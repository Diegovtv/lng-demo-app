/**
 * App version: 1.0.0
 * SDK version: 5.4.1
 * CLI version: 2.12.0
 * 
 * Generated: Thu, 15 Feb 2024 19:08:12 GMT
 */

var APP_core_app_sample=function(){"use strict";function ownKeys$1(o,s){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(o);s&&(_=_.filter((function(s){return Object.getOwnPropertyDescriptor(o,s).enumerable}))),m.push.apply(m,_)}return m}function _objectSpread2(o){for(var s=1;s<arguments.length;s++){var m=null!=arguments[s]?arguments[s]:{};s%2?ownKeys$1(Object(m),!0).forEach((function(s){_defineProperty$2(o,s,m[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):ownKeys$1(Object(m)).forEach((function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(m,s))}))}return o}function _regeneratorRuntime$1(){_regeneratorRuntime$1=function(){return o};var o={},s=Object.prototype,m=s.hasOwnProperty,_=Object.defineProperty||function(o,s,m){o[s]=m.value},S="function"==typeof Symbol?Symbol:{},E=S.iterator||"@@iterator",A=S.asyncIterator||"@@asyncIterator",O=S.toStringTag||"@@toStringTag";function define(o,s,m){return Object.defineProperty(o,s,{value:m,enumerable:!0,configurable:!0,writable:!0}),o[s]}try{define({},"")}catch(o){define=function(o,s,m){return o[s]=m}}function wrap(o,s,m,S){var E=s&&s.prototype instanceof Generator?s:Generator,A=Object.create(E.prototype),O=new Context(S||[]);return _(A,"_invoke",{value:makeInvokeMethod(o,m,O)}),A}function tryCatch(o,s,m){try{return{type:"normal",arg:o.call(s,m)}}catch(o){return{type:"throw",arg:o}}}o.wrap=wrap;var H={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var K={};define(K,E,(function(){return this}));var z=Object.getPrototypeOf,G=z&&z(z(values([])));G&&G!==s&&m.call(G,E)&&(K=G);var q=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(K);function defineIteratorMethods(o){["next","throw","return"].forEach((function(s){define(o,s,(function(o){return this._invoke(s,o)}))}))}function AsyncIterator(o,s){function invoke(_,S,E,A){var O=tryCatch(o[_],o,S);if("throw"!==O.type){var H=O.arg,K=H.value;return K&&"object"==typeof K&&m.call(K,"__await")?s.resolve(K.__await).then((function(o){invoke("next",o,E,A)}),(function(o){invoke("throw",o,E,A)})):s.resolve(K).then((function(o){H.value=o,E(H)}),(function(o){return invoke("throw",o,E,A)}))}A(O.arg)}var S;_(this,"_invoke",{value:function(o,m){function callInvokeWithMethodAndArg(){return new s((function(s,_){invoke(o,m,s,_)}))}return S=S?S.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(o,s,m){var _="suspendedStart";return function(S,E){if("executing"===_)throw new Error("Generator is already running");if("completed"===_){if("throw"===S)throw E;return doneResult()}for(m.method=S,m.arg=E;;){var A=m.delegate;if(A){var O=maybeInvokeDelegate(A,m);if(O){if(O===H)continue;return O}}if("next"===m.method)m.sent=m._sent=m.arg;else if("throw"===m.method){if("suspendedStart"===_)throw _="completed",m.arg;m.dispatchException(m.arg)}else"return"===m.method&&m.abrupt("return",m.arg);_="executing";var K=tryCatch(o,s,m);if("normal"===K.type){if(_=m.done?"completed":"suspendedYield",K.arg===H)continue;return{value:K.arg,done:m.done}}"throw"===K.type&&(_="completed",m.method="throw",m.arg=K.arg)}}}function maybeInvokeDelegate(o,s){var m=s.method,_=o.iterator[m];if(void 0===_)return s.delegate=null,"throw"===m&&o.iterator.return&&(s.method="return",s.arg=void 0,maybeInvokeDelegate(o,s),"throw"===s.method)||"return"!==m&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+m+"' method")),H;var S=tryCatch(_,o.iterator,s.arg);if("throw"===S.type)return s.method="throw",s.arg=S.arg,s.delegate=null,H;var E=S.arg;return E?E.done?(s[o.resultName]=E.value,s.next=o.nextLoc,"return"!==s.method&&(s.method="next",s.arg=void 0),s.delegate=null,H):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,H)}function pushTryEntry(o){var s={tryLoc:o[0]};1 in o&&(s.catchLoc=o[1]),2 in o&&(s.finallyLoc=o[2],s.afterLoc=o[3]),this.tryEntries.push(s)}function resetTryEntry(o){var s=o.completion||{};s.type="normal",delete s.arg,o.completion=s}function Context(o){this.tryEntries=[{tryLoc:"root"}],o.forEach(pushTryEntry,this),this.reset(!0)}function values(o){if(o){var s=o[E];if(s)return s.call(o);if("function"==typeof o.next)return o;if(!isNaN(o.length)){var _=-1,S=function next(){for(;++_<o.length;)if(m.call(o,_))return next.value=o[_],next.done=!1,next;return next.value=void 0,next.done=!0,next};return S.next=S}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_(q,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),_(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,O,"GeneratorFunction"),o.isGeneratorFunction=function(o){var s="function"==typeof o&&o.constructor;return!!s&&(s===GeneratorFunction||"GeneratorFunction"===(s.displayName||s.name))},o.mark=function(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,GeneratorFunctionPrototype):(o.__proto__=GeneratorFunctionPrototype,define(o,O,"GeneratorFunction")),o.prototype=Object.create(q),o},o.awrap=function(o){return{__await:o}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,A,(function(){return this})),o.AsyncIterator=AsyncIterator,o.async=function(s,m,_,S,E){void 0===E&&(E=Promise);var A=new AsyncIterator(wrap(s,m,_,S),E);return o.isGeneratorFunction(m)?A:A.next().then((function(o){return o.done?o.value:A.next()}))},defineIteratorMethods(q),define(q,O,"Generator"),define(q,E,(function(){return this})),define(q,"toString",(function(){return"[object Generator]"})),o.keys=function(o){var s=Object(o),m=[];for(var _ in s)m.push(_);return m.reverse(),function next(){for(;m.length;){var o=m.pop();if(o in s)return next.value=o,next.done=!1,next}return next.done=!0,next}},o.values=values,Context.prototype={constructor:Context,reset:function(o){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!o)for(var s in this)"t"===s.charAt(0)&&m.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function(){this.done=!0;var o=this.tryEntries[0].completion;if("throw"===o.type)throw o.arg;return this.rval},dispatchException:function(o){if(this.done)throw o;var s=this;function handle(m,_){return E.type="throw",E.arg=o,s.next=m,_&&(s.method="next",s.arg=void 0),!!_}for(var _=this.tryEntries.length-1;_>=0;--_){var S=this.tryEntries[_],E=S.completion;if("root"===S.tryLoc)return handle("end");if(S.tryLoc<=this.prev){var A=m.call(S,"catchLoc"),O=m.call(S,"finallyLoc");if(A&&O){if(this.prev<S.catchLoc)return handle(S.catchLoc,!0);if(this.prev<S.finallyLoc)return handle(S.finallyLoc)}else if(A){if(this.prev<S.catchLoc)return handle(S.catchLoc,!0)}else{if(!O)throw new Error("try statement without catch or finally");if(this.prev<S.finallyLoc)return handle(S.finallyLoc)}}}},abrupt:function(o,s){for(var _=this.tryEntries.length-1;_>=0;--_){var S=this.tryEntries[_];if(S.tryLoc<=this.prev&&m.call(S,"finallyLoc")&&this.prev<S.finallyLoc){var E=S;break}}E&&("break"===o||"continue"===o)&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var A=E?E.completion:{};return A.type=o,A.arg=s,E?(this.method="next",this.next=E.finallyLoc,H):this.complete(A)},complete:function(o,s){if("throw"===o.type)throw o.arg;return"break"===o.type||"continue"===o.type?this.next=o.arg:"return"===o.type?(this.rval=this.arg=o.arg,this.method="return",this.next="end"):"normal"===o.type&&s&&(this.next=s),H},finish:function(o){for(var s=this.tryEntries.length-1;s>=0;--s){var m=this.tryEntries[s];if(m.finallyLoc===o)return this.complete(m.completion,m.afterLoc),resetTryEntry(m),H}},catch:function(o){for(var s=this.tryEntries.length-1;s>=0;--s){var m=this.tryEntries[s];if(m.tryLoc===o){var _=m.completion;if("throw"===_.type){var S=_.arg;resetTryEntry(m)}return S}}throw new Error("illegal catch attempt")},delegateYield:function(o,s,m){return this.delegate={iterator:values(o),resultName:s,nextLoc:m},"next"===this.method&&(this.arg=void 0),H}},o}function asyncGeneratorStep$1(o,s,m,_,S,E,A){try{var O=o[E](A),H=O.value}catch(o){return void m(o)}O.done?s(H):Promise.resolve(H).then(_,S)}function _asyncToGenerator$1(o){return function(){var s=this,m=arguments;return new Promise((function(_,S){var E=o.apply(s,m);function _next(o){asyncGeneratorStep$1(E,_,S,_next,_throw,"next",o)}function _throw(o){asyncGeneratorStep$1(E,_,S,_next,_throw,"throw",o)}_next(void 0)}))}}function _classCallCheck$1(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,_toPropertyKey$2(_.key),_)}}function _createClass$1(o,s,m){return s&&_defineProperties$1(o.prototype,s),m&&_defineProperties$1(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}function _defineProperty$2(o,s,m){return(s=_toPropertyKey$2(s))in o?Object.defineProperty(o,s,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[s]=m,o}function _inherits$1(o,s){if("function"!=typeof s&&null!==s)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(s&&s.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),s&&_setPrototypeOf$1(o,s)}function _getPrototypeOf$1(o){return _getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf$1(o)}function _setPrototypeOf$1(o,s){return _setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf$1(o,s)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(o){return!1}}function _construct(o,s,m){return _construct=_isNativeReflectConstruct()?Reflect.construct.bind():function _construct(o,s,m){var _=[null];_.push.apply(_,s);var S=new(Function.bind.apply(o,_));return m&&_setPrototypeOf$1(S,m.prototype),S},_construct.apply(null,arguments)}function _wrapNativeSuper(o){var s="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(o){if(null===o||!function _isNativeFunction(o){return-1!==Function.toString.call(o).indexOf("[native code]")}(o))return o;if("function"!=typeof o)throw new TypeError("Super expression must either be null or a function");if(void 0!==s){if(s.has(o))return s.get(o);s.set(o,Wrapper)}function Wrapper(){return _construct(o,arguments,_getPrototypeOf$1(this).constructor)}return Wrapper.prototype=Object.create(o.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf$1(Wrapper,o)},_wrapNativeSuper(o)}function _objectWithoutProperties(o,s){if(null==o)return{};var m,_,S=function _objectWithoutPropertiesLoose(o,s){if(null==o)return{};var m,_,S={},E=Object.keys(o);for(_=0;_<E.length;_++)m=E[_],s.indexOf(m)>=0||(S[m]=o[m]);return S}(o,s);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(o);for(_=0;_<E.length;_++)m=E[_],s.indexOf(m)>=0||Object.prototype.propertyIsEnumerable.call(o,m)&&(S[m]=o[m])}return S}function _assertThisInitialized(o){if(void 0===o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function _possibleConstructorReturn(o,s){if(s&&("object"==typeof s||"function"==typeof s))return s;if(void 0!==s)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(o)}function _createSuper$1(o){var s=_isNativeReflectConstruct();return function _createSuperInternal(){var m,_=_getPrototypeOf$1(o);if(s){var S=_getPrototypeOf$1(this).constructor;m=Reflect.construct(_,arguments,S)}else m=_.apply(this,arguments);return _possibleConstructorReturn(this,m)}}function _get$1(){return _get$1="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(o,s,m){var _=function _superPropBase$1(o,s){for(;!Object.prototype.hasOwnProperty.call(o,s)&&null!==(o=_getPrototypeOf$1(o)););return o}(o,s);if(_){var S=Object.getOwnPropertyDescriptor(_,s);return S.get?S.get.call(arguments.length<3?o:m):S.value}},_get$1.apply(this,arguments)}function _slicedToArray$1(o,s){return _arrayWithHoles(o)||function _iterableToArrayLimit(o,s){var m=null==o?null:"undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(null!=m){var _,S,E,A,O=[],H=!0,K=!1;try{if(E=(m=m.call(o)).next,0===s){if(Object(m)!==m)return;H=!1}else for(;!(H=(_=E.call(m)).done)&&(O.push(_.value),O.length!==s);H=!0);}catch(o){K=!0,S=o}finally{try{if(!H&&null!=m.return&&(A=m.return(),Object(A)!==A))return}finally{if(K)throw S}}return O}}(o,s)||_unsupportedIterableToArray$1(o,s)||_nonIterableRest()}function _toArray(o){return _arrayWithHoles(o)||_iterableToArray(o)||_unsupportedIterableToArray$1(o)||_nonIterableRest()}function _toConsumableArray$1(o){return function _arrayWithoutHoles(o){if(Array.isArray(o))return _arrayLikeToArray$1(o)}(o)||_iterableToArray(o)||_unsupportedIterableToArray$1(o)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayWithHoles(o){if(Array.isArray(o))return o}function _iterableToArray(o){if("undefined"!=typeof Symbol&&null!=o[Symbol.iterator]||null!=o["@@iterator"])return Array.from(o)}function _unsupportedIterableToArray$1(o,s){if(o){if("string"==typeof o)return _arrayLikeToArray$1(o,s);var m=Object.prototype.toString.call(o).slice(8,-1);return"Object"===m&&o.constructor&&(m=o.constructor.name),"Map"===m||"Set"===m?Array.from(o):"Arguments"===m||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m)?_arrayLikeToArray$1(o,s):void 0}}function _arrayLikeToArray$1(o,s){(null==s||s>o.length)&&(s=o.length);for(var m=0,_=new Array(s);m<s;m++)_[m]=o[m];return _}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(o,s){var m="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!m){if(Array.isArray(o)||(m=_unsupportedIterableToArray$1(o))||s&&o&&"number"==typeof o.length){m&&(o=m);var _=0,F=function(){};return{s:F,n:function(){return _>=o.length?{done:!0}:{done:!1,value:o[_++]}},e:function(o){throw o},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var S,E=!0,A=!1;return{s:function(){m=m.call(o)},n:function(){var o=m.next();return E=o.done,o},e:function(o){A=!0,S=o},f:function(){try{E||null==m.return||m.return()}finally{if(A)throw S}}}}function _toPropertyKey$2(o){var s=function _toPrimitive$1(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(o,"string");return"symbol"==typeof s?s:String(s)}var o={},s={},m={get:function get(s,m){var _=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,S=function dotGrab(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!==o){for(var s=(arguments.length>1?arguments[1]:void 0).split("."),m=0;m<s.length;m++)o=o[s[m]]=void 0!==o[s[m]]?o[s[m]]:{};return"object"==typeof o&&null!==o?Object.keys(o).length?o:void 0:o}}(o[s],m);return void 0!==S?S:_},has:function has(o,s){return!!this.get(o,s)},set:function set(m,_){o.user[m]=_,function publish(o,m){s[o]&&s[o].forEach((function(o){return o(m)}))}(m,_)},subscribe:function subscribe(o,m){s[o]=s[o]||[],s[o].push(m)},unsubscribe:function unsubscribe(o,m){if(m){var _=s[o]&&s[o].findIndex((function(o){return o===m}));_>-1&&s[o].splice(_,1)}else o in s&&(s[o]=[])},clearSubscribers:function clearSubscribers(){var o,m=_createForOfIteratorHelper(Object.getOwnPropertyNames(s));try{for(m.s();!(o=m.n()).done;){var _=o.value;delete s[_]}}catch(o){m.e(o)}finally{m.f()}}},_=function prepLog(o,s){return["%c"+((s=Array.from(s)).length>1&&"string"==typeof s[0]?s.shift():o),"background-color: "+{Info:"green",Debug:"gray",Warn:"orange",Error:"red"}[o]+"; color: white; padding: 2px 4px; border-radius: 2px",s]},S={info:function info(){m.get("platform","log")&&console.log.apply(console,_("Info",arguments))},debug:function debug(){m.get("platform","log")&&console.debug.apply(console,_("Debug",arguments))},error:function error(){m.get("platform","log")&&console.error.apply(console,_("Error",arguments))},warn:function warn(){m.get("platform","log")&&console.warn.apply(console,_("Warn",arguments))}},E=window.lng,A=function(o){_inherits$1(ColorShift,o);var s=_createSuper$1(ColorShift);function ColorShift(){return _classCallCheck$1(this,ColorShift),s.apply(this,arguments)}return _createClass$1(ColorShift,[{key:"brightness",set:function set(o){this._brightness=(o-50)/100,this.redraw()}},{key:"contrast",set:function set(o){this._contrast=(o+50)/100,this.redraw()}},{key:"gamma",set:function set(o){this._gamma=(o+50)/100,this.redraw()}},{key:"setupUniforms",value:function setupUniforms(o){_get$1(_getPrototypeOf$1(ColorShift.prototype),"setupUniforms",this).call(this,o);var s=this.gl;this._setUniform("colorAdjust",[this._brightness||0,this._contrast||1,this._gamma||1],s.uniform3fv)}}]),ColorShift}(E.shaders.WebGLDefaultShader);A.before="\n    #ifdef GL_ES\n    # ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    # else\n    precision lowp float;\n    # endif\n    #endif\n        \n    varying vec2 vTextureCoord;\n    varying vec4 vColor;\n    uniform sampler2D uSampler;\n    uniform vec3 colorAdjust;\n    \n    const mat3 RGBtoOpponentMat = mat3(0.2814, -0.0971, -0.0930, 0.6938, 0.1458,-0.2529, 0.0638, -0.0250, 0.4665);\n    const mat3 OpponentToRGBMat = mat3(1.1677, 0.9014, 0.7214, -6.4315, 2.5970, 0.1257, -0.5044, 0.0159, 2.0517);    \n",A.after="    \n    vec3 brightnessContrast(vec3 value, float brightness, float contrast)\n    {\n        return (value - 0.5) * contrast + 0.5 + brightness;\n    }   \n    \n    vec3 updateGamma(vec3 value, float param)\n    {\n        return vec3(pow(abs(value.r), param),pow(abs(value.g), param),pow(abs(value.b), param));\n    } \n       \n    void main(void){\n        vec4 fragColor = texture2D(uSampler, vTextureCoord);        \n        vec4 color = filter(fragColor) * vColor;       \n        \n        vec3 bc = brightnessContrast(color.rgb,colorAdjust[0],colorAdjust[1]);        \n        vec3 ga = updateGamma(bc.rgb, colorAdjust[2]);  \n              \n        gl_FragColor = vec4(ga.rgb, color.a);          \n    }    \n";var O=function(o){_inherits$1(ProtanopiaShader,o);var s=_createSuper$1(ProtanopiaShader);function ProtanopiaShader(){return _classCallCheck$1(this,ProtanopiaShader),s.apply(this,arguments)}return _createClass$1(ProtanopiaShader)}(A);O.fragmentShaderSource="\n    ".concat(A.before,"    \n    vec4 vision(vec4 color)\n    {\n        vec4 r = vec4( 0.20,  0.99, -0.19, 0.0);\n        vec4 g = vec4( 0.16,  0.79,  0.04, 0.0);\n        vec4 b = vec4( 0.01, -0.01,  1.00, 0.0);\n       \n        return vec4(dot(color, r), dot(color, g), dot(color, b), color.a);\t\n    }\n    \n    vec4 filter( vec4 color )\n    {   \n        vec3 opponentColor = RGBtoOpponentMat * vec3(color.r, color.g, color.b);\n        opponentColor.x -= opponentColor.y * 1.5; \n        vec3 rgbColor = OpponentToRGBMat * opponentColor;\n        return vision(vec4(rgbColor.r, rgbColor.g, rgbColor.b, color.a));      \n    }    \n    ").concat(A.after," \n");var H=function(o){_inherits$1(DeuteranopiaShader,o);var s=_createSuper$1(DeuteranopiaShader);function DeuteranopiaShader(){return _classCallCheck$1(this,DeuteranopiaShader),s.apply(this,arguments)}return _createClass$1(DeuteranopiaShader)}(A);H.fragmentShaderSource="\n    ".concat(A.before,"\n    vec4 vision(vec4 color)\n    {\n        vec4 r = vec4( 0.43,  0.72, -0.15, 0.0 );\n        vec4 g = vec4( 0.34,  0.57,  0.09, 0.0 );\n        vec4 b = vec4(-0.02,  0.03,  1.00, 0.0 );\n       \n        return vec4(dot(color, r), dot(color, g), dot(color, b), color.a);\t\n    }\n       \n    vec4 filter( vec4 color )\n    {   \n        vec3 opponentColor = RGBtoOpponentMat * vec3(color.r, color.g, color.b);\n        opponentColor.x -= opponentColor.y * 1.5; \n        vec3 rgbColor = OpponentToRGBMat * opponentColor;\n        return vision(vec4(rgbColor.r, rgbColor.g, rgbColor.b, color.a));    \n    }\n    ").concat(A.after,"    \n");var K=function(o){_inherits$1(TritanopiaShader,o);var s=_createSuper$1(TritanopiaShader);function TritanopiaShader(){return _classCallCheck$1(this,TritanopiaShader),s.apply(this,arguments)}return _createClass$1(TritanopiaShader)}(A);K.fragmentShaderSource="\n    ".concat(A.before,"    \n    vec4 vision(vec4 color)\n    {\n        vec4 r = vec4( 0.97,  0.11, -0.08, 0.0 );\n        vec4 g = vec4( 0.02,  0.82,  0.16, 0.0 );\n        vec4 b = vec4(-0.06,  0.88,  0.18, 0.0 );\n       \n        return vec4(dot(color, r), dot(color, g), dot(color, b), color.a);\t\n    }   \n    \n    vec4 filter( vec4 color )\n    {   \n        vec3 opponentColor = RGBtoOpponentMat * vec3(color.r, color.g, color.b);\n        opponentColor.x -= ((3.0 * opponentColor.z) - opponentColor.y) * 0.25;\n        vec3 rgbColor = OpponentToRGBMat * opponentColor;\n        return vision(vec4(rgbColor.r, rgbColor.g, rgbColor.b, color.a));\n    }   \n    ").concat(A.after," \n");var z=function(o){_inherits$1(NeutralShader,o);var s=_createSuper$1(NeutralShader);function NeutralShader(){return _classCallCheck$1(this,NeutralShader),s.apply(this,arguments)}return _createClass$1(NeutralShader)}(A);z.fragmentShaderSource="\n    ".concat(A.before,"\n    vec4 filter( vec4 color )\n    {\n        return color;\n    }\n    ").concat(A.after,"\n");var G=function(o){_inherits$1(MonochromacyShader,o);var s=_createSuper$1(MonochromacyShader);function MonochromacyShader(){return _classCallCheck$1(this,MonochromacyShader),s.apply(this,arguments)}return _createClass$1(MonochromacyShader)}(A);G.fragmentShaderSource="\n    ".concat(A.before,"\n    vec4 filter( vec4 color )\n    {   \n        float grey = dot(color.rgb, vec3(0.299, 0.587, 0.114));\n        return vec4(vec3(grey, grey, grey), 1.0 ); \n    }\n    ").concat(A.after,"\n");var q,X;function delay$1(o){return new Promise((function(s){setTimeout(s,o)}))}function speak$1(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US",_=window.speechSynthesis;return new Promise((function(S,E){var A=new SpeechSynthesisUtterance(o);A.lang=m,A.onend=function(){S()},A.onerror=function(o){E(o)},s.push(A),_.speak(A)}))}function speakSeries$1(o,s){var m=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],_=window.speechSynthesis,S=function flattenStrings(){for(var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=[],m=0;m<o.length&&"string"==typeof o[m]&&!o[m].includes("PAUSE-");m++)s.push(o[m]);return[s.join(",\b ")].concat(o.slice(m))}(Array.isArray(o)?o:[o]),E=[],A=[],O=!0;return{series:_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){var o,m,_,H,K,z;return _regeneratorRuntime$1().wrap((function _callee$(G){for(;;)switch(G.prev=G.next){case 0:G.prev=0;case 1:if(!O||!S.length){G.next=62;break}return G.next=4,Promise.resolve(S.shift());case 4:if(o=G.sent,O){G.next=9;break}return G.abrupt("break",62);case 9:if("string"!=typeof o||!o.includes("PAUSE-")){G.next=16;break}return m=1e3*o.split("PAUSE-")[1],isNaN(m)&&(m=0),G.next=14,delay$1(m);case 14:G.next=60;break;case 16:if("string"!=typeof o||!o.length){G.next=48;break}H=_=3;case 19:if(!(O&&H>0)){G.next=46;break}return G.prev=20,G.next=23,speak$1(o,A,s);case 23:H=0,G.next=44;break;case 26:if(G.prev=26,G.t0=G.catch(20),!(G.t0 instanceof SpeechSynthesisErrorEvent)){G.next=43;break}if("network"!==G.t0.error){G.next=36;break}return H--,console.warn("Speech synthesis network error. Retries left: ".concat(H)),G.next=34,delay$1(500*(_-H));case 34:G.next=41;break;case 36:if("canceled"!==G.t0.error&&"interrupted"!==G.t0.error){G.next=40;break}H=0,G.next=41;break;case 40:throw new Error("SpeechSynthesisErrorEvent: ".concat(G.t0.error));case 41:G.next=44;break;case 43:throw G.t0;case 44:G.next=19;break;case 46:G.next=60;break;case 48:if("function"!=typeof o){G.next=55;break}return K=speakSeries$1(o(),s,!1),E.push(K),G.next=53,K.series;case 53:G.next=60;break;case 55:if(!Array.isArray(o)){G.next=60;break}return z=speakSeries$1(o,s,!1),E.push(z),G.next=60,z.series;case 60:G.next=1;break;case 62:return G.prev=62,O=!1,G.finish(62);case 65:case"end":return G.stop()}}),_callee,null,[[0,,62,65],[20,26]])})))(),get active(){return O},append:function append(o){S.push(o)},cancel:function cancel(){O&&(m&&_.cancel(),E.forEach((function(o){o.cancel()})),O=!1)}}}function SpeechEngine(o,s){return q&&q.cancel(),q=speakSeries$1(o,s)}function getElmName(o){return o.ref||o.constructor.name}function debounce$2(o,s,m){var _,S,E,A,O;function later(){var H=Date.now()-A;H<s&&H>=0?_=setTimeout(later,s-H):(_=null,m||(O=o.apply(E,S),E=S=null))}null==s&&(s=100);var H=function debounced(){E=this,S=arguments,A=Date.now();var H=m&&!_;return _||(_=setTimeout(later,s)),H&&(O=o.apply(E,S),E=S=null),O};return H.clear=function(){_&&(clearTimeout(_),_=null)},H.flush=function(){_&&(O=o.apply(E,S),E=S=null,clearTimeout(_),_=null)},H}var J,ae=[],pe=!1;function onFocusChangeCore(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(me.enabled){var s=o.every((function(o){return!o.loading})),m=o.filter((function(o){return!ae.includes(o)}));if(X(),s){ae=o.slice(0);var _=[],S=m.reduce((function(o,s){return s.announce?(o.push([getElmName(s),"Announce",s.announce]),_.push(s.announce)):s.title&&(o.push([getElmName(s),"Title",s.title]),_.push(s.title)),o}),[]);return m.reverse().reduce((function(o,s){return s.announceContext?(o.push([getElmName(s),"Context",s.announceContext]),_.push(s.announceContext)):o.push([getElmName(s),"No Context",""]),o}),S),me.debug&&console.table(S),_.length?me.speak(_.reduce((function(o,s){return o.concat(s)}),[])):void 0}me.onFocusChange()}}var me={enabled:!0,debug:!1,cancel:function cancel(){J&&J.cancel()},clearPrevFocus:function clearPrevFocus(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;ae=ae.slice(0,o),X()},speak:function speak(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=s.append,_=void 0!==m&&m,S=s.notification,E=void 0!==S&&S;return me.enabled&&(me.onFocusChange.flush(),_&&J&&J.active?J.append(o):(me.cancel(),function textToSpeech(o){if(!pe)return J=SpeechEngine(o)}(o)),E&&(pe=!0,J.series.finally((function(){pe=!1,me.refresh()})))),J},setupTimers:function setupTimers(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=o.focusDebounce,m=void 0===s?400:s,_=o.focusChangeTimeout,S=void 0===_?3e5:_;me.onFocusChange=debounce$2(onFocusChangeCore,m),X=debounce$2((function(){ae=[]}),S)}};me.setupTimers();var _e,Se,Ee,De,$e,He,et,rt,it,at,ot,st={Announcer:me,colorshift:function colorshift(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{brightness:50,contrast:50,gamma:50};m=_objectSpread2(_objectSpread2({},{brightness:50,contrast:50,gamma:50}),m);var _=s&&function colorshiftShader(o){var s={normal:z,monochromacy:G,deuteranopia:H,tritanopia:K,protanopia:O};return o="string"==typeof o&&o.toLowerCase()||null,Object.keys(s).indexOf(o)>-1&&s[o]}(s);_?(S.info("Accessibility Colorshift",s,m),o.rtt=!0,o.shader=_objectSpread2({type:_},m)):(S.info("Accessibility Colorshift","Disabled"),o.rtt=!1,o.shader=null)}},ut={set log(o){_e=o},set settings(o){Se=o},set ads(o){De=o},set lightning(o){$e=o},set appInstance(o){Ee=o}},ct=function sendMetric(o,s,m){_e.info("Sending metric",o,s,m)},dt=function errorMetric(o,s,m,_){var S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};S=_objectSpread2({params:S},{message:s,code:m,visible:_}),ct(o,"error",S)},ht=function Metric(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.reduce((function(s,_){return s[_]=function(s){var S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};S=_objectSpread2(_objectSpread2(_objectSpread2({},m),s?{name:s}:{}),S),ct(o,_,S)},s}),{error:function error(s,m,_){dt(o,s,m,_)},event:function event(s,m){ct(o,s,m)}})},pt=function Metrics(o){return Object.keys(o).reduce((function(s,m){return s[m]="media"===m?function(s){return ht(m,o[m],{url:s})}:ht(m,o[m]),s}),{error:dt,event:ct})}({app:["launch","loaded","ready","close"],page:["view","leave"],user:["click","input"],media:["abort","canplay","ended","pause","play","volumechange","waiting","seeking","seeked"]}),gt=function formatLocale(o){return o&&2===o.length?"".concat(o.toLowerCase(),"-").concat(o.toUpperCase()):o},_t=function getLatLon(o){return new Promise((function(s){(function hasOrAskForGeoLocationPermission(){return new Promise((function(o){!0===Se.get("platform","forceBrowserGeolocation")&&o(!0),"permissions"in navigator&&"function"==typeof navigator.permissions.query?navigator.permissions.query({name:"geolocation"}).then((function(s){o("granted"===s.state||"granted"===s.status)})):o(!1)}))})().then((function(m){return!0!==m?bt().then((function(m){return s(m||o)})):"geolocation"in navigator?void navigator.geolocation.getCurrentPosition((function(o){return o&&o.coords&&s([o.coords.latitude,o.coords.longitude])}),(function(){return s(o)}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):bt().then((function(m){return s(m||o)}))}))}))},bt=function queryForLatLon(){return new Promise((function(o){fetch("https://geolocation-db.com/json/").then((function(o){return o.json()})).then((function(s){var m=s.latitude,_=s.longitude;return o(!(!m||!_)&&[m,_])})).catch((function(){return o(!1)}))}))},kt={ageRating:"adult",city:"New York",zipCode:"27505",countryCode:function countryCode(){return function getCountryCode(o){if("language"in navigator){var s=gt(navigator.language).slice(3,5);return Promise.resolve(s)}return Promise.resolve(o)}("US")},ip:"127.0.0.1",household:"b2244e9d4c04826ccd5a7b2c2a50e7d4",language:function language(){return function getLanguage(o){if("language"in navigator){var s=gt(navigator.language).slice(0,2);return Promise.resolve(s)}return Promise.resolve(o)}("en")},latlon:function latlon(){return _t([40.7128,74.006])},locale:function locale(){return function getLocale(o){if("language"in navigator){var s=gt(navigator.language);return Promise.resolve(s)}return Promise.resolve(o)}("en-US")},mac:"00:00:00:00:00:00",operator:"metrological",platform:"metrological",packages:[],uid:"ee6723b8-7ab3-462c-8d93-dbf61227998e",stbType:"metrological"},It=function getInfo(o){var s=_objectSpread2(_objectSpread2({},kt),Se.get("platform","profile"));return Promise.resolve("function"==typeof s[o]?s[o]():s[o])},At=function setInfo(o,s){if(o in kt)return kt[o]=s},Lt=[{number:1,name:"Metro News 1",description:"New York Cable News Channel",entitled:!0,program:{title:"The Morning Show",description:"New York's best morning show",startTime:new Date(new Date-3e5).toUTCString(),duration:1800,ageRating:0}},{number:2,name:"MTV",description:"Music Television",entitled:!0,program:{title:"Beavis and Butthead",description:"American adult animated sitcom created by Mike Judge",startTime:new Date(new Date-12e5).toUTCString(),duration:2700,ageRating:18}},{number:3,name:"NBC",description:"NBC TV Network",entitled:!1,program:{title:"The Tonight Show Starring Jimmy Fallon",description:"Late-night talk show hosted by Jimmy Fallon on NBC",startTime:new Date(new Date-6e5).toUTCString(),duration:3600,ageRating:10}}],Rt=function channels(){return Se.get("platform","tv",Lt)},Mt=function randomChannel(){return Rt()[~~(Rt.length*Math.random())]},zt={},qt=function emit(o){for(var s=arguments.length,m=new Array(s>1?s-1:0),_=1;_<s;_++)m[_-1]=arguments[_];zt[o]&&zt[o].forEach((function(o){o.apply(null,m)}))},Jt={getChannel:function getChannel(){return He||(He=Mt()),new Promise((function(o,s){if(He){var m=_objectSpread2({},He);delete m.program,o(m)}else s("No channel found")}))},getProgram:function getProgram(){return He||(He=Mt()),new Promise((function(o,s){He.program?o(He.program):s("No program found")}))},setChannel:function setChannel(o){return new Promise((function(s,m){if(o){var _=Rt().find((function(s){return s.number===o}));if(_){var S=_objectSpread2({},He=_);delete S.program,qt("channelChange",S),s(S)}else m("Channel not found")}else m("No channel number supplied")}))}},tn={abort:"Abort",canplay:"CanPlay",canplaythrough:"CanPlayThrough",durationchange:"DurationChange",emptied:"Emptied",encrypted:"Encrypted",ended:"Ended",error:"Error",interruptbegin:"InterruptBegin",interruptend:"InterruptEnd",loadeddata:"LoadedData",loadedmetadata:"LoadedMetadata",loadstart:"LoadStart",pause:"Pause",play:"Play",playing:"Playing",progress:"Progress",ratechange:"Ratechange",seeked:"Seeked",seeking:"Seeking",stalled:"Stalled",timeupdate:"TimeUpdate",volumechange:"VolumeChange",waiting:"Waiting"},nn=null,rn=function mediaUrl(o){return o},sn=1,un=!1,pn={},vn={adsEnabled:!1,playing:!1,_playingAds:!1,get playingAds(){return this._playingAds},set playingAds(o){this._playingAds!==o&&(this._playingAds=o,wn(!0===o?"AdStart":"AdEnd"))},skipTime:!1,playAfterSeek:null},_n={play:function play(){vn.playing=!0},pause:function pause(){vn.playing=!1},seeked:function seeked(){!0===vn.playAfterSeek&&Gn.play(),vn.playAfterSeek=null},abort:function abort(){Fn()}},Cn=function withPrecision(o){return Math.round(sn*o)+"px"},wn=function fireOnConsumer(o,s){at&&(at.fire("$videoPlayer"+o,s,et.currentTime),at.fire("$videoPlayerEvent",o,s,et.currentTime))},xn=null,In=null,An=function registerEventListeners(){_e.info("VideoPlayer","Registering event listeners"),Object.keys(tn).forEach((function(o){var s=function handler(s){it&&it[o]&&"function"==typeof it[o]&&it[o]({currentTime:et.currentTime}),function fireHook(o,s){_n[o]&&"function"==typeof _n[o]&&_n[o].call(null,o,s)}(o,{videoElement:et,event:s}),wn(tn[o],{videoElement:et,event:s})};pn[o]=s,et.addEventListener(o,s)}))},Fn=function deregisterEventListeners(){_e.info("VideoPlayer","Deregistering event listeners"),Object.keys(pn).forEach((function(o){et.removeEventListener(o,pn[o])})),pn={}},Gn={consumer:function consumer(o){at=o},loader:function loader(o){xn=o},unloader:function unloader(o){In=o},position:function position(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;et.style.left=Cn(s),et.style.top=Cn(o),!0===un&&rt.position(o,s)},size:function size(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1920,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1080;et.style.width=Cn(o),et.style.height=Cn(s),et.width=parseFloat(et.style.width),et.height=parseFloat(et.style.height),!0===un&&rt.size(o,s)},area:function area(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1080,_=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.position(o,_),this.size(s-_,m-o)},open:function open(o){var s=this,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.canInteract)if(it=pt.media(o),this.hide(),Fn(),this.src==o)this.clear().then(this.open(o,m));else{var _={enabled:vn.adsEnabled,duration:300};m.videoId&&(_.caid=m.videoId),De.get(_,at).then((function(_){vn.playingAds=!0,_.prerolls().then((function(){vn.playingAds=!1,function loader(o,s,m){return xn&&"function"==typeof xn?xn(o,s,m):new Promise((function(m){o=rn(o),s.setAttribute("src",o),s.load(),m()}))}(o,et,m).then((function(){An(),s.show(),s.play()})).catch((function(o){wn("error",{videoElement:et,event:o})}))}))}))}},reload:function reload(){if(this.canInteract){var o=et.getAttribute("src");this.close(),this.open(o)}},close:function close(){var o=this;De.cancel(),vn.playingAds&&(vn.playingAds=!1,De.stop(),setTimeout((function(){o.close()}))),this.canInteract&&(this.clear(),this.hide(),Fn())},clear:function clear(){if(this.canInteract)return this.pause(),!0===un&&rt.stop(),function unloader(o){return In&&"function"==typeof In?In(o):new Promise((function(s){o.removeAttribute("src"),o.load(),s()}))}(et).then((function(){wn("Clear",{videoElement:et})}))},play:function play(){this.canInteract&&(!0===un&&rt.start(),function(o){var s,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(o&&"function"==typeof o)try{s=o.apply(_,m)}catch(o){s=o}else s=o;return null!==s&&"object"==typeof s&&s.then&&"function"==typeof s.then?s:new Promise((function(o,m){s instanceof Error?m(s):o(s)}))}(et.play,null,et).catch((function(o){wn("error",{videoElement:et,event:o})})))},pause:function pause(){this.canInteract&&et.pause()},playPause:function playPause(){this.canInteract&&(!0===this.playing?this.pause():this.play())},mute:function mute(){var o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.canInteract&&(et.muted=o)},loop:function loop(){var o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];et.loop=o},seek:function seek(o){this.canInteract&&this.src&&(null===vn.playAfterSeek&&(vn.playAfterSeek=!!vn.playing),this.pause(),et.currentTime=Math.max(0,Math.min(o,this.duration-.1)))},skip:function skip(o){var s=this;this.canInteract&&this.src&&(vn.skipTime=(vn.skipTime||et.currentTime)+o,function(o,s){clearTimeout(nn),nn=setTimeout((function(){o()}),s)}((function(){s.seek(vn.skipTime),vn.skipTime=!1}),300))},show:function show(){this.canInteract&&(!0===un?rt.show():(et.style.display="block",et.style.visibility="visible"))},hide:function hide(){this.canInteract&&(!0===un?rt.hide():(et.style.display="none",et.style.visibility="hidden"))},enableAds:function enableAds(){var o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];vn.adsEnabled=o},get duration(){return et&&(isNaN(et.duration)?1/0:et.duration)},get currentTime(){return et&&et.currentTime},get muted(){return et&&et.muted},get looped(){return et&&et.loop},get src(){return et&&et.getAttribute("src")},get playing(){return vn.playing},get playingAds(){return vn.playingAds},get canInteract(){return!1===vn.playingAds},get top(){return et&&parseFloat(et.style.top)},get left(){return et&&parseFloat(et.style.left)},get bottom(){return et&&parseFloat(et.style.top-et.style.height)},get right(){return et&&parseFloat(et.style.left-et.style.width)},get width(){return et&&parseFloat(et.style.width)},get height(){return et&&parseFloat(et.style.height)},get visible(){return!0===un?rt.isVisible:et&&"block"===et.style.display},get adsEnabled(){return vn.adsEnabled},get _videoEl(){return et},get _consumer(){return at}};!function(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},m=!1,_=function doSetup(){!1===m&&(s(),m=!0)};Object.keys(o).reduce((function(s,m){return"function"==typeof o[m]?s[m]=function(){return _(),o[m].apply(o,arguments)}:"function"==typeof Object.getOwnPropertyDescriptor(o,m).get?s.__defineGetter__(m,(function(){return _(),Object.getOwnPropertyDescriptor(o,m).get.apply(o)})):"function"==typeof Object.getOwnPropertyDescriptor(o,m).set?s.__defineSetter__(m,(function(){return _(),Object.getOwnPropertyDescriptor(o,m).set.sourceObject[m].apply(o,arguments)})):s[m]=o[m],s}),{})}(Gn,(function(){sn=Ee&&Ee.stage&&Ee.stage.getRenderPrecision()||sn,et=function setupVideoTag(){var o=document.getElementsByTagName("video");if(o&&o.length)return o[0];var s=document.createElement("video"),m=Se.get("platform","width")?Se.get("platform","width"):1920,_=Se.get("platform","height")?Se.get("platform","height"):1080;return s.setAttribute("id","video-player"),s.setAttribute("width",Cn(m)),s.setAttribute("height",Cn(_)),s.style.position="absolute",s.style.zIndex="1",s.style.display="none",s.style.visibility="hidden",s.style.top=Cn(0),s.style.left=Cn(0),s.style.width=Cn(m),s.style.height=Cn(_),document.body.appendChild(s),s}(),!0===(un=Se.get("platform","textureMode",!1))&&(et.setAttribute("crossorigin","anonymous"),rt=function setUpVideoTexture(){if(!Ee.tag("VideoTexture")){var o=Ee.stage.c({type:function(o){_inherits$1(VideoTexture,o);var s=_createSuper$1(VideoTexture);function VideoTexture(){return _classCallCheck$1(this,VideoTexture),s.apply(this,arguments)}return _createClass$1(VideoTexture,[{key:"videoEl",get:function get(){return this._videoEl},set:function set(o){this._videoEl=o}},{key:"videoView",get:function get(){return this.tag("Video")}},{key:"videoTexture",get:function get(){return this.videoView.texture}},{key:"isVisible",get:function get(){return 1===this.videoView.alpha&&!0===this.videoView.visible}},{key:"_init",value:function _init(){this._createVideoTexture()}},{key:"_createVideoTexture",value:function _createVideoTexture(){var o=this.stage.gl,s=o.createTexture();o.bindTexture(o.TEXTURE_2D,s),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),this.videoTexture.options={source:s,w:this.videoEl.width,h:this.videoEl.height},this.videoView.w=this.videoEl.width/this.stage.getRenderPrecision(),this.videoView.h=this.videoEl.height/this.stage.getRenderPrecision()}},{key:"start",value:function start(){var o=this,s=this.stage;this._lastTime=0,this._updateVideoTexture||(this._updateVideoTexture=function(){if(o.videoTexture.options.source&&o.videoEl.videoWidth&&o.active){var m=s.gl,_=(new Date).getTime(),S=o.videoEl.getVideoPlaybackQuality(),E=S?S.totalVideoFrames:o.videoEl.webkitDecodedFrameCount;if(E?o._lastFrame!==E:o._lastTime<_-30){o._lastTime=_,o._lastFrame=E;try{m.bindTexture(m.TEXTURE_2D,o.videoTexture.options.source),m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,o.videoEl),o._lastFrame=o.videoEl.webkitDecodedFrameCount,o.videoView.visible=!0,o.videoTexture.options.w=o.videoEl.width,o.videoTexture.options.h=o.videoEl.height;var A=o.videoView.w/o.videoView.h,O=o.videoEl.width/o.videoEl.height;A>O?(o.videoView.scaleX=O/A,o.videoView.scaleY=1):(o.videoView.scaleY=A/O,o.videoView.scaleX=1)}catch(s){_e.error("texImage2d video",s),o.stop()}o.videoTexture.source.forceRenderUpdate()}}}),this._updatingVideoTexture||(s.on("frameStart",this._updateVideoTexture),this._updatingVideoTexture=!0)}},{key:"stop",value:function stop(){var o=this.stage;if(o.removeListener("frameStart",this._updateVideoTexture),this._updatingVideoTexture=!1,this.videoView.visible=!1,this.videoTexture.options.source){var s=o.gl;s.bindTexture(s.TEXTURE_2D,this.videoTexture.options.source),s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT)}}},{key:"position",value:function position(o,s){this.videoView.patch({smooth:{x:s,y:o}})}},{key:"size",value:function size(o,s){this.videoView.patch({smooth:{w:o,h:s}})}},{key:"show",value:function show(){this.videoView.setSmooth("alpha",1)}},{key:"hide",value:function hide(){this.videoView.setSmooth("alpha",0)}}],[{key:"_template",value:function _template(){return{Video:{alpha:1,visible:!1,pivot:.5,texture:{type:$e.textures.StaticTexture,options:{}}}}}}]),VideoTexture}($e.Component),ref:"VideoTexture",zIndex:0,videoEl:et});Ee.childList.addAt(o,0)}return Ee.tag("VideoTexture")}())}));var qn=function getAds(){return Promise.resolve({prerolls:[],midrolls:[],postrolls:[]})},ar={active:!1},vr=function playAd(o){return new Promise((function(s){if(!1===ar.active)return S.info("Ad","Skipping add due to inactive state"),s();var m=document.getElementsByTagName("video")[0];m.style.display="block",m.style.visibility="visible",m.src=rn(o.url),m.load();var _,E=null,A=function cleanup(){Object.keys(O).forEach((function(o){return m.removeEventListener(o,O[o])})),s()},O={play:function play(){S.info("Ad","Play ad",o.url),wr("Play",o),_r(o.callbacks,"defaultImpression")},ended:function ended(){wr("Ended",o),_r(o.callbacks,"complete"),A()},timeupdate:function timeupdate(){!E&&m.duration&&(E={firstQuartile:m.duration/4,midPoint:m.duration/2,thirdQuartile:m.duration/4*3},S.info("Ad","Calculated quartiles times",{timeEvents:E})),E&&E.firstQuartile&&m.currentTime>=E.firstQuartile&&(wr("FirstQuartile",o),delete E.firstQuartile,_r(o.callbacks,"firstQuartile")),E&&E.midPoint&&m.currentTime>=E.midPoint&&(wr("MidPoint",o),delete E.midPoint,_r(o.callbacks,"midPoint")),E&&E.thirdQuartile&&m.currentTime>=E.thirdQuartile&&(wr("ThirdQuartile",o),delete E.thirdQuartile,_r(o.callbacks,"thirdQuartile"))},stalled:function stalled(){wr("Stalled",o),_=setTimeout((function(){A()}),5e3)},canplay:function canplay(){_&&clearTimeout(_)},error:function error(){wr("Error",o),A()},abort:function abort(){A()}};Object.keys(O).forEach((function(o){return m.addEventListener(o,O[o])})),m.play()}))},_r=function sendBeacon(o,s){if(o&&o[s])return S.info("Ad","Sending beacon",s,o[s]),o[s].reduce((function(o,m){return o.then((function(){return fetch(m).then((function(o){200===o.status?wr("Beacon"+s+"Sent"):wr("Beacon"+s+"Failed"+o.status),Promise.resolve(null)})).catch((function(){Promise.resolve(null)}))}))}),Promise.resolve(null));S.info("Ad","No callback found for "+s)},wr=function fireOnConsumer(o,s){ot&&(ot.fire("$ad"+o,s),ot.fire("$adEvent",o,s))},Pr={get:function get(o,s){return!1===o.enabled?Promise.resolve({prerolls:function prerolls(){return Promise.resolve()}}):(ot=s,new Promise((function(s){S.info("Ad","Starting session"),qn(o).then((function(o){S.info("Ad","API result",o),s({prerolls:function prerolls(){return o.preroll?(ar.active=!0,wr("PrerollSlotImpression",o),_r(o.preroll.callbacks,"slotImpression"),function playSlot(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(o,s){return o.then((function(){return vr(s)}))}),Promise.resolve(null))}(o.preroll.ads).then((function(){wr("PrerollSlotEnd",o),_r(o.preroll.callbacks,"slotEnd"),ar.active=!1}))):Promise.resolve()},midrolls:function midrolls(){return Promise.resolve()},postrolls:function postrolls(){return Promise.resolve()}})}))})))},cancel:function cancel(){S.info("Ad","Cancel Ad"),ar.active=!1},stop:function stop(){S.info("Ad","Stop Ad"),ar.active=!1;var o=document.getElementsByTagName("video")[0];o.pause(),o.removeAttribute("src")}},Or="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs$1(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function getAugmentedNamespace(o){if(o.__esModule)return o;var s=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(o).forEach((function(m){var _=Object.getOwnPropertyDescriptor(o,m);Object.defineProperty(s,m,_.get?_:{enumerable:!0,get:function(){return o[m]}})})),s}var Vr=function isMergeableObject(o){return function isNonNullObject(o){return!!o&&"object"==typeof o}(o)&&!function isSpecial(o){var s=Object.prototype.toString.call(o);return"[object RegExp]"===s||"[object Date]"===s||function isReactElement(o){return o.$$typeof===oi}(o)}(o)};var oi="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function cloneUnlessOtherwiseSpecified(o,s){return!1!==s.clone&&s.isMergeableObject(o)?deepmerge(function emptyTarget(o){return Array.isArray(o)?[]:{}}(o),o,s):o}function defaultArrayMerge(o,s,m){return o.concat(s).map((function(o){return cloneUnlessOtherwiseSpecified(o,m)}))}function getKeys(o){return Object.keys(o).concat(function getEnumerableOwnPropertySymbols(o){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(o).filter((function(s){return Object.propertyIsEnumerable.call(o,s)})):[]}(o))}function propertyIsOnObject(o,s){try{return s in o}catch(o){return!1}}function mergeObject(o,s,m){var _={};return m.isMergeableObject(o)&&getKeys(o).forEach((function(s){_[s]=cloneUnlessOtherwiseSpecified(o[s],m)})),getKeys(s).forEach((function(S){(function propertyIsUnsafe(o,s){return propertyIsOnObject(o,s)&&!(Object.hasOwnProperty.call(o,s)&&Object.propertyIsEnumerable.call(o,s))})(o,S)||(propertyIsOnObject(o,S)&&m.isMergeableObject(s[S])?_[S]=function getMergeFunction(o,s){if(!s.customMerge)return deepmerge;var m=s.customMerge(o);return"function"==typeof m?m:deepmerge}(S,m)(o[S],s[S],m):_[S]=cloneUnlessOtherwiseSpecified(s[S],m))})),_}function deepmerge(o,s,m){(m=m||{}).arrayMerge=m.arrayMerge||defaultArrayMerge,m.isMergeableObject=m.isMergeableObject||Vr,m.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var _=Array.isArray(s);return _===Array.isArray(o)?_?m.arrayMerge(o,s,m):mergeObject(o,s,m):cloneUnlessOtherwiseSpecified(s,m)}deepmerge.all=function deepmergeAll(o,s){if(!Array.isArray(o))throw new Error("first argument should be an array");return o.reduce((function(o,m){return deepmerge(o,m,s)}),{})};var li=deepmerge;
/*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   */
function isObject$6(o){return"[object Object]"===Object.prototype.toString.call(o)}function isPlainObject$1(o){var s,m;return!1!==isObject$6(o)&&(void 0===(s=o.constructor)||!1!==isObject$6(m=s.prototype)&&!1!==m.hasOwnProperty("isPrototypeOf"))}var hi,gi,_i,bi=!1,Ui=function deprecated(){!0!==(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&!1!==bi||console.warn(["The 'Locale'-plugin in the Lightning-SDK is deprecated and will be removed in future releases.","Please consider using the new 'Language'-plugin instead.","https://rdkcentral.github.io/Lightning-SDK/#/plugins/language"].join("\n\n")),bi=!0},ta=function(){function Locale(){_classCallCheck$1(this,Locale),this.__enabled=!1}var o;return _createClass$1(Locale,[{key:"load",value:(o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){var s=this;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if(this.__enabled){m.next=2;break}return m.abrupt("return");case 2:return m.next=4,fetch(o).then((function(o){return o.json()})).then((function(o){s.loadFromObject(o)}));case 4:case"end":return m.stop()}}),_callee,this)}))),function load(s){return o.apply(this,arguments)})},{key:"setLanguage",value:function setLanguage(o){Ui(),this.__enabled=!0,this.language=o}},{key:"tr",get:function get(){return Ui(!0),this.__trObj[this.language]}},{key:"loadFromObject",value:function loadFromObject(o){Ui();var s="en";if(-1===Object.keys(o).indexOf(this.language)){if(S.warn("No translations found for: "+this.language),!(Object.keys(o).indexOf(s)>-1)){var m="No translations found for fallback language: en";throw S.error(m),Error(m)}S.warn("Using fallback language: en"),this.language=s}this.__trObj=o;for(var _=0,E=Object.values(this.__trObj);_<E.length;_++)for(var A=E[_],O=0,H=Object.keys(A);O<H.length;O++){var K=H[O];A[K]=new na(A[K])}}}]),Locale}(),na=function(o){_inherits$1(LocalizedString,o);var s=_createSuper$1(LocalizedString);function LocalizedString(){return _classCallCheck$1(this,LocalizedString),s.apply(this,arguments)}return _createClass$1(LocalizedString,[{key:"format",value:function format(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];var _=s.reduce((function(o,s,m){return o.split("{".concat(m,"}")).join(s)}),this);return new LocalizedString(_)}}]),LocalizedString}(_wrapNativeSuper(String)),aa=new ta,oa=function(o){_inherits$1(VersionLabel,o);var s=_createSuper$1(VersionLabel);function VersionLabel(){return _classCallCheck$1(this,VersionLabel),s.apply(this,arguments)}return _createClass$1(VersionLabel,[{key:"_firstActive",value:function _firstActive(){this.tag("Text").text="APP - v".concat(this.version,"\nSDK - v").concat(this.sdkVersion),this.tag("Text").loadTexture(),this.w=this.tag("Text").renderWidth+40,this.h=this.tag("Text").renderHeight+5}}],[{key:"_template",value:function _template(){return{rect:!0,color:3137370284,h:40,w:100,x:function x(o){return o-50},y:function y(o){return o-50},mount:1,Text:{w:function w(o){return o},h:function h(o){return o},y:5,x:20,text:{fontSize:22,lineHeight:26}}}}}]),VersionLabel}(E.Component),la=function(o){_inherits$1(FpsIndicator,o);var s=_createSuper$1(FpsIndicator);function FpsIndicator(){return _classCallCheck$1(this,FpsIndicator),s.apply(this,arguments)}return _createClass$1(FpsIndicator,[{key:"_setup",value:function _setup(){var o=this;this.config=_objectSpread2(_objectSpread2({},{log:!1,interval:500,threshold:1}),m.get("platform","showFps")),this.fps=0,this.lastFps=this.fps-this.config.threshold;var s=function fpsCalculator(){o.fps=~~(1/o.stage.dt)};this.stage.on("frameStart",s),this.stage.off("framestart",s),this.interval=setInterval(this.showFps.bind(this),this.config.interval)}},{key:"_firstActive",value:function _firstActive(){this.showFps()}},{key:"_detach",value:function _detach(){clearInterval(this.interval)}},{key:"showFps",value:function showFps(){if(!(Math.abs(this.lastFps-this.fps)<=this.config.threshold)){this.lastFps=this.fps;var o=4278222848;this.fps<=40&&this.fps>20?o=4294944e3:this.fps<=20&&(o=4294901760),this.tag("Background").setSmooth("color",o),this.tag("Counter").text="".concat(this.fps),this.config.log&&S.info("FPS",this.fps)}}}],[{key:"_template",value:function _template(){return{rect:!0,color:4294967295,texture:E.Tools.getRoundRect(80,80,40),h:80,w:80,x:100,y:100,mount:1,Background:{x:3,y:3,texture:E.Tools.getRoundRect(72,72,36),color:4278222848},Counter:{w:function w(o){return o},h:function h(o){return o},y:10,text:{fontSize:32,textAlign:"center"}},Text:{w:function w(o){return o},h:function h(o){return o},y:48,text:{fontSize:15,textAlign:"center",text:"FPS"}}}}}]),FpsIndicator}(E.Component),fetchJson=function(o){return new Promise((function(s,m){var _=new XMLHttpRequest;_.onreadystatechange=function(){_.readyState==XMLHttpRequest.DONE&&(0===_.status||200===_.status?s(JSON.parse(_.responseText)):m(_.statusText))},_.open("GET",o),_.send(null)}))},ca={asset:function asset(o){return hi+o},proxyUrl:function proxyUrl(o){return gi?gi+"?"+ga(o,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}):o},makeQueryString:function makeQueryString(){return ga.apply(void 0,arguments)},ensureUrlWithProtocol:function ensureUrlWithProtocol(){return da.apply(void 0,arguments)}},da=function _ensureUrlWithProtocol(o){return/^\/[^/]/i.test(o)&&/^(?:file:)/i.test(window.location.protocol)?window.location.protocol+"//"+o:/^\/\//.test(o)?window.location.protocol+o:/^(?:https?:)/i.test(o)?o:window.location.origin+o},pa=function makeFullStaticPath(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",s=arguments.length>1?arguments[1]:void 0;return s="/"!==s.charAt(s.length-1)?s+"/":s,/^(?:https?:)?(?:\/\/)/.test(s)||"/"===s.charAt(0)?s:(o=fa(o))+(s="/"!==(s="."===s.charAt(0)?s.substr(1):s).charAt(0)?"/"+s:s)},fa=function cleanUpPathName(o){if("/"===o.slice(-1))return o.slice(0,-1);var s=o.split("/");return s[s.length-1].indexOf(".")>-1&&s.pop(),s.join("/")},ga=function _makeQueryString(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"url";return s.operator="metrological",s[m]=o,Object.keys(s).map((function(o){return encodeURIComponent(o)+"="+encodeURIComponent(""+s[o])})).join("&")},ma={},_a={},Sa=null,ka=function initLanguage(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(m,_){fetchJson(o).then((function(o){xa(o),"object"==typeof s&&"then"in s&&"function"==typeof s.then?s.then((function(o){return Da(o).then(m).catch(_)})).catch((function(o){S.error(o),_(o)})):Da(s).then(m).catch(_)})).catch((function(){var s="Language file "+o+" not found";S.error(s),_(s)}))}))},xa=function setTranslations(o){"meta"in o&&(ma=_objectSpread2({},o.meta),delete o.meta),_a=o},Da=function setLanguage(o){return Sa=null,new Promise((function(s,m){if(o in _a)Sa=o;else if("map"in ma&&o in ma.map&&ma.map[o]in _a)Sa=ma.map[o];else if("default"in ma&&ma.default in _a){var _="Translations for Language "+Sa+" not found. Using default language "+ma.default;S.warn(_),Sa=ma.default}else{var E="Translations for Language "+Sa+" not found.";S.error(E),m(E)}if(Sa){S.info("Setting language to",Sa);var A=_a[Sa];if("object"==typeof A)s();else if("string"==typeof A){var O=ca.asset(A);fetchJson(O).then((function(o){_a[Sa]=o,s()})).catch((function(o){var s="Error while fetching "+O;S.error(s,o),m(s)}))}}}))},Ra={eventListeners:[],timeouts:[],intervals:[],targets:[]},ja={setTimeout:function(o){function setTimeout(s,m){return o.apply(this,arguments)}return setTimeout.toString=function(){return o.toString()},setTimeout}((function(o,s){for(var m=arguments.length,_=new Array(m>2?m-2:0),E=2;E<m;E++)_[E-2]=arguments[E];var A=setTimeout((function(){Ra.timeouts=Ra.timeouts.filter((function(o){return o!==A})),o.apply(null,_)}),s,_);return S.info("Set Timeout","ID: "+A),Ra.timeouts.push(A),A})),clearTimeout:function(o){function clearTimeout(s){return o.apply(this,arguments)}return clearTimeout.toString=function(){return o.toString()},clearTimeout}((function(o){Ra.timeouts.indexOf(o)>-1?(Ra.timeouts=Ra.timeouts.filter((function(s){return s!==o})),S.info("Clear Timeout","ID: "+o),clearTimeout(o)):S.error("Clear Timeout","ID "+o+" not found")})),clearTimeouts:function clearTimeouts(){var o=this;Ra.timeouts.forEach((function(s){o.clearTimeout(s)}))},setInterval:function(o){function setInterval(s,m){return o.apply(this,arguments)}return setInterval.toString=function(){return o.toString()},setInterval}((function(o,s){for(var m=arguments.length,_=new Array(m>2?m-2:0),E=2;E<m;E++)_[E-2]=arguments[E];var A=setInterval((function(){Ra.intervals.filter((function(o){return o!==A})),o.apply(null,_)}),s,_);return S.info("Set Interval","ID: "+A),Ra.intervals.push(A),A})),clearInterval:function(o){function clearInterval(s){return o.apply(this,arguments)}return clearInterval.toString=function(){return o.toString()},clearInterval}((function(o){Ra.intervals.indexOf(o)>-1?(Ra.intervals=Ra.intervals.filter((function(s){return s!==o})),S.info("Clear Interval","ID: "+o),clearInterval(o)):S.error("Clear Interval","ID "+o+" not found")})),clearIntervals:function clearIntervals(){var o=this;Ra.intervals.forEach((function(s){o.clearInterval(s)}))},addEventListener:function addEventListener(o,s,m){o.addEventListener(s,m);var _=Ra.targets.indexOf(o)>-1?Ra.targets.indexOf(o):Ra.targets.push(o)-1;Ra.eventListeners[_]=Ra.eventListeners[_]||{},Ra.eventListeners[_][s]=Ra.eventListeners[_][s]||[],Ra.eventListeners[_][s].push(m),S.info("Add eventListener","Target:",o,"Event: "+s,"Handler:",m.toString())},removeEventListener:function removeEventListener(o,s,m){var _=Ra.targets.indexOf(o);_>-1&&Ra.eventListeners[_]&&Ra.eventListeners[_][s]&&Ra.eventListeners[_][s].indexOf(m)>-1?(Ra.eventListeners[_][s]=Ra.eventListeners[_][s].filter((function(o){return o!==m})),S.info("Remove eventListener","Target:",o,"Event: "+s,"Handler:",m.toString()),o.removeEventListener(s,m),Object.keys(Ra.eventListeners[_]).forEach((function(o){0===Ra.eventListeners[_][o].length&&delete Ra.eventListeners[_][o]})),0===Object.keys(Ra.eventListeners[_]).length&&(Ra.targets.splice(_,1),Ra.eventListeners.splice(_,1))):S.error("Remove eventListener","Not found","Target",o,"Event: "+s,"Handler",m.toString())},removeEventListeners:function removeEventListeners(o,s){var m=this;if(o&&s){var _=Ra.targets.indexOf(o);_>-1&&Ra.eventListeners[_][s].forEach((function(_){m.removeEventListener(o,s,_)}))}else if(o){var S=Ra.targets.indexOf(o);S>-1&&Object.keys(Ra.eventListeners[S]).forEach((function(s){m.removeEventListeners(o,s)}))}else Object.keys(Ra.eventListeners).forEach((function(o){m.removeEventListeners(Ra.targets[o])}))},clear:function clear(){this.clearTimeouts(),this.clearIntervals(),this.removeEventListeners(),Ra.eventListeners=[],Ra.timeouts=[],Ra.intervals=[],Ra.targets=[]}},Va={white:"#ffffff",black:"#000000",red:"#ff0000",green:"#00ff00",blue:"#0000ff",yellow:"#feff00",cyan:"#00feff",magenta:"#ff00ff"},za={},qa=function addColors(o,s){!function isObject(o){return"object"==typeof o&&null!==o}(o)?function isString(o){return"string"==typeof o}(o)&&s&&(Qa(o),Va[o]=s):(Object.keys(o).forEach((function(o){return Qa(o)})),Va=Object.assign({},Va,o))},Qa=function cleanUpNormalizedColors(o){for(var s in za)s.indexOf(o)>-1&&delete za[s]},Za=function initColors(o){return new Promise((function(s,m){if("object"==typeof o)return qa(o),s();fetchJson(o).then((function(o){return qa(o),s()})).catch((function(){var s="Colors file "+o+" not found";return S.error(s),m(s)}))}))},ro={name:"@lightningjs/sdk",version:"5.4.1",license:"Apache-2.0",types:"index.d.ts",scripts:{postinstall:"node ./scripts/postinstall.js",lint:"eslint '**/*.js'",release:"npm publish --access public",typedoc:"typedoc --tsconfig tsconfig.typedoc.json",tsd:"tsd"},"lint-staged":{"*.js":["eslint --fix"],"src/startApp.js":["rollup -c ./rollup.config.js"]},husky:{hooks:{"pre-commit":"lint-staged"}},dependencies:{"@babel/polyfill":"^7.11.5","@lightningjs/core":"^2.7.0","@metrological/sdk":"^1.0.0","@michieljs/execute-as-promise":"^1.0.0",deepmerge:"^4.2.2","is-plain-object":"^5.0.0",localcookies:"^2.0.0",shelljs:"^0.8.5","url-polyfill":"^1.1.10","whatwg-fetch":"^3.0.0"},devDependencies:{"@babel/core":"^7.11.6","@babel/plugin-transform-parameters":"^7.10.5 ","@babel/plugin-transform-spread":"^7.11.0","@babel/preset-env":"^7.11.5","babel-eslint":"^10.1.0",eslint:"^7.10.0","eslint-config-prettier":"^6.12.0","eslint-plugin-prettier":"^3.1.4",husky:"^4.3.0","lint-staged":"^10.4.0",prettier:"^1.19.1",rollup:"^1.32.1","rollup-plugin-babel":"^4.4.0",tsd:"^0.22.0",typedoc:"^0.23.9"},repository:{type:"git",url:"git@github.com:rdkcentral/Lightning-SDK.git"},bugs:{url:"https://github.com/rdkcentral/Lightning-SDK/issues"}},oo={stage:{w:1920,h:1080,precision:1,clearColor:0,canvas2d:!1},debug:!1,defaultFontFace:"RobotoRegular",keys:{8:"Back",13:"Enter",27:"Menu",37:"Left",38:"Up",39:"Right",40:"Down",174:"ChannelDown",175:"ChannelUp",178:"Stop",250:"PlayPause",191:"Search",409:"Search"}},lo=[],ho=function fontLoader(o,s){return new Promise((function(m,_){o.map((function(o){var m=o.family,_=o.url,E=o.urls,A=o.descriptors;return function(){var o=E?E.map((function(o){return"url("+o+")"})):"url("+_+")",O=new FontFace(m,o,A||{});return s.push(O),S.info("Loading font",m),document.fonts.add(O),O.load()}})).reduce((function(o,s){return o.then((function(){return s()}))}),Promise.resolve(null)).then(m).catch(_)}))};E.textures.ImageTexture;E.Component;var po,_o,So,To,Co,Eo,Io,Lo,Do,Oo,Fo,No,Bo,Vo=function(){function localCookie(o){return _classCallCheck$1(this,localCookie),o=o||{},this.forceCookies=o.forceCookies||!1,!0===this._checkIfLocalStorageWorks()&&!0!==o.forceCookies?{getItem:this._getItemLocalStorage,setItem:this._setItemLocalStorage,removeItem:this._removeItemLocalStorage,clear:this._clearLocalStorage,keys:this._getLocalStorageKeys}:{getItem:this._getItemCookie,setItem:this._setItemCookie,removeItem:this._removeItemCookie,clear:this._clearCookies,keys:this._getCookieKeys}}return _createClass$1(localCookie,[{key:"_checkIfLocalStorageWorks",value:function _checkIfLocalStorageWorks(){if("undefined"==typeof localStorage)return!1;try{return localStorage.setItem("feature_test","yes"),"yes"===localStorage.getItem("feature_test")&&(localStorage.removeItem("feature_test"),!0)}catch(o){return!1}}},{key:"_getItemLocalStorage",value:function _getItemLocalStorage(o){return window.localStorage.getItem(o)}},{key:"_setItemLocalStorage",value:function _setItemLocalStorage(o,s){return window.localStorage.setItem(o,s)}},{key:"_removeItemLocalStorage",value:function _removeItemLocalStorage(o){return window.localStorage.removeItem(o)}},{key:"_clearLocalStorage",value:function _clearLocalStorage(){return window.localStorage.clear()}},{key:"_getLocalStorageKeys",value:function _getLocalStorageKeys(){return Object.keys(window.localStorage)}},{key:"_getItemCookie",value:function _getItemCookie(o){var s=document.cookie.match(RegExp("(?:^|;\\s*)"+function(o){return o.replace(/([.*+?\^${}()|\[\]\/\\])/g,"\\$1")}(o)+"=([^;]*)"));return s&&""===s[1]&&(s[1]=null),s?s[1]:null}},{key:"_setItemCookie",value:function _setItemCookie(o,s){var m=new Date,_=new Date(m.getTime()+15768e7);document.cookie="".concat(o,"=").concat(s,"; expires=").concat(_.toUTCString(),";")}},{key:"_removeItemCookie",value:function _removeItemCookie(o){document.cookie="".concat(o,"=;Max-Age=-99999999;")}},{key:"_clearCookies",value:function _clearCookies(){document.cookie.split(";").forEach((function(o){document.cookie=o.replace(/^ +/,"").replace(/=.*/,"=;expires=Max-Age=-99999999")}))}},{key:"_getCookieKeys",value:function _getCookieKeys(){return document.cookie.split(";").map((function(o){return o.split("=")[0]}))}}]),localCookie}(),Ho=/\{\/(.*?)\/([igm]{0,3})\}/g,Go=/^[!*$]$/,qo=/\/:\w+?@@([0-9]+?)@@/,Qo=/^\/:/,as=function stripRegex(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"R";return Ho.test(o)&&(o=o.replace(Ho,s)),o},_s=function(){function Request(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1?arguments[1]:void 0,m=arguments.length>2?arguments[2]:void 0;_classCallCheck$1(this,Request),this._hash=o,this._storeCaller=m,this._register=new Map,this._isCreated=!1,this._isSharedInstance=!1,this._cancelled=!1,this._copiedHistoryState=null,qh(s)?this._register=function createRegister(o){var s=new Map;return[].concat(_toConsumableArray$1(Object.keys(o)),_toConsumableArray$1(Object.getOwnPropertySymbols(o))).forEach((function(m){s.set(m,o[m])})),s}(s):np(s)&&(this._storeCaller=s),this._register.set(Wp.store,this._storeCaller)}return _createClass$1(Request,[{key:"cancel",value:function cancel(){S.debug("[router]:","cancelled ".concat(this._hash)),this._cancelled=!0}},{key:"url",get:function get(){return this._hash}},{key:"register",get:function get(){return this._register}},{key:"hash",get:function get(){return this._hash},set:function set(o){this._hash=o}},{key:"route",get:function get(){return this._route},set:function set(o){this._route=o}},{key:"provider",get:function get(){return this._provider},set:function set(o){this._provider=o}},{key:"providerType",get:function get(){return this._providerType},set:function set(o){this._providerType=o}},{key:"page",get:function get(){return this._page},set:function set(o){this._page=o}},{key:"isCreated",get:function get(){return this._isCreated},set:function set(o){this._isCreated=o}},{key:"isSharedInstance",get:function get(){return this._isSharedInstance},set:function set(o){this._isSharedInstance=o}},{key:"isCancelled",get:function get(){return this._cancelled}},{key:"copiedHistoryState",get:function get(){return this._copiedHistoryState},set:function set(o){this._copiedHistoryState=o}}]),Request}(),ws=function(){function Route(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck$1(this,Route);var s=["on","before","after"].reduce((function(s,m){return kh(o[m])?m:s}),void 0);this._cfg=o,s&&(this._provider={type:s,request:o[s]})}return _createClass$1(Route,[{key:"path",get:function get(){return this._cfg.path}},{key:"name",get:function get(){return this._cfg.name}},{key:"component",get:function get(){return this._cfg.component}},{key:"options",get:function get(){return this._cfg.options}},{key:"widgets",get:function get(){return this._cfg.widgets}},{key:"cache",get:function get(){return this._cfg.cache}},{key:"hook",get:function get(){return this._cfg.hook}},{key:"beforeNavigate",get:function get(){return this._cfg.beforeNavigate}},{key:"provider",get:function get(){return this._provider}}]),Route}(),Os=function getFloor(o){return as(o).split("/").length},Us=function getRouteByHash(o){o=o.replace(/^#/,"");var s=/(\/?:?[^/]+)/g,m=function getRoutesByFloor(o){var s,m=[],_=_createForOfIteratorHelper(Ec.entries());try{for(_.s();!(s=_.n()).done;){var S=_slicedToArray$1(s.value,1)[0];Os(S)===o&&m.push(S)}}catch(o){_.e(o)}finally{_.f()}return m}(Os(o)),_=o.match(s)||[],S=[],E=m.filter((function(o){var m=!0;if(Ho.test(o)){var E=o.match(Ho);E&&E.length&&(o=E.reduce((function(o,s){var m=S.length;return o=o.replace(s,"@@".concat(m,"@@")),S.push(s.substring(1,s.length-1)),o}),o))}for(var A=o.match(s)||[],O=0,H=A.length;O<H;O++){var K=A[O],z=_[O];if(qo.test(K)){var G=qo.exec(K)[1],q=S[G],X=/\/([^\/]+)\/([igm]{0,3})/.exec(q);if(X&&X.length){var J=X[1],ae=X[2];new RegExp("^/".concat(J,"$"),ae).test(z)||(m=!1)}}else{if(Qo.test(K))continue;z&&K.toLowerCase()!==z.toLowerCase()&&(m=!1)}}return m}));if(E.length){if(-1!==E.indexOf(o)){var A=E[E.indexOf(o)];return Ec.get(A)}if(E=E.sort((function(o){return Qo.test(o)?-1:1})),hh(E[0]))return Ec.get(E[0])}return!1},Bs=function getValuesFromHash(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1?arguments[1]:void 0;s=as(s,"");var m=/(\/?:?[\w%\s:.-]+)/g,_=o.match(m)||[],S=s.match(m)||[],E=/^\/:([\w-]+)\/?/;return S.reduce((function(o,s,m){var S=E.exec(s);return S&&S.length&&o.set(S[1],decodeURIComponent(_[m].replace(/^\//,""))),o}),new Map)},Hs=function getOption(o,s){if(o&&o.hasOwnProperty(s))return o[s]},Ys=function getRouteByName(o){var s,m=_createForOfIteratorHelper(Ec.entries());try{for(m.s();!(s=m.n()).done;){var _=_slicedToArray$1(s.value,2),S=_[0];if(_[1].name===o)return S}}catch(o){m.e(o)}finally{m.f()}return!1},emit$2=function(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};yp(s)||(s=[s]),s.forEach((function(s){var _="_on".concat(vp(s));kh(o[_])&&o[_](m)}))},Zs=null,pu=function getReferences(){if(Eo)return Eo.get().reduce((function(o,s){return o[s.ref.toLowerCase()]=s,o}),{})},_u=function restoreFocus(){Zs=null,_o._setState("")},vl=function getActiveWidget(){return Zs},_l=function setActiveWidget(o){Zs=o},Pl=function createComponent(o,s){return o.c({type:s,visible:!1,widgets:pu()})},Ql=[],nc=function updateHistory(o){var s=Ud();if(s){var m=o.register.get(Wp.store),_=Us(s),S=Hs(_.options,"preventStorage");if(np(m)?m:!S){var E=s.replace(/^\//,""),A=ic(E),O=ac(zd(),o),H=_h();if(-1===A||H.get("storeSameHash"))Ql.push({hash:E,state:O});else{var K=Ql.splice(A,1)[0];Ql.push({hash:K.hash,state:O})}}}},ic=function locationInHistory(o){for(var s=0;s<Ql.length;s++)if(Ql[s].hash===o)return s;return-1},ac=function getStateObject(o,s){if(s.isSharedInstance){if(s.copiedHistoryState)return s.copiedHistoryState}else if(o&&kh(o.historyState))return o.historyState();return null},lc=function getHistory(){return Ql.slice(0)},mc=function setHistory(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];yp(o)&&(Ql=o)},yc=!0,_c=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o,s){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!0);case 1:case"end":return o.stop()}}),_callee)})));return function beforeEachRoute(s,m){return o.apply(this,arguments)}}(),kc=function afterEachRoute(){},Ec=new Map,Ac=new Map,Dc=!1,Mc=null,jc=function bootRouter(o,s){var m=o.appInstance,_=o.routes;s&&ap(s)&&(_o=s),_o||(_o=m||_i),po=_o.application,So=po.childList,To=_o.stage,Co=wp(),function mixin(o){o.pages&&(So=o.pages.childList),o.widgets&&o.widgets.children&&(Eo=o.widgets.childList).forEach((function(o){return o.visible=!1})),o._handleBack=function(o){_y(-1),o.preventDefault()}}(_o),yp(_)?zc(o):kh(_)&&(console.warn("[Router]: Calling Router.route() directly is deprecated."),console.warn("Use object config: https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration"))},zc=function setup(o){Dc||qc(o),o.routes.forEach((function(o){var s=bp(o.path);if(hh(s))console.error("".concat(s," already exists in routes configuration"));else{var m=function createRoute(o){if("$"===o.path){var s={preventStorage:!0};qh(o.options)&&(s=_objectSpread2(_objectSpread2({},o.options),s)),o.options=s,Lo&&(o.after=Lo)}return new ws(o)}(o);if(Ec.set(s,m),m.component){var _=m.component;mp(_)&&(Co.get("lazyCreate")||(_=Pl(To,_),So.a(_))),Ac.set(s,_)}}}))},qc=function init(o){Io=o.root,kh(o.boot)&&(Lo=o.boot),np(o.updateHash)&&(yc=o.updateHash),kh(o.beforeEachRoute)&&(_c=o.beforeEachRoute),kh(o.afterEachRoute)&&(kc=o.afterEachRoute),o.bootComponent&&(console.warn("[Router]: Boot Component is now available as a special router: https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration?id=special-routes"),console.warn("[Router]: setting { bootComponent } property will be deprecated in a future release"),ap(o.bootComponent)?o.routes.push({path:"$",component:o.bootComponent,after:Lo||null,options:{preventStorage:!0}}):console.error("[Router]: ".concat(o.bootComponent," is not a valid boot component"))),o.routes.forEach((function(s){var m=as(s.path);if(/(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*\/:(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\?$/.test(m)){var _=s.path.substring(0,s.path.lastIndexOf("/")),S=s.path.substring(0,s.path.lastIndexOf("?"));s.path=S;var E=_objectSpread2({},s);E.path=_,o.routes.push(E)}})),Dc=!0},Xc=function storeComponent(o,s){Ac.has(o)&&Ac.set(o,s)},_d=function getComponent(o){return Ac.has(o)?Ac.get(o):null},Cd=function mustUpdateLocationHash(){if(!Co||!Co.size)return!1;var o=Co.get("updateHash");return!(np(o)&&!o||np(yc)&&!yc)},Ad=function onRequestResolved(o){var s=o.hash,m=o.route,_=o.register,E=o.page;Hs(m.options,"clearHistory")?mc([]):s&&!Go.test(m.path)&&nc(o),Xc(m.path,E),o.isSharedInstance||!o.isCreated?emit$2(E,"changed"):o.isCreated&&emit$2(E,"mounted"),Eo&&function updateWidgets(o,s){var m=(o||[]).map((function(o){return o.toLowerCase()}));Eo.forEach((function(o){o.visible=-1!==m.indexOf(o.ref.toLowerCase()),o.visible&&emit$2(o,["activated"],s)})),"Widgets"===_o.state&&Zs&&!Zs.visible&&_o._setState("")}(m.widgets,E),zd()&&!o.isSharedInstance&&Rd(Mc,o),_.get(Wp.historyState)&&kh(E.historyState)&&E.historyState(_.get(Wp.historyState)),Vd(E),Do=o.hash,Oo=m.path;var A,O=_createForOfIteratorHelper(Sm.values());try{for(O.s();!(A=O.n()).done;){var H=A.value;H.isCancelled&&H.hash&&Sm.delete(H.hash)}}catch(o){O.e(o)}finally{O.f()}kc(o),S.info("[route]:",m.path),S.info("[hash]:",s)},Rd=function cleanUp(o,s){var m=Oo,_=s.register,S=Co.get("lazyDestroy"),E=Co.get("destroyOnHistoryBack"),A=_.get("keepAlive"),O=!1;_.get(Wp.backtrack)&&(E||S)&&(O=!0),S&&!A&&(O=!0),Oo===s.route.path&&(O=!0),O?(Xc(m,o._routedType||o.constructor),So.remove(o),Co.get("gcOnUnload")&&To.gc()):o.patch({x:0,y:0,scale:1,alpha:1,visible:!1})},Ud=function getActiveHash(){return Do},Vd=function setActivePage(o){Mc=o},zd=function getActivePage(){return Mc},qd=function getActiveRoute(){return Oo},eh=function getLastHash(){return Fo},uh=function getPreviousState(){return No},hh=function routeExists(o){return Ec.has(o)},mh=function getRootHash(){return Io},vh=function getBootRequest(){return Lo},_h=function getRouterConfig(){return Co},bh=function getRoutes(){return Ec},kh=function isFunction(o){return"function"==typeof o},qh=function isObject(o){return"object"==typeof o&&null!==o},np=function isBoolean(o){return"boolean"==typeof o},ap=function isPage(o){return!!(o instanceof E.Element||mp(o))},mp=function isComponentConstructor(o){return o.prototype&&"isComponent"in o.prototype},yp=function isArray(o){return Array.isArray(o)},vp=function ucfirst(o){return"".concat(o.charAt(0).toUpperCase()).concat(o.slice(1))},_p=function isString(o){return"string"==typeof o},bp=function cleanHash(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/^#/,"").replace(/\/+$/,"")},wp=function getConfigMap(){var o=m.get("platform","router"),s=qh(o);return["backtrack","gcOnUnload","destroyOnHistoryBack","lazyCreate","lazyDestroy","reuseInstance","autoRestoreRemote","numberNavigation","updateHash","storeSameHash"].reduce((function(_,S){return _.set(S,s?o[S]:m.get("platform",S)),_}),new Map)},Ip=function getQueryStringParams(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ud(),s=Ay();"$"!==o&&o||!s||_p(s)&&(o=s);var m="",_=/([?&].*)/.exec(o),S={};if(document.location&&document.location.search&&(m=document.location.search),_&&_.length){var E=_[1];m?(E=E.replace(/^\?/,""),m="".concat(m,"&").concat(E)):m=E}if(m){var A,O=_createForOfIteratorHelper(new URLSearchParams(m).entries());try{for(O.s();!(A=O.n()).done;){var H=_slicedToArray$1(A.value,2),K=H[0],z=H[1];S[K]=z}}catch(o){O.e(o)}finally{O.f()}return S}return!1},zp=function objectToQueryString(o){return qh(o)?"?"+Object.keys(o).map((function(s){return"".concat(s,"=").concat(o[s])})).join("&"):""},Wp={route:Symbol("route"),hash:Symbol("hash"),store:Symbol("store"),fromHistory:Symbol("fromHistory"),expires:Symbol("expires"),resume:Symbol("resume"),backtrack:Symbol("backtrack"),historyState:Symbol("historyState"),queryParams:Symbol("queryParams")},Jp={on:function on(o){return function setPreviousState(o){No=o}(_o.state||""),_o._setState("Loading"),af(o)},before:function before(o){return af(o)},after:function after(o){try{af(o,!0)}catch(o){}return Promise.resolve()}},af=function execProvider(o,s){var m=o.route,_=m.provider,S=m.cache?1e3*m.cache:0,E=hf(o);return _.request(o.page,_objectSpread2({},E)).then((function(){o.page[Wp.expires]=Date.now()+S,s&&emit$2(o.page,"dataProvided")})).catch((function(s){throw o.page[Wp.expires]=Date.now(),s}))},hf=function addPersistData(o){var s,m=o.page,_=o.route,S=o.hash,E=o.register,A=void 0===E?new Map:E,O=Bs(S,_.path),H=Ip(S),K={},z=_createForOfIteratorHelper(new Map([].concat(_toConsumableArray$1(O),_toConsumableArray$1(A))));try{for(z.s();!(s=z.n()).done;){var G=_slicedToArray$1(s.value,2),q=G[0],X=G[1];K[q]=X}}catch(o){z.e(o)}finally{z.f()}if(H&&(K[Wp.queryParams]=H),A.size){var J,ae={},pe=_createForOfIteratorHelper(A);try{for(pe.s();!(J=pe.n()).done;){var me=_slicedToArray$1(J.value,2),_e=me[0],Se=me[1];ae[_e]=Se}}catch(o){pe.e(o)}finally{pe.f()}m.persist=ae}return m.params=K,emit$2(m,["urlParams"],K),K},pf=function isPageExpired(o){if(!o[Wp.expires])return!1;var s=o[Wp.expires];return Date.now()>=s},_f=function hasProvider(o){return!!hh(o)&&!!Ec.get(o).provider},Ef=function getProvider(o){if(hh(o.path)){var s=Ec.get(o.path).provider;return{type:s.type,provider:s.request}}},If=function moveOnAxes(o,s,m,_){var S="x"===o?1920:1080;return new Promise((function(E){var A,O;(m.patch((_defineProperty$2(A={},"".concat(o),s?-1*S:S),_defineProperty$2(A,"visible",!0),_defineProperty$2(A,"smooth",_defineProperty$2({},"".concat(o),[0,{duration:.4,delay:.2}])),A)),_)&&_.patch((_defineProperty$2(O={},"".concat(o),0),_defineProperty$2(O,"smooth",_defineProperty$2({},"".concat(o),[s?S:-1*S,{duration:.4,delay:.2}])),O));m.transition(o).on("finish",(function(){E()}))}))},zf={fade:function fade(o,s){return new Promise((function(m){o.patch({alpha:0,visible:!0,smooth:{alpha:[1,{duration:.5,delay:.1}]}}),o.transition("alpha").on("finish",(function(){s&&(s.visible=!1),m()}))}))},crossFade:function crossFade(o,s){return new Promise((function(m){o.patch({alpha:0,visible:!0,smooth:{alpha:[1,{duration:.5,delay:.1}]}}),s&&s.patch({smooth:{alpha:[0,{duration:.5,delay:.3}]}}),o.transition("alpha").on("finish",(function(){m()}))}))},up:function up(o,s){return If("y",0,o,s)},down:function down(o,s){return If("y",1,o,s)},left:function left(o,s){return If("x",0,o,s)},right:function right(o,s){return If("x",1,o,s)}},Jf=function executeTransition(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,m=o.pageTransition||o.easing,_=!!(o.smoothIn||o.smoothInOut||m),S=_h().get("disableTransitions");if(o.easing&&console.warn("easing() method is deprecated and will be removed. Use pageTransition()"),!_||S)return o.visible=!0,s&&(s.visible=!1),Promise.resolve();if(m){var E;try{E=m.call(o,o,s)}catch(o){E="crossFade"}if(function isPromise(o){var s;if(kh(o))try{s=o.apply(null)}catch(o){s=o}else s=o;return qh(s)&&kh(s.then)}(E))return E;if(_p(E)){var A=zf[E];if(A)return A(o,s)}if(o.smoothIn){return o.smoothIn({pageIn:o,smooth:function smooth(s,m){var _=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(S){o.visible=!0,o.setSmooth(s,m,_),o.transition(s).on("finish",(function(){S()}))}))}})}}return zf.crossFade(o,s)},sg=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){var s,m;return _regeneratorRuntime$1().wrap((function _callee$(_){for(;;)switch(_.prev=_.next){case 0:return s=!1,_.prev=1,_.next=4,_g(o);case 4:if(!(o=_.sent)||o.isCancelled){_.next=12;break}if("Loading"===_o.state&&("Widgets"===uh()?_o._setState("Widgets",[vl()]):_o._setState("")),o.isSharedInstance||o.isCancelled){_.next=10;break}return _.next=10,Jf(o.page,zd());case 10:_.next=13;break;case 12:s=!0;case 13:if(!s&&!o.isCancelled){_.next=18;break}S.debug("[router]:","Rejected ".concat(o.hash," because route to ").concat(eh()," started")),o.isCreated&&!o.isSharedInstance&&So.remove(o.page),_.next=20;break;case 18:return Ad(o),_.abrupt("return",o.page);case 20:_.next=25;break;case 22:_.prev=22,_.t0=_.catch(1),_.t0.route?s||(m=_.t0.route,Hs(m.options,"clearHistory")?mc([]):Go.test(m.path)||nc(_.t0),_.t0.isCreated&&!_.t0.isSharedInstance&&So.remove(_.t0.page),$g(_.t0)):console.error(_.t0);case 25:case"end":return _.stop()}}),_callee,null,[[1,22]])})));return function load(s){return o.apply(this,arguments)}}(),_g=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o){var s,m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee2$(G){for(;;)switch(G.prev=G.next){case 0:if(s=o.route,m=o.hash,_=o.register,S=_d(s.path),E=mp(S),A=!1,E||_.get(Wp.backtrack)||lm(s)||(S=S.constructor,E=!0),E?(o.page=Pl(To,S),So.a(o.page),_f(s.path)&&(A=!0),o.isCreated=!0):(o.page=S,_f(s.path)&&(pf(S)||S[Wp.hash]!==m)&&(A=!0),O=zd()&&zd()[Wp.route],s.path===O&&(o.isSharedInstance=!0,kh(o.page.historyState)&&(o.copiedHistoryState=o.page.historyState()))),o.page[Wp.hash]=m,o.page[Wp.route]=s.path,G.prev=10,!A){G.next=25;break}return H=Ef(s),K=H.type,z=H.provider,o.provider=z,o.providerType=K,G.next=17,Jp[K](o);case 17:if(m===eh()){G.next=21;break}return G.abrupt("return",!1);case 21:return"after"!==o.providerType&&emit$2(o.page,"dataProvided"),G.abrupt("return",o);case 23:G.next=27;break;case 25:return hf(o),G.abrupt("return",o);case 27:G.next=33;break;case 29:return G.prev=29,G.t0=G.catch(10),o.error=G.t0,G.abrupt("return",Promise.reject(o));case 33:case"end":return G.stop()}}),_callee2,null,[[10,29]])})));return function loader(s){return o.apply(this,arguments)}}(),$g=function handleError(o){o&&o.error?console.error(o.error):o&&S.error(o),o.page&&hh("!")&&ay("!",{request:o},!1)},lm=function mustReuse(o){var s=Hs(o.options,"reuseInstance"),m=Co.get("reuseInstance");return np(s)?s:!(np(m)&&!1===m)},_m=function(o){_inherits$1(RoutedApp,o);var s=_createSuper$1(RoutedApp);function RoutedApp(){return _classCallCheck$1(this,RoutedApp),s.apply(this,arguments)}return _createClass$1(RoutedApp,[{key:"pages",get:function get(){return this.tag("Pages")}},{key:"widgets",get:function get(){return this.tag("Widgets")}},{key:"_handleBack",value:function _handleBack(){}},{key:"_getFocused",value:function _getFocused(){return Oy.getActivePage()}}],[{key:"_template",value:function _template(){return{Pages:{forceZIndexContext:!0},Loading:{rect:!0,w:1920,h:1080,color:4278190080,visible:!1,zIndex:99,Label:{mount:.5,x:960,y:540,text:{text:"Loading.."}}}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(Loading,o);var s=_createSuper$1(Loading);function Loading(){return _classCallCheck$1(this,Loading),s.apply(this,arguments)}return _createClass$1(Loading,[{key:"$enter",value:function $enter(){this.tag("Loading").visible=!0}},{key:"$exit",value:function $exit(){this.tag("Loading").visible=!1}}]),Loading}(this),function(o){_inherits$1(Widgets,o);var s=_createSuper$1(Widgets);function Widgets(){return _classCallCheck$1(this,Widgets),s.apply(this,arguments)}return _createClass$1(Widgets,[{key:"$enter",value:function $enter(o,s){this._widget=s,this._refocus()}},{key:"_getFocused",value:function _getFocused(){return this._widget}},{key:"reload",value:function reload(o){this._widget=o,this._refocus()}},{key:"_handleKey",value:function _handleKey(){var o=Co.get("autoRestoreRemote");np(o)&&!0!==o||Oy.focusPage()}}]),Widgets}(this)]}}]),RoutedApp}(E.Component),Sm=new Map,zm="",Xm="",Ym=function start(){var o=(Py()||"").replace(/^#/,""),s="$",m=Ip(o),_=vh(),S=mh(),E=-1!==o.indexOf(s);Go.test(o)&&o!==s&&(o=""),Xm=E?S:o||S;var A=function ready(){!o&&S?_p(S)?ay(S):kh(S)&&S().then((function(o){qh(o)?ay(o.path,o.params):ay(o)})):(uy(o),hy().then((function(){_o._refocus()})).catch((function(o){console.error(o)})))};if(hh(s)){if(o&&!E&&!Us(o))return void ay("*",{failedHash:o});ay(s,{resume:Xm,reload:s===o},!1)}else kh(_)?_(m).then((function(){A()})).catch((function(o){Zm(o)})):A()},Zm=function handleBootError(o){hh("!")?ay("!",{request:{error:o}}):console.error(o)},ay=function navigate(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0;if(!qh(o)||(o=function getHashByName(o){if(!o.to&&!o.name)return!1;var s=Ys(o.to||o.name),m=s;if(/\/:([\w-]+)\/?/.test(s)&&(o.params&&(m=Object.keys(o.params).reduce((function(s,m){return s.replace(":".concat(m),o.params[m])}),s)),o.query))return"".concat(m).concat(zp(o.query));return m}(o),o)){var _=Py();!Cd()&&zm&&(_=zm),_.replace(/^#/,"")!==o?(uy(o,s,m),Cd()?Ly(o):(zm=o,hy(o).then((function(){_o._refocus()})).catch((function(o){console.error(o)})))):s.reload&&(uy(o,s,m),hy(o).then((function(){_o._refocus()})).catch((function(o){console.error(o)})))}},uy=function queue(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0;if(o=bp(o),!Sm.has(o)){var _,S=_createForOfIteratorHelper(Sm.values());try{for(S.s();!(_=S.n()).done;){_.value.cancel()}}catch(o){S.e(o)}finally{S.f()}var E=function createRequest(o,s,m){return new _s(o,s,m)}(o,s,m);return Sm.set(decodeURIComponent(o),E),E}return!1},hy=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){var s,m,_,S,E,A;return _regeneratorRuntime$1().wrap((function _callee$(O){for(;;)switch(O.prev=O.next){case 0:if(s=bp(o||Py()),m=decodeURIComponent(s),(_=Sm.get(m))||Sm.size||(_=uy(s)),S=Us(s)){O.next=8;break}return hh("*")?ay("*",{failedHash:s}):console.error("Unable to navigate to: ".concat(s)),O.abrupt("return");case 8:return _.hash=s,_.route=S,O.next=12,_c(Ud(),_);case 12:if(!(E=O.sent)||!S.beforeNavigate){O.next=17;break}return O.next=16,S.beforeNavigate(Ud(),_);case 16:E=O.sent;case 17:if(!np(E)){O.next=22;break}if(!E){O.next=20;break}return O.abrupt("return",vy(_));case 20:O.next=25;break;case 22:_.cancel(),Sm.delete(m),_p(E)?ay(E):qh(E)&&(A=!0,np(E.store)&&(A=E.store),ay(E.path,E.params,A));case 25:case"end":return O.stop()}}),_callee)})));return function handleHashChange(s){return o.apply(this,arguments)}}(),vy=function resolveHashChange(o){var s=o.hash,m=o.route,_=decodeURIComponent(s);if(function setLastHash(o){Fo=o}(s),m.path){var S=_d(m.path);if(kh(m.hook)){var E,A=Bs(s,m.path),O={},H=_createForOfIteratorHelper(A.keys());try{for(H.s();!(E=H.n()).done;){var K=E.value;O[K]=A.get(K)}}catch(o){H.e(o)}finally{H.f()}m.hook(_o,_objectSpread2({},O))}if(S){var z=zd();if(z){var G=function keepActivePageAlive(o,s){if(_p(o)){var m=bh();if(!m.has(o))return!1;o=m.get(o)}var _=s.register,S=o.options;return _.has("keepAlive")?_.get("keepAlive"):!(!S||!S.keepAlive)&&S.keepAlive}(qd(),o);z&&m.path===qd()&&!G&&z._setState("")}ap(S)?sg(o).then((function(){_o._refocus(),Sm.delete(_)})):S().then((function(o){return o.default})).then((function(s){return Xc(m.path,s),sg(o)})).then((function(){_o._refocus(),Sm.delete(_)}))}else Sm.delete(_)}},_y=function step(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!o||isNaN(o))return!1;var s=lc();if(o=Math.abs(o),s.length){var m,_=s.splice(s.length-o,o)[0];return mc(s),ay(_.hash,(_defineProperty$2(m={},Wp.backtrack,!0),_defineProperty$2(m,Wp.historyState,_.state),m),!1)}if(Co.get("backtrack")){var S=/(\/:?[\w%\s-]+)$/,E=as(Py()),A=Os(E);if(A>1)for(;A--;)if(E=E.replace(S,""),Us(E))return ay(E,_defineProperty$2({},Wp.backtrack,!0),!1)}return o>s.length&&(kh(_o._handleAppClose)?_o._handleAppClose():_o.application.closeApp())},wy=function isNavigating(){if(Sm.size){var o,s=!1,m=_createForOfIteratorHelper(Sm.values());try{for(m.s();!(o=m.n()).done;){o.value.isCancelled||(s=!0)}}catch(o){m.e(o)}finally{m.f()}return s}return!1},Ay=function getResumeHash(){return Xm},Py=function getHash(){return document.location.hash},Ly=function setHash(o){document.location.hash=o},Ry=function registerListener(){ja.addEventListener(window,"hashchange",_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:if(!Cd()){o.next=9;break}return o.prev=1,o.next=4,hy();case 4:o.next=9;break;case 6:o.prev=6,o.t0=o.catch(1),console.error(o.t0);case 9:case"end":return o.stop()}}),_callee2,null,[[1,6]])}))))},Oy={startRouter:function startRouter(o,s){jc(o,s),Ry(),Ym()},navigate:ay,resume:function resume(){_p(Xm)?(ay(Xm,!1),Xm=""):kh(Xm)?Xm().then((function(o){Xm="",qh(o)?ay(o.path,o.params):ay(o)})):console.warn("[Router]: resume() called but no hash found")},step:_y,go:_y,back:_y.bind(null,-1),activePage:zd,getActivePage:function getActivePage$1(){return zd()},deletePage:function deletePage(o){!function deleteCurrentInstance(o){Ac.has(o)&&-1!==So.getIndex(Ac.get(o))&&(So.remove(Ac.get(o)),Xc(o,Ac.get(o)._routedType||Ac.get(o).constructor))}(o)},getActiveRoute:qd,getActiveHash:Ud,focusWidget:function focusWidget(o){var s=function getWidgetByName(o){return o=vp(o),Eo.getByRef(o)||!1}(o);s&&(_l(s),"Widgets"===_o.state?_o.reload(Zs):_o._setState("Widgets",[Zs]))},getActiveWidget:vl,restoreFocus:_u,isNavigating:wy,getHistory:lc,setHistory:mc,getHistoryState:function getHistoryState(o){var s=null;Ql.length&&(o?-1!==ic(o)&&(s=Ql[ic(o)].state):s=Ql[Ql.length-1].state);return s},replaceHistoryState:function replaceHistoryState(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1?arguments[1]:void 0;if(Ql.length){var m=s?ic(s):Ql.length-1;-1!==m&&qh(o)&&(Ql[m].state=o)}},getQueryStringParams:Ip,reload:function reload(){if(!wy()){var o=Ud();ay(o,{reload:!0},!1)}},symbols:Wp,App:_m,focusPage:_u,root:function root(){var o=mh();_p(o)?ay(o):kh(o)&&o().then((function(o){qh(o)?ay(o.path,o.params):ay(o)}))},setupRoutes:function setupRoutes(){console.warn("Router: setupRoutes is deprecated, consolidate your configuration"),console.warn("https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration")},on:function on(){console.warn("Router.on() is deprecated, consolidate your configuration"),console.warn("https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration")},before:function before(){console.warn("Router.before() is deprecated, consolidate your configuration"),console.warn("https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration")},after:function after(){console.warn("Router.after() is deprecated, consolidate your configuration"),console.warn("https://rdkcentral.github.io/Lightning-SDK/#/plugins/router/configuration")}},Launch=function(s,_,A,O){!function initSettings(s,m){o.app=s,o.platform=m,o.user={}}(_,A),function initUtils(o){hi=da(pa(window.location.pathname,o.path||"/")),o.proxyUrl&&(gi=da(o.proxyUrl))}(A),function initStorage(){m.get("platform","id"),new Vo}(),A.plugins&&(A.plugins.profile&&function initProfile(o){It=o.getInfo?o.getInfo:It,At=o.setInfo?o.setInfo:At}(A.plugins.profile),A.plugins.metrics&&function initMetrics(o){ct=o.sendMetric}(A.plugins.metrics),A.plugins.mediaPlayer&&function initMediaPlayer(o){o.mediaUrl&&o.mediaUrl}(A.plugins.mediaPlayer),A.plugins.mediaPlayer&&function initVideoPlayer(o){o.mediaUrl&&(rn=o.mediaUrl)}(A.plugins.mediaPlayer),A.plugins.ads&&function initAds(o){o.getAds&&(qn=o.getAds)}(A.plugins.ads),A.plugins.router&&function initRouter(o){o.getHash&&(Py=o.getHash),o.setHash&&(Ly=o.setHash)}(A.plugins.router),A.plugins.tv&&function initTV(o){Jt={},o.getChannel&&"function"==typeof o.getChannel&&(Jt.getChannel=o.getChannel),o.getProgram&&"function"==typeof o.getProgram&&(Jt.getProgram=o.getProgram),o.setChannel&&"function"==typeof o.setChannel&&(Jt.setChannel=o.setChannel),o.emit&&"function"==typeof o.emit&&o.emit(qt)}(A.plugins.tv),A.plugins.purchase&&function initPurchase(o){o.billingUrl&&o.billingUrl}(A.plugins.purchase),A.plugins.pin&&function initPin(o){o.submit&&"function"==typeof o.submit&&o.submit,o.check&&"function"==typeof o.check&&o.check}(A.plugins.pin));var H=function Application(o,s,_){var A=_.width,O=_.height;return A&&O&&(oo.stage.w=A,oo.stage.h=O,oo.stage.precision=A/1920),A||O||720!==window.innerHeight||(oo.stage.w=1280,oo.stage.h=720,oo.stage.precision=1280/1920),function(s){_inherits$1(Application,s);var E=_createSuper$1(Application);function Application(o){var s;_classCallCheck$1(this,Application);var m=li(oo,o,{isMergeableObject:isPlainObject$1});return(s=E.call(this,m)).config=m,s}return _createClass$1(Application,[{key:"colorshift",value:function colorshift(){var o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};st.colorshift(this,o,s)}},{key:"keymapping",get:function get(){return this.stage.application.config.keys}},{key:"overrideKeyMap",value:function overrideKeyMap(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],m=this.stage.application.config.keys;return Object.keys(o).reduce((function(_,S){return s||Object.keys(m).forEach((function(s){s!=S&&m[s]==o[S]&&delete _[s]})),_[S]=o[S],_}),m),m}},{key:"_setup",value:function _setup(){var s=this;Promise.all([this.loadFonts(o.config&&o.config.fonts||o.getFonts&&o.getFonts()||[]),aa.load(o.config&&o.config.locale||o.getLocale&&o.getLocale()),o.language&&this.loadLanguage(o.language()),o.colors&&this.loadColors(o.colors())]).then((function(){pt.app.loaded(),s.w=s.config.stage.w/s.config.stage.precision,s.h=s.config.stage.h/s.config.stage.precision,_i=s.stage.c({ref:"App",type:o,zIndex:1,forceZIndexContext:!!_.showVersion||!!_.showFps}),s.childList.a(_i),s._refocus(),S.info("App version",s.config.version),S.info("SDK version",ro.version),_.showVersion&&s.childList.a({ref:"VersionLabel",type:oa,version:s.config.version,sdkVersion:ro.version,zIndex:1}),_.showFps&&s.childList.a({ref:"FpsCounter",type:la,zIndex:1}),_get$1(_getPrototypeOf$1(Application.prototype),"_setup",s).call(s)})).catch(console.error)}},{key:"_handleBack",value:function _handleBack(){this.closeApp()}},{key:"_handleExit",value:function _handleExit(){this.closeApp()}},{key:"closeApp",value:function closeApp(){S.info("Signaling App Close"),_.onClose&&"function"==typeof _.onClose?_.onClose.apply(_,arguments):this.close()}},{key:"close",value:function close(){S.info("Closing App"),m.clearSubscribers(),ja.clear(),this.childList.remove(this.tag("App")),this.cleanupFonts(),this.stage.gc(),this.destroy()}},{key:"loadFonts",value:function loadFonts(o){return _.fontLoader&&"function"==typeof _.fontLoader?_.fontLoader(o,lo):ho(o,lo)}},{key:"cleanupFonts",value:function cleanupFonts(){"delete"in document.fonts?lo.forEach((function(o){S.info("Removing font",o.family),document.fonts.delete(o)})):S.info("No support for removing manually-added fonts")}},{key:"loadLanguage",value:function loadLanguage(o){var s=ca.asset("translations.json"),m=o;return"object"==typeof m&&(m=o.language||null,s=o.file||s),ka(s,m)}},{key:"loadColors",value:function loadColors(o){var s=ca.asset("colors.json");return!o||"string"!=typeof o&&"object"!=typeof o||(s=o),Za(s)}},{key:"focus",set:function set(o){this._focussed=o,this._refocus()}},{key:"_getFocused",value:function _getFocused(){return this._focussed||this.tag("App")}}],[{key:"_template",value:function _template(){return{w:1920,h:1080}}}]),Application}(E.Application)}(s,0,A);return ut.log=S,ut.settings=m,ut.ads=Pr,ut.lightning=E,Bo=new H(_),ut.appInstance=Bo,Bo};E.Component;var __awaiter$l=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},Xy=function(){function CoreAPI(o){_classCallCheck$1(this,CoreAPI),this.logger=o||console}return _createClass$1(CoreAPI,[{key:"fetchData",value:function fetchData(o){var s,m,_;return __awaiter$l(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var S,E,A,O,H,K,z,G,q,X;return _regeneratorRuntime$1().wrap((function _callee$(J){for(;;)switch(J.prev=J.next){case 0:return S=o.url,E=o.header,A=o.body,O=o.options,H=null!==(s=o.method)&&void 0!==s?s:"GET",K=Object.assign({},E),J.prev=3,J.next=6,fetch(S,Object.assign(Object.assign({method:H,headers:K},O),A&&{body:JSON.stringify(A)}));case 6:if(!(z=J.sent).ok){J.next=24;break}if(!z.headers){J.next=17;break}if(!(null===(m=z.headers.get("content-type"))||void 0===m?void 0:m.includes("text/xml"))){J.next=15;break}return J.next=12,z.text();case 12:return G=J.sent,q=(new window.DOMParser).parseFromString(G,"text/xml"),J.abrupt("return",q);case 15:if(!(null===(_=z.headers.get("content-type"))||void 0===_?void 0:_.includes("image"))){J.next=17;break}return J.abrupt("return",z);case 17:if(204===z.status){J.next=21;break}return J.next=20,z.json();case 20:return J.abrupt("return",J.sent);case 21:return J.abrupt("return",{success:!0});case 24:return J.next=26,z.text();case 26:return J.t0=J.sent,X={error:!0,body:J.t0},this.logger.error(JSON.stringify(X)),J.abrupt("return",X);case 30:J.next=36;break;case 32:return J.prev=32,J.t1=J.catch(3),this.logger.error(J.t1),J.abrupt("return",{error:!0});case 36:case"end":return J.stop()}}),_callee,this,[[3,32]])})))}}]),CoreAPI}(),Qy=function(){function DebugProxy(){_classCallCheck$1(this,DebugProxy),this._isStarted=!1}return _createClass$1(DebugProxy,[{key:"startProxy",value:function startProxy(o){if(this._isStarted)console.error("Error starting DebugProxy; it is already started");else{o.indexOf(":")<0&&(o+=":8888"),this._isStarted=!0,console.warn("DebugProxy started using proxyAddress=".concat(o));var s="http://".concat(o,"/;"),m=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(_,S,E,A,O){(S=S.toString()).toString().indexOf(o)<0&&(S="".concat(s).concat(S)),m.bind(this)(_,S.toString(),!!E,A,O)};var _=window.fetch;window.fetch=function(m,S){var E=m.toString();return E.toString().indexOf(o)<0&&(E="".concat(s).concat(E)),_(E,S)}}}}]),DebugProxy}();new Qy;var tv,_v=function(){function DateTimeService(){_classCallCheck$1(this,DateTimeService)}return _createClass$1(DateTimeService,[{key:"getUTCString",value:function getUTCString(o){return o||(o=new Date),new Date(o).toUTCString()}},{key:"getUTCNow",value:function getUTCNow(){return this.asUTC()}},{key:"asUTC",value:function asUTC(o){return new Date(this.getUTCString(o))}}]),DateTimeService}();!function(o){o[o.ERROR=1]="ERROR",o[o.WARN=2]="WARN",o[o.INFO=3]="INFO",o[o.DEBUG=4]="DEBUG",o[o.PERFORMANCE=5]="PERFORMANCE"}(tv||(tv={}));var $v=function(){function Logger(o){_classCallCheck$1(this,Logger),this.dateTimeService=new _v,this._logLevel=tv.DEBUG,this.logStorage=o}return _createClass$1(Logger,[{key:"LogLevel",get:function get(){return this._logLevel},set:function set(o){this._logLevel=o}},{key:"log",value:function log(o,s){if(o<=this.LogLevel){var m=this.dateTimeService.getUTCNow().toISOString(),_="".concat(m," | [").concat(tv[o],"] ").concat(s);this.logStorage.send(_,o)}}},{key:"error",value:function error(o){this.log(tv.ERROR,o)}},{key:"warn",value:function warn(o){this.log(tv.WARN,o)}},{key:"info",value:function info(o){this.log(tv.INFO,o)}},{key:"debug",value:function debug(o){this.log(tv.DEBUG,o)}},{key:"performance",value:function performance(o){this.log(tv.PERFORMANCE,o)}}]),Logger}(),Yv=function(){function ConsoleLogStorage(){_classCallCheck$1(this,ConsoleLogStorage),this.logBatch=[]}return _createClass$1(ConsoleLogStorage,[{key:"send",value:function send(o,s){switch(s){case tv.DEBUG:console.debug(o);break;case tv.ERROR:console.error(o);break;case tv.WARN:console.warn(o);break;case tv.INFO:console.info(o);break;default:console.log(o)}}}]),ConsoleLogStorage}(),Jv=function(){function EventDispatcher(){var o=this;_classCallCheck$1(this,EventDispatcher),this.listeners=new Set,this.bus={addListener:function addListener(s){if(o.listeners.has(s))throw new Error("Duplicate listener added");o.listeners.add(s)},removeListener:function removeListener(s){return o.listeners.delete(s)}}}return _createClass$1(EventDispatcher,[{key:"dispatchEvent",value:function dispatchEvent(o){this.listeners.forEach((function(s){try{s(o)}catch(o){try{self.reportError(o)}catch(o){}}}))}}]),EventDispatcher}(),e_=_regeneratorRuntime$1().mark(map$1);function map$1(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function map$(A){for(;;)switch(A.prev=A.next){case 0:m=0,_=_createForOfIteratorHelper(o),A.prev=2,_.s();case 4:if((S=_.n()).done){A.next=10;break}return E=S.value,A.next=8,s(E,m++);case 8:A.next=4;break;case 10:A.next=15;break;case 12:A.prev=12,A.t0=A.catch(2),_.e(A.t0);case 15:return A.prev=15,_.f(),A.finish(15);case 18:case"end":return A.stop()}}),e_,null,[[2,12,15,18]])}function mapObjectValues(o,s){var m,_={},S=_createForOfIteratorHelper(map$1(function entries(o){return Object.entries(o)}(o),(function(o){var m=_slicedToArray$1(o,2),_=m[0],S=m[1];return[_,s(S,_)]})));try{for(S.s();!(m=S.n()).done;){var E=_slicedToArray$1(m.value,2),A=E[0],O=E[1];_[A]=O}}catch(o){S.e(o)}finally{S.f()}return _}var t_=function(){function Store(o){_classCallCheck$1(this,Store),this.launchParams={path:"",qs:{}},this.data=o,this.propertyChangedDispatchers=mapObjectValues(o,(function(){return new Jv})),this.propertyChanged=mapObjectValues(this.propertyChangedDispatchers,(function(o){return o.bus}))}return _createClass$1(Store,[{key:"set",value:function set(o,s){var m=this.data[o];this.data[o]=s,this.propertyChangedDispatchers[o].dispatchEvent({propertyName:o,oldValue:m,newValue:s})}},{key:"get",value:function get(){return this.data}},{key:"getByProperty",value:function getByProperty(o){return this.data[o]}},{key:"setLaunchParams",value:function setLaunchParams(o){var s=o.path,m=o.qs;this.launchParams.path=null!=s?s:"",this.launchParams.qs=m}}]),Store}(),n_=function(){function Profiling(o){_classCallCheck$1(this,Profiling),this.isActive=!1,this.fetchRecords=[],this.ignoredLoggerUrlList=[],this.entryTypes=["measure","resource"],this.supportedEntryTypes=[],this.runningMarks=[],this.durationConversionMapping={milliseconds:1,seconds:1e3,minutes:6e4},this.unit="milliseconds",this.logger=o}return _createClass$1(Profiling,[{key:"init",value:function init(){var o=this;if(this.isActive)try{this.supportedEntryTypes=this.detectSupport(this.entryTypes);var s=new PerformanceObserver((function(s){var m,_=_createForOfIteratorHelper(s.getEntries());try{for(_.s();!(m=_.n()).done;){var S=m.value,E=S,A=E.entryType,O=E.initiatorType;if("measure"===A){var H=S.toJSON(),K=Object.assign(Object.assign({},H),{duration:H.duration/o.durationConversionFactor()}),z=JSON.stringify({entryType:A,entryJson:K},null,2);o.logger.performance(z),performance.clearMeasures(H.name)}else if(!o.checkInIgnoredList(E.name)&&("fetch"===O||"xmlhttprequest"===O)){var G=E.toJSON(),q=Object.assign(Object.assign({},G),{duration:G.duration/o.durationConversionFactor()});o.fetchRecords.push(q);var X=JSON.stringify({initiatorType:O,entryJson:q},null,2);o.logger.performance(X)}}}catch(o){_.e(o)}finally{_.f()}}));s.observe({entryTypes:this.supportedEntryTypes})}catch(o){this.logger.warn(JSON.stringify(o,null,2))}}},{key:"track",value:function track(o){this.isActive&&(this.runningMarks.push(o),performance.mark("".concat(o,":start")))}},{key:"stopTrack",value:function stopTrack(o){this.isActive&&(performance.mark("".concat(o,":end")),this.runningMarks=this.removeFromActiveTrackList(o),this.measure(o))}},{key:"activeTracks",value:function activeTracks(){return this.runningMarks}},{key:"currentMemoryHeapSize",value:function currentMemoryHeapSize(){var o,s;return(null===(o=performance.memory)||void 0===o?void 0:o.usedJSHeapSize)&&this.isActive?((null===(s=performance.memory)||void 0===s?void 0:s.usedJSHeapSize)/Math.pow(1e3,2)).toFixed(2):0}},{key:"currentFetchRecords",value:function currentFetchRecords(){return this.isActive?this.fetchRecords:[]}},{key:"measure",value:function measure(o){performance.measure("".concat(o,":measure"),"".concat(o,":start"),"".concat(o,":end")),performance.clearMarks("".concat(o,":start")),performance.clearMarks("".concat(o,":end"))}},{key:"checkInIgnoredList",value:function checkInIgnoredList(o){return this.ignoredLoggerUrlList.findIndex((function(s){return o.includes(s)}))>-1}},{key:"detectSupport",value:function detectSupport(o){return PerformanceObserver.supportedEntryTypes?o.filter((function(o){return PerformanceObserver.supportedEntryTypes.includes(o)})):["resource","measure"]}},{key:"removeFromActiveTrackList",value:function removeFromActiveTrackList(o){return this.runningMarks.filter((function(s){return!s.includes(o)}))}},{key:"durationConversionFactor",value:function durationConversionFactor(){return this.durationConversionMapping[this.unit]}},{key:"ignoreList",set:function set(o){this.ignoredLoggerUrlList=o}},{key:"durationUnit",get:function get(){return this.unit},set:function set(o){this.durationConversionMapping[o]&&(this.unit=o)}},{key:"active",get:function get(){return this.isActive},set:function set(o){this.isActive=o}}]),Profiling}(),r_=function(){function BasePresenter(o,s){_classCallCheck$1(this,BasePresenter),this.propertyChangedDispatcher=new Jv,this.propertyChanged=this.propertyChangedDispatcher.bus,this.logger=s||console,this.store=o}return _createClass$1(BasePresenter,[{key:"initAsync",value:function initAsync(){}},{key:"onPropertyChanged",value:function onPropertyChanged(o,s,m){this.propertyChangedDispatcher.dispatchEvent({propertyName:o,oldValue:s,newValue:m})}},{key:"destroy",value:function destroy(){}}]),BasePresenter}(),i_=function(){function DependencyRegistry(){_classCallCheck$1(this,DependencyRegistry),this.typeMappings=[],this.dependencyKeys={LogStorage:"LogStorage",API:"API",Store:"Store",Profiling:"Profiling",Logger:"Logger"}}return _createClass$1(DependencyRegistry,[{key:"registerType",value:function registerType(o,s){var m=this.typeMappings.findIndex((function(o){return o.token===s}));-1!==m?this.typeMappings[m]={instance:o,token:s}:this.typeMappings.push({instance:o,token:s})}},{key:"resolveType",value:function resolveType(o){var s=this.typeMappings.find((function(s){return s.token===o}));if(!s)throw new Error("Type registration not found for type ".concat(o));return s.instance}}]),DependencyRegistry}(),a_=new i_;function isValidHexColor(o){return/^#[0-9A-Fa-f]{6}/gi.test(o)}function convertHexToBase16(o){var s=function hexToRGBA(o){var s,m=[0,0,0,0];if(!isValidHexColor(o))return m;var _=null===(s=o.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(o,s,m,_){return"#"+s+s+m+m+_+_})).substring(1).match(/.{2}/g))||void 0===s?void 0:s.map((function(o){return parseInt(o,16)}));return null!=_?_:m}(o),m=4278190080|s[0]<<16|s[1]<<8|s[2];return parseInt("0x".concat((m>>>0).toString(16)))}var o_=function(){function ColorService(o){_classCallCheck$1(this,ColorService),this.colors=[],this.init(o)}return _createClass$1(ColorService,[{key:"init",value:function init(o){o&&(this.colors=_toConsumableArray$1(Object.entries(o)))}},{key:"get",value:function get(o){var s=this.colors.find((function(s){return s[0]===o}));if(s){var m=s[1];return isValidHexColor(m)?convertHexToBase16(m):parseInt(m)}return null}}]),ColorService}(),s_=function(){function ErrorHandler(o){_classCallCheck$1(this,ErrorHandler),this.logger=o||console}return _createClass$1(ErrorHandler,[{key:"handleError",value:function handleError(o){this.logger.error("[Global Error] ".concat(o.message," | ").concat(o.filename,":").concat(o.lineno," [Ln ").concat(o.lineno,", Col ").concat(o.colno,"]"))}},{key:"handlePromise",value:function handlePromise(o){this.logger.error("[".concat(o.type," Error] ").concat(o.reason.message))}}]),ErrorHandler}(),__awaiter$k=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},u_=function(){function Player(o){var s=o.playerInstance,m=o.customTimeUpdateInterval,_=void 0===m?Player.defaultCustomTimeUpdateInterval:m,S=o.platform,E=o.videoElement;_classCallCheck$1(this,Player),this._trackedTimeUpdatePerSecondEvent={type:"TimeUpdatePerSecond",interval:1e3,lastCheck:0},this._trackedTimeUpdateCustomEvent={type:"TimeUpdateCustom",interval:0,lastCheck:0},this.playerErrorMessage="Player instance not available.",s&&(this._trackedTimeUpdateCustomEvent.interval=_,this.platform=S||null,this.player=s,E&&(s.videoElement=E))}return _createClass$1(Player,[{key:"renderCC",value:function renderCC(o){if(!this.player)throw this.playerErrorMessage;this.player.renderCC(o)}},{key:"size",value:function size(o,s){if(!this.player)throw this.playerErrorMessage;this.player.size(o,s)}},{key:"position",value:function position(o,s){if(!this.player)throw this.playerErrorMessage;this.player.position(o,s)}},{key:"destroy",value:function destroy(){return __awaiter$k(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:if(!this.player){o.next=5;break}return o.next=3,this.player.destroy();case 3:o.next=6;break;case 5:throw this.playerErrorMessage;case 6:case"end":return o.stop()}}),_callee,this)})))}},{key:"open",value:function open(o,s){return __awaiter$k(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:if(!this.player){m.next=5;break}return m.next=3,this.player.open(o,s);case 3:m.next=6;break;case 5:throw this.playerErrorMessage;case 6:case"end":return m.stop()}}),_callee2,this)})))}},{key:"close",value:function close(){return __awaiter$k(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:if(!this.player){o.next=5;break}return o.next=3,this.player.close();case 3:o.next=6;break;case 5:throw this.playerErrorMessage;case 6:case"end":return o.stop()}}),_callee3,this)})))}},{key:"resizeVideo",value:function resizeVideo(o,s,m,_){if(!this.player)throw this.playerErrorMessage;this.player.size(o,s),this.player.position(m,_)}},{key:"mute",value:function mute(){var o;if(!this.player)throw this.playerErrorMessage;(null===(o=this.platform)||void 0===o?void 0:o.mute())||this.player.mute()}},{key:"unmute",value:function unmute(){var o;if(!this.player)throw this.playerErrorMessage;(null===(o=this.platform)||void 0===o?void 0:o.unmute())||this.player.unmute()}},{key:"play",value:function play(){return __awaiter$k(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:if(!this.player){o.next=5;break}return o.next=3,this.player.play();case 3:o.next=6;break;case 5:throw this.playerErrorMessage;case 6:case"end":return o.stop()}}),_callee4,this)})))}},{key:"pause",value:function pause(){return __awaiter$k(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:if(!this.player){o.next=5;break}return o.next=3,this.player.pause();case 3:o.next=6;break;case 5:throw this.playerErrorMessage;case 6:case"end":return o.stop()}}),_callee5,this)})))}},{key:"seek",value:function seek(o){return __awaiter$k(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(s){for(;;)switch(s.prev=s.next){case 0:if(!this.player){s.next=5;break}return s.next=3,this.player.seek(o);case 3:s.next=6;break;case 5:throw this.playerErrorMessage;case 6:case"end":return s.stop()}}),_callee6,this)})))}},{key:"loop",value:function loop(o){if(!this.player)throw this.playerErrorMessage;this.player.loop(o)}},{key:"isFormatSupported",value:function isFormatSupported(o){if(this.player)return this.player.isFormatSupported(o);throw this.playerErrorMessage}},{key:"shouldDispatchEvent",value:function shouldDispatchEvent(o){var s=o.interval,m=o.lastCheck;return Date.now()-m>=s}},{key:"registerEventListeners",value:function registerEventListeners(o){if(!this.player)throw this.playerErrorMessage;this.player.registerEventListeners(o)}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(o,s){if(!this.player)throw this.playerErrorMessage;this.player.registerPlayerEventListener(o,s)}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(o,s){if(!this.player)throw this.playerErrorMessage;this.player.deregisterPlayerEventListener(o,s)}},{key:"onPlayerEvent",set:function set(o){var s=this;if(!this.player)throw this.playerErrorMessage;this.player.onPlayerEvent=function callbackWrapper(m){if("TimeUpdate"===m.type){if(s._trackedTimeUpdateCustomEvent.interval>0&&s.shouldDispatchEvent(s._trackedTimeUpdateCustomEvent)){s._trackedTimeUpdateCustomEvent.lastCheck=Date.now();var _=Object.assign(Object.assign({},m),{type:s._trackedTimeUpdateCustomEvent.type});o(_)}if(s.shouldDispatchEvent(s._trackedTimeUpdatePerSecondEvent)){s._trackedTimeUpdatePerSecondEvent.lastCheck=Date.now();var S=Object.assign(Object.assign({},m),{type:s._trackedTimeUpdatePerSecondEvent.type});o(S)}}o(m)}}},{key:"isPlaying",get:function get(){if(this.player)return this.player.isPlaying;throw this.playerErrorMessage}},{key:"width",get:function get(){if(this.player)return this.player.width;throw this.playerErrorMessage}},{key:"height",get:function get(){if(this.player)return this.player.height;throw this.playerErrorMessage}},{key:"bitrateRange",get:function get(){if(this.player)return this.player.bitrateRange;throw this.playerErrorMessage}},{key:"duration",get:function get(){if(this.player)return this.player.duration;throw this.playerErrorMessage}},{key:"currentTime",get:function get(){if(this.player)return this.player.currentTime;throw this.playerErrorMessage}},{key:"ccEnabled",get:function get(){if(this.player)return this.player.ccEnabled;throw this.playerErrorMessage},set:function set(o){if(!this.player)throw this.playerErrorMessage;this.player.ccEnabled=o}},{key:"ccAvailable",get:function get(){if(this.player)return this.player.ccAvailable;throw this.playerErrorMessage}}]),Player}();u_.defaultCustomTimeUpdateInterval=3e3;var l_=function(){function TextProvider(o,s,m){var _;_classCallCheck$1(this,TextProvider),this.defaultLanguage="en_US",this.refinementTexts={},this.currentLanguage=null!==(_=o.language)&&void 0!==_?_:this.defaultLanguage,this.translations=s[this.currentLanguage],this.logger=m||console}return _createClass$1(TextProvider,[{key:"getText",value:function getText(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],m=this.translations[o];return m?s?this.refinementTexts[this.currentLanguage].reduce((function(o,s){return o.replace.apply(o,_toConsumableArray$1(s))}),m):m:(this.logger.warn("Text key ".concat(o," is invalid.")),o)}},{key:"setRefinementTexts",value:function setRefinementTexts(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en_US";this.refinementTexts[s]=o}}]),TextProvider}();"undefined"!=typeof globalThis&&(globalThis.regeneratorRuntime=void 0);var c_={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function encode(o){try{if(window.btoa&&window.atob)return window.btoa(unescape(encodeURIComponent(o)))}catch(o){console.error("Error encoding cookie values into Base64:"+o)}return this._encode(o)},_encode:function _encode(o){var s,m,_,S,E,A,O,H="",K=0;for(o=d_.encode(o);K<o.length;)S=(s=o.charCodeAt(K++))>>2,E=(3&s)<<4|(m=o.charCodeAt(K++))>>4,A=(15&m)<<2|(_=o.charCodeAt(K++))>>6,O=63&_,isNaN(m)?A=O=64:isNaN(_)&&(O=64),H=H+c_._keyStr.charAt(S)+c_._keyStr.charAt(E)+c_._keyStr.charAt(A)+c_._keyStr.charAt(O);return H},decode:function decode(o){try{if(window.btoa&&window.atob)return decodeURIComponent(escape(window.atob(o)))}catch(o){}return c_._decode(o)},_decode:function _decode(o){var s,m,_,S,E,A,O="",H=0;for(o=o.replace(/[^A-Za-z0-9\+\/\=]/g,"");H<o.length;)s=c_._keyStr.indexOf(o.charAt(H++))<<2|(S=c_._keyStr.indexOf(o.charAt(H++)))>>4,m=(15&S)<<4|(E=c_._keyStr.indexOf(o.charAt(H++)))>>2,_=(3&E)<<6|(A=c_._keyStr.indexOf(o.charAt(H++))),O+=String.fromCharCode(s),64!==E&&(O+=String.fromCharCode(m)),64!==A&&(O+=String.fromCharCode(_));return O=d_.decode(O)}},d_={encode:function encode(o){for(var s,m="",_=0;_<o.length;_++)128>(s=o.charCodeAt(_))?m+=String.fromCharCode(s):127<s&&2048>s?(m+=String.fromCharCode(192|s>>6),m+=String.fromCharCode(128|63&s)):(m+=String.fromCharCode(224|s>>12),m+=String.fromCharCode(128|63&s>>6),m+=String.fromCharCode(128|63&s));return m},decode:function decode(o){for(var s="",m=0,_=0,S=0,E=0;m<o.length;)128>(_=o.charCodeAt(m))?(s+=String.fromCharCode(_),m++):191<_&&224>_?(S=o.charCodeAt(m+1),s+=String.fromCharCode((31&_)<<6|63&S),m+=2):(S=o.charCodeAt(m+1),E=o.charCodeAt(m+2),s+=String.fromCharCode((15&_)<<12|(63&S)<<6|63&E),m+=3);return s}},h_={forEach:function forEach(o,s){var m,_;if(null==this)throw new TypeError(" this is null or not defined");var S=Object(this),E=S.length>>>0;if("function"!=typeof o)throw new TypeError(o+" is not a function");for(1<arguments.length&&(m=s),_=0;_<E;){var A;_ in S&&(A=S[_],o.call(m,A,_,S)),_++}},map:function map(o,s){var m,_,S;if(null===this)throw new TypeError(" this is null or not defined");var E=Object(this),A=E.length>>>0;if("function"!=typeof o)throw new TypeError(o+" is not a function");for(1<arguments.length&&(m=s),_=Array(A),S=0;S<A;){var O,H;S in E&&(O=E[S],H=o.call(m,O,S,E),_[S]=H),S++}return _},filter:function filter(o){if(null==this)throw new TypeError;var s=Object(this),m=s.length>>>0;if("function"!=typeof o)throw new TypeError;for(var _=[],S=2<=arguments.length?arguments[1]:void 0,E=0;E<m;E++)if(E in s){var A=s[E];o.call(S,A,E,s)&&_.push(A)}return _},isArray:function isArray(o){return"[object Array]"===Object.prototype.toString.call(o)},Base64:c_};function _typeof$1(o){return _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof$1(o)}function _toPropertyKey$1(o){var s=function _toPrimitive(o,s){if("object"!==_typeof$1(o)||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!==_typeof$1(_))return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(o,"string");return"symbol"===_typeof$1(s)?s:String(s)}function _defineProperty$1(o,s,m){return(s=_toPropertyKey$1(s))in o?Object.defineProperty(o,s,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[s]=m,o}var p_,f_={SessionStart:1,SessionEnd:2,PageView:3,PageEvent:4,CrashReport:5,OptOut:6,AppStateTransition:10,Profile:14,Commerce:16,Media:20,UserAttributeChange:17,UserIdentityChange:18},g_=(_defineProperty$1(p_={},f_.Commerce,1),_defineProperty$1(p_,f_.UserAttributeChange,1),_defineProperty$1(p_,f_.UserIdentityChange,1),p_),m_={Unknown:0,Navigation:1,Location:2,Search:3,Transaction:4,UserContent:5,UserPreference:6,Social:7,Other:8,Media:9,getName:function getName(o){return o===m_.Unknown?"Unknown":o===m_.Navigation?"Navigation":o===m_.Location?"Location":o===m_.Search?"Search":o===m_.Transaction?"Transaction":o===m_.UserContent?"User Content":o===m_.UserPreference?"User Preference":o===m_.Social?"Social":o===y_.ProductAddToCart?"Product Added to Cart":o===y_.ProductAddToWishlist?"Product Added to Wishlist":o===y_.ProductCheckout?"Product Checkout":o===y_.ProductCheckoutOption?"Product Checkout Options":o===y_.ProductClick?"Product Click":o===y_.ProductImpression?"Product Impression":o===y_.ProductPurchase?"Product Purchased":o===y_.ProductRefund?"Product Refunded":o===y_.ProductRemoveFromCart?"Product Removed From Cart":o===y_.ProductRemoveFromWishlist?"Product Removed from Wishlist":o===y_.ProductViewDetail?"Product View Details":o===y_.PromotionClick?"Promotion Click":o===y_.PromotionView?"Promotion View":"Other"}},y_={ProductAddToCart:10,ProductRemoveFromCart:11,ProductCheckout:12,ProductCheckoutOption:13,ProductClick:14,ProductViewDetail:15,ProductPurchase:16,ProductRefund:17,PromotionView:18,PromotionClick:19,ProductAddToWishlist:20,ProductRemoveFromWishlist:21,ProductImpression:22},v_={Other:0,CustomerId:1,Facebook:2,Twitter:3,Google:4,Microsoft:5,Yahoo:6,Email:7,FacebookCustomAudienceId:9,Other2:10,Other3:11,Other4:12,Other5:13,Other6:14,Other7:15,Other8:16,Other9:17,Other10:18,MobileNumber:19,PhoneNumber2:20,PhoneNumber3:21,isValid:function(o){if("number"==typeof o)for(var s in v_)if(v_.hasOwnProperty(s)&&v_[s]===o)return!0;return!1},getName:function(o){return o===window.mParticle.IdentityType.CustomerId?"Customer ID":o===window.mParticle.IdentityType.Facebook?"Facebook ID":o===window.mParticle.IdentityType.Twitter?"Twitter ID":o===window.mParticle.IdentityType.Google?"Google ID":o===window.mParticle.IdentityType.Microsoft?"Microsoft ID":o===window.mParticle.IdentityType.Yahoo?"Yahoo ID":o===window.mParticle.IdentityType.Email?"Email":o===window.mParticle.IdentityType.FacebookCustomAudienceId?"Facebook App User ID":"Other ID"},getIdentityType:function(o){return"other"===o?v_.Other:"customerid"===o?v_.CustomerId:"facebook"===o?v_.Facebook:"twitter"===o?v_.Twitter:"google"===o?v_.Google:"microsoft"===o?v_.Microsoft:"yahoo"===o?v_.Yahoo:"email"===o?v_.Email:"facebookcustomaudienceid"===o?v_.FacebookCustomAudienceId:"other2"===o?v_.Other2:"other3"===o?v_.Other3:"other4"===o?v_.Other4:"other5"===o?v_.Other5:"other6"===o?v_.Other6:"other7"===o?v_.Other7:"other8"===o?v_.Other8:"other9"===o?v_.Other9:"other10"===o?v_.Other10:"mobile_number"===o?v_.MobileNumber:"phone_number_2"===o?v_.PhoneNumber2:!("phone_number_3"!=o)&&v_.PhoneNumber3},getIdentityName:function(o){return o===v_.Other?"other":o===v_.CustomerId?"customerid":o===v_.Facebook?"facebook":o===v_.Twitter?"twitter":o===v_.Google?"google":o===v_.Microsoft?"microsoft":o===v_.Yahoo?"yahoo":o===v_.Email?"email":o===v_.FacebookCustomAudienceId?"facebookcustomaudienceid":o===v_.Other2?"other2":o===v_.Other3?"other3":o===v_.Other4?"other4":o===v_.Other5?"other5":o===v_.Other6?"other6":o===v_.Other7?"other7":o===v_.Other8?"other8":o===v_.Other9?"other9":o===v_.Other10?"other10":o===v_.MobileNumber?"mobile_number":o===v_.PhoneNumber2?"phone_number_2":o===v_.PhoneNumber3?"phone_number_3":void 0}},b_={Unknown:0,AddToCart:1,RemoveFromCart:2,Checkout:3,CheckoutOption:4,Click:5,ViewDetail:6,Purchase:7,Refund:8,AddToWishlist:9,RemoveFromWishlist:10,getName:function(o){return o===b_.AddToCart?"Add to Cart":o===b_.RemoveFromCart?"Remove from Cart":o===b_.Checkout?"Checkout":o===b_.CheckoutOption?"Checkout Option":o===b_.Click?"Click":o===b_.ViewDetail?"View Detail":o===b_.Purchase?"Purchase":o===b_.Refund?"Refund":o===b_.AddToWishlist?"Add to Wishlist":o===b_.RemoveFromWishlist?"Remove from Wishlist":"Unknown"},getExpansionName:function(o){return o===b_.AddToCart?"add_to_cart":o===b_.RemoveFromCart?"remove_from_cart":o===b_.Checkout?"checkout":o===b_.CheckoutOption?"checkout_option":o===b_.Click?"click":o===b_.ViewDetail?"view_detail":o===b_.Purchase?"purchase":o===b_.Refund?"refund":o===b_.AddToWishlist?"add_to_wishlist":o===b_.RemoveFromWishlist?"remove_from_wishlist":"unknown"}},S_={Unknown:0,PromotionView:1,PromotionClick:2,getName:function(o){return o===S_.PromotionView?"view":o===S_.PromotionClick?"click":"unknown"},getExpansionName:function(o){return o===S_.PromotionView?"view":o===S_.PromotionClick?"click":"unknown"}},T_={MessageType:f_,EventType:m_,CommerceEventType:y_,IdentityType:v_,ProfileMessageType:{Logout:3},ApplicationTransitionType:{AppInit:1},ProductActionType:b_,PromotionActionType:S_,TriggerUploadType:g_,Environment:{Production:"production",Development:"development"}},k_={sdkVersion:"2.23.4",sdkVendor:"mparticle",platform:"web",Messages:{DeprecationMessages:{MethodIsDeprecatedPostfix:"is a deprecated method and will be removed in future releases",AlternativeMethodPrefix:"Please use the alternate method:"},ErrorMessages:{NoToken:"A token must be specified.",EventNameInvalidType:"Event name must be a valid string value.",EventDataInvalidType:"Event data must be a valid object hash.",LoggingDisabled:"Event logging is currently disabled.",CookieParseError:"Could not parse cookie",EventEmpty:"Event object is null or undefined, cancelling send",APIRequestEmpty:"APIRequest is null or undefined, cancelling send",NoEventType:"Event type must be specified.",TransactionIdRequired:"Transaction ID is required",TransactionRequired:"A transaction attributes object is required",PromotionIdRequired:"Promotion ID is required",BadAttribute:"Attribute value cannot be object or array",BadKey:"Key value cannot be object or array",BadLogPurchase:"Transaction attributes and a product are both required to log a purchase, https://docs.mparticle.com/?javascript#measuring-transactions"},InformationMessages:{CookieSearch:"Searching for cookie",CookieFound:"Cookie found, parsing values",CookieNotFound:"Cookies not found",CookieSet:"Setting cookie",CookieSync:"Performing cookie sync",SendBegin:"Starting to send event",SendIdentityBegin:"Starting to send event to identity server",SendWindowsPhone:"Sending event to Windows Phone container",SendIOS:"Calling iOS path: ",SendAndroid:"Calling Android JS interface method: ",SendHttp:"Sending event to mParticle HTTP service",SendAliasHttp:"Sending alias request to mParticle HTTP service",SendIdentityHttp:"Sending event to mParticle HTTP service",StartingNewSession:"Starting new Session",StartingLogEvent:"Starting to log event",StartingLogOptOut:"Starting to log user opt in/out",StartingEndSession:"Starting to end session",StartingInitialization:"Starting to initialize",StartingLogCommerceEvent:"Starting to log commerce event",StartingAliasRequest:"Starting to Alias MPIDs",LoadingConfig:"Loading configuration options",AbandonLogEvent:"Cannot log event, logging disabled or developer token not set",AbandonAliasUsers:"Cannot Alias Users, logging disabled or developer token not set",AbandonStartSession:"Cannot start session, logging disabled or developer token not set",AbandonEndSession:"Cannot end session, logging disabled or developer token not set",NoSessionToEnd:"Cannot end session, no active session found"},ValidationMessages:{ModifyIdentityRequestUserIdentitiesPresent:"identityRequests to modify require userIdentities to be present. Request not sent to server. Please fix and try again",IdentityRequesetInvalidKey:"There is an invalid key on your identityRequest object. It can only contain a `userIdentities` object and a `onUserAlias` function. Request not sent to server. Please fix and try again.",OnUserAliasType:"The onUserAlias value must be a function.",UserIdentities:"The userIdentities key must be an object with keys of identityTypes and values of strings. Request not sent to server. Please fix and try again.",UserIdentitiesInvalidKey:"There is an invalid identity key on your `userIdentities` object within the identityRequest. Request not sent to server. Please fix and try again.",UserIdentitiesInvalidValues:"All user identity values must be strings or null. Request not sent to server. Please fix and try again.",AliasMissingMpid:"Alias Request must contain both a destinationMpid and a sourceMpid",AliasNonUniqueMpid:"Alias Request's destinationMpid and sourceMpid must be unique",AliasMissingTime:"Alias Request must have both a startTime and an endTime",AliasStartBeforeEndTime:"Alias Request's endTime must be later than its startTime"}},NativeSdkPaths:{LogEvent:"logEvent",SetUserTag:"setUserTag",RemoveUserTag:"removeUserTag",SetUserAttribute:"setUserAttribute",RemoveUserAttribute:"removeUserAttribute",SetSessionAttribute:"setSessionAttribute",AddToCart:"addToCart",RemoveFromCart:"removeFromCart",ClearCart:"clearCart",LogOut:"logOut",SetUserAttributeList:"setUserAttributeList",RemoveAllUserAttributes:"removeAllUserAttributes",GetUserAttributesLists:"getUserAttributesLists",GetAllUserAttributes:"getAllUserAttributes",Identify:"identify",Logout:"logout",Login:"login",Modify:"modify",Alias:"aliasUsers",Upload:"upload"},StorageNames:{localStorageName:"mprtcl-api",localStorageNameV3:"mprtcl-v3",cookieName:"mprtcl-api",cookieNameV2:"mprtcl-v2",cookieNameV3:"mprtcl-v3",localStorageNameV4:"mprtcl-v4",localStorageProductsV4:"mprtcl-prodv4",cookieNameV4:"mprtcl-v4",currentStorageName:"mprtcl-v4",currentStorageProductsName:"mprtcl-prodv4"},DefaultConfig:{cookieDomain:null,cookieExpiration:365,logLevel:null,timeout:300,sessionTimeout:30,maxProducts:20,forwarderStatsTimeout:5e3,integrationDelayTimeout:5e3,maxCookieSize:3e3,aliasMaxWindow:90,uploadInterval:0},DefaultUrls:{v1SecureServiceUrl:"jssdks.mparticle.com/v1/JS/",v2SecureServiceUrl:"jssdks.mparticle.com/v2/JS/",v3SecureServiceUrl:"jssdks.mparticle.com/v3/JS/",configUrl:"jssdkcdns.mparticle.com/JS/v2/",identityUrl:"identity.mparticle.com/v1/",aliasUrl:"jssdks.mparticle.com/v1/identity/"},Base64CookieKeys:{csm:1,sa:1,ss:1,ua:1,ui:1,csd:1,ia:1,con:1},SDKv2NonMPIDCookieKeys:{gs:1,cu:1,l:1,globalSettings:1,currentUserMPID:1},HTTPCodes:{noHttpCoverage:-1,activeIdentityRequest:-2,activeSession:-3,validationIssue:-4,nativeIdentityRequest:-5,loggingDisabledOrMissingAPIKey:-6,tooManyRequests:429},FeatureFlags:{ReportBatching:"reportBatching",EventBatchingIntervalMillis:"eventBatchingIntervalMillis",OfflineStorage:"offlineStorage"},DefaultInstance:"default_instance",CCPAPurpose:"data_sale_opt_out"},C_=function extendStatics(o,s){return C_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var m in s)Object.prototype.hasOwnProperty.call(s,m)&&(o[m]=s[m])},C_(o,s)};function __extends$1(o,s){if("function"!=typeof s&&null!==s)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function __(){this.constructor=o}C_(o,s),o.prototype=null===s?Object.create(s):(__.prototype=s.prototype,new __)}var w_,x_,E_=function __assign(){return E_=Object.assign||function __assign(o){for(var s,m=1,_=arguments.length;m<_;m++)for(var S in s=arguments[m])Object.prototype.hasOwnProperty.call(s,S)&&(o[S]=s[S]);return o},E_.apply(this,arguments)};function __awaiter$j(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))}function __generator$1(o,s){var m,_,S,E,A={label:0,sent:function sent(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return E={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(E[Symbol.iterator]=function(){return this}),E;function verb(O){return function(H){return function step(O){if(m)throw new TypeError("Generator is already executing.");for(;E&&(E=0,O[0]&&(A=0)),A;)try{if(m=1,_&&(S=2&O[0]?_.return:O[0]?_.throw||((S=_.return)&&S.call(_),0):_.next)&&!(S=S.call(_,O[1])).done)return S;switch(_=0,S&&(O=[2&O[0],S.value]),O[0]){case 0:case 1:S=O;break;case 4:return A.label++,{value:O[1],done:!1};case 5:A.label++,_=O[1],O=[0];continue;case 7:O=A.ops.pop(),A.trys.pop();continue;default:if(!(S=A.trys,(S=S.length>0&&S[S.length-1])||6!==O[0]&&2!==O[0])){A=0;continue}if(3===O[0]&&(!S||O[1]>S[0]&&O[1]<S[3])){A.label=O[1];break}if(6===O[0]&&A.label<S[1]){A.label=S[1],S=O;break}if(S&&A.label<S[2]){A.label=S[2],A.ops.push(O);break}S[2]&&A.ops.pop(),A.trys.pop();continue}O=s.call(o,A)}catch(o){O=[6,o],_=0}finally{m=S=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([O,H])}}}"function"==typeof SuppressedError&&SuppressedError,function(o){o[o.Unknown=0]="Unknown",o[o.AddToCart=1]="AddToCart",o[o.RemoveFromCart=2]="RemoveFromCart",o[o.Checkout=3]="Checkout",o[o.CheckoutOption=4]="CheckoutOption",o[o.Click=5]="Click",o[o.ViewDetail=6]="ViewDetail",o[o.Purchase=7]="Purchase",o[o.Refund=8]="Refund",o[o.AddToWishlist=9]="AddToWishlist",o[o.RemoveFromWishlist=10]="RemoveFromWishlist"}(w_||(w_={})),function(o){o.other="other",o.customerId="customerid",o.facebook="facebook",o.twitter="twitter",o.google="google",o.microsoft="microsoft",o.yahoo="yahoo",o.email="email",o.alias="alias",o.facebookCustomAudienceId="facebookcustomaudienceid",o.otherId2="other2",o.otherId3="other3",o.otherId4="other4",o.otherId5="other5",o.otherId6="other6",o.otherId7="other7",o.otherId8="other8",o.otherId9="other9",o.otherId10="other10",o.mobileNumber="mobile_number",o.phoneNumber2="phone_number_2",o.phoneNumber3="phone_number_3"}(x_||(x_={}));"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var I_,A_,P_,L_,D_,R_,O_,M_,F_,N_,U_,B_,j_,$_,V_,H_,K_,z_={};I_=z_,Object.defineProperty(I_,"__esModule",{value:!0}),(A_=I_.ApplicationInformationOsEnum||(I_.ApplicationInformationOsEnum={})).unknown="Unknown",A_.iOS="IOS",A_.android="Android",A_.windowsPhone="WindowsPhone",A_.mobileWeb="MobileWeb",A_.unityIOS="UnityIOS",A_.unityAndroid="UnityAndroid",A_.desktop="Desktop",A_.tvOS="TVOS",A_.roku="Roku",A_.outOfBand="OutOfBand",A_.alexa="Alexa",A_.smartTV="SmartTV",A_.fireTV="FireTV",A_.xbox="Xbox",(I_.ApplicationStateTransitionEventEventTypeEnum||(I_.ApplicationStateTransitionEventEventTypeEnum={})).applicationStateTransition="application_state_transition",(P_=I_.ApplicationStateTransitionEventDataApplicationTransitionTypeEnum||(I_.ApplicationStateTransitionEventDataApplicationTransitionTypeEnum={})).applicationInitialized="application_initialized",P_.applicationExit="application_exit",P_.applicationBackground="application_background",P_.applicationForeground="application_foreground",(L_=I_.BatchEnvironmentEnum||(I_.BatchEnvironmentEnum={})).unknown="unknown",L_.development="development",L_.production="production",(I_.BreadcrumbEventEventTypeEnum||(I_.BreadcrumbEventEventTypeEnum={})).breadcrumb="breadcrumb",(I_.CommerceEventEventTypeEnum||(I_.CommerceEventEventTypeEnum={})).commerceEvent="commerce_event",(D_=I_.CommerceEventDataCustomEventTypeEnum||(I_.CommerceEventDataCustomEventTypeEnum={})).addToCart="add_to_cart",D_.removeFromCart="remove_from_cart",D_.checkout="checkout",D_.checkoutOption="checkout_option",D_.click="click",D_.viewDetail="view_detail",D_.purchase="purchase",D_.refund="refund",D_.promotionView="promotion_view",D_.promotionClick="promotion_click",D_.addToWishlist="add_to_wishlist",D_.removeFromWishlist="remove_from_wishlist",D_.impression="impression",(I_.CrashReportEventEventTypeEnum||(I_.CrashReportEventEventTypeEnum={})).crashReport="crash_report",(I_.CustomEventEventTypeEnum||(I_.CustomEventEventTypeEnum={})).customEvent="custom_event",(R_=I_.CustomEventDataCustomEventTypeEnum||(I_.CustomEventDataCustomEventTypeEnum={})).navigation="navigation",R_.location="location",R_.search="search",R_.transaction="transaction",R_.userContent="user_content",R_.userPreference="user_preference",R_.social="social",R_.media="media",R_.other="other",R_.unknown="unknown",(O_=I_.DeviceCurrentStateDeviceOrientationEnum||(I_.DeviceCurrentStateDeviceOrientationEnum={})).portrait="portrait",O_.portraitUpsideDown="portrait_upside_down",O_.landscape="landscape",O_.landscapeLeft="LandscapeLeft",O_.landscapeRight="LandscapeRight",O_.faceUp="FaceUp",O_.faceDown="FaceDown",O_.square="Square",(M_=I_.DeviceCurrentStateStatusBarOrientationEnum||(I_.DeviceCurrentStateStatusBarOrientationEnum={})).portrait="portrait",M_.portraitUpsideDown="portrait_upside_down",M_.landscape="landscape",M_.landscapeLeft="LandscapeLeft",M_.landscapeRight="LandscapeRight",M_.faceUp="FaceUp",M_.faceDown="FaceDown",M_.square="Square",(F_=I_.DeviceInformationPlatformEnum||(I_.DeviceInformationPlatformEnum={})).iOS="iOS",F_.android="Android",F_.web="web",F_.desktop="desktop",F_.tvOS="tvOS",F_.roku="roku",F_.outOfBand="out_of_band",F_.smartTV="smart_tv",F_.xbox="xbox",function(o){o.unknown="unknown",o.sessionStart="session_start",o.sessionEnd="session_end",o.screenView="screen_view",o.customEvent="custom_event",o.crashReport="crash_report",o.optOut="opt_out",o.firstRun="first_run",o.preAttribution="pre_attribution",o.pushRegistration="push_registration",o.applicationStateTransition="application_state_transition",o.pushMessage="push_message",o.networkPerformance="network_performance",o.breadcrumb="breadcrumb",o.profile="profile",o.pushReaction="push_reaction",o.commerceEvent="commerce_event",o.userAttributeChange="user_attribute_change",o.userIdentityChange="user_identity_change",o.uninstall="uninstall",o.validationResult="validation_result"}(I_.EventTypeEnum||(I_.EventTypeEnum={})),(N_=I_.IdentityTypeEnum||(I_.IdentityTypeEnum={})).other="other",N_.customerId="customer_id",N_.facebook="facebook",N_.twitter="twitter",N_.google="google",N_.microsoft="microsoft",N_.yahoo="yahoo",N_.email="email",N_.alias="alias",N_.facebookCustomAudienceId="facebook_custom_audience_id",N_.otherId2="other_id_2",N_.otherId3="other_id_3",N_.otherId4="other_id_4",N_.otherId5="other_id_5",N_.otherId6="other_id_6",N_.otherId7="other_id_7",N_.otherId8="other_id_8",N_.otherId9="other_id_9",N_.otherId10="other_id_10",N_.mobileNumber="mobile_number",N_.phoneNumber2="phone_number_2",N_.phoneNumber3="phone_number_3",(I_.NetworkPerformanceEventEventTypeEnum||(I_.NetworkPerformanceEventEventTypeEnum={})).networkPerformance="network_performance",(I_.OptOutEventEnum||(I_.OptOutEventEnum={})).optOut="opt_out",(U_=I_.ProductActionActionEnum||(I_.ProductActionActionEnum={})).unknown="unknown",U_.addToCart="add_to_cart",U_.removeFromCart="remove_from_cart",U_.checkout="checkout",U_.checkoutOption="checkout_option",U_.click="click",U_.viewDetail="view_detail",U_.purchase="purchase",U_.refund="refund",U_.addToWishlist="add_to_wishlist",U_.removeFromWishlist="remove_from_wish_list",(I_.ProfileEventEventTypeEnum||(I_.ProfileEventEventTypeEnum={})).profile="profile",(B_=I_.ProfileEventDataProfileEventTypeEnum||(I_.ProfileEventDataProfileEventTypeEnum={})).signup="signup",B_.login="login",B_.logout="logout",B_.update="update",B_.delete="delete",(j_=I_.PromotionActionActionEnum||(I_.PromotionActionActionEnum={})).view="view",j_.click="click",(I_.PushMessageEventEventTypeEnum||(I_.PushMessageEventEventTypeEnum={})).pushMessage="push_message",($_=I_.PushMessageEventDataPushMessageTypeEnum||(I_.PushMessageEventDataPushMessageTypeEnum={})).sent="sent",$_.received="received",$_.action="action",(V_=I_.PushMessageEventDataApplicationStateEnum||(I_.PushMessageEventDataApplicationStateEnum={})).notRunning="not_running",V_.background="background",V_.foreground="foreground",(H_=I_.PushMessageEventDataPushMessageBehaviorEnum||(I_.PushMessageEventDataPushMessageBehaviorEnum={})).received="Received",H_.directOpen="DirectOpen",H_.read="Read",H_.influencedOpen="InfluencedOpen",H_.displayed="Displayed",(I_.PushRegistrationEventEventTypeEnum||(I_.PushRegistrationEventEventTypeEnum={})).pushRegistration="push_registration",(I_.SessionEndEventEventTypeEnum||(I_.SessionEndEventEventTypeEnum={})).sessionEnd="session_end",(I_.SessionStartEventEventTypeEnum||(I_.SessionStartEventEventTypeEnum={})).sessionStart="session_start",(K_=I_.SourceInformationChannelEnum||(I_.SourceInformationChannelEnum={})).native="native",K_.javascript="javascript",K_.pixel="pixel",K_.desktop="desktop",K_.partner="partner",K_.serverToServer="server_to_server",(I_.UserAttributeChangeEventEventTypeEnum||(I_.UserAttributeChangeEventEventTypeEnum={})).userAttributeChange="user_attribute_change",(I_.UserIdentityChangeEventEventTypeEnum||(I_.UserIdentityChangeEventEventTypeEnum={})).userIdentityChange="user_identity_change";var W_={exports:{}};!function(o,s){!function(s,m,_){o.exports=_(),o.exports.default=_()}(0,0,(function(){var o=JSON.parse('{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","¢":"cent","£":"pound","¤":"currency","¥":"yen","©":"(c)","ª":"a","®":"(r)","º":"o","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","þ":"th","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"DJ","đ":"dj","Ē":"E","ē":"e","Ė":"E","ė":"e","Ę":"e","ę":"e","Ě":"E","ě":"e","Ğ":"G","ğ":"g","Ģ":"G","ģ":"g","Ĩ":"I","ĩ":"i","Ī":"i","ī":"i","Į":"I","į":"i","İ":"I","ı":"i","Ķ":"k","ķ":"k","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","Ō":"O","ō":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ũ":"U","ũ":"u","Ū":"u","ū":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","Ə":"E","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","ǈ":"LJ","ǉ":"lj","ǋ":"NJ","ǌ":"nj","Ș":"S","ș":"s","Ț":"T","ț":"t","ə":"e","˚":"o","Ά":"A","Έ":"E","Ή":"H","Ί":"I","Ό":"O","Ύ":"Y","Ώ":"W","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ϊ":"I","Ϋ":"Y","ά":"a","έ":"e","ή":"h","ί":"i","ΰ":"y","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","ς":"s","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ϊ":"i","ϋ":"y","ό":"o","ύ":"y","ώ":"w","Ё":"Yo","Ђ":"DJ","Є":"Ye","І":"I","Ї":"Yi","Ј":"J","Љ":"LJ","Њ":"NJ","Ћ":"C","Џ":"DZ","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"U","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"u","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","ё":"yo","ђ":"dj","є":"ye","і":"i","ї":"yi","ј":"j","љ":"lj","њ":"nj","ћ":"c","ѝ":"u","џ":"dz","Ґ":"G","ґ":"g","Ғ":"GH","ғ":"gh","Қ":"KH","қ":"kh","Ң":"NG","ң":"ng","Ү":"UE","ү":"ue","Ұ":"U","ұ":"u","Һ":"H","һ":"h","Ә":"AE","ә":"ae","Ө":"OE","ө":"oe","Ա":"A","Բ":"B","Գ":"G","Դ":"D","Ե":"E","Զ":"Z","Է":"E\'","Ը":"Y\'","Թ":"T\'","Ժ":"JH","Ի":"I","Լ":"L","Խ":"X","Ծ":"C\'","Կ":"K","Հ":"H","Ձ":"D\'","Ղ":"GH","Ճ":"TW","Մ":"M","Յ":"Y","Ն":"N","Շ":"SH","Չ":"CH","Պ":"P","Ջ":"J","Ռ":"R\'","Ս":"S","Վ":"V","Տ":"T","Ր":"R","Ց":"C","Փ":"P\'","Ք":"Q\'","Օ":"O\'\'","Ֆ":"F","և":"EV","ء":"a","آ":"aa","أ":"a","ؤ":"u","إ":"i","ئ":"e","ا":"a","ب":"b","ة":"h","ت":"t","ث":"th","ج":"j","ح":"h","خ":"kh","د":"d","ذ":"th","ر":"r","ز":"z","س":"s","ش":"sh","ص":"s","ض":"dh","ط":"t","ظ":"z","ع":"a","غ":"gh","ف":"f","ق":"q","ك":"k","ل":"l","م":"m","ن":"n","ه":"h","و":"w","ى":"a","ي":"y","ً":"an","ٌ":"on","ٍ":"en","َ":"a","ُ":"u","ِ":"e","ْ":"","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","پ":"p","چ":"ch","ژ":"zh","ک":"k","گ":"g","ی":"y","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","฿":"baht","ა":"a","ბ":"b","გ":"g","დ":"d","ე":"e","ვ":"v","ზ":"z","თ":"t","ი":"i","კ":"k","ლ":"l","მ":"m","ნ":"n","ო":"o","პ":"p","ჟ":"zh","რ":"r","ს":"s","ტ":"t","უ":"u","ფ":"f","ქ":"k","ღ":"gh","ყ":"q","შ":"sh","ჩ":"ch","ც":"ts","ძ":"dz","წ":"ts","ჭ":"ch","ხ":"kh","ჯ":"j","ჰ":"h","Ṣ":"S","ṣ":"s","Ẁ":"W","ẁ":"w","Ẃ":"W","ẃ":"w","Ẅ":"W","ẅ":"w","ẞ":"SS","Ạ":"A","ạ":"a","Ả":"A","ả":"a","Ấ":"A","ấ":"a","Ầ":"A","ầ":"a","Ẩ":"A","ẩ":"a","Ẫ":"A","ẫ":"a","Ậ":"A","ậ":"a","Ắ":"A","ắ":"a","Ằ":"A","ằ":"a","Ẳ":"A","ẳ":"a","Ẵ":"A","ẵ":"a","Ặ":"A","ặ":"a","Ẹ":"E","ẹ":"e","Ẻ":"E","ẻ":"e","Ẽ":"E","ẽ":"e","Ế":"E","ế":"e","Ề":"E","ề":"e","Ể":"E","ể":"e","Ễ":"E","ễ":"e","Ệ":"E","ệ":"e","Ỉ":"I","ỉ":"i","Ị":"I","ị":"i","Ọ":"O","ọ":"o","Ỏ":"O","ỏ":"o","Ố":"O","ố":"o","Ồ":"O","ồ":"o","Ổ":"O","ổ":"o","Ỗ":"O","ỗ":"o","Ộ":"O","ộ":"o","Ớ":"O","ớ":"o","Ờ":"O","ờ":"o","Ở":"O","ở":"o","Ỡ":"O","ỡ":"o","Ợ":"O","ợ":"o","Ụ":"U","ụ":"u","Ủ":"U","ủ":"u","Ứ":"U","ứ":"u","Ừ":"U","ừ":"u","Ử":"U","ử":"u","Ữ":"U","ữ":"u","Ự":"U","ự":"u","Ỳ":"Y","ỳ":"y","Ỵ":"Y","ỵ":"y","Ỷ":"Y","ỷ":"y","Ỹ":"Y","ỹ":"y","–":"-","‘":"\'","’":"\'","“":"\\"","”":"\\"","„":"\\"","†":"+","•":"*","…":"...","₠":"ecu","₢":"cruzeiro","₣":"french franc","₤":"lira","₥":"mill","₦":"naira","₧":"peseta","₨":"rupee","₩":"won","₪":"new shequel","₫":"dong","€":"euro","₭":"kip","₮":"tugrik","₯":"drachma","₰":"penny","₱":"peso","₲":"guarani","₳":"austral","₴":"hryvnia","₵":"cedi","₸":"kazakhstani tenge","₹":"indian rupee","₺":"turkish lira","₽":"russian ruble","₿":"bitcoin","℠":"sm","™":"tm","∂":"d","∆":"delta","∑":"sum","∞":"infinity","♥":"love","元":"yuan","円":"yen","﷼":"rial","ﻵ":"laa","ﻷ":"laa","ﻹ":"lai","ﻻ":"la"}'),s=JSON.parse('{"bg":{"Й":"Y","Ц":"Ts","Щ":"Sht","Ъ":"A","Ь":"Y","й":"y","ц":"ts","щ":"sht","ъ":"a","ь":"y"},"de":{"Ä":"AE","ä":"ae","Ö":"OE","ö":"oe","Ü":"UE","ü":"ue","ß":"ss","%":"prozent","&":"und","|":"oder","∑":"summe","∞":"unendlich","♥":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","¢":"centavos","£":"libras","¤":"moneda","₣":"francos","∑":"suma","∞":"infinito","♥":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","¢":"centime","£":"livre","¤":"devise","₣":"franc","∑":"somme","∞":"infini","♥":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","¢":"centavo","∑":"soma","£":"libra","∞":"infinito","♥":"amor"},"uk":{"И":"Y","и":"y","Й":"Y","й":"y","Ц":"Ts","ц":"ts","Х":"Kh","х":"kh","Щ":"Shch","щ":"shch","Г":"H","г":"h"},"vi":{"Đ":"D","đ":"d"},"da":{"Ø":"OE","ø":"oe","Å":"AA","å":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"større end"},"nb":{"&":"og","Å":"AA","Æ":"AE","Ø":"OE","å":"aa","æ":"ae","ø":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","Å":"AA","Ä":"AE","Ö":"OE","å":"aa","ä":"ae","ö":"oe"}}');function replace(m,_){if("string"!=typeof m)throw new Error("slugify: string argument expected");var S=s[(_="string"==typeof _?{replacement:_}:_||{}).locale]||{},E=void 0===_.replacement?"-":_.replacement,A=void 0===_.trim||_.trim,O=m.normalize().split("").reduce((function(s,m){var A=S[m];return void 0===A&&(A=o[m]),void 0===A&&(A=m),A===E&&(A=" "),s+A.replace(_.remove||/[^\w\s$*_+~.()'"!\-:@]+/g,"")}),"");return _.strict&&(O=O.replace(/[^A-Za-z0-9\s]/g,"")),A&&(O=O.trim()),O=O.replace(/\s+/g,E),_.lower&&(O=O.toLowerCase()),O}return replace.extend=function(s){Object.assign(o,s)},replace}))}(W_);var G_=getDefaultExportFromCjs(W_.exports),q_=k_.Messages,X_=function createCookieString(o){return fb(Ib(o))},Y_=function revertCookieString(o){return _b(bb(o))},Q_=function inArray(o,s){var m=0;if(Array.prototype.indexOf)return 0<=o.indexOf(s,0);for(var _=o.length;m<_;m++)if(m in o&&o[m]===s)return!0;return!1},J_=function findKeyInObject(o,s){if(s&&o)for(var m in o)if(o.hasOwnProperty(m)&&m.toLowerCase()===s.toLowerCase())return m;return null},Z_=function generateDeprecationMessage(o,s){var m=[o,q_.DeprecationMessages.MethodIsDeprecatedPostfix];return s&&(m.push(s),m.push(q_.DeprecationMessages.MethodIsDeprecatedPostfix)),m.join(" ")};function generateHash(o){var s=0;if(null==o)return 0;if(o=o.toString().toLowerCase(),Array.prototype.reduce)return o.split("").reduce((function(o,s){return(o=(o<<5)-o+s.charCodeAt(0))&o}),0);if(0===o.length)return s;for(var m=0;m<o.length;m++)s=(s<<5)-s+o.charCodeAt(m),s&=s;return s}var eb=function generateUniqueId(o){return void 0===o&&(o=""),o?function generateRandomValue(){var o,s;return window.crypto&&window.crypto.getRandomValues&&(o=window.crypto.getRandomValues(new Uint8Array(1))),o?(s^o[0]%16>>NaN).toString(16):(s^16*Math.random()>>NaN).toString(16)}():"".concat(1e7,"-").concat(1e3,"-").concat(4e3,"-").concat(8e3,"-").concat(1e11).replace(/[018]/g,generateUniqueId)},sb=function isObject(o){var s=Object.prototype.toString.call(o);return"[object Object]"===s||"[object Error]"===s},db=function parseNumber(o){if(isNaN(o)||!isFinite(o))return 0;var s=parseFloat(o);return isNaN(s)?0:s},hb=function parseStringOrNumber(o){return Mb(o)?o:null},fb=function replaceCommasWithPipes(o){return o.replace(/,/g,"|")},_b=function replacePipesWithCommas(o){return o.replace(/\|/g,",")},bb=function replaceApostrophesWithQuotes(o){return o.replace(/\'/g,'"')},Ib=function replaceQuotesWithApostrophes(o){return o.replace(/\"/g,"'")},Ab=function returnConvertedBoolean(o){return"false"!==o&&"0"!==o&&!!o},Pb=function decoded(o){return decodeURIComponent(o.replace(/\+/g," "))},Lb=function converted(o){return 0===o.indexOf('"')&&(o=o.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),o},Db=function isString(o){return"string"==typeof o},Rb=function isNumber(o){return"number"==typeof o},Ob=function isDataPlanSlug(o){return Db(o)&&o===G_(o)},Mb=function isStringOrNumber(o){return Db(o)||Rb(o)},Fb=function isEmpty(o){return null==o||!(Object.keys(o)||o).length};function convertEvents(o,s,m){if(!o)return null;if(!s||1>s.length)return null;for(var _,S=m.Identity.getCurrentUser(),E=[],A=null,O=0,H=s;O<H.length;O++)if(_=H[O]){A=_;var K=convertEvent(_);K&&E.push(K)}if(!A)return null;var z=null;Fb(A.ConsentState)?!Fb(S)&&(z=S.getConsentState()):z=A.ConsentState;var G={source_request_id:m._Helpers.generateUniqueId(),mpid:o,timestamp_unixtime_ms:(new Date).getTime(),environment:A.Debug?z_.BatchEnvironmentEnum.development:z_.BatchEnvironmentEnum.production,events:E,mp_deviceid:A.DeviceId,sdk_version:A.SDKVersion,application_info:{application_version:A.AppVersion,application_name:A.AppName,package:A.Package,sideloaded_kits_count:m._Store.sideloadedKitsCount},device_info:{platform:z_.DeviceInformationPlatformEnum.web,screen_width:window.screen.width,screen_height:window.screen.height},user_attributes:A.UserAttributes,user_identities:convertUserIdentities(A.UserIdentities),consent_state:convertConsentState(z),integration_attributes:A.IntegrationAttributes};return A.DataPlan&&A.DataPlan.PlanId&&(G.context={data_plan:{plan_id:A.DataPlan.PlanId,plan_version:A.DataPlan.PlanVersion||void 0}}),G}function convertConsentState(o){return Fb(o)?null:{gdpr:convertGdprConsentState(o.getGDPRConsentState()),ccpa:convertCcpaConsentState(o.getCCPAConsentState())}}function convertGdprConsentState(o){if(!o)return null;var s={};for(var m in o)o.hasOwnProperty(m)&&(s[m]={consented:o[m].Consented,hardware_id:o[m].HardwareId,document:o[m].ConsentDocument,timestamp_unixtime_ms:o[m].Timestamp,location:o[m].Location});return s}function convertCcpaConsentState(o){return o?{data_sale_opt_out:{consented:o.Consented,hardware_id:o.HardwareId,document:o.ConsentDocument,timestamp_unixtime_ms:o.Timestamp,location:o.Location}}:null}function convertUserIdentities(o){if(!o||!o.length)return null;for(var s,m={},_=0,S=o;_<S.length;_++)switch(s=S[_],s.Type){case T_.IdentityType.CustomerId:m.customer_id=s.Identity;break;case T_.IdentityType.Email:m.email=s.Identity;break;case T_.IdentityType.Facebook:m.facebook=s.Identity;break;case T_.IdentityType.FacebookCustomAudienceId:m.facebook_custom_audience_id=s.Identity;break;case T_.IdentityType.Google:m.google=s.Identity;break;case T_.IdentityType.Microsoft:m.microsoft=s.Identity;break;case T_.IdentityType.Other:m.other=s.Identity;break;case T_.IdentityType.Other2:m.other_id_2=s.Identity;break;case T_.IdentityType.Other3:m.other_id_3=s.Identity;break;case T_.IdentityType.Other4:m.other_id_4=s.Identity;break;case T_.IdentityType.Other5:m.other_id_5=s.Identity;break;case T_.IdentityType.Other6:m.other_id_6=s.Identity;break;case T_.IdentityType.Other7:m.other_id_7=s.Identity;break;case T_.IdentityType.Other8:m.other_id_8=s.Identity;break;case T_.IdentityType.Other9:m.other_id_9=s.Identity;break;case T_.IdentityType.Other10:m.other_id_10=s.Identity;break;case T_.IdentityType.MobileNumber:m.mobile_number=s.Identity;break;case T_.IdentityType.PhoneNumber2:m.phone_number_2=s.Identity;break;case T_.IdentityType.PhoneNumber3:m.phone_number_3=s.Identity}return m}function convertEvent(o){if(!o)return null;switch(o.EventDataType){case T_.MessageType.AppStateTransition:return function convertAST(o){var s=convertBaseEventData(o),m={application_transition_type:z_.ApplicationStateTransitionEventDataApplicationTransitionTypeEnum.applicationInitialized,is_first_run:o.IsFirstRun,is_upgrade:!1,launch_referral:o.LaunchReferral};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.applicationStateTransition,data:m}}(o);case T_.MessageType.Commerce:return function convertCommerceEvent(o){var s=convertBaseEventData(o),m={custom_flags:o.CustomFlags,product_action:convertProductAction(o),promotion_action:convertPromotionAction(o),product_impressions:convertImpressions(o),shopping_cart:convertShoppingCart(o),currency_code:o.CurrencyCode};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.commerceEvent,data:m}}(o);case T_.MessageType.CrashReport:return function convertCrashReportEvent(o){var s=convertBaseEventData(o),m={message:o.EventName};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.crashReport,data:m}}(o);case T_.MessageType.OptOut:return function convertOptOutEvent(o){var s=convertBaseEventData(o),m={is_opted_out:o.OptOut};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.optOut,data:m}}(o);case T_.MessageType.PageEvent:return function convertCustomEvent(o){var s=convertBaseEventData(o),m={custom_event_type:convertSdkEventType(o.EventCategory),custom_flags:o.CustomFlags,event_name:o.EventName};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.customEvent,data:m}}(o);case T_.MessageType.PageView:return function convertPageViewEvent(o){var s=convertBaseEventData(o),m={custom_flags:o.CustomFlags,screen_name:o.EventName};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.screenView,data:m}}(o);case T_.MessageType.Profile:return null;case T_.MessageType.SessionEnd:return function convertSessionEndEvent(o){var s=convertBaseEventData(o),m={session_duration_ms:o.SessionLength};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.sessionEnd,data:m}}(o);case T_.MessageType.SessionStart:return function convertSessionStartEvent(o){var s=convertBaseEventData(o),m={};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.sessionStart,data:m}}(o);case T_.MessageType.UserAttributeChange:return function convertUserAttributeChangeEvent(o){var s=convertBaseEventData(o),m={user_attribute_name:o.UserAttributeChanges.UserAttributeName,new:o.UserAttributeChanges.New,old:o.UserAttributeChanges.Old,deleted:o.UserAttributeChanges.Deleted,is_new_attribute:o.UserAttributeChanges.IsNewAttribute};return m=E_(E_({},m),s),{event_type:z_.EventTypeEnum.userAttributeChange,data:m}}(o);case T_.MessageType.UserIdentityChange:return function convertUserIdentityChangeEvent(o){var s=convertBaseEventData(o),m={new:{identity_type:convertUserIdentityTypeToServerIdentityType(o.UserIdentityChanges.New.IdentityType),identity:o.UserIdentityChanges.New.Identity||null,timestamp_unixtime_ms:o.Timestamp,created_this_batch:o.UserIdentityChanges.New.CreatedThisBatch},old:{identity_type:convertUserIdentityTypeToServerIdentityType(o.UserIdentityChanges.Old.IdentityType),identity:o.UserIdentityChanges.Old.Identity||null,timestamp_unixtime_ms:o.Timestamp,created_this_batch:o.UserIdentityChanges.Old.CreatedThisBatch}};return m=Object.assign(m,s),{event_type:z_.EventTypeEnum.userIdentityChange,data:m}}(o)}return null}function convertProductActionType(o){return o?o===w_.AddToCart?z_.ProductActionActionEnum.addToCart:o===w_.AddToWishlist?z_.ProductActionActionEnum.addToWishlist:o===w_.Checkout?z_.ProductActionActionEnum.checkout:o===w_.CheckoutOption?z_.ProductActionActionEnum.checkoutOption:o===w_.Click?z_.ProductActionActionEnum.click:o===w_.Purchase?z_.ProductActionActionEnum.purchase:o===w_.Refund?z_.ProductActionActionEnum.refund:o===w_.RemoveFromCart?z_.ProductActionActionEnum.removeFromCart:o===w_.RemoveFromWishlist?z_.ProductActionActionEnum.removeFromWishlist:o===w_.ViewDetail?z_.ProductActionActionEnum.viewDetail:z_.ProductActionActionEnum.unknown:z_.ProductActionActionEnum.unknown}function convertProductAction(o){return o.ProductAction?{action:convertProductActionType(o.ProductAction.ProductActionType),checkout_step:o.ProductAction.CheckoutStep,checkout_options:o.ProductAction.CheckoutOptions,transaction_id:o.ProductAction.TransactionId,affiliation:o.ProductAction.Affiliation,total_amount:o.ProductAction.TotalAmount,tax_amount:o.ProductAction.TaxAmount,shipping_amount:o.ProductAction.ShippingAmount,coupon_code:o.ProductAction.CouponCode,products:convertProducts(o.ProductAction.ProductList)}:null}function convertProducts(o){if(!o||!o.length)return null;for(var s=[],m=0,_=o;m<_.length;m++){var S=_[m],E={id:S.Sku,name:S.Name,brand:S.Brand,category:S.Category,variant:S.Variant,total_product_amount:S.TotalAmount,position:S.Position,price:S.Price,quantity:S.Quantity,coupon_code:S.CouponCode,custom_attributes:S.Attributes};s.push(E)}return s}function convertPromotionAction(o){return o.PromotionAction?{action:o.PromotionAction.PromotionActionType,promotions:convertPromotions(o.PromotionAction.PromotionList)}:null}function convertPromotions(o){if(!o||!o.length)return null;for(var s=[],m=0,_=o;m<_.length;m++){var S=_[m],E={id:S.Id,name:S.Name,creative:S.Creative,position:S.Position};s.push(E)}return s}function convertImpressions(o){if(!o.ProductImpressions)return null;for(var s=[],m=0,_=o.ProductImpressions;m<_.length;m++){var S=_[m],E={product_impression_list:S.ProductImpressionList,products:convertProducts(S.ProductList)};s.push(E)}return s}function convertShoppingCart(o){return o.ShoppingCart&&o.ShoppingCart.ProductList&&o.ShoppingCart.ProductList.length?{products:convertProducts(o.ShoppingCart.ProductList)}:null}function convertSdkEventType(o){return o===T_.EventType.Other?z_.CustomEventDataCustomEventTypeEnum.other:o===T_.EventType.Location?z_.CustomEventDataCustomEventTypeEnum.location:o===T_.EventType.Navigation?z_.CustomEventDataCustomEventTypeEnum.navigation:o===T_.EventType.Search?z_.CustomEventDataCustomEventTypeEnum.search:o===T_.EventType.Social?z_.CustomEventDataCustomEventTypeEnum.social:o===T_.EventType.Transaction?z_.CustomEventDataCustomEventTypeEnum.transaction:o===T_.EventType.UserContent?z_.CustomEventDataCustomEventTypeEnum.userContent:o===T_.EventType.UserPreference?z_.CustomEventDataCustomEventTypeEnum.userPreference:o===T_.EventType.Media?z_.CustomEventDataCustomEventTypeEnum.media:o===T_.CommerceEventType.ProductAddToCart?z_.CommerceEventDataCustomEventTypeEnum.addToCart:o===T_.CommerceEventType.ProductAddToWishlist?z_.CommerceEventDataCustomEventTypeEnum.addToWishlist:o===T_.CommerceEventType.ProductCheckout?z_.CommerceEventDataCustomEventTypeEnum.checkout:o===T_.CommerceEventType.ProductCheckoutOption?z_.CommerceEventDataCustomEventTypeEnum.checkoutOption:o===T_.CommerceEventType.ProductClick?z_.CommerceEventDataCustomEventTypeEnum.click:o===T_.CommerceEventType.ProductImpression?z_.CommerceEventDataCustomEventTypeEnum.impression:o===T_.CommerceEventType.ProductPurchase?z_.CommerceEventDataCustomEventTypeEnum.purchase:o===T_.CommerceEventType.ProductRefund?z_.CommerceEventDataCustomEventTypeEnum.refund:o===T_.CommerceEventType.ProductRemoveFromCart?z_.CommerceEventDataCustomEventTypeEnum.removeFromCart:o===T_.CommerceEventType.ProductRemoveFromWishlist?z_.CommerceEventDataCustomEventTypeEnum.removeFromWishlist:o===T_.CommerceEventType.ProductViewDetail?z_.CommerceEventDataCustomEventTypeEnum.viewDetail:o===T_.CommerceEventType.PromotionClick?z_.CommerceEventDataCustomEventTypeEnum.promotionClick:o===T_.CommerceEventType.PromotionView?z_.CommerceEventDataCustomEventTypeEnum.promotionView:z_.CustomEventDataCustomEventTypeEnum.unknown}function convertBaseEventData(o){return{timestamp_unixtime_ms:o.Timestamp,session_uuid:o.SessionId,session_start_unixtime_ms:o.SessionStartDate,custom_attributes:o.EventAttributes,location:convertSDKLocation(o.Location),source_message_id:o.SourceMessageId}}function convertSDKLocation(o){return o&&Object.keys(o).length?{latitude:o.lat,longitude:o.lng}:null}function convertUserIdentityTypeToServerIdentityType(o){return o===x_.other?z_.IdentityTypeEnum.other:o===x_.customerId?z_.IdentityTypeEnum.customerId:o===x_.facebook?z_.IdentityTypeEnum.facebook:o===x_.twitter?z_.IdentityTypeEnum.twitter:o===x_.google?z_.IdentityTypeEnum.google:o===x_.microsoft?z_.IdentityTypeEnum.microsoft:o===x_.yahoo?z_.IdentityTypeEnum.yahoo:o===x_.email?z_.IdentityTypeEnum.email:o===x_.alias?z_.IdentityTypeEnum.alias:o===x_.facebookCustomAudienceId?z_.IdentityTypeEnum.facebookCustomAudienceId:o===x_.otherId2?z_.IdentityTypeEnum.otherId2:o===x_.otherId3?z_.IdentityTypeEnum.otherId3:o===x_.otherId4?z_.IdentityTypeEnum.otherId4:o===x_.otherId5?z_.IdentityTypeEnum.otherId5:o===x_.otherId6?z_.IdentityTypeEnum.otherId6:o===x_.otherId7?z_.IdentityTypeEnum.otherId7:o===x_.otherId8?z_.IdentityTypeEnum.otherId8:o===x_.otherId9?z_.IdentityTypeEnum.otherId9:o===x_.otherId10?z_.IdentityTypeEnum.otherId10:o===x_.mobileNumber?z_.IdentityTypeEnum.mobileNumber:o===x_.phoneNumber2?z_.IdentityTypeEnum.phoneNumber2:o===x_.phoneNumber3?z_.IdentityTypeEnum.phoneNumber3:void 0}var Nb=function(){function a(o,s,m){this._storageKey=o,this.storageObject=s,this.logger=(null==m?void 0:m.logger)||{verbose:function verbose(){},warning:function warning(){},error:function error(){}},this.contents=this.retrieve()}return a.prototype.store=function(o){this.contents=o;var s=Fb(o)?"":JSON.stringify(o);try{this.storageObject.setItem(this._storageKey,s),this.logger.verbose("Saving item to Storage: ".concat(s))}catch(o){this.logger.error("Cannot Save items to Storage: ".concat(s)),this.logger.error(o)}},a.prototype.retrieve=function(){var o=this.storageObject.getItem(this._storageKey);return this.contents=o?JSON.parse(o):null,this.logger.verbose("Retrieving item from Storage: ".concat(o)),this.contents},a.prototype.purge=function(){this.logger.verbose("Purging Storage"),this.contents=null,this.storageObject.removeItem(this._storageKey)},a}(),Ub=function(o){function b(s,m){return o.call(this,s,window.localStorage,m)||this}return __extends$1(b,o),b}(Nb),Bb=function(o){function b(s,m){return o.call(this,s,window.sessionStorage,m)||this}return __extends$1(b,o),b}(Nb),$b=function(){function a(o,s){var m;this.offlineStorageEnabled=!1,this.mpInstance=o,this.uploadIntervalMillis=s,this.batchingEnabled=s>=a.MINIMUM_INTERVAL_MILLIS,this.uploadIntervalMillis<a.MINIMUM_INTERVAL_MILLIS&&(this.uploadIntervalMillis=a.MINIMUM_INTERVAL_MILLIS),this.eventsQueuedForProcessing=[],this.batchesQueuedForProcessing=[],this.offlineStorageEnabled=this.isOfflineStorageAvailable(),this.offlineStorageEnabled&&(this.eventVault=new Bb("".concat(o._Store.storageName,"-events"),{logger:o.Logger}),this.batchVault=new Ub("".concat(o._Store.storageName,"-batches"),{logger:o.Logger}),(m=this.eventsQueuedForProcessing).push.apply(m,this.eventVault.retrieve()));var _=this.mpInstance._Store,S=_.SDKConfig,E=_.devToken,A=this.mpInstance._Helpers.createServiceUrl(S.v3SecureServiceUrl,E);this.uploadUrl="".concat(A,"/events"),this.uploader=window.fetch?new Kb(this.uploadUrl):new Gb(this.uploadUrl),this.triggerUploadInterval(!0,!1),this.addEventListeners()}return a.prototype.isOfflineStorageAvailable=function(){var o=this.mpInstance,s=o._Helpers.getFeatureFlag,m=o._Store.deviceId,_=s(k_.FeatureFlags.OfflineStorage),S=parseInt(_,10),E=function getRampNumber(o){if(!o)return 100;var s=generateHash(o);return Math.abs(s%100)+1}(m);return S>=E},a.prototype.addEventListeners=function(){var o=this;document.addEventListener("visibilitychange",(function(){o.prepareAndUpload(!1,o.isBeaconAvailable())})),window.addEventListener("beforeunload",(function(){o.prepareAndUpload(!1,o.isBeaconAvailable())})),window.addEventListener("pagehide",(function(){o.prepareAndUpload(!1,o.isBeaconAvailable())}))},a.prototype.isBeaconAvailable=function(){return!!navigator.sendBeacon},a.prototype.triggerUploadInterval=function(o,s){var m=this;void 0===o&&(o=!1),void 0===s&&(s=!1),setTimeout((function(){m.prepareAndUpload(o,s)}),this.uploadIntervalMillis)},a.prototype.queueEvent=function(o){Fb(o)||(this.eventsQueuedForProcessing.push(o),this.offlineStorageEnabled&&this.eventVault&&this.eventVault.store(this.eventsQueuedForProcessing),this.mpInstance.Logger.verbose("Queuing event: ".concat(JSON.stringify(o))),this.mpInstance.Logger.verbose("Queued event count: ".concat(this.eventsQueuedForProcessing.length)),(!this.batchingEnabled||T_.TriggerUploadType[o.EventDataType])&&this.prepareAndUpload(!1,!1))},a.createNewBatches=function(o,s,m){if(!s||!o||!o.length)return null;for(var _=[],S=new Map,E=0,A=o;E<A.length;E++){if(!(pe=A[E]).MPID){var O=s.getMPID();pe.MPID=O}(ae=S.get(pe.MPID))||(ae=[]),ae.push(pe),S.set(pe.MPID,ae)}for(var H=0,K=Array.from(S.entries());H<K.length;H++){for(var z=K[H],G=(O=z[0],z[1]),q=new Map,X=0,J=G;X<J.length;X++){var ae,pe=J[X];(ae=q.get(pe.SessionId))||(ae=[]),ae.push(pe),q.set(pe.SessionId,ae)}for(var me=0,_e=Array.from(q.entries());me<_e.length;me++){var Se=convertEvents(O,_e[me][1],m),Ee=m._Store.SDKConfig.onCreateBatch;Ee&&((Se=Ee(Se))?Se.modified=!0:m.Logger.warning("Skiping batch upload because no batch was returned from onCreateBatch callback")),Se&&_.push(Se)}}return _},a.prototype.prepareAndUpload=function(o,s){return __awaiter$j(this,void 0,void 0,(function(){var m,_,S,E,A,O,H,K;return __generator$1(this,(function(z){switch(z.label){case 0:return m=this.mpInstance.Identity.getCurrentUser(),_=this.eventsQueuedForProcessing,this.eventsQueuedForProcessing=[],this.offlineStorageEnabled&&this.eventVault&&this.eventVault.store([]),S=[],Fb(_)||(S=a.createNewBatches(_,m,this.mpInstance)),this.offlineStorageEnabled&&this.batchVault&&((O=this.batchesQueuedForProcessing).unshift.apply(O,this.batchVault.retrieve()),this.batchVault.purge()),Fb(S)||(H=this.batchesQueuedForProcessing).push.apply(H,S),E=this.batchesQueuedForProcessing,this.batchesQueuedForProcessing=[],s&&this.offlineStorageEnabled&&this.batchVault&&this.batchVault.store(E),[4,this.uploadBatches(this.mpInstance.Logger,E,s)];case 1:return A=z.sent(),Fb(A)||(K=this.batchesQueuedForProcessing).unshift.apply(K,A),!s&&this.offlineStorageEnabled&&this.batchVault&&(this.batchVault.store(this.batchesQueuedForProcessing),this.batchesQueuedForProcessing=[]),o&&this.triggerUploadInterval(o,!1),[2]}}))}))},a.prototype.uploadBatches=function(o,s,m){return __awaiter$j(this,void 0,void 0,(function(){var _,S,E,A,O,H;return __generator$1(this,(function(K){switch(K.label){case 0:if(_=s.filter((function(o){return!Fb(o.events)})),Fb(_))return[2,null];o.verbose("Uploading batches: ".concat(JSON.stringify(_))),o.verbose("Batch count: ".concat(_.length)),S=0,K.label=1;case 1:return S<_.length?(E={method:"POST",headers:{Accept:a.CONTENT_TYPE,"Content-Type":"text/plain;charset=UTF-8"},body:JSON.stringify(_[S])},m&&this.isBeaconAvailable()?(A=new Blob([E.body],{type:"text/plain;charset=UTF-8"}),navigator.sendBeacon(this.uploadUrl,A),[3,5]):[3,2]):[3,6];case 2:return K.trys.push([2,4,,5]),[4,this.uploader.upload(E)];case 3:if(!(200<=(O=K.sent()).status&&300>O.status)){if(500<=O.status||429===O.status)return o.error("HTTP error status ".concat(O.status," received")),[2,_.slice(S,_.length)];if(401<=O.status)return o.error("HTTP error status ".concat(O.status," while uploading - please verify your API key.")),[2,null];throw console.error("HTTP error status ".concat(O.status," while uploading events."),O),new Error("Uncaught HTTP Error ".concat(O.status,".  Batch upload will be re-attempted."))}return o.verbose("Upload success for request ID: ".concat(_[S].source_request_id)),[3,5];case 4:return H=K.sent(),o.error("Error sending event to mParticle servers. ".concat(H)),[2,_.slice(S,_.length)];case 5:return S++,[3,1];case 6:return[2,null]}}))}))},a.CONTENT_TYPE="text/plain;charset=UTF-8",a.MINIMUM_INTERVAL_MILLIS=500,a}(),Hb=function a(o){this.url=o},Kb=function(o){function b(){return null!==o&&o.apply(this,arguments)||this}return __extends$1(b,o),b.prototype.upload=function(o){return __awaiter$j(this,void 0,void 0,(function(){return __generator$1(this,(function(s){switch(s.label){case 0:return[4,fetch(this.url,o)];case 1:return[2,s.sent()]}}))}))},b}(Hb),Gb=function(o){function b(){return null!==o&&o.apply(this,arguments)||this}return __extends$1(b,o),b.prototype.upload=function(o){return __awaiter$j(this,void 0,void 0,(function(){return __generator$1(this,(function(s){switch(s.label){case 0:return[4,this.makeRequest(this.url,o.body)];case 1:return[2,s.sent()]}}))}))},b.prototype.makeRequest=function(o,s){return __awaiter$j(this,void 0,void 0,(function(){var m;return __generator$1(this,(function(){return m=new XMLHttpRequest,[2,new Promise((function(_,S){m.onreadystatechange=function(){4!==m.readyState||(200<=m.status&&300>m.status?_(m):S(m))},m.open("post",o),m.send(s)}))]}))}))},b}(Hb);function APIClient(o,s){this.uploader=null;var m=this;this.queueEventForBatchUpload=function(s){if(!this.uploader){var m=o._Helpers.getFeatureFlag(k_.FeatureFlags.EventBatchingIntervalMillis);this.uploader=new $b(o,m)}this.uploader.queueEvent(s),o._Persistence.update()},this.processQueuedEvents=function(){var s,_=o.Identity.getCurrentUser();if(_&&(s=_.getMPID()),o._Store.eventQueue.length&&s){var S=o._Store.eventQueue;o._Store.eventQueue=[],this.appendUserInfoToEvents(_,S),S.forEach((function(o){m.sendEventToServer(o)}))}},this.appendUserInfoToEvents=function(s,m){m.forEach((function(m){m.MPID||o._ServerModel.appendUserInfo(s,m)}))},this.sendEventToServer=function(m,_){var S=o._Helpers.extend({shouldUploadEvent:!0},_);if(!o._Store.webviewBridgeEnabled){var E,A=o.Identity.getCurrentUser();return A&&(E=A.getMPID()),o._Store.requireDelay=o._Helpers.isDelayedByIntegration(o._preInit.integrationDelays,o._Store.integrationDelayTimeoutStart,Date.now()),E&&!o._Store.requireDelay&&o._Store.configurationLoaded?(this.processQueuedEvents(),void(Fb(m)||(S.shouldUploadEvent&&this.queueEventForBatchUpload(m),m.EventName!==T_.MessageType.AppStateTransition&&(s&&s.kitBlockingEnabled&&(m=s.createBlockedEvent(m)),m&&o._Forwarders.sendEventToForwarders(m))))):(o.Logger.verbose("Event was added to eventQueue. eventQueue will be processed once a valid MPID is returned or there is no more integration imposed delay."),void o._Store.eventQueue.push(m))}o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.LogEvent,JSON.stringify(m))},this.sendBatchForwardingStatsToServer=function(s,m){var _,S;try{_=o._Helpers.createServiceUrl(o._Store.SDKConfig.v2SecureServiceUrl,o._Store.devToken),S={uuid:o._Helpers.generateUniqueId(),data:s},m&&(m.open("post",_+"/Forwarding"),m.send(JSON.stringify(S)))}catch(s){o.Logger.error("Error sending forwarding stats to mParticle servers.")}},this.sendSingleForwardingStatsToServer=function(s){var m,_;try{var S=o._Helpers.createXHR((function e(){4===S.readyState&&202===S.status&&o.Logger.verbose("Successfully sent  "+S.statusText+" from server")}));m=o._Helpers.createServiceUrl(o._Store.SDKConfig.v1SecureServiceUrl,o._Store.devToken),_=s,S&&(S.open("post",m+"/Forwarding"),S.send(JSON.stringify(_)))}catch(s){o.Logger.error("Error sending forwarding stats to mParticle servers.")}},this.prepareForwardingStats=function(s,_){var S,E=o._Forwarders.getForwarderStatsQueue();s&&s.isVisible&&(S={mid:s.id,esid:s.eventSubscriptionId,n:_.EventName,attrs:_.EventAttributes,sdk:_.SDKVersion,dt:_.EventDataType,et:_.EventCategory,dbg:_.Debug,ct:_.Timestamp,eec:_.ExpandedEventCount,dp:_.DataPlan},o._Helpers.getFeatureFlag(k_.FeatureFlags.ReportBatching)?(E.push(S),o._Forwarders.setForwarderStatsQueue(E)):m.sendSingleForwardingStatsToServer(S))}}var Xb={isNumber:Rb,isFunction:function isFunction(o){return"function"==typeof o},isStringOrNumber:Mb,isValidAttributeValue:function isValidAttributeValue(o){return void 0!==o&&!sb(o)&&!Array.isArray(o)},isValidKeyValue:function isValidKeyValue(o){return!(!o||sb(o)||Array.isArray(o)||this.isFunction(o))},validateIdentities:function validateIdentities(o,s){var m={userIdentities:1,onUserAlias:1,copyUserAttributes:1};if(o){if("modify"===s&&(sb(o.userIdentities)&&!Object.keys(o.userIdentities).length||!sb(o.userIdentities)))return{valid:!1,error:k_.Messages.ValidationMessages.ModifyIdentityRequestUserIdentitiesPresent};for(var _ in o)if(o.hasOwnProperty(_)){if(!m[_])return{valid:!1,error:k_.Messages.ValidationMessages.IdentityRequesetInvalidKey};if("onUserAlias"===_&&!Xb.isFunction(o[_]))return{valid:!1,error:k_.Messages.ValidationMessages.OnUserAliasType}}if(0===Object.keys(o).length)return{valid:!0};if(void 0===o.userIdentities)return{valid:!1,error:k_.Messages.ValidationMessages.UserIdentities};if(null!==o.userIdentities&&!sb(o.userIdentities))return{valid:!1,error:k_.Messages.ValidationMessages.UserIdentities};if(sb(o.userIdentities)&&Object.keys(o.userIdentities).length)for(var S in o.userIdentities)if(o.userIdentities.hasOwnProperty(S)){if(!1===T_.IdentityType.getIdentityType(S))return{valid:!1,error:k_.Messages.ValidationMessages.UserIdentitiesInvalidKey};if("string"!=typeof o.userIdentities[S]&&null!==o.userIdentities[S])return{valid:!1,error:k_.Messages.ValidationMessages.UserIdentitiesInvalidValues}}}return{valid:!0}}},Yb=function(){function a(){}return a.hashEventType=function(o){return generateHash(o)},a.hashEventName=function(o,s){return generateHash(s+o)},a.hashEventAttributeKey=function(o,s,m){return generateHash(o+s+m)},a.hashUserAttribute=function(o){return generateHash(o)},a.hashUserIdentity=function(o){return o},a.hashConsentPurpose=function(o,s){return generateHash(o+s)},a.hashAttributeConditionalForwarding=function(o){return generateHash(o).toString()},a.hashConsentPurposeConditionalForwarding=function(o,s){return this.hashConsentPurpose(o,s).toString()},a}(),Qb=k_.StorageNames;function Helpers(o){var s=this;this.canLog=function(){return!(!o._Store.isEnabled||!o._Store.devToken&&!o._Store.webviewBridgeEnabled)},this.getFeatureFlag=function(s){return o._Store.SDKConfig.flags.hasOwnProperty(s)?o._Store.SDKConfig.flags[s]:null},this.invokeCallback=function(m,_,S,E,A){m||o.Logger.warning("There is no callback provided");try{s.Validators.isFunction(m)&&m({httpCode:_,body:S,getUser:function getUser(){return E||o.Identity.getCurrentUser()},getPreviousUser:function getPreviousUser(){if(!A){var s=o.Identity.getUsers(),m=s.shift(),_=E||o.Identity.getCurrentUser();return m&&_&&m.getMPID()===_.getMPID()&&(m=s.shift()),m||null}return o.Identity.getUser(A)}})}catch(s){o.Logger.error("There was an error with your callback: "+s)}},this.invokeAliasCallback=function(m,_,S){m||o.Logger.warning("There is no callback provided");try{if(s.Validators.isFunction(m)){var E={httpCode:_};S&&(E.message=S),m(E)}}catch(s){o.Logger.error("There was an error with your callback: "+s)}},this.extend=function(){var o,m,_,S,E,A,O=arguments[0]||{},H=1,K=arguments.length,z=!1,G={hasOwn:Object.prototype.hasOwnProperty,class2type:{},type:function type(o){return null==o?o+"":G.class2type[Object.prototype.toString.call(o)]||"object"},isPlainObject:function isPlainObject(o){if(!o||"object"!==G.type(o)||o.nodeType||G.isWindow(o))return!1;try{if(o.constructor&&!G.hasOwn.call(o,"constructor")&&!G.hasOwn.call(o.constructor.prototype,"isPrototypeOf"))return!1}catch(o){return!1}for(var s in o);return void 0===s||G.hasOwn.call(o,s)},isArray:Array.isArray||function(o){return"array"===G.type(o)},isFunction:function isFunction(o){return"function"===G.type(o)},isWindow:function isWindow(o){return null!=o&&o==o.window}};for("boolean"==typeof O&&(z=O,O=arguments[1]||{},H=2),"object"===_typeof$1(O)||G.isFunction(O)||(O={}),K===H&&(O=this,--H);H<K;H++)if(null!=(o=arguments[H]))for(m in o)_=O[m],O!==(S=o[m])&&(z&&S&&(G.isPlainObject(S)||(E=G.isArray(S)))?(E?(E=!1,A=_&&G.isArray(_)?_:[]):A=_&&G.isPlainObject(_)?_:{},O[m]=s.extend(z,A,S)):void 0!==S&&(O[m]=S));return O},this.createServiceUrl=function(s,m){var _,S=window.mParticle&&o._Store.SDKConfig.forceHttps?"https://":window.location.protocol+"//";return _=o._Store.SDKConfig.forceHttps?"https://"+s:S+s,m&&(_+=m),_},this.createXHR=function(s){var m;try{m=new window.XMLHttpRequest}catch(s){o.Logger.error("Error creating XMLHttpRequest object.")}if(m&&s&&"withCredentials"in m)m.onreadystatechange=s;else if(void 0!==window.XDomainRequest){o.Logger.verbose("Creating XDomainRequest object");try{(m=new window.XDomainRequest).onload=s}catch(s){o.Logger.error("Error creating XDomainRequest object")}}return m},this.filterUserIdentities=function(o,m){var _=[];if(o&&Object.keys(o).length)for(var S in o)if(o.hasOwnProperty(S)){var E=T_.IdentityType.getIdentityType(S);if(!s.inArray(m,E)){var A={Type:E,Identity:o[S]};E===T_.IdentityType.CustomerId?_.unshift(A):_.push(A)}}return _},this.filterUserIdentitiesForForwarders=function(o,m){var _={};if(o&&Object.keys(o).length)for(var S in o)if(o.hasOwnProperty(S)){var E=Yb.hashUserIdentity(T_.IdentityType.getIdentityType(S));s.inArray(m,E)||(_[S]=o[S])}return _},this.filterUserAttributes=function(o,m){var _={};if(o&&Object.keys(o).length)for(var S in o)if(o.hasOwnProperty(S)){var E=Yb.hashUserAttribute(S);s.inArray(m,E)||(_[S]=o[S])}return _},this.isFilteredUserAttribute=function(o,m){var _=Yb.hashUserAttribute(o);return m&&s.inArray(m,_)},this.isEventType=function(o){for(var s in T_.EventType)if(T_.EventType.hasOwnProperty(s)&&T_.EventType[s]===o)return!0;return!1},this.sanitizeAttributes=function(m,_){if(!m||!s.isObject(m))return null;var S={};for(var E in m)m.hasOwnProperty(E)&&s.Validators.isValidAttributeValue(m[E])?S[E]=m[E]:o.Logger.warning("For '"+_+"', the corresponding attribute value of '"+E+"' must be a string, number, boolean, or null.");return S},this.isDelayedByIntegration=function(s,m,_){if(_-m>o._Store.SDKConfig.integrationDelayTimeout)return!1;for(var S in s)if(!0===s[S])return!0;return!1},this.createMainStorageName=function(o){return o?Qb.currentStorageName+"_"+o:Qb.currentStorageName},this.createProductStorageName=function(o){return o?Qb.currentStorageProductsName+"_"+o:Qb.currentStorageProductsName},this.converted=Lb,this.findKeyInObject=J_,this.parseNumber=db,this.inArray=Q_,this.isObject=sb,this.decoded=Pb,this.returnConvertedBoolean=Ab,this.parseStringOrNumber=hb,this.generateHash=generateHash,this.generateUniqueId=eb,this.Validators=Xb}var Zb=k_.Messages,eS="mParticleAndroid",tS="mParticle";function NativeSdkHelpers(o){var s=this;this.isBridgeV2Available=function(o){if(!o)return!1;var s=tS+"_"+o+"_v2";return!!(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.hasOwnProperty(s))||!(!window.mParticle||!window.mParticle.uiwebviewBridgeName||window.mParticle.uiwebviewBridgeName!==s)||!!window.hasOwnProperty(eS+"_"+o+"_v2")},this.isWebviewEnabled=function(m,_){return o._Store.bridgeV2Available=s.isBridgeV2Available(m),o._Store.bridgeV1Available=s.isBridgeV1Available(),2===_?o._Store.bridgeV2Available:!(window.mParticle&&window.mParticle.uiwebviewBridgeName&&window.mParticle.uiwebviewBridgeName!==tS+"_"+m+"_v2")&&!!(2>_)&&(o._Store.bridgeV2Available||o._Store.bridgeV1Available)},this.isBridgeV1Available=function(){return!!(o._Store.SDKConfig.useNativeSdk||window.mParticleAndroid||o._Store.SDKConfig.isIOS)},this.sendToNative=function(m,_){return o._Store.bridgeV2Available&&2===o._Store.SDKConfig.minWebviewBridgeVersion||o._Store.bridgeV2Available&&2>o._Store.SDKConfig.minWebviewBridgeVersion?void s.sendViaBridgeV2(m,_,o._Store.SDKConfig.requiredWebviewBridgeName):o._Store.bridgeV1Available&&2>o._Store.SDKConfig.minWebviewBridgeVersion?void s.sendViaBridgeV1(m,_):void 0},this.sendViaBridgeV1=function(m,_){window.mParticleAndroid&&window.mParticleAndroid.hasOwnProperty(m)?(o.Logger.verbose(Zb.InformationMessages.SendAndroid+m),window.mParticleAndroid[m](_)):o._Store.SDKConfig.isIOS&&(o.Logger.verbose(Zb.InformationMessages.SendIOS+m),s.sendViaIframeToIOS(m,_))},this.sendViaIframeToIOS=function(o,s){var m=document.createElement("IFRAME");m.setAttribute("src","mp-sdk://"+o+"/"+encodeURIComponent(s)),document.documentElement.appendChild(m),m.parentNode.removeChild(m)},this.sendViaBridgeV2=function(m,_,S){if(S){var E,A,O=window[eS+"_"+S+"_v2"],H=tS+"_"+S+"_v2";return window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[H]&&(E=window.webkit.messageHandlers[H]),o.uiwebviewBridgeName===H&&(A=o[H]),O&&O.hasOwnProperty(m)?(o.Logger.verbose(Zb.InformationMessages.SendAndroid+m),void O[m](_)):void(E?(o.Logger.verbose(Zb.InformationMessages.SendIOS+m),E.postMessage(JSON.stringify({path:m,value:_?JSON.parse(_):null}))):A&&(o.Logger.verbose(Zb.InformationMessages.SendIOS+m),s.sendViaIframeToIOS(m,_)))}}}var nS=k_.Messages;function cookieSyncManager(o){var s=this;this.attemptCookieSync=function(m,_,S){var E,A,O,H,K,z;_&&!o._Store.webviewBridgeEnabled&&o._Store.pixelConfigurations.forEach((function(G){z=!1,G.filteringConsentRuleValues&&G.filteringConsentRuleValues.values&&G.filteringConsentRuleValues.values.length&&(z=!0),E={moduleId:G.moduleId,frequencyCap:G.frequencyCap,pixelUrl:s.replaceAmp(G.pixelUrl),redirectUrl:G.redirectUrl?s.replaceAmp(G.redirectUrl):null,filteringConsentRuleValues:G.filteringConsentRuleValues},O=s.replaceMPID(E.pixelUrl,_),H=E.redirectUrl?s.replaceMPID(E.redirectUrl,_):"",K=O+encodeURIComponent(H);var q=o._Persistence.getPersistence();return m&&m!==_?void(q&&q[_]&&(!q[_].csd&&(q[_].csd={}),s.performCookieSync(K,E.moduleId,_,q[_].csd,E.filteringConsentRuleValues,S,z))):void(q[_]&&(!q[_].csd&&(q[_].csd={}),A=q[_].csd[E.moduleId.toString()]?q[_].csd[E.moduleId.toString()]:null,A?(new Date).getTime()>new Date(A).getTime()+60*E.frequencyCap*1e3*60*24&&s.performCookieSync(K,E.moduleId,_,q[_].csd,E.filteringConsentRuleValues,S,z):s.performCookieSync(K,E.moduleId,_,q[_].csd,E.filteringConsentRuleValues,S,z)))}))},this.replaceMPID=function(o,s){return o.replace("%%mpid%%",s)},this.replaceAmp=function(o){return o.replace(/&amp;/g,"&")},this.performCookieSync=function(s,m,_,S,E,A,O){if((!O||!A)&&o._Consent.isEnabledForUserConsent(E,o.Identity.getCurrentUser())){var H=document.createElement("img");o.Logger.verbose(nS.InformationMessages.CookieSync),H.onload=function(){S[m.toString()]=(new Date).getTime(),o._Persistence.saveUserCookieSyncDatesToPersistence(_,S)},H.src=s}}}var rS=k_.Messages;function SessionManager(o){function b(){o._Store.sessionId=null,o._Store.dateLastEventSent=null,o._Store.sessionAttributes={},o._Persistence.update()}var s=this;this.initialize=function(){if(o._Store.sessionId){var m=6e4*o._Store.SDKConfig.sessionTimeout;if(new Date>new Date(o._Store.dateLastEventSent.getTime()+m))s.endSession(),s.startNewSession();else{var _=o._Persistence.getPersistence();_&&!_.cu&&(o.Identity.identify(o._Store.SDKConfig.identifyRequest,o._Store.SDKConfig.identityCallback),o._Store.identifyCalled=!0,o._Store.SDKConfig.identityCallback=null)}}else s.startNewSession()},this.getSession=function(){return o.Logger.warning(Z_("SessionManager.getSession()","SessionManager.getSessionId()")),this.getSessionId()},this.getSessionId=function(){return o._Store.sessionId},this.startNewSession=function(){if(o.Logger.verbose(rS.InformationMessages.StartingNewSession),o._Helpers.canLog()){o._Store.sessionId=o._Helpers.generateUniqueId().toUpperCase();var m=o.Identity.getCurrentUser(),_=m?m.getMPID():null;if(_&&(o._Store.currentSessionMPIDs=[_]),!o._Store.sessionStartDate){var S=new Date;o._Store.sessionStartDate=S,o._Store.dateLastEventSent=S}s.setSessionTimer(),o._Store.identifyCalled||(o.Identity.identify(o._Store.SDKConfig.identifyRequest,o._Store.SDKConfig.identityCallback),o._Store.identifyCalled=!0,o._Store.SDKConfig.identityCallback=null),o._Events.logEvent({messageType:T_.MessageType.SessionStart})}else o.Logger.verbose(rS.InformationMessages.AbandonStartSession)},this.endSession=function(m){var _;if(o.Logger.verbose(rS.InformationMessages.StartingEndSession),m)return o._Events.logEvent({messageType:T_.MessageType.SessionEnd}),void b();if(o._Helpers.canLog()){var S,E=o._Persistence.getPersistence();if(E){if(E.gs&&!E.gs.sid)return void o.Logger.verbose(rS.InformationMessages.NoSessionToEnd);if(E.gs.sid&&o._Store.sessionId!==E.gs.sid&&(o._Store.sessionId=E.gs.sid),null===(_=null==E?void 0:E.gs)||void 0===_?void 0:_.les)S=6e4*o._Store.SDKConfig.sessionTimeout,(new Date).getTime()-E.gs.les<S?s.setSessionTimer():(o._Events.logEvent({messageType:T_.MessageType.SessionEnd}),o._Store.sessionStartDate=null,b())}}else o.Logger.verbose(rS.InformationMessages.AbandonEndSession)},this.setSessionTimer=function(){var m=6e4*o._Store.SDKConfig.sessionTimeout;o._Store.globalTimer=window.setTimeout((function(){s.endSession()}),m)},this.resetSessionTimer=function(){o._Store.webviewBridgeEnabled||(!o._Store.sessionId&&s.startNewSession(),s.clearSessionTimeout(),s.setSessionTimer()),s.startNewSessionIfNeeded()},this.clearSessionTimeout=function(){clearTimeout(o._Store.globalTimer)},this.startNewSessionIfNeeded=function(){if(!o._Store.webviewBridgeEnabled){var m=o._Persistence.getPersistence();!o._Store.sessionId&&m&&(m.sid?o._Store.sessionId=m.sid:s.startNewSession())}}}var iS=k_.Messages;function Ecommerce(o){var s=this;this.convertTransactionAttributesToProductAction=function(o,s){o.hasOwnProperty("Id")&&(s.TransactionId=o.Id),o.hasOwnProperty("Affiliation")&&(s.Affiliation=o.Affiliation),o.hasOwnProperty("CouponCode")&&(s.CouponCode=o.CouponCode),o.hasOwnProperty("Revenue")&&(s.TotalAmount=this.sanitizeAmount(o.Revenue,"Revenue")),o.hasOwnProperty("Shipping")&&(s.ShippingAmount=this.sanitizeAmount(o.Shipping,"Shipping")),o.hasOwnProperty("Tax")&&(s.TaxAmount=this.sanitizeAmount(o.Tax,"Tax")),o.hasOwnProperty("Step")&&(s.CheckoutStep=o.Step),o.hasOwnProperty("Option")&&(s.CheckoutOptions=o.Option)},this.getProductActionEventName=function(o){switch(o){case T_.ProductActionType.AddToCart:return"AddToCart";case T_.ProductActionType.AddToWishlist:return"AddToWishlist";case T_.ProductActionType.Checkout:return"Checkout";case T_.ProductActionType.CheckoutOption:return"CheckoutOption";case T_.ProductActionType.Click:return"Click";case T_.ProductActionType.Purchase:return"Purchase";case T_.ProductActionType.Refund:return"Refund";case T_.ProductActionType.RemoveFromCart:return"RemoveFromCart";case T_.ProductActionType.RemoveFromWishlist:return"RemoveFromWishlist";case T_.ProductActionType.ViewDetail:return"ViewDetail";case T_.ProductActionType.Unknown:default:return"Unknown"}},this.getPromotionActionEventName=function(o){return o===T_.PromotionActionType.PromotionClick?"PromotionClick":o===T_.PromotionActionType.PromotionView?"PromotionView":"Unknown"},this.convertProductActionToEventType=function(s){return s===T_.ProductActionType.AddToCart?T_.CommerceEventType.ProductAddToCart:s===T_.ProductActionType.AddToWishlist?T_.CommerceEventType.ProductAddToWishlist:s===T_.ProductActionType.Checkout?T_.CommerceEventType.ProductCheckout:s===T_.ProductActionType.CheckoutOption?T_.CommerceEventType.ProductCheckoutOption:s===T_.ProductActionType.Click?T_.CommerceEventType.ProductClick:s===T_.ProductActionType.Purchase?T_.CommerceEventType.ProductPurchase:s===T_.ProductActionType.Refund?T_.CommerceEventType.ProductRefund:s===T_.ProductActionType.RemoveFromCart?T_.CommerceEventType.ProductRemoveFromCart:s===T_.ProductActionType.RemoveFromWishlist?T_.CommerceEventType.ProductRemoveFromWishlist:s===T_.ProductActionType.Unknown?T_.EventType.Unknown:s===T_.ProductActionType.ViewDetail?T_.CommerceEventType.ProductViewDetail:(o.Logger.error("Could not convert product action type "+s+" to event type"),null)},this.convertPromotionActionToEventType=function(s){return s===T_.PromotionActionType.PromotionClick?T_.CommerceEventType.PromotionClick:s===T_.PromotionActionType.PromotionView?T_.CommerceEventType.PromotionView:(o.Logger.error("Could not convert promotion action type "+s+" to event type"),null)},this.generateExpandedEcommerceName=function(o,s){return"eCommerce - "+o+" - "+(s?"Total":"Item")},this.extractProductAttributes=function(o,s){s.CouponCode&&(o["Coupon Code"]=s.CouponCode),s.Brand&&(o.Brand=s.Brand),s.Category&&(o.Category=s.Category),s.Name&&(o.Name=s.Name),s.Sku&&(o.Id=s.Sku),s.Price&&(o["Item Price"]=s.Price),s.Quantity&&(o.Quantity=s.Quantity),s.Position&&(o.Position=s.Position),s.Variant&&(o.Variant=s.Variant),o["Total Product Amount"]=s.TotalAmount||0},this.extractTransactionId=function(o,s){s.TransactionId&&(o["Transaction Id"]=s.TransactionId)},this.extractActionAttributes=function(o,m){s.extractTransactionId(o,m),m.Affiliation&&(o.Affiliation=m.Affiliation),m.CouponCode&&(o["Coupon Code"]=m.CouponCode),m.TotalAmount&&(o["Total Amount"]=m.TotalAmount),m.ShippingAmount&&(o["Shipping Amount"]=m.ShippingAmount),m.TaxAmount&&(o["Tax Amount"]=m.TaxAmount),m.CheckoutOptions&&(o["Checkout Options"]=m.CheckoutOptions),m.CheckoutStep&&(o["Checkout Step"]=m.CheckoutStep)},this.extractPromotionAttributes=function(o,s){s.Id&&(o.Id=s.Id),s.Creative&&(o.Creative=s.Creative),s.Name&&(o.Name=s.Name),s.Position&&(o.Position=s.Position)},this.buildProductList=function(o,s){return s?Array.isArray(s)?s:[s]:o.ShoppingCart.ProductList},this.createProduct=function(s,m,_,S,E,A,O,H,K,z){return z=o._Helpers.sanitizeAttributes(z,s),"string"!=typeof s?(o.Logger.error("Name is required when creating a product"),null):o._Helpers.Validators.isStringOrNumber(m)?o._Helpers.Validators.isStringOrNumber(_)?(_=o._Helpers.parseNumber(_),H&&!o._Helpers.Validators.isNumber(H)&&(o.Logger.error("Position must be a number, it will be set to null."),H=null),{Name:s,Sku:m,Price:_,Quantity:S=o._Helpers.Validators.isStringOrNumber(S)?o._Helpers.parseNumber(S):1,Brand:O,Variant:E,Category:A,Position:H,CouponCode:K,TotalAmount:S*_,Attributes:z}):(o.Logger.error("Price is required when creating a product, and must be a string or a number"),null):(o.Logger.error("SKU is required when creating a product, and must be a string or a number"),null)},this.createPromotion=function(s,m,_,S){return o._Helpers.Validators.isStringOrNumber(s)?{Id:s,Creative:m,Name:_,Position:S}:(o.Logger.error(iS.ErrorMessages.PromotionIdRequired),null)},this.createImpression=function(s,m){return"string"==typeof s?m?{Name:s,Product:m}:(o.Logger.error("Product is required when creating an impression."),null):(o.Logger.error("Name is required when creating an impression."),null)},this.createTransactionAttributes=function(s,m,_,S,E,A){return o._Helpers.Validators.isStringOrNumber(s)?{Id:s,Affiliation:m,CouponCode:_,Revenue:S,Shipping:E,Tax:A}:(o.Logger.error(iS.ErrorMessages.TransactionIdRequired),null)},this.expandProductImpression=function(m){var _=[];return m.ProductImpressions?(m.ProductImpressions.forEach((function(S){S.ProductList&&S.ProductList.forEach((function(E){var A=o._Helpers.extend(!1,{},m.EventAttributes);if(E.Attributes)for(var O in E.Attributes)A[O]=E.Attributes[O];s.extractProductAttributes(A,E),S.ProductImpressionList&&(A["Product Impression List"]=S.ProductImpressionList);var H=o._ServerModel.createEventObject({messageType:T_.MessageType.PageEvent,name:s.generateExpandedEcommerceName("Impression"),data:A,eventType:T_.EventType.Transaction});_.push(H)}))})),_):_},this.expandCommerceEvent=function(o){return o?s.expandProductAction(o).concat(s.expandPromotionAction(o)).concat(s.expandProductImpression(o)):null},this.expandPromotionAction=function(m){var _=[];return m.PromotionAction?(m.PromotionAction.PromotionList.forEach((function(S){var E=o._Helpers.extend(!1,{},m.EventAttributes);s.extractPromotionAttributes(E,S);var A=o._ServerModel.createEventObject({messageType:T_.MessageType.PageEvent,name:s.generateExpandedEcommerceName(T_.PromotionActionType.getExpansionName(m.PromotionAction.PromotionActionType)),data:E,eventType:T_.EventType.Transaction});_.push(A)})),_):_},this.expandProductAction=function(m){var _=[];if(!m.ProductAction)return _;var S=!1;if(m.ProductAction.ProductActionType===T_.ProductActionType.Purchase||m.ProductAction.ProductActionType===T_.ProductActionType.Refund){var E=o._Helpers.extend(!1,{},m.EventAttributes);E["Product Count"]=m.ProductAction.ProductList?m.ProductAction.ProductList.length:0,s.extractActionAttributes(E,m.ProductAction),m.CurrencyCode&&(E["Currency Code"]=m.CurrencyCode);var A=o._ServerModel.createEventObject({messageType:T_.MessageType.PageEvent,name:s.generateExpandedEcommerceName(T_.ProductActionType.getExpansionName(m.ProductAction.ProductActionType),!0),data:E,eventType:T_.EventType.Transaction});_.push(A)}else S=!0;var O=m.ProductAction.ProductList;return O?(O.forEach((function(E){var A=o._Helpers.extend(!1,m.EventAttributes,E.Attributes);S?s.extractActionAttributes(A,m.ProductAction):s.extractTransactionId(A,m.ProductAction),s.extractProductAttributes(A,E);var O=o._ServerModel.createEventObject({messageType:T_.MessageType.PageEvent,name:s.generateExpandedEcommerceName(T_.ProductActionType.getExpansionName(m.ProductAction.ProductActionType)),data:A,eventType:T_.EventType.Transaction});_.push(O)})),_):_},this.createCommerceEventObject=function(s){var m;return o.Logger.verbose(iS.InformationMessages.StartingLogCommerceEvent),o._Helpers.canLog()?((m=o._ServerModel.createEventObject({messageType:T_.MessageType.Commerce})).EventName="eCommerce - ",m.CurrencyCode=o._Store.currencyCode,m.ShoppingCart=[],m.CustomFlags=s,m):(o.Logger.verbose(iS.InformationMessages.AbandonLogEvent),null)},this.sanitizeAmount=function(s,m){if(!o._Helpers.Validators.isStringOrNumber(s)){var _=[m,"must be of type number. A",_typeof$1(s),"was passed. Converting to 0"].join(" ");return o.Logger.warning(_),0}return o._Helpers.parseNumber(s)}}function Store(o,s){var m={isEnabled:!0,sessionAttributes:{},currentSessionMPIDs:[],consentState:null,sessionId:null,isFirstRun:null,clientId:null,deviceId:null,devToken:null,serverSettings:{},dateLastEventSent:null,sessionStartDate:null,currentPosition:null,isTracking:!1,watchPositionId:null,cartProducts:[],eventQueue:[],currencyCode:null,globalTimer:null,context:null,configurationLoaded:!1,identityCallInFlight:!1,SDKConfig:{},nonCurrentUserMPIDs:{},identifyCalled:!1,isLoggedIn:!1,cookieSyncDates:{},integrationAttributes:{},requireDelay:!0,isLocalStorageAvailable:null,storageName:null,prodStorageName:null,activeForwarders:[],kits:{},sideloadedKits:[],configuredForwarders:[],pixelConfigurations:[],wrapperSDKInfo:{name:"none",version:null,isInfoSet:!1}};for(var _ in m)this[_]=m[_];if(this.integrationDelayTimeoutStart=Date.now(),this.SDKConfig=function createSDKConfig(o){var s={};for(var m in k_.DefaultConfig)k_.DefaultConfig.hasOwnProperty(m)&&(s[m]=k_.DefaultConfig[m]);if(o)for(var m in o)o.hasOwnProperty(m)&&(s[m]=o[m]);for(var m in k_.DefaultUrls)s[m]=k_.DefaultUrls[m];return s}(o),o){if(o.deviceId&&(this.deviceId=o.deviceId),this.SDKConfig.isDevelopmentMode=!!o.hasOwnProperty("isDevelopmentMode")&&s._Helpers.returnConvertedBoolean(o.isDevelopmentMode),o.hasOwnProperty("v1SecureServiceUrl")&&(this.SDKConfig.v1SecureServiceUrl=o.v1SecureServiceUrl),o.hasOwnProperty("v2SecureServiceUrl")&&(this.SDKConfig.v2SecureServiceUrl=o.v2SecureServiceUrl),o.hasOwnProperty("v3SecureServiceUrl")&&(this.SDKConfig.v3SecureServiceUrl=o.v3SecureServiceUrl),o.hasOwnProperty("identityUrl")&&(this.SDKConfig.identityUrl=o.identityUrl),o.hasOwnProperty("aliasUrl")&&(this.SDKConfig.aliasUrl=o.aliasUrl),o.hasOwnProperty("configUrl")&&(this.SDKConfig.configUrl=o.configUrl),o.hasOwnProperty("logLevel")&&(this.SDKConfig.logLevel=o.logLevel),this.SDKConfig.useNativeSdk=!!o.useNativeSdk,this.SDKConfig.kits=o.kits||{},this.SDKConfig.sideloadedKits=o.sideloadedKits||[],this.SDKConfig.isIOS=o.hasOwnProperty("isIOS")?o.isIOS:!(!window.mParticle||!window.mParticle.isIOS)&&window.mParticle.isIOS,this.SDKConfig.useCookieStorage=!!o.hasOwnProperty("useCookieStorage")&&o.useCookieStorage,this.SDKConfig.maxProducts=o.hasOwnProperty("maxProducts")?o.maxProducts:k_.DefaultConfig.maxProducts,this.SDKConfig.maxCookieSize=o.hasOwnProperty("maxCookieSize")?o.maxCookieSize:k_.DefaultConfig.maxCookieSize,o.hasOwnProperty("appName")&&(this.SDKConfig.appName=o.appName),o.hasOwnProperty("package")&&(this.SDKConfig.package=o.package),this.SDKConfig.integrationDelayTimeout=o.hasOwnProperty("integrationDelayTimeout")?o.integrationDelayTimeout:k_.DefaultConfig.integrationDelayTimeout,o.hasOwnProperty("identifyRequest")&&(this.SDKConfig.identifyRequest=o.identifyRequest),o.hasOwnProperty("identityCallback")){var S=o.identityCallback;s._Helpers.Validators.isFunction(S)?this.SDKConfig.identityCallback=o.identityCallback:s.Logger.warning("The optional callback must be a function. You tried entering a(n) "+_typeof$1(S)+" . Callback not set. Please set your callback again.")}if(o.hasOwnProperty("appVersion")&&(this.SDKConfig.appVersion=o.appVersion),o.hasOwnProperty("appName")&&(this.SDKConfig.appName=o.appName),o.hasOwnProperty("sessionTimeout")&&(this.SDKConfig.sessionTimeout=o.sessionTimeout),o.hasOwnProperty("dataPlan")){this.SDKConfig.dataPlan={PlanVersion:null,PlanId:null};var E=o.dataPlan;E.planId&&(Ob(E.planId)?this.SDKConfig.dataPlan.PlanId=E.planId:s.Logger.error("Your data plan id must be a string and match the data plan slug format (i.e. under_case_slug)")),E.planVersion&&(Rb(E.planVersion)?this.SDKConfig.dataPlan.PlanVersion=E.planVersion:s.Logger.error("Your data plan version must be a number"))}else this.SDKConfig.dataPlan={};if(this.SDKConfig.forceHttps=!o.hasOwnProperty("forceHttps")||o.forceHttps,this.SDKConfig.customFlags=o.customFlags||{},this.SDKConfig.minWebviewBridgeVersion=o.hasOwnProperty("minWebviewBridgeVersion")?o.minWebviewBridgeVersion:1,this.SDKConfig.aliasMaxWindow=o.hasOwnProperty("aliasMaxWindow")?o.aliasMaxWindow:k_.DefaultConfig.aliasMaxWindow,o.hasOwnProperty("dataPlanOptions")){var A=o.dataPlanOptions;A.hasOwnProperty("dataPlanVersion")&&A.hasOwnProperty("blockUserAttributes")&&A.hasOwnProperty("blockEventAttributes")&&A.hasOwnProperty("blockEvents")&&A.hasOwnProperty("blockUserIdentities")||s.Logger.error('Ensure your config.dataPlanOptions object has the following keys: a "dataPlanVersion" object, and "blockUserAttributes", "blockEventAttributes", "blockEvents", "blockUserIdentities" booleans')}o.hasOwnProperty("onCreateBatch")&&("function"==typeof o.onCreateBatch?this.SDKConfig.onCreateBatch=o.onCreateBatch:(s.Logger.error("config.onCreateBatch must be a function"),this.SDKConfig.onCreateBatch=void 0)),o.hasOwnProperty("flags")||(this.SDKConfig.flags={}),this.SDKConfig.flags.hasOwnProperty(k_.FeatureFlags.EventBatchingIntervalMillis)||(this.SDKConfig.flags[k_.FeatureFlags.EventBatchingIntervalMillis]=k_.DefaultConfig.uploadInterval),this.SDKConfig.flags.hasOwnProperty(k_.FeatureFlags.ReportBatching)||(this.SDKConfig.flags[k_.FeatureFlags.ReportBatching]=!1),this.SDKConfig.flags.hasOwnProperty(k_.FeatureFlags.OfflineStorage)||(this.SDKConfig.flags[k_.FeatureFlags.OfflineStorage]=0)}}function Logger$5(o){var s=this,m=o.logLevel||"warning";this.logger=o.hasOwnProperty("logger")?o.logger:new ConsoleLogger,this.verbose=function(o){"none"!==m&&s.logger.verbose&&"verbose"===m&&s.logger.verbose(o)},this.warning=function(o){"none"!==m&&s.logger.warning&&("verbose"===m||"warning"===m)&&s.logger.warning(o)},this.error=function(o){"none"!==m&&s.logger.error&&s.logger.error(o)},this.setLogLevel=function(o){m=o}}function ConsoleLogger(){this.verbose=function(o){console&&console.info&&console.info(o)},this.error=function(o){console&&console.error&&console.error(o)},this.warning=function(o){console&&console.warn&&console.warn(o)}}var aS=h_.Base64,oS=k_.Messages,sS=k_.Base64CookieKeys,uS=k_.SDKv2NonMPIDCookieKeys,lS=k_.StorageNames;function _Persistence(o){function b(s){var m=o._Store;return s.gs.sid=m.sessionId,s.gs.ie=m.isEnabled,s.gs.sa=m.sessionAttributes,s.gs.ss=m.serverSettings,s.gs.dt=m.devToken,s.gs.les=m.dateLastEventSent?m.dateLastEventSent.getTime():null,s.gs.av=m.SDKConfig.appVersion,s.gs.cgid=m.clientId,s.gs.das=m.deviceId,s.gs.c=m.context,s.gs.ssd=m.sessionStartDate?m.sessionStartDate.getTime():0,s.gs.ia=m.integrationAttributes,s}function c(o){localStorage.removeItem(o)}function d(o,m,_){return s.encodePersistence(JSON.stringify(o))+";expires="+m+";path=/"+_}var s=this;this.useLocalStorage=function(){return!o._Store.SDKConfig.useCookieStorage&&o._Store.isLocalStorageAvailable},this.initializeStorage=function(){try{var m,_,S=s.getLocalStorage(),E=s.getCookie();S||E?o._Store.isFirstRun=!1:(o._Store.isFirstRun=!0,o._Store.mpid=0),o._Store.isLocalStorageAvailable||(o._Store.SDKConfig.useCookieStorage=!0),o._Store.isLocalStorageAvailable?(m=window.localStorage,o._Store.SDKConfig.useCookieStorage?(S?(_=E?o._Helpers.extend(!1,S,E):S,m.removeItem(o._Store.storageName)):E&&(_=E),s.storeDataInMemory(_)):E?(_=S?o._Helpers.extend(!1,S,E):E,s.storeDataInMemory(_),s.expireCookies(o._Store.storageName)):s.storeDataInMemory(S)):s.storeDataInMemory(E);try{if(o._Store.isLocalStorageAvailable){var A=localStorage.getItem(o._Store.prodStorageName);if(A)var O=JSON.parse(aS.decode(A));o._Store.mpid&&s.storeProductsInMemory(O,o._Store.mpid)}}catch(m){o._Store.isLocalStorageAvailable&&localStorage.removeItem(o._Store.prodStorageName),o._Store.cartProducts=[],o.Logger.error("Error loading products in initialization: "+m)}for(var H in _)_.hasOwnProperty(H)&&(uS[H]||(o._Store.nonCurrentUserMPIDs[H]=_[H]));s.update()}catch(m){s.useLocalStorage()&&o._Store.isLocalStorageAvailable?localStorage.removeItem(o._Store.storageName):s.expireCookies(o._Store.storageName),o.Logger.error("Error initializing storage: "+m)}},this.update=function(){o._Store.webviewBridgeEnabled||(o._Store.SDKConfig.useCookieStorage&&s.setCookie(),s.setLocalStorage())},this.storeProductsInMemory=function(s,m){if(s)try{o._Store.cartProducts=s[m]&&s[m].cp?s[m].cp:[]}catch(s){o.Logger.error(oS.ErrorMessages.CookieParseError)}},this.storeDataInMemory=function(s,m){try{s?(o._Store.mpid=m||(s.cu||0),s.gs=s.gs||{},o._Store.sessionId=s.gs.sid||o._Store.sessionId,o._Store.isEnabled=void 0===s.gs.ie?o._Store.isEnabled:s.gs.ie,o._Store.sessionAttributes=s.gs.sa||o._Store.sessionAttributes,o._Store.serverSettings=s.gs.ss||o._Store.serverSettings,o._Store.devToken=o._Store.devToken||s.gs.dt,o._Store.SDKConfig.appVersion=o._Store.SDKConfig.appVersion||s.gs.av,o._Store.clientId=s.gs.cgid||o._Store.clientId||o._Helpers.generateUniqueId(),o._Store.deviceId=o._Store.deviceId||s.gs.das||o._Helpers.generateUniqueId(),o._Store.integrationAttributes=s.gs.ia||{},o._Store.context=s.gs.c||o._Store.context,o._Store.currentSessionMPIDs=s.gs.csm||o._Store.currentSessionMPIDs,o._Store.isLoggedIn=!0===s.l,s.gs.les&&(o._Store.dateLastEventSent=new Date(s.gs.les)),o._Store.sessionStartDate=s.gs.ssd?new Date(s.gs.ssd):new Date,s=m?s[m]:s[s.cu]):(o.Logger.verbose(oS.InformationMessages.CookieNotFound),o._Store.clientId=o._Store.clientId||o._Helpers.generateUniqueId(),o._Store.deviceId=o._Store.deviceId||o._Helpers.generateUniqueId())}catch(s){o.Logger.error(oS.ErrorMessages.CookieParseError)}},this.determineLocalStorageAvailability=function(o){var s;window.mParticle&&window.mParticle._forceNoLocalStorage&&(o=void 0);try{return o.setItem("mparticle","test"),s="test"===o.getItem("mparticle"),o.removeItem("mparticle"),s&&o}catch(o){return!1}},this.getUserProductsFromLS=function(s){if(!o._Store.isLocalStorageAvailable)return[];var m,_,S=localStorage.getItem(o._Store.prodStorageName);if(S&&(m=aS.decode(S)),!s)return[];try{return m&&(_=JSON.parse(m)),m&&_[s]&&_[s].cp&&Array.isArray(_[s].cp)?_[s].cp:[]}catch(o){return[]}},this.getAllUserProductsFromLS=function(){var s,m,_=localStorage.getItem(o._Store.prodStorageName);_&&(s=aS.decode(_));try{m=JSON.parse(s)}catch(o){m={}}return m},this.setLocalStorage=function(){if(o._Store.isLocalStorageAvailable){var m=o._Store.storageName,_=s.getAllUserProductsFromLS(),S=s.getLocalStorage()||{},E=o.Identity.getCurrentUser(),A=E?E.getMPID():null,O={cp:_[A]?_[A].cp:[]};if(A){(_=_||{})[A]=O;try{window.localStorage.setItem(encodeURIComponent(o._Store.prodStorageName),aS.encode(JSON.stringify(_)))}catch(s){o.Logger.error("Error with setting products on localStorage.")}}if(!o._Store.SDKConfig.useCookieStorage){S.gs=S.gs||{},S.l=o._Store.isLoggedIn?1:0,o._Store.sessionId&&(S.gs.csm=o._Store.currentSessionMPIDs),S.gs.ie=o._Store.isEnabled,A&&(S.cu=A),Object.keys(o._Store.nonCurrentUserMPIDs).length&&(S=o._Helpers.extend({},S,o._Store.nonCurrentUserMPIDs),o._Store.nonCurrentUserMPIDs={}),S=b(S);try{window.localStorage.setItem(encodeURIComponent(m),s.encodePersistence(JSON.stringify(S)))}catch(s){o.Logger.error("Error with setting localStorage item.")}}}},this.getLocalStorage=function(){if(!o._Store.isLocalStorageAvailable)return null;var m,_=o._Store.storageName,S=s.decodePersistence(window.localStorage.getItem(_)),E={};if(S)for(m in S=JSON.parse(S))S.hasOwnProperty(m)&&(E[m]=S[m]);return Object.keys(E).length?E:null},this.expireCookies=function(o){var m,_,S,E=new Date;_=""===(S=s.getCookieDomain())?"":";domain="+S,E.setTime(E.getTime()-864e5),m="; expires="+E.toUTCString(),document.cookie=o+"="+m+"; path=/"+_},this.getCookie=function(){var m,_,S,E,A,O=window.document.cookie.split("; "),H=o._Store.storageName,K=H?void 0:{};for(o.Logger.verbose(oS.InformationMessages.CookieSearch),m=0,_=O.length;m<_;m++){try{E=(S=O[m].split("=")).shift(),A=S.join("=")}catch(m){o.Logger.verbose("Unable to parse cookie: "+E+". Skipping.")}if(H&&H===E){K=o._Helpers.converted(A);break}H||(K[E]=o._Helpers.converted(A))}return K?(o.Logger.verbose(oS.InformationMessages.CookieFound),JSON.parse(s.decodePersistence(K))):null},this.setCookie=function(){var m,_=o.Identity.getCurrentUser();_&&(m=_.getMPID());var S,E,A,O=new Date,H=o._Store.storageName,K=s.getCookie()||{},z=new Date(O.getTime()+24*o._Store.SDKConfig.cookieExpiration*60*60*1e3).toGMTString();E=""===(S=s.getCookieDomain())?"":";domain="+S,K.gs=K.gs||{},o._Store.sessionId&&(K.gs.csm=o._Store.currentSessionMPIDs),m&&(K.cu=m),K.l=o._Store.isLoggedIn?1:0,K=b(K),Object.keys(o._Store.nonCurrentUserMPIDs).length&&(K=o._Helpers.extend({},K,o._Store.nonCurrentUserMPIDs),o._Store.nonCurrentUserMPIDs={}),A=s.reduceAndEncodePersistence(K,z,E,o._Store.SDKConfig.maxCookieSize),o.Logger.verbose(oS.InformationMessages.CookieSet),window.document.cookie=encodeURIComponent(H)+"="+A},this.reduceAndEncodePersistence=function(s,m,_,S){var E,A=s.gs.csm?s.gs.csm:[];if(A.length){var O={};for(var H in s)s.hasOwnProperty(H)&&(uS[H]||H===s.cu||(O[H]=1));if(Object.keys(O).length)for(var K in O)(E=d(s,m,_)).length>S&&O.hasOwnProperty(K)&&-1===A.indexOf(K)&&delete s[K];for(var z,G=0;G<A.length&&(E=d(s,m,_)).length>S;G++)s[z=A[G]]?(o.Logger.verbose("Size of new encoded cookie is larger than maxCookieSize setting of "+S+". Removing from cookie the earliest logged in MPID containing: "+JSON.stringify(s[z],0,2)),delete s[z]):o.Logger.error("Unable to save MPID data to cookies because the resulting encoded cookie is larger than the maxCookieSize setting of "+S+". We recommend using a maxCookieSize of 1500.")}else for(var q in s)s.hasOwnProperty(q)&&((E=d(s,m,_)).length>S&&!uS[q]&&q!==s.cu&&delete s[q]);return E},this.findPrevCookiesBasedOnUI=function(m){var _,S=o._Persistence.getPersistence();if(m)for(var E in m.userIdentities)if(S&&Object.keys(S).length)for(var A in S)if(S[A].mpid){var O=S[A].ui;for(var H in O)if(E===H&&m.userIdentities[E]===O[H]){_=A;break}}_&&s.storeDataInMemory(S,_)},this.encodePersistence=function(s){for(var m in(s=JSON.parse(s)).gs)s.gs.hasOwnProperty(m)&&(sS[m]?s.gs[m]&&(Array.isArray(s.gs[m])&&s.gs[m].length||o._Helpers.isObject(s.gs[m])&&Object.keys(s.gs[m]).length)?s.gs[m]=aS.encode(JSON.stringify(s.gs[m])):delete s.gs[m]:"ie"===m?s.gs[m]=s.gs[m]?1:0:!s.gs[m]&&delete s.gs[m]);for(var _ in s)if(s.hasOwnProperty(_)&&!uS[_])for(m in s[_])s[_].hasOwnProperty(m)&&sS[m]&&(o._Helpers.isObject(s[_][m])&&Object.keys(s[_][m]).length?s[_][m]=aS.encode(JSON.stringify(s[_][m])):delete s[_][m]);return X_(JSON.stringify(s))},this.decodePersistence=function(s){try{if(s){if(s=JSON.parse(Y_(s)),o._Helpers.isObject(s)&&Object.keys(s).length){for(var m in s.gs)s.gs.hasOwnProperty(m)&&(sS[m]?s.gs[m]=JSON.parse(aS.decode(s.gs[m])):"ie"===m&&(s.gs[m]=!!s.gs[m]));for(var _ in s)if(s.hasOwnProperty(_))if(uS[_])"l"===_&&(s[_]=!!s[_]);else for(m in s[_])s[_].hasOwnProperty(m)&&sS[m]&&s[_][m].length&&(s[_][m]=JSON.parse(aS.decode(s[_][m])))}return JSON.stringify(s)}}catch(s){o.Logger.error("Problem with decoding cookie",s)}},this.getCookieDomain=function(){if(o._Store.SDKConfig.cookieDomain)return o._Store.SDKConfig.cookieDomain;var m=s.getDomain(document,location.hostname);return""===m?"":"."+m},this.getDomain=function(o,s){var m,_,S=s.split(".");for(m=S.length-1;0<=m;m--)if(_=S.slice(m).join("."),o.cookie="mptest=cookie;domain=."+_+";",-1<o.cookie.indexOf("mptest=cookie"))return o.cookie="mptest=;domain=."+_+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",_;return""},this.getUserIdentities=function(o){var m=s.getPersistence();return m&&m[o]&&m[o].ui?m[o].ui:{}},this.getAllUserAttributes=function(o){var m=s.getPersistence();return m&&m[o]&&m[o].ua?m[o].ua:{}},this.getCartProducts=function(s){var m,_=localStorage.getItem(o._Store.prodStorageName);return _&&((m=JSON.parse(aS.decode(_)))&&m[s]&&m[s].cp)?m[s].cp:[]},this.setCartProducts=function(s){if(o._Store.isLocalStorageAvailable)try{window.localStorage.setItem(encodeURIComponent(o._Store.prodStorageName),aS.encode(JSON.stringify(s)))}catch(s){o.Logger.error("Error with setting products on localStorage.")}},this.saveUserIdentitiesToPersistence=function(o,m){if(m){var _=s.getPersistence();_&&(_[o]?_[o].ui=m:_[o]={ui:m},s.savePersistence(_))}},this.saveUserAttributesToPersistence=function(o,m){var _=s.getPersistence();m&&(_&&(_[o]?_[o].ui=m:_[o]={ui:m}),s.savePersistence(_))},this.saveUserCookieSyncDatesToPersistence=function(o,m){if(m){var _=s.getPersistence();_&&(_[o]?_[o].csd=m:_[o]={csd:m}),s.savePersistence(_)}},this.saveUserConsentStateToCookies=function(m,_){if(_||null===_){var S=s.getPersistence();S&&(S[m]?S[m].con=o._Consent.ConsentSerialization.toMinifiedJsonObject(_):S[m]={con:o._Consent.ConsentSerialization.toMinifiedJsonObject(_)},s.savePersistence(S))}},this.savePersistence=function(m){var _,S=s.encodePersistence(JSON.stringify(m)),E=new Date,A=o._Store.storageName,O=new Date(E.getTime()+24*o._Store.SDKConfig.cookieExpiration*60*60*1e3).toGMTString(),H=s.getCookieDomain();if(_=""===H?"":";domain="+H,o._Store.SDKConfig.useCookieStorage){var K=s.reduceAndEncodePersistence(m,O,_,o._Store.SDKConfig.maxCookieSize);window.document.cookie=encodeURIComponent(A)+"="+K}else o._Store.isLocalStorageAvailable&&localStorage.setItem(o._Store.storageName,S)},this.getPersistence=function(){return this.useLocalStorage()?this.getLocalStorage():this.getCookie()},this.getConsentState=function(m){var _=s.getPersistence();return _&&_[m]&&_[m].con?o._Consent.ConsentSerialization.fromMinifiedJsonObject(_[m].con):null},this.getFirstSeenTime=function(o){if(!o)return null;var m=s.getPersistence();return m&&m[o]&&m[o].fst?m[o].fst:null},this.setFirstSeenTime=function(o,m){if(o){m||(m=(new Date).getTime());var _=s.getPersistence();_&&(!_[o]&&(_[o]={}),!_[o].fst&&(_[o].fst=m,s.savePersistence(_)))}},this.getLastSeenTime=function(m){if(!m)return null;if(m===o.Identity.getCurrentUser().getMPID())return(new Date).getTime();var _=s.getPersistence();return _&&_[m]&&_[m].lst?_[m].lst:null},this.setLastSeenTime=function(o,m){if(o){m||(m=(new Date).getTime());var _=s.getPersistence();_&&_[o]&&(_[o].lst=m,s.savePersistence(_))}},this.getDeviceId=function(){return o._Store.deviceId},this.setDeviceId=function(m){o._Store.deviceId=m,s.update()},this.resetPersistence=function(){c(lS.localStorageName),c(lS.localStorageNameV3),c(lS.localStorageNameV4),c(o._Store.prodStorageName),c(o._Store.storageName),c(lS.localStorageProductsV4),s.expireCookies(lS.cookieName),s.expireCookies(lS.cookieNameV2),s.expireCookies(lS.cookieNameV3),s.expireCookies(lS.cookieNameV4),s.expireCookies(o._Store.prodStorageName),s.expireCookies(o._Store.storageName),mParticle._isTestEnv&&(c(o._Helpers.createMainStorageName("abcdef")),s.expireCookies(o._Helpers.createMainStorageName("abcdef")),c(o._Helpers.createProductStorageName("abcdef")))},this.forwardingStatsBatches={uploadsTable:{},forwardingStatsEventQueue:[]}}var cS=k_.Messages;function Events$2(o){var s=this;this.logEvent=function(s,m){if(o.Logger.verbose(cS.InformationMessages.StartingLogEvent+": "+s.name),o._Helpers.canLog()){var _=o._ServerModel.createEventObject(s);o._APIClient.sendEventToServer(_,m)}else o.Logger.verbose(cS.InformationMessages.AbandonLogEvent)},this.startTracking=function(s){function c(s,m){if(s)try{m?s(m):s()}catch(s){o.Logger.error("Error invoking the callback passed to startTrackingLocation."),o.Logger.error(s)}}if(o._Store.isTracking){var m={coords:{latitude:o._Store.currentPosition.lat,longitude:o._Store.currentPosition.lng}};c(s,m)}else"geolocation"in navigator&&(o._Store.watchPositionId=navigator.geolocation.watchPosition((function e(m){o._Store.currentPosition={lat:m.coords.latitude,lng:m.coords.longitude},c(s,m),s=null,o._Store.isTracking=!0}),(function d(){c(s),s=null,o._Store.isTracking=!1})))},this.stopTracking=function(){o._Store.isTracking&&(navigator.geolocation.clearWatch(o._Store.watchPositionId),o._Store.currentPosition=null,o._Store.isTracking=!1)},this.logOptOut=function(){o.Logger.verbose(cS.InformationMessages.StartingLogOptOut);var s=o._ServerModel.createEventObject({messageType:T_.MessageType.OptOut,eventType:T_.EventType.Other});o._APIClient.sendEventToServer(s)},this.logAST=function(){s.logEvent({messageType:T_.MessageType.AppStateTransition})},this.logCheckoutEvent=function(m,_,S,E){var A=o._Ecommerce.createCommerceEventObject(E);A&&(A.EventName+=o._Ecommerce.getProductActionEventName(T_.ProductActionType.Checkout),A.EventCategory=T_.CommerceEventType.ProductCheckout,A.ProductAction={ProductActionType:T_.ProductActionType.Checkout,CheckoutStep:m,CheckoutOptions:_,ProductList:[]},s.logCommerceEvent(A,S))},this.logProductActionEvent=function(m,_,S,E,A,O){var H=o._Ecommerce.createCommerceEventObject(E),K=Array.isArray(_)?_:[_];K.forEach((function(s){s.TotalAmount&&(s.TotalAmount=o._Ecommerce.sanitizeAmount(s.TotalAmount,"TotalAmount")),s.Position&&(s.Position=o._Ecommerce.sanitizeAmount(s.Position,"Position")),s.Price&&(s.Price=o._Ecommerce.sanitizeAmount(s.Price,"Price")),s.Quantity&&(s.Quantity=o._Ecommerce.sanitizeAmount(s.Quantity,"Quantity"))})),H&&(H.EventCategory=o._Ecommerce.convertProductActionToEventType(m),H.EventName+=o._Ecommerce.getProductActionEventName(m),H.ProductAction={ProductActionType:m,ProductList:K},o._Helpers.isObject(A)&&o._Ecommerce.convertTransactionAttributesToProductAction(A,H.ProductAction),s.logCommerceEvent(H,S,O))},this.logPurchaseEvent=function(m,_,S,E){var A=o._Ecommerce.createCommerceEventObject(E);A&&(A.EventName+=o._Ecommerce.getProductActionEventName(T_.ProductActionType.Purchase),A.EventCategory=T_.CommerceEventType.ProductPurchase,A.ProductAction={ProductActionType:T_.ProductActionType.Purchase},A.ProductAction.ProductList=o._Ecommerce.buildProductList(A,_),o._Ecommerce.convertTransactionAttributesToProductAction(m,A.ProductAction),s.logCommerceEvent(A,S))},this.logRefundEvent=function(m,_,S,E){if(m){var A=o._Ecommerce.createCommerceEventObject(E);A&&(A.EventName+=o._Ecommerce.getProductActionEventName(T_.ProductActionType.Refund),A.EventCategory=T_.CommerceEventType.ProductRefund,A.ProductAction={ProductActionType:T_.ProductActionType.Refund},A.ProductAction.ProductList=o._Ecommerce.buildProductList(A,_),o._Ecommerce.convertTransactionAttributesToProductAction(m,A.ProductAction),s.logCommerceEvent(A,S))}else o.Logger.error(cS.ErrorMessages.TransactionRequired)},this.logPromotionEvent=function(m,_,S,E,A){var O=o._Ecommerce.createCommerceEventObject(E);O&&(O.EventName+=o._Ecommerce.getPromotionActionEventName(m),O.EventCategory=o._Ecommerce.convertPromotionActionToEventType(m),O.PromotionAction={PromotionActionType:m,PromotionList:Array.isArray(_)?_:[_]},s.logCommerceEvent(O,S,A))},this.logImpressionEvent=function(m,_,S,E){var A=o._Ecommerce.createCommerceEventObject(S);A&&(A.EventName+="Impression",A.EventCategory=T_.CommerceEventType.ProductImpression,!Array.isArray(m)&&(m=[m]),A.ProductImpressions=[],m.forEach((function(o){A.ProductImpressions.push({ProductImpressionList:o.Name,ProductList:Array.isArray(o.Product)?o.Product:[o.Product]})})),s.logCommerceEvent(A,_,E))},this.logCommerceEvent=function(s,m,_){return o.Logger.verbose(cS.InformationMessages.StartingLogCommerceEvent),s.ProductAction&&null===s.EventCategory?void o.Logger.error("Commerce event not sent.  The mParticle.ProductActionType you passed was invalid. Re-check your code."):(m=o._Helpers.sanitizeAttributes(m,s.EventName),void(o._Helpers.canLog()?(o._Store.webviewBridgeEnabled&&(s.ShoppingCart={}),m&&(s.EventAttributes=m),o._APIClient.sendEventToServer(s,_),o._Persistence.update()):o.Logger.verbose(cS.InformationMessages.AbandonLogEvent)))},this.addEventHandler=function(m,_,S,E,A){var O,H,K=[],z=function handler(m){o.Logger.verbose("DOM event triggered, handling event"),s.logEvent({messageType:T_.MessageType.PageEvent,name:"function"==typeof S?S(O):S,data:"function"==typeof E?E(O):E,eventType:A||T_.EventType.Other}),(O.href&&"_blank"!==O.target||O.submit)&&(m.preventDefault?m.preventDefault():m.returnValue=!1,setTimeout((function timeoutHandler(){O.href?window.location.href=O.href:O.submit&&O.submit()}),o._Store.SDKConfig.timeout))};if(_)if("string"==typeof _?K=document.querySelectorAll(_):_.nodeType&&(K=[_]),K.length)for(o.Logger.verbose("Found "+K.length+" element"+(1<K.length?"s":"")+", attaching event handlers"),H=0;H<K.length;H++)(O=K[H]).addEventListener?O.addEventListener(m,z,!1):O.attachEvent?O.attachEvent("on"+m,z):O["on"+m]=z;else o.Logger.verbose("No elements found");else o.Logger.error("Can't bind event, selector is required")}}function filteredMparticleUser(o,s,m,_){var S=this;return{getUserIdentities:function getUserIdentities(){var S={},E=m._Persistence.getUserIdentities(o);for(var A in E)if(E.hasOwnProperty(A)){var O=T_.IdentityType.getIdentityName(m._Helpers.parseNumber(A));_&&(!_||_.isIdentityBlocked(O))||(S[O]=E[A])}return{userIdentities:S=m._Helpers.filterUserIdentitiesForForwarders(S,s.userIdentityFilters)}},getMPID:function getMPID(){return o},getUserAttributesLists:function getUserAttributesLists(o){var s,E={};for(var A in s=S.getAllUserAttributes())s.hasOwnProperty(A)&&Array.isArray(s[A])&&(_&&(!_||_.isAttributeKeyBlocked(A))||(E[A]=s[A].slice()));return E=m._Helpers.filterUserAttributes(E,o.userAttributeFilters)},getAllUserAttributes:function getAllUserAttributes(){var S={},E=m._Persistence.getAllUserAttributes(o);if(E)for(var A in E)E.hasOwnProperty(A)&&(_&&(!_||_.isAttributeKeyBlocked(A))||(Array.isArray(E[A])?S[A]=E[A].slice():S[A]=E[A]));return S=m._Helpers.filterUserAttributes(S,s.userAttributeFilters)}}}function Forwarders(o,s){var m=this,_="setUserAttribute",S="removeUserAttribute";this.initForwarders=function(s,_){var S=o.Identity.getCurrentUser();!o._Store.webviewBridgeEnabled&&o._Store.configuredForwarders&&(o._Store.configuredForwarders.sort((function(o,s){return o.settings.PriorityValue=o.settings.PriorityValue||0,s.settings.PriorityValue=s.settings.PriorityValue||0,-1*(o.settings.PriorityValue-s.settings.PriorityValue)})),o._Store.activeForwarders=o._Store.configuredForwarders.filter((function(E){if(!o._Consent.isEnabledForUserConsent(E.filteringConsentRuleValues,S))return!1;if(!m.isEnabledForUserAttributes(E.filteringUserAttributeValue,S))return!1;if(!m.isEnabledForUnknownUser(E.excludeAnonymousUser,S))return!1;var A=o._Helpers.filterUserIdentities(s,E.userIdentityFilters),O=o._Helpers.filterUserAttributes(S?S.getAllUserAttributes():{},E.userAttributeFilters);return E.initialized||(E.logger=o.Logger,E.init(E.settings,_,!1,null,O,A,o._Store.SDKConfig.appVersion,o._Store.SDKConfig.appName,o._Store.SDKConfig.customFlags,o._Store.clientId),E.initialized=!0),!0})))},this.isEnabledForUserAttributes=function(s,m){if(!s||!o._Helpers.isObject(s)||!Object.keys(s).length)return!0;var _,S,E;if(!m)return!1;E=m.getAllUserAttributes();var A=!1;try{if(E&&o._Helpers.isObject(E)&&Object.keys(E).length)for(var O in E)if(E.hasOwnProperty(O)&&(_=Yb.hashAttributeConditionalForwarding(O),S=Yb.hashAttributeConditionalForwarding(E[O]),_===s.userAttributeName&&S===s.userAttributeValue)){A=!0;break}return!s||s.includeOnMatch===A}catch(o){return!0}},this.isEnabledForUnknownUser=function(o,s){return!!(s&&s.isLoggedIn()||!o)},this.applyToForwarders=function(s,m){o._Store.activeForwarders.length&&o._Store.activeForwarders.forEach((function(_){if(_[s])try{var S=_[s](m);S&&o.Logger.verbose(S)}catch(s){o.Logger.verbose(s)}}))},this.sendEventToForwarders=function(s){var m,_,S,E=function f(s,m){s.UserIdentities&&s.UserIdentities.length&&s.UserIdentities.forEach((function(_,S){o._Helpers.inArray(m,Yb.hashUserIdentity(_.Type))&&(s.UserIdentities.splice(S,1),0<S&&S--)}))},A=function g(s,m){var _;if(m)for(var S in s.EventAttributes)s.EventAttributes.hasOwnProperty(S)&&(_=Yb.hashEventAttributeKey(s.EventCategory,s.EventName,S),o._Helpers.inArray(m,_)&&delete s.EventAttributes[S])},O=function h(s,m){return!!(s&&s.length&&o._Helpers.inArray(s,m))},H=[T_.MessageType.PageEvent,T_.MessageType.PageView,T_.MessageType.Commerce];if(!o._Store.webviewBridgeEnabled&&o._Store.activeForwarders){_=Yb.hashEventName(s.EventName,s.EventCategory),S=Yb.hashEventType(s.EventCategory);for(var K=0;K<o._Store.activeForwarders.length;K++){if(-1<H.indexOf(s.EventDataType)&&o._Store.activeForwarders[K].filteringEventAttributeValue&&o._Store.activeForwarders[K].filteringEventAttributeValue.eventAttributeName&&o._Store.activeForwarders[K].filteringEventAttributeValue.eventAttributeValue){var z=null;if(s.EventAttributes)for(var G in s.EventAttributes){var q;if((q=Yb.hashAttributeConditionalForwarding(G))===o._Store.activeForwarders[K].filteringEventAttributeValue.eventAttributeName&&(z={name:q,value:Yb.hashAttributeConditionalForwarding(s.EventAttributes[G])}),z)break}var X=null!==z&&z.value===o._Store.activeForwarders[K].filteringEventAttributeValue.eventAttributeValue;if(!(!0===o._Store.activeForwarders[K].filteringEventAttributeValue.includeOnMatch?X:!X))continue}if((m={},m=o._Helpers.extend(!0,m,s),s.EventDataType!==T_.MessageType.PageEvent||!O(o._Store.activeForwarders[K].eventNameFilters,_)&&!O(o._Store.activeForwarders[K].eventTypeFilters,S))&&((s.EventDataType!==T_.MessageType.Commerce||!O(o._Store.activeForwarders[K].eventTypeFilters,S))&&(s.EventDataType!==T_.MessageType.PageView||!O(o._Store.activeForwarders[K].screenNameFilters,_))&&(m.EventAttributes&&(s.EventDataType===T_.MessageType.PageEvent?A(m,o._Store.activeForwarders[K].attributeFilters):s.EventDataType===T_.MessageType.PageView&&A(m,o._Store.activeForwarders[K].screenAttributeFilters)),E(m,o._Store.activeForwarders[K].userIdentityFilters),m.UserAttributes=o._Helpers.filterUserAttributes(m.UserAttributes,o._Store.activeForwarders[K].userAttributeFilters),o._Store.activeForwarders[K].process))){o.Logger.verbose("Sending message to forwarder: "+o._Store.activeForwarders[K].name);var J=o._Store.activeForwarders[K].process(m);J&&o.Logger.verbose(J)}}}},this.handleForwarderUserAttributes=function(m,E,A){s&&s.isAttributeKeyBlocked(E)||!o._Store.activeForwarders.length||o._Store.activeForwarders.forEach((function(s){if(s[m]&&!o._Helpers.isFilteredUserAttribute(E,s.userAttributeFilters))try{var O;m===_?O=s.setUserAttribute(E,A):m===S&&(O=s.removeUserAttribute(E)),O&&o.Logger.verbose(O)}catch(s){o.Logger.error(s)}}))},this.setForwarderUserIdentities=function(s){o._Store.activeForwarders.forEach((function(m){var _=o._Helpers.filterUserIdentities(s,m.userIdentityFilters);m.setUserIdentity&&_.forEach((function(s){var _=m.setUserIdentity(s.Identity,s.Type);_&&o.Logger.verbose(_)}))}))},this.setForwarderOnUserIdentified=function(m){o._Store.activeForwarders.forEach((function(_){var S=filteredMparticleUser(m.getMPID(),_,o,s);if(_.onUserIdentified){var E=_.onUserIdentified(S);E&&o.Logger.verbose(E)}}))},this.setForwarderOnIdentityComplete=function(m,_){var S;o._Store.activeForwarders.forEach((function(E){var A=filteredMparticleUser(m.getMPID(),E,o,s);"identify"===_?E.onIdentifyComplete&&((S=E.onIdentifyComplete(A))&&o.Logger.verbose(S)):"login"===_?E.onLoginComplete&&((S=E.onLoginComplete(A))&&o.Logger.verbose(S)):"logout"===_?E.onLogoutComplete&&((S=E.onLogoutComplete(A))&&o.Logger.verbose(S)):"modify"==_&&E.onModifyComplete&&((S=E.onModifyComplete(A))&&o.Logger.verbose(S))}))},this.getForwarderStatsQueue=function(){return o._Persistence.forwardingStatsBatches.forwardingStatsEventQueue},this.setForwarderStatsQueue=function(s){o._Persistence.forwardingStatsBatches.forwardingStatsEventQueue=s},this.processForwarders=function(s,_){s?(this.processUIEnabledKits(s),this.processSideloadedKits(s),m.initForwarders(o._Store.SDKConfig.identifyRequest.userIdentities,_)):o.Logger.warning("No config was passed. Cannot process forwarders")},this.processUIEnabledKits=function(s){var _=this.returnKitConstructors();try{Array.isArray(s.kitConfigs)&&s.kitConfigs.length&&s.kitConfigs.forEach((function(o){m.configureUIEnabledKit(o,_)}))}catch(s){o.Logger.error("MP Kits not configured propertly. Kits may not be initialized. "+s)}},this.returnKitConstructors=function(){var s={};return Fb(o._Store.SDKConfig.kits)?!Fb(o._preInit.forwarderConstructors)&&o._preInit.forwarderConstructors.forEach((function(o){if(o.suffix){var m="".concat(o.name,"-").concat(o.suffix);s[m]=o}else s[o.name]=o})):s=o._Store.SDKConfig.kits,s},this.configureUIEnabledKit=function(s,m){var _=null,S=s;for(var E in m){var A=void 0;if(S.suffix&&(A="".concat(S.name,"-").concat(S.suffix)),!(E!==A&&E!==S.name||S.isDebug!==o._Store.SDKConfig.isDevelopmentMode&&S.isSandbox!==o._Store.SDKConfig.isDevelopmentMode)){_=this.returnConfiguredKit(m[E],S),o._Store.configuredForwarders.push(_);break}}},this.processSideloadedKits=function(s){try{if(Array.isArray(s.sideloadedKits)){var _={kits:{}};for(var S in s.sideloadedKits.forEach((function(o){try{o.kitInstance.register(_)}catch(s){console.error("Error registering sideloaded kit "+o.kitInstance.name)}})),_.kits){var E=_.kits[S];m.configureSideloadedKit(E)}if(!Fb(_.kits)){var A=Object.keys(_.kits);o._Store.sideloadedKitsCount=A.length}}}catch(s){o.Logger.error("Sideloaded Kits not configured propertly. Kits may not be initialized. "+s)}},this.configureSideloadedKit=function(s){o._Store.configuredForwarders.push(this.returnConfiguredKit(s))},this.returnConfiguredKit=function(o){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},m=new o.constructor;return m.id=s.moduleId,m.isSandbox=s.isDebug||s.isSandbox,m.hasSandbox="true"===s.hasDebugString,m.isVisible=s.isVisible||!0,m.settings=s.settings||{},m.eventNameFilters=s.eventNameFilters||[],m.eventTypeFilters=s.eventTypeFilters||[],m.attributeFilters=s.attributeFilters||[],m.screenNameFilters=s.screenNameFilters||[],m.screenAttributeFilters=s.screenAttributeFilters||[],m.userIdentityFilters=s.userIdentityFilters||[],m.userAttributeFilters=s.userAttributeFilters||[],m.filteringEventAttributeValue=s.filteringEventAttributeValue||{},m.filteringUserAttributeValue=s.filteringUserAttributeValue||{},m.eventSubscriptionId=s.eventSubscriptionId||null,m.filteringConsentRuleValues=s.filteringConsentRuleValues||{},m.excludeAnonymousUser=s.excludeAnonymousUser||!1,m},this.configurePixel=function(s){(s.isDebug===o._Store.SDKConfig.isDevelopmentMode||s.isProduction!==o._Store.SDKConfig.isDevelopmentMode)&&o._Store.pixelConfigurations.push(s)},this.processPixelConfigs=function(s){try{Fb(s.pixelConfigs)||s.pixelConfigs.forEach((function(o){m.configurePixel(o)}))}catch(s){o.Logger.error("Cookie Sync configs not configured propertly. Cookie Sync may not be initialized. "+s)}}}var dS=T_.MessageType,hS=T_.ApplicationTransitionType;function convertProductListToV2DTO(o){return o?o.map((function(o){return function convertProductToV2DTO(o){return{id:hb(o.Sku),nm:hb(o.Name),pr:db(o.Price),qt:db(o.Quantity),br:hb(o.Brand),va:hb(o.Variant),ca:hb(o.Category),ps:db(o.Position),cc:hb(o.CouponCode),tpa:db(o.TotalAmount),attrs:o.Attributes}}(o)})):[]}function ServerModel(o){var s=this;this.appendUserInfo=function(s,m){if(m){if(!s)return m.MPID=null,m.ConsentState=null,m.UserAttributes=null,void(m.UserIdentities=null);if(!m.MPID||m.MPID!==s.getMPID()){m.MPID=s.getMPID(),m.ConsentState=s.getConsentState(),m.UserAttributes=s.getAllUserAttributes();var _=s.getUserIdentities().userIdentities,S={};for(var E in _){var A=T_.IdentityType.getIdentityType(E);!1!==A&&(S[A]=_[E])}var O=[];if(o._Helpers.isObject(S)&&Object.keys(S).length)for(var H in S){var K={};K.Identity=S[H],K.Type=o._Helpers.parseNumber(H),O.push(K)}m.UserIdentities=O}}},this.convertToConsentStateV2DTO=function(o){if(!o)return null;var s={},m=o.getGDPRConsentState();if(m){var _={};for(var S in s.gdpr=_,m)if(m.hasOwnProperty(S)){var E=m[S];s.gdpr[S]={},"boolean"==typeof E.Consented&&(_[S].c=E.Consented),"number"==typeof E.Timestamp&&(_[S].ts=E.Timestamp),"string"==typeof E.ConsentDocument&&(_[S].d=E.ConsentDocument),"string"==typeof E.Location&&(_[S].l=E.Location),"string"==typeof E.HardwareId&&(_[S].h=E.HardwareId)}}var A=o.getCCPAConsentState();return A&&(s.ccpa={data_sale_opt_out:{c:A.Consented,ts:A.Timestamp,d:A.ConsentDocument,l:A.Location,h:A.HardwareId}}),s},this.createEventObject=function(m,_){var S={},E={},A=m.messageType===T_.MessageType.OptOut?!o._Store.isEnabled:null;if(o._Store.sessionId||m.messageType===T_.MessageType.OptOut||o._Store.webviewBridgeEnabled){E=m.hasOwnProperty("toEventAPIObject")?m.toEventAPIObject():{EventName:m.name||m.messageType,EventCategory:m.eventType,EventAttributes:o._Helpers.sanitizeAttributes(m.data,m.name),SourceMessageId:m.sourceMessageId||o._Helpers.generateUniqueId(),EventDataType:m.messageType,CustomFlags:m.customFlags||{},UserAttributeChanges:m.userAttributeChanges,UserIdentityChanges:m.userIdentityChanges},m.messageType!==T_.MessageType.SessionEnd&&(o._Store.dateLastEventSent=new Date),S={Store:o._Store.serverSettings,SDKVersion:k_.sdkVersion,SessionId:o._Store.sessionId,SessionStartDate:o._Store.sessionStartDate?o._Store.sessionStartDate.getTime():0,Debug:o._Store.SDKConfig.isDevelopmentMode,Location:o._Store.currentPosition,OptOut:A,ExpandedEventCount:0,AppVersion:o.getAppVersion(),AppName:o.getAppName(),Package:o._Store.SDKConfig.package,ClientGeneratedId:o._Store.clientId,DeviceId:o._Store.deviceId,IntegrationAttributes:o._Store.integrationAttributes,CurrencyCode:o._Store.currencyCode,DataPlan:o._Store.SDKConfig.dataPlan?o._Store.SDKConfig.dataPlan:{}},E.EventDataType===dS.AppStateTransition&&(E.IsFirstRun=o._Store.isFirstRun,E.LaunchReferral=window.location.href||null),E.CurrencyCode=o._Store.currencyCode;var O=_||o.Identity.getCurrentUser();return s.appendUserInfo(O,E),m.messageType===T_.MessageType.SessionEnd&&(E.SessionLength=o._Store.dateLastEventSent.getTime()-o._Store.sessionStartDate.getTime(),E.currentSessionMPIDs=o._Store.currentSessionMPIDs,E.EventAttributes=o._Store.sessionAttributes,o._Store.currentSessionMPIDs=[],o._Store.sessionStartDate=null),S.Timestamp=o._Store.dateLastEventSent.getTime(),o._Helpers.extend({},E,S)}return null},this.convertEventToV2DTO=function(m){var _={n:m.EventName,et:m.EventCategory,ua:m.UserAttributes,ui:m.UserIdentities,ia:m.IntegrationAttributes,str:m.Store,attrs:m.EventAttributes,sdk:m.SDKVersion,sid:m.SessionId,sl:m.SessionLength,ssd:m.SessionStartDate,dt:m.EventDataType,dbg:m.Debug,ct:m.Timestamp,lc:m.Location,o:m.OptOut,eec:m.ExpandedEventCount,av:m.AppVersion,cgid:m.ClientGeneratedId,das:m.DeviceId,mpid:m.MPID,smpids:m.currentSessionMPIDs};m.DataPlan&&m.DataPlan.PlanId&&(_.dp_id=m.DataPlan.PlanId,m.DataPlan.PlanVersion&&(_.dp_v=m.DataPlan.PlanVersion));var S=s.convertToConsentStateV2DTO(m.ConsentState);return S&&(_.con=S),m.EventDataType===dS.AppStateTransition&&(_.fr=m.IsFirstRun,_.iu=!1,_.at=hS.AppInit,_.lr=m.LaunchReferral,_.attrs=null),m.CustomFlags&&function convertCustomFlags(o,s){var m=[];for(var _ in s.flags={},o.CustomFlags)m=[],o.CustomFlags.hasOwnProperty(_)&&(Array.isArray(o.CustomFlags[_])?o.CustomFlags[_].forEach((function(o){("number"==typeof o||"string"==typeof o||"boolean"==typeof o)&&m.push(o.toString())})):("number"==typeof o.CustomFlags[_]||"string"==typeof o.CustomFlags[_]||"boolean"==typeof o.CustomFlags[_])&&m.push(o.CustomFlags[_].toString()),m.length&&(s.flags[_]=m))}(m,_),m.EventDataType===dS.Commerce?(_.cu=m.CurrencyCode,m.ShoppingCart&&(_.sc={pl:convertProductListToV2DTO(m.ShoppingCart.ProductList)}),m.ProductAction?_.pd={an:m.ProductAction.ProductActionType,cs:o._Helpers.parseNumber(m.ProductAction.CheckoutStep),co:m.ProductAction.CheckoutOptions,pl:convertProductListToV2DTO(m.ProductAction.ProductList),ti:m.ProductAction.TransactionId,ta:m.ProductAction.Affiliation,tcc:m.ProductAction.CouponCode,tr:o._Helpers.parseNumber(m.ProductAction.TotalAmount),ts:o._Helpers.parseNumber(m.ProductAction.ShippingAmount),tt:o._Helpers.parseNumber(m.ProductAction.TaxAmount)}:m.PromotionAction?_.pm={an:m.PromotionAction.PromotionActionType,pl:m.PromotionAction.PromotionList.map((function(o){return{id:o.Id,nm:o.Name,cr:o.Creative,ps:o.Position?o.Position:0}}))}:m.ProductImpressions&&(_.pi=m.ProductImpressions.map((function(o){return{pil:o.ProductImpressionList,pl:convertProductListToV2DTO(o.ProductList)}})))):m.EventDataType===dS.Profile&&(_.pet=m.ProfileMessageType),_}}function forwardingStatsUploader(o){this.startForwardingStatsTimer=function(){mParticle._forwardingStatsTimer=setInterval((function(){!function b(){var s=o._Forwarders.getForwarderStatsQueue(),m=o._Persistence.forwardingStatsBatches.uploadsTable,_=Date.now();for(var S in s.length&&(m[_]={uploading:!1,data:s},o._Forwarders.setForwarderStatsQueue([])),m)!function(s){if(m.hasOwnProperty(s)&&!1===m[s].uploading){var _=o._Helpers.createXHR((function d(){4===_.readyState&&(200===_.status||202===_.status?(o.Logger.verbose("Successfully sent  "+_.statusText+" from server"),delete m[s]):"4"===_.status.toString()[0]?429!==_.status&&delete m[s]:m[s].uploading=!1)})),S=m[s].data;m[s].uploading=!0,o._APIClient.sendBatchForwardingStatsToServer(S,_)}}(S)}()}),o._Store.SDKConfig.forwarderStatsTimeout)}}var pS=k_.Messages,fS=k_.HTTPCodes;function Identity(o){var s=this;this.checkIdentitySwap=function(s,m,_){if(s&&m&&s!==m){var S=o._Persistence.getPersistence();S&&(S.cu=m,S.gs.csm=_,o._Persistence.savePersistence(S))}},this.IdentityRequest={createKnownIdentities:function createKnownIdentities(s,m){var _={};if(s&&s.userIdentities&&o._Helpers.isObject(s.userIdentities))for(var S in s.userIdentities)_[S]=s.userIdentities[S];return _.device_application_stamp=m,_},preProcessIdentityRequest:function preProcessIdentityRequest(s,m,_){o.Logger.verbose(pS.InformationMessages.StartingLogEvent+": "+_);var S=o._Helpers.Validators.validateIdentities(s,_);if(!S.valid)return o.Logger.error("ERROR: "+S.error),{valid:!1,error:S.error};if(m&&!o._Helpers.Validators.isFunction(m)){var E="The optional callback must be a function. You tried entering a(n) "+_typeof$1(m);return o.Logger.error(E),{valid:!1,error:E}}return{valid:!0}},createIdentityRequest:function createIdentityRequest(s,m,_,S,E,A,O){return{client_sdk:{platform:m,sdk_vendor:_,sdk_version:S},context:A,environment:o._Store.SDKConfig.isDevelopmentMode?"development":"production",request_id:o._Helpers.generateUniqueId(),request_timestamp_ms:(new Date).getTime(),previous_mpid:O||null,known_identities:this.createKnownIdentities(s,E)}},createModifyIdentityRequest:function createModifyIdentityRequest(s,m,_,S,E,A){return{client_sdk:{platform:_,sdk_vendor:S,sdk_version:E},context:A,environment:o._Store.SDKConfig.isDevelopmentMode?"development":"production",request_id:o._Helpers.generateUniqueId(),request_timestamp_ms:(new Date).getTime(),identity_changes:this.createIdentityChanges(s,m)}},createIdentityChanges:function createIdentityChanges(s,m){var _,S=[];if(m&&o._Helpers.isObject(m)&&s&&o._Helpers.isObject(s))for(_ in m)S.push({old_value:s[_]||null,new_value:m[_],identity_type:_});return S},combineUserIdentities:function combineUserIdentities(s,m){var _={},S=o._Helpers.extend(s,m);for(var E in S){var A=T_.IdentityType.getIdentityType(E);!1!==A&&0<=A&&(_[T_.IdentityType.getIdentityType(E)]=S[E])}return _},createAliasNetworkRequest:function createAliasNetworkRequest(s){return{request_id:o._Helpers.generateUniqueId(),request_type:"alias",environment:o._Store.SDKConfig.isDevelopmentMode?"development":"production",api_key:o._Store.devToken,data:{destination_mpid:s.destinationMpid,source_mpid:s.sourceMpid,start_unixtime_ms:s.startTime,end_unixtime_ms:s.endTime,scope:s.scope,device_application_stamp:o._Store.deviceId}}},convertAliasToNative:function convertAliasToNative(o){return{DestinationMpid:o.destinationMpid,SourceMpid:o.sourceMpid,StartUnixtimeMs:o.startTime,EndUnixtimeMs:o.endTime}},convertToNative:function convertToNative(o){var s=[];if(o&&o.userIdentities){for(var m in o.userIdentities)o.userIdentities.hasOwnProperty(m)&&s.push({Type:T_.IdentityType.getIdentityType(m),Identity:o.userIdentities[m]});return{UserIdentities:s}}}},this.IdentityAPI={HTTPCodes:fS,identify:function identify(m,_){var S,E=o.Identity.getCurrentUser(),A=o._Identity.IdentityRequest.preProcessIdentityRequest(m,_,"identify");if(E&&(S=E.getMPID()),A.valid){var O=o._Identity.IdentityRequest.createIdentityRequest(m,k_.platform,k_.sdkVendor,k_.sdkVersion,o._Store.deviceId,o._Store.context,S);o._Helpers.canLog()?o._Store.webviewBridgeEnabled?(o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.Identify,JSON.stringify(o._Identity.IdentityRequest.convertToNative(m))),o._Helpers.invokeCallback(_,fS.nativeIdentityRequest,"Identify request sent to native sdk")):o._IdentityAPIClient.sendIdentityRequest(O,"identify",_,m,s.parseIdentityResponse,S):(o._Helpers.invokeCallback(_,fS.loggingDisabledOrMissingAPIKey,pS.InformationMessages.AbandonLogEvent),o.Logger.verbose(pS.InformationMessages.AbandonLogEvent))}else o._Helpers.invokeCallback(_,fS.validationIssue,A.error),o.Logger.verbose(A)},logout:function logout(m,_){var S,E=o.Identity.getCurrentUser(),A=o._Identity.IdentityRequest.preProcessIdentityRequest(m,_,"logout");if(E&&(S=E.getMPID()),A.valid){var O,H=o._Identity.IdentityRequest.createIdentityRequest(m,k_.platform,k_.sdkVendor,k_.sdkVersion,o._Store.deviceId,o._Store.context,S);o._Helpers.canLog()?o._Store.webviewBridgeEnabled?(o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.Logout,JSON.stringify(o._Identity.IdentityRequest.convertToNative(m))),o._Helpers.invokeCallback(_,fS.nativeIdentityRequest,"Logout request sent to native sdk")):(o._IdentityAPIClient.sendIdentityRequest(H,"logout",_,m,s.parseIdentityResponse,S),(O=o._ServerModel.createEventObject({messageType:T_.MessageType.Profile})).ProfileMessageType=T_.ProfileMessageType.Logout,o._Store.activeForwarders.length&&o._Store.activeForwarders.forEach((function(o){o.logOut&&o.logOut(O)}))):(o._Helpers.invokeCallback(_,fS.loggingDisabledOrMissingAPIKey,pS.InformationMessages.AbandonLogEvent),o.Logger.verbose(pS.InformationMessages.AbandonLogEvent))}else o._Helpers.invokeCallback(_,fS.validationIssue,A.error),o.Logger.verbose(A)},login:function login(m,_){var S,E=o.Identity.getCurrentUser(),A=o._Identity.IdentityRequest.preProcessIdentityRequest(m,_,"login");if(E&&(S=E.getMPID()),A.valid){var O=o._Identity.IdentityRequest.createIdentityRequest(m,k_.platform,k_.sdkVendor,k_.sdkVersion,o._Store.deviceId,o._Store.context,S);o._Helpers.canLog()?o._Store.webviewBridgeEnabled?(o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.Login,JSON.stringify(o._Identity.IdentityRequest.convertToNative(m))),o._Helpers.invokeCallback(_,fS.nativeIdentityRequest,"Login request sent to native sdk")):o._IdentityAPIClient.sendIdentityRequest(O,"login",_,m,s.parseIdentityResponse,S):(o._Helpers.invokeCallback(_,fS.loggingDisabledOrMissingAPIKey,pS.InformationMessages.AbandonLogEvent),o.Logger.verbose(pS.InformationMessages.AbandonLogEvent))}else o._Helpers.invokeCallback(_,fS.validationIssue,A.error),o.Logger.verbose(A)},modify:function modify(m,_){var S,E=o.Identity.getCurrentUser(),A=o._Identity.IdentityRequest.preProcessIdentityRequest(m,_,"modify");E&&(S=E.getMPID());var O=m&&m.userIdentities?m.userIdentities:{};if(A.valid){var H=o._Identity.IdentityRequest.createModifyIdentityRequest(E?E.getUserIdentities().userIdentities:{},O,k_.platform,k_.sdkVendor,k_.sdkVersion,o._Store.context);o._Helpers.canLog()?o._Store.webviewBridgeEnabled?(o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.Modify,JSON.stringify(o._Identity.IdentityRequest.convertToNative(m))),o._Helpers.invokeCallback(_,fS.nativeIdentityRequest,"Modify request sent to native sdk")):o._IdentityAPIClient.sendIdentityRequest(H,"modify",_,m,s.parseIdentityResponse,S):(o._Helpers.invokeCallback(_,fS.loggingDisabledOrMissingAPIKey,pS.InformationMessages.AbandonLogEvent),o.Logger.verbose(pS.InformationMessages.AbandonLogEvent))}else o._Helpers.invokeCallback(_,fS.validationIssue,A.error),o.Logger.verbose(A)},getCurrentUser:function getCurrentUser(){var m;return o._Store?(m=o._Store.mpid)?(m=o._Store.mpid.slice(),s.mParticleUser(m,o._Store.isLoggedIn)):o._Store.webviewBridgeEnabled?s.mParticleUser():null:null},getUser:function getUser(m){var _=o._Persistence.getPersistence();return _&&_[m]&&!k_.SDKv2NonMPIDCookieKeys.hasOwnProperty(m)?s.mParticleUser(m):null},getUsers:function getUsers(){var m=o._Persistence.getPersistence(),_=[];if(m)for(var S in m)k_.SDKv2NonMPIDCookieKeys.hasOwnProperty(S)||_.push(s.mParticleUser(S));return _.sort((function(o,s){return(o.getLastSeenTime()||0)>(s.getLastSeenTime()||0)?-1:1})),_},aliasUsers:function aliasUsers(s,m){var _;if(s.destinationMpid&&s.sourceMpid||(_=pS.ValidationMessages.AliasMissingMpid),s.destinationMpid===s.sourceMpid&&(_=pS.ValidationMessages.AliasNonUniqueMpid),s.startTime&&s.endTime||(_=pS.ValidationMessages.AliasMissingTime),s.startTime>s.endTime&&(_=pS.ValidationMessages.AliasStartBeforeEndTime),_)return o.Logger.warning(_),void o._Helpers.invokeAliasCallback(m,fS.validationIssue,_);if(o._Helpers.canLog())if(o._Store.webviewBridgeEnabled)o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.Alias,JSON.stringify(o._Identity.IdentityRequest.convertAliasToNative(s))),o._Helpers.invokeAliasCallback(m,fS.nativeIdentityRequest,"Alias request sent to native sdk");else{o.Logger.verbose(pS.InformationMessages.StartingAliasRequest+": "+s.sourceMpid+" -> "+s.destinationMpid);var S=o._Identity.IdentityRequest.createAliasNetworkRequest(s);o._IdentityAPIClient.sendAliasRequest(S,m)}else o._Helpers.invokeAliasCallback(m,fS.loggingDisabledOrMissingAPIKey,pS.InformationMessages.AbandonAliasUsers),o.Logger.verbose(pS.InformationMessages.AbandonAliasUsers)},createAliasRequest:function createAliasRequest(s,m){try{if(!m||!s)return o.Logger.error("'destinationUser' and 'sourceUser' must both be present"),null;var _=s.getFirstSeenTime();_||o.Identity.getUsers().forEach((function(o){o.getFirstSeenTime()&&(!_||o.getFirstSeenTime()<_)&&(_=o.getFirstSeenTime())}));var S=(new Date).getTime()-24*o._Store.SDKConfig.aliasMaxWindow*60*60*1e3,E=s.getLastSeenTime()||(new Date).getTime();return _<S&&(E<(_=S)&&o.Logger.warning("Source User has not been seen in the last "+o._Store.SDKConfig.maxAliasWindow+" days, Alias Request will likely fail")),{destinationMpid:m.getMPID(),sourceMpid:s.getMPID(),startTime:_,endTime:E}}catch(m){return o.Logger.error("There was a problem with creating an alias request: "+m),null}}},this.mParticleUser=function(s,m){var _=this;return{getUserIdentities:function getUserIdentities(){var m={},_=o._Persistence.getUserIdentities(s);for(var S in _)_.hasOwnProperty(S)&&(m[T_.IdentityType.getIdentityName(o._Helpers.parseNumber(S))]=_[S]);return{userIdentities:m}},getMPID:function getMPID(){return s},setUserTag:function setUserTag(s){return o._Helpers.Validators.isValidKeyValue(s)?void this.setUserAttribute(s,null):void o.Logger.error(pS.ErrorMessages.BadKey)},removeUserTag:function removeUserTag(s){return o._Helpers.Validators.isValidKeyValue(s)?void this.removeUserAttribute(s):void o.Logger.error(pS.ErrorMessages.BadKey)},setUserAttribute:function setUserAttribute(m,S){var E,A,O,H;if(o._SessionManager.resetSessionTimer(),o._Helpers.canLog()){if(!o._Helpers.Validators.isValidAttributeValue(S))return void o.Logger.error(pS.ErrorMessages.BadAttribute);if(!o._Helpers.Validators.isValidKeyValue(m))return void o.Logger.error(pS.ErrorMessages.BadKey);if(o._Store.webviewBridgeEnabled)o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.SetUserAttribute,JSON.stringify({key:m,value:S}));else{E=o._Persistence.getPersistence(),A=this.getAllUserAttributes();var K=o._Helpers.findKeyInObject(A,m);K?(H=!1,O=A[K],delete A[K]):H=!0,A[m]=S,E&&E[s]&&(E[s].ua=A,o._Persistence.savePersistence(E,s)),_.sendUserAttributeChangeEvent(m,S,O,H,!1,this),o._Forwarders.initForwarders(_.IdentityAPI.getCurrentUser().getUserIdentities(),o._APIClient.prepareForwardingStats),o._Forwarders.handleForwarderUserAttributes("setUserAttribute",m,S)}}},setUserAttributes:function setUserAttributes(s){if(o._SessionManager.resetSessionTimer(),o._Helpers.isObject(s)){if(o._Helpers.canLog())for(var m in s)s.hasOwnProperty(m)&&this.setUserAttribute(m,s[m])}else o.Logger.error("Must pass an object into setUserAttributes. You passed a "+_typeof$1(s))},removeUserAttribute:function removeUserAttribute(m){var S,E;if(o._SessionManager.resetSessionTimer(),o._Helpers.Validators.isValidKeyValue(m))if(o._Store.webviewBridgeEnabled)o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.RemoveUserAttribute,JSON.stringify({key:m,value:null}));else{S=o._Persistence.getPersistence(),E=this.getAllUserAttributes();var A=o._Helpers.findKeyInObject(E,m);A&&(m=A);var O=E[m]?E[m].toString():null;delete E[m],S&&S[s]&&(S[s].ua=E,o._Persistence.savePersistence(S,s)),_.sendUserAttributeChangeEvent(m,null,O,!1,!0,this),o._Forwarders.initForwarders(_.IdentityAPI.getCurrentUser().getUserIdentities(),o._APIClient.prepareForwardingStats),o._Forwarders.handleForwarderUserAttributes("removeUserAttribute",m,null)}else o.Logger.error(pS.ErrorMessages.BadKey)},setUserAttributeList:function setUserAttributeList(m,S){var E,A,O,H,K;if(o._SessionManager.resetSessionTimer(),o._Helpers.Validators.isValidKeyValue(m))if(Array.isArray(S)){var z=S.slice();if(o._Store.webviewBridgeEnabled)o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.SetUserAttributeList,JSON.stringify({key:m,value:z}));else{E=o._Persistence.getPersistence(),A=this.getAllUserAttributes();var G=o._Helpers.findKeyInObject(A,m);if(G?(H=!1,O=A[G],delete A[G]):H=!0,A[m]=z,E&&E[s]&&(E[s].ua=A,o._Persistence.savePersistence(E,s)),O&&Array.isArray(O)){if(S.length!==O.length)K=!0;else for(var q=0;q<S.length;q++)if(O[q]!==S[q]){K=!0;break}}else K=!0;K&&_.sendUserAttributeChangeEvent(m,S,O,H,!1,this),o._Forwarders.initForwarders(_.IdentityAPI.getCurrentUser().getUserIdentities(),o._APIClient.prepareForwardingStats),o._Forwarders.handleForwarderUserAttributes("setUserAttribute",m,z)}}else o.Logger.error("The value you passed in to setUserAttributeList must be an array. You passed in a "+("undefined"==typeof value?"undefined":_typeof$1(value)));else o.Logger.error(pS.ErrorMessages.BadKey)},removeAllUserAttributes:function removeAllUserAttributes(){var s;if(o._SessionManager.resetSessionTimer(),o._Store.webviewBridgeEnabled)o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.RemoveAllUserAttributes);else if(s=this.getAllUserAttributes(),o._Forwarders.initForwarders(_.IdentityAPI.getCurrentUser().getUserIdentities(),o._APIClient.prepareForwardingStats),s)for(var m in s)s.hasOwnProperty(m)&&o._Forwarders.handleForwarderUserAttributes("removeUserAttribute",m,null),this.removeUserAttribute(m)},getUserAttributesLists:function getUserAttributesLists(){var o,s={};for(var m in o=this.getAllUserAttributes())o.hasOwnProperty(m)&&Array.isArray(o[m])&&(s[m]=o[m].slice());return s},getAllUserAttributes:function getAllUserAttributes(){var m={},_=o._Persistence.getAllUserAttributes(s);if(_)for(var S in _)_.hasOwnProperty(S)&&(m[S]=Array.isArray(_[S])?_[S].slice():_[S]);return m},getCart:function getCart(){return o.Logger.warning("Deprecated function Identity.getCurrentUser().getCart() will be removed in future releases"),_.mParticleUserCart(s)},getConsentState:function getConsentState(){return o._Persistence.getConsentState(s)},setConsentState:function setConsentState(m){o._Persistence.saveUserConsentStateToCookies(s,m),o._Forwarders.initForwarders(this.getUserIdentities().userIdentities,o._APIClient.prepareForwardingStats),o._CookieSyncManager.attemptCookieSync(null,this.getMPID())},isLoggedIn:function isLoggedIn(){return m},getLastSeenTime:function getLastSeenTime(){return o._Persistence.getLastSeenTime(s)},getFirstSeenTime:function getFirstSeenTime(){return o._Persistence.getFirstSeenTime(s)}}},this.mParticleUserCart=function(s){return{add:function add(m,_){var S,E,A;o.Logger.warning("Deprecated function Identity.getCurrentUser().getCart().add() will be removed in future releases"),(A=Array.isArray(m)?m.slice():[m]).forEach((function(s){s.Attributes=o._Helpers.sanitizeAttributes(s.Attributes)})),o._Store.webviewBridgeEnabled?o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.AddToCart,JSON.stringify(A)):(o._SessionManager.resetSessionTimer(),E=(E=o._Persistence.getUserProductsFromLS(s)).concat(A),!0===_&&o._Events.logProductActionEvent(T_.ProductActionType.AddToCart,A),E.length>o._Store.SDKConfig.maxProducts&&(o.Logger.verbose("The cart contains "+E.length+" items. Only "+o._Store.SDKConfig.maxProducts+" can currently be saved in cookies."),E=E.slice(-o._Store.SDKConfig.maxProducts)),(S=o._Persistence.getAllUserProductsFromLS())[s].cp=E,o._Persistence.setCartProducts(S))},remove:function remove(m,_){o.Logger.warning("Deprecated function Identity.getCurrentUser().getCart().remove() will be removed in future releases");var S,E,A=-1,O=null;o._Store.webviewBridgeEnabled?o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.RemoveFromCart,JSON.stringify(m)):(o._SessionManager.resetSessionTimer(),(E=o._Persistence.getUserProductsFromLS(s))&&(E.forEach((function(o,s){o.Sku===m.Sku&&(A=s,O=o)})),-1<A&&(E.splice(A,1),!0===_&&o._Events.logProductActionEvent(T_.ProductActionType.RemoveFromCart,O))),(S=o._Persistence.getAllUserProductsFromLS())[s].cp=E,o._Persistence.setCartProducts(S))},clear:function clear(){var m;o.Logger.warning("Deprecated function Identity.getCurrentUser().getCart().clear() will be removed in future releases"),o._Store.webviewBridgeEnabled?o._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.ClearCart):(o._SessionManager.resetSessionTimer(),(m=o._Persistence.getAllUserProductsFromLS())&&m[s]&&m[s].cp&&(m[s].cp=[],m[s].cp=[],o._Persistence.setCartProducts(m)))},getCartProducts:function getCartProducts(){return o.Logger.warning("Deprecated function Identity.getCurrentUser().getCart().getCartProducts() will be removed in future releases"),o._Persistence.getCartProducts(s)}}},this.parseIdentityResponse=function(m,_,S,E,A){var O,H,K,z,G=o.Identity.getUser(_),q={},X=G?G.getUserIdentities().userIdentities:{},J=o._Helpers.extend({},X);o._Store.identityCallInFlight=!1;try{if(o.Logger.verbose('Parsing "'+A+'" identity response from server'),m.responseText&&((K=JSON.parse(m.responseText)).hasOwnProperty("is_logged_in")&&(o._Store.isLoggedIn=K.is_logged_in)),(!G||G.getMPID()&&K.mpid&&K.mpid!==G.getMPID())&&(o._Store.mpid=K.mpid,G&&o._Persistence.setLastSeenTime(_),!o._Persistence.getFirstSeenTime(K.mpid)&&(H=!0),o._Persistence.setFirstSeenTime(K.mpid)),200===m.status){if("modify"===A)q=o._Identity.IdentityRequest.combineUserIdentities(X,E.userIdentities),o._Persistence.saveUserIdentitiesToPersistence(_,q);else{var ae=s.IdentityAPI.getUser(K.mpid),pe=ae?ae.getUserIdentities().userIdentities:{},me=o._Helpers.extend({},pe);o.Logger.verbose("Successfully parsed Identity Response"),"identify"==A&&G&&K.mpid===G.getMPID()&&o._Persistence.setFirstSeenTime(K.mpid),z=o._Store.currentSessionMPIDs.indexOf(K.mpid),o._Store.sessionId&&K.mpid&&_!==K.mpid&&0>z&&o._Store.currentSessionMPIDs.push(K.mpid),-1<z&&(o._Store.currentSessionMPIDs=o._Store.currentSessionMPIDs.slice(0,z).concat(o._Store.currentSessionMPIDs.slice(z+1,o._Store.currentSessionMPIDs.length)),o._Store.currentSessionMPIDs.push(K.mpid)),o._CookieSyncManager.attemptCookieSync(_,K.mpid,H),s.checkIdentitySwap(_,K.mpid,o._Store.currentSessionMPIDs),E&&E.userIdentities&&Object.keys(E.userIdentities).length&&(q=s.IdentityRequest.combineUserIdentities(pe,E.userIdentities)),o._Persistence.saveUserIdentitiesToPersistence(K.mpid,q),o._Persistence.update(),o._Persistence.findPrevCookiesBasedOnUI(E),o._Store.context=K.context||o._Store.context}if(O=o.Identity.getCurrentUser(),E&&E.onUserAlias&&o._Helpers.Validators.isFunction(E.onUserAlias))try{o.Logger.warning("Deprecated function onUserAlias will be removed in future releases"),E.onUserAlias(G,O)}catch(s){o.Logger.error("There was an error with your onUserAlias function - "+s)}var _e=o._Persistence.getPersistence();O&&(o._Persistence.storeDataInMemory(_e,O.getMPID()),(!G||O.getMPID()!==G.getMPID()||G.isLoggedIn()!==O.isLoggedIn())&&o._Forwarders.initForwarders(O.getUserIdentities().userIdentities,o._APIClient.prepareForwardingStats),o._Forwarders.setForwarderUserIdentities(O.getUserIdentities().userIdentities),o._Forwarders.setForwarderOnIdentityComplete(O,A),o._Forwarders.setForwarderOnUserIdentified(O,A));var Se={};for(var Ee in q)Se[T_.IdentityType.getIdentityName(o._Helpers.parseNumber(Ee))]=q[Ee];s.sendUserIdentityChangeEvent(Se,A,K.mpid,"modify"===A?J:me)}S?0===m.status?o._Helpers.invokeCallback(S,fS.noHttpCoverage,K||null,O):o._Helpers.invokeCallback(S,m.status,K||null,O):K&&K.errors&&K.errors.length&&o.Logger.error("Received HTTP response code of "+m.status+" - "+K.errors[0].message),o._APIClient.processQueuedEvents()}catch(s){S&&o._Helpers.invokeCallback(S,m.status,K||null),o.Logger.error("Error parsing JSON response from Identity server: "+s)}},this.sendUserIdentityChangeEvent=function(m,_,S,E){var A,O;if(S||"modify"===_)for(var H in A=this.IdentityAPI.getUser(S),m)if(E[H]!==m[H]){var K=!E[H];O=s.createUserIdentityChange(H,m[H],E[H],K,A),o._APIClient.sendEventToServer(O)}},this.createUserIdentityChange=function(s,m,_,S,E){return o._ServerModel.createEventObject({messageType:T_.MessageType.UserIdentityChange,userIdentityChanges:{New:{IdentityType:s,Identity:m,CreatedThisBatch:S},Old:{IdentityType:s,Identity:_,CreatedThisBatch:!1}},userInMemory:E})},this.sendUserAttributeChangeEvent=function(m,_,S,E,A,O){var H=s.createUserAttributeChange(m,_,S,E,A,O);H&&o._APIClient.sendEventToServer(H)},this.createUserAttributeChange=function(s,m,_,S,E,A){var O;return void 0===_&&(_=null),m!==_&&(O=o._ServerModel.createEventObject({messageType:T_.MessageType.UserAttributeChange,userAttributeChanges:{UserAttributeName:s,New:m,Old:_,Deleted:E,IsNewAttribute:S}},A)),O}}var gS=k_.CCPAPurpose;function Consent(o){var s=this;this.isEnabledForUserConsent=function(o,s){if(!o||!o.values||!o.values.length)return!0;if(!s)return!1;var m,_={},S=s.getConsentState();if(S){var E=S.getGDPRConsentState();if(E)for(var A in E)E.hasOwnProperty(A)&&(m=Yb.hashConsentPurposeConditionalForwarding("1",A),_[m]=E[A].Consented);var O=S.getCCPAConsentState();O&&(m=Yb.hashConsentPurposeConditionalForwarding("2",gS),_[m]=O.Consented)}var H=o.values.some((function(o){var s=o.consentPurpose,m=o.hasConsented;return!!_.hasOwnProperty(s)&&_[s]===m}));return o.includeOnMatch===H},this.createPrivacyConsent=function(s,m,_,S,E){return"boolean"==typeof s?m&&isNaN(m)?(o.Logger.error("Timestamp must be a valid number when constructing a Consent object."),null):_&&"string"!=typeof _?(o.Logger.error("Document must be a valid string when constructing a Consent object."),null):S&&"string"!=typeof S?(o.Logger.error("Location must be a valid string when constructing a Consent object."),null):E&&"string"!=typeof E?(o.Logger.error("Hardware ID must be a valid string when constructing a Consent object."),null):{Consented:s,Timestamp:m||Date.now(),ConsentDocument:_,Location:S,HardwareId:E}:(o.Logger.error("Consented boolean is required when constructing a Consent object."),null)},this.ConsentSerialization={toMinifiedJsonObject:function toMinifiedJsonObject(o){var s,m={};if(o){var _=o.getGDPRConsentState();if(_)for(var S in m.gdpr={},_)if(_.hasOwnProperty(S)){var E=_[S];m.gdpr[S]={},"boolean"==typeof E.Consented&&(m.gdpr[S].c=E.Consented),"number"==typeof E.Timestamp&&(m.gdpr[S].ts=E.Timestamp),"string"==typeof E.ConsentDocument&&(m.gdpr[S].d=E.ConsentDocument),"string"==typeof E.Location&&(m.gdpr[S].l=E.Location),"string"==typeof E.HardwareId&&(m.gdpr[S].h=E.HardwareId)}var A=o.getCCPAConsentState();A&&(m.ccpa=((s={})[gS]={},s),"boolean"==typeof A.Consented&&(m.ccpa[gS].c=A.Consented),"number"==typeof A.Timestamp&&(m.ccpa[gS].ts=A.Timestamp),"string"==typeof A.ConsentDocument&&(m.ccpa[gS].d=A.ConsentDocument),"string"==typeof A.Location&&(m.ccpa[gS].l=A.Location),"string"==typeof A.HardwareId&&(m.ccpa[gS].h=A.HardwareId))}return m},fromMinifiedJsonObject:function fromMinifiedJsonObject(o){var m=s.createConsentState();if(o.gdpr)for(var _ in o.gdpr)if(o.gdpr.hasOwnProperty(_)){var S=s.createPrivacyConsent(o.gdpr[_].c,o.gdpr[_].ts,o.gdpr[_].d,o.gdpr[_].l,o.gdpr[_].h);m.addGDPRConsentState(_,S)}if(o.ccpa&&o.ccpa.hasOwnProperty(gS)){var E=s.createPrivacyConsent(o.ccpa[gS].c,o.ccpa[gS].ts,o.ccpa[gS].d,o.ccpa[gS].l,o.ccpa[gS].h);m.setCCPAConsentState(E)}return m}},this.createConsentState=function(m){function d(o){if("string"!=typeof o)return null;var s=o.trim();return s.length?s.toLowerCase():null}function j(){return delete S[gS],this}var _={},S={};if(m){var E=s.createConsentState();return E.setGDPRConsentState(m.getGDPRConsentState()),E.setCCPAConsentState(m.getCCPAConsentState()),E}return{setGDPRConsentState:function f(o){if(o){if(sb(o))for(var s in _={},o)o.hasOwnProperty(s)&&this.addGDPRConsentState(s,o[s])}else _={};return this},addGDPRConsentState:function e(m,S){var E=d(m);if(!E)return o.Logger.error("Purpose must be a string."),this;if(!sb(S))return o.Logger.error("Invoked with a bad or empty consent object."),this;var A=s.createPrivacyConsent(S.Consented,S.Timestamp,S.ConsentDocument,S.Location,S.HardwareId);return A&&(_[E]=A),this},setCCPAConsentState:function i(m){if(!sb(m))return o.Logger.error("Invoked with a bad or empty CCPA consent object."),this;var _=s.createPrivacyConsent(m.Consented,m.Timestamp,m.ConsentDocument,m.Location,m.HardwareId);return _&&(S[gS]=_),this},getCCPAConsentState:function a(){return S[gS]},getGDPRConsentState:function h(){return Object.assign({},_)},removeGDPRConsentState:function g(o){var s=d(o);return s?(delete _[s],this):this},removeCCPAState:function b(){return o.Logger.warning("removeCCPAState is deprecated and will be removed in a future release; use removeCCPAConsentState instead"),j()},removeCCPAConsentState:j}}}var mS={ScreenView:"screen_view",CustomEvent:"custom_event",Commerce:"commerce",UserAttributes:"user_attributes",UserIdentities:"user_identities",ProductAction:"product_action",PromotionAction:"promotion_action",ProductImpression:"product_impression"},yS=function(){function a(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me=this;if(this.dataPlanMatchLookups={},this.blockEvents=!1,this.blockEventAttributes=!1,this.blockUserAttributes=!1,this.blockUserIdentities=!1,this.kitBlockingEnabled=!1,!o||o.document){this.kitBlockingEnabled=!0,this.mpInstance=s,this.blockEvents=null===(S=null===(_=null===(m=null==o?void 0:o.document)||void 0===m?void 0:m.dtpn)||void 0===_?void 0:_.blok)||void 0===S?void 0:S.ev,this.blockEventAttributes=null===(O=null===(A=null===(E=null==o?void 0:o.document)||void 0===E?void 0:E.dtpn)||void 0===A?void 0:A.blok)||void 0===O?void 0:O.ea,this.blockUserAttributes=null===(z=null===(K=null===(H=null==o?void 0:o.document)||void 0===H?void 0:H.dtpn)||void 0===K?void 0:K.blok)||void 0===z?void 0:z.ua,this.blockUserIdentities=null===(X=null===(q=null===(G=null==o?void 0:o.document)||void 0===G?void 0:G.dtpn)||void 0===q?void 0:q.blok)||void 0===X?void 0:X.id;var _e=null===(pe=null===(ae=null===(J=null==o?void 0:o.document)||void 0===J?void 0:J.dtpn)||void 0===ae?void 0:ae.vers)||void 0===pe?void 0:pe.version_document,Se=null==_e?void 0:_e.data_points;if(_e)try{0<(null==Se?void 0:Se.length)&&Se.forEach((function(o){return me.addToMatchLookups(o)}))}catch(o){this.mpInstance.Logger.error("There was an issue with the data plan: "+o)}}else this.kitBlockingEnabled=!1}return a.prototype.addToMatchLookups=function(o){var s,m,_;if(o.match&&o.validator){var S=this.generateMatchKey(o.match),E=this.getPlannedProperties(o.match.type,o.validator);this.dataPlanMatchLookups[S]=E,((null===(s=null==o?void 0:o.match)||void 0===s?void 0:s.type)===mS.ProductImpression||(null===(m=null==o?void 0:o.match)||void 0===m?void 0:m.type)===mS.ProductAction||(null===(_=null==o?void 0:o.match)||void 0===_?void 0:_.type)===mS.PromotionAction)&&(S=this.generateProductAttributeMatchKey(o.match),E=this.getProductProperties(o.match.type,o.validator),this.dataPlanMatchLookups[S]=E)}else this.mpInstance.Logger.warning("Data Plan Point is not valid' + ".concat(o))},a.prototype.generateMatchKey=function(o){var s=o.criteria||"";switch(o.type){case mS.CustomEvent:var m=s;return[mS.CustomEvent,m.custom_event_type,m.event_name].join(":");case mS.ScreenView:return[mS.ScreenView,"",s.screen_name].join(":");case mS.ProductAction:case mS.PromotionAction:case mS.ProductImpression:return[o.type,s.action].join(":");case mS.UserIdentities:case mS.UserAttributes:return[o.type].join(":");default:return null}},a.prototype.generateProductAttributeMatchKey=function(o){var s=o.criteria||"";switch(o.type){case mS.ProductAction:case mS.PromotionAction:return[o.type,s.action,"ProductAttributes"].join(":");case mS.ProductImpression:return[o.type,"ProductAttributes"].join(":");default:return null}},a.prototype.getPlannedProperties=function(o,s){var m,_,S,E,A,O,H,K,z,G;switch(o){case mS.CustomEvent:case mS.ScreenView:case mS.ProductAction:case mS.PromotionAction:case mS.ProductImpression:if(z=null===(E=null===(S=null===(_=null===(m=null==s?void 0:s.definition)||void 0===m?void 0:m.properties)||void 0===_?void 0:_.data)||void 0===S?void 0:S.properties)||void 0===E?void 0:E.custom_attributes){if(!0===z.additionalProperties||void 0===z.additionalProperties)return!0;for(var q={},X=0,J=Object.keys(z.properties);X<J.length;X++)q[J[X]]=!0;return q}return!1!==(null===(H=null===(O=null===(A=null==s?void 0:s.definition)||void 0===A?void 0:A.properties)||void 0===O?void 0:O.data)||void 0===H?void 0:H.additionalProperties)||{};case mS.UserAttributes:case mS.UserIdentities:if(!0===(G=null===(K=null==s?void 0:s.definition)||void 0===K?void 0:K.additionalProperties)||void 0===G)return!0;q={};for(var ae=s.definition.properties,pe=0,me=Object.keys(ae);pe<me.length;pe++)q[me[pe]]=!0;return q;default:return null}},a.prototype.getProductProperties=function(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De;switch(o){case mS.ProductImpression:if(!1===(null==(De=null===(G=null===(z=null===(K=null===(H=null===(O=null===(A=null===(E=null===(S=null===(_=null===(m=null==s?void 0:s.definition)||void 0===m?void 0:m.properties)||void 0===_?void 0:_.data)||void 0===S?void 0:S.properties)||void 0===E?void 0:E.product_impressions)||void 0===A?void 0:A.items)||void 0===O?void 0:O.properties)||void 0===H?void 0:H.products)||void 0===K?void 0:K.items)||void 0===z?void 0:z.properties)||void 0===G?void 0:G.custom_attributes)?void 0:De.additionalProperties)){for(var $e={},He=0,et=Object.keys(null==De?void 0:De.properties);He<et.length;He++)$e[et[He]]=!0;return $e}return!0;case mS.ProductAction:case mS.PromotionAction:if((De=null===(Ee=null===(Se=null===(_e=null===(me=null===(pe=null===(ae=null===(J=null===(X=null===(q=null==s?void 0:s.definition)||void 0===q?void 0:q.properties)||void 0===X?void 0:X.data)||void 0===J?void 0:J.properties)||void 0===ae?void 0:ae.product_action)||void 0===pe?void 0:pe.properties)||void 0===me?void 0:me.products)||void 0===_e?void 0:_e.items)||void 0===Se?void 0:Se.properties)||void 0===Ee?void 0:Ee.custom_attributes)&&!1===De.additionalProperties){$e={};for(var rt=0,it=Object.keys(null==De?void 0:De.properties);rt<it.length;rt++)$e[it[rt]]=!0;return $e}return!0;default:return null}},a.prototype.getMatchKey=function(o){switch(o.event_type){case z_.EventTypeEnum.screenView:var s=o;return s.data?["screen_view","",s.data.screen_name].join(":"):null;case z_.EventTypeEnum.commerceEvent:var m=o,_=[];if(m&&m.data){var S=m.data,E=S.product_action,A=S.product_impressions,O=S.promotion_action;E?(_.push(mS.ProductAction),_.push(E.action)):O?(_.push(mS.PromotionAction),_.push(O.action)):A&&_.push(mS.ProductImpression)}return _.join(":");case z_.EventTypeEnum.customEvent:var H=o;return H.data?["custom_event",H.data.custom_event_type,H.data.event_name].join(":"):null;default:return null}},a.prototype.getProductAttributeMatchKey=function(o){if(o.event_type===z_.EventTypeEnum.commerceEvent){var s=[],m=o.data,_=m.product_action,S=m.product_impressions,E=m.promotion_action;return _?(s.push(mS.ProductAction),s.push(_.action),s.push("ProductAttributes")):E?(s.push(mS.PromotionAction),s.push(E.action),s.push("ProductAttributes")):S&&(s.push(mS.ProductImpression),s.push("ProductAttributes")),s.join(":")}return null},a.prototype.createBlockedEvent=function(o){try{return o&&(o=this.transformEventAndEventAttributes(o)),o&&o.EventDataType===T_.MessageType.Commerce&&(o=this.transformProductAttributes(o)),o&&(o=this.transformUserAttributes(o),o=this.transformUserIdentities(o)),o}catch(s){return o}},a.prototype.transformEventAndEventAttributes=function(o){var s=E_({},o),m=convertEvent(s),_=this.getMatchKey(m),S=this.dataPlanMatchLookups[_];if(this.blockEvents&&!S)return null;if(this.blockEventAttributes){if(!0===S)return s;if(S){for(var E,A=0,O=Object.keys(s.EventAttributes);A<O.length;A++)S[E=O[A]]||delete s.EventAttributes[E];return s}return s}return s},a.prototype.transformProductAttributes=function(o){function b(o,s){s.forEach((function(s){for(var m,_=0,S=Object.keys(s.Attributes);_<S.length;_++)m=S[_],o[m]||delete s.Attributes[m]}))}var s,m=E_({},o),_=convertEvent(m),S=this.getProductAttributeMatchKey(_),E=this.dataPlanMatchLookups[S];if(this.blockEvents&&!E)return null;if(this.blockEventAttributes){if(!0===E)return m;if(E){switch(o.EventCategory){case T_.CommerceEventType.ProductImpression:m.ProductImpressions.forEach((function(o){b(E,null==o?void 0:o.ProductList)}));break;case T_.CommerceEventType.ProductPurchase:b(E,null===(s=m.ProductAction)||void 0===s?void 0:s.ProductList);break;default:this.mpInstance.Logger.warning("Product Not Supported ")}return m}return m}return m},a.prototype.transformUserAttributes=function(o){var s=E_({},o);if(this.blockUserAttributes){var m=this.dataPlanMatchLookups.user_attributes;if(this.mpInstance._Helpers.isObject(m))for(var _,S=0,E=Object.keys(s.UserAttributes);S<E.length;S++)m[_=E[S]]||delete s.UserAttributes[_]}return s},a.prototype.isAttributeKeyBlocked=function(o){if(!this.blockUserAttributes)return!1;if(this.blockUserAttributes){var s=this.dataPlanMatchLookups.user_attributes;if(!0===s)return!1;if(!s[o])return!0}return!1},a.prototype.isIdentityBlocked=function(o){if(!this.blockUserIdentities)return!1;if(!this.blockUserIdentities)return!1;var s=this.dataPlanMatchLookups.user_identities;return!0!==s&&!s[o]},a.prototype.transformUserIdentities=function(o){var s,m=this,_=E_({},o);if(this.blockUserIdentities){var S=this.dataPlanMatchLookups.user_identities;this.mpInstance._Helpers.isObject(S)&&(null===(s=null==_?void 0:_.UserIdentities)||void 0===s?void 0:s.length)&&_.UserIdentities.forEach((function(o,s){var E=T_.IdentityType.getIdentityName(m.mpInstance._Helpers.parseNumber(o.Type));S[E]||_.UserIdentities.splice(s,1)}))}return _},a}();function ConfigAPIClient(){this.getSDKConfiguration=function(o,s,m,_){var S;try{var E=_._Helpers.createXHR((function xhrCallback(){4===E.readyState&&(200===E.status?(s=_._Helpers.extend({},s,JSON.parse(E.responseText)),m(o,s,_),_.Logger.verbose("Successfully received configuration from server")):(m(o,s,_),_.Logger.verbose("Issue with receiving configuration from server, received HTTP Code of "+E.status)))}));S="https://"+_._Store.SDKConfig.configUrl+o+"/config?env=",S+=s.isDevelopmentMode?"1":"0";var A=s.dataPlan;A&&(A.planId&&(S=S+"&plan_id="+A.planId||""),A.planVersion&&(S=S+"&plan_version="+A.planVersion||"")),E&&(E.open("get",S),E.send(null))}catch(S){m(o,s,_),_.Logger.error("Error getting forwarder configuration from mParticle servers.")}}}var vS=k_.HTTPCodes,_S=k_.Messages;function IdentityAPIClient(o){this.sendAliasRequest=function(s,m){var _;if(o.Logger.verbose(_S.InformationMessages.SendAliasHttp),_=o._Helpers.createXHR((function xhrCallback(){if(4===_.readyState){if(o.Logger.verbose("Received "+_.statusText+" from server"),200!==_.status&&202!==_.status&&_.responseText){var s=JSON.parse(_.responseText);if(s.hasOwnProperty("message")){var S=s.message;return void o._Helpers.invokeAliasCallback(m,_.status,S)}}o._Helpers.invokeAliasCallback(m,_.status)}})),_)try{_.open("post",o._Helpers.createServiceUrl(o._Store.SDKConfig.aliasUrl,o._Store.devToken)+"/Alias"),_.send(JSON.stringify(s))}catch(s){o._Helpers.invokeAliasCallback(m,vS.noHttpCoverage,s),o.Logger.error("Error sending alias request to mParticle servers. "+s)}},this.sendIdentityRequest=function(s,m,_,S,E,A){var O,H;if(o.Logger.verbose(_S.InformationMessages.SendIdentityBegin),s){if(o.Logger.verbose(_S.InformationMessages.SendIdentityHttp),O=o._Helpers.createXHR((function xhrCallback(){4===O.readyState&&(o.Logger.verbose("Received "+O.statusText+" from server"),E(O,H,_,S,m))})))try{o._Store.identityCallInFlight?o._Helpers.invokeCallback(_,vS.activeIdentityRequest,"There is currently an Identity request processing. Please wait for this to return before requesting again"):(H=A||null,"modify"===m?O.open("post",o._Helpers.createServiceUrl(o._Store.SDKConfig.identityUrl)+A+"/"+m):O.open("post",o._Helpers.createServiceUrl(o._Store.SDKConfig.identityUrl)+m),O.setRequestHeader("Content-Type","application/json"),O.setRequestHeader("x-mp-key",o._Store.devToken),o._Store.identityCallInFlight=!0,O.send(JSON.stringify(s)))}catch(s){o._Store.identityCallInFlight=!1,o._Helpers.invokeCallback(_,vS.noHttpCoverage,s),o.Logger.error("Error sending identity request to servers with status code "+O.status+" - "+s)}}else o.Logger.error(_S.ErrorMessages.APIRequestEmpty)}}var bS=k_.Messages,SS=k_.HTTPCodes;function mParticleInstance(o){var s=this;this._instanceName=o,this._NativeSdkHelpers=new NativeSdkHelpers(this),this._SessionManager=new SessionManager(this),this._Persistence=new _Persistence(this),this._Helpers=new Helpers(this),this._Events=new Events$2(this),this._CookieSyncManager=new cookieSyncManager(this),this._ServerModel=new ServerModel(this),this._Ecommerce=new Ecommerce(this),this._ForwardingStatsUploader=new forwardingStatsUploader(this),this._Consent=new Consent(this),this._IdentityAPIClient=new IdentityAPIClient(this),this._preInit={readyQueue:[],integrationDelays:{},forwarderConstructors:[]},this.IdentityType=T_.IdentityType,this.EventType=T_.EventType,this.CommerceEventType=T_.CommerceEventType,this.PromotionType=T_.PromotionActionType,this.ProductActionType=T_.ProductActionType,this._Identity=new Identity(this),this.Identity=this._Identity.IdentityAPI,this.generateHash=this._Helpers.generateHash,this.getDeviceId=this._Persistence.getDeviceId,"undefined"!=typeof window&&window.mParticle&&window.mParticle.config&&window.mParticle.config.hasOwnProperty("rq")&&(this._preInit.readyQueue=window.mParticle.config.rq),this.init=function(o,s){return s||console.warn("You did not pass a config object to init(). mParticle will not initialize properly"),function runPreConfigFetchInitialization(o,s,m){o.Logger=new Logger$5(m),o._Store=new Store(m,o),window.mParticle.Store=o._Store,o._Store.devToken=s||null,o.Logger.verbose(bS.InformationMessages.StartingInitialization);try{o._Store.isLocalStorageAvailable=o._Persistence.determineLocalStorageAvailability(window.localStorage)}catch(s){o.Logger.warning("localStorage is not available, using cookies if available"),o._Store.isLocalStorageAvailable=!1}}(this,o,s),s?void(!s.hasOwnProperty("requestConfig")||s.requestConfig?(new ConfigAPIClient).getSDKConfiguration(o,s,completeSDKInitialization,this):completeSDKInitialization(o,s,this)):void console.error("No config available on the window, please pass a config object to mParticle.init()")},this.setLogLevel=function(o){s.Logger.setLogLevel(o)},this.reset=function(o){try{o._Persistence.resetPersistence(),o._Store&&delete o._Store}catch(o){console.error("Cannot reset mParticle",o)}},this._resetForTests=function(o,s,m){m._Store&&delete m._Store,m._Store=new Store(o,m),m._Store.isLocalStorageAvailable=m._Persistence.determineLocalStorageAvailability(window.localStorage),m._Events.stopTracking(),s||m._Persistence.resetPersistence(),m._Persistence.forwardingStatsBatches.uploadsTable={},m._Persistence.forwardingStatsBatches.forwardingStatsEventQueue=[],m._preInit={readyQueue:[],pixelConfigurations:[],integrationDelays:{},forwarderConstructors:[],isDevelopmentMode:!1}},this.ready=function(o){s.isInitialized()&&"function"==typeof o?o():s._preInit.readyQueue.push(o)},this.getEnvironment=function(){return s._Store.SDKConfig.isDevelopmentMode?T_.Environment.Development:T_.Environment.Production},this.getVersion=function(){return k_.sdkVersion},this.setAppVersion=function(o){queueIfNotInitialized((function(){s.setAppVersion(o)}),s)||(s._Store.SDKConfig.appVersion=o,s._Persistence.update())},this.setDeviceId=function(o){queueIfNotInitialized((function(){s.setDeviceId(o)}),s)||this._Persistence.setDeviceId(o)},this.isInitialized=function(){return!!s._Store&&s._Store.isInitialized},this.getAppName=function(){return s._Store.SDKConfig.appName},this.setAppName=function(o){queueIfNotInitialized((function(){s.setAppName(o)}),s)||(s._Store.SDKConfig.appName=o)},this.getAppVersion=function(){return s._Store.SDKConfig.appVersion},this.stopTrackingLocation=function(){s._SessionManager.resetSessionTimer(),s._Events.stopTracking()},this.startTrackingLocation=function(o){s._Helpers.Validators.isFunction(o)||s.Logger.warning("Warning: Location tracking is triggered, but not including a callback into the `startTrackingLocation` may result in events logged too quickly and not being associated with a location."),s._SessionManager.resetSessionTimer(),s._Events.startTracking(o)},this.setPosition=function(o,m){queueIfNotInitialized((function(){s.setPosition(o,m)}),s)||(s._SessionManager.resetSessionTimer(),"number"==typeof o&&"number"==typeof m?s._Store.currentPosition={lat:o,lng:m}:s.Logger.error("Position latitude and/or longitude must both be of type number"))},this.startNewSession=function(){s._SessionManager.startNewSession()},this.endSession=function(){s._SessionManager.endSession(!0)},this.logBaseEvent=function(o,m){if(!queueIfNotInitialized((function(){s.logBaseEvent(o,m)}),s))return s._SessionManager.resetSessionTimer(),"string"!=typeof o.name?void s.Logger.error(bS.ErrorMessages.EventNameInvalidType):(o.eventType||(o.eventType=T_.EventType.Unknown),s._Helpers.canLog()?void s._Events.logEvent(o,m):void s.Logger.error(bS.ErrorMessages.LoggingDisabled))},this.logEvent=function(o,m,_,S,E){if(!queueIfNotInitialized((function(){s.logEvent(o,m,_,S,E)}),s))return s._SessionManager.resetSessionTimer(),"string"!=typeof o?void s.Logger.error(bS.ErrorMessages.EventNameInvalidType):(m||(m=T_.EventType.Unknown),s._Helpers.isEventType(m)?s._Helpers.canLog()?void s._Events.logEvent({messageType:T_.MessageType.PageEvent,name:o,data:_,eventType:m,customFlags:S},E):void s.Logger.error(bS.ErrorMessages.LoggingDisabled):void s.Logger.error("Invalid event type: "+m+", must be one of: \n"+JSON.stringify(T_.EventType)))},this.logError=function(o,m){if(!queueIfNotInitialized((function(){s.logError(o,m)}),s)&&(s._SessionManager.resetSessionTimer(),o)){"string"==typeof o&&(o={message:o});var _={m:o.message?o.message:o,s:"Error",t:o.stack||null};if(m){var S=s._Helpers.sanitizeAttributes(m,_.m);for(var E in S)_[E]=S[E]}s._Events.logEvent({messageType:T_.MessageType.CrashReport,name:o.name?o.name:"Error",data:_,eventType:T_.EventType.Other})}},this.logLink=function(o,m,_,S){s._Events.addEventHandler("click",o,m,S,_)},this.logForm=function(o,m,_,S){s._Events.addEventHandler("submit",o,m,S,_)},this.logPageView=function(o,m,_,S){if(!queueIfNotInitialized((function(){s.logPageView(o,m,_,S)}),s)){if(s._SessionManager.resetSessionTimer(),s._Helpers.canLog()){if(s._Helpers.Validators.isStringOrNumber(o)||(o="PageView"),m){if(!s._Helpers.isObject(m))return void s.Logger.error("The attributes argument must be an object. A "+_typeof$1(m)+" was entered. Please correct and retry.")}else m={hostname:window.location.hostname,title:window.document.title};if(_&&!s._Helpers.isObject(_))return void s.Logger.error("The customFlags argument must be an object. A "+_typeof$1(_)+" was entered. Please correct and retry.")}s._Events.logEvent({messageType:T_.MessageType.PageView,name:o,data:m,eventType:T_.EventType.Unknown,customFlags:_},S)}},this.upload=function(){s._Helpers.canLog()&&(s._Store.webviewBridgeEnabled?s._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.Upload):s._APIClient.uploader.prepareAndUpload(!1,!1))},this.Consent={createCCPAConsent:s._Consent.createPrivacyConsent,createGDPRConsent:s._Consent.createPrivacyConsent,createConsentState:s._Consent.createConsentState},this.eCommerce={Cart:{add:function add(o,m){s.Logger.warning("Deprecated function eCommerce.Cart.add() will be removed in future releases");var _,S=s.Identity.getCurrentUser();S&&(_=S.getMPID()),s._Identity.mParticleUserCart(_).add(o,m)},remove:function remove(o,m){s.Logger.warning("Deprecated function eCommerce.Cart.remove() will be removed in future releases");var _,S=s.Identity.getCurrentUser();S&&(_=S.getMPID()),s._Identity.mParticleUserCart(_).remove(o,m)},clear:function clear(){s.Logger.warning("Deprecated function eCommerce.Cart.clear() will be removed in future releases");var o,m=s.Identity.getCurrentUser();m&&(o=m.getMPID()),s._Identity.mParticleUserCart(o).clear()}},setCurrencyCode:function setCurrencyCode(o){return queueIfNotInitialized((function(){s.eCommerce.setCurrencyCode(o)}),s)?void 0:"string"==typeof o?(s._SessionManager.resetSessionTimer(),void(s._Store.currencyCode=o)):void s.Logger.error("Code must be a string")},createProduct:function createProduct(o,m,_,S,E,A,O,H,K,z){return s._Ecommerce.createProduct(o,m,_,S,E,A,O,H,K,z)},createPromotion:function createPromotion(o,m,_,S){return s._Ecommerce.createPromotion(o,m,_,S)},createImpression:function createImpression(o,m){return s._Ecommerce.createImpression(o,m)},createTransactionAttributes:function createTransactionAttributes(o,m,_,S,E,A){return s._Ecommerce.createTransactionAttributes(o,m,_,S,E,A)},logCheckout:function logCheckout(o,m,_,S){return s.Logger.warning("mParticle.logCheckout is deprecated, please use mParticle.logProductAction instead"),s._Store.isInitialized?(s._SessionManager.resetSessionTimer(),void s._Events.logCheckoutEvent(o,m,_,S)):void s.ready((function(){s.eCommerce.logCheckout(o,m,_,S)}))},logProductAction:function logProductAction(o,m,_,S,E,A){queueIfNotInitialized((function(){s.eCommerce.logProductAction(o,m,_,S,E,A)}),s)||(s._SessionManager.resetSessionTimer(),s._Events.logProductActionEvent(o,m,_,S,E,A))},logPurchase:function logPurchase(o,m,_,S,E){return s.Logger.warning("mParticle.logPurchase is deprecated, please use mParticle.logProductAction instead"),s._Store.isInitialized?o&&m?(s._SessionManager.resetSessionTimer(),void s._Events.logPurchaseEvent(o,m,S,E)):void s.Logger.error(bS.ErrorMessages.BadLogPurchase):void s.ready((function(){s.eCommerce.logPurchase(o,m,_,S,E)}))},logPromotion:function logPromotion(o,m,_,S,E){queueIfNotInitialized((function(){s.eCommerce.logPromotion(o,m,_,S,E)}),s)||(s._SessionManager.resetSessionTimer(),s._Events.logPromotionEvent(o,m,_,S,E))},logImpression:function logImpression(o,m,_,S){queueIfNotInitialized((function(){s.eCommerce.logImpression(o,m,_,S)}),s)||(s._SessionManager.resetSessionTimer(),s._Events.logImpressionEvent(o,m,_,S))},logRefund:function logRefund(o,m,_,S,E){return s.Logger.warning("mParticle.logRefund is deprecated, please use mParticle.logProductAction instead"),s._Store.isInitialized?(s._SessionManager.resetSessionTimer(),void s._Events.logRefundEvent(o,m,S,E)):void s.ready((function(){s.eCommerce.logRefund(o,m,_,S,E)}))},expandCommerceEvent:function expandCommerceEvent(o){return s._Ecommerce.expandCommerceEvent(o)}},this.setSessionAttribute=function(o,m){if(!queueIfNotInitialized((function(){s.setSessionAttribute(o,m)}),s)&&s._Helpers.canLog()){if(!s._Helpers.Validators.isValidAttributeValue(m))return void s.Logger.error(bS.ErrorMessages.BadAttribute);if(!s._Helpers.Validators.isValidKeyValue(o))return void s.Logger.error(bS.ErrorMessages.BadKey);if(s._Store.webviewBridgeEnabled)s._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.SetSessionAttribute,JSON.stringify({key:o,value:m}));else{var _=s._Helpers.findKeyInObject(s._Store.sessionAttributes,o);_&&(o=_),s._Store.sessionAttributes[o]=m,s._Persistence.update(),s._Forwarders.applyToForwarders("setSessionAttribute",[o,m])}}},this.setOptOut=function(o){queueIfNotInitialized((function(){s.setOptOut(o)}),s)||(s._SessionManager.resetSessionTimer(),s._Store.isEnabled=!o,s._Events.logOptOut(),s._Persistence.update(),s._Store.activeForwarders.length&&s._Store.activeForwarders.forEach((function(m){if(m.setOptOut){var _=m.setOptOut(o);_&&s.Logger.verbose(_)}})))},this.setIntegrationAttribute=function(o,m){if(!queueIfNotInitialized((function(){s.setIntegrationAttribute(o,m)}),s)){if("number"!=typeof o)return void s.Logger.error("integrationId must be a number");if(null===m)s._Store.integrationAttributes[o]={};else{if(!s._Helpers.isObject(m))return void s.Logger.error("Attrs must be an object with keys and values. You entered a "+_typeof$1(m));if(0===Object.keys(m).length)s._Store.integrationAttributes[o]={};else for(var _ in m){if("string"!=typeof _){s.Logger.error("Keys must be strings, you entered a "+_typeof$1(_));continue}if("string"!=typeof m[_]){s.Logger.error("Values for integration attributes must be strings. You entered a "+_typeof$1(m[_]));continue}s._Helpers.isObject(s._Store.integrationAttributes[o])||(s._Store.integrationAttributes[o]={}),s._Store.integrationAttributes[o][_]=m[_]}}s._Persistence.update()}},this.getIntegrationAttributes=function(o){return s._Store.integrationAttributes[o]?s._Store.integrationAttributes[o]:{}},this.addForwarder=function(o){s._preInit.forwarderConstructors.push(o)},this.configurePixel=function(o){s._Forwarders.configurePixel(o)},this._getActiveForwarders=function(){return s._Store.activeForwarders},this._getIntegrationDelays=function(){return s._preInit.integrationDelays},this._setIntegrationDelay=function(o,m){if(s._preInit.integrationDelays[o]=m,!0!==m){var _=Object.keys(s._preInit.integrationDelays);if(0!==_.length){var S=_.some((function(o){return!0===s._preInit.integrationDelays[o]}));S||s._APIClient.processQueuedEvents()}}},this._setWrapperSDKInfo=function(o,m){queueIfNotInitialized((function(){s._setWrapperSDKInfo(o,m)}),s)||(void 0===s._Store.wrapperSDKInfo||!s._Store.wrapperSDKInfo.isInfoSet)&&(s._Store.wrapperSDKInfo={name:o,version:m,isInfoSet:!0})}}function completeSDKInitialization(o,s,m){var _=function createKitBlocker(o,s){var m,_,S,E;return o.dataPlanOptions&&(s.Logger.verbose("Customer provided data plan found"),E=o.dataPlanOptions,_={document:{dtpn:{vers:E.dataPlanVersion,blok:{ev:E.blockEvents,ea:E.blockEventAttributes,ua:E.blockUserAttributes,id:E.blockUserIdentities}}}}),_||(o.dataPlan&&o.dataPlan.document?o.dataPlan.document.error_message?S=o.dataPlan.document.error_message:(s.Logger.verbose("Data plan found from mParticle.js"),_=o.dataPlan):o.dataPlanResult&&(o.dataPlanResult.error_message?S=o.dataPlanResult.error_message:(s.Logger.verbose("Data plan found from /config"),_={document:o.dataPlanResult}))),S&&s.Logger.error(S),_&&(m=new yS(_,s)),m}(s,m);if(m._APIClient=new APIClient(m,_),m._Forwarders=new Forwarders(m,_),s.flags&&s.flags.hasOwnProperty(k_.FeatureFlags.EventBatchingIntervalMillis)&&(m._Store.SDKConfig.flags[k_.FeatureFlags.EventBatchingIntervalMillis]=s.flags[k_.FeatureFlags.EventBatchingIntervalMillis]),m._Store.storageName=m._Helpers.createMainStorageName(s.workspaceToken),m._Store.prodStorageName=m._Helpers.createProductStorageName(s.workspaceToken),s.hasOwnProperty("workspaceToken")?m._Store.SDKConfig.workspaceToken=s.workspaceToken:m.Logger.warning("You should have a workspaceToken on your config object for security purposes."),s.hasOwnProperty("requiredWebviewBridgeName")?m._Store.SDKConfig.requiredWebviewBridgeName=s.requiredWebviewBridgeName:s.hasOwnProperty("workspaceToken")&&(m._Store.SDKConfig.requiredWebviewBridgeName=s.workspaceToken),m._Store.webviewBridgeEnabled=m._NativeSdkHelpers.isWebviewEnabled(m._Store.SDKConfig.requiredWebviewBridgeName,m._Store.SDKConfig.minWebviewBridgeVersion),m._Store.configurationLoaded=!0,m._Store.webviewBridgeEnabled||m._Persistence.initializeStorage(),m._Store.webviewBridgeEnabled)m._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.SetSessionAttribute,JSON.stringify({key:"$src_env",value:"webview"})),o&&m._NativeSdkHelpers.sendToNative(k_.NativeSdkPaths.SetSessionAttribute,JSON.stringify({key:"$src_key",value:o}));else{var S;if(m._Helpers.isObject(m._Store.SDKConfig.identifyRequest)&&m._Helpers.isObject(m._Store.SDKConfig.identifyRequest.userIdentities)&&0===Object.keys(m._Store.SDKConfig.identifyRequest.userIdentities).length||!m._Store.SDKConfig.identifyRequest){var E={};if(S=m.Identity.getCurrentUser()){var A=S.getUserIdentities().userIdentities||{};for(var O in A)A.hasOwnProperty(O)&&(E[O]=A[O])}m._Store.SDKConfig.identifyRequest={userIdentities:E}}S=m.Identity.getCurrentUser(),m._Helpers.getFeatureFlag(k_.FeatureFlags.ReportBatching)&&m._ForwardingStatsUploader.startForwardingStatsTimer(),m._Forwarders.processForwarders(s,m._APIClient.prepareForwardingStats),m._Forwarders.processPixelConfigs(s),m._SessionManager.initialize(),m._Events.logAST(),!m._Store.identifyCalled&&m._Store.SDKConfig.identityCallback&&S&&S.getMPID()&&m._Store.SDKConfig.identityCallback({httpCode:SS.activeSession,getUser:function getUser(){return m._Identity.mParticleUser(S.getMPID())},getPreviousUser:function getPreviousUser(){var o=m.Identity.getUsers(),s=o.shift();return s&&S&&s.getMPID()===S.getMPID()&&(s=o.shift()),s||null},body:{mpid:S.getMPID(),is_logged_in:m._Store.isLoggedIn,matched_identities:S.getUserIdentities().userIdentities,context:null,is_ephemeral:!1}})}m._Store.isInitialized=!0,m._preInit.readyQueue&&m._preInit.readyQueue.length&&(m._preInit.readyQueue.forEach((function(o){m._Helpers.Validators.isFunction(o)?o():Array.isArray(o)&&function processPreloadedItem(o,s){var m=o,_=m.splice(0,1)[0];if(mParticle[m[0]])mParticle[_].apply(this,m);else{var S=_.split(".");try{for(var E=mParticle,A=0;A<S.length;A++)E=E[S[A]];E.apply(this,m)}catch(o){s.Logger.verbose("Unable to compute proper mParticle function "+o)}}}(o,m)})),m._preInit.readyQueue=[]),m._Store.isFirstRun&&(m._Store.isFirstRun=!1)}function queueIfNotInitialized(o,s){return!s.isInitialized()&&(s.ready((function(){o()})),!0)}var TS,kS,CS,wS=function mockFunction(){return null},xS=function(){function a(){}return a.prototype.getMPInstance=function(){return{_Helpers:{sanitizeAttributes:window.mParticle.getInstance()._Helpers.sanitizeAttributes,generateHash:function generateHash(){return"mockHash"},generateUniqueId:function generateUniqueId(){return"mockId"},extend:window.mParticle.getInstance()._Helpers.extend,createServiceUrl:wS,parseNumber:wS,isObject:wS,returnConvertedBoolean:wS,Validators:null},_resetForTests:wS,_APIClient:null,MPSideloadedKit:null,_Consent:null,_Events:null,_Forwarders:null,_NativeSdkHelpers:null,_Persistence:null,_preInit:null,Consent:null,_ServerModel:null,_SessionManager:null,_Store:{sessionId:"mockSessionId",sideloadedKits:[],devToken:"test_dev_token",isFirstRun:!0,isEnabled:!0,sessionAttributes:{},currentSessionMPIDs:[],consentState:null,clientId:null,deviceId:null,serverSettings:{},dateLastEventSent:null,sessionStartDate:null,currentPosition:null,isTracking:!1,watchPositionId:null,cartProducts:[],eventQueue:[],currencyCode:null,globalTimer:null,context:null,configurationLoaded:!1,identityCallInFlight:!1,nonCurrentUserMPIDs:{},identifyCalled:!1,isLoggedIn:!1,cookieSyncDates:{},integrationAttributes:{},requireDelay:!0,isLocalStorageAvailable:null,integrationDelayTimeoutStart:null,storageName:null,prodStorageName:null,activeForwarders:[],kits:{},configuredForwarders:[],pixelConfigurations:[],wrapperSDKInfo:{name:"none",version:null,isInfoSet:!1},SDKConfig:{isDevelopmentMode:!1,onCreateBatch:wS}},config:null,eCommerce:null,Identity:{getCurrentUser:wS,IdentityAPI:{},identify:wS,login:wS,logout:wS,modify:wS},Logger:{verbose:wS,error:wS,warning:wS},ProductActionType:null,ServerModel:null,addForwarder:wS,generateHash:wS,getAppVersion:wS,getAppName:wS,getInstance:wS,getDeviceId:wS,init:wS,logBaseEvent:wS,logEvent:wS,logLevel:"none",setPosition:wS,upload:wS}},a.prototype.createSDKEventFunction=function(o){return new ServerModel(this.getMPInstance()).createEventObject(o)},a.prototype.returnBatch=function(o){var s=this,m=this.getMPInstance();return convertEvents("0",Array.isArray(o)?o.map((function(o){return s.createSDKEventFunction(o)})):[this.createSDKEventFunction(o)],m)},a}();!function(o){o[o.Unknown=0]="Unknown",o[o.Navigation=1]="Navigation",o[o.Location=2]="Location",o[o.Search=3]="Search",o[o.Transaction=4]="Transaction",o[o.UserContent=5]="UserContent",o[o.UserPreference=6]="UserPreference",o[o.Social=7]="Social",o[o.Other=8]="Other",o[o.Media=9]="Media"}(TS||(TS={})),function(o){o[o.SessionStart=1]="SessionStart",o[o.SessionEnd=2]="SessionEnd",o[o.PageView=3]="PageView",o[o.PageEvent=4]="PageEvent",o[o.CrashReport=5]="CrashReport",o[o.OptOut=6]="OptOut",o[o.AppStateTransition=10]="AppStateTransition",o[o.Profile=14]="Profile",o[o.Commerce=16]="Commerce",o[o.UserAttributeChange=17]="UserAttributeChange",o[o.UserIdentityChange=18]="UserIdentityChange",o[o.Media=20]="Media"}(kS||(kS={})),function(o){o[o.Other=0]="Other",o[o.CustomerId=1]="CustomerId",o[o.Facebook=2]="Facebook",o[o.Twitter=3]="Twitter",o[o.Google=4]="Google",o[o.Microsoft=5]="Microsoft",o[o.Yahoo=6]="Yahoo",o[o.Email=7]="Email",o[o.FacebookCustomAudienceId=9]="FacebookCustomAudienceId",o[o.Other2=10]="Other2",o[o.Other3=11]="Other3",o[o.Other4=12]="Other4",o[o.Other5=13]="Other5",o[o.Other6=14]="Other6",o[o.Other7=15]="Other7",o[o.Other8=16]="Other8",o[o.Other9=17]="Other9",o[o.Other10=18]="Other10",o[o.MobileNumber=19]="MobileNumber",o[o.PhoneNumber2=20]="PhoneNumber2",o[o.PhoneNumber3=21]="PhoneNumber3"}(CS||(CS={}));var ES=function(){function a(o){this.filterDictionary={eventTypeFilters:[],eventNameFilters:[],screenNameFilters:[],screenAttributeFilters:[],userIdentityFilters:[],userAttributeFilters:[],attributeFilters:[],consentRegulationFilters:[],consentRegulationPurposeFilters:[],messageTypeFilters:[],messageTypeStateFilters:[],filteringEventAttributeValue:{},filteringUserAttributeValue:{},filteringConsentRuleValues:{}},this.kitInstance=o}return a.prototype.addEventTypeFilter=function(o){var s=Yb.hashEventType(o);this.filterDictionary.eventTypeFilters.push(s)},a.prototype.addEventNameFilter=function(o,s){var m=Yb.hashEventName(s,o);this.filterDictionary.eventNameFilters.push(m)},a.prototype.addEventAttributeFilter=function(o,s,m){var _=Yb.hashEventAttributeKey(o,s,m);this.filterDictionary.attributeFilters.push(_)},a.prototype.addScreenNameFilter=function(o){var s=Yb.hashEventName(o,TS.Unknown);this.filterDictionary.screenNameFilters.push(s)},a.prototype.addScreenAttributeFilter=function(o,s){var m=Yb.hashEventAttributeKey(TS.Unknown,o,s);this.filterDictionary.screenAttributeFilters.push(m)},a.prototype.addUserIdentityFilter=function(o){var s=Yb.hashUserIdentity(o);this.filterDictionary.userIdentityFilters.push(s)},a.prototype.addUserAttributeFilter=function(o){var s=Yb.hashUserAttribute(o);this.filterDictionary.userAttributeFilters.push(s)},a}();Array.prototype.forEach||(Array.prototype.forEach=h_.forEach),Array.prototype.map||(Array.prototype.map=h_.map),Array.prototype.filter||(Array.prototype.filter=h_.filter),Array.isArray||(Array.prototype.isArray=h_.isArray);var IS=new function mParticle$1(){var o=this;this.Store={},this._instances={},this.IdentityType=T_.IdentityType,this.EventType=T_.EventType,this.CommerceEventType=T_.CommerceEventType,this.PromotionType=T_.PromotionActionType,this.ProductActionType=T_.ProductActionType,this.MPSideloadedKit=ES,"undefined"!=typeof window&&(this.isIOS=!(!window.mParticle||!window.mParticle.isIOS)&&window.mParticle.isIOS,this.config=window.mParticle&&window.mParticle.config?window.mParticle.config:{}),this.init=function(s,m,_){!m&&window.mParticle&&window.mParticle.config&&(console.warn("You did not pass a config object to mParticle.init(). Attempting to use the window.mParticle.config if it exists. Please note that in a future release, this may not work and mParticle will not initialize properly"),m=window.mParticle?window.mParticle.config:{}),_=(_&&0!==_.length?_:k_.DefaultInstance).toLowerCase();var S=o._instances[_];void 0===S&&(S=new mParticleInstance(s),o._instances[_]=S),S.init(s,m,_)},this.getInstance=function(s){var m;return s?(m=o._instances[s.toLowerCase()])||(console.log("You tried to initialize an instance named "+s+". This instance does not exist. Check your instance name or initialize a new instance with this name before calling it."),null):(s=k_.DefaultInstance,(m=o._instances[s])||(m=new mParticleInstance(s),o._instances[k_.DefaultInstance]=m),m)},this.getDeviceId=function(){return o.getInstance().getDeviceId()},this.setDeviceId=function(s){return o.getInstance().setDeviceId(s)},this.isInitialized=function(){return o.getInstance().isInitialized()},this.startNewSession=function(){o.getInstance().startNewSession()},this.endSession=function(){o.getInstance().endSession()},this.setLogLevel=function(s){o.getInstance().setLogLevel(s)},this.ready=function(s){o.getInstance().ready(s)},this.setAppVersion=function(s){o.getInstance().setAppVersion(s)},this.getAppName=function(){return o.getInstance().getAppName()},this.setAppName=function(s){o.getInstance().setAppName(s)},this.getAppVersion=function(){return o.getInstance().getAppVersion()},this.getEnvironment=function(){return o.getInstance().getEnvironment()},this.stopTrackingLocation=function(){o.getInstance().stopTrackingLocation()},this.startTrackingLocation=function(s){o.getInstance().startTrackingLocation(s)},this.setPosition=function(s,m){o.getInstance().setPosition(s,m)},this.startNewSession=function(){o.getInstance().startNewSession()},this.endSession=function(){o.getInstance().endSession()},this.logBaseEvent=function(s,m){o.getInstance().logBaseEvent(s,m)},this.logEvent=function(s,m,_,S,E){o.getInstance().logEvent(s,m,_,S,E)},this.logError=function(s,m){o.getInstance().logError(s,m)},this.logLink=function(s,m,_,S){o.getInstance().logLink(s,m,_,S)},this.logForm=function(s,m,_,S){o.getInstance().logForm(s,m,_,S)},this.logPageView=function(s,m,_,S){o.getInstance().logPageView(s,m,_,S)},this.upload=function(){o.getInstance().upload()},this.eCommerce={Cart:{add:function add(s,m){o.getInstance().eCommerce.Cart.add(s,m)},remove:function remove(s,m){o.getInstance().eCommerce.Cart.remove(s,m)},clear:function clear(){o.getInstance().eCommerce.Cart.clear()}},setCurrencyCode:function setCurrencyCode(s){o.getInstance().eCommerce.setCurrencyCode(s)},createProduct:function createProduct(s,m,_,S,E,A,O,H,K,z){return o.getInstance().eCommerce.createProduct(s,m,_,S,E,A,O,H,K,z)},createPromotion:function createPromotion(s,m,_,S){return o.getInstance().eCommerce.createPromotion(s,m,_,S)},createImpression:function createImpression(s,m){return o.getInstance().eCommerce.createImpression(s,m)},createTransactionAttributes:function createTransactionAttributes(s,m,_,S,E,A){return o.getInstance().eCommerce.createTransactionAttributes(s,m,_,S,E,A)},logCheckout:function logCheckout(s,m,_,S){o.getInstance().eCommerce.logCheckout(s,m,_,S)},logProductAction:function logProductAction(s,m,_,S,E,A){o.getInstance().eCommerce.logProductAction(s,m,_,S,E,A)},logPurchase:function logPurchase(s,m,_,S,E){o.getInstance().eCommerce.logPurchase(s,m,_,S,E)},logPromotion:function logPromotion(s,m,_,S,E){o.getInstance().eCommerce.logPromotion(s,m,_,S,E)},logImpression:function logImpression(s,m,_,S){o.getInstance().eCommerce.logImpression(s,m,_,S)},logRefund:function logRefund(s,m,_,S,E){o.getInstance().eCommerce.logRefund(s,m,_,S,E)},expandCommerceEvent:function expandCommerceEvent(s){return o.getInstance().eCommerce.expandCommerceEvent(s)}},this.setSessionAttribute=function(s,m){o.getInstance().setSessionAttribute(s,m)},this.setOptOut=function(s){o.getInstance().setOptOut(s)},this.setIntegrationAttribute=function(s,m){o.getInstance().setIntegrationAttribute(s,m)},this.getIntegrationAttributes=function(s){return o.getInstance().getIntegrationAttributes(s)},this.Identity={HTTPCodes:o.getInstance().Identity.HTTPCodes,aliasUsers:function aliasUsers(s,m){o.getInstance().Identity.aliasUsers(s,m)},createAliasRequest:function createAliasRequest(s,m){return o.getInstance().Identity.createAliasRequest(s,m)},getCurrentUser:function getCurrentUser(){return o.getInstance().Identity.getCurrentUser()},getUser:function getUser(s){return o.getInstance().Identity.getUser(s)},getUsers:function getUsers(){return o.getInstance().Identity.getUsers()},identify:function identify(s,m){o.getInstance().Identity.identify(s,m)},login:function login(s,m){o.getInstance().Identity.login(s,m)},logout:function logout(s,m){o.getInstance().Identity.logout(s,m)},modify:function modify(s,m){o.getInstance().Identity.modify(s,m)}},this.sessionManager={getSession:function getSession(){return o.getInstance()._SessionManager.getSession()}},this.Consent={createConsentState:function createConsentState(){return o.getInstance().Consent.createConsentState()},createGDPRConsent:function createGDPRConsent(s,m,_,S,E){return o.getInstance().Consent.createGDPRConsent(s,m,_,S,E)},createCCPAConsent:function createCCPAConsent(s,m,_,S,E){return o.getInstance().Consent.createGDPRConsent(s,m,_,S,E)}},this.reset=function(){o.getInstance().reset(o.getInstance())},this._resetForTests=function(s,m){"boolean"==typeof m?o.getInstance()._resetForTests(s,m,o.getInstance()):o.getInstance()._resetForTests(s,!1,o.getInstance())},this.configurePixel=function(s){o.getInstance().configurePixel(s)},this._setIntegrationDelay=function(s,m){o.getInstance()._setIntegrationDelay(s,m)},this._getIntegrationDelays=function(){return o.getInstance()._getIntegrationDelays()},this.getVersion=function(){return o.getInstance().getVersion()},this.generateHash=function(s){return o.getInstance().generateHash(s)},this.addForwarder=function(s){o.getInstance().addForwarder(s)},this._getActiveForwarders=function(){return o.getInstance()._getActiveForwarders()},this._setWrapperSDKInfo=function(s,m){o.getInstance()._setWrapperSDKInfo(s,m)}};"undefined"!=typeof window&&(window.mParticle=IS,window.mParticle._BatchValidator=new xS);var __awaiter$i=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},AS=function(){function BasePlatform(){_classCallCheck$1(this,BasePlatform),this.enablePointer=!1,this.logger=null,this._windowSize=null,this._hdmiConnectionRefreshInterval=6e4,this._ready=new Promise((function(){}))}return _createClass$1(BasePlatform,[{key:"init",value:function init(o){return __awaiter$i(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return this.logger=o||console,this._registerNetworkStatusListener(),this._registerClosedCaptionsStatusListener(),s.abrupt("return");case 4:case"end":return s.stop()}}),_callee,this)})))}},{key:"getCaptionStyle",value:function getCaptionStyle(){return{textStyle:{fontSize:50,fontStyle:"normal",textColor:4294967295,highlightColor:4278190080,highlight:!0},scaling:1,windowColor:0}}},{key:"appActionMetricsHandler",value:function appActionMetricsHandler(o,s){var m;null===(m=this.logger)||void 0===m||m.info("appActionMetricsHandler event fallback ".concat({action:o,videoId:s}))}},{key:"announce",value:function announce(o,s){var m;null===(m=this.logger)||void 0===m||m.info("Announce: ".concat(o," ").concat(s))}},{key:"usesPlatformAnnouncer",value:function usesPlatformAnnouncer(){return!1}},{key:"_checkCCStatus",value:function _checkCCStatus(){return __awaiter$i(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){var o;return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.getCloseCaptioningEnabled();case 2:(o=s.sent)!==this._ccEnabled&&(this._ccEnabled=o);case 4:case"end":return s.stop()}}),_callee2,this)})))}},{key:"_registerClosedCaptionsStatusListener",value:function _registerClosedCaptionsStatusListener(){this.supportsCCNativeListener||(clearInterval(this._ccInterval),this._ccInterval=setInterval(this._checkCCStatus.bind(this),1e4))}},{key:"_deregisterClosedCaptionsStatusListener",value:function _deregisterClosedCaptionsStatusListener(){this.supportsCCNativeListener||clearInterval(this._ccInterval)}},{key:"_checkHDMIStatus",value:function _checkHDMIStatus(){return __awaiter$i(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){var o;return _regeneratorRuntime$1().wrap((function _callee3$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.getHDMIConnectedStatus();case 2:(o=s.sent)!==this._hdmiActive&&(this._hdmiActive=o);case 4:case"end":return s.stop()}}),_callee3,this)})))}},{key:"_checkTTSStatus",value:function _checkTTSStatus(){return __awaiter$i(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){var o;return _regeneratorRuntime$1().wrap((function _callee4$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.getTTSStatus();case 2:(o=s.sent)!==this._ttsEnabled&&(this._ttsEnabled=o);case 4:case"end":return s.stop()}}),_callee4,this)})))}},{key:"_checkNetworkStatus",value:function _checkNetworkStatus(o){o!==this._networkConnected&&(this._networkConnected=o)}},{key:"_registerNetworkStatusListener",value:function _registerNetworkStatusListener(){var o=this;addEventListener("offline",(function(){return o._checkNetworkStatus(!1)})),addEventListener("online",(function(){return o._checkNetworkStatus(!0)}))}},{key:"deviceId",get:function get(){return"Device ID"}},{key:"screenHeight",get:function get(){return this.windowSize.h}},{key:"screenWidth",get:function get(){return this.windowSize.w}},{key:"captionsButtonEnabled",get:function get(){return!0}},{key:"advertisingId",get:function get(){return"Advertising ID"}},{key:"bitrateRange",get:function get(){return this.defaultBitrateRange}},{key:"defaultBitrateRange",get:function get(){return{min:-1,max:5819030}}},{key:"webBrowser",get:function get(){return{userAgent:window.navigator.userAgent}}},{key:"isAndroid",get:function get(){return"androidtv"===this.deviceType||"firetv"===this.deviceType}},{key:"isLowEndDevice",get:function get(){return"firetv"===this.deviceType&&"AFTT"===this.model}},{key:"platformDeeplink",get:function get(){return""}},{key:"_injectScript",value:function _injectScript(o){var s=this;return new Promise((function(m,_){var S;null===(S=s.logger)||void 0===S||S.debug("injecting script: "+o);var E=document.createElement("script");E.src=o,E.onload=function(){var _;null===(_=s.logger)||void 0===_||_.debug("script injected successfuly: "+o),m()},E.onerror=function(){var m;null===(m=s.logger)||void 0===m||m.error("error injecting script: "+o),_()},document.head&&document.head.appendChild(E)}))}},{key:"windowSize",get:function get(){if(!this._windowSize){var o=_slicedToArray$1(720===window.innerHeight?[1280,720]:[1920,1080],2),s=o[0],m=o[1];this._windowSize={w:s,h:m}}return this._windowSize}}]),BasePlatform}(),PS=/(?:.*(?:\.com|\d*\.\d*\.\d*\.\d*)(?:\:\d*)?\/#?\$?!?(?:.*#)?|#|)(.*?)(?:\/?\?.*|\/?$)/,LS=/(?:[^#/&?]*?)=(?:.*?)(?=[#/&]|$)/g,DS=function(){function QueryParams(){_classCallCheck$1(this,QueryParams)}return _createClass$1(QueryParams,[{key:"init",value:function init(){var o=_objectSpread2({},document.location),s=this._parsePathAndQsParams(o.href).qs;this._qs=s}},{key:"_parsePathAndQsParams",value:function _parsePathAndQsParams(o){var s=PS.exec(o),m=s&&s.length>0?s[1]:o,_=(o.match(LS)||[]).reduce((function(o,s){var m=_slicedToArray$1(s.split("=",2),2),_=m[0],S=m[1];return _objectSpread2(_objectSpread2({},o),{},_defineProperty$2({},_,S))}),{});return{path:m,qs:_}}},{key:"get",value:function get(o){return this._qs&&this._qs[o]||null}}]),QueryParams}(),RS=new DS,OS={tmdb_key:"d8fb2aa91bb0049c7dd9060234b1b996",tmdb_endpoint:"https://api.themoviedb.org/3/movie/popular?language=en-US",tmdb_backdrop_path:"https://image.tmdb.org/t/p",tmdb_movie_endpoint:"https://api.themoviedb.org/3/movie"},MS="ddkz2ef5c",FS=["firebasestorage.googleapis.com"],NS={endpoint:"https://tracker.universalsearch.io/v1/track?"},US={region:"",credentials:{accessKeyId:"",secretAccessKey:""}},BS={ingestServer:"rtmps://19fbbcd8202b.global-contribute.live-video.net:443/app/",ingestEndpoint:"19fbbcd8202b.global-contribute.live-video.net",streamKey:"sk_us-east-1_d9UCYQtD3UUd_rF219Wc9eyelRsZrLkZGePE52VGUoG",channelARN:"arn:aws:ivs:us-east-1:383573658163:channel/msN4cmeN6aBF"},jS=function extendStatics(o,s){return jS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,s){o.__proto__=s}||function(o,s){for(var m in s)Object.prototype.hasOwnProperty.call(s,m)&&(o[m]=s[m])},jS(o,s)};var $S=function __assign(){return $S=Object.assign||function __assign(o){for(var s,m=1,_=arguments.length;m<_;m++)for(var S in s=arguments[m])Object.prototype.hasOwnProperty.call(s,S)&&(o[S]=s[S]);return o},$S.apply(this,arguments)};function __awaiter$h(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))}var VS=Object.create?function(o,s,m,_){void 0===_&&(_=m);var S=Object.getOwnPropertyDescriptor(s,m);S&&!("get"in S?!s.__esModule:S.writable||S.configurable)||(S={enumerable:!0,get:function get(){return s[m]}}),Object.defineProperty(o,_,S)}:function(o,s,m,_){void 0===_&&(_=m),o[_]=s[m]};function __values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],_=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function next(){return o&&_>=o.length&&(o=void 0),{value:o&&o[_++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(o,s){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var _,S,E=m.call(o),A=[];try{for(;(void 0===s||s-- >0)&&!(_=E.next()).done;)A.push(_.value)}catch(o){S={error:o}}finally{try{_&&!_.done&&(m=E.return)&&m.call(E)}finally{if(S)throw S.error}}return A}function __await(o){return this instanceof __await?(this.v=o,this):new __await(o)}var HS=Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s};var KS=Object.freeze({__proto__:null,__extends:function __extends(o,s){if("function"!=typeof s&&null!==s)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function __(){this.constructor=o}jS(o,s),o.prototype=null===s?Object.create(s):(__.prototype=s.prototype,new __)},get __assign(){return $S},__rest:function __rest(o,s){var m={};for(var _ in o)Object.prototype.hasOwnProperty.call(o,_)&&s.indexOf(_)<0&&(m[_]=o[_]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols){var S=0;for(_=Object.getOwnPropertySymbols(o);S<_.length;S++)s.indexOf(_[S])<0&&Object.prototype.propertyIsEnumerable.call(o,_[S])&&(m[_[S]]=o[_[S]])}return m},__decorate:function __decorate(o,s,m,_){var S,E=arguments.length,A=E<3?s:null===_?_=Object.getOwnPropertyDescriptor(s,m):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)A=Reflect.decorate(o,s,m,_);else for(var O=o.length-1;O>=0;O--)(S=o[O])&&(A=(E<3?S(A):E>3?S(s,m,A):S(s,m))||A);return E>3&&A&&Object.defineProperty(s,m,A),A},__param:function __param(o,s){return function(m,_){s(m,_,o)}},__esDecorate:function __esDecorate(o,s,m,_,S,E){function accept(o){if(void 0!==o&&"function"!=typeof o)throw new TypeError("Function expected");return o}for(var A,O=_.kind,H="getter"===O?"get":"setter"===O?"set":"value",K=!s&&o?_.static?o:o.prototype:null,z=s||(K?Object.getOwnPropertyDescriptor(K,_.name):{}),G=!1,q=m.length-1;q>=0;q--){var X={};for(var J in _)X[J]="access"===J?{}:_[J];for(var J in _.access)X.access[J]=_.access[J];X.addInitializer=function(o){if(G)throw new TypeError("Cannot add initializers after decoration has completed");E.push(accept(o||null))};var ae=(0,m[q])("accessor"===O?{get:z.get,set:z.set}:z[H],X);if("accessor"===O){if(void 0===ae)continue;if(null===ae||"object"!=typeof ae)throw new TypeError("Object expected");(A=accept(ae.get))&&(z.get=A),(A=accept(ae.set))&&(z.set=A),(A=accept(ae.init))&&S.push(A)}else(A=accept(ae))&&("field"===O?S.push(A):z[H]=A)}K&&Object.defineProperty(K,_.name,z),G=!0},__runInitializers:function __runInitializers(o,s,m){for(var _=arguments.length>2,S=0;S<s.length;S++)m=_?s[S].call(o,m):s[S].call(o);return _?m:void 0},__propKey:function __propKey(o){return"symbol"==typeof o?o:"".concat(o)},__setFunctionName:function __setFunctionName(o,s,m){return"symbol"==typeof s&&(s=s.description?"[".concat(s.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:m?"".concat(m," ",s):s})},__metadata:function __metadata(o,s){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(o,s)},__awaiter:__awaiter$h,__generator:function __generator(o,s){var m,_,S,E,A={label:0,sent:function sent(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return E={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(E[Symbol.iterator]=function(){return this}),E;function verb(O){return function(H){return function step(O){if(m)throw new TypeError("Generator is already executing.");for(;E&&(E=0,O[0]&&(A=0)),A;)try{if(m=1,_&&(S=2&O[0]?_.return:O[0]?_.throw||((S=_.return)&&S.call(_),0):_.next)&&!(S=S.call(_,O[1])).done)return S;switch(_=0,S&&(O=[2&O[0],S.value]),O[0]){case 0:case 1:S=O;break;case 4:return A.label++,{value:O[1],done:!1};case 5:A.label++,_=O[1],O=[0];continue;case 7:O=A.ops.pop(),A.trys.pop();continue;default:if(!(S=A.trys,(S=S.length>0&&S[S.length-1])||6!==O[0]&&2!==O[0])){A=0;continue}if(3===O[0]&&(!S||O[1]>S[0]&&O[1]<S[3])){A.label=O[1];break}if(6===O[0]&&A.label<S[1]){A.label=S[1],S=O;break}if(S&&A.label<S[2]){A.label=S[2],A.ops.push(O);break}S[2]&&A.ops.pop(),A.trys.pop();continue}O=s.call(o,A)}catch(o){O=[6,o],_=0}finally{m=S=0}if(5&O[0])throw O[1];return{value:O[0]?O[1]:void 0,done:!0}}([O,H])}}},__createBinding:VS,__exportStar:function __exportStar(o,s){for(var m in o)"default"===m||Object.prototype.hasOwnProperty.call(s,m)||VS(s,o,m)},__values:__values,__read:__read,__spread:function __spread(){for(var o=[],s=0;s<arguments.length;s++)o=o.concat(__read(arguments[s]));return o},__spreadArrays:function __spreadArrays(){for(var o=0,s=0,m=arguments.length;s<m;s++)o+=arguments[s].length;var _=Array(o),S=0;for(s=0;s<m;s++)for(var E=arguments[s],A=0,O=E.length;A<O;A++,S++)_[S]=E[A];return _},__spreadArray:function __spreadArray(o,s,m){if(m||2===arguments.length)for(var _,S=0,E=s.length;S<E;S++)!_&&S in s||(_||(_=Array.prototype.slice.call(s,0,S)),_[S]=s[S]);return o.concat(_||Array.prototype.slice.call(s))},__await:__await,__asyncGenerator:function __asyncGenerator(o,s,m){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _,S=m.apply(o,s||[]),E=[];return _={},verb("next"),verb("throw"),verb("return"),_[Symbol.asyncIterator]=function(){return this},_;function verb(o){S[o]&&(_[o]=function(s){return new Promise((function(m,_){E.push([o,s,m,_])>1||resume(o,s)}))})}function resume(o,s){try{!function step(o){o.value instanceof __await?Promise.resolve(o.value.v).then(fulfill,reject):settle(E[0][2],o)}(S[o](s))}catch(o){settle(E[0][3],o)}}function fulfill(o){resume("next",o)}function reject(o){resume("throw",o)}function settle(o,s){o(s),E.shift(),E.length&&resume(E[0][0],E[0][1])}},__asyncDelegator:function __asyncDelegator(o){var s,m;return s={},verb("next"),verb("throw",(function(o){throw o})),verb("return"),s[Symbol.iterator]=function(){return this},s;function verb(_,S){s[_]=o[_]?function(s){return(m=!m)?{value:__await(o[_](s)),done:!1}:S?S(s):s}:S}},__asyncValues:function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,m=o[Symbol.asyncIterator];return m?m.call(o):(o=__values(o),s={},verb("next"),verb("throw"),verb("return"),s[Symbol.asyncIterator]=function(){return this},s);function verb(m){s[m]=o[m]&&function(s){return new Promise((function(_,S){(function settle(o,s,m,_){Promise.resolve(_).then((function(s){o({value:s,done:m})}),s)})(_,S,(s=o[m](s)).done,s.value)}))}}},__makeTemplateObject:function __makeTemplateObject(o,s){return Object.defineProperty?Object.defineProperty(o,"raw",{value:s}):o.raw=s,o},__importStar:function __importStar(o){if(o&&o.__esModule)return o;var s={};if(null!=o)for(var m in o)"default"!==m&&Object.prototype.hasOwnProperty.call(o,m)&&VS(s,o,m);return HS(s,o),s},__importDefault:function __importDefault(o){return o&&o.__esModule?o:{default:o}},__classPrivateFieldGet:function __classPrivateFieldGet(o,s,m,_){if("a"===m&&!_)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof s?o!==s||!_:!s.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===m?_:"a"===m?_.call(o):_?_.value:s.get(o)},__classPrivateFieldSet:function __classPrivateFieldSet(o,s,m,_,S){if("m"===_)throw new TypeError("Private method is not writable");if("a"===_&&!S)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof s?o!==s||!S:!s.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===_?S.call(o,m):S?S.value=m:s.set(o,m),m},__classPrivateFieldIn:function __classPrivateFieldIn(o,s){if(null===s||"object"!=typeof s&&"function"!=typeof s)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof o?s===o:o.has(s)}}),zS={LiveVideo:[{url:"https://cph-p2p-msl.akamaized.net/hls/live/2000341/test/master.m3u8",format:"hls",id:"2"},{url:"https://explo.broadpeak.tv:8343/bpk-tv/spring/lowlat/index.mpd",format:"dash",id:"6"},{url:"47s38p175ecqxp3pjkoxlnt76",format:"theolive",id:"19"},{url:"https://fcc3ddae59ed.us-west-2.playback.live-video.net/api/video/v1/us-west-2.893648527354.channel.DmumNckWFTqz.m3u8",format:"hls",id:"3",cc:!0},{url:"https://19fbbcd8202b.us-east-1.playback.live-video.net/api/video/v1/us-east-1.383573658163.channel.msN4cmeN6aBF.m3u8",format:"hls",id:"7",ivs:{source:"broadcast"}},{url:"https://d1cfb1813d56495ba932efc30ad80900.mediatailor.us-east-1.amazonaws.com/v1/master/4865792e3cbf3864b6030f934049f2e69e8c7118/TestAdCampaing_1-09-14-23/core_hls_test.m3u8",format:"hls",id:"8",ads:!0,ivs:{source:"mediatailor"}},{url:"https://d24rwxnt7vw9qb.cloudfront.net/v1/dash/e6d234965645b411ad572802b6c9d5a10799c9c1/All_Reference_Streams/2fc23947945841b9b1be9768f9c13e75/index.mpd",format:"dash",id:"20",drm:{playready:{licenseAcquisitionURL:"https://lic.staging.drmtoday.com/license-proxy-headerauth/drmtoday/RightsManager.asmx",headers:{"x-dt-custom-data":"ewogICAgInVzZXJJZCI6ICJhd3MtZWxlbWVudGFsOjpzcGVrZS10ZXN0aW5nIiwKICAgICJzZXNzaW9uSWQiOiAiZWxlbWVudGFsLXJlZnN0cmVhbSIsCiAgICAibWVyY2hhbnQiOiAiYXdzLWVsZW1lbnRhbCIKfQo="}},widevine:{licenseAcquisitionURL:"https://lic.staging.drmtoday.com/license-proxy-widevine/cenc/?specConform=true",headers:{"x-dt-custom-data":"ewogICAgInVzZXJJZCI6ICJhd3MtZWxlbWVudGFsOjpzcGVrZS10ZXN0aW5nIiwKICAgICJzZXNzaW9uSWQiOiAiZWxlbWVudGFsLXJlZnN0cmVhbSIsCiAgICAibWVyY2hhbnQiOiAiYXdzLWVsZW1lbnRhbCIKfQo="}}}}],VOD:[{url:"https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8",id:"1",format:"hls"},{url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",id:"4",format:"mp4"},{url:"https://media.axprod.net/TestVectors/Cmaf/clear_1080p_h264/manifest.mpd",id:"5",format:"dash"}],LiveAudio:[{url:"https://live.amperwave.net/manifest/audacy-ktwvfmaac-hlsc.m3u8",id:"9",format:"hls"},{url:"https://broadcast.classicrock109.com/cr109.mp3",id:"13",format:"mp3"},{url:"https://streaming.playtrance.com/playtrance-main-high?dummyParam=.aac",id:"17",format:"aac"}],AOD:[{url:"https://www2.iis.fraunhofer.de/AAC/ChID-BLITS-EBU-Narration.mp4",id:"10",format:"mp4"},{url:"https://storage.googleapis.com/shaka-demo-assets/dig-the-uke-clear/dash.mpd",id:"11",format:"dash"},{url:"https://files.freemusicarchive.org/storage-freemusicarchive-org/tracks/5PvfRwA6uXr91prN2c4xtuIvhELOzNkyqEz8bjzN.mp3",id:"12",format:"mp3"},{url:"https://file-examples.com/storage/feaade38c1651bd01984236/2017/11/file_example_WAV_10MG.wav",id:"14",format:"wav"},{url:"https://file-examples.com/storage/feaade38c1651bd01984236/2017/11/file_example_OOG_5MG.ogg",id:"15",format:"ogg"},{url:"https://files.catbox.moe/2kjovu.aac",id:"16",format:"aac"},{url:"https://files.catbox.moe/yoevo4.flac",id:"18",format:"flac"}]},WS=function(o){_inherits$1(API,o);var s=_createSuper$1(API);function API(){return _classCallCheck$1(this,API),s.apply(this,arguments)}return _createClass$1(API,[{key:"fetchCarouselInfo",value:function fetchCarouselInfo(){return OS}},{key:"fetchAsset",value:function fetchAsset(){return zS}},{key:"fetchCarouselData",value:function fetchCarouselData(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.fetchData({url:this.carouselUrl});case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),_callee,this)})))}},{key:"fetchAssetData",value:function fetchAssetData(o){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){var s;return _regeneratorRuntime$1().wrap((function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:return s="".concat(OS.tmdb_movie_endpoint,"/").concat(o,"?api_key=").concat(OS.tmdb_key),m.next=3,this.fetchData({url:s});case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}}),_callee2,this)})))}},{key:"carouselUrl",get:function get(){return"".concat(OS.tmdb_endpoint,"&api_key=").concat(OS.tmdb_key)}}]),API}(Xy),GS=function(o){_inherits$1(HomePresenter,o);var s=_createSuper$1(HomePresenter);function HomePresenter(){var o;_classCallCheck$1(this,HomePresenter);var m=a_.resolveType(a_.dependencyKeys.Store);return(o=s.call(this,m)).onDataLoaded=function(s){s.newValue&&o.store.set("appIsBooting",!1)},o.onFullScreenEnabled=function(s){if("home"===s.newValue.page){var m=s.newValue.isVisible;o.onPropertyChanged("isFullScreenEnabled",!1,m)}},o.store.propertyChanged.dataLoaded.addListener(o.onDataLoaded),o.store.propertyChanged.fullScreenEnabled.addListener(o.onFullScreenEnabled),o}return _createClass$1(HomePresenter)}(r_),qS=function(o){_inherits$1(CarouselPresenter,o);var s=_createSuper$1(CarouselPresenter);function CarouselPresenter(){var o;return _classCallCheck$1(this,CarouselPresenter),(o=s.apply(this,arguments)).api=a_.resolveType(a_.dependencyKeys.API),o.movieData=[],o.debugUseError=!1,o}return _createClass$1(CarouselPresenter,[{key:"initAsync",value:function initAsync(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o;return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(!this.movieData.length){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,this.api.fetchCarouselData();case 4:(o=s.sent).error||this.debugUseError?(this.logger.error("Request failed."),this.onPropertyChanged("carouselError",!1,!0),this.debugUseError=!1,this.movieData=[]):this.movieData=o.results,this.store.set("dataLoaded",!0);case 7:case"end":return s.stop()}}),_callee,this)})))}},{key:"carouselData",get:function get(){return this.movieData.length?this.movieData:[]}},{key:"carouselInfo",get:function get(){return this.api.fetchCarouselInfo()}},{key:"formatPosterUrl",value:function formatPosterUrl(o,s){return"".concat(this.carouselInfo.tmdb_backdrop_path,"/w").concat(o,"/").concat(s)}},{key:"callAppError",value:function callAppError(o){this.store.set("appError",o)}}]),CarouselPresenter}(r_),XS=new o_({white:"0xffffffff",eggshell:"0xfffafafa",black:"0xff000000",dimGrey:"0xffdadada",velopeGreen:"0xff24bd7e",transparentWhite:"0x80ffffff",clear:"0x00000000",gray:"0xff636363",lightGray:"0xff969696",transparentGray:"0xff27c25d",transparentBlack:"0xc0000000",keyboardGray:"0xff585858",lime:"0xff00ff00",semiTransparent:"0x80ffffff"}),YS=1920,QS=1080,JS=1280,ZS=720,eT="appTitle",tT="appSecondTitle",nT="demosTitle",rT="appDescription",iT="appFeature1",aT="appFeature2",oT="appFeature3",sT="appFeature4",uT="appFeature5",lT="appFeature6",cT="carouselTitle",dT="notFound",hT="videoPlayerTitle",pT="audioPlayerTitle",fT="playerWidgetTitle",gT="keyboardTitle",mT="selectPlayer",yT="selectSource",vT="playerActions",_T="currentlySelected",bT="splashText",ST="exitPageTitle",TT="exitTitle",kT="exitMessage",CT="exitAffirm",wT="exitDeny",xT="exampleModalPageTitle",ET="exampleModalTitle",IT="exampleModalMessage",AT="exampleModalAffirm",PT="errorMessage",LT="error",DT="mutePlayer",RT="unmutePlayer",OT="autoplay",MT="rewind",FT="play",NT="pause",UT="fastForward",BT="fullScreen",jT="keyboardViewDescription",$T="emailKeyboardButtonTitle",VT="searchKeyboardButtonTitle",HT="errorDismiss",KT="apiErrorText",zT="playerErrorText";function clamp$2(o,s,m){return Math.max(s,Math.min(o,m))}function arrayCompare(o,s){return Array.isArray(o)&&Array.isArray(s)&&o.length===s.length&&o.every((function(o,m){return o===s[m]}))}function calculateProportion(o,s,m){return Math.ceil(m*o/s)}var WT=3;function getLngOptimalElementSize(o){return function getDivisibleElementSize(o,s){return o%s==0?o:Math.ceil(o/s)*s}(o,WT)}var GT,qT,XT,YT,QT="playerCurrentEvent",JT="isFullScreenEnabled",ZT=function(o){_inherits$1(ProgressBarPresenter,o);var s=_createSuper$1(ProgressBarPresenter);function ProgressBarPresenter(){var o;_classCallCheck$1(this,ProgressBarPresenter);var m=a_.resolveType(a_.dependencyKeys.Store);return(o=s.call(this,m)).onStoreCurrentEvent=function(s){if(s.newValue){var m=s.newValue;switch(m.type){case"LoadStart":case"Waiting":o.store.set("appIsLoading",!0);break;case"TimeUpdate":case"Playing":o.store.set("appIsLoading",!1)}o.onPropertyChanged(QT,"",m)}},o.store.propertyChanged.currentEvent.addListener(o.onStoreCurrentEvent),o}return _createClass$1(ProgressBarPresenter,[{key:"initAsync",value:function initAsync(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return");case 1:case"end":return o.stop()}}),_callee)})))}},{key:"calculateProgress",value:function calculateProgress(o,s,m){var _=clamp$2(s/Math.max(m,1),0,1);return clamp$2(o*_,16,o)}},{key:"getTimeStamps",value:function getTimeStamps(o,s){return this.formatTime(o)+" / "+this.formatTime(Math.round(s-o))}},{key:"calculateSeekValue",value:function calculateSeekValue(o,s,m){return clamp$2(o+m,0,s)}},{key:"formatTime",value:function formatTime(o){var s=new Date(1e3*Math.floor(o));return isNaN(s.valueOf())?"0:00":s.toISOString().substr(11,8).replace(/^0(?:0:0?)?/,"")}},{key:"destroy",value:function destroy(){this.store.propertyChanged.currentEvent.removeListener(this.onStoreCurrentEvent)}}]),ProgressBarPresenter}(r_),_k=[],Tk={};function handle(o){var s;try{s=function getResult(o,s){var m=function dotGrab$1(){for(var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(arguments.length>1?arguments[1]:void 0).split("."),m=o,_=function _loop(o){m=(Object.entries(m).find((function(m){var _=_slicedToArray$1(m,2),S=_[0];return _[1],S.toLowerCase()===s[o].toLowerCase()}))||[null,{}])[1]},S=0;S<s.length;S++)_(S);return m}(qT,o);o.match(/^[a-zA-Z]+\.on[A-Za-z]+$/)&&(m={event:o,listening:!0});return"function"==typeof m?null==s?m():m(s):m}(o.method,o.params)}catch(s){setTimeout((function(){return XT(JSON.stringify({jsonrpc:"2.0",error:{code:-32602,message:"Invalid params (this is a mock error from the mock transport layer)"},id:o.id}))}))}setTimeout((function(){return XT(JSON.stringify({jsonrpc:"2.0",result:s,id:o.id}))}))}function event$1(o,s,m){var _=Object.entries(Tk).find((function(m){var _=_slicedToArray$1(m,2);return _[0],_[1].toLowerCase()===o.toLowerCase()+"."+s.toLowerCase()}));if(_){var S=JSON.stringify({jsonrpc:"2.0",id:parseInt(_[0]),result:m});XT(S)}}window.__firebolt&&window.__firebolt.testHarness&&(YT=window.__firebolt.testHarness);var Pk={send:function send(o){console.debug("Sending message to transport: "+o);var s=JSON.parse(o);if(Array.isArray(s))s.forEach((function(o){return send(JSON.stringify(o))}));else{var m=_slicedToArray$1(s.method.split("."),2),_=m[0],S=m[1];YT&&YT.onSend&&YT.onSend(_,S,s.params,s.id),S.match(/^on[A-Z]/)&&(s.params.listen?Tk[s.id]=_.toLowerCase()+"."+S[2].toLowerCase()+S.substr(3):Object.keys(Tk).forEach((function(o){Tk[o]===_.toLowerCase()+"."+S[2].toLowerCase()+S.substr(3)&&delete Tk[o]}))),qT?handle(s):_k.push(s)}},receive:function receive(o){XT=o,YT&&"function"==typeof YT.initialize&&YT.initialize({emit:event$1,listen:function listen(){GT.apply(void 0,arguments)}})},event:event$1},Ok={};var Wk={mock:function mock(o,s,m,_){var S="".concat(o,".").concat(s);if(null==m||0===m.length||0===Object.values(m[0]).length)return Ok[S]&&null!=Ok[S].value?Ok[S].value:_;var E=Ok[S];return null==E&&(E={subscribers:[]}),Ok[S]=E,E.value=m[0].value,Pk.event(o,s+"Changed",{value:m[0].value}),{}}},Xk={closedCaptions:{enabled:!0,styles:{fontFamily:"Monospace sans-serif",fontSize:1,fontColor:"#ffffff",fontEdge:"none",fontEdgeColor:"#7F7F7F",fontOpacity:100,backgroundColor:"#000000",backgroundOpacity:100,textAlign:"center",textAlignVertical:"middle"}},closedCaptionsSettings:function closedCaptionsSettings(){return Wk.mock("Accessibility","closedCaptionsSettings",arguments,{enabled:!0,styles:{fontFamily:"Monospace sans-serif",fontSize:1,fontColor:"#ffffff",fontEdge:"none",fontEdgeColor:"#7F7F7F",fontOpacity:100,backgroundColor:"#000000",backgroundOpacity:100,textAlign:"center",textAlignVertical:"middle"}})},voiceGuidance:{enabled:!0,speed:5},voiceGuidanceSettings:function voiceGuidanceSettings(){return Wk.mock("Accessibility","voiceGuidanceSettings",arguments,{enabled:!0,speed:5})}},Yk={id:function id(){return Wk.mock("Account","id",arguments,"123")},uid:function uid(){return Wk.mock("Account","uid",arguments,"ee6723b8-7ab3-462c-8d93-dbf61227998e")}},Zk={config:{adServerUrl:"https://demo.v.fwmrm.net/ad/p/1",adServerUrlTemplate:"https://demo.v.fwmrm.net/ad/p/1?flag=+sltp+exvt+slcb+emcr+amcb+aeti&prof=12345:caf_allinone_profile &nw=12345&mode=live&vdur=123&caid=a110523018&asnw=372464&csid=gmott_ios_tablet_watch_live_ESPNU&ssnw=372464&vip=198.205.92.1&resp=vmap1&metr=1031&pvrn=12345&vprn=12345&vcid=1X0Ce7L3xRWlTeNhc7br8Q%3D%3D",adNetworkId:"519178",adProfileId:"12345:caf_allinone_profile",adSiteSectionId:"caf_allinone_profile_section",adOptOut:!0,privacyData:"ew0KICAicGR0IjogImdkcDp2MSIsDQogICJ1c19wcml2YWN5IjogIjEtTi0iLA0KICAibG10IjogIjEiIA0KfQ0K",ifaValue:"01234567-89AB-CDEF-GH01-23456789ABCD",ifa:"ewogICJ2YWx1ZSI6ICIwMTIzNDU2Ny04OUFCLUNERUYtR0gwMS0yMzQ1Njc4OUFCQ0QiLAogICJpZmFfdHlwZSI6ICJzc3BpZCIsCiAgImxtdCI6ICIwIgp9Cg==",appName:"FutureToday",appBundleId:"FutureToday.comcast",distributorAppId:"1001",deviceAdAttributes:"ewogICJib0F0dHJpYnV0ZXNGb3JSZXZTaGFyZUlkIjogIjEyMzQiCn0=",coppa:0,authenticationEntity:"60f72475281cfba3852413bd53e957f6"},policy:function policy(){return Wk.mock("Advertising","policy",arguments,{skipRestriction:"adsUnwatched",limitAdTracking:!1})},advertisingId:{ifa:"01234567-89AB-CDEF-GH01-23456789ABCD",ifa_type:"idfa",lmt:"0"},deviceAttributes:{},appBundleId:"operator.app"},eC={id:function id(){return Wk.mock("Device","id",arguments,"123")},distributor:function distributor(){return Wk.mock("Device","distributor",arguments,"Company")},platform:function platform(){return Wk.mock("Device","platform",arguments,"WPE")},uid:function uid(){return Wk.mock("Device","uid",arguments,"ee6723b8-7ab3-462c-8d93-dbf61227998e")},type:function type(){return Wk.mock("Device","type",arguments,"STB")},model:function model(){return Wk.mock("Device","model",arguments,"xi6")},sku:function sku(){return Wk.mock("Device","sku",arguments,"AX061AEI")},make:function make(){return Wk.mock("Device","make",arguments,"Arris")},version:function version(){return Wk.mock("Device","version",arguments,{sdk:{major:0,minor:8,patch:0,readable:"Firebolt JS SDK v0.8.0"},api:{major:0,minor:8,patch:0,readable:"Firebolt API v0.8.0"},firmware:{major:1,minor:2,patch:3,readable:"Device Firmware v1.2.3"},os:{major:0,minor:1,patch:0,readable:"Firebolt OS v0.1.0"},debug:"Non-parsable build info for error logging only."})},hdcp:function hdcp(){return Wk.mock("Device","hdcp",arguments,{"hdcp1.4":!0,"hdcp2.2":!0})},hdr:function hdr(){return Wk.mock("Device","hdr",arguments,{hdr10:!0,hdr10Plus:!0,dolbyVision:!0,hlg:!0})},audio:function audio(){return Wk.mock("Device","audio",arguments,{stereo:!0,"dolbyDigital5.1":!0,"dolbyDigital5.1+":!0,dolbyAtmos:!0})},screenResolution:function screenResolution(){return Wk.mock("Device","screenResolution",arguments,[1920,1080])},videoResolution:function videoResolution(){return Wk.mock("Device","videoResolution",arguments,[1920,1080])},name:function name(){return Wk.mock("Device","name",arguments,"Living Room")},network:function network(){return Wk.mock("Device","network",arguments,{state:"connected",type:"wifi"})}},tC={policy:function policy(){return Wk.mock("Discovery","policy",arguments,{enableRecommendations:!0,shareWatchHistory:!0,rememberWatchedPrograms:!0})},entityInfo:!0,purchasedContent:!0,watched:!0,watchNext:!0,entitlements:!0,contentAccess:null,clearContentAccess:null,launch:!0,signIn:!0,signOut:!0},nC={state:"inactive",previous:"initializing"},rC={state:"foreground",previous:"inactive"},iC={state:"unloading",previous:"inactive"},aC=function emit(o){Pk.event("Lifecycle",o.state,o)},oC=!!window.__firebolt&&!!window.__firebolt.automation,sC={ready:function ready(){nC.previous="initializing",setTimeout((function(){return aC(nC)}),oC?1:500),rC.previous="inactive",setTimeout((function(){return aC(rC)}),oC?2:1e3)},close:function close(o){var s=o.reason;if("remoteButton"===s)nC.previous="foreground",setTimeout((function(){return aC(nC)}),oC?1:500);else{if(!["userExit","error"].includes(s))throw"Invalid close reason";nC.previous="foreground",iC.previous="inactive",setTimeout((function(){return aC(nC)}),oC?1:500),setTimeout((function(){return aC(iC)}),oC?2:1e3)}},finished:function finished(){window.location&&(window.location.href="about:blank")}},uC={locality:function locality(){return Wk.mock("Localization","locality",arguments,"Philadelphia")},postalCode:function postalCode(){return Wk.mock("Localization","postalCode",arguments,"19103")},countryCode:function countryCode(){return Wk.mock("Localization","countryCode",arguments,"US")},language:function language(){return Wk.mock("Localization","language",arguments,"en")},locale:function locale(){return Wk.mock("Localization","locale",arguments,"en-US")},latlon:[39.9549,75.1699],additionalInfo:{}},lC={protocols:{"dial1.7":!0},device:"device-id",friendlyName:function friendlyName(){return Wk.mock("SecondScreen","friendlyName",arguments,"Living Room")}},cC={localization:uC,device:eC,accessibility:Xk},dC=function(){function Queue(){_classCallCheck$1(this,Queue),this._callback=null,this._queue=[]}return _createClass$1(Queue,[{key:"send",value:function send(o){this._queue.push(o)}},{key:"receive",value:function receive(o){this._callback=o}},{key:"flush",value:function flush(o){o.receive(this._callback),this._queue.forEach((function(s){return o.send(s)}))}}]),Queue}(),hC={},pC=function getLogLevel(){return hC.platform.logLevel},fC=function(){function LegacyTransport(o){_classCallCheck$1(this,LegacyTransport),this.bridge=o}return _createClass$1(LegacyTransport,[{key:"send",value:function send(o){this.bridge.JSMessageChanged(o,(function(){}))}},{key:"receive",value:function receive(o){window.$badger=window.$badger||{};var s=window.$badger.callback?window.$badger.callback.bind(window.$badger):null,m=window.$badger.event?window.$badger.event.bind(window.$badger):null;window.$badger.callback=function(m,_,S){S.jsonrpc?o(JSON.stringify(S)):s&&s(m,_,S)},window.$badger.event=function(s,_){_.jsonrpc?o(JSON.stringify(_)):m&&m(s,_)}}}],[{key:"isLegacy",value:function isLegacy(o){return LegacyTransport.isXREProxy(o)||void 0===o.send&&o.JSMessageChanged}},{key:"isXREProxy",value:function isXREProxy(o){return void 0!==o.proxyObjectTest}}]),LegacyTransport}(),gC=function(){function WebsocketTransport(o){_classCallCheck$1(this,WebsocketTransport),this._endpoint=o,this._ws=null,this._connected=!1,this._queue=[],this._callbacks=[]}return _createClass$1(WebsocketTransport,[{key:"send",value:function send(o){this._connect(),this._connected?this._ws.send(o):this._queue.length<100&&this._queue.push(o)}},{key:"receive",value:function receive(o){o&&(this._connect(),this._callbacks.push(o))}},{key:"_notifyCallbacks",value:function _notifyCallbacks(o){for(var s=this,m=function _loop(m){setTimeout((function(){return s._callbacks[m](o)}),1)},_=0;_<this._callbacks.length;_++)m(_)}},{key:"_connect",value:function _connect(){var o=this;this._ws||(this._ws=new WebSocket(this._endpoint,["jsonrpc"]),this._ws.addEventListener("message",(function(s){o._notifyCallbacks(s.data)})),this._ws.addEventListener("error",(function(o){})),this._ws.addEventListener("close",(function(s){o._ws=null,o._connected=!1})),this._ws.addEventListener("open",(function(s){o._connected=!0;for(var m=0;m<o._queue.length;m++)o._ws.send(o._queue[m]);o._queue=[]})))}}]),WebsocketTransport}();var mC={transform:function transform$2(o,s){if(!s||!s.methods)return o;var m=s.methods,_=JSON.parse(JSON.stringify(o));return Object.keys(m).forEach((function(o){var s=m[o],S=_slicedToArray$1(s["x-method"].split("."),2),E=S[0],A=S[1],O={};O[s["x-this-param"]]=_,_[o]=function(){for(var o=0;o<arguments.length;o++)O[s["x-additional-params"][o]]=o<0||arguments.length<=o?void 0:arguments[o];return vC.send(E.toLowerCase(),A,O)}})),_}},yC=null,vC=function(){function Transport(){_classCallCheck$1(this,Transport),this._promises=[],this._transport=null,this._id=1,this._eventEmitters=[],this._eventIds=[],this._queue=new dC,this._deprecated={},this.isMock=!1}return _createClass$1(Transport,[{key:"_endpoint",value:function _endpoint(){return window.__firebolt&&window.__firebolt.endpoint?window.__firebolt.endpoint:null}},{key:"constructTransportLayer",value:function constructTransportLayer(){var o,s=this,m=this._endpoint();return m&&(m.startsWith("ws://")||m.startsWith("wss://"))?(o=new gC(m)).receive(this.receiveHandler.bind(this)):void 0!==window.ServiceManager&&window.ServiceManager&&window.ServiceManager.version?(o=this._queue,window.ServiceManager.getServiceForJavaScript("com.comcast.BridgeObject_1",(function(m){o=fC.isLegacy(m)?new fC(m):m,s.setTransportLayer(o)}))):(this.isMock=!0,(o=Pk).receive(this.receiveHandler.bind(this))),o}},{key:"setTransportLayer",value:function setTransportLayer(o){this._transport=o,this._queue.flush(o)}},{key:"_send",value:function _send(o,s,m,_){return!Array.isArray(o)||s||m?this._sendAndGetId(o,s,m,_).promise:this._batch(o)}},{key:"_sendAndGetId",value:function _sendAndGetId(o,s,m,_){var S=this._processRequest(o,s,m,_),E=S.promise,A=S.json,O=S.id,H=JSON.stringify(A);return"DEBUG"===pC()&&console.debug("Sending message to transport: "+H),this._transport.send(H),{id:O,promise:E}}},{key:"_batch",value:function _batch(o){var s=this,m=[],_=[];o.forEach((function(o){var S=o.module,E=o.method,A=o.params,O=o.transforms,H=s._processRequest(S,E,A,O);m.push({promise:H.promise,id:H.id}),_.push(H.json)}));var S=JSON.stringify(_);return"DEBUG"===pC()&&console.debug("Sending message to transport: "+S),this._transport.send(S),m}},{key:"_processRequest",value:function _processRequest(o,s,m,_){var S={promise:this._addPromiseToQueue(o,s,m,_),json:this._createRequestJSON(o,s,m),id:this._id};return this._id++,S}},{key:"_createRequestJSON",value:function _createRequestJSON(o,s,m){return{jsonrpc:"2.0",method:o.toLowerCase()+"."+s,params:m,id:this._id}}},{key:"_addPromiseToQueue",value:function _addPromiseToQueue(o,s,m,_){var S=this;return new Promise((function(E,A){S._promises[S._id]={},S._promises[S._id].promise=S,S._promises[S._id].resolve=E,S._promises[S._id].reject=A,S._promises[S._id].transforms=_;var O=S._deprecated[o.toLowerCase()+"."+s.toLowerCase()];O&&console.warn("WARNING: ".concat(o,".").concat(s,"() is deprecated. ")+O.alternative),s.match(/^on[A-Z]/)&&(m.listen?S._eventIds.push(S._id):S._eventIds=S._eventIds.filter((function(o){return o!==S._id})))}))}},{key:"receiveHandler",value:function receiveHandler(o){"DEBUG"===pC()&&console.debug("Received message from transport: "+o);var s=JSON.parse(o),m=this._promises[s.id];if(m){if(s.error)m.reject(s.error);else{var _=s.result;m.transforms&&(_=Array.isArray(s.result)?_.map((function(o){return mC.transform(o,m.transforms)})):mC.transform(_,m.transforms)),m.resolve(_)}delete this._promises[s.id]}this._eventIds.includes(s.id)&&!function isEventSuccess(o){return o&&"string"==typeof o.event&&"boolean"==typeof o.listening}(s.result)&&this._eventEmitters.forEach((function(o){o(s.id,s.result)}))}},{key:"init",value:function init(){!function initSettings(o,s){hC.app=o,hC.platform=_objectSpread2({logLevel:"WARN"},s),hC.user={}}({},{log:!0}),this._queue.receive(this.receiveHandler.bind(this)),window.__firebolt&&(!0===window.__firebolt.mockTransportLayer?(this.isMock=!0,this.setTransportLayer(Pk)):window.__firebolt.getTransportLayer&&this.setTransportLayer(window.__firebolt.getTransportLayer())),null==this._transport&&(this._transport=this.constructTransportLayer())}}],[{key:"addEventEmitter",value:function addEventEmitter(o){Transport.get()._eventEmitters.push(o)}},{key:"registerDeprecatedMethod",value:function registerDeprecatedMethod(o,s,m){Transport.get()._deprecated[o.toLowerCase()+"."+s.toLowerCase()]={alternative:m||""}}},{key:"send",value:function send(o,s,m,_){return Transport.get()._send(o,s,m,_)}},{key:"listen",value:function listen(o,s,m,_){return Transport.get()._sendAndGetId(o,s,m,_)}},{key:"get",value:function get(){if(window.__firebolt=window.__firebolt||{},null==window.__firebolt.transport&&null==yC){var o=new Transport;o.init(),o.isMock?yC=o:(window.__firebolt=window.__firebolt||{},window.__firebolt.transport=o),window.__firebolt.setTransportLayer=o.setTransportLayer.bind(o)}return window.__firebolt.transport?window.__firebolt.transport:yC}}]),Transport}();window.__firebolt=window.__firebolt||{},window.__firebolt.setTransportLayer=function(o){vC.get().setTransportLayer(o)};var _C=0,bC={internal:{},external:{},get:function get(o){return Object.assign(Object.assign({},bC.internal[o]),bC.external[o])},set:function set(o,s,m){bC.external[o]=bC.external[o]||{},bC.external[o][s]=m},setInternal:function setInternal(o,s,m){bC.internal[o]=bC.internal[o]||{},bC.internal[o][s]=m},find:function find(o){var s;return[bC.internal,bC.external].find((function(m){if(s=Object.keys(m).find((function(s){return m[s][o]})))return!0})),s},remove:function remove(o){[bC.internal,bC.external].forEach((function(s){Object.keys(s).forEach((function(m){s[m]&&s[m][o]&&(delete s[m][o],0===Object.values(s[m]).length&&delete s[m])}))}))},removeKey:function removeKey(o){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&bC.internal[o]&&delete bC.internal[o],bC.external[o]&&delete bC.external[o]},keys:function keys(){return Array.from(new Set(Object.keys(bC.internal).concat(Object.keys(bC.external))))},count:function count(o){return Object.values(bC.get(o)).length}},SC={},TC=[],kC={},CC={},wC=!1,xC=function emit(o,s){AC(bC.internal[SC[o]],[s]),AC(bC.external[SC[o]],[s])},EC=function registerEvents(o,s){kC[o.toLowerCase()]=s.concat()},IC=function registerEventContext(o,s,m){CC[o.toLowerCase()]=CC[o.toLowerCase()]||{},CC[o.toLowerCase()][s]=m.concat()},AC=function callCallbacks(o,s){o&&Object.keys(o).forEach((function(m){var _=o[m];TC.indexOf(parseInt(m))>=0&&(TC.splice(TC.indexOf(parseInt(m)),1),delete o[m]),_.apply(null,s)}))},PC=function doListen(o,s,m,_,S){var E=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(NC(),"function"!=typeof m)return Promise.reject("No valid callback function provided.");if("*"===o)return Promise.reject("No valid module name provided");var A,O,H="*"===s,K=H?kC[o]:[s],z=[],G=Object.values(_).length>0,q=Object.keys(_).sort().map((function(o){return o+"="+JSON.stringify(_[o])})).join("&");_C++,S&&TC.push(_C),K.forEach((function(s){var S=o+"."+s+(G?".".concat(q):"");if(0===Object.values(bC.get(S)).length){var A=Object.assign({listen:!0},_),O=vC.listen(o,"on"+s[0].toUpperCase()+s.substring(1),A),K=O.id,X=O.promise;SC[K]=S,z.push(X)}var J=E?bC.setInternal:bC.set;J(S,""+_C,H?function(o){return m(s,o)}:m)}));var X=new Promise((function(o,s){A=o,O=s}));return z.length?Promise.all(z).then((function(o){A(_C)})).catch((function(o){"*"===s?A(_C):O(o)})):A(_C),X},LC=function getListenArgs(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];var _=s.pop(),S=_slicedToArray$1(DC.apply(void 0,s),3);return[S[0],S[1],_,S[2]]},DC=function getClearArgs(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];for(var _=(s.shift()||"*").toLowerCase(),S=s.shift()||"*",E={},A=0;A<s.length;A++)E[CC[_][S][A]]=s.shift();return[_,S,E]},RC=function listen(){var o=_slicedToArray$1(LC.apply(void 0,arguments),4),s=o[0],m=o[1],_=o[2],S=o[3];return PC(s,m,_,S,!1)},OC=function prioritize(){var o=_slicedToArray$1(LC.apply(void 0,arguments),4),s=o[0],m=o[1],_=o[2],S=o[3];return PC(s,m,_,S,!1,!0)},MC=function unsubscribe(o,s){var m=_slicedToArray$1(o.split(".").slice(0,2),2),_=m[0],S=m[1],E=Object.assign({listen:!1},s);vC.send(_,"on"+S[0].toUpperCase()+S.substr(1),E)},FC=function doClear(){var o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],m=arguments.length>2?arguments[2]:void 0;if("*"===s&&(s=!1),"number"==typeof o){var _=o.toString(),S=bC.find(_);return!!S&&(bC.remove(_),0===bC.count(S)&&MC(S),!0)}if(o||s)if(s){var E=Object.values(m).length>0,A=Object.keys(m).sort().map((function(o){return o+"="+JSON.stringify(m[o])})).join("&"),O=o+"."+s+(E?".".concat(A):"");bC.removeKey(O),MC(O,m)}else bC.keys().forEach((function(s){0===s.indexOf(o.toLowerCase())&&(bC.removeKey(s),MC(s))}));else bC.keys().forEach((function(o){bC.removeKey(o),MC(o)}))},NC=function init(){wC||(vC.addEventEmitter(xC),function setMockListener(o){GT=o}(RC),wC=!0)},UC={listen:RC,once:function once(){var o=_slicedToArray$1(LC.apply(void 0,arguments),4),s=o[0],m=o[1],_=o[2],S=o[3];return PC(s,m,_,S,!0)},clear:function clear(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];if(s&&s.length&&"number"==typeof s[0])return FC(s[0]);if(s&&s.length&&"number"==typeof s[1])return FC(s[1]);var _=_slicedToArray$1(DC.apply(void 0,s),3),S=_[0],E=_[1],A=_[2];return FC(S,E,A)},broadcast:function broadcast(o,s){xC(Object.entries(SC).find((function(s){var m=_slicedToArray$1(s,2);return m[0],m[1]==="app."+o}))[0],s)}};var BC={prop:function prop(o,s,m){var _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,S=arguments.length>4?arguments[4]:void 0,E=arguments.length>5?arguments[5]:void 0,A=arguments.length>6?arguments[6]:void 0,O=Object.values(m).length;if(O===A&&null===_)return vC.send(o,s,m);if(O===A&&"function"==typeof _){if(S)throw new Error("Cannot subscribe to an immutable property");return UC.listen(o,s+"Changed",_)}if(O===A&&null!==_){if(S)throw new Error("Cannot set a value to an immutable property");if(E)throw new Error("Cannot set a value to a readonly property");return vC.send(o,"set"+s[0].toUpperCase()+s.substring(1),Object.assign({value:_},m))}throw O<A?new Error("Cannot get a value without all required context parameters."):new Error("Property accessed with unexpected number of parameters.")}};EC("Accessibility",["closedCaptionsSettingsChanged","voiceGuidanceSettingsChanged"]),vC.registerDeprecatedMethod("Accessibility","closedCaptions","Use Accessibility.closedCaptionsSettings() instead."),vC.registerDeprecatedMethod("Accessibility","voiceGuidance","Use Accessibility.voiceGuidanceSettings() instead.");var jC={events:{CLOSED_CAPTIONS_SETTINGS_CHANGED:"closedCaptionsSettingsChanged",VOICE_GUIDANCE_SETTINGS_CHANGED:"voiceGuidanceSettingsChanged"},clear:function clear$3(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.clear.apply(UC,["Accessibility"].concat(s))},closedCaptions:function closedCaptions(){return vC.send("Accessibility","closedCaptions",{},null)},closedCaptionsSettings:function closedCaptionsSettings(){var o=arguments[0];return BC.prop("Accessibility","closedCaptionsSettings",{},o,!1,!0,0)},listen:function listen$4(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.listen.apply(UC,["Accessibility"].concat(s))},once:function once$3(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.once.apply(UC,["Accessibility"].concat(s))},voiceGuidance:function voiceGuidance(){return vC.send("Accessibility","voiceGuidance",{},null)},voiceGuidanceSettings:function voiceGuidanceSettings(){var o=arguments[0];return BC.prop("Accessibility","voiceGuidanceSettings",{},o,!1,!0,0)}};EC("Advertising",["policyChanged"]);var $C={events:{POLICY_CHANGED:"policyChanged"},SkipRestriction:{NONE:"none",ADS_UNWATCHED:"adsUnwatched",ADS_ALL:"adsAll",ALL:"all"},advertisingId:function advertisingId(){return vC.send("Advertising","advertisingId",{},null)},appBundleId:function appBundleId(){return vC.send("Advertising","appBundleId",{},null)},clear:function clear$2(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.clear.apply(UC,["Advertising"].concat(s))},config:function config(o){return vC.send("Advertising","config",{options:o},null)},deviceAttributes:function deviceAttributes(){return vC.send("Advertising","deviceAttributes",{},null)},listen:function listen$3(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.listen.apply(UC,["Advertising"].concat(s))},once:function once$2(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.once.apply(UC,["Advertising"].concat(s))},policy:function policy(){var o=arguments[0];return BC.prop("Advertising","policy",{},o,!1,!0,0)}};vC.registerDeprecatedMethod("Authentication","token","Use Authentication module has individual methods for each token type. instead."),EC("Capabilities",["available","granted","revoked","unavailable"]),IC("Capabilities","available",["capability"]),IC("Capabilities","granted",["role","capability"]),IC("Capabilities","revoked",["role","capability"]),IC("Capabilities","unavailable",["capability"]),EC("Device",["audioChanged","deviceNameChanged","hdcpChanged","hdrChanged","nameChanged","networkChanged","screenResolutionChanged","videoResolutionChanged"]),vC.registerDeprecatedMethod("Device","onDeviceNameChanged","Use Device.name() instead.");var VC={events:{DEVICE_NAME_CHANGED:"deviceNameChanged",NAME_CHANGED:"nameChanged",HDCP_CHANGED:"hdcpChanged",HDR_CHANGED:"hdrChanged",AUDIO_CHANGED:"audioChanged",SCREEN_RESOLUTION_CHANGED:"screenResolutionChanged",VIDEO_RESOLUTION_CHANGED:"videoResolutionChanged",NETWORK_CHANGED:"networkChanged"},NetworkState:{CONNECTED:"connected",DISCONNECTED:"disconnected"},NetworkType:{WIFI:"wifi",ETHERNET:"ethernet",HYBRID:"hybrid"},AudioProfile:{STEREO:"stereo",DOLBY_DIGITAL_5_1:"dolbyDigital5.1",DOLBY_DIGITAL_7_1:"dolbyDigital7.1",DOLBY_DIGITAL_5_1_PLUS:"dolbyDigital5.1+",DOLBY_DIGITAL_7_1_PLUS:"dolbyDigital7.1+",DOLBY_ATMOS:"dolbyAtmos"},version:function version$9(){return new Promise((function(o,s){vC.send("device","version").then((function(s){(s=s||{}).sdk=s.sdk||{},s.sdk.major=parseInt("0"),s.sdk.minor=parseInt("11"),s.sdk.patch=parseInt("0"),s.sdk.readable="Firebolt Core SDK 0.11.0",o(s)})).catch((function(o){s(o)}))}))},audio:function audio(){var o=arguments[0];return BC.prop("Device","audio",{},o,!1,!0,0)},clear:function clear$1(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.clear.apply(UC,["Device"].concat(s))},distributor:function distributor(){var o=arguments[0];return BC.prop("Device","distributor",{},o,!0,!0,0)},hdcp:function hdcp(){var o=arguments[0];return BC.prop("Device","hdcp",{},o,!1,!0,0)},hdr:function hdr(){var o=arguments[0];return BC.prop("Device","hdr",{},o,!1,!0,0)},id:function id(){var o=arguments[0];return BC.prop("Device","id",{},o,!0,!0,0)},listen:function listen$2(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.listen.apply(UC,["Device"].concat(s))},make:function make(){var o=arguments[0];return BC.prop("Device","make",{},o,!0,!0,0)},model:function model(){var o=arguments[0];return BC.prop("Device","model",{},o,!0,!0,0)},name:function name$1(){var o=arguments[0];return BC.prop("Device","name",{},o,!1,!0,0)},network:function network(){var o=arguments[0];return BC.prop("Device","network",{},o,!1,!0,0)},once:function once$1(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.once.apply(UC,["Device"].concat(s))},platform:function platform(){var o=arguments[0];return BC.prop("Device","platform",{},o,!0,!0,0)},screenResolution:function screenResolution(){var o=arguments[0];return BC.prop("Device","screenResolution",{},o,!1,!0,0)},sku:function sku(){var o=arguments[0];return BC.prop("Device","sku",{},o,!0,!0,0)},type:function type(){var o=arguments[0];return BC.prop("Device","type",{},o,!0,!0,0)},uid:function uid(){var o=arguments[0];return BC.prop("Device","uid",{},o,!0,!0,0)},videoResolution:function videoResolution(){var o=arguments[0];return BC.prop("Device","videoResolution",{},o,!1,!0,0)}};var HC={ErrorType:{NETWORK:"network",MEDIA:"media",RESTRICTION:"restriction",ENTITLEMENT:"entitlement",OTHER:"other"},action:function action(o,s,m){return vC.send("Metrics","action",{category:o,type:s,parameters:m},null)},error:function error(o,s,m,_,S){return vC.send("Metrics","error",{type:o,code:s,description:m,visible:_,parameters:S},null)},mediaEnded:function mediaEnded(o){return vC.send("Metrics","mediaEnded",{entityId:o},null)},mediaLoadStart:function mediaLoadStart(o){return vC.send("Metrics","mediaLoadStart",{entityId:o},null)},mediaPause:function mediaPause(o){return vC.send("Metrics","mediaPause",{entityId:o},null)},mediaPlay:function mediaPlay(o){return vC.send("Metrics","mediaPlay",{entityId:o},null)},mediaPlaying:function mediaPlaying(o){return vC.send("Metrics","mediaPlaying",{entityId:o},null)},mediaProgress:function mediaProgress(o,s){return vC.send("Metrics","mediaProgress",{entityId:o,progress:s},null)},mediaRateChange:function mediaRateChange(o,s){return vC.send("Metrics","mediaRateChange",{entityId:o,rate:s},null)},mediaRenditionChange:function mediaRenditionChange(o,s,m,_,S){return vC.send("Metrics","mediaRenditionChange",{entityId:o,bitrate:s,width:m,height:_,profile:S},null)},mediaSeeked:function mediaSeeked(o,s){return vC.send("Metrics","mediaSeeked",{entityId:o,position:s},null)},mediaSeeking:function mediaSeeking(o,s){return vC.send("Metrics","mediaSeeking",{entityId:o,target:s},null)},mediaWaiting:function mediaWaiting(o){return vC.send("Metrics","mediaWaiting",{entityId:o},null)},page:function page(o){return vC.send("Metrics","page",{pageId:o},null)},startContent:function startContent(o){return vC.send("Metrics","startContent",{entityId:o},null)},stopContent:function stopContent(o){return vC.send("Metrics","stopContent",{entityId:o},null)}};EC("Discovery",["navigateTo","policyChanged","pullEntityInfo","pullPurchasedContent"]),vC.registerDeprecatedMethod("Discovery","entitlements","Use Discovery.contentAccess() instead."),EC("Lifecycle",["background","foreground","inactive","suspended","unloading"]);var KC={_current:"initializing",get current(){return this._current}};function _ready(){return _ready=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){var o;return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,OC("Lifecycle",(function(o,s){KC._current=o}));case 2:return s.next=4,vC.send("lifecycle","ready",{});case 4:return o=s.sent,setTimeout((function(o){vC.send("metrics","ready",{})})),s.abrupt("return",o);case 7:case"end":return s.stop()}}),_callee)}))),_ready.apply(this,arguments)}var zC={events:{INACTIVE:"inactive",FOREGROUND:"foreground",BACKGROUND:"background",SUSPENDED:"suspended",UNLOADING:"unloading"},CloseReason:{REMOTE_BUTTON:"remoteButton",USER_EXIT:"userExit",DONE:"done",ERROR:"error"},LifecycleState:{INITIALIZING:"initializing",INACTIVE:"inactive",FOREGROUND:"foreground",BACKGROUND:"background",UNLOADING:"unloading",SUSPENDED:"suspended"},ready:function ready(){return _ready.apply(this,arguments)},state:function state(){return KC.current},finished:function finished(){if("unloading"===KC.current)return vC.send("lifecycle","finished");throw"Cannot call finished() except when in the unloading transition"},clear:function clear(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.clear.apply(UC,["Lifecycle"].concat(s))},close:function close(o){return vC.send("Lifecycle","close",{reason:o},null)},listen:function listen$1(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.listen.apply(UC,["Lifecycle"].concat(s))},once:function once(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return UC.once.apply(UC,["Lifecycle"].concat(s))}};EC("Localization",["countryCodeChanged","languageChanged","localeChanged","localityChanged","postalCodeChanged"]),EC("SecondScreen",["closeRequest","friendlyNameChanged","launchRequest"]),function setMockResponses(o){qT=o,_k.forEach((function(o){return handle(o)})),_k.length=0}({Accessibility:Xk,Account:Yk,Advertising:Zk,Authentication:{token:{value:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",expires:"2022-04-23T18:25:43.511Z",type:"platform"},device:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",session:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",root:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"},Capabilities:{supported:!0,available:!0,permitted:!0,granted:!0,info:[{capability:"xrn:firebolt:capability:device:model",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0}},{capability:"xrn:firebolt:capability:input:keyboard",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0}},{capability:"xrn:firebolt:capability:protocol:bluetoothle",supported:!1,available:!1,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["unsupported"]},{capability:"xrn:firebolt:capability:token:device",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0}},{capability:"xrn:firebolt:capability:token:platform",supported:!0,available:!1,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["unavailable"]},{capability:"xrn:firebolt:capability:protocol:moca",supported:!0,available:!1,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["disabled","unavailable"]},{capability:"xrn:firebolt:capability:wifi:scan",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["unpermitted"]},{capability:"xrn:firebolt:capability:localization:postal-code",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["ungranted"]},{capability:"xrn:firebolt:capability:localization:postal-code",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["ungranted"]},{capability:"xrn:firebolt:capability:localization:locality",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0},details:["grantDenied","ungranted"]}],request:[{capability:"xrn:firebolt:capability:commerce:purchase",supported:!0,available:!0,use:{permitted:!0,granted:!0},manage:{permitted:!0,granted:!0},provide:{permitted:!0,granted:!0}}]},Device:eC,Discovery:tC,Keyboard:{email:"user@domain.com",password:"abc123",standard:"Living Room"},Lifecycle:sC,Localization:uC,Metrics:{ready:!0,signIn:!0,signOut:!0,startContent:!0,stopContent:!0,page:!0,action:!0,error:!0,mediaLoadStart:!0,mediaPlay:!0,mediaPlaying:!0,mediaPause:!0,mediaWaiting:!0,mediaProgress:!0,mediaSeeking:!0,mediaSeeked:!0,mediaRateChange:!0,mediaRenditionChange:!0,mediaEnded:!0},Parameters:{initialization:{lmt:0,us_privacy:"1-Y-",discovery:{navigateTo:{action:"entity",data:{entityId:"abc",entityType:"program",programType:"movie"},context:{source:"voice"}}}}},Profile:{approveContentRating:!1,approvePurchase:!1,flags:{userExperience:"1000"}},SecondScreen:lC,SecureStorage:{get:"VGhpcyBub3QgYSByZWFsIHRva2VuLgo=",set:null,remove:null},Platform:cC});var WC,GC,__awaiter$g=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},qC=VC.NetworkType,XC=HC.ErrorType,YC=function(o){_inherits$1(X1,o);var s=_createSuper$1(X1);function X1(){var o,m=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return _classCallCheck$1(this,X1),(o=s.call(this))._model="",o._browserOSVersion="",o._modelCode="",o._networkType=qC.ETHERNET,o._limitAdTracking=!1,o._hdmiConnected=!0,o.deviceScreenResolution=null,o.devicePlatform="",o.shouldCheckAdvertisingInfo=!0,o.advertisingIdFailed=!1,o.shouldCheckAdvertisingInfo=m,o}return _createClass$1(X1,[{key:"init",value:function init(){var o=this,s=Object.create(null,{init:{get:function get(){return _get$1(_getPrototypeOf$1(X1.prototype),"init",o)}}});return __awaiter$g(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o=this;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,s.init.call(this);case 2:return window.addEventListener("keydown",(function(o){8===o.keyCode&&o.preventDefault()}),!0),m.next=5,Promise.all([this._setStaticDeviceCapabilities(),this._setDeviceInfo(),this._setNetworkConnectivity(),this.getScreenResolution(),this.getPlatform(),this._setAdvertisingInfo()]);case 5:return this._checkTTSStatus(),VC.listen("hdcpChanged",(function(s){o._hdmiConnected=Object.values(s).some((function(o){return!0===o}))})),m.next=9,this._setupBadger();case 9:this.retryWithBadger();case 10:case"end":return m.stop()}}),_callee,this)})))}},{key:"retryWithBadger",value:function retryWithBadger(){this.setAdvertisingInfoBadger()}},{key:"getScreenResolution",value:function getScreenResolution(){var o=this;return VC.screenResolution().then((function(s){o.deviceScreenResolution=s}))}},{key:"getPlatform",value:function getPlatform(){var o=this;return VC.platform().then((function(s){o.devicePlatform=s}))}},{key:"_setupBadger",value:function _setupBadger(){return __awaiter$g(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new Promise((function(o){try{window.$badger.active(),o()}catch(m){var s=document.createElement("script");s.setAttribute("src","https://cdn.thor.comcast.com/sdk/money-badger.min.js"),document.head.appendChild(s),document.addEventListener("onMoneyBadgerReady",(function(){return o()}))}})));case 1:case"end":return o.stop()}}),_callee2)})))}},{key:"_setStaticDeviceCapabilities",value:function _setStaticDeviceCapabilities(){return __awaiter$g(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:this._browserOSVersion=this.getBrowserOSVersionNumber(),this.retrieveFireBoltDeviceInfo();case 2:case"end":return o.stop()}}),_callee3,this)})))}},{key:"retrieveFireBoltDeviceInfo",value:function retrieveFireBoltDeviceInfo(){var o=this,s=VC.model().then((function(s){o._model="string"!=typeof s?"X1":s})).catch((function(s){return o._logFireboltError("Device.model",s)})),m=VC.make().then((function(s){o._modelCode="string"!=typeof s?"X1":s})).catch((function(s){return o._logFireboltError("Device.make",s)}));return Promise.all([s,m])}},{key:"_setDeviceInfo",value:function _setDeviceInfo(){var o=this,s=VC.uid().then((function(s){o._deviceId=s})).catch((function(s){return o._logFireboltError("Device.uid",s)})),m=VC.distributor().then((function(s){o._partnerId=s})).catch((function(s){return o._logFireboltError("Device.distributor",s)}));return Promise.all([s,m])}},{key:"_setNetworkConnectivity",value:function _setNetworkConnectivity(){var o=this;return VC.network().then((function(s){var m=s;o._networkType=m.type})).catch((function(s){return o._logFireboltError("Device.network",s)}))}},{key:"_setAdvertisingInfo",value:function _setAdvertisingInfo(){var o=this;if(this.shouldCheckAdvertisingInfo)return $C.advertisingId().then((function(s){var m=s;o._advertisingId=m.ifa,o._limitAdTracking="1"===m.lmt})).catch((function(s){var m;o._logFireboltError("Advertising.advertisingId",s),null===(m=o.logger)||void 0===m||m.warn("Retrieving advertisingID using $badger"),o.advertisingIdFailed=!0}))}},{key:"setAdvertisingInfoBadger",value:function setAdvertisingInfoBadger(){var o=this;if(this.advertisingIdFailed)return new Promise((function(s,m){window.$badger.adPlatform().advertisingId().success((function(m){o._advertisingId=m.ifa,o._limitAdTracking="1"===m.lmt,s()})).failure((function(){var s;null===(s=o.logger)||void 0===s||s.error("X1 | Error accessing moneybadger api: advertisingId"),m()}))}))}},{key:"getCloseCaptioningEnabled",value:function getCloseCaptioningEnabled(){return __awaiter$g(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){var o=this;return _regeneratorRuntime$1().wrap((function _callee4$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",jC.closedCaptionsSettings().then((function(o){return o.enabled})).catch((function(s){return o._logFireboltError("Accessibility.closedCaptionsSettings",s),!1})));case 1:case"end":return s.stop()}}),_callee4)})))}},{key:"getTTSStatus",value:function getTTSStatus(){return __awaiter$g(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){var o=this;return _regeneratorRuntime$1().wrap((function _callee5$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",jC.voiceGuidanceSettings().then((function(o){return o.enabled})).catch((function(s){return o._logFireboltError("Accessibility.voiceGuidanceSettings",s),!1})));case 1:case"end":return s.stop()}}),_callee5)})))}},{key:"getHDMIConnectedStatus",value:function getHDMIConnectedStatus(){return __awaiter$g(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this._hdmiConnected);case 1:case"end":return o.stop()}}),_callee6,this)})))}},{key:"shutdown",value:function shutdown(){var o=this,s=setTimeout((function(){window.$badger.shutdown()}),500);zC.close(zC.CloseReason.USER_EXIT).catch((function(m){clearTimeout(s),o._logFireboltError("Lifecycle.close",m)}))}},{key:"errorMetricsHandler",value:function errorMetricsHandler(o,s,m,_){var S=this;HC.error(XC.OTHER,m,o,s,_).catch((function(o){return S._logFireboltError("Metrics.error",o)}))}},{key:"dismissLoadingScreen",value:function dismissLoadingScreen(){var o,s=this;try{window.$badger.dismissLoadingScreen()}catch(s){null===(o=this.logger)||void 0===o||o.warn("### Badger error ".concat(s))}zC.ready().catch((function(o){return s._logFireboltError("Lifecycle.ready",o)}))}},{key:"resizePlatformPlayer",value:function resizePlatformPlayer(o,s,m,_){try{window.$badger.resizevideo(o,s,m,_)}catch(o){return}}},{key:"toggleVideoOn",value:function toggleVideoOn(){var o;try{window.$badger.toggleVideo(!0)}catch(s){return void(null===(o=this.logger)||void 0===o||o.warn(JSON.stringify(s,null,2)))}}},{key:"toggleVideoOff",value:function toggleVideoOff(){var o;try{window.$badger.toggleVideo()}catch(s){return void(null===(o=this.logger)||void 0===o||o.warn(JSON.stringify(s,null,2)))}}},{key:"mute",value:function mute(){return new Promise((function(o){o(!1)}))}},{key:"unmute",value:function unmute(){return new Promise((function(o){o(!1)}))}},{key:"keyMapping",get:function get(){return{179:"MediaPlayPause",228:"MediaFastForward",227:"MediaRewind"}}},{key:"deviceType",get:function get(){return"X1"}},{key:"osName",get:function get(){return"X1"}},{key:"webBrowser",get:function get(){return this._webBrowser}},{key:"manufacturer",get:function get(){return"Comcast"}},{key:"brand",get:function get(){return"Comcast"}},{key:"supportsTTS",get:function get(){return!0}},{key:"supportsCCNativeListener",get:function get(){return!1}},{key:"deviceCategory",get:function get(){return"STB"}},{key:"appActionMetricsHandler",value:function appActionMetricsHandler(o,s){var m=this;switch(o){case"start":HC.startContent(s).catch((function(o){return m._logFireboltError("Metrics.startContent",o)}));break;case"stop":HC.stopContent().catch((function(o){return m._logFireboltError("Metrics.stopContent",o)}))}}},{key:"_logFireboltError",value:function _logFireboltError(o,s){var m,_=s.message;null===(m=this.logger)||void 0===m||m.error("X1 | Error accessing Firebolt API ".concat(o,"(): ").concat(_))}},{key:"getBrowserOSVersionNumber",value:function getBrowserOSVersionNumber(){var o="0.0.0";try{var s=navigator.userAgent.split(/\s*[;,)(]\s*/).find((function(o){return o.includes("Version")}));s&&(o=s)}finally{return o}}},{key:"model",get:function get(){return this._model}},{key:"modelCode",get:function get(){return this._modelCode}},{key:"platform",get:function get(){return this.devicePlatform}},{key:"screenResolution",get:function get(){return this.deviceScreenResolution}},{key:"osVersion",get:function get(){return this._browserOSVersion}},{key:"networkType",get:function get(){return this._networkType}},{key:"limitAdTracking",get:function get(){return this._limitAdTracking}},{key:"partnerId",get:function get(){return this._partnerId?this._partnerId:"comcast"}}]),X1}(AS),__awaiter$f=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},QC=function(o){_inherits$1(Browser,o);var s=_createSuper$1(Browser);function Browser(){return _classCallCheck$1(this,Browser),s.apply(this,arguments)}return _createClass$1(Browser,[{key:"init",value:function init(){var o=this,s=Object.create(null,{init:{get:function get(){return _get$1(_getPrototypeOf$1(Browser.prototype),"init",o)}}});return __awaiter$f(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,s.init.call(this);case 2:return this._checkTTSStatus(),o.abrupt("return");case 4:case"end":return o.stop()}}),_callee,this)})))}},{key:"shutdown",value:function shutdown(){console.info("Shutdown event fallback")}},{key:"mute",value:function mute(){return new Promise((function(o){o(!1)}))}},{key:"unmute",value:function unmute(){return new Promise((function(o){o(!1)}))}},{key:"errorMetricsHandler",value:function errorMetricsHandler(o,s,m){var _,S={message:o,visible:s,code:m,args:arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}};null===(_=this.logger)||void 0===_||_.info("errorMetricsHandler event fallback ".concat(JSON.stringify(S,null,2)))}},{key:"dismissLoadingScreen",value:function dismissLoadingScreen(){var o;null===(o=this.logger)||void 0===o||o.info("Dismiss loading screen event fallback")}},{key:"getHDMIConnectedStatus",value:function getHDMIConnectedStatus(){return __awaiter$f(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!0);case 1:case"end":return o.stop()}}),_callee2)})))}},{key:"getCloseCaptioningEnabled",value:function getCloseCaptioningEnabled(){return __awaiter$f(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!1);case 1:case"end":return o.stop()}}),_callee3)})))}},{key:"getTTSStatus",value:function getTTSStatus(){return __awaiter$f(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!1);case 1:case"end":return o.stop()}}),_callee4)})))}},{key:"deviceType",get:function get(){return"browser"}},{key:"keyMapping",get:function get(){return{80:"MediaPlayPause",70:"MediaFastForward",82:"MediaRewind"}}},{key:"model",get:function get(){return""}},{key:"modelCode",get:function get(){return""}},{key:"manufacturer",get:function get(){return""}},{key:"osVersion",get:function get(){return""}},{key:"networkType",get:function get(){return""}},{key:"deviceCategory",get:function get(){return""}},{key:"osName",get:function get(){return""}},{key:"limitAdTracking",get:function get(){return!1}},{key:"supportsTTS",get:function get(){return!0}},{key:"supportsCCNativeListener",get:function get(){return!1}}]),Browser}(AS),__awaiter$e=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},JC=function(o){_inherits$1(Tizen,o);var s=_createSuper$1(Tizen);function Tizen(){var o;return _classCallCheck$1(this,Tizen),(o=s.apply(this,arguments))._model="",o._modelCode="",o._osVersion="",o._limitAdTracking=!1,o._requiredKeys=["MediaPause","MediaPlay","MediaFastForward","MediaRewind"],o._addTTSChangeNativeListener=function(s){var m;try{webapis.tvinfo.addCaptionChangeListener(webapis.tvinfo.TvInfoMenuKey.VOICE_GUIDE_KEY,s)}catch(s){null===(m=o.logger)||void 0===m||m.warn("Cannot add TTS listener ".concat(s))}},o._addCaptionChangeNativeListener=function(s){var m;try{webapis.tvinfo.addCaptionChangeListener(webapis.tvinfo.TvInfoMenuKey.SUBTITLE_ONOFF_KEY,s)}catch(s){null===(m=o.logger)||void 0===m||m.warn("Cannot add closed captions listener ".concat(s))}},o._addNetworkStatusChangeNativeListener=function(s){var m;try{webapis.network.addNetworkStateChangeListener((function(){var o=webapis.network.getActiveConnectionType()!==webapis.network.NetworkActiveConnectionType.DISCONNECTED;s(o)}))}catch(s){null===(m=o.logger)||void 0===m||m.warn("Cannot add Network status listener ".concat(s))}},o}return _createClass$1(Tizen,[{key:"init",value:function init(){var o=this,s=Object.create(null,{init:{get:function get(){return _get$1(_getPrototypeOf$1(Tizen.prototype),"init",o)}}});return __awaiter$e(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o,m,_=this;return _regeneratorRuntime$1().wrap((function _callee$(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,s.init.call(this);case 2:return S.next=4,this._injectScript("$WEBAPIS/webapis/webapis.js");case 4:this._updateDeviceInfo(),this._updateAdInfo(),o=[],(m=tizen.tvinputdevice).getSupportedKeys().forEach((function(s){var m=s.name;_._requiredKeys.includes(m)&&o.push(m)})),m.registerKeyBatch(o),this._checkTTSStatus(),this._checkCCStatus(),this._addTTSChangeNativeListener((function(){_._checkTTSStatus()})),this._addCaptionChangeNativeListener((function(){_._checkCCStatus()})),this._addNetworkStatusChangeNativeListener(this._checkNetworkStatus);case 15:case"end":return S.stop()}}),_callee,this)})))}},{key:"shutdown",value:function shutdown(){tizen.application.getCurrentApplication().exit()}},{key:"getCloseCaptioningEnabled",value:function getCloseCaptioningEnabled(){return __awaiter$e(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:if(!webapis.tvinfo){o.next=4;break}return o.abrupt("return",!!webapis.tvinfo.getMenuValue(webapis.tvinfo.TvInfoMenuKey.SUBTITLE_ONOFF_KEY));case 4:return o.abrupt("return",!1);case 5:case"end":return o.stop()}}),_callee2)})))}},{key:"getTTSStatus",value:function getTTSStatus(){return __awaiter$e(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:if(!webapis.tvinfo){o.next=4;break}return o.abrupt("return",!!webapis.tvinfo.getMenuValue(webapis.tvinfo.TvInfoMenuKey.VOICE_GUIDE_KEY));case 4:return o.abrupt("return",!1);case 5:case"end":return o.stop()}}),_callee3)})))}},{key:"dismissLoadingScreen",value:function dismissLoadingScreen(){var o;null===(o=this.logger)||void 0===o||o.info("Dismiss loading screen event fallback")}},{key:"getHDMIConnectedStatus",value:function getHDMIConnectedStatus(){return __awaiter$e(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!0);case 1:case"end":return o.stop()}}),_callee4)})))}},{key:"errorMetricsHandler",value:function errorMetricsHandler(o,s,m,_){var S,E={message:o,visible:s,code:m,args:_};null===(S=this.logger)||void 0===S||S.info("errorMetricsHandler event fallback ".concat(JSON.stringify(E,null,2)))}},{key:"setMute",value:function setMute(o){tizen.tvaudiocontrol.setMute(o)}},{key:"mute",value:function mute(){return __awaiter$e(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,this.setMute(!0);case 3:return o.abrupt("return",!0);case 6:return o.prev=6,o.t0=o.catch(0),o.abrupt("return",!1);case 9:case"end":return o.stop()}}),_callee5,this,[[0,6]])})))}},{key:"unmute",value:function unmute(){return __awaiter$e(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,this.setMute(!1);case 3:return o.abrupt("return",!0);case 6:return o.prev=6,o.t0=o.catch(0),o.abrupt("return",!1);case 9:case"end":return o.stop()}}),_callee6,this,[[0,6]])})))}},{key:"_updateDeviceInfo",value:function _updateDeviceInfo(){webapis.productinfo&&(this._deviceId=webapis.productinfo.getDuid(),this._model=webapis.productinfo.getRealModel(),this._modelCode=webapis.productinfo.getModelCode(),this._osVersion=webapis.productinfo.getFirmware())}},{key:"_updateAdInfo",value:function _updateAdInfo(){webapis.adinfo&&(this._advertisingId=webapis.adinfo.getTIFA(),this._limitAdTracking=webapis.adinfo.isLATEnabled())}},{key:"keyMapping",get:function get(){return{10009:"Back",415:"MediaPlayPause",19:"MediaPlayPause",417:"MediaFastForward",412:"MediaRewind"}}},{key:"deviceType",get:function get(){return"tizen"}},{key:"deviceCategory",get:function get(){return this.deviceType}},{key:"osName",get:function get(){return"Tizen"}},{key:"brand",get:function get(){return"Samsung"}},{key:"manufacturer",get:function get(){return"Samsung"}},{key:"supportsTTS",get:function get(){return!0}},{key:"supportsCCNativeListener",get:function get(){return!0}},{key:"model",get:function get(){return this._model}},{key:"modelCode",get:function get(){return this._modelCode}},{key:"osVersion",get:function get(){return this._osVersion}},{key:"limitAdTracking",get:function get(){return this._limitAdTracking}},{key:"networkType",get:function get(){if(!webapis.network)return"";switch(webapis.network.getActiveConnectionType()){case webapis.network.NetworkActiveConnectionType.ETHERNET:return"WiredConnection";case webapis.network.NetworkActiveConnectionType.WIFI:return"WifiConnection";default:return"Disconnected"}}},{key:"bitrateRange",get:function get(){return this.modelYear&&this.modelYear<=2018?{min:-1,max:4e6}:this.defaultBitrateRange}},{key:"modelYear",get:function get(){return{J:2015,K:2016,M:2017,N:2018,R:2019,T:2020}[this.modelIdentifier]||null}},{key:"modelIdentifier",get:function get(){var o=this.model.match(/\d+([A-Z])/);return o?o[1]:""}}]),Tizen}(AS),__awaiter$d=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},ZC=function(o){_inherits$1(Android,o);var s=_createSuper$1(Android);function Android(){var o;return _classCallCheck$1(this,Android),(o=s.apply(this,arguments))._model="",o._manufacturer="",o._osVersion="",o._modelCode="",o._networkType="",o._limitAdTracking=!1,o._ttsEnabled=!1,o._feedbackEmail="tvapp.support@nbcnews.com",o}return _createClass$1(Android,[{key:"init",value:function init(){var o=this,s=Object.create(null,{init:{get:function get(){return _get$1(_getPrototypeOf$1(Android.prototype),"init",o)}}});return __awaiter$d(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,s.init.call(this);case 2:window.addEventListener("keydown",(function(o){0===o.keyCode&&o.stopImmediatePropagation()}),!0),this._updateDeviceInfo(),this._updateAdInfo(),this._checkTTSStatus();case 6:case"end":return o.stop()}}),_callee,this)})))}},{key:"_updateAdInfo",value:function _updateAdInfo(){if("function"==typeof AndroidJsInterface.getAdInfo){var o=JSON.parse(AndroidJsInterface.getAdInfo());this._advertisingId=o.adId,this._limitAdTracking=o.limitAdTracking,this._deviceId=o.adId}}},{key:"getHDMIConnectedStatus",value:function getHDMIConnectedStatus(){return __awaiter$d(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:if("function"!=typeof AndroidJsInterface.getHDMIPluggedIn){o.next=4;break}return o.abrupt("return",AndroidJsInterface.getHDMIPluggedIn());case 4:return o.abrupt("return",!0);case 5:case"end":return o.stop()}}),_callee2)})))}},{key:"mute",value:function mute(){return new Promise((function(o){o(!1)}))}},{key:"unmute",value:function unmute(){return new Promise((function(o){o(!1)}))}},{key:"shutdown",value:function shutdown(){"function"==typeof AndroidJsInterface.shutdown&&AndroidJsInterface.shutdown()}},{key:"dismissLoadingScreen",value:function dismissLoadingScreen(){"function"==typeof AndroidJsInterface.dismissSplash&&AndroidJsInterface.dismissSplash()}},{key:"announce",value:function announce(o,s){var m;if(this._ttsEnabled&&"function"==typeof AndroidJsInterface.announce)if(null===(m=this.logger)||void 0===m||m.info("Announce: ".concat(o)),"string"==typeof o)AndroidJsInterface.announce(o,s);else if(Array.isArray(o)){var _=o.join(",");AndroidJsInterface.announce(_,s)}}},{key:"getCloseCaptioningEnabled",value:function getCloseCaptioningEnabled(){return __awaiter$d(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:if("function"!=typeof AndroidJsInterface.getCaptionsEnabled){o.next=2;break}return o.abrupt("return",AndroidJsInterface.getCaptionsEnabled());case 2:return o.abrupt("return",!1);case 3:case"end":return o.stop()}}),_callee3)})))}},{key:"getTTSStatus",value:function getTTSStatus(){return __awaiter$d(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:if("function"!=typeof AndroidJsInterface.getTTSStatus){o.next=2;break}return o.abrupt("return",AndroidJsInterface.getTTSStatus());case 2:return o.abrupt("return",!1);case 3:case"end":return o.stop()}}),_callee4)})))}},{key:"getCaptionStyle",value:function getCaptionStyle(){var o=_get$1(_getPrototypeOf$1(Android.prototype),"getCaptionStyle",this).call(this);if("function"==typeof AndroidJsInterface.getCaptionsStyle){var s=JSON.parse(AndroidJsInterface.getCaptionsStyle());o.scaling=s.fontScale,o.windowColor=parseInt(s.windowColor,16),o.textStyle.fontSize=50*s.fontScale,o.textStyle.fontStyle=s.fontStyle,o.textStyle.textColor=parseInt(s.textColor,16),o.textStyle.highlightColor=parseInt(s.backgroundColor,16)}return o}},{key:"errorMetricsHandler",value:function errorMetricsHandler(o,s,m){var _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};"function"==typeof AndroidJsInterface.errorMetricsHandler&&AndroidJsInterface.errorMetricsHandler(o,s,m,JSON.stringify(_))}},{key:"deviceType",get:function get(){return"androidtv"}},{key:"keyMapping",get:function get(){return{8:"Back",179:"MediaPlayPause",228:"MediaFastForward",227:"MediaRewind"}}},{key:"_updateDeviceInfo",value:function _updateDeviceInfo(){if("function"==typeof AndroidJsInterface.getDeviceInfo){var o=JSON.parse(AndroidJsInterface.getDeviceInfo());this._model=o.model,this._manufacturer=o.manufacturer,this._osVersion=o.osVersion,this._modelCode=o.device,this._networkType=o.networkType}}},{key:"osName",get:function get(){return"Android"}},{key:"supportsTTS",get:function get(){return!0}},{key:"supportsCCNativeListener",get:function get(){return!1}},{key:"model",get:function get(){return this._model}},{key:"modelCode",get:function get(){return this._modelCode}},{key:"manufacturer",get:function get(){return this._manufacturer}},{key:"osVersion",get:function get(){return this._osVersion}},{key:"networkType",get:function get(){return this._networkType}},{key:"limitAdTracking",get:function get(){return this._limitAdTracking}},{key:"deviceCategory",get:function get(){return this.deviceType}},{key:"bitrateRange",get:function get(){var o=parseInt(this.osVersion);return isNaN(o)?this.defaultBitrateRange:o<10?{min:1e6,max:3e6}:this.defaultBitrateRange}}]),Android}(AS),tw=function(o){_inherits$1(FireTV,o);var s=_createSuper$1(FireTV);function FireTV(){return _classCallCheck$1(this,FireTV),s.apply(this,arguments)}return _createClass$1(FireTV,[{key:"deviceType",get:function get(){return"firetv"}},{key:"bitrateRange",get:function get(){return"AFTT"===this.model?{min:-1,max:2e6}:this.defaultBitrateRange}},{key:"mute",value:function mute(){return new Promise((function(o){o(!1)}))}},{key:"unmute",value:function unmute(){return new Promise((function(o){o(!1)}))}}]),FireTV}(ZC),__awaiter$c=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},rw=function(o){_inherits$1(WebOS,o);var s=_createSuper$1(WebOS);function WebOS(){var o;return _classCallCheck$1(this,WebOS),(o=s.apply(this,arguments)).enablePointer=!0,o._model="",o._osVersion="",o._networkType="",o}return _createClass$1(WebOS,[{key:"init",value:function init(){var o,s=this,m=Object.create(null,{init:{get:function get(){return _get$1(_getPrototypeOf$1(WebOS.prototype),"init",s)}}});return __awaiter$c(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,m.init.call(this);case 2:return s.prev=2,s.next=5,Promise.all([this._injectScript("./static/webOSTV.js"),this._injectScript("./static/webOSTV-dev.js")]);case 5:s.next=11;break;case 7:return s.prev=7,s.t0=s.catch(2),null===(o=this.logger)||void 0===o||o.error("webOS Platform intialization failed: ".concat(s.t0)),s.abrupt("return");case 11:return s.next=13,Promise.all([this._getDeviceInfo(),this._getDeviceId(),this._addTTSChangeNativeListener(),this._addCaptionChangeNativeListener(),this._addNetworkStatusChangeNativeListener()]);case 13:case"end":return s.stop()}}),_callee,this,[[2,7]])})))}},{key:"shutdown",value:function shutdown(){window.close(),webOS.service.request("luna://com.webos.applicationManager",{method:"launch",parameters:{id:"com.webos.app.livetv"},onFailure:this._webOSApiError})}},{key:"getCloseCaptioningEnabled",value:function getCloseCaptioningEnabled(){return __awaiter$c(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!!this._ccEnabled);case 1:case"end":return o.stop()}}),_callee2,this)})))}},{key:"dismissLoadingScreen",value:function dismissLoadingScreen(){var o;null===(o=this.logger)||void 0===o||o.info("Dismiss loading screen event fallback")}},{key:"updateIsPlaying",value:function updateIsPlaying(o){var s;null===(s=this.logger)||void 0===s||s.info("Plaform | Update Is Playing status: ".concat(o))}},{key:"showToaster",value:function showToaster(o){var s;null===(s=this.logger)||void 0===s||s.info("Showing Toaster fallback, with message: ".concat(o))}},{key:"getHDMIConnectedStatus",value:function getHDMIConnectedStatus(){return __awaiter$c(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!0);case 1:case"end":return o.stop()}}),_callee3)})))}},{key:"getTTSStatus",value:function getTTSStatus(){return __awaiter$c(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!!this._ttsEnabled);case 1:case"end":return o.stop()}}),_callee4,this)})))}},{key:"errorMetricsHandler",value:function errorMetricsHandler(o,s,m,_){var S;null===(S=this.logger)||void 0===S||S.info(JSON.stringify({message:"errorMetricsHandler event fallback",error:{message:o,visible:s,code:m,args:_}},null,2))}},{key:"setMute",value:function setMute(o){return new Promise((function(s,m){webOS.service.request("luna://com.webos.audio",{method:"setMuted",parameters:{muted:o},onSuccess:function onSuccess(o){console.log(o),s()},onFailure:function onFailure(o){console.log(o),m()}})}))}},{key:"mute",value:function mute(){return __awaiter$c(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,this.setMute(!0);case 3:return o.abrupt("return",!0);case 6:return o.prev=6,o.t0=o.catch(0),o.abrupt("return",!1);case 9:case"end":return o.stop()}}),_callee5,this,[[0,6]])})))}},{key:"unmute",value:function unmute(){return __awaiter$c(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,this.setMute(!1);case 3:return o.abrupt("return",!0);case 6:return o.prev=6,o.t0=o.catch(0),o.abrupt("return",!1);case 9:case"end":return o.stop()}}),_callee6,this,[[0,6]])})))}},{key:"keyMapping",get:function get(){return{461:"Back",415:"MediaPlay",19:"MediaPause",417:"MediaFastForward",412:"MediaRewind"}}},{key:"deviceType",get:function get(){return"webos"}},{key:"deviceCategory",get:function get(){return this.deviceType}},{key:"model",get:function get(){return this._model}},{key:"manufacturer",get:function get(){return"LG"}},{key:"modelCode",get:function get(){return this._model}},{key:"osName",get:function get(){return"webOS"}},{key:"osVersion",get:function get(){return this._osVersion}},{key:"brand",get:function get(){return"LG"}},{key:"supportsTTS",get:function get(){return!0}},{key:"supportsCCNativeListener",get:function get(){return!0}},{key:"networkType",get:function get(){return this._networkType}},{key:"limitAdTracking",get:function get(){return!1}},{key:"_getDeviceInfo",value:function _getDeviceInfo(){var o=this;return new Promise((function(s){webOS.deviceInfo((function(m){o._model=m.modelName,o._osVersion=m.version,s()}))}))}},{key:"_getDeviceId",value:function _getDeviceId(){var o=this;return new Promise((function(s,m){webOS.service.request("luna://com.webos.service.sm",{method:"deviceid/getIDs",parameters:{idType:["LGUDID"]},onSuccess:function onSuccess(_){var S=_.idList;if(S&&S.length){var E=S[0].idValue;o._deviceId=E,o._advertisingId=E,s()}else m()},onFailure:function onFailure(s){o._webOSApiError(s),m()}})}))}},{key:"_addTTSChangeNativeListener",value:function _addTTSChangeNativeListener(){var o=this;return new Promise((function(s){webOS.service.request("luna://com.webos.settingsservice",{method:"getSystemSettings",parameters:{category:"option",key:"audioGuidance",subscribe:!0},subscribe:!0,resubscribe:!0,onSuccess:function onSuccess(m){var _=!!m.settings.audioGuidance&&"on"===m.settings.audioGuidance;_!==o._ttsEnabled&&(o._ttsEnabled=_),s()},onFailure:function onFailure(m){o._webOSApiError(m),s()}})}))}},{key:"_addCaptionChangeNativeListener",value:function _addCaptionChangeNativeListener(){var o=this;return new Promise((function(s){webOS.service.request("luna://com.webos.settingsservice",{method:"getSystemSettings",parameters:{category:"caption",key:"captionEnable",subscribe:!0},subscribe:!0,resubscribe:!0,onSuccess:function onSuccess(m){var _="on"===m.settings.captionEnable;_!==o._ccEnabled&&(o._ccEnabled=_),s()},onFailure:function onFailure(m){o._webOSApiError(m),s()}})}))}},{key:"_addNetworkStatusChangeNativeListener",value:function _addNetworkStatusChangeNativeListener(){var o=this;return new Promise((function(s){webOS.service.request("luna://com.palm.connectionmanager",{method:"getStatus",parameters:{subscribe:!0},subscribe:!0,resubscribe:!0,onSuccess:function onSuccess(m){var _=!0;m.isInternetConnectionAvailable?"connected"===m.wired.state?o._networkType="ETHERNET":"connected"===m.wifi.state&&(o._networkType="WIFI"):(o._networkType="DISCONNECTED",_=!1),o._checkNetworkStatus(_),s()},onFailure:function onFailure(m){o._webOSApiError(m),s()}})}))}},{key:"_webOSApiError",value:function _webOSApiError(o){var s,m=o.errorCode,_=o.errorText;null===(s=this.logger)||void 0===s||s.warn("WebOS API Error: ".concat(m," - ").concat(_))}}]),WebOS}(AS),__awaiter$b=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},ow=_createClass$1((function VizioCompanionInfoStatic(){_classCallCheck$1(this,VizioCompanionInfoStatic),this.deviceHDRCapabilities=[],this.deviceId="",this.deviceModel="",this.devicePlaybackQualities=[],this.firmwareVersion=""})),sw=_createClass$1((function VizioCompanioninfoDynamic(){_classCallCheck$1(this,VizioCompanioninfoDynamic),this.advertiserID={IFA:"",IFA_TYPE:"",LMT:!1},this.isCCEnabled=!1,this.isTTSEnabled=!1,this.isNetworkConnected=!1}));!function(o){o.VIZIO_LIBRARY_DID_LOAD="VIZIO_LIBRARY_DID_LOAD",o.VIZIO_TTS_ENABLED="VIZIO_TTS_ENABLED",o.VIZIO_TTS_DISABLED="VIZIO_TTS_DISABLED"}(WC||(WC={})),function(o){o.offline="offline",o.online="online"}(GC||(GC={}));var pw=function(o){_inherits$1(Vizio,o);var s=_createSuper$1(Vizio);function Vizio(){var o;return _classCallCheck$1(this,Vizio),(o=s.apply(this,arguments))._companionInfoStatic=new ow,o._companionInfoDynamic=new sw,o}return _createClass$1(Vizio,[{key:"_updateNetworkStatus",value:function _updateNetworkStatus(){this._checkNetworkStatus(this._companionInfoDynamic.isNetworkConnected)}},{key:"_setupWindowListeners",value:function _setupWindowListeners(){var o=this;this._companionInfoDynamic.isNetworkConnected=navigator.onLine,this._updateNetworkStatus(),window.addEventListener(GC.offline,(function(){o._companionInfoDynamic.isNetworkConnected=!1,o._updateNetworkStatus()})),window.addEventListener(GC.online,(function(){o._companionInfoDynamic.isNetworkConnected=!0,o._updateNetworkStatus()}))}},{key:"_setupDocumentListeners",value:function _setupDocumentListeners(){var o=this;document.addEventListener(WC.VIZIO_TTS_DISABLED,(function(){o._companionInfoDynamic.isTTSEnabled=!1,o._checkTTSStatus()})),document.addEventListener(WC.VIZIO_TTS_ENABLED,(function(){o._companionInfoDynamic.isTTSEnabled=!0,o._checkTTSStatus()}))}},{key:"_setupVizioListeners",value:function _setupVizioListeners(){var o=this;window.VIZIO.setAdvertiserIDListener((function(s){o._companionInfoDynamic.advertiserID=s})),window.VIZIO.setClosedCaptionHandler((function(s){o._companionInfoDynamic.isCCEnabled=s,o._checkCCStatus()})),window.VIZIO.setDeviceLanguageHandler((function(s){var m;null===(m=o.logger)||void 0===m||m.info("vizio setDeviceLanguageHandler:"+s)}))}},{key:"announce",value:function announce(o){var s,m=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.ttsEnabled&&(m&&(null===(s=this.logger)||void 0===s||s.info("Vizio: TTS append is not supported; canceling current TTS"),window.VIZIO.Chromevox.cancel()),window.VIZIO.Chromevox.play(o.toString()))}},{key:"_collectDeviceInfo",value:function _collectDeviceInfo(){return __awaiter$b(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o,s=this;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return o=[new Promise((function(o){window.VIZIO.getDeviceId((function(m){s._companionInfoStatic.deviceId=m,o()}))})),new Promise((function(o){window.VIZIO.getFirmwareVersion((function(m){s._companionInfoStatic.firmwareVersion=m,o()}))})),new Promise((function(o){window.VIZIO.getDeviceHDRCapabilities((function(m){s._companionInfoStatic.deviceHDRCapabilities=m,o()}))})),new Promise((function(o){window.VIZIO.getDevicePlaybackQualities((function(m){s._companionInfoStatic.devicePlaybackQualities=m,o()}))}))],m.next=3,Promise.all(o);case 3:this._companionInfoStatic.deviceModel=window.VIZIO.deviceModel;case 4:case"end":return m.stop()}}),_callee,this)})))}},{key:"init",value:function init(){var o,s=this,m=Object.create(null,{init:{get:function get(){return _get$1(_getPrototypeOf$1(Vizio.prototype),"init",s)}}});return __awaiter$b(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){var s=this;return _regeneratorRuntime$1().wrap((function _callee3$(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,m.init.call(this);case 2:return _.prev=2,this._setupDocumentListeners(),this._setupWindowListeners(),document.addEventListener("VIZIO_LIBRARY_DID_LOAD",(function(){return __awaiter$b(s,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this._collectDeviceInfo();case 2:this._setupVizioListeners();case 3:case"end":return o.stop()}}),_callee2,this)})))})),_.next=8,this._injectScript("http://localhost:12345/scfs/cl/js/vizio-companion-lib.js");case 8:_.next=14;break;case 10:return _.prev=10,_.t0=_.catch(2),null===(o=this.logger)||void 0===o||o.error("Vizio Platform intialization failed: "+_.t0),_.abrupt("return");case 14:return _.abrupt("return");case 15:case"end":return _.stop()}}),_callee3,this,[[2,10]])})))}},{key:"ttsEnabled",get:function get(){return this._companionInfoDynamic.isTTSEnabled}},{key:"keyMapping",get:function get(){return{37:"Left",39:"Right",38:"Up",40:"Down",8:"Back",19:"MediaPlayPause",413:"MediaPlayPause",415:"MediaPlayPause",417:"MediaFastForward",412:"MediaRewind",418:"MediaTrackNext",419:"MediaTrackPrevious",27:"Exit"}}},{key:"deviceType",get:function get(){return"vizio"}},{key:"deviceCategory",get:function get(){return this.deviceType}},{key:"model",get:function get(){return this._companionInfoStatic.deviceModel}},{key:"manufacturer",get:function get(){return"Vizio"}},{key:"modelCode",get:function get(){return this.model}},{key:"osName",get:function get(){return"SmartCast"}},{key:"osVersion",get:function get(){return this._companionInfoStatic.firmwareVersion}},{key:"deviceId",get:function get(){return this._companionInfoStatic.deviceId}},{key:"brand",get:function get(){return"Vizio"}},{key:"networkType",get:function get(){return"wifi"}},{key:"limitAdTracking",get:function get(){return!1}},{key:"supportsTTS",get:function get(){return!0}},{key:"supportsCCNativeListener",get:function get(){return!0}},{key:"shutdown",value:function shutdown(){window.VIZIO.exitApplication()}},{key:"getHDMIConnectedStatus",value:function getHDMIConnectedStatus(){return __awaiter$b(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!0);case 1:case"end":return o.stop()}}),_callee4)})))}},{key:"getCloseCaptioningEnabled",value:function getCloseCaptioningEnabled(){return __awaiter$b(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this._companionInfoDynamic.isCCEnabled);case 1:case"end":return o.stop()}}),_callee5,this)})))}},{key:"getTTSStatus",value:function getTTSStatus(){return __awaiter$b(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this._companionInfoDynamic.isTTSEnabled);case 1:case"end":return o.stop()}}),_callee6,this)})))}},{key:"dismissLoadingScreen",value:function dismissLoadingScreen(){var o;null===(o=this.logger)||void 0===o||o.info("Dismiss loading screen event fallback")}},{key:"showToaster",value:function showToaster(o){var s;null===(s=this.logger)||void 0===s||s.info(JSON.stringify({message:"Showing Toaster fallback, with message: ",messageIdentifier:o},null,2))}},{key:"errorMetricsHandler",value:function errorMetricsHandler(o,s,m){var _,S=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};null===(_=this.logger)||void 0===_||_.info(JSON.stringify({message:"errorMetricsHandler event fallback",data:{message:o,visible:s,code:m,args:S}},null,2))}},{key:"mute",value:function mute(){return __awaiter$b(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee7(){return _regeneratorRuntime$1().wrap((function _callee7$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!1);case 1:case"end":return o.stop()}}),_callee7)})))}},{key:"unmute",value:function unmute(){return __awaiter$b(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee8(){return _regeneratorRuntime$1().wrap((function _callee8$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!1);case 1:case"end":return o.stop()}}),_callee8)})))}}]),Vizio}(AS),__awaiter$a=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},_w=function(o){_inherits$1(Run3TV,o);var s=_createSuper$1(Run3TV);function Run3TV(){var o;return _classCallCheck$1(this,Run3TV),(o=s.apply(this,arguments))._model="",o._manufacturer="",o._osName="",o._osVersion="",o}return _createClass$1(Run3TV,[{key:"_collectDeviceInfo",value:function _collectDeviceInfo(){return __awaiter$a(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o,s=this;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return o=[new Promise((function(o){window.fmw.getDevice((function(m){s._model=m.deviceModel,s._manufacturer=m.deviceMake,o()}))})),new Promise((function(o){window.fmw.package((function(m){s._osName=m.name,s._osVersion=m.version,o()}))}))],m.next=3,Promise.all(o);case 3:case"end":return m.stop()}}),_callee)})))}},{key:"init",value:function init(){var o,s=this,m=Object.create(null,{init:{get:function get(){return _get$1(_getPrototypeOf$1(Run3TV.prototype),"init",s)}}});return __awaiter$a(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,window.fmw.isLoaded(),s.next=4,m.init.call(this);case 4:return s.next=6,this._collectDeviceInfo();case 6:s.next=11;break;case 8:s.prev=8,s.t0=s.catch(0),null===(o=this.logger)||void 0===o||o.error("Run3TV | API was not detected.");case 11:case"end":return s.stop()}}),_callee2,this,[[0,8]])})))}},{key:"keyMapping",get:function get(){return{461:"Back",27:"Exit"}}},{key:"deviceType",get:function get(){return"nextgen"}},{key:"deviceCategory",get:function get(){return this.deviceType}},{key:"model",get:function get(){return this._model}},{key:"manufacturer",get:function get(){return this._manufacturer}},{key:"modelCode",get:function get(){return this.model}},{key:"osName",get:function get(){return this._osName}},{key:"osVersion",get:function get(){return this._osVersion}},{key:"networkType",get:function get(){return"wifi"}},{key:"limitAdTracking",get:function get(){return!1}},{key:"supportsTTS",get:function get(){return!1}},{key:"supportsCCNativeListener",get:function get(){return!0}},{key:"shutdown",value:function shutdown(){window.fmw.navQuit()}},{key:"getHDMIConnectedStatus",value:function getHDMIConnectedStatus(){return __awaiter$a(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!0);case 1:case"end":return o.stop()}}),_callee3)})))}},{key:"getCloseCaptioningEnabled",value:function getCloseCaptioningEnabled(){return __awaiter$a(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!0);case 1:case"end":return o.stop()}}),_callee4)})))}},{key:"getTTSStatus",value:function getTTSStatus(){return __awaiter$a(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!1);case 1:case"end":return o.stop()}}),_callee5)})))}},{key:"dismissLoadingScreen",value:function dismissLoadingScreen(){}},{key:"showToaster",value:function showToaster(o){window.fmw.notify.send(Object.assign({display:"pop-up"},o))}},{key:"errorMetricsHandler",value:function errorMetricsHandler(){}},{key:"reportException",value:function reportException(o,s,m){var _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return __awaiter$a(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",new Promise((function(S,E){var A=Object.keys(_).length>0?"".concat(m,", ").concat(JSON.stringify(_)):m;window.fmw.iot.exception({offsetS:o,location:s,message:A},(function(o){0===o?E():S()}))})));case 1:case"end":return S.stop()}}),_callee6)})))}},{key:"mute",value:function mute(){return __awaiter$a(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee7(){return _regeneratorRuntime$1().wrap((function _callee7$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!1);case 1:case"end":return o.stop()}}),_callee7)})))}},{key:"unmute",value:function unmute(){return __awaiter$a(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee8(){return _regeneratorRuntime$1().wrap((function _callee8$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",!1);case 1:case"end":return o.stop()}}),_callee8)})))}}]),Run3TV}(AS),Lw=function(){function PAL(){_classCallCheck$1(this,PAL)}return _createClass$1(PAL,null,[{key:"getPlatform",value:function getPlatform(){if(null!==PAL.platform)return PAL.platform;var o=null,s=navigator.userAgent;return s&&(s.search(/WPE/)>-1?o=new YC:s.search(/AmazonPlatform/)>-1?o=new tw:s.search(/Android/)>-1?o=new ZC:s.search(/Tizen/)>-1?o=new JC:s.search(/Web0S/)>-1?o=new rw:s.search(/VIZIO/)>-1?o=new pw:location.href.search(/baseURI/)>-1&&location.href.search(/dateRND/)>-1&&location.href.search(/appName/)>-1&&(o=new _w)),null===o&&(o=new QC),PAL.platform=o,PAL.platform}}]),PAL}();Lw.platform=null;var qw=Lw.getPlatform(),yx=function(o){_inherits$1(SplashPresenter,o);var s=_createSuper$1(SplashPresenter);function SplashPresenter(){var o;_classCallCheck$1(this,SplashPresenter);var m=a_.resolveType(a_.dependencyKeys.Store);return(o=s.call(this,m)).onBooting=function(s){var m,_=null!==(m=s.newValue)&&void 0!==m&&m;o.onPropertyChanged("isBooting",!1,_),qw.dismissLoadingScreen()},o.store.propertyChanged.appIsBooting.addListener(o.onBooting),o}return _createClass$1(SplashPresenter,[{key:"initAsync",value:function initAsync(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return");case 1:case"end":return o.stop()}}),_callee)})))}}]),SplashPresenter}(r_),_x=function(o){_inherits$1(SpinnerPresenter,o);var s=_createSuper$1(SpinnerPresenter);function SpinnerPresenter(){var o;_classCallCheck$1(this,SpinnerPresenter);var m=a_.resolveType(a_.dependencyKeys.Store);return(o=s.call(this,m)).isLoading=function(s){var m,_=null!==(m=s.newValue)&&void 0!==m&&m;o.onPropertyChanged("isLoading",!1,_)},o.store.propertyChanged.appIsLoading.addListener(o.isLoading),o}return _createClass$1(SpinnerPresenter,[{key:"initAsync",value:function initAsync(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return");case 1:case"end":return o.stop()}}),_callee)})))}},{key:"appLoading",get:function get(){return this.store.getByProperty("appIsLoading")}}]),SpinnerPresenter}(r_),xx=function(o){_inherits$1(PlayersDemoPresenter,o);var s=_createSuper$1(PlayersDemoPresenter);function PlayersDemoPresenter(){var o;_classCallCheck$1(this,PlayersDemoPresenter);var m=a_.resolveType(a_.dependencyKeys.Store);return(o=s.call(this,m)).api=a_.resolveType(a_.dependencyKeys.API),o.playersData=[{title:"HLS JS",player:"hls"},{title:"Shaka",player:"shaka"},{title:"AAMP",player:"aamp"},{title:"AVPlay",player:"avplay"},{title:"IVSPlayer",player:"ivsplayer"},{title:"VideoJS",player:"videojsplayer"}],o.sourcesData=[{title:"HLS (VOD)",params:{format:"hls",type:"VOD",id:"1",tags:[]}},{title:"HLS (Linear)",params:{format:"hls",type:"LiveVideo",id:"2",tags:[]}},{title:"HLS CC(Linear)",params:{format:"hls",type:"LiveVideo",id:"3",tags:["cc"]}},{title:"MP4 (VOD)",params:{format:"mp4",type:"VOD",id:"4",tags:[]}},{title:"DASH (VOD)",params:{format:"dash",type:"VOD",id:"5",tags:[]}},{title:"DASH (Linear)",params:{format:"dash",type:"LiveVideo",id:"6",tags:[]}},{title:"IVS Broadcast",params:{format:"hls",type:"LiveVideo",id:"7",tags:["ivs","broadcast"]}},{title:"IVS with Ads",params:{format:"hls",type:"LiveVideo",id:"8",tags:["ivs","mediatailor","ads"]}}],o.onFullScreenEnabled=function(s){if("playerDemo"===s.newValue.page){var m=s.newValue.isVisible;o.onPropertyChanged("isFullScreenEnabled",!1,m)}},o.store.propertyChanged.fullScreenEnabled.addListener(o.onFullScreenEnabled),o}return _createClass$1(PlayersDemoPresenter,[{key:"initAsync",value:function initAsync(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return this.assetData=this.api.fetchAsset(),o.abrupt("return");case 2:case"end":return o.stop()}}),_callee,this)})))}},{key:"getAssetURL",value:function getAssetURL(o){if(this.assetData){var s=this.assetData[o.type],m=this.appendTagProperty(s);if(s){var _=m.filter((function(s){return s.format===o.format})),S=this.filterAssets(o,_);if(S){var E=S.url;return Object.assign(Object.assign({},S),{formattedUrl:this.formatUrl(E)||E,type:o.type})}}}}},{key:"getAssetByID",value:function getAssetByID(o){var s,m=this;if(this.assetData)return Object.keys(this.assetData).forEach((function(_){if(m.assetData){var S=_,E=m.assetData[S].find((function(s){return s.id===o}));E&&(s=Object.assign(Object.assign({},E),{formattedUrl:m.formatUrl(E.url)||E.url,type:_}))}})),s}},{key:"appendTagProperty",value:function appendTagProperty(o){return o.map((function(o){var s=Object.keys(o),m=s.findIndex((function(o){return"url"===o}));s.splice(m,1);var _=s.findIndex((function(o){return"format"===o}));s.splice(_,1);var S=s.findIndex((function(o){return"id"===o}));return s.splice(S,1),Object.assign(Object.assign({},o),{tags:s})}))}},{key:"filterAssets",value:function filterAssets(o,s){var m=o.tags;return s.find((function(o){var s,_;return _=m.length>0?m.reduce((function(s,m){var _,S=!!o[m]||(null===(_=o.ivs)||void 0===_?void 0:_.source)===m;return s&&S}),!0):0===(null===(s=o.tags)||void 0===s?void 0:s.length),_}))}},{key:"formatUrl",value:function formatUrl(o){if(!o)return"";var s=o.match(/^(https?:\/\/|http?:\/\/)/g);if(!s)return o;var m=o.replace(s[0],"").replace(/([/])/g,"/ ");return"".concat(s).concat(m)}},{key:"playersButtonsData",get:function get(){return this.playersData}},{key:"sourcesButtonsData",get:function get(){return this.sourcesData}}]),PlayersDemoPresenter}(r_);var Ex=function(){function Config(){_classCallCheck$1(this,Config)}return _createClass$1(Config,[{key:"filterOutNonSupportedKeys",value:function filterOutNonSupportedKeys(o,s){var m=Object.create({});return function isObject$2(o){return!("object"!=typeof o||o instanceof Array)}(o)?(Object.keys(o).forEach((function(_){s.indexOf(_)>=0?m[_]=o[_]:console.warn("Warning - unsupported key provided to configuration: ",_)})),m):Object.create({})}}]),Config}(),Ax=["cname","secureDistribution","privateCdn","signUrl","longUrlSignature","shorten","useRootPath","secure","forceVersion","analytics"],Px=function(o){_inherits$1(URLConfig,o);var s=_createSuper$1(URLConfig);function URLConfig(o){var m;_classCallCheck$1(this,URLConfig);var _=(m=s.call(this)).filterOutNonSupportedKeys(o,Ax);return Object.assign(_assertThisInitialized(m),{secure:!0},_),m}return _createClass$1(URLConfig,[{key:"extend",value:function extend(o){var s=this.filterOutNonSupportedKeys(o,Ax);return new URLConfig(Object.assign({},this,s))}},{key:"setCname",value:function setCname(o){return this.cname=o,this}},{key:"setSecureDistribution",value:function setSecureDistribution(o){return this.secureDistribution=o,this}},{key:"setPrivateCdn",value:function setPrivateCdn(o){return this.privateCdn=o,this}},{key:"setSignUrl",value:function setSignUrl(o){return this.signUrl=o,this}},{key:"setLongUrlSignature",value:function setLongUrlSignature(o){return this.longUrlSignature=o,this}},{key:"setShorten",value:function setShorten(o){return this.shorten=o,this}},{key:"setUseRootPath",value:function setUseRootPath(o){return this.useRootPath=o,this}},{key:"setSecure",value:function setSecure(o){return this.secure=o,this}},{key:"setForceVersion",value:function setForceVersion(o){return this.forceVersion=o,this}}]),URLConfig}(Ex),Dx=function(){function QualifierValue(o){_classCallCheck$1(this,QualifierValue),this.values=[],this.delimiter=":",this.hasValue(o)&&this.addValue(o)}return _createClass$1(QualifierValue,[{key:"toString",value:function toString(){return this.values.join(this.delimiter)}},{key:"hasValue",value:function hasValue(o){return null!=o&&""!==o}},{key:"addValue",value:function addValue(o){var s=this;return Array.isArray(o)?this.values=this.values.concat(o):this.values.push(o),this.values=this.values.filter((function(o){return s.hasValue(o)})),this}},{key:"setDelimiter",value:function setDelimiter(o){return this.delimiter=o,this}}]),QualifierValue}(),Ox=function(o){_inherits$1(UnsupportedError,o);var s=_createSuper$1(UnsupportedError);function UnsupportedError(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unsupported";return _classCallCheck$1(this,UnsupportedError),s.call(this,o)}return _createClass$1(UnsupportedError)}(_wrapNativeSuper(Error));function createUnsupportedError(o){return new Ox(o)}function qualifierToJson(){return this._qualifierModel||{error:createUnsupportedError("unsupported qualifier ".concat(this.constructor.name))}}var Nx=function(o){_inherits$1(Qualifier,o);var s=_createSuper$1(Qualifier);function Qualifier(o,m){var _;return _classCallCheck$1(this,Qualifier),(_=s.call(this)).delimiter="_",_.key=o,m instanceof Dx?_.qualifierValue=m:(_.qualifierValue=new Dx,_.qualifierValue.addValue(m)),_}return _createClass$1(Qualifier,[{key:"toString",value:function toString(){var o=this.key,s=this.delimiter,m=this.qualifierValue;return"".concat(o).concat(s).concat(m.toString())}},{key:"addValue",value:function addValue(o){return this.qualifierValue.addValue(o),this}}]),Qualifier}(function(){function QualifierModel(){_classCallCheck$1(this,QualifierModel),this._qualifierModel={}}return _createClass$1(QualifierModel,[{key:"toJson",value:function toJson(){return qualifierToJson.apply(this)}}]),QualifierModel}()),Bx=function(o){_inherits$1(FlagQualifier,o);var s=_createSuper$1(FlagQualifier);function FlagQualifier(o,m){var _,S;return _classCallCheck$1(this,FlagQualifier),S=m?new Dx([o,"".concat(m)]).setDelimiter(":"):o,(_=s.call(this,"fl",S)).flagValue=m,_}return _createClass$1(FlagQualifier,[{key:"toString",value:function toString(){return _get$1(_getPrototypeOf$1(FlagQualifier.prototype),"toString",this).call(this).replace(/\./,"%2E")}},{key:"getFlagValue",value:function getFlagValue(){return this.flagValue}}]),FlagQualifier}(Nx);function actionToJson(){return this._actionModel&&Object.keys(this._actionModel).length?this._actionModel:{error:createUnsupportedError("unsupported action ".concat(this.constructor.name))}}var $x=function(o){_inherits$1(Action,o);var s=_createSuper$1(Action);function Action(){var o;return _classCallCheck$1(this,Action),(o=s.apply(this,arguments)).qualifiers=new Map,o.flags=[],o.delimiter=",",o.actionTag="",o}return _createClass$1(Action,[{key:"prepareQualifiers",value:function prepareQualifiers(){}},{key:"getActionTag",value:function getActionTag(){return this.actionTag}},{key:"setActionTag",value:function setActionTag(o){return this.actionTag=o,this}},{key:"toString",value:function toString(){return this.prepareQualifiers(),function mapToSortedArray(o,s){var m=Array.from(o.entries());return s.forEach((function(o){m.push(["fl",o])})),m.sort().map((function(o){return o[1]}))}(this.qualifiers,this.flags).join(this.delimiter)}},{key:"addQualifier",value:function addQualifier(o){if("string"==typeof o){var s=_slicedToArray$1(o.toLowerCase().split("_"),2),m=s[0],_=s[1];"fl"===m?this.flags.push(new Bx(_)):this.qualifiers.set(m,new Nx(m,_))}else this.qualifiers.set(o.key,o);return this}},{key:"addFlag",value:function addFlag(o){return"string"==typeof o?this.flags.push(new Bx(o)):o instanceof Bx&&this.flags.push(o),this}},{key:"addValueToQualifier",value:function addValueToQualifier(o,s){return this.qualifiers.get(o).addValue(s),this}}]),Action}(function(){function ActionModel(){_classCallCheck$1(this,ActionModel),this._actionModel={}}return _createClass$1(ActionModel,[{key:"toJson",value:function toJson(){return actionToJson.apply(this)}}]),ActionModel}()),Vx=function(o){_inherits$1(BackgroundColor,o);var s=_createSuper$1(BackgroundColor);function BackgroundColor(o){var m;return _classCallCheck$1(this,BackgroundColor),(m=s.call(this)).addQualifier(new Nx("b",new Dx(o).setDelimiter("_"))),m}return _createClass$1(BackgroundColor)}($x);var Hx=function(){function RawAction(o){_classCallCheck$1(this,RawAction),this.raw=o}return _createClass$1(RawAction,[{key:"toString",value:function toString(){return this.raw}},{key:"toJson",value:function toJson(){return{error:createUnsupportedError("unsupported action ".concat(this.constructor.name))}}}]),RawAction}();var Wx=function(o){_inherits$1(FormatQualifier,o);var s=_createSuper$1(FormatQualifier);function FormatQualifier(o){var m;return _classCallCheck$1(this,FormatQualifier),(m=s.call(this,o)).val=o,m}return _createClass$1(FormatQualifier,[{key:"getValue",value:function getValue(){return this.val}}]),FormatQualifier}(Dx);function objectFlip(o){var s={};return Object.keys(o).forEach((function(m){s[o[m]]=m})),s}var Yx={limitFit:"limit",limitFill:"lfill",minimumFit:"mfit",thumbnail:"thumb",limitPad:"lpad",minimumPad:"mpad"};objectFlip({444:"CHROMA_444",420:"CHROMA_420"}),objectFlip({noCmyk:"no_cmyk",keepCmyk:"keep_cmyk",tinySrgb:"tinysrgb",srgbTrueColor:"srgb:truecolor"});var Qx=objectFlip(Yx),Zx=objectFlip({colorSpace:"cs",dpr:"dpr",density:"dn",defaultImage:"d",format:"f",quality:"q"});objectFlip({redEye:"redeye",advancedRedEye:"adv_redeye",oilPaint:"oil_paint",unsharpMask:"unsharp_mask",makeTransparent:"make_transparent"}),objectFlip({autoBest:"auto:best",autoEco:"auto:eco",autoGood:"auto:good",autoLow:"auto:low",jpegminiHigh:"jpegmini:1",jpegminiMedium:"jpegmini:2",jpegminiBest:"jpegmini:0"}),objectFlip({fullHd:"full_hd",fullHdWifi:"full_hd_wifi",fullHdLean:"full_hd_lean",hdLean:"hd_lean"});var eE=function(o){_inherits$1(DeliveryAction,o);var s=_createSuper$1(DeliveryAction);function DeliveryAction(o,m,_){var S,E;return _classCallCheck$1(this,DeliveryAction),(S=s.call(this))._actionModel={},E=m instanceof Wx?m.getValue():m,S._actionModel.actionType=Zx[o],S._actionModel[_]=E,S.addQualifier(new Nx(o,m)),S}return _createClass$1(DeliveryAction)}($x),tE=function(o){_inherits$1(ProgressiveQualifier,o);var s=_createSuper$1(ProgressiveQualifier);function ProgressiveQualifier(o){return _classCallCheck$1(this,ProgressiveQualifier),s.call(this,"progressive",o)}return _createClass$1(ProgressiveQualifier)}(Bx),nE=function(o){_inherits$1(DeliveryFormatAction,o);var s=_createSuper$1(DeliveryFormatAction);function DeliveryFormatAction(o,m){return _classCallCheck$1(this,DeliveryFormatAction),s.call(this,o,m,"formatType")}return _createClass$1(DeliveryFormatAction,[{key:"lossy",value:function lossy$1(){return this._actionModel.lossy=!0,this.addFlag(function lossy(){return new Bx("lossy")}()),this}},{key:"progressive",value:function progressive$1(o){return o instanceof tE?(this._actionModel.progressive={mode:o.getFlagValue()},this.addFlag(o)):(this._actionModel.progressive={mode:o},this.addFlag(function progressive(o){return new Bx("progressive",o)}(o))),this}},{key:"preserveTransparency",value:function preserveTransparency$1(){return this._actionModel.preserveTransparency=!0,this.addFlag(function preserveTransparency(){return new Bx("preserve_transparency")}()),this}}],[{key:"fromJson",value:function fromJson(o){var s,m=o.formatType,_=o.lossy,S=o.progressive,E=o.preserveTransparency;return s=m?new this("f",m):new this("f"),S&&(S.mode?s.progressive(S.mode):s.progressive()),_&&s.lossy(),E&&s.preserveTransparency(),s}}]),DeliveryFormatAction}(eE),rE=function(){function Transformation(){_classCallCheck$1(this,Transformation),this.actions=[]}return _createClass$1(Transformation,[{key:"addAction",value:function addAction(o){var s;if("string"==typeof o){if(o.indexOf("/")>=0)throw"addAction cannot accept a string with a forward slash in it - /, use .addTransformation() instead";s=new Hx(o)}else s=o;return this.actions.push(s),this}},{key:"addTransformation",value:function addTransformation(o){return o instanceof Transformation?this.actions=this.actions.concat(o.actions):this.actions.push(new Hx(o)),this}},{key:"toString",value:function toString(){return this.actions.map((function(o){return o.toString()})).filter((function(o){return o})).join("/")}},{key:"animated",value:function animated(o){return this.addAction(o)}},{key:"border",value:function border(o){return this.addAction(o)}},{key:"reshape",value:function reshape(o){return this.addAction(o)}},{key:"resize",value:function resize(o){return this.addAction(o)}},{key:"quality",value:function quality(o){return this.addAction(new nE("q",o)),this}},{key:"format",value:function format(o){return this.addAction(new nE("f",o)),this}},{key:"roundCorners",value:function roundCorners(o){return this.addAction(o)}},{key:"overlay",value:function overlay(o){return this.addAction(o)}},{key:"underlay",value:function underlay(o){return o.setLayerType("u"),this.addAction(o)}},{key:"addVariable",value:function addVariable(o){return this.addAction(o)}},{key:"conditional",value:function conditional(o){return this.addAction(o)}},{key:"effect",value:function effect(o){return this.addAction(o)}},{key:"adjust",value:function adjust(o){return this.addAction(o)}},{key:"rotate",value:function rotate(o){return this.addAction(o)}},{key:"namedTransformation",value:function namedTransformation(o){return this.addAction(o)}},{key:"delivery",value:function delivery(o){return this.addAction(o)}},{key:"backgroundColor",value:function backgroundColor(o){return this.addAction(new Vx(function prepareColor(o){return o&&o.match(/^#/)?"rgb:".concat(o.substr(1)):o}(o)))}},{key:"psdTools",value:function psdTools(o){return this.addAction(o)}},{key:"extract",value:function extract(o){return this.addAction(o)}},{key:"addFlag",value:function addFlag(o){var s=new $x,m=o;return"string"==typeof o&&(m=new Bx(o)),s.addQualifier(m),this.addAction(s)}},{key:"customFunction",value:function customFunction(o){return this.addAction(o)}},{key:"transcode",value:function transcode(o){return this.addAction(o)}},{key:"videoEdit",value:function videoEdit(o){return this.addAction(o)}},{key:"toJson",value:function toJson(){var o,s,m=[],_=_createForOfIteratorHelper(this.actions);try{for(_.s();!(o=_.n()).done;){var S=o.value.toJson();if("error"in(s=S)&&s.error)return S;m.push(S)}}catch(o){_.e(o)}finally{_.f()}return{actions:m}}}]),Transformation}(),iE=function(o){_inherits$1(ImageTransformation,o);var s=_createSuper$1(ImageTransformation);function ImageTransformation(){return _classCallCheck$1(this,ImageTransformation),s.apply(this,arguments)}return _createClass$1(ImageTransformation)}(rE),aE=function(o){_inherits$1(VideoTransformation,o);var s=_createSuper$1(VideoTransformation);function VideoTransformation(){return _classCallCheck$1(this,VideoTransformation),s.apply(this,arguments)}return _createClass$1(VideoTransformation)}(rE),oE={};function toFloatAsString(o){var s=o.toString();return s.match(/[A-Z]/gi)||s.length>1&&"0"===s[0]?s:!isNaN(parseFloat(s))&&-1===s.indexOf(":")&&-1===s.indexOf(".")?"".concat(s,".0"):s}var sE=function(o){_inherits$1(AspectRatioQualifierValue,o);var s=_createSuper$1(AspectRatioQualifierValue);function AspectRatioQualifierValue(){return _classCallCheck$1(this,AspectRatioQualifierValue),s.apply(this,arguments)}return _createClass$1(AspectRatioQualifierValue)}(Dx),uE=function(o){_inherits$1(ResizeSimpleAction,o);var s=_createSuper$1(ResizeSimpleAction);function ResizeSimpleAction(o,m,_){var S;return _classCallCheck$1(this,ResizeSimpleAction),(S=s.call(this))._actionModel={dimensions:{}},S._actionModel.actionType=Qx[o]||o,S.addQualifier(new Nx("c",o)),m&&S.width(m),_&&S.height(_),S}return _createClass$1(ResizeSimpleAction,[{key:"height",value:function height(o){return this._actionModel.dimensions.height=o,this.addQualifier(new Nx("h",o))}},{key:"width",value:function width(o){return this._actionModel.dimensions.width=o,this.addQualifier(new Nx("w",o))}},{key:"aspectRatio",value:function aspectRatio(o){return o instanceof sE?(this._actionModel.dimensions.aspectRatio="".concat(o),this.addQualifier(new Nx("ar",o))):"number"==typeof o||"string"==typeof o?(this._actionModel.dimensions.aspectRatio=toFloatAsString(o),this.addQualifier(new Nx("ar",toFloatAsString(o)))):o instanceof Bx?(this._actionModel.dimensions.aspectRatio="".concat(o.qualifierValue),this.addFlag(o)):void 0}},{key:"relative",value:function relative$1(){return this._actionModel.relative=!0,this.addFlag(function relative(){return new Bx("relative")}())}},{key:"regionRelative",value:function regionRelative$1(){return this._actionModel.regionRelative=!0,this.addFlag(function regionRelative(){return new Bx("region_relative")}())}}],[{key:"fromJson",value:function fromJson(o){var s=o.actionType,m=o.dimensions,_=o.relative,S=o.regionRelative,E=m.aspectRatio,A=m.width,O=m.height,H=new this(Yx[s]||s,A,O);return E&&H.aspectRatio("ignore_aspect_ratio"===E?function ignoreInitialAspectRatio(){return new Bx("ignore_aspect_ratio")}():E),_&&H.relative(),S&&H.regionRelative(),H}}]),ResizeSimpleAction}($x);var lE=function(o){_inherits$1(RoundCornersAction,o);var s=_createSuper$1(RoundCornersAction);function RoundCornersAction(){var o;return _classCallCheck$1(this,RoundCornersAction),(o=s.call(this))._actionModel={},o._actionModel.actionType="roundCorners",o}return _createClass$1(RoundCornersAction,[{key:"radius",value:function radius(o,s,m,_){var S=new Dx;void 0!==o&&S.addValue(o),void 0!==s&&S.addValue(s),void 0!==m&&S.addValue(m),void 0!==_&&S.addValue(_);var E=[o,s,m,_].filter((function(o){return void 0!==o}));return this._radius=E,this._actionModel.radius=E,this.addQualifier(new Nx("r").addValue(S)),this}},{key:"max",value:function max(){return this._radius="max",this._actionModel.radius="max",this.addQualifier(new Nx("r","max"))}},{key:"getRadius",value:function getRadius(){return this._radius}}],[{key:"fromJson",value:function fromJson(o){var s=o.radius,m=new this;return Array.isArray(s)&&m.radius(s[0],s[1],s[2],s[3]),"max"===s&&m.max(),m}}]),RoundCornersAction}($x),cE=lE;function stringPad(o,s,m){var _=s>>0,S=String(void 0!==m?m:" ");return o.length>_?String(o):((_-=o.length)>S.length&&(S+=function repeatStringNumTimes(o,s){var m=s,_="";for(;m>0;)_+=o,m--;return _}(S,_/S.length)),S.slice(0,_)+String(o))}var dE={},hE=0;function encodeVersion(o){var s="",m=6*o.split(".").length,_=function reverseVersion(o){if(o.split(".").length<2)throw new Error("invalid semVer, must have at least two segments");return o.split(".").reverse().map((function(o){var s=+o;if(isNaN(s)||s<0)throw"Invalid version number provided";return stringPad(o,2,"0")})).join(".")}(o),S=parseInt(_.split(".").join("")).toString(2);if((S=stringPad(S,m,"0")).length%6!=0)throw"Version must be smaller than 43.21.26)";return S.match(/.{1,6}/g).forEach((function(o){s+=dE[o]})),s}"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").forEach((function(o){var s=hE.toString(2);s=stringPad(s,6,"0"),dE[s]=o,hE++}));var pE="1.9.2";function getNodeVersion(){var o="0.0.0";if("undefined"!=typeof window)return o;try{return process.versions.node||o}catch(s){return o}}function getSDKAnalyticsSignature(o){var s=function ensureShapeOfTrackedProperties(o){var s={techVersion:getNodeVersion(),sdkCode:"T",sdkSemver:pE.split("-")[0],responsive:!1,placeholder:!1,lazyload:!1,accessibility:!1};return o?Object.assign(Object.assign({},s),o):s}(o),m=function getAnalyticsOptions(o){var s={sdkSemver:o.sdkSemver,techVersion:o.techVersion,sdkCode:o.sdkCode,feature:"0"};return o.accessibility&&(s.feature="D"),o.lazyload&&(s.feature="C"),o.responsive&&(s.feature="A"),o.placeholder&&(s.feature="B"),s}(s);try{var _=function removePatchFromSemver(o){var s=o.split(".");return"".concat(s[0],".").concat(s[1])}(m.techVersion),S=encodeVersion(m.sdkSemver),E=encodeVersion(_),A=m.feature,O=m.sdkCode;return"".concat("A").concat(O).concat(S).concat(E).concat(A)}catch(o){return"E"}}var fE={"image/upload":"images","image/private":"private_images","image/authenticated":"authenticated_images","raw/upload":"files","video/upload":"videos"},gE=function(){function CloudinaryFile(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0;_classCallCheck$1(this,CloudinaryFile),this.setPublicID(o),this.setCloudConfig(s),this.setURLConfig(m)}return _createClass$1(CloudinaryFile,[{key:"setURLConfig",value:function setURLConfig(o){return this.urlConfig=new Px(o),this}},{key:"setCloudConfig",value:function setCloudConfig(o){return this.cloudName=o.cloudName,this.apiKey=o.apiKey,this.apiSecret=o.apiSecret,this.authToken=o.authToken,this}},{key:"setPublicID",value:function setPublicID(o){return this.publicID=o?o.toString():"",this}},{key:"setDeliveryType",value:function setDeliveryType(o){return this.deliveryType=o,this}},{key:"setSuffix",value:function setSuffix(o){return this.suffix=o,this}},{key:"setSignature",value:function setSignature(o){return this.signature=o,this}},{key:"setVersion",value:function setVersion(o){return o&&(this.version=o),this}},{key:"setAssetType",value:function setAssetType(o){return o&&(this.assetType=o),this}},{key:"sign",value:function sign(){return this}},{key:"toURL",value:function toURL(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.createCloudinaryURL(null,o.trackedAnalytics)}},{key:"validateAssetForURLCreation",value:function validateAssetForURLCreation(){if(void 0===this.cloudName)throw"You must supply a cloudName when initializing the asset";var o=this.suffix&&this.suffix.indexOf(".")>=0,s=this.suffix&&this.suffix.indexOf("/")>=0;if(o||s)throw"`suffix`` should not include . or /"}},{key:"getResourceType",value:function getResourceType(){var o=function handleAssetType(o){return o||"image"}(this.assetType),s=function handleDeliveryType(o){return o||"upload"}(this.deliveryType),m=!!this.suffix,_="".concat(o,"/").concat(s),S=fE["".concat(o,"/").concat(s)],E=this.urlConfig.useRootPath,A=this.urlConfig.shorten;if(E){if("image/upload"===_)return"";throw new Error("useRootPath can only be used with assetType: 'image' and deliveryType: 'upload'. Provided: ".concat(_," instead"))}if(A&&"image/upload"===_)return"iu";if(m){if(S)return S;throw new Error("URL Suffix only supported for ".concat(Object.keys(fE).join(", "),", Provided: ").concat(_," instead"))}return _}},{key:"getSignature",value:function getSignature(){return this.signature?"s--".concat(this.signature,"--"):""}},{key:"createCloudinaryURL",value:function createCloudinaryURL(o,s){if(!this.publicID)return"";this.validateAssetForURLCreation();var m=function getUrlPrefix(o,s){var m=s.secure,_=s.privateCdn,S=s.cname,E=s.secureDistribution;return m||S?m&&!E&&_?"https://".concat(o,"-res.cloudinary.com"):m&&!E?"https://res.cloudinary.com/".concat(o):m&&E&&_?"https://".concat(E):m&&E?"https://".concat(E,"/").concat(o):!m&&S?"http://".concat(S,"/").concat(o):"ERROR":"http://res.cloudinary.com/".concat(o)}(this.cloudName,this.urlConfig),_=o?o.toString():"",S=function getUrlVersion(o,s,m){var _=!1!==m;return s?"v".concat(s):function publicIDContainsVersion(o){return o.match(/^v[0-9]+/)}(o)||function isUrl(o){return o.match(/^https?:\//)}(o)||function isFileName(o){return o.indexOf("/")<0}(o)?"":_?"v1":""}(this.publicID,this.version,this.urlConfig.forceVersion),E=this.publicID.replace(/,/g,"%2C"),A=[m,this.getResourceType(),this.getSignature(),_,S,E,this.suffix].filter((function(o){return o})).join("/");if("string"==typeof o)return A;var O=encodeURI(A).replace(/\?/g,"%3F").replace(/=/g,"%3D");return!1===this.urlConfig.analytics||E.includes("?")?O:"".concat(O,"?_a=").concat(getSDKAnalyticsSignature(s))}}]),CloudinaryFile}(),mE=function(o){_inherits$1(CloudinaryTransformable,o);var s=_createSuper$1(CloudinaryTransformable);function CloudinaryTransformable(o,m,_,S){var E;return _classCallCheck$1(this,CloudinaryTransformable),(E=s.call(this,o,m,_)).transformation=S,E}return _createClass$1(CloudinaryTransformable,[{key:"animated",value:function animated(o){return this.transformation.animated(o),this}},{key:"border",value:function border(o){return this.transformation.border(o),this}},{key:"reshape",value:function reshape(o){return this.transformation.reshape(o),this}},{key:"resize",value:function resize(o){return this.transformation.resize(o),this}},{key:"quality",value:function quality(o){return this.addAction(new nE("q",o)),this}},{key:"format",value:function format(o){return this.addAction(new nE("f",o)),this}},{key:"roundCorners",value:function roundCorners(o){return this.transformation.roundCorners(o),this}},{key:"overlay",value:function overlay(o){return this.transformation.overlay(o),this}},{key:"addVariable",value:function addVariable(o){return this.transformation.addVariable(o),this}},{key:"conditional",value:function conditional(o){return this.transformation.conditional(o),this}},{key:"effect",value:function effect(o){return this.transformation.effect(o),this}},{key:"adjust",value:function adjust(o){return this.transformation.adjust(o),this}},{key:"rotate",value:function rotate(o){return this.transformation.rotate(o),this}},{key:"namedTransformation",value:function namedTransformation(o){return this.transformation.namedTransformation(o),this}},{key:"delivery",value:function delivery(o){return this.transformation.delivery(o),this}},{key:"backgroundColor",value:function backgroundColor(o){return this.transformation.backgroundColor(o),this}},{key:"psdTools",value:function psdTools(o){return this.transformation.psdTools(o),this}},{key:"extract",value:function extract(o){return this.transformation.extract(o),this}},{key:"addFlag",value:function addFlag(o){return this.transformation.addFlag(o),this}},{key:"customFunction",value:function customFunction(o){return this.transformation.customFunction(o),this}},{key:"addAction",value:function addAction(o){return this.transformation.addAction(o),this}},{key:"addTransformation",value:function addTransformation(o){return this.transformation.addTransformation(o),this}},{key:"toString",value:function toString(){return this.transformation.toString()}},{key:"underlay",value:function underlay(o){return this.transformation.underlay(o),this}},{key:"toURL",value:function toURL(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.createCloudinaryURL(this.transformation,null==o?void 0:o.trackedAnalytics)}}]),CloudinaryTransformable}(gE),yE=function(o){_inherits$1(CloudinaryImage,o);var s=_createSuper$1(CloudinaryImage);function CloudinaryImage(o,m,_){return _classCallCheck$1(this,CloudinaryImage),s.call(this,o,m,_,new iE)}return _createClass$1(CloudinaryImage)}(mE),vE=function(o){_inherits$1(CloudinaryVideo,o);var s=_createSuper$1(CloudinaryVideo);function CloudinaryVideo(o,m,_){var S;return _classCallCheck$1(this,CloudinaryVideo),(S=s.call(this,o,m,_,new aE)).assetType="video",S}return _createClass$1(CloudinaryVideo,[{key:"transcode",value:function transcode(o){return this.transformation.transcode(o),this}},{key:"videoEdit",value:function videoEdit(o){return this.transformation.videoEdit(o),this}}]),CloudinaryVideo}(mE),_E=function(){function Cloudinary(o){_classCallCheck$1(this,Cloudinary),o&&(this.cloudinaryConfig=o)}return _createClass$1(Cloudinary,[{key:"image",value:function image(o){return new yE(o,this.cloudinaryConfig.cloud,this.cloudinaryConfig.url)}},{key:"video",value:function video(o){return new vE(o,this.cloudinaryConfig.cloud,this.cloudinaryConfig.url)}},{key:"setConfig",value:function setConfig(o){return this.cloudinaryConfig=o,this}},{key:"getConfig",value:function getConfig(){return this.cloudinaryConfig}},{key:"extendConfig",value:function extendConfig(){}}]),Cloudinary}(),bE=function(){function CloudinaryImplementation(){_classCallCheck$1(this,CloudinaryImplementation),this.downScaleAmount=10,this.cld=new _E({cloud:{cloudName:MS}})}return _createClass$1(CloudinaryImplementation,[{key:"generateImageURL",value:function generateImageURL(o){var s=o.createSessionNumber?this.addNewSessionNumber(o.url):o.url;return this.generateCloudinaryImage({url:s,width:o.width,height:o.height}).toURL()}},{key:"roundImageCorners",value:function roundImageCorners(o,s){var m=this.generateCloudinaryImage({url:o.url,width:o.width,height:o.height}).roundCorners(function byRadius(o,s,m,_){return(new cE).radius(o,s,m,_)}(s)).toURL();return m}},{key:"generateDownScaledURL",value:function generateDownScaledURL(o){var s=o.width/this.downScaleAmount,m=o.height/this.downScaleAmount;return this.generateImageURL({url:o.url,width:s,height:m})}},{key:"generateCloudinaryImage",value:function generateCloudinaryImage(o){return this.cld.image(o.url).setDeliveryType("fetch").resize(function fit(o,s){return new uE("fit",o,s)}().width(o.width).height(o.height))}},{key:"addNewSessionNumber",value:function addNewSessionNumber(o){var s=a_.resolveType(a_.dependencyKeys.Store),m=s.getByProperty("sessionNumber"),_=m||function getRandomNumber(){return Math.floor(1e9*Math.random())}(),S="".concat(o,"?sessionNumber=").concat(_);return m||s.set("sessionNumber",_),S}}]),CloudinaryImplementation}(),SE={currentEvent:null,appIsLoading:!1,dataLoaded:!1,appIsBooting:!1,sessionNumber:null,playerMuted:!1,fullScreenEnabled:{page:"",isVisible:!1},appError:{error:!1,type:"other"},carouselError:!1},TE=function(o){_inherits$1(AudioDemoPresenter,o);var s=_createSuper$1(AudioDemoPresenter);function AudioDemoPresenter(){var o;return _classCallCheck$1(this,AudioDemoPresenter),(o=s.apply(this,arguments)).sourcesData=[{title:"HLS (Linear)",params:{format:"hls",type:"LiveAudio",tags:[],id:"9"}},{title:"MP4 (AUD)",params:{format:"mp4",type:"AOD",tags:[],id:"10"}},{title:"DASH (AUD)",params:{format:"dash",type:"AOD",tags:[],id:"11"}},{title:"MP3 (AUD)",params:{format:"mp3",type:"AOD",tags:[],id:"12"}},{title:"MP3 (Linear)",params:{format:"mp3",type:"LiveAudio",tags:[],id:"13"}},{title:"WAV (AUD)",params:{format:"wav",type:"AOD",tags:[],id:"14"}},{title:"OGG (AUD)",params:{format:"ogg",type:"AOD",tags:[],id:"15"}},{title:"AAC (AUD)",params:{format:"aac",type:"AOD",tags:[],id:"16"}},{title:"AAC (Linear)",params:{format:"aac",type:"LiveAudio",tags:[],id:"17"}},{title:"FLAC (AUD)",params:{format:"flac",type:"AOD",tags:[],id:"18"}}],o}return _createClass$1(AudioDemoPresenter)}(xx),kE={language:"en_US"},CE={en_US:{appTitle:"Core App Sample",appSecondTitle:"Introducing the Velope Core App Sample",demosTitle:"Featured Demos",appDescription:"App created with Lightningjs for the purposes of acting as a template for future projects as well as testing out new features from the Core App Packages.",appFeature1:"• Player page with a selection of all supported players that can be controlled with a remote on TV or with on screen controls on browser",appFeature2:"• Is supported in TV platforms such as FireTV, AndroidTV, WebOS, Tizen, Vizio and X1",appFeature3:"• Progressbar supports seeking between video allowing you to fast forward or rewind at will",appFeature4:"• Includes a Cloudinary implementation with processes to resize images",appFeature5:"• Supports HLS, Shaka, AAMP and AVPlay Player Implementation",appFeature6:"• Functioning and customizable Splash Screen, Exit Modal and Keyboard page",carouselTitle:"Carousel Example",notFound:"Not Found..",videoPlayerTitle:"Video Player",audioPlayerTitle:"Audio Player",playerWidgetTitle:"Player Widget",keyboardTitle:"Keyboard Samples",selectPlayer:"Select a player",selectSource:"Select a source",playerActions:"Player actions",currentlySelected:"Currently selected:",videoUrl:"-Video URL-",splashText:"This splash screen can be customized",unSupportedSource:"Selected Source is unsupported!",exitPageTitle:"Exit Modal",exitTitle:"Exit Title",exitMessage:"Are you sure you want to exit the app?",exitAffirm:"Yes",exitDeny:"No",exampleModalPageTitle:"Example Modal",exampleModalTitle:"Hey",exampleModalMessage:"You didn't exit the app!",exampleModalAffirm:"OK",errorMessage:"Oops! something went wrong ):",error:"Error!",autoplay:"Autoplay",rewind:"Rewind 10 seconds",play:"Play",pause:"Pause",fastForward:"Fast forward ten seconds",fullScreen:"Go to full screen",mutePlayer:"Mute player",unmutePlayer:"Unmute player",keyboardViewDescription:"Our core app offers a keyboard component that can be stylized and customized to specific layouts. Select one of the buttons below to switch between two different keyboard layouts",emailKeyboardButtonTitle:"Email Keyboard",searchKeyboardButtonTitle:"Search Keyboard",keyboardPlaceholder:"Placeholder for search",errorDismiss:"Close",errorReturn:"Go Back",errorRetry:"Retry",apiErrorText:"The page you’re looking for can’t be reached right now. Please check your internet connection and try again.",playerErrorText:"The video you are trying to load is not working. Please check your internet connection and try again."}},wE=function(o){_inherits$1(ErrorPresenter,o);var s=_createSuper$1(ErrorPresenter);function ErrorPresenter(){var o;_classCallCheck$1(this,ErrorPresenter);var m=a_.resolveType(a_.dependencyKeys.Store);return(o=s.call(this,m)).handleError=function(s){s.newValue&&o.onPropertyChanged("errorTriggered",{},s.newValue)},o.store.propertyChanged.appError.addListener(o.handleError),o}return _createClass$1(ErrorPresenter)}(r_),xE=function(){function BroadcastClient(){var o=this;_classCallCheck$1(this,BroadcastClient),this.permissions={audio:!1,video:!1},this.injectBroadcastSDK().then((function(){o.IVSClient=IVSBroadcastClient.create({streamConfig:IVSBroadcastClient.STANDARD_LANDSCAPE,ingestEndpoint:BS.ingestEndpoint})})),this.logger=a_.resolveType(DE.dependencyKeys.Logger)}return _createClass$1(BroadcastClient,[{key:"injectBroadcastSDK",value:function injectBroadcastSDK(){return new Promise((function(o,s){var m=document.createElement("script");m.src="https://web-broadcast.live-video.net/1.5.1/amazon-ivs-web-broadcast.js",m.onload=function(){o()},m.onerror=function(){s()},document.body&&document.body.appendChild(m)}))}},{key:"initBroadcastService",value:function initBroadcastService(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:if(!this.IVSClient){o.next=5;break}return o.next=3,this.handlePermissions();case 3:return o.next=5,this.getMediaDevices();case 5:case"end":return o.stop()}}),_callee,this)})))}},{key:"handlePermissions",value:function handlePermissions(){var o,s,m;return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){var _,S;return _regeneratorRuntime$1().wrap((function _callee2$(E){for(;;)switch(E.prev=E.next){case 0:return this.permissions={audio:!1,video:!1},E.prev=1,E.next=4,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 4:this.stream=E.sent,_=_createForOfIteratorHelper(this.stream.getTracks());try{for(_.s();!(S=_.n()).done;)S.value.stop()}catch(o){_.e(o)}finally{_.f()}this.permissions={video:!0,audio:!0},E.next=14;break;case 10:E.prev=10,E.t0=E.catch(1),this.permissions={video:!1,audio:!1},null===(o=this.logger)||void 0===o||o.error("".concat(E.t0));case 14:this.permissions.video?this.permissions.audio||null===(m=this.logger)||void 0===m||m.error("Failed to get audio permissions."):null===(s=this.logger)||void 0===s||s.error("Failed to get video permissions.");case 15:case"end":return E.stop()}}),_callee2,this,[[1,10]])})))}},{key:"getMediaDevices",value:function getMediaDevices(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){var o;return _regeneratorRuntime$1().wrap((function _callee3$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,navigator.mediaDevices.enumerateDevices();case 2:o=s.sent,this.videoDevices=o.filter((function(o){return"videoinput"===o.kind})),this.audioDevices=o.filter((function(o){return"audioinput"===o.kind}));case 5:case"end":return s.stop()}}),_callee3,this)})))}},{key:"setupVideoDevices",value:function setupVideoDevices(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){var o,s,m,_;return _regeneratorRuntime$1().wrap((function _callee4$(S){for(;;)switch(S.prev=S.next){case 0:if(!this.videoDevices){S.next=7;break}o=[],s=_createForOfIteratorHelper(this.videoDevices);try{for(s.s();!(m=s.n()).done;)_=m.value,o.push(_.deviceId)}catch(o){s.e(o)}finally{s.f()}return S.next=6,navigator.mediaDevices.getUserMedia({video:{deviceId:o,width:{max:1920},height:{max:1080}}});case 6:this.cameraStream=S.sent;case 7:case"end":return S.stop()}}),_callee4,this)})))}},{key:"setupAudioDevices",value:function setupAudioDevices(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:if(!this.audioDevices||!this.audioDevices[0]){o.next=4;break}return o.next=3,navigator.mediaDevices.getUserMedia({audio:{deviceId:this.audioDevices[0].deviceId}});case 3:this.audioStream=o.sent;case 4:case"end":return o.stop()}}),_callee5,this)})))}},{key:"addSourceToStream",value:function addSourceToStream(){this.IVSClient&&(this.cameraStream&&this.IVSClient.addVideoInputDevice(this.cameraStream,"camera1",{index:0}),this.audioStream&&this.IVSClient.addAudioInputDevice(this.audioStream,"mic1"))}},{key:"startBroadcast",value:function startBroadcast(o){var s,m;return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(_){for(;;)switch(_.prev=_.next){case 0:if(this.cameraStreamFirstTrack||this.audioStreamFirstTrack){_.next=6;break}return _.next=3,this.setupVideoDevices();case 3:return _.next=5,this.setupAudioDevices();case 5:this.addSourceToStream();case 6:if(!this.IVSClient){_.next=16;break}return _.prev=7,_.next=10,this.IVSClient.startBroadcast(o);case 10:null===(s=this.logger)||void 0===s||s.info("I am successfully broadcasting!"),_.next=16;break;case 13:_.prev=13,_.t0=_.catch(7),null===(m=this.logger)||void 0===m||m.error("Something drastically failed while broadcasting!',".concat(_.t0));case 16:case"end":return _.stop()}}),_callee6,this,[[7,13]])})))}},{key:"stopBroadcast",value:function stopBroadcast(){this.IVSClient&&(this.IVSClient.stopBroadcast(),this.cameraStreamFirstTrack&&this.cameraStreamFirstTrack.stop(),this.audioStreamFirstTrack&&this.audioStreamFirstTrack.stop())}},{key:"mute",value:function mute(){this.audioStream&&this.cameraStreamFirstTrack&&(this.cameraStreamFirstTrack.enabled=!1)}},{key:"unmute",value:function unmute(){this.audioStream&&this.cameraStreamFirstTrack&&(this.cameraStreamFirstTrack.enabled=!0)}},{key:"hide",value:function hide(){this.cameraStream&&this.audioStreamFirstTrack&&(this.audioStreamFirstTrack.enabled=!1)}},{key:"show",value:function show(){this.cameraStream&&this.audioStreamFirstTrack&&(this.audioStreamFirstTrack.enabled=!0)}},{key:"audioStreamFirstTrack",get:function get(){var o;return null===(o=this.audioStream)||void 0===o?void 0:o.getAudioTracks()[0]}},{key:"cameraStreamFirstTrack",get:function get(){var o;return null===(o=this.cameraStream)||void 0===o?void 0:o.getAudioTracks()[0]}}]),BroadcastClient}(),IE=function(o){_inherits$1(SoundBoardPresenter,o);var s=_createSuper$1(SoundBoardPresenter);function SoundBoardPresenter(){var o;return _classCallCheck$1(this,SoundBoardPresenter),(o=s.apply(this,arguments)).htmlSources=[{title:"Audience Cheer 01",params:{player:"html",sfx:"Cheer1",route:"./static/StockSFX/AudienceCheer_01.wav"}},{title:"Audience Cheer 02",params:{player:"html",sfx:"Cheer2",route:"./static/StockSFX/AudienceCheer_02.wav"}},{title:"Audience Cheer 03",params:{player:"html",sfx:"Cheer3",route:"./static/StockSFX/AudienceCheer_03.wav"}},{title:"Audience Cheer 04",params:{player:"html",sfx:"Cheer4",route:"./static/StockSFX/AudienceCheer_04.wav"}},{title:"Audience Cheer 05",params:{player:"html",sfx:"Cheer5",route:"./static/StockSFX/AudienceCheer_05.wav"}},{title:"Wheel Ambient MP3",params:{player:"html",sfx:"WheelAmbientMp3",route:"./static/StockSFX/Wheel_Ambient.mp3"}},{title:"Wheel Ambient WAV",params:{player:"html",sfx:"WheelAmbientWav",route:"./static/StockSFX/Wheel_Ambient.wav"}},{title:"Wheel Clean MP3",params:{player:"html",sfx:"WheelCleanMp3",route:"./static/StockSFX/Wheel_Clean.mp3"}},{title:"Wheel Clean WAV",params:{player:"html",sfx:"WheelCleanWav",route:"./static/StockSFX/Wheel_Clean.wav"}}],o.audioAPISources=[{title:"Audience Cheer 01",params:{player:"audioAPI",sfx:"audioAPICheer1",route:"./static/StockSFX/AudienceCheer_01.wav"}},{title:"Audience Cheer 02",params:{player:"audioAPI",sfx:"audioAPICheer2",route:"./static/StockSFX/AudienceCheer_02.wav"}},{title:"Audience Cheer 03",params:{player:"audioAPI",sfx:"audioAPICheer3",route:"./static/StockSFX/AudienceCheer_03.wav"}},{title:"Audience Cheer 04",params:{player:"audioAPI",sfx:"audioAPICheer4",route:"./static/StockSFX/AudienceCheer_04.wav"}},{title:"Audience Cheer 05",params:{player:"audioAPI",sfx:"audioAPICheer5",route:"./static/StockSFX/AudienceCheer_05.wav"}},{title:"Wheel Ambient MP3",params:{player:"audioAPI",sfx:"audioAPIWheelAmbientMp3",route:"./static/StockSFX/Wheel_Ambient.mp3"}},{title:"Wheel Ambient WAV",params:{player:"audioAPI",sfx:"audioAPIWheelAmbientWav",route:"./static/StockSFX/Wheel_Ambient.wav"}},{title:"Wheel Clean MP3",params:{player:"audioAPI",sfx:"audioAPIWheelCleanMp3",route:"./static/StockSFX/Wheel_Clean.mp3"}},{title:"Wheel Clean WAV",params:{player:"audioAPI",sfx:"audioAPIWheelCleanWav",route:"./static/StockSFX/Wheel_Clean.wav"}}],o.ampSources=[{title:"Audience Cheer 01",params:{player:"amp",sfx:"Cheer1",route:"./apps/core-app/static/StockSFX/AudienceCheer_01.wa4"}},{title:"Audience Cheer 02",params:{player:"amp",sfx:"Cheer2",route:"./apps/core-app/static/StockSFX/AudienceCheer_02.wa4"}},{title:"Audience Cheer 03",params:{player:"amp",sfx:"Cheer3",route:"./apps/core-app/static/StockSFX/AudienceCheer_03.wa4"}},{title:"Audience Cheer 04",params:{player:"amp",sfx:"Cheer4",route:"./apps/core-app/static/StockSFX/AudienceCheer_04.wa4"}},{title:"Audience Cheer 05",params:{player:"amp",sfx:"Cheer5",route:"./apps/core-app/static/StockSFX/AudienceCheer_05.wa4"}},{title:"Wheel Ambient",params:{player:"amp",sfx:"WheelAmbientMp3",route:"./apps/core-app/static/StockSFX/Wheel_Ambient.mp4"}},{title:"Wheel Clean",params:{player:"amp",sfx:"WheelCleanMp3",route:"./apps/core-app/static/StockSFX/Wheel_Clean.mp4"}},{title:"Video Clip",params:{player:"amp",sfx:"tearsOfSteel",route:"https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8"}}],o.rmpSources=[{title:"Video Clip",params:{player:"rmp",sfx:"tearsOfSteel",route:"https://demo.unified-streaming.com/k8s/features/stable/video/tears-of-steel/tears-of-steel.ism/.m3u8"}}],o}return _createClass$1(SoundBoardPresenter,[{key:"htmlSourceButtons",get:function get(){return this.htmlSources}},{key:"audioAPISourceButtons",get:function get(){return this.audioAPISources}},{key:"ampSourceButtons",get:function get(){return this.ampSources}},{key:"rmpSourceButtons",get:function get(){return this.rmpSources}}]),SoundBoardPresenter}(r_),AE=function(o){_inherits$1(DetailsPresenter,o);var s=_createSuper$1(DetailsPresenter);function DetailsPresenter(){var o;return _classCallCheck$1(this,DetailsPresenter),(o=s.apply(this,arguments)).api=a_.resolveType(a_.dependencyKeys.API),o}return _createClass$1(DetailsPresenter,[{key:"fetchAssetData",value:function fetchAssetData(o){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var s;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.api.fetchAssetData(o);case 2:if(!(s=m.sent).error){m.next=8;break}throw this.logger.error("Error while fetching Asset ID: ".concat(o,". Error: ").concat(JSON.stringify(s.error,null,2))),s.error;case 8:this.assetData=s;case 9:case"end":return m.stop()}}),_callee,this)})))}},{key:"assetData",get:function get(){return this.currentAssetData},set:function set(o){this.currentAssetData=o}},{key:"tmdbInfo",get:function get(){return this.api.fetchCarouselInfo()}},{key:"formatPosterUrl",value:function formatPosterUrl(o,s){return"".concat(this.tmdbInfo.tmdb_backdrop_path,"/w").concat(o,"/").concat(s)}}]),DetailsPresenter}(r_),__awaiter$9=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},PE=function(o){_inherits$1(UniversalSearchAnalytics,o);var s=_createSuper$1(UniversalSearchAnalytics);function UniversalSearchAnalytics(o,m){var _;return _classCallCheck$1(this,UniversalSearchAnalytics),(_=s.call(this,m)).eventBatch=[],_.universalSearchConfig=o,_}return _createClass$1(UniversalSearchAnalytics,[{key:"send",value:function send(o){return __awaiter$9(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var s,m,_,S;return _regeneratorRuntime$1().wrap((function _callee$(E){for(;;)switch(E.prev=E.next){case 0:return s=o.EventPayload,m=new URLSearchParams(s),_=this.universalSearchConfig.endpoint+m,E.prev=3,E.next=6,this.fetchData({url:_,header:{method:"GET"}});case 6:S=E.sent,this.logger.info("GET request response: ".concat(JSON.stringify(S,null,2))),E.next=13;break;case 10:E.prev=10,E.t0=E.catch(3),this.logger.error("".concat(JSON.stringify(E.t0,null,2)));case 13:case"end":return E.stop()}}),_callee,this,[[3,10]])})))}}]),UniversalSearchAnalytics}(Xy),LE=function(){function DependencyRegistryConfig(){_classCallCheck$1(this,DependencyRegistryConfig),this.dependencyKeys={HomePresenter:"HomePresenter",CarouselPresenter:"CarouselPresenter",ProgressBarPresenter:"ProgressBarPresenter",SplashPresenter:"SplashPresenter",SpinnerPresenter:"SpinnerPresenter",PlayersDemoPresenter:"PlayersDemoPresenter",CloudinaryImplementation:"CloudinaryImplementation",SoundBoardPresenter:"SoundBoardPresenter",Player:"Player",AudioDemoPresenter:"AudioDemoPresenter",Logger:"Logger",BroadcastClient:"BroadcastClient",TextProvider:"TextProvider",ErrorPresenter:"ErrorPresenter",DetailsPresenter:"DetailsPresenter",AnalyticsImplementation:"AnalyticsImplementation"}}return _createClass$1(DependencyRegistryConfig,[{key:"init",value:function init(){a_.registerType(new Yv,a_.dependencyKeys.LogStorage);var o=a_.resolveType(a_.dependencyKeys.LogStorage);a_.registerType(new $v(o),a_.dependencyKeys.Logger);var s=a_.resolveType(a_.dependencyKeys.Logger);a_.registerType(new n_(s),a_.dependencyKeys.Profiling);var m="true"===RS.get("profiling"),_=RS.get("durationUnit"),S=a_.resolveType(a_.dependencyKeys.Profiling);S.active=m,S.ignoreList=FS,S.durationUnit=_,m&&(s.LogLevel=tv.PERFORMANCE),a_.registerType(new l_(kE,CE),this.dependencyKeys.TextProvider),a_.registerType(new t_(SE),a_.dependencyKeys.Store);var E=a_.resolveType(a_.dependencyKeys.Store);a_.registerType(new WS(s),a_.dependencyKeys.API),a_.registerType(new GS,this.dependencyKeys.HomePresenter),a_.registerType(new qS(E),this.dependencyKeys.CarouselPresenter),a_.registerType(new ZT,this.dependencyKeys.ProgressBarPresenter),a_.registerType(new yx,this.dependencyKeys.SplashPresenter),a_.registerType(new _x,this.dependencyKeys.SpinnerPresenter),a_.registerType(new xx,this.dependencyKeys.PlayersDemoPresenter),a_.registerType(new TE,this.dependencyKeys.AudioDemoPresenter),a_.registerType(new bE,this.dependencyKeys.CloudinaryImplementation),a_.registerType(new wE,this.dependencyKeys.ErrorPresenter),a_.registerType(new IE(E),this.dependencyKeys.SoundBoardPresenter),a_.registerType(new AE(E),this.dependencyKeys.DetailsPresenter),a_.registerType(new xE,this.dependencyKeys.BroadcastClient),a_.registerType(new PE(NS),this.dependencyKeys.AnalyticsImplementation)}}]),DependencyRegistryConfig}(),DE=new LE;function BootRouter(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o;return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return o=a_.resolveType(DE.dependencyKeys.Logger),s.next=3,qw.init(o);case 3:case"end":return s.stop()}}),_callee)})))}function measureTextWidth(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=document.createElement("canvas").getContext("2d");if(!s)return 0;var m=function preparingTextFont(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=o.fontStyle,m=o.fontSize,_=o.fontFace||"sans-serif";return[s,m?"".concat(m,"px"):"0","'".concat(_,"'")].filter(Boolean).join(" ")}(o);s.font=m;var _=s.measureText(o.text||"");return Math.round(_.width)}function renderImage(o,s,m){if(o){if(o.search(/^.*\.(svg)$/gi)>-1)return{texture:E.Tools.getSvgTexture(o,s,m)};if(o.search(/^.*\.(jpg|gif|png)$/gi)>-1)return{w:s,h:m,src:o};throw new Error("Could not load icon/image. Wrong format.")}}var RE=4294967295,OE=0,ME=4278190080,FE=4288059030,NE=3640655872,UE=2164260863,BE=2568229911,jE=4280229663,$E=4009754623,VE=2147483647,HE=function(o){_inherits$1(ItemCell,o);var s=_createSuper$1(ItemCell);function ItemCell(){var o;return _classCallCheck$1(this,ItemCell),(o=s.apply(this,arguments)).itemImage="",o.placeHolderImage=null,o.stroke=0,o.focusedStroke=0,o.strokeColor=RE,o.strokeUnfocusColor=ME,o}return _createClass$1(ItemCell,[{key:"_active",value:function _active(){this.tag("ItemBox").patch({src:this.itemImage})}},{key:"_inactive",value:function _inactive(){this.tag("ItemBox").patch({src:this.placeHolderImage?this.placeHolderImage:null})}},{key:"_enable",value:function _enable(){this.addImage(this.placeHolderImage?this.placeHolderImage:this.itemImage)}},{key:"_focus",value:function _focus(){this._setFocus(!0)}},{key:"_unfocus",value:function _unfocus(){this._setFocus(!1)}},{key:"addImage",value:function addImage(o){this.tag("ItemBox").patch({src:o})}},{key:"loadImage",value:function loadImage(){this.tag("ItemBox").loadTexture()}},{key:"_setFocus",value:function _setFocus(o){this.tag("ItemBox").patch({shader:Object.assign(Object.assign({},this.focusedStroke>0&&{stroke:o?this.focusedStroke:this.stroke}),{strokeColor:o?this.strokeColor:this.strokeUnfocusColor})})}},{key:"strokeWidth",set:function set(o){this.stroke=o,this.tag("ItemBox").shader.stroke=o}},{key:"focusedStrokeWidth",set:function set(o){this.focusedStroke=o}},{key:"strokeRadius",set:function set(o){this.tag("ItemBox").shader.radius=o}},{key:"strokeColorOnFocus",set:function set(o){this.strokeColor=o}},{key:"strokeColorOnUnfocus",set:function set(o){this.strokeUnfocusColor=o,this.tag("ItemBox").shader.strokeColor=o}}],[{key:"_template",value:function _template(){return{w:function w(o){return o},h:function h(o){return o},ItemBox:{w:function w(o){return o},h:function h(o){return o},alpha:1,rect:!0,shader:{type:E.shaders.RoundedRectangle,radius:10,stroke:3}}}}}]),ItemCell}(E.Component),KE=function(o){_inherits$1(StrikeThrough,o);var s=_createSuper$1(StrikeThrough);function StrikeThrough(){var o;return _classCallCheck$1(this,StrikeThrough),(o=s.apply(this,arguments))._formatText=!0,o._strikeThroughLineHeight=0,o.lineTemplate={y:function y(o){return o/2.25},w:function w(o){return o+.01*o},h:function h(o){return.05*o},mountY:.5,rect:!0},o}return _createClass$1(StrikeThrough,[{key:"_active",value:function _active(){this.updateTextStyle()}},{key:"updateTextStyle",value:function updateTextStyle(){var o,s;this.patch({Line:Object.assign(Object.assign(Object.assign({},this.lineTemplate),this._strikeThroughLineHeight>0&&{h:this._strikeThroughLineHeight}),{alpha:this._formatText?1:0,color:null!==(s=null===(o=this.style)||void 0===o?void 0:o.textColor)&&void 0!==s?s:0})})}},{key:"textStyle",get:function get(){return this.text},set:function set(o){this.style?this.style=Object.assign(Object.assign({},this.style),o):this.style=o,this.text=this.style}},{key:"enableStrikeThrough",get:function get(){return this._formatText},set:function set(o){this._formatText=o,this.updateTextStyle()}},{key:"strikeThroughLineHeight",set:function set(o){this._strikeThroughLineHeight=o,this.updateTextStyle()}}]),StrikeThrough}(E.Component),zE=function(o){_inherits$1(Button,o);var s=_createSuper$1(Button);function Button(){var o;return _classCallCheck$1(this,Button),(o=s.apply(this,arguments)).buttonId="",o.defaultWidth=150,o.defaultHeight=78,o.buttonColor=jE,o.buttonFocusedColor=RE,o.buttonSelectedColor=FE,o.buttonDisabledColor=$E,o.buttonPaddingW=24,o.buttonPaddingH=12,o.buttonRadius=10,o.buttonText="",o.buttonTextFixedVerticalPosition=2,o.buttonDefaultTextSize=23,o.buttonDefaultLetterSpacing=.3,o.buttonTextColor=RE,o.buttonFocusedTextColor=jE,o.buttonSelectedTextColor=ME,o.buttonDisabledTextColor=VE,o.buttonTextButtonStyle={fontSize:o.buttonDefaultTextSize,letterSpacing:o.buttonDefaultLetterSpacing,textColor:o.buttonTextColor},o.buttonFocusedTextButtonStyle={fontSize:o.buttonDefaultTextSize,letterSpacing:o.buttonDefaultLetterSpacing,textColor:o.buttonFocusedTextColor},o.buttonSelectedTextButtonStyle={fontSize:o.buttonDefaultTextSize,letterSpacing:o.buttonDefaultLetterSpacing,textColor:o.buttonSelectedTextColor},o.buttonDisabledTextButtonStyle={fontSize:o.buttonDefaultTextSize,textColor:o.buttonDisabledTextColor,letterSpacing:o.buttonDefaultLetterSpacing},o.buttonEnableStrikeThrough=!1,o.buttonStrikeThroughLineHeight=0,o.buttonStroke=0,o.buttonFocusedStroke=0,o.buttonSelectedStroke=0,o.buttonDisabledStroke=0,o.buttonStrokeColor=OE,o.buttonFocusedStrokeColor=OE,o.buttonSelectedStrokeColor=OE,o.buttonDisabledStrokeColor=OE,o.buttonIsSelected=!1,o.buttonIsDisabled=!1,o.buttonIconProps={src:"",w:0,h:0},o.buttonIconSpacing=16,o.buttonSpinnerStyle={w:60,h:60,shader:{radius:30,stroke:12,color:4294967295,showDot:!0,period:1,backgroundColor:0}},o.buttonContentAlpha=1,o.useSmoothAnimation=!1,o.buttonRoute="",o.buttonUseSpinner=!1,o.skipFocus=!1,o.useTitle=!0,o.showUnderlineBar=!1,o.underlineDefaultColor=RE,o.underlineFocusedColor=ME,o}return _createClass$1(Button,[{key:"_enable",value:function _enable(){this._update()}},{key:"_focus",value:function _focus(){this.background.patch(Object.assign({},this.useSmooth?{smooth:_defineProperty$2({},"shader.fillColor",this.focusedColor)}:{shader:{fillColor:this.focusedColor}})),this._setFocus(!0),this.fireOnFocus()}},{key:"_unfocus",value:function _unfocus(){this.background.patch(Object.assign({},this.useSmooth?{smooth:_defineProperty$2({},"shader.fillColor",this.isSelected?this.selectedColor:this.color)}:{shader:{fillColor:this.isSelected?this.selectedColor:this.color}})),this._setFocus(!1),this.fireOnUnFocus()}},{key:"_handleEnter",value:function _handleEnter(){return"function"==typeof this.onEnter&&this.onEnter()}},{key:"_setFocus",value:function _setFocus(o){this.background.patch({alpha:o?1:this.alpha,shader:{fillColor:this.getFillColor(o),stroke:this.getStroke(o),strokeColor:this.getStrokeColor(o)}}),this.useTitle&&this.title?(this.buttonTitle.patch({textStyle:Object.assign(Object.assign({},this.getTextStyle(o)),{text:this.title})}),this.buttonTitle.enableStrikeThrough&&this.buttonTitle.updateTextStyle()):this.buttonLabel.patch({text:o?this.buttonFocusedTextButtonStyle:this.buttonTextButtonStyle}),null!=this.buttonIconProps.src&&this.buttonIcon.patch({shader:{amount:o?0:6}}),this.isSelected||this.tag("UnderlineBar").patch({color:o?this.underlineFocusedColor:this.underlineDefaultColor})}},{key:"_update",value:function _update(){this._updateColor(),this._updateTitle(),this._updateIcon(),this._updateSize()}},{key:"_updateColor",value:function _updateColor(){var o,s=null!==(o=this.hasFocus())&&void 0!==o&&o;this.background.patch({shader:{radius:this.radius,fillColor:this.getFillColor(s),stroke:this.getStroke(s),strokeColor:this.getStrokeColor(s)}}),this.buttonLabel.patch({text:{textColor:this.buttonTextButtonStyle.textColor}})}},{key:"_updateTitle",value:function _updateTitle(){var o;if(this.title){var s=null!==(o=this.hasFocus())&&void 0!==o&&o,m=this.getTextStyle(s);this.buttonUseSpinner?(this.buttonContent.alpha=0,this.buttonSpinner.alpha=1):(this.buttonContent.alpha=this.buttonContentAlpha,this.buttonSpinner.alpha=0,this.buttonTitle.patch({y:this.textFixedVerticalPosition,alpha:1,enableStrikeThrough:this.buttonEnableStrikeThrough,strikeThroughLineHeight:this.buttonStrikeThroughLineHeight,textStyle:Object.assign(Object.assign({},m),{text:this.title})}),this.buttonTitle.enableStrikeThrough&&this.buttonTitle.updateTextStyle())}else this.buttonTitle.texture=null}},{key:"_updateIcon",value:function _updateIcon(){var o;this.buttonIconProps.src?this.buttonIcon.patch(Object.assign(Object.assign({},renderImage(this.buttonIconProps.src,this.buttonIconProps.w,this.buttonIconProps.h)),{flexItem:{marginRight:this.title?null!==(o=this.buttonIconProps.spacing)&&void 0!==o?o:this.buttonIconSpacing:0},rotation:this.buttonIconProps.rotation?this.buttonIconProps.rotation:0,shader:{type:E.shaders.Inversion,amount:this.hasFocus()?0:10}})):this.buttonIcon.patch({w:0,h:0,texture:!1,flexItem:!1})}},{key:"_updateSize",value:function _updateSize(){var o=this.buttonIconProps.src?this.buttonIconProps.w+this.buttonIconSpacing:0,s=this.buttonIconProps.src?this.buttonIconProps.h:0,m=(this.buttonTitle.textStyle?measureTextWidth(this.buttonTitle.textStyle):0)+2*this.paddingW+o,_=this.buttonTextButtonStyle.fontSize||s+2*this.paddingH;m&&m!==this.w&&(this.button.w=m>this.defaultWidth?m:this.defaultWidth),_&&_!==this.h&&(this.button.h=_>this.defaultHeight?_:this.defaultHeight)}},{key:"_updateUnderLine",value:function _updateUnderLine(){var o=measureTextWidth(this.buttonTitle.textStyle);this.tag("UnderlineBar").patch({w:o+40,h:1,y:2,alpha:this.showUnderlineBar,color:this.underlineDefaultColor})}},{key:"_updateSpinner",value:function _updateSpinner(){this.buttonUseSpinner?this.buttonSpinner.patch({w:this.buttonSpinnerStyle.w,h:this.buttonSpinnerStyle.h,shader:Object.assign(Object.assign({},this.buttonSpinnerStyle.shader),{type:E.shaders.Spinner2})}):this.buttonSpinner.texture=!1}},{key:"getFillColor",value:function getFillColor(o){return o?this.focusedColor:this.isSelected?this.selectedColor:this.disabled?this.disabledColor:this.color}},{key:"getStroke",value:function getStroke(o){return o?this.focusedStroke:this.isSelected?this.selectedStroke:this.disabled?this.disabledStroke:this.stroke}},{key:"getStrokeColor",value:function getStrokeColor(o){return o?this.focusedStrokeColor:this.isSelected?this.selectedStrokeColor:this.disabled?this.disabledStrokeColor:this.strokeColor}},{key:"getTextStyle",value:function getTextStyle(o){return o?this.buttonFocusedTextButtonStyle:this.isSelected?this.buttonSelectedTextButtonStyle:this.disabled?this.buttonDisabledTextButtonStyle:this.buttonTextButtonStyle}},{key:"fireOnFocus",value:function fireOnFocus(){if("function"==typeof this.onFocus)return this.onFocus()}},{key:"fireOnUnFocus",value:function fireOnUnFocus(){if("function"==typeof this.onUnFocus)return this.onUnFocus()}},{key:"underline",get:function get(){return this.showUnderlineBar},set:function set(o){this.showUnderlineBar=o,this._updateUnderLine()}},{key:"underlineColor",set:function set(o){this.underlineDefaultColor=o}},{key:"underlineFocusColor",set:function set(o){this.underlineFocusedColor=o}},{key:"w",get:function get(){return this.button.w},set:function set(o){o!==this.defaultWidth&&(this.defaultWidth=o,this._update())}},{key:"h",get:function get(){return this.button.h},set:function set(o){o!==this.defaultHeight&&(this.defaultHeight=o,this._update())}},{key:"id",get:function get(){return this.buttonId},set:function set(o){this.buttonId=o}},{key:"title",get:function get(){return this.buttonText},set:function set(o){this.buttonText!==o&&(this.buttonText=o,this._update())}},{key:"textStyle",set:function set(o){o!==this.buttonTextButtonStyle&&(this.buttonTextButtonStyle=o,this._update())}},{key:"focusedStyle",set:function set(o){o!==this.buttonFocusedTextButtonStyle&&(this.buttonFocusedTextButtonStyle=Object.assign(Object.assign({},this.buttonTextButtonStyle),o),this._update())}},{key:"selectedStyle",set:function set(o){o!==this.buttonSelectedTextButtonStyle&&(this.buttonSelectedTextButtonStyle=Object.assign(Object.assign({},this.buttonTextButtonStyle),o),this._update())}},{key:"disabledStyle",set:function set(o){o!==this.buttonDisabledTextButtonStyle&&(this.buttonDisabledTextButtonStyle=Object.assign(Object.assign({},this.buttonTextButtonStyle),o),this._update())}},{key:"textFixedVerticalPosition",get:function get(){return this.buttonTextFixedVerticalPosition},set:function set(o){this.buttonTextFixedVerticalPosition=o,this._updateTitle()}},{key:"paddingW",get:function get(){return this.buttonPaddingW},set:function set(o){this.buttonPaddingW=o}},{key:"paddingH",get:function get(){return this.buttonPaddingH},set:function set(o){this.buttonPaddingH=o}},{key:"useSmooth",get:function get(){return this.useSmoothAnimation},set:function set(o){this.useSmoothAnimation=o}},{key:"color",get:function get(){return this.buttonColor},set:function set(o){this.buttonColor=o,this._update()}},{key:"focusedColor",get:function get(){return this.buttonFocusedColor},set:function set(o){this.buttonFocusedColor=o,this._update()}},{key:"selectedColor",get:function get(){return this.buttonSelectedColor},set:function set(o){this.buttonSelectedColor=o,this._update()}},{key:"disabledColor",get:function get(){return this.buttonDisabledColor},set:function set(o){this.buttonDisabledColor=o,this._update()}},{key:"stroke",get:function get(){return this.buttonStroke},set:function set(o){this.buttonStroke=o,this._update()}},{key:"strokeColor",get:function get(){return this.buttonStrokeColor},set:function set(o){this.buttonStrokeColor=o,this._update()}},{key:"focusedStrokeColor",get:function get(){return this.buttonFocusedStrokeColor},set:function set(o){this.buttonFocusedStrokeColor=o,this._update()}},{key:"label",set:function set(o){this.buttonLabel.patch({text:{text:o}})}},{key:"showLabel",set:function set(o){this.buttonLabel.setSmooth("alpha",o)}},{key:"icon",set:function set(o){this.buttonIconProps=o,this._update()}},{key:"radius",get:function get(){return this.buttonRadius},set:function set(o){this.buttonRadius=o,this._update()}},{key:"disabled",get:function get(){return this.buttonIsDisabled},set:function set(o){this.buttonIsDisabled=o,this._update()}},{key:"route",get:function get(){return this.buttonRoute},set:function set(o){this.buttonRoute=o}},{key:"background",get:function get(){return this.tag("Background")}},{key:"button",get:function get(){return this.tag("Button")}},{key:"buttonContent",get:function get(){return this.tag("Button.Content")}},{key:"buttonSpinner",get:function get(){return this.tag("Button.Spinner")}},{key:"buttonTitle",get:function get(){return this.tag("Button.Content.Title")}},{key:"buttonIcon",get:function get(){return this.tag("Button.Content.Icon")}},{key:"buttonLabel",get:function get(){return this.tag("ButtonLabel")}},{key:"isSelected",get:function get(){return this.buttonIsSelected},set:function set(o){this.buttonIsSelected=o,this._update()}},{key:"focusedStroke",get:function get(){return this.buttonFocusedStroke},set:function set(o){this.buttonFocusedStroke=o,this._updateColor()}},{key:"selectedStroke",get:function get(){return this.buttonSelectedStroke},set:function set(o){this.buttonSelectedStroke=o,this._updateColor()}},{key:"disabledStroke",get:function get(){return this.buttonDisabledStroke},set:function set(o){this.buttonDisabledStroke=o,this._updateColor()}},{key:"selectedStrokeColor",get:function get(){return this.buttonSelectedStrokeColor},set:function set(o){this.buttonSelectedStrokeColor=o,this._updateColor()}},{key:"disabledStrokeColor",get:function get(){return this.buttonDisabledStrokeColor},set:function set(o){this.buttonDisabledStrokeColor=o,this._updateColor()}},{key:"flexDirection",set:function set(o){this.tag("Content").patch({flex:{direction:o}})}},{key:"useSpinner",get:function get(){return this.buttonUseSpinner},set:function set(o){this.buttonUseSpinner=o,this._updateSpinner()}},{key:"spinnerStyle",set:function set(o){this.buttonSpinnerStyle=Object.assign(Object.assign({},this.buttonSpinnerStyle),o)}},{key:"useStrikeThrough",set:function set(o){this.buttonEnableStrikeThrough=o,this._updateTitle()}},{key:"strikeThroughLineHeight",set:function set(o){this.buttonStrikeThroughLineHeight=o}},{key:"contentAlpha",get:function get(){return this.buttonContentAlpha},set:function set(o){this.buttonContentAlpha=o,this._updateTitle()}}],[{key:"_template",value:function _template(){return{Button:{w:150,h:78,Background:{w:function w(o){return o},h:function h(o){return o},rect:!0,shader:{type:E.shaders.RoundedRectangle,radius:10}},Content:{mount:.5,x:function x(o){return o/2},y:function y(o){return o/2},flex:{direction:"row",alignContent:"center",alignItems:"center"},Icon:{},Title:{y:2,alpha:0,type:KE,enableStrikeThrough:!1},UnderlineBar:{y:4,alpha:0,color:4290296257,rect:!0}},Spinner:{x:function x(o){return o/2},y:function y(o){return o/2},w:60,h:60,mount:.5,alpha:0,rect:!0,shader:{type:E.shaders.Spinner2,radius:30,stroke:12,color:4294967295,showDot:!0,period:1,backgroundColor:0}}},ButtonLabel:{x:90,y:85,w:180,h:50,alpha:0,text:{fontFace:"Regular",fontSize:28,textColor:RE}}}}}]),Button}(E.Component);function set$1(o,s,m,_){return set$1="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function set(o,s,m,_){var S,E=_superPropBase(o,s);if(E){if((S=Object.getOwnPropertyDescriptor(E,s)).set)return S.set.call(_,m),!0;if(!S.writable)return!1}if(S=Object.getOwnPropertyDescriptor(_,s)){if(!S.writable)return!1;S.value=m,Object.defineProperty(_,s,S)}else _defineProperty(_,s,m);return!0},set$1(o,s,m,_)}function _set(o,s,m,_,S){if(!set$1(o,s,m,_||o)&&S)throw new TypeError("failed to set property");return m}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(o,s,m){var _=_superPropBase(o,s);if(_){var S=Object.getOwnPropertyDescriptor(_,s);return S.get?S.get.call(arguments.length<3?o:m):S.value}},_get.apply(this,arguments)}function _superPropBase(o,s){for(;!Object.prototype.hasOwnProperty.call(o,s)&&null!==(o=_getPrototypeOf(o)););return o}function _inherits(o,s){if("function"!=typeof s&&null!==s)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(s&&s.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),s&&_setPrototypeOf(o,s)}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}function _createSuper(o){var s=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(o){return!1}}();return function _createSuperInternal(){var m,_=_getPrototypeOf(o);if(s){var S=_getPrototypeOf(this).constructor;m=Reflect.construct(_,arguments,S)}else m=_.apply(this,arguments);return function _possibleConstructorReturn(o,s){if(s&&("object"===_typeof(s)||"function"==typeof s))return s;if(void 0!==s)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(o){if(void 0===o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}(o)}(this,m)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _regeneratorRuntime(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return o};var o={},s=Object.prototype,m=s.hasOwnProperty,_=Object.defineProperty||function(o,s,m){o[s]=m.value},S="function"==typeof Symbol?Symbol:{},E=S.iterator||"@@iterator",A=S.asyncIterator||"@@asyncIterator",O=S.toStringTag||"@@toStringTag";function define(o,s,m){return Object.defineProperty(o,s,{value:m,enumerable:!0,configurable:!0,writable:!0}),o[s]}try{define({},"")}catch(o){define=function define(o,s,m){return o[s]=m}}function wrap(o,s,m,S){var E=s&&s.prototype instanceof Generator?s:Generator,A=Object.create(E.prototype),O=new Context(S||[]);return _(A,"_invoke",{value:makeInvokeMethod(o,m,O)}),A}function tryCatch(o,s,m){try{return{type:"normal",arg:o.call(s,m)}}catch(o){return{type:"throw",arg:o}}}o.wrap=wrap;var H={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var K={};define(K,E,(function(){return this}));var z=Object.getPrototypeOf,G=z&&z(z(values([])));G&&G!==s&&m.call(G,E)&&(K=G);var q=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(K);function defineIteratorMethods(o){["next","throw","return"].forEach((function(s){define(o,s,(function(o){return this._invoke(s,o)}))}))}function AsyncIterator(o,s){function invoke(_,S,E,A){var O=tryCatch(o[_],o,S);if("throw"!==O.type){var H=O.arg,K=H.value;return K&&"object"==_typeof(K)&&m.call(K,"__await")?s.resolve(K.__await).then((function(o){invoke("next",o,E,A)}),(function(o){invoke("throw",o,E,A)})):s.resolve(K).then((function(o){H.value=o,E(H)}),(function(o){return invoke("throw",o,E,A)}))}A(O.arg)}var S;_(this,"_invoke",{value:function value(o,m){function callInvokeWithMethodAndArg(){return new s((function(s,_){invoke(o,m,s,_)}))}return S=S?S.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(o,s,m){var _="suspendedStart";return function(S,E){if("executing"===_)throw new Error("Generator is already running");if("completed"===_){if("throw"===S)throw E;return{value:void 0,done:!0}}for(m.method=S,m.arg=E;;){var A=m.delegate;if(A){var O=maybeInvokeDelegate(A,m);if(O){if(O===H)continue;return O}}if("next"===m.method)m.sent=m._sent=m.arg;else if("throw"===m.method){if("suspendedStart"===_)throw _="completed",m.arg;m.dispatchException(m.arg)}else"return"===m.method&&m.abrupt("return",m.arg);_="executing";var K=tryCatch(o,s,m);if("normal"===K.type){if(_=m.done?"completed":"suspendedYield",K.arg===H)continue;return{value:K.arg,done:m.done}}"throw"===K.type&&(_="completed",m.method="throw",m.arg=K.arg)}}}function maybeInvokeDelegate(o,s){var m=s.method,_=o.iterator[m];if(void 0===_)return s.delegate=null,"throw"===m&&o.iterator.return&&(s.method="return",s.arg=void 0,maybeInvokeDelegate(o,s),"throw"===s.method)||"return"!==m&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+m+"' method")),H;var S=tryCatch(_,o.iterator,s.arg);if("throw"===S.type)return s.method="throw",s.arg=S.arg,s.delegate=null,H;var E=S.arg;return E?E.done?(s[o.resultName]=E.value,s.next=o.nextLoc,"return"!==s.method&&(s.method="next",s.arg=void 0),s.delegate=null,H):E:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,H)}function pushTryEntry(o){var s={tryLoc:o[0]};1 in o&&(s.catchLoc=o[1]),2 in o&&(s.finallyLoc=o[2],s.afterLoc=o[3]),this.tryEntries.push(s)}function resetTryEntry(o){var s=o.completion||{};s.type="normal",delete s.arg,o.completion=s}function Context(o){this.tryEntries=[{tryLoc:"root"}],o.forEach(pushTryEntry,this),this.reset(!0)}function values(o){if(o){var s=o[E];if(s)return s.call(o);if("function"==typeof o.next)return o;if(!isNaN(o.length)){var _=-1,S=function next(){for(;++_<o.length;)if(m.call(o,_))return next.value=o[_],next.done=!1,next;return next.value=void 0,next.done=!0,next};return S.next=S}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,_(q,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),_(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,O,"GeneratorFunction"),o.isGeneratorFunction=function(o){var s="function"==typeof o&&o.constructor;return!!s&&(s===GeneratorFunction||"GeneratorFunction"===(s.displayName||s.name))},o.mark=function(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,GeneratorFunctionPrototype):(o.__proto__=GeneratorFunctionPrototype,define(o,O,"GeneratorFunction")),o.prototype=Object.create(q),o},o.awrap=function(o){return{__await:o}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,A,(function(){return this})),o.AsyncIterator=AsyncIterator,o.async=function(s,m,_,S,E){void 0===E&&(E=Promise);var A=new AsyncIterator(wrap(s,m,_,S),E);return o.isGeneratorFunction(m)?A:A.next().then((function(o){return o.done?o.value:A.next()}))},defineIteratorMethods(q),define(q,O,"Generator"),define(q,E,(function(){return this})),define(q,"toString",(function(){return"[object Generator]"})),o.keys=function(o){var s=Object(o),m=[];for(var _ in s)m.push(_);return m.reverse(),function next(){for(;m.length;){var o=m.pop();if(o in s)return next.value=o,next.done=!1,next}return next.done=!0,next}},o.values=values,Context.prototype={constructor:Context,reset:function reset(o){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!o)for(var s in this)"t"===s.charAt(0)&&m.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=void 0)},stop:function stop(){this.done=!0;var o=this.tryEntries[0].completion;if("throw"===o.type)throw o.arg;return this.rval},dispatchException:function dispatchException(o){if(this.done)throw o;var s=this;function handle(m,_){return E.type="throw",E.arg=o,s.next=m,_&&(s.method="next",s.arg=void 0),!!_}for(var _=this.tryEntries.length-1;_>=0;--_){var S=this.tryEntries[_],E=S.completion;if("root"===S.tryLoc)return handle("end");if(S.tryLoc<=this.prev){var A=m.call(S,"catchLoc"),O=m.call(S,"finallyLoc");if(A&&O){if(this.prev<S.catchLoc)return handle(S.catchLoc,!0);if(this.prev<S.finallyLoc)return handle(S.finallyLoc)}else if(A){if(this.prev<S.catchLoc)return handle(S.catchLoc,!0)}else{if(!O)throw new Error("try statement without catch or finally");if(this.prev<S.finallyLoc)return handle(S.finallyLoc)}}}},abrupt:function abrupt(o,s){for(var _=this.tryEntries.length-1;_>=0;--_){var S=this.tryEntries[_];if(S.tryLoc<=this.prev&&m.call(S,"finallyLoc")&&this.prev<S.finallyLoc){var E=S;break}}E&&("break"===o||"continue"===o)&&E.tryLoc<=s&&s<=E.finallyLoc&&(E=null);var A=E?E.completion:{};return A.type=o,A.arg=s,E?(this.method="next",this.next=E.finallyLoc,H):this.complete(A)},complete:function complete(o,s){if("throw"===o.type)throw o.arg;return"break"===o.type||"continue"===o.type?this.next=o.arg:"return"===o.type?(this.rval=this.arg=o.arg,this.method="return",this.next="end"):"normal"===o.type&&s&&(this.next=s),H},finish:function finish(o){for(var s=this.tryEntries.length-1;s>=0;--s){var m=this.tryEntries[s];if(m.finallyLoc===o)return this.complete(m.completion,m.afterLoc),resetTryEntry(m),H}},catch:function _catch(o){for(var s=this.tryEntries.length-1;s>=0;--s){var m=this.tryEntries[s];if(m.tryLoc===o){var _=m.completion;if("throw"===_.type){var S=_.arg;resetTryEntry(m)}return S}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(o,s,m){return this.delegate={iterator:values(o),resultName:s,nextLoc:m},"next"===this.method&&(this.arg=void 0),H}},o}function asyncGeneratorStep(o,s,m,_,S,E,A){try{var O=o[E](A),H=O.value}catch(o){return void m(o)}O.done?s(H):Promise.resolve(H).then(_,S)}function _asyncToGenerator(o){return function(){var s=this,m=arguments;return new Promise((function(_,S){var E=o.apply(s,m);function _next(o){asyncGeneratorStep(E,_,S,_next,_throw,"next",o)}function _throw(o){asyncGeneratorStep(E,_,S,_next,_throw,"throw",o)}_next(void 0)}))}}function _toConsumableArray(o){return function _arrayWithoutHoles(o){if(Array.isArray(o))return _arrayLikeToArray(o)}(o)||function _iterableToArray(o){if("undefined"!=typeof Symbol&&null!=o[Symbol.iterator]||null!=o["@@iterator"])return Array.from(o)}(o)||_unsupportedIterableToArray(o)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ownKeys(o,s){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(o);s&&(_=_.filter((function(s){return Object.getOwnPropertyDescriptor(o,s).enumerable}))),m.push.apply(m,_)}return m}function _objectSpread(o){for(var s=1;s<arguments.length;s++){var m=null!=arguments[s]?arguments[s]:{};s%2?ownKeys(Object(m),!0).forEach((function(s){_defineProperty(o,s,m[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):ownKeys(Object(m)).forEach((function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(m,s))}))}return o}function _defineProperty(o,s,m){return(s=_toPropertyKey(s))in o?Object.defineProperty(o,s,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[s]=m,o}function _slicedToArray(o,s){return function _arrayWithHoles(o){if(Array.isArray(o))return o}(o)||function _iterableToArrayLimit(o,s){var m=null==o?null:"undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(null!=m){var _,S,E,A,O=[],H=!0,K=!1;try{if(E=(m=m.call(o)).next,0===s){if(Object(m)!==m)return;H=!1}else for(;!(H=(_=E.call(m)).done)&&(O.push(_.value),O.length!==s);H=!0);}catch(o){K=!0,S=o}finally{try{if(!H&&null!=m.return&&(A=m.return(),Object(A)!==A))return}finally{if(K)throw S}}return O}}(o,s)||_unsupportedIterableToArray(o,s)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,s){if(o){if("string"==typeof o)return _arrayLikeToArray(o,s);var m=Object.prototype.toString.call(o).slice(8,-1);return"Object"===m&&o.constructor&&(m=o.constructor.name),"Map"===m||"Set"===m?Array.from(o):"Arguments"===m||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m)?_arrayLikeToArray(o,s):void 0}}function _arrayLikeToArray(o,s){(null==s||s>o.length)&&(s=o.length);for(var m=0,_=new Array(s);m<s;m++)_[m]=o[m];return _}function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _classCallCheck(o,s){if(!(o instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,_toPropertyKey(_.key),_)}}function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}function _toPropertyKey(o){var s=function _toPrimitive(o,s){if("object"!==_typeof(o)||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!==_typeof(_))return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(o,"string");return"symbol"===_typeof(s)?s:String(s)}E.Component;var WE=new(function(){function Logger(){_classCallCheck(this,Logger),this._logCallback=void 0,this._prefix="LightningUI",this._debug=!1}return _createClass(Logger,[{key:"debug",get:function get(){return this._debug},set:function set(o){this._debug=Boolean(o)}},{key:"logCallback",get:function get(){return this._logCallback},set:function set(o){"function"==typeof o?this._logCallback=o:this.warn("logCallback value must be a function, instead received ".concat(_typeof(o)))}},{key:"log",value:function log(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];var _;this._logCallback&&this._logCallback({level:"log",payload:s}),this.debug&&(_=console).log.apply(_,[this._prefix].concat(s))}},{key:"info",value:function info(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];var _;this._logCallback&&this._logCallback({level:"info",payload:s}),this.debug&&(_=console).info.apply(_,[this._prefix].concat(s))}},{key:"warn",value:function warn(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];var _;this._logCallback&&this._logCallback({level:"warn",payload:s}),this.debug&&(_=console).warn.apply(_,[this._prefix].concat(s))}},{key:"error",value:function error(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];var _;this._logCallback&&this._logCallback({level:"error",payload:s}),this.debug&&(_=console).error.apply(_,[this._prefix].concat(s))}}]),Logger}());function debounce$1(o,s,m){var _,S,E,A,O;function later(){var H=Date.now()-A;H<s&&H>=0?_=setTimeout(later,s-H):(_=null,m||(O=o.apply(E,S),E=S=null))}null==s&&(s=100);var H=function debounced(){E=this,S=arguments,A=Date.now();var H=m&&!_;return _||(_=setTimeout(later,s)),H&&(O=o.apply(E,S),E=S=null),O};return H.clear=function(){_&&(clearTimeout(_),_=null)},H.flush=function(){_&&(O=o.apply(E,S),E=S=null,clearTimeout(_),_=null)},H}function getEuclideanDistance(o,s,m,_){var S=o-m,E=s-_;return Math.sqrt(Math.pow(S,2)+Math.sqrt(Math.pow(E,2)))}function isComponentOnScreen(o){if(!o)return!1;var s=o.w,m=o.h,_=o.core,S=void 0===_?{}:_,E=S.renderContext,A=E.px,O=E.py,H=S._scissor,K=void 0===H?[]:H,z=o.stage.h/o.stage.getRenderPrecision(),G=o.stage.w/o.stage.getRenderPrecision();if(!(A>=0&&A+s<=G&&O>=0&&O+m<=z))return!1;if(K&&K.length){var q=_slicedToArray(K,4),X=q[0],J=void 0===X?null:X,ae=q[1],pe=void 0===ae?null:ae,me=q[2],_e=void 0===me?null:me,Se=q[3],Ee=void 0===Se?null:Se,De=Math.round(A+s)>=Math.round(J),$e=Math.round(A)<=Math.round(J+_e),He=Math.round(O+m)>=Math.round(pe),et=Math.round(O+m)<=Math.round(pe+Ee);return De&&$e&&He&&et}return!0}function getWidthByUpCount(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,m=o.layout.screenW,_=o.layout.columnCount,S=o.layout.marginX,E=o.layout.gutterX.xs;if(!(s<1||s>_))return(m-2*S-(s-1)*E)/s;console.error("Column expects a number between 1 & ".concat(_,". Received ").concat(s))}function getWidthByColumnSpan(o,s){var m=o.layout.columnCount,_=o.layout.gutterX.xs;return getWidthByUpCount(o,m)*s+_*(s-1)}function getDimensions(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_=s.w,S=s.h,E=s.ratioX,A=s.ratioY,O=s.upCount,H=m.w||0,K=m.h||0,z={};return z=_&&S?{w:_,h:S}:S&&E&&A?{w:Math.round(S*E/A),h:S}:E&&A&&O?function getItemRatioDimensions(o,s,m,_){var S,E;return s&&m&&_?(S=Math.round(getWidthByUpCount(o,_)),E=Math.round(S/s*m)):(S=0,E=0),{w:S,h:E}}(o,E,A,O):S&&O?{w:Math.round(getWidthByUpCount(o,O)),h:S}:S?{w:H,h:S}:_?{w:_,h:K}:{w:H,h:K},_objectSpread(_objectSpread({},z),{},{ratioX:E,ratioY:A,upCount:O})}function getHexColor(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!o)return 0;"number"==typeof o&&(o=o.toString(16).slice(2)),o=o.replace("#","");var m=Math.round(255*s).toString(16),_="0x".concat(m).concat(o);return Number(_)}function getValidColor(o){if(/^0x[0-9a-fA-F]{8}/g.test(o))return Number(o);if(/^#[0-9a-fA-F]{6}/g.test(o))return getHexColor(o.substr(1,6));if("string"==typeof o&&/^[0-9]{8,10}/g.test(o))return parseInt(o);if("number"==typeof o&&/^[0-9]{8,10}/g.test(o.toString()))return o;if("string"==typeof o&&o.indexOf("rgba")>-1)return rgba2argb(o);if("string"==typeof o&&o.indexOf("rgb")>-1){var s=[].concat(_toConsumableArray(o.replace(/rgb\(|\)/g,"").split(",")),["255"]);return E.StageUtils.getArgbNumber(s)}return null}function reduceFraction(o){return function simplifyFraction(o){for(var s=_slicedToArray(o,2),m=s[0],_=s[1],S=m;S>0;S--)if(!(m%S||_%S))return[m/S,_/S]}(o.split("/").map((function(o){return+o}))).join("/")}var GE=function getValFromObjPath(o,s){return"string"==typeof s&&(s=s.split(".").filter((function(o){return o.length}))),s.reduce((function(o,s){return o&&o[s]}),o)};function rgba2argb(o){var s=o.replace(/rgba\(|\)/g,"").split(",");return s[3]=255*s[3],E.StageUtils.getArgbNumber(s)}function capitalizeFirstLetter(o){return o.charAt(0).toUpperCase()+o.slice(1)}var qE={getWidth:function getWidth(o){var s=_objectSpread({padding:0,paddingLeft:0,paddingRight:0,strokeWidth:0},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),m=s.padding,_=s.paddingLeft,S=s.paddingRight,E=s.strokeWidth;return o?o-(_||m)-(S||m)-E:0},getHeight:function getHeight(o){var s=_objectSpread({padding:0,paddingBottom:0,paddingTop:0,strokeWidth:0},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),m=s.padding,_=s.paddingBottom,S=s.paddingTop,E=s.strokeWidth;return o?o-(_||m)-(S||m)-E:0}};function clone(o,s){var m=Object.create(Object.getPrototypeOf(o));if(Object.defineProperties(m,Object.getOwnPropertyDescriptors(o)),!s||o===s)return m;for(var _ in s){var S=s[_];o.hasOwnProperty(_)?m[_]=getMergeValue(_,o,s):m[_]=S}return m}function getMergeValue(o,s,m){var _=s[o],S=m[o],E=_typeof(_),A=_typeof(S);return E!==A||"function"===A||Array.isArray(S)?S:S&&"object"===A?clone(_,S):S}function getDimension(o,s){if(!s)return 0;var m=s.transition(o);return m.isRunning()?m.targetValue:s[o]}var XE=getDimension.bind(null,"x"),YE=getDimension.bind(null,"y");function flatten$1(o){return o.reduce((function(o,s){return o.concat(Array.isArray(s)?flatten$1(s):s)}),[])}function stringifyCompare(o,s){return JSON.stringify(o)===JSON.stringify(s)}function delayForAnimation(o){setTimeout(o,arguments.length>1&&void 0!==arguments[1]?arguments[1]:16)}var QE=function degreesToRadians(o){return o*(Math.PI/180)},JE=/({ICON.*?}|{BADGE:.*?}|{NEWLINE}|{TEXT:.*?})/g;function max(){if(arguments){var o=Array.from(arguments).filter((function(o){return!isNaN(o)&&null!=o}));if(o.length)return Math.max.apply(Math,_toConsumableArray(o))}}function watchForUpdates(o){var s,m=o.element,_=o.watchProps,S=void 0===_?[]:_,E=o.sideEffect,A=void 0===E?function(){}:E;null!=m&&m.isElement||WE.error("watchForUpdates: Expected a Lightning Element passed to element parameter, received ".concat(_typeof(m)));var O=null===(s=m.__core)||void 0===s?void 0:s._onAfterUpdate;return m.onAfterUpdate=function(o){var s=!1;S.forEach((function(m){if(!o.transition(m)||!o.transition(m).isRunning()){var _="__watchPrev".concat(m),S=o[m];S!==o[_]&&(o[_]=S,s=!0)}})),s&&A(),O&&O(o)}.bind(this),m}var ZE,eI={isMarkupString:function isMarkupString(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"string"==typeof o&&JE.test(o)},capitalizeFirstLetter:capitalizeFirstLetter,degreesToRadians:QE,downloadFile:function downloadFile(o,s,m){["plain","json"].includes(m)||(m="plain");var _="data:text/".concat(m,";charset=utf-8,")+encodeURIComponent(JSON.stringify(o)),S=document.createElement("a");S.setAttribute("href",_),S.setAttribute("download",s),S.click()},delayForAnimation:delayForAnimation,stringifyCompare:stringifyCompare,objectPropertyOf:function objectPropertyOf(o,s){return s.reduce((function(o,s){return o&&"undefined"!==o[s]?o[s]:void 0}),o)},flatten:flatten$1,getDimension:getDimension,getFirstNumber:function getFirstNumber(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return s.find(Number.isFinite)},measureTextWidth:function measureTextWidth(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=document.createElement("canvas").getContext("2d"),m=o.fontStyle,_=o.fontWeight,S=o.fontSize,E=o.fontFamily,A=void 0===E?o.fontFace||"sans-serif":E,O=[m,_,S?"".concat(S,"px"):"0","'".concat(A,"'")].filter(Boolean).join(" ");s.font=O;var H=s.measureText(o.text||"");return Math.round(H.width)},clone:clone,getMergeValue:getMergeValue,RoundRect:qE,rgba2argb:rgba2argb,getValFromObjPath:GE,reduceFraction:reduceFraction,getValidColor:getValidColor,getHexColor:getHexColor,getAspectRatioH:function getAspectRatioH(o){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:":",m=_slicedToArray((arguments.length>1&&void 0!==arguments[1]?arguments[1]:"16:9").split(s),2);return o/(m[0]/m[1])},getAspectRatioW:function getAspectRatioW(o){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:":",m=_slicedToArray((arguments.length>1&&void 0!==arguments[1]?arguments[1]:"16:9").split(s),2);return o*(m[0]/m[1])},getWidthByUpCount:getWidthByUpCount,getDimensions:getDimensions,getWidthByColumnSpan:getWidthByColumnSpan,createConditionalZContext:function createConditionalZContext(o,s){o.zIndex||void 0===s||0===s||(o.forceZIndexContext=!0,o.zIndex=0)},watchForUpdates:watchForUpdates,convertTextAlignToFlexJustify:function convertTextAlignToFlexJustify(o){switch(o){case"left":return"flex-start";case"center":return"center";case"right":return"flex-end";default:return console.warn('Expected "textAlign" values are "left," "center," and "right," but instead, '.concat(o,' was received and will fall back to "left."')),"flex-start"}}},tI=new(function(){function Metrics(){_classCallCheck(this,Metrics),this._keyMetricsCallback=void 0}return _createClass(Metrics,[{key:"keyMetricsCallback",get:function get(){return this._keyMetricsCallback},set:function set(o){-1<["undefined","function"].indexOf(_typeof(o))?this._keyMetricsCallback=o:WE.warn("context keyMetricsCallback expected a function. Received ".concat(_typeof(o)))}}]),Metrics}()),nI=new E.EventEmitter,rI={name:"Base Lightning TV",alpha:{primary:1,secondary:.7,tertiary:.1,inactive:.5,full:1,none:0,alpha1:.1,alpha2:.3,alpha3:.5,alpha4:.7,alpha5:.9},animation:{duration:{none:0,xfast:.1,fast:.25,normal:.5,slow:.75,xslow:.9},delay:{none:0,xfast:.01,fast:.025,normal:.05,slow:.075,xslow:.09},expressive:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},expressiveEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},expressiveExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standard:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standardEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},standardExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utility:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utilityEntrance:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25},utilityExit:{timingFunction:"cubic-bezier(0, 0, 1, 1)",delay:0,duration:.25}},asset:{arrowLeft:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAi0lEQVRIDWNgGAWjIfD//38JID5Fk5AAGqwKxPeA+D/VLQCaaQLEr0CGgwBVLQCa5wbEn0EGwwDVLAAaGA3Ev2AGw2iqWAA0rBiI/8EMRaYptgBoWDeygehsci1gIlcjWfqArqZdEMFcBLSEdpGMZAntkimSJbTLaEiW0K6oQLKEdoUdzJJRemiHAAD4n+yzPWCs7QAAAABJRU5ErkJggg==",arrowRight:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGKADAAQAAAABAAAAGAAAAADiNXWtAAAAg0lEQVRIDWNgGAWjIYArBP7//38KiCVwyVMsDjQcBO4BsSrFhmEzAGw8hHgFpEywqaFIDMkCEPMzELtRZCC6ZjQLQNxfQByNro5sPhYLQEL/gLiYbEORNeKwACbcDVPLBGMMOhrmVDSapkFE00imaTKlaUajaVFB28Ju0CXrUQfhDAEAEgHss6NhpLQAAAAASUVORK5CYII=",backspaceOutline:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAACmpJREFUeF7tnVmoZUcVhv/feY4gBEVEH/KgCCZxCK2itNo4xQQH+kUN0TjEiDGKKBqnaExwBjUaR6KY+NQgiQkOMSYhYEScIopGJOqDE2hHjfP0y4p1Oqdv33v2qr32Prv2Paug6Ye7Vu2qv75TtWvtGohMqUBAAQZ80zUVQAKUEIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypfPsAJJ0NYC92XRHKPB3AAfLv18BuBLAFSR/NKZWswJI0vkA3jCmILsw75sAvIfkR8eo22wAknQSgMvGEGFD8vwxgFeQvGrI+s4CIEnHAPgugHsMWfkNzevDAM4i+Z8h6t88QJLuXOB5yBAVzjxuVeBaAM8ieXNUjzkAdAmA50Yrmv5HKPATACeQ/GNEm6YBkvRyANblZhpHAXsfekpkOGsWIEmPAHA9gDuOo13mWhS4gOSZfdVoEiBJ9wFwA4D7961Y+lUpsK/v7KxVgL4K4ElOCS4l+Uyn7a41k3Q0gMcC2ANgH4CHV1T2OyStx69OzQEk6TwAZztr8lMAx5P8s9N+Y8wk2cTjfQDu66z080h+zml7yKwpgCSdCOByZyX+BuBRJH/otN84M0kWN/s0gOc4Kv8Nko922B1m0gxAkh4I4AcVwcL9JA/UVnjT7CXdHYD9yEzfVUkAjib5uxqNmgCoBAu/CeBhzsJ/kORZTtuNN5Nk70bXAZ0Hy59G8qIawVoB6LMAnu8suE3tH0/y3077NAMg6esAuoaoC0la7M2dJgdI0ssAXOgs8W8BHEvS/s9UoYCkdwN4bYfL5STto7U7TQpQZbDQehzreawHylSpgKSTAVza4XYDyeNqsp4MoB7BwteQfH9N5dL2NgWK3l0vyAdJWhDXnSYBSNLtANh3GO/KwgMk97trlYbbKiDJPpzea5U8JKuYqDIeql0kvQPAG5352ZLMR5L8q9M+zXZQYFcAJOnJAL7sbGWLMFuk2SLOmYIKzB6gEiz8HoB7O7U4meQXnLZp1qGApD8BuOcsh7AewcL3kuyadg4OjSSbhRxH0j4BjJok2Ufga0j+YdQHlcznDlBNsPAa+xpP8r/rEHbxjAKPbRuyHvKFY0Ik6QUALOprPfIT1gHRbAGSdDoA77aSX5Zg4e8nhGfx6FEgWoJn8Zy1QCTplq5vjc3NwnoEC/eQ/HYD8IwC0TbwrA2i2QHUI1h4JskLGoJnUIhWwLMWiGYFkCSLMX2t5WDhlneeLm5Dw5kDntEhkmRhEVvesWNqZgiTdC6AN3W1Svn72oOFkuxF+WcVIQUrai+IKuA5BBHJ453auc1mA1AJFn7Jsf7EKj9ZsLBHw1ZDtI5neAmaBUBzCxaO2cBj5u2FZtlO0l8A3K3ZIaxHsPB8kt5vYn00c/mM0dBj5OmqzAqjOQDUfLBwJ32HbPAh84pCM5seSNJLAHzcWeFJgoVdZRui4YfIo6ucff8uyVY03LW5IawyWPgvW5u77mChV/QIABFfb/kidk0CVKbDth3Huw35dJLeniqiV2/fniDYx1f7vlWTeoUFah6wZQhrqwcqwUKbrtsaH0+6mOQpHsOpbXpCVFPstcJjBZNkmzHv0swQJultAN7iVO375TyafzjtJzcbEaK1w9McQJXBQlvvYmtsfjE5FZUFGAGiSeBpCqDKYKFtmX0qya9Utl0z5gNCNBk8BSA7CtiODNwxjf4trEew8BySNtTNOg0A0aTwtARQTbDQeh3rfawXmn0KQDQ5PC0B9EkAL3LSkAD9X6hWALIJzJ3mNoSdS9I7U3NyuX6zQO+zKOzkEEmaHqDSFdpZM97tOfkSfRvvk0LUDEAFIgseetf85DS+AYgk/bPr1NvRZ2HLg4ektwI4xzmgZCBxYohaBMjWPeenDOcvaIvZ2oez5gAqQ5mtLbb3oa4z+Bb6nTHW1UP92vFIr54vzJ8BcGplGdYKkSRbCXGHSWdh2z1ckp1taGccroxyFt9cznG4iGuDqFmASk9kZxxakNGTckHZBBA1DVCB6BMAXuwhyA4VmGL/+05l6zlsbdt7DJmXU0uXmSQ7JvD2zQ1hiwJJsotRvlVxXO87SU5+heUYDT5Gni5KVhg1D1DphWqCjOYy6RlAYzb0mHn3gWkWABWIaoKMubHwSBpGebGWZNdc2vmUO6a1BhJXFUSSff/yLuOYamvzzwEcVfFr7tWwPXqi6uN2PXWYG0C1Qca1n8RaDlewl3kPRL3gWXo/XBwo1dXWdk/a3jEOnJoVQGUoqw0yvpLkh7oUHvLvTohC8FRANBo8pT3sxLeVJ/M2M4QtiVYTZJzkNPoOiAaBxwHRqPDMFqBS8Jog4yT3YewA0aDwrIBodHhmDVApvG0mtO3PnjTJjTxbIBoFnm0gWgs8pQ06lxY3N4QtCWZBRgPDezdnHvPr+alV2EiaL0DlF2Dbn20bdB40XtHwQ5nOHqAC0SyCjEM1Wkv57AqACkRvBvB2p7hrDzI6yzU7s90EUPNBxtnR4SjwrgGo9EK1Qca8cM4ByU4mkuz++F93ZHELyZX3iW31n+S+sKWZWfNBxkCbNeUq6ekArugo1I0kH1xT8EkBKj1R80HGGkFbtZVkZ3bb2d2r0tUkn1hTh8kBKhB9DMBLnQWfJMjoLFuTZpJsO/ONAB7UUcBLSHqvX781q1YAqg0yfoDkq5psrQYLJeldAF7nKFr1x+wmACq9kAUZLazvvTV4P8kDDlE22kTSQ4uuK9dCF5HuR/I3NYI1A1CBaB+AK50VsAMj7TJeixNl2kYBSccCsB/ZMQ6Brif5GIfdYSZNAVQg8rzsLSphl/Hapby2LDZTUaBcq/56ALb1fOVxLkuinULy4loRmwOoQGQX7T7DWZnPk3y203bXmkl6AIA91isDOBGADV3e1HsJbasA1QYZvUKl3fYKPI2knXFQnZoEqPRCNUHG6oqnwyEFLiJ5Wl89mgWoQFQTZOyrwSb7WUztcSRtu0+v1DRABaKPADijV+3SaZUCNgE5geTNEZnmAFBtkDGix6b4Xld2BNvJcaHUPEClF6oNMoZE2eXOtm3q1ZFha1mfWQBUINoL4Kqurbm7vPEj1bOAqx3udW0kk62+swGoQHQ2gPOGFGAD8roJgF0t+qkx6jorgApElwE4aQwxZp6n3YNxsPyzA7yst/4iSdvEMFqaHUCjKZEZ91IgAeolWzotFEiAkoWQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnT+H0jPT81J3xWWAAAAAElFTkSuQmCC",check:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAOCAYAAAAi2ky3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACtSURBVHgBvdPdDcIgEAfwoy8Nb45QN3AGF2s36Ahu4gpuIDoBfSgfpdoTlCbEWEMh6T8hFzjyg5AAkBHOcQe5UWqspRx435sDpMYj6IYQwwVSEiJ2MKVUBWuzLSLl2HL+uxmNCGFO8yaL7RHxve6qRZoAuS4hxac8735elWVx7jrtMKL1o0Gcat9jhExHSukN/kUIFZ7MpDRtzE1isDRkAUtDvrA8ZI597FUf8gWH9P0b4gko9wAAAABJRU5ErkJggg=="},color:{white:["#ffffff",1],black:["#000000",1],grey:["#929096",1],red:["#e74c3c",1],orange:["#dc7633",1],yellow:["#f7dc6f",1],green:["#2Ecc71",1],blue:["#93a9fd",1],purple:["#663399",1],palette:{"grey-05":["#f8f7fa",1],"grey-40":["#929096",1],"grey-70":["#48474b",1],"grey-90":["#181819",1],"blue-20":["#becffe",1],"blue-40":["#93a9fd",1],"blue-90":["#000033",1]},material:["#181819",1],materialBrand:["#000033",1],overlay:["#181819",.7],textNeutral:["#f8f7fa",1],textNeutralSecondary:["#f8f7fa",.7],textNeutralTertiary:["#f8f7fa",.1],textNeutralDisabled:["#f8f7fa",.5],textInverse:["#181819",1],textInverseSecondary:["#181819",.7],textInverseTertiary:["#181819",.1],textInverseDisabled:["#181819",.5],textBrand:["#93a9fd",1],textBrandSecondary:["#93a9fd",.7],textBrandTertiary:["#93a9fd",.1],textBrandDisabled:["#93a9fd",.5],textPositive:["#2Ecc71",1],textNegative:["#e74c3c",1],textInfo:["#93a9fd",1],textCaution:["#dc7633",1],fillTransparent:["#ffffff",0],fillNeutral:["#f8f7fa",1],fillNeutralSecondary:["#f8f7fa",.7],fillNeutralTertiary:["#f8f7fa",.1],fillNeutralDisabled:["#f8f7fa",.5],fillInverse:["#181819",1],fillInverseSecondary:["#181819",.7],fillInverseTertiary:["#181819",.1],fillInverseDisabled:["#181819",.5],fillBrand:["#93a9fd",1],fillBrandSecondary:["#93a9fd",.7],fillBrandTertiary:["#93a9fd",.1],fillBrandDisabled:["#93a9fd",.5],fillPositive:["#2Ecc71",1],fillNegative:["#e74c3c",1],fillInfo:["#93a9fd",1],fillCaution:["#dc7633",1],strokeNeutral:["#f8f7fa",1],strokeNeutralSecondary:["#f8f7fa",.7],strokeNeutralTertiary:["#f8f7fa",.1],strokeNeutralDisabled:["#f8f7fa",.5],strokeInverse:["#181819",1],strokeInverseSecondary:["#181819",.7],strokeInverseTertiary:["#181819",.1],strokeInverseDisabled:["#181819",.5],strokeBrand:["#93a9fd",1],strokeBrandSecondary:["#93a9fd",.7],strokeBrandTertiary:["#93a9fd",.1],strokeBrandDisabled:["#93a9fd",.5],strokePositive:["#2Ecc71",1],strokeNegative:["#e74c3c",1],strokeInfo:["#93a9fd",1],strokeCaution:["#dc7633",1],interactiveNeutralFocus:["#ffffff",1],interactiveNeutralFocusSoft:["#ffffff",.1],interactiveInverseFocus:["#48474b",1],interactiveInverseFocusSoft:["#48474b",.1],interactiveBrandFocus:["#becffe",1],interactiveBrandFocusSoft:["#becffe",.1],shadowNeutralFocus:["#000000",.7],shadowNeutralFocusSoft:["#000000",.7],shadowInverseFocus:["#000000",.7],shadowInverseFocusSoft:["#000000",.7],shadowBrandFocus:["#000000",.7],shadowBrandFocusSoft:["#000000",.7]},componentConfig:{Keyboard:{style:{keyProps:{delete:{title:null,icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACQCAYAAADnRuK4AAAAAXNSR0IArs4c6QAACmpJREFUeF7tnVmoZUcVhv/feY4gBEVEH/KgCCZxCK2itNo4xQQH+kUN0TjEiDGKKBqnaExwBjUaR6KY+NQgiQkOMSYhYEScIopGJOqDE2hHjfP0y4p1Oqdv33v2qr32Prv2Paug6Ye7Vu2qv75TtWvtGohMqUBAAQZ80zUVQAKUEIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypXMClAyEFEiAQvKlcwKUDIQUSIBC8qVzApQMhBRIgELypfPsAJJ0NYC92XRHKPB3AAfLv18BuBLAFSR/NKZWswJI0vkA3jCmILsw75sAvIfkR8eo22wAknQSgMvGEGFD8vwxgFeQvGrI+s4CIEnHAPgugHsMWfkNzevDAM4i+Z8h6t88QJLuXOB5yBAVzjxuVeBaAM8ieXNUjzkAdAmA50Yrmv5HKPATACeQ/GNEm6YBkvRyANblZhpHAXsfekpkOGsWIEmPAHA9gDuOo13mWhS4gOSZfdVoEiBJ9wFwA4D7961Y+lUpsK/v7KxVgL4K4ElOCS4l+Uyn7a41k3Q0gMcC2ANgH4CHV1T2OyStx69OzQEk6TwAZztr8lMAx5P8s9N+Y8wk2cTjfQDu66z080h+zml7yKwpgCSdCOByZyX+BuBRJH/otN84M0kWN/s0gOc4Kv8Nko922B1m0gxAkh4I4AcVwcL9JA/UVnjT7CXdHYD9yEzfVUkAjib5uxqNmgCoBAu/CeBhzsJ/kORZTtuNN5Nk70bXAZ0Hy59G8qIawVoB6LMAnu8suE3tH0/y3077NAMg6esAuoaoC0la7M2dJgdI0ssAXOgs8W8BHEvS/s9UoYCkdwN4bYfL5STto7U7TQpQZbDQehzreawHylSpgKSTAVza4XYDyeNqsp4MoB7BwteQfH9N5dL2NgWK3l0vyAdJWhDXnSYBSNLtANh3GO/KwgMk97trlYbbKiDJPpzea5U8JKuYqDIeql0kvQPAG5352ZLMR5L8q9M+zXZQYFcAJOnJAL7sbGWLMFuk2SLOmYIKzB6gEiz8HoB7O7U4meQXnLZp1qGApD8BuOcsh7AewcL3kuyadg4OjSSbhRxH0j4BjJok2Ufga0j+YdQHlcznDlBNsPAa+xpP8r/rEHbxjAKPbRuyHvKFY0Ik6QUALOprPfIT1gHRbAGSdDoA77aSX5Zg4e8nhGfx6FEgWoJn8Zy1QCTplq5vjc3NwnoEC/eQ/HYD8IwC0TbwrA2i2QHUI1h4JskLGoJnUIhWwLMWiGYFkCSLMX2t5WDhlneeLm5Dw5kDntEhkmRhEVvesWNqZgiTdC6AN3W1Svn72oOFkuxF+WcVIQUrai+IKuA5BBHJ453auc1mA1AJFn7Jsf7EKj9ZsLBHw1ZDtI5neAmaBUBzCxaO2cBj5u2FZtlO0l8A3K3ZIaxHsPB8kt5vYn00c/mM0dBj5OmqzAqjOQDUfLBwJ32HbPAh84pCM5seSNJLAHzcWeFJgoVdZRui4YfIo6ucff8uyVY03LW5IawyWPgvW5u77mChV/QIABFfb/kidk0CVKbDth3Huw35dJLeniqiV2/fniDYx1f7vlWTeoUFah6wZQhrqwcqwUKbrtsaH0+6mOQpHsOpbXpCVFPstcJjBZNkmzHv0swQJultAN7iVO375TyafzjtJzcbEaK1w9McQJXBQlvvYmtsfjE5FZUFGAGiSeBpCqDKYKFtmX0qya9Utl0z5gNCNBk8BSA7CtiODNwxjf4trEew8BySNtTNOg0A0aTwtARQTbDQeh3rfawXmn0KQDQ5PC0B9EkAL3LSkAD9X6hWALIJzJ3mNoSdS9I7U3NyuX6zQO+zKOzkEEmaHqDSFdpZM97tOfkSfRvvk0LUDEAFIgseetf85DS+AYgk/bPr1NvRZ2HLg4ektwI4xzmgZCBxYohaBMjWPeenDOcvaIvZ2oez5gAqQ5mtLbb3oa4z+Bb6nTHW1UP92vFIr54vzJ8BcGplGdYKkSRbCXGHSWdh2z1ckp1taGccroxyFt9cznG4iGuDqFmASk9kZxxakNGTckHZBBA1DVCB6BMAXuwhyA4VmGL/+05l6zlsbdt7DJmXU0uXmSQ7JvD2zQ1hiwJJsotRvlVxXO87SU5+heUYDT5Gni5KVhg1D1DphWqCjOYy6RlAYzb0mHn3gWkWABWIaoKMubHwSBpGebGWZNdc2vmUO6a1BhJXFUSSff/yLuOYamvzzwEcVfFr7tWwPXqi6uN2PXWYG0C1Qca1n8RaDlewl3kPRL3gWXo/XBwo1dXWdk/a3jEOnJoVQGUoqw0yvpLkh7oUHvLvTohC8FRANBo8pT3sxLeVJ/M2M4QtiVYTZJzkNPoOiAaBxwHRqPDMFqBS8Jog4yT3YewA0aDwrIBodHhmDVApvG0mtO3PnjTJjTxbIBoFnm0gWgs8pQ06lxY3N4QtCWZBRgPDezdnHvPr+alV2EiaL0DlF2Dbn20bdB40XtHwQ5nOHqAC0SyCjEM1Wkv57AqACkRvBvB2p7hrDzI6yzU7s90EUPNBxtnR4SjwrgGo9EK1Qca8cM4ByU4mkuz++F93ZHELyZX3iW31n+S+sKWZWfNBxkCbNeUq6ekArugo1I0kH1xT8EkBKj1R80HGGkFbtZVkZ3bb2d2r0tUkn1hTh8kBKhB9DMBLnQWfJMjoLFuTZpJsO/ONAB7UUcBLSHqvX781q1YAqg0yfoDkq5psrQYLJeldAF7nKFr1x+wmACq9kAUZLazvvTV4P8kDDlE22kTSQ4uuK9dCF5HuR/I3NYI1A1CBaB+AK50VsAMj7TJeixNl2kYBSccCsB/ZMQ6Brif5GIfdYSZNAVQg8rzsLSphl/Hapby2LDZTUaBcq/56ALb1fOVxLkuinULy4loRmwOoQGQX7T7DWZnPk3y203bXmkl6AIA91isDOBGADV3e1HsJbasA1QYZvUKl3fYKPI2knXFQnZoEqPRCNUHG6oqnwyEFLiJ5Wl89mgWoQFQTZOyrwSb7WUztcSRtu0+v1DRABaKPADijV+3SaZUCNgE5geTNEZnmAFBtkDGix6b4Xld2BNvJcaHUPEClF6oNMoZE2eXOtm3q1ZFha1mfWQBUINoL4Kqurbm7vPEj1bOAqx3udW0kk62+swGoQHQ2gPOGFGAD8roJgF0t+qkx6jorgApElwE4aQwxZp6n3YNxsPyzA7yst/4iSdvEMFqaHUCjKZEZ91IgAeolWzotFEiAkoWQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnROgJKBkAIJUEi+dE6AkoGQAglQSL50ToCSgZACCVBIvnT+H0jPT81J3xWWAAAAAElFTkSuQmCC"}}}}},font:[],layout:{screenW:1920,screenH:1080,columnCount:10,marginX:150,marginY:150,safe:50,gutterX:{xs:20,sm:40,md:60,lg:80,xl:100},gutterY:{xs:20,sm:40,md:60,lg:80,xl:100},focusScale:1.2},radius:{none:0,xs:2,sm:4,md:8,lg:16,xl:24},spacer:{xxs:2,xs:4,sm:8,md:10,lg:20,xl:30,xxl:40,xxxl:50},stroke:{sm:2,md:4,lg:6,xl:8},typography:{display1:{fontFamily:"Arial",fontSize:75,lineHeight:85,fontStyle:"500",verticalAlign:"middle",textBaseline:"bottom"},display2:{fontFamily:"Arial",fontSize:50,lineHeight:60,fontStyle:"500",verticalAlign:"middle",textBaseline:"bottom"},headline1:{fontFamily:"Arial",fontSize:35,fontStyle:"500",lineHeight:48,verticalAlign:"middle",textBaseline:"bottom"},headline2:{fontFamily:"Arial",fontSize:30,fontStyle:"500",lineHeight:40,verticalAlign:"middle",textBaseline:"bottom"},headline3:{fontFamily:"Arial",fontSize:25,fontStyle:"500",lineHeight:36,verticalAlign:"middle",textBaseline:"bottom"},body1:{fontFamily:"Arial",fontSize:25,fontStyle:"300",lineHeight:40,verticalAlign:"middle",textBaseline:"bottom"},body2:{fontFamily:"Arial",fontSize:22,fontStyle:"300",lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},body3:{fontFamily:"Arial",fontSize:20,fontStyle:"300",lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},button1:{fontFamily:"Arial",fontSize:25,fontStyle:"500",letterSpacing:-.2,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},button2:{fontFamily:"Arial",fontSize:20,fontStyle:"500",lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},callout1:{fontFamily:"Arial",fontSize:20,fontStyle:"500",letterSpacing:1,lineHeight:32,verticalAlign:"middle",textBaseline:"bottom"},caption1:{fontFamily:"Arial",fontSize:15,fontStyle:"500",lineHeight:24,verticalAlign:"middle",textBaseline:"bottom"}}},iI=[],aI=function fontLoader(o){for(var s=[],m=function _loop(){var m=o[_],S=m.family,E=m.src,A=m.descriptors,O=E&&Array.isArray(E)&&E.length?E.map((function(o){return"local"===o.substr(0,5)?o:"url(".concat(o,")")})).join(","):"url("+E+")",H=new FontFace(S,O,A||{});WE.info("Loading font",S),document.fonts.add(H),s.push(new Promise((function(o){H.load().then((function(){iI.push(H),o(S)})).catch((function(s){o(new Error("".concat(S,": ").concat(s.message)))}))})))},_=0;_<o.length;_++)m();return Promise.all(s).then((function(o){var s=o.filter((function(o){return!(o instanceof Error)})).join(", ");s&&WE.log("Fonts loaded: ".concat(s));var m=o.filter((function(o){return o instanceof Error})).map((function(o){return o.message})).join(", ");m&&WE.error("Unable to load fonts: ".concat(m))}))},oI=function(){var o=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(o){return _regeneratorRuntime().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(!document.fonts||!("delete"in document.fonts)){s.next=6;break}if(iI.length){s.next=3;break}return s.abrupt("return");case 3:iI=iI.filter((function(s){return o.find((function(o){return o.family===s.family}))?s:(WE.info("Removing font",s.family),document.fonts.delete(s),!1)})),s.next=7;break;case 6:WE.info("Unable to remove manually-added fonts");case 7:case"end":return s.stop()}}),_callee)})));return function cleanupFonts(s){return o.apply(this,arguments)}}(),sI={fontFamily:"fontFace"},uI=function all(o){for(var s={},m=0;m<o.length;m++)s=clone(s,o[m]);return s},lI=[],cI=function isSubTheme(o){return"subTheme"===o.slice(0,8)},dI=new(function(){function ThemeManager(){_classCallCheck(this,ThemeManager),this._cache=new Map,"undefined"!=typeof window&&(window.LUI||(window.LUI={}),window.LUI.themeManagerInstances?window.LUI.themeManagerInstances.push({themeManager:this,events:nI}):window.LUI.themeManagerInstances=[{themeManager:this,events:nI}])}var o,s,m,_,S;return _createClass(ThemeManager,[{key:"_setCache",value:function _setCache(o,s){"undefined"!=typeof window&&window.LUI.themeManagerInstances.forEach((function(m){var _=m.themeManager;_&&_._cache.set(o,s)}))}},{key:"_deleteCache",value:function _deleteCache(o){"undefined"!=typeof window&&window.LUI.themeManagerInstances.forEach((function(s){var m=s.themeManager;m&&m._cache.delete(o)}))}},{key:"_emit",value:function _emit(o,s){"undefined"!=typeof window&&window.LUI.themeManagerInstances.forEach((function(m){m.events.emit(o,s)}))}},{key:"getTheme",value:function getTheme(){if(this._cache.has("theme"))return this._cache.get("theme");var o=this._processTheme.call(this);return this._setCache("theme",o),o}},{key:"setTheme",value:(S=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(o){var s,m;return _regeneratorRuntime().wrap((function _callee2$(_){for(;;)switch(_.prev=_.next){case 0:if("object"===_typeof(s=Array.isArray(o)?uI(o):o)&&null!==s){_.next=4;break}return WE.warn("context theme expected an object. Received ".concat(_typeof(s))),_.abrupt("return");case 4:return this._clearCache(),m=this._processTheme.call(this,[s],s.extensions),this._setCache("theme",m),_.next=9,oI(m.font);case 9:if(!m.font||!m.font.length){_.next=12;break}return _.next=12,this._loadFonts(m.font);case 12:return this._refreshSubThemes(),this._emit("themeExtensionsUpdate"),this._emit("themeUpdate"),_.abrupt("return",m);case 16:case"end":return _.stop()}}),_callee2,this)}))),function setTheme(o){return S.apply(this,arguments)})},{key:"getSubTheme",value:function getSubTheme(o){if(this._cache.has("subTheme".concat(o)))return this._cache.get("subTheme".concat(o)).result}},{key:"setSubTheme",value:(_=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(o,s){var m,_,S,E=arguments;return _regeneratorRuntime().wrap((function _callee3$(A){for(;;)switch(A.prev=A.next){case 0:if(m=!(E.length>2&&void 0!==E[2])||E[2],o){A.next=4;break}return WE.warn("Sub theme name not specified"),A.abrupt("return");case 4:if("string"==typeof o){A.next=7;break}return WE.warn("Sub theme name must be a string. Received an ".concat(_typeof(o))),A.abrupt("return");case 7:if("object"===_typeof(s)&&Object.keys(s).length){A.next=10;break}return WE.warn("Could not set subTheme ".concat(o,", value should be an object with properties. Received an ").concat(_typeof(s))),A.abrupt("return");case 10:if(_=this.getTheme(),!(S=this._processTheme.call(this,[_,s])).font||!S.font.length){A.next=15;break}return A.next=15,this._loadFonts(S.font);case 15:return this._setCache("subTheme".concat(o),{original:s,result:S}),m&&this._emit("themeUpdate".concat(o)),A.abrupt("return",S);case 18:case"end":return A.stop()}}),_callee3,this)}))),function setSubTheme(o,s){return _.apply(this,arguments)})},{key:"_refreshSubThemes",value:function _refreshSubThemes(){var o=this;_toConsumableArray(this._cache.keys()).forEach((function(s){if("string"==typeof s&&cI(s)){var m=o._cache.get(s);m.original&&o.updateSubTheme(s.replace(/^subTheme/,""),m.original)}}))}},{key:"_loadFonts",value:(m=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(o){return _regeneratorRuntime().wrap((function _callee4$(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,aI(o);case 3:s.next=8;break;case 5:s.prev=5,s.t0=s.catch(0),WE.error("Unable to load font: ".concat(s.t0));case 8:case"end":return s.stop()}}),_callee4,null,[[0,5]])}))),function _loadFonts(o){return m.apply(this,arguments)})},{key:"updateTheme",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(o){var s,m,_;return _regeneratorRuntime().wrap((function _callee5$(S){for(;;)switch(S.prev=S.next){case 0:if(s=Array.isArray(o)?uI(o):o,m={},this._cache.has("theme")&&(m=this._cache.get("theme")),this._clearCache(),_=this._processTheme.call(this,[m,s],s.extensions||m.extensions),this._setCache("theme",_),!_.font||!_.font.length){S.next=9;break}return S.next=9,this._loadFonts(_.font);case 9:return this._refreshSubThemes(),s.extensions&&this._emit("themeExtensionsUpdate"),this._emit("themeUpdate"),S.abrupt("return",_);case 13:case"end":return S.stop()}}),_callee5,this)}))),function updateTheme(o){return s.apply(this,arguments)})},{key:"_clearCache",value:function _clearCache(){var o=this;lI.filter((function(o){return window.URL&&"function"==typeof window.URL.revokeObjectURL&&URL.revokeObjectURL(o),!1})),this._cache.forEach((function(s,m){"string"==typeof m&&cI(m)||o._deleteCache(m)})),this._cache.forEach((function(s,m){"string"==typeof m&&cI(m)&&o.setSubTheme(m.replace("subTheme",""),s.original,!1)}))}},{key:"updateSubTheme",value:(o=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(o,s){var m,_,S,E,A=arguments;return _regeneratorRuntime().wrap((function _callee6$(O){for(;;)switch(O.prev=O.next){case 0:if(m=!(A.length>2&&void 0!==A[2])||A[2],o){O.next=4;break}return WE.warn("Sub theme name not specified"),O.abrupt("return");case 4:if("object"===_typeof(s)&&Object.keys(s).length){O.next=7;break}return WE.warn("Could not update subTheme ".concat(o," due to invalid value")),O.abrupt("return");case 7:if(_=this.getTheme(),S={},this._cache.has("subTheme".concat(o))&&(S=this._cache.get("subTheme".concat(o)).original),!(E=this._processTheme.call(this,[_,S,s])).font||!E.font.length){O.next=14;break}return O.next=14,this._loadFonts(E.font);case 14:return this._setCache("subTheme".concat(o),{original:clone(S,s),result:E}),m&&this._emit("themeUpdate".concat(o)),O.abrupt("return",E);case 17:case"end":return O.stop()}}),_callee6,this)}))),function updateSubTheme(s,m){return o.apply(this,arguments)})},{key:"removeSubTheme",value:function removeSubTheme(o){this._cache.has("subTheme".concat(o))&&this._deleteCache("subTheme".concat(o)),this._emit("themeUpdate".concat(o))}},{key:"_getComponentUUID",value:function _getComponentUUID(o){return"componentStyle".concat(o)}},{key:"_processTheme",value:function _processTheme(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1?arguments[1]:void 0;if(!Array.isArray(o))throw new Error("context processTheme expected an array. Received ".concat(_typeof(o)));var m=uI([rI].concat(_toConsumableArray(o))),_={},S=JSON.stringify(m,(function(o,s){var S=s;if(S&&"object"===_typeof(S)){var E=s;for(var A in S)Object.hasOwnProperty.call(S,A)&&sI[A]&&(E[A&&sI[A]]=S[A],delete E[A]);S=E}var O=function checkBase64EncodedImage(o){var s=/^data:image\/(jpeg|jpg|png|gif);base64,/,m=s.test(o);return{isImage:m,mimeType:m?function getMimeTypeFromDataUri(o){var s=o.match(/^data:(.*?);base64,/);return s&&2===s.length?s[1]:null}(o.match(s)[0]):null}}(S),H=O.isImage,K=O.mimeType;if(window.URL&&"function"==typeof window.URL.createObjectURL&&H)try{var z=function base64ToBlobURL(o,s){var m=atob(o.substring(o.indexOf(",")+1)),_=[];try{for(var S=0;S<m.length;S+=512){for(var E=m.slice(S,S+512),A=new Array(E.length),O=0;O<E.length;O++)A[O]=E.charCodeAt(O);var H=new Uint8Array(A);_.push(H)}var K=new Blob(_,{type:s});return URL.createObjectURL(K)}catch(o){return WE.info("Unable to convert base64 image to URL"),null}}(S,K);return lI.push(z),z}catch(o){return S}return Array.isArray(S)&&2===S.length&&!S[0].targetComponent&&S[0].length&&"#"===S[0].substr(0,1)?getHexColor(S[0],S[1]):"extensions"===o||"function"==typeof S||"object"===_typeof(S)&&null!==S&&"Object"!==S.constructor.name&&!Array.isArray(S)?void(_[o]=S):"string"==typeof S&&S.includes("theme.")?GE({theme:m},S)||S:getValidColor(S)||S}));return _objectSpread(_objectSpread(_objectSpread({},JSON.parse(S)),_),{},{extensions:s})}}]),ThemeManager}()),hI=new(function(){function Context(){_classCallCheck(this,Context)}return _createClass(Context,[{key:"theme",get:function get(){return dI.getTheme()},set:function set(o){WE.warn("Context.theme must be set using context.setTheme or context.updateTheme")}},{key:"keyMetricsCallback",get:function get(){return tI.keyMetricsCallback},set:function set(o){WE.warn("Context.keyMetricsCallback must be set using context.setKeyMetricsCallback")}},{key:"debug",get:function get(){return WE.debug},set:function set(o){WE.debug=o}},{key:"on",value:function on(){return nI.on.apply(nI,arguments)}},{key:"off",value:function off(){return nI.off.apply(nI,arguments)}},{key:"emit",value:function emit(){return nI.emit.apply(nI,arguments)}},{key:"log",value:function log(){WE.log.apply(WE,arguments)}},{key:"info",value:function info(){WE.info.apply(WE,arguments)}},{key:"warn",value:function warn(){WE.warn.apply(WE,arguments)}},{key:"error",value:function error(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];WE.error(s)}},{key:"setTheme",value:function setTheme(o){return dI.setTheme(o)}},{key:"updateTheme",value:function updateTheme(o){return dI.updateTheme(o)}},{key:"getSubTheme",value:function getSubTheme(o){return dI.getSubTheme(o)}},{key:"setSubThemes",value:function setSubThemes(o){if("object"===_typeof(o))for(var s in o)dI.setSubTheme(s,o[s]);else WE.warn("subThemes must be an object")}},{key:"setSubTheme",value:function setSubTheme(o,s){return dI.setSubTheme(o,s)}},{key:"updateSubTheme",value:function updateSubTheme(o,s){return dI.updateSubTheme(o,s)}},{key:"removeSubTheme",value:function removeSubTheme(o){dI.removeSubTheme(o)}},{key:"setLogCallback",value:function setLogCallback(o){WE.logCallback=o}},{key:"setKeyMetricsCallback",value:function setKeyMetricsCallback(o){tI.keyMetricsCallback=o}},{key:"config",value:function config(){for(var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=Object.keys(o),m=0;m<s.length;m++){var _=this["set"+capitalizeFirstLetter(s[m])];_&&_(o[s[m]])}return this}}]),Context}()),pI=new(function(){function GlobalUpdateManager(){_classCallCheck(this,GlobalUpdateManager),this._updateThemeSet=new Set,this._requestUpdateSet=new Set,this._timeout=null,this._runUpdatesTimeoutHandler=this._runUpdatesTimeoutHandler.bind(this)}return _createClass(GlobalUpdateManager,[{key:"_runUpdatesTimeoutHandler",value:function _runUpdatesTimeoutHandler(){this._timeout=null,this._updateThemeSet.forEach((function(o){try{o._updateThemeComponent()}catch(o){hI.error("Error updating component themes",o)}})),this._updateThemeSet.clear(),this._requestUpdateSet.forEach((function(o){try{o.requestUpdate()}catch(o){hI.error("Error updating component",o)}})),this._requestUpdateSet.clear()}},{key:"flush",value:function flush(){this._timeout&&(clearTimeout(this._timeout),this._runUpdatesTimeoutHandler())}},{key:"addUpdateTheme",value:function addUpdateTheme(o){this._updateThemeSet.add(o),this._timeout||(this._timeout=setTimeout(this._runUpdatesTimeoutHandler,0))}},{key:"deleteUpdateTheme",value:function deleteUpdateTheme(o){this._updateThemeSet.delete(o)}},{key:"addRequestUpdate",value:function addRequestUpdate(o){this._requestUpdateSet.add(o),this._timeout||(this._timeout=setTimeout(this._runUpdatesTimeoutHandler,0))}},{key:"deleteRequestUpdate",value:function deleteRequestUpdate(o){this._requestUpdateSet.delete(o)}}]),GlobalUpdateManager}());function delay(o){return new Promise((function(s){setTimeout(s,o)}))}function speak(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US",_=window.speechSynthesis;return new Promise((function(S,E){var A=new SpeechSynthesisUtterance(o);A.lang=m,A.onend=function(){S()},A.onerror=function(o){E(o)},s.push(A),_.speak(A)}))}function speakSeries(o,s){var m=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],_=window.speechSynthesis,S=function flattenStrings(){for(var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=[],m=0;m<o.length&&"string"==typeof o[m]&&!o[m].includes("PAUSE-");m++)s.push(o[m]);return[s.join(",\b ")].concat(o.slice(m))}(Array.isArray(o)?o:[o]),E=[],A=[],O=!0;return{series:_asyncToGenerator(_regeneratorRuntime().mark((function _callee7(){var o,m,_,H,K,z;return _regeneratorRuntime().wrap((function _callee7$(G){for(;;)switch(G.prev=G.next){case 0:G.prev=0;case 1:if(!O||!S.length){G.next=62;break}return G.next=4,Promise.resolve(S.shift());case 4:if(o=G.sent,O){G.next=9;break}return G.abrupt("break",62);case 9:if("string"!=typeof o||!o.includes("PAUSE-")){G.next=16;break}return m=1e3*o.split("PAUSE-")[1],isNaN(m)&&(m=0),G.next=14,delay(m);case 14:G.next=60;break;case 16:if("string"!=typeof o||!o.length){G.next=48;break}H=_=3;case 19:if(!(O&&H>0)){G.next=46;break}return G.prev=20,G.next=23,speak(o,A,s);case 23:H=0,G.next=44;break;case 26:if(G.prev=26,G.t0=G.catch(20),!(G.t0 instanceof SpeechSynthesisErrorEvent)){G.next=43;break}if("network"!==G.t0.error){G.next=36;break}return H--,console.warn("Speech synthesis network error. Retries left: ".concat(H)),G.next=34,delay(500*(_-H));case 34:G.next=41;break;case 36:if("canceled"!==G.t0.error&&"interrupted"!==G.t0.error){G.next=40;break}H=0,G.next=41;break;case 40:throw new Error("SpeechSynthesisErrorEvent: ".concat(G.t0.error));case 41:G.next=44;break;case 43:throw G.t0;case 44:G.next=19;break;case 46:G.next=60;break;case 48:if("function"!=typeof o){G.next=55;break}return K=speakSeries(o(),s,!1),E.push(K),G.next=53,K.series;case 53:G.next=60;break;case 55:if(!Array.isArray(o)){G.next=60;break}return z=speakSeries(o,s,!1),E.push(z),G.next=60,z.series;case 60:G.next=1;break;case 62:return G.prev=62,O=!1,G.finish(62);case 65:case"end":return G.stop()}}),_callee7,null,[[0,,62,65],[20,26]])})))(),get active(){return O},append:function append(o){S.push(o)},cancel:function cancel(){O&&(m&&_.cancel(),E.forEach((function(o){o.cancel()})),O=!1)}}}function Speech(o,s){return ZE&&ZE.cancel(),ZE=speakSeries(o,s)}var fI=[{pattern:"TV-14",replacer:"Rated TV-14"},{pattern:"CC",replacer:"Closed Captions available"},{pattern:"HD",replacer:"High Definition available"},{pattern:/ENG(?!\+)/,replacer:"English Available"},{pattern:/ENG\+ES/,replacer:"Available in English and Spanish"},{pattern:"AD",replacer:"Audio Description available"},{pattern:"RT",replacer:"Rotten Tomatoes"},{pattern:/(S)+(\d+)+(E)+(\d+)+/,replacer:function replacer(o,s,m,_,S){return"Season ".concat(m," Episode ").concat(S)}}];function wrapWithBoundary(o){return"\\b".concat(o,"\\b")}!function generateAbbrevConfig(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fI,s=(arguments.length>1?arguments[1]:void 0)?[].concat(fI,_toConsumableArray(o)):o,m={},_={},S="",E=0;return s.forEach((function(o,s){var A,O=o.pattern,H=o.replacer;O instanceof RegExp?(_[s+E]={pattern:O,replacer:H},A=wrapWithBoundary(O.source),E+=function getNumberOfCaptureGroups(o){return new RegExp(o.toString()+"|").exec("").length-1}(O)):(m[O]={replacer:H},A=wrapWithBoundary(O)),S=""===S?"(".concat(A,")"):"".concat(S,"|(").concat(A,")")})),{abbreviationsPattern:S=new RegExp(S,"g"),stringPatternMap:m,regExpPatternMap:_}}(fI);var gI=function translateAbbrev(o,s){var m=s.abbreviationsPattern,_=s.stringPatternMap,S=s.regExpPatternMap,E=o.replace(m,(function(o){if(_[o])return _[o].replacer;for(var s=arguments.length,m=new Array(s>1?s-1:0),E=1;E<s;E++)m[E-1]=arguments[E];var A=m.findIndex((function(o){return!!o})),O=S[A],H=O.pattern,K=O.replacer;return"string"==typeof K?K:"function"==typeof K?o.replace(H,K):void 0}));return E};function elmName(o){return o.ref||o.constructor.name}var mI={voiceOutDelay:500,abbreviationsConfig:{}};var yI=function getCharacterValue(o,s){return o.charCodeAt(0)*(s+1)};function executeWithContext(o,s){return"function"==typeof o?o(s):"object"===_typeof(o)?o:{}}function isPlainObject(o){return!("object"!==_typeof(o)||null===o||Array.isArray(o)||o instanceof Date||o instanceof RegExp||o instanceof Function)}var vI=function getSubTheme(o){if(o.subTheme)return o.subTheme;for(var s=o.p;s&&!s.subTheme;)s=s.parent;return s&&s.subTheme},_I=function getComponentConfig(o){if(!isPlainObject(o))return{};var s,m=bI(o);return m?Array.from(m).reverse().reduce((function(s,m){var _;return clone(s,(null==o||null===(_=o.theme)||void 0===_||null===(_=_.componentConfig)||void 0===_?void 0:_[m])||{})}),{}):(null==o||null===(s=o.theme)||void 0===s||null===(s=s.componentConfig)||void 0===s?void 0:s[o.constructor.__componentName])||{}},bI=function getPrototypeChain(o){if(!isPlainObject(o))return[];var s=new Set,m=o;do{null!==(m=Object.getPrototypeOf(m))&&"object"===_typeof(m)&&m.constructor.__componentName&&s.add(m.constructor.__componentName)}while(m);return Array.from(s)};function removeEmptyObjects(o){for(var s in o)o.hasOwnProperty(s)&&"object"===_typeof(o[s])&&null!==o[s]&&(removeEmptyObjects(o[s]),0===Object.keys(o[s]).length&&delete o[s]);if(0!==Object.keys(o).length)return o}var SI=function findPropertiesBySubProperty(o,s){var m=new Set;return function traverse(o){for(var _ in o)if(o.hasOwnProperty(_)&&"object"===_typeof(o[_])){if(_===s)for(var S in o[_])o[_].hasOwnProperty(S)&&m.add(S);traverse(o[_])}}(o),Array.from(m)},TI=function generateComponentStyleSource(o){var s={},m=o.theme;if(!isPlainObject(o))return{};if(wI(o).forEach((function(o){var _=o.style;if("object"!==_typeof(_)||_.base||_.mode||_.tone||_.default){var S=_.base,E=_.mode,A=_.tone;s=clone(s,{base:executeWithContext(S,m)}),s=clone(s,{tone:executeWithContext(A,m)}),s=clone(s,{mode:executeWithContext(E,m)})}else s=clone(s,{base:_})})),o._componentConfig){o._componentConfig.styleConfig&&(hI.info("style config is deprecated. Please use style = { base: {}, tone: {}, mode: {} }"),s=clone(s,o._componentConfig.styleConfig));var _=o._componentConfig.style;null!=_&&_.base&&(s=clone(s,{base:_.base})),_&&(s=clone(s,{overwrite:_})),null!=_&&_.tone&&(s=clone(s,{tone:_.tone})),null!=_&&_.mode&&(s=clone(s,{mode:_.mode}))}if(o._componentLevelStyle){o._componentLevelStyle.styleConfig&&(s=clone(s,o._componentLevelStyle.styleConfig));var S=o._componentLevelStyle;null!=S&&S.base&&(s=clone(s,{base:S.base})),null!=S&&S.tone&&(s=clone(s,{tone:S.tone})),null!=S&&S.mode&&(s=clone(s,{mode:S.mode}))}for(var E=s,A=E.base,O=void 0===A?{}:A,H=E.mode,K=void 0===H?{}:H,z=E.tone,G=void 0===z?{}:z,q=E.overwrite,X=void 0===q?{}:q,J={},ae=SI(K,"tone"),pe=SI(G,"mode"),me=0,_e=_toConsumableArray(new Set(["unfocused"].concat(_toConsumableArray(Object.keys(K)),_toConsumableArray(pe))));me<_e.length;me++)for(var Se=_e[me],Ee=0,De=_toConsumableArray(new Set(["neutral"].concat(_toConsumableArray(Object.keys(G)),_toConsumableArray(ae))));Ee<De.length;Ee++){var $e,He,et=De[Ee],rt=clone(O,G[et]);rt=clone(rt,X),rt=clone(rt,(null===($e=G[et])||void 0===$e||null===($e=$e.mode)||void 0===$e?void 0:$e[Se])||{}),rt=clone(rt,K[Se]),J[Se+"_"+et]=clone(rt,(null===(He=K[Se])||void 0===He||null===(He=He.tone)||void 0===He?void 0:He[et])||{})}return removeEmptyObjects(kI(o,J))||{}},kI=function colorParser(o,s){var m=JSON.stringify(s,(function(s,m){if(!(-1<["tone","mode"].indexOf(s)))return"string"==typeof m&&m.startsWith("theme.")?GE(o,m):Array.isArray(m)&&2===m.length?getHexColor(m[0],m[1]):m}));return JSON.parse(m||{})};function generateNameFromPrototypeChain(o){var s,m;if(!Object.getPrototypeOf(o))return(null===(m=o.constructor)||void 0===m?void 0:m.name)||"";var _=(null===(s=o.constructor)||void 0===s?void 0:s.name)||"",S=generateNameFromPrototypeChain(Object.getPrototypeOf(o));return S?"".concat(S,".").concat(_):_}var CI={},wI=function getStyleChainMemoized(o){var s=generateNameFromPrototypeChain(o);if(CI[s])return CI[s];var m=xI(o);return CI[s]=m,m},xI=function getStyleChain(o){var s=new Set,m=o;do{(m=Object.getPrototypeOf(m))&&m.constructor&&(m.constructor.__mixinStyle&&!s.has(m.constructor.__mixinStyle)&&("object"===_typeof(m.constructor.__mixinStyle)&&Object.keys(m.constructor.__mixinStyle).length||"function"==typeof m.constructor.__mixinStyle)&&s.add(m.constructor.__mixinStyle),m.constructor.__themeStyle&&!s.has(m.constructor.__themeStyle)&&("object"===_typeof(m.constructor.__themeStyle)&&Object.keys(m.constructor.__themeStyle).length||"function"==typeof m.constructor.__themeStyle)&&s.add(m.constructor.__themeStyle))}while(m);return Array.from(s).map((function(o){return{style:o}})).reverse()},EI=function replaceAliasValues(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],m=clone(o,{});return[{prev:"height",curr:"h",skipWarn:!0},{prev:"width",curr:"w",skipWarn:!0}].concat(_toConsumableArray(s)).forEach((function(o){o&&"string"==typeof o.prev&&"string"==typeof o.curr&&m[o.prev]&&(!o.skipWarn&&console.warn('The style property "'.concat(o.prev,'" is deprecated and will be removed in a future release. Please use "').concat(o.curr,'" instead.')),Object.defineProperty(m,o.curr,Object.getOwnPropertyDescriptor(m,o.prev)),delete m[o.prev])})),m},II=new Map;hI.on("themeUpdate",(function(){II.clear()}));var AI=II,PI=function(o){_inherits(StyleManager,E.EventEmitter);var s=_createSuper(StyleManager);function StyleManager(){var o,m=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).component,_=void 0===m?{}:m;return _classCallCheck(this,StyleManager),(o=s.apply(this,arguments)).init(_),o}return _createClass(StyleManager,[{key:"init",value:function init(o){this.isActive=!0,this.component=o,this.setupListeners(),this._style={},this.update()}},{key:"setupListeners",value:function setupListeners(){this._boundThemeUpdate=this._onThemeUpdate.bind(this),this._hasSubTheme=Boolean(this.component._targetSubTheme),this.component._targetSubTheme?hI.on("themeUpdate".concat(this.component._targetSubTheme),this._boundThemeUpdate):hI.on("themeUpdate",this._boundThemeUpdate)}},{key:"clearListeners",value:function clearListeners(){this._boundThemeUpdate&&(this.component._targetSubTheme?hI.off("themeUpdate".concat(this.component._targetSubTheme),this._boundThemeUpdate):hI.off("themeUpdate",this._boundThemeUpdate))}},{key:"destroy",value:function destroy(){this.isActive=!1,this._cleanupCache(),this.clearListeners(),this._styleCache=null,this._boundThemeUpdate=null,this.component=null}},{key:"_onThemeUpdate",value:function _onThemeUpdate(){this.clearSourceCache(),this.clearStyleCache(),this.update()}},{key:"clearSourceCache",value:function clearSourceCache(){if(this.component){var o=this._generateCacheKey("styleSource");this._removeCache(o)}}},{key:"clearStyleCache",value:function clearStyleCache(){if(this.component){var o=this.component,s=o.tone,m=o.mode,_=this._generateCacheKey("style_".concat(m,"_").concat(s));AI.delete(_)}}},{key:"_generateCacheKey",value:function _generateCacheKey(o){return[o,this.component.constructor.__componentName,this._customStyleHash].filter(Boolean).join("_")}},{key:"_addCache",value:function _addCache(o,s){var m=this._generateCacheKey(o),_=AI.get(m);AI.set(m,{ids:_toConsumableArray(new Set([].concat(_toConsumableArray((null==_?void 0:_.ids)||[]),[this.component.__id]))),payload:s})}},{key:"_cleanupCache",value:function _cleanupCache(){var o=this;this.component&&AI.forEach((function(s,m){var _=s.ids,S=s.payload,E=_&&_.length&&_.indexOf(o.component.__id);E>-1&&_.length>1?AI.set(m,{ids:_.slice(0,E).concat(_.slice(E+1)),payload:S}):E>-1&&AI.delete(m)}))}},{key:"_removeCache",value:function _removeCache(o){AI.delete(o)}},{key:"_getCache",value:function _getCache(o){var s=this._generateCacheKey(o);return AI.get(s)}},{key:"update",value:function update(){if(this.component){var o=this.component,s=o.mode,m=o.tone;try{var _,S,E=null===(_=this._getCache("styleSource"))||void 0===_?void 0:_.payload;E||(E=TI(this.component),this._addCache("styleSource",E));var A=null===(S=this._getCache("style_".concat(s,"_").concat(m)))||void 0===S?void 0:S.payload;if(!A){var O=function generateStyle(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!isPlainObject(o))return{};var m=o.mode,_=void 0===m?"unfocused":m,S=o.tone,E=void 0===S?"neutral":S,A=s["".concat(_,"_").concat(E)]||s["unfocused_".concat(E)]||s.unfocused_neutral||{},O=o._componentLevelStyle;return O?clone(A,kI(o,O)):A}(this.component,E),H=new Set;H.add([EI,[this.component.constructor.aliasStyles]]),A=Array.from(H).reduce((function(o,s){var m=_slicedToArray(s,2),_=m[0],S=m[1];return _.apply(void 0,[o].concat(_toConsumableArray(S)))}),O),this._addCache("style_".concat(s,"_").concat(m),O)}this._style=A,this.emit("styleUpdate",this.style)}catch(o){hI.error("styleManager: ",o.message)}}}},{key:"style",get:function get(){return this._style},set:function set(o){hI.warn("styleManager: Cannot mutate style directly")}},{key:"_customStyleHash",get:function get(){if(Boolean(Object.keys(this.component.constructor.__mixinStyle||{}).length)||Boolean(Object.keys(this.component._componentLevelStyle||{}).length))return function getHash(o){return JSON.stringify(o).length+"-"+function getCharacterSum(o){for(var s=JSON.stringify(o),m=0,_=0;_<s.length;_++)m+=yI(s[_],_);return m}(o)}(clone(this.component.constructor.__mixinStyle||{},this.component._componentLevelStyle||{}))}}]),StyleManager}();function capital(o){return o.charAt(0).toUpperCase()+o.slice(1)}var LI="__original";var DI=function withMixins(o){return function withExtensions(o){return o.prototype.constructor._withExtensionsApplied?o:function(s){_inherits(_class10,s);var m=_createSuper(_class10);function _class10(){return _classCallCheck(this,_class10),m.apply(this,arguments)}return _createClass(_class10,[{key:"_prototypeChain",get:function get(){if(this.__prototypeChain)return this.__prototypeChain;var o=new Set,s=this;do{if(null!==(s=Object.getPrototypeOf(s))&&"object"===_typeof(s))try{s.constructor.__componentName&&o.add(s.constructor.__componentName)}catch(o){}}while(s);return this.__prototypeChain=o,o}},{key:"_extensions",get:function get(){var o=hI&&hI.theme&&hI.theme.extensions;return!o||!Array.isArray(o)||Array.isArray(o)&&!o.length?[]:o.filter((function(o){var s=o.targetComponent,m=o.extension;return("string"==typeof s||Array.isArray(s))&&"function"==typeof m})).slice().reverse()||[]}},{key:"_componentExtensions",get:function get(){var o=this;return this._extensions.filter((function(s){var m=s.targetComponent;return"string"==typeof m?m===o.constructor.__componentName||o._prototypeChain.has(m):!!Array.isArray(m)&&m.find((function(s){if(s.startsWith("/")&&s.endsWith("/")){var m=new RegExp(s.slice(1,-1));return Array.from(o._prototypeChain).some((function(o){return m.test(o)}))}return o._prototypeChain.has(s)}))})).reduce((function(o,s){var m=s.extension;return o.push(m),o}),[])}},{key:"_extensionApplied",get:function get(){return this._currentComponentExtensionLength===this._appliedExtensionLength}},{key:"_construct",value:function _construct(){this._appliedExtensionLength=0,this._extendedList={},this._extensionInstance={},this._setupExtensionBound=this._setupExtension.bind(this),hI.on("themeUpdate",this._setupExtensionBound),this._currentComponentExtensionLength=this._calculateComponentExtensionLength(),this._createExtension(),_get(_getPrototypeOf(_class10.prototype),"_construct",this).call(this)}},{key:"_detach",value:function _detach(){_get(_getPrototypeOf(_class10.prototype),"_detach",this).call(this),hI.off("themeUpdate",this._setupExtensionBound)}},{key:"_setupExtension",value:function _setupExtension(){this._currentComponentExtensionLength=this._calculateComponentExtensionLength(),this._createExtension.call(this)}},{key:"_resetComponent",value:function _resetComponent(){var o=this;this._extensionInstance._extensionCleanup&&this._extensionInstance._extensionCleanup.call(this),(Object.keys(this._extendedList)||[]).forEach((function(s){delete o[s],delete o[s+LI]})),this._extensionInstance={},this._extendedList={}}},{key:"_calculateComponentExtensionLength",value:function _calculateComponentExtensionLength(){return this._componentExtensions.reduce((function(o,s){return o+s.toString().length}),0)}},{key:"_createExtension",value:function _createExtension(){if(!this._extensionApplied){this._resetComponent();var o=new(this._createExtensionClass());this._extendedList=this._createExtensionAliases(o),this._extensionInstance=o,this._setComponentAliases(this._extendedList)}}},{key:"_createExtensionClass",value:function _createExtensionClass(){var o=this._componentExtensions.reduce((function(o,s){return s(o)}),(function ExtensionBase(){}));return this._appliedExtensionLength=this._calculateComponentExtensionLength(),o}},{key:"_createExtensionAliases",value:function _createExtensionAliases(o){for(var s=o,m=0;m<this._componentExtensions.length+1;m++)s=Object.getPrototypeOf(s);var _={},S=this._componentExtensions.reduce((function(o,s){var m=new new s(_createClass((function FakeClass(){_classCallCheck(this,FakeClass)}))),S=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(m));return Object.keys(S).forEach((function(s){if(!["constructor"].includes(s)){if(S[s].get||S[s].set)return _[s]={type:"accessor"},void(o[s]={get:function get(){return this[s+LI]},set:function set(o){this[s+LI]=o}});_[s]={type:"method"},o[s]={value:function value(){this[s+LI]&&this[s+LI]()}}}})),o}),{});return Object.defineProperties(s,S),Object.setPrototypeOf(s,this),_}},{key:"_setComponentAliases",value:function _setComponentAliases(o){var s=this;Object.keys(o).forEach((function(m){s[m+LI]=s[m],"method"===o[m].type?s[m]=s._extensionInstance[m]:"accessor"===o[m].type&&Object.defineProperty(s,m,{configurable:!0,get:function get(){return this._extensionInstance[m]},set:function set(o){this._extensionInstance[m]=o}})}))}}],[{key:"name",get:function get(){return o.name}},{key:"__componentName",get:function get(){if(!_get(_getPrototypeOf(_class10),"__componentName",this))throw new Error("A valid static __componentName property is required for theming to work properly. Please add this to the ".concat(this.constructor.name," class."));return _get(_getPrototypeOf(_class10),"__componentName",this)}},{key:"_withExtensionsApplied",get:function get(){return!0}}]),_class10}(o)}(function withLayout(o){return function(o){_inherits(_class3,o);var s=_createSuper(_class3);function _class3(){return _classCallCheck(this,_class3),s.apply(this,arguments)}return _createClass(_class3,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(_class3.prototype),"_construct",this)&&_get(_getPrototypeOf(_class3.prototype),"_construct",this).call(this),this._previousDimensionData=null}},{key:"itemLayout",get:function get(){return this._itemLayout},set:function set(o){var s,m=this.constructor._componentName||this.constructor.name;o&&(s=JSON.parse(JSON.stringify(o,(function(o,s){if(!("circle"!==o&&s<0))return"circle"===o?Boolean(s):s;hI.error("itemLayout for ".concat(m," received an invalid value of ").concat(s," for ").concat(o))})))),stringifyCompare(this._itemLayout,s)||(s&&!s.upCount?(this._originalW=this.w,this._originalH=this.h,this._itemLayout=_objectSpread({w:this._originalW,h:this._originalH},s)):this._itemLayout=s,this._updateItemLayout())}},{key:"_allowUpdate",value:function _allowUpdate(){var o=this._itemLayout||{},s=o.w,m=void 0===s?"":s,_=o.h,S=void 0===_?"":_,E=o.circle,A=void 0===E?"":E,O=o.ratioX,H=void 0===O?"":O,K=o.ratioY,z=void 0===K?"":K,G=o.upCount,q=void 0===G?"":G,X=Object.values(hI.theme.layout).join("")+"".concat(m).concat(S).concat(A?1:0).concat(H).concat(z).concat(q);return X!==this._previousDimensionData&&(this._previousDimensionData=X,!0)}},{key:"_updateItemLayout",value:function _updateItemLayout(){if(this._allowUpdate()){var o=getDimensions(this.theme,this._itemLayout),s=o.w,m=o.h;if(m||s){var _=hI.theme.layout.screenW,S=hI.theme.layout.screenH,E=s||m*(_/S),A=m||s*(S/_);this.w=this._itemLayout&&this._itemLayout.circle?A:E,this.h=A,this._itemLayout&&this._itemLayout.circle&&this.style.radius?(this._circleSet=!0,this._originalRadius=this.style.radius,this.style=_objectSpread(_objectSpread({},this.style),{},{radius:A/2})):this._circleSet&&(this.style=_objectSpread(_objectSpread({},this.style),{},{radius:this._originalRadius}),this._originalRadius=void 0,this._circleSet=!1),this.queueRequestUpdate&&this.queueRequestUpdate(),this.fireAncestors("$itemChanged")}}}}]),_class3}(o)}(function withThemeStyles(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(m){_inherits(_class6,m);var _=_createSuper(_class6);function _class6(){return _classCallCheck(this,_class6),_.apply(this,arguments)}return _createClass(_class6,[{key:"_construct",value:function _construct(){var o=this;this._withThemeStylesSetupComplete?_get(_getPrototypeOf(_class6.prototype),"_construct",this).call(this):(_get(_getPrototypeOf(_class6.prototype),"_construct",this).call(this),this._hSetByUser=!1,this._wSetByUser=!1,this._styleManager=new PI({component:this}),this._style=this._styleManager.style,this._styleManager.on("styleUpdate",(function(){o._style=o._styleManager.style,o.queueThemeUpdate()})),this._withThemeStylesSetupComplete=!0)}},{key:"_setup",value:function _setup(){_get(_getPrototypeOf(_class6.prototype),"_setup",this)&&_get(_getPrototypeOf(_class6.prototype),"_setup",this).call(this),this._targetSubTheme=vI(this),this._targetSubTheme&&(this._styleManager.clearListeners(),this._styleManager.setupListeners(),this._styleManager.clearStyleCache(),this._styleManager.clearSourceCache(),this._styleManager.update())}},{key:"_attach",value:function _attach(){_get(_getPrototypeOf(_class6.prototype),"_attach",this).call(this),this._styleManager.isActive||this._styleManager.init(this)}},{key:"_detach",value:function _detach(){_get(_getPrototypeOf(_class6.prototype),"_detach",this).call(this),this._styleManager.destroy()}},{key:"_unfocus",value:function _unfocus(){this._isFocusedMode&&(this.mode="unfocused"),_get(_getPrototypeOf(_class6.prototype),"_unfocus",this).call(this)}},{key:"_focus",value:function _focus(){this._isDisabledMode||(this.mode="focused"),_get(_getPrototypeOf(_class6.prototype),"_focus",this).call(this)}},{key:"_checkDimensionUpdates",value:function _checkDimensionUpdates(){var o=!1;!this._wSetByUser&&this.style.w&&this._w!==this.style.w&&(this._w=this.style.w,o=!0),!this._hSetByUser&&this.style.h&&this._h!==this.style.h&&(this._h=this.style.h,o=!0),o&&this._updateDimensions()}},{key:"_updateThemeComponent",value:function _updateThemeComponent(){this.style&&this._isAttached()&&(this._checkDimensionUpdates(),this.queueRequestUpdate?this.queueRequestUpdate():this._update&&this._update(),this._updateItemLayout&&this._updateItemLayout())}},{key:"queueThemeUpdate",value:function queueThemeUpdate(){pI.addUpdateTheme(this)}},{key:"theme",get:function get(){return this._targetSubTheme&&hI.getSubTheme(this._targetSubTheme)||hI.theme}},{key:"style",get:function get(){return this._style},set:function set(o){"[object Object]"===Object.prototype.toString.call(o)?(this._componentLevelStyle=o,this._styleManager.clearStyleCache(),this._styleManager.update()):hI.error("style must be an object")}},{key:"_componentStyle",get:function get(){return hI.info("_componentStyle will soon be deprecated. Please use Component.style"),this._style}},{key:"styleConfig",get:function get(){return this._styleConfig},set:function set(o){hI.info("style config is deprecated. Please use style = { base: {}, tone: {}, mode: {} }"),this._styleConfig=o,this._styleManager.update()}},{key:"_componentConfig",get:function get(){return _I(this)}},{key:"mode",get:function get(){var o;return this._mode||(null===(o=this._componentConfig)||void 0===o?void 0:o.mode)||"unfocused"},set:function set(o){if("string"==typeof o&&this._mode!==o){this._mode=o;var s=this["on".concat(capitalizeFirstLetter(o))];s&&"function"==typeof s&&s(),this._styleManager.update()}}},{key:"tone",get:function get(){return this._tone||this._componentConfig.tone||"neutral"},set:function set(o){"string"==typeof o&&this._tone!==o&&(this._tone=o,this._styleManager.update())}},{key:"w",get:function get(){var o;return this._wSetByUser&&this._w||(null===(o=this.style)||void 0===o?void 0:o.w)||0},set:function set(o){this._w!==o&&(_set(_getPrototypeOf(_class6.prototype),"w",o,this,!0),this._wSetByUser=!0,this._styleManager.update())}},{key:"h",get:function get(){var o;return this._hSetByUser&&this._h||(null===(o=this.style)||void 0===o?void 0:o.h)||0},set:function set(o){this._h!==o&&(_set(_getPrototypeOf(_class6.prototype),"h",o,this,!0),this._hSetByUser=!0,this._styleManager.update())}}],[{key:"name",get:function get(){return o.name}},{key:"__componentName",get:function get(){if(!_get(_getPrototypeOf(_class6),"__componentName",this))throw new Error("A valid static __componentName property is required for theming to work properly. Please add this to the ".concat(this.constructor.name," class."));return _get(_getPrototypeOf(_class6),"__componentName",this)}},{key:"__mixinStyle",get:function get(){return s}}]),_class6}(o)}(function withUpdates(o){return function(s){_inherits(_class8,s);var m=_createSuper(_class8);function _class8(){return _classCallCheck(this,_class8),m.apply(this,arguments)}return _createClass(_class8,[{key:"_construct",value:function _construct(){var o=this,s=Object.getPrototypeOf(this);s._withUpdatesInitialized||((this.constructor.properties||[]).forEach((function(o){var m=function getPropertyDescriptor(o,s){return{get:function get(){var m=this["_get".concat(capital(o))];if(m&&"function"==typeof m){var _=m.call(this,this[s]);this[s]=_}return this[s]},set:function set(m){if(m!==this[s]){var _=this["_set".concat(capital(o))];_&&"function"==typeof _&&(m=_.call(this,m)),this[s]="style"===s?clone(this[s],m):m,this.queueRequestUpdate()}},configurable:!0,enumerable:!0}}(o,"_"+o);void 0!==m&&Object.defineProperty(s,o,m)})),(this.constructor.aliasProperties||[]).forEach((function(o){if(o&&"string"==typeof o.prev&&"string"==typeof o.curr){var m=function getAliasPropertyDescriptor(o,s){var m='The property "'.concat(o,'" is deprecated and will be removed in a future release. Please use "').concat(s,'" instead.');return{get:function get(){return console.warn(m),this[s]},set:function set(o){console.warn(m),this[s]=o}}}(o.prev,o.curr);void 0!==m&&Object.defineProperty(s,o.prev,m)}})),s._withUpdatesInitialized=!0),this._whenEnabled=new Promise((function(s){o._whenEnabledResolver=s})),_get(_getPrototypeOf(_class8.prototype),"_construct",this)&&_get(_getPrototypeOf(_class8.prototype),"_construct",this).call(this)}},{key:"queueRequestUpdate",value:function queueRequestUpdate(){this._isAttached()&&pI.addRequestUpdate(this)}},{key:"_firstEnable",value:function _firstEnable(){this._readyForUpdates=!0,this._whenEnabledResolver(),pI.deleteRequestUpdate(this),this.requestUpdate(),_get(_getPrototypeOf(_class8.prototype),"_firstEnable",this)&&_get(_getPrototypeOf(_class8.prototype),"_firstEnable",this).call(this)}},{key:"_detach",value:function _detach(){_get(_getPrototypeOf(_class8.prototype),"_detach",this).call(this),pI.deleteRequestUpdate(this)}},{key:"requestUpdate",value:function requestUpdate(){var o=this,s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._readyForUpdates||s){var m=this._update();"object"===_typeof(m)&&null!==m&&m.catch&&m.catch((function(s){hI.error("asyncronous _update() error in '".concat(o.constructor.__componentName,"'"),o,s)}))}}},{key:"logPropTable",value:function logPropTable(){console.table(this._propTable)}},{key:"_propTable",get:function get(){var o=this;return this.constructor.properties.reduce((function(s,m){return s[m]=o[m],s}),{})}}],[{key:"name",get:function get(){return o.name}}]),_class8}(o)}(function withTags(o){return function(s){_inherits(_class7,s);var m=_createSuper(_class7);function _class7(){return _classCallCheck(this,_class7),m.apply(this,arguments)}return _createClass(_class7,[{key:"_construct",value:function _construct(){var o=this;(this.constructor.tags||[]).forEach((function(s){if("object"===_typeof(s))var m=s.name,_=s.path;else m=s,_=s;var S="_"+m,E=function getPropertyDescriptor$1(o){return{get:function get(){return this.tag(o)},configurable:!0,enumerable:!0}}(_);Object.defineProperty(Object.getPrototypeOf(o),S,E)})),_get(_getPrototypeOf(_class7.prototype),"_construct",this)&&_get(_getPrototypeOf(_class7.prototype),"_construct",this).call(this)}}],[{key:"name",get:function get(){return o.name}}]),_class7}(o)}(function withHandleKey(o){return function(s){_inherits(_class2,s);var m=_createSuper(_class2);function _class2(){return _classCallCheck(this,_class2),m.apply(this,arguments)}return _createClass(_class2,[{key:"_handleKey",value:function _handleKey(o){return this._processEvent(o)}},{key:"_handleKeyRelease",value:function _handleKeyRelease(o){return this._processEvent(o,"Release")}},{key:"_processEvent",value:function _processEvent(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",m=(this.stage.application.__keymap||{})[o.keyCode];return m||(m=o.key),!(!m||"function"!=typeof this["on".concat(m).concat(s)])&&(this._invokeKeyPayloadCallback(m+s),this["on".concat(m).concat(s)].call(this,this,o))}},{key:"_invokeKeyPayloadCallback",value:function _invokeKeyPayloadCallback(o){this.metricsPayload&&"function"==typeof hI.keyMetricsCallback&&hI.keyMetricsCallback(o,this.metricsPayload)}}],[{key:"name",get:function get(){return o.name}}]),_class2}(o)}(o))))))}(function(o){_inherits(Base,E.Component);var s=_createSuper(Base);function Base(){return _classCallCheck(this,Base),s.apply(this,arguments)}return _createClass(Base,[{key:"_construct",value:function _construct(){this.skipPlinko=!1,this.centerInParent=!1,this.loaded||(this.loaded=Promise.resolve())}},{key:"_init",value:function _init(){this.queueRequestUpdate()}},{key:"_resetLoadedPromise",value:function _resetLoadedPromise(){var o=this;this.loaded=new Promise((function(s,m){o._resolveLoadedPromise=s,o._rejectLoadedPromise=m}))}},{key:"_update",value:function _update(){}},{key:"_focus",value:function _focus(){void 0===this.shouldSmooth&&(this.shouldSmooth=!0),this.queueRequestUpdate()}},{key:"_unfocus",value:function _unfocus(){this.queueRequestUpdate()}},{key:"applySmooth",value:function applySmooth(o,s,m){this.shouldSmooth?o.smooth=m||s:o.patch(s)}},{key:"announce",get:function get(){return this._announce},set:function set(o){this._announce=o}},{key:"announceContext",get:function get(){return this._announceContext},set:function set(o){this._announceContext=o}},{key:"shouldSmooth",get:function get(){return this._shouldSmooth},set:function set(o){this._shouldSmooth=o}},{key:"_isDisabledMode",get:function get(){return"disabled"===this.mode}},{key:"_isUnfocusedMode",get:function get(){return"unfocused"===this.mode}},{key:"_isFocusedMode",get:function get(){return"focused"===this.mode}},{key:"isFullyOnScreen",value:function isFullyOnScreen(){return isComponentOnScreen(this)}},{key:"getFocusScale",value:function getFocusScale(){return hI.theme.layout.focusScale}},{key:"getUnfocusScale",value:function getUnfocusScale(){return 1}}],[{key:"__componentName",get:function get(){return"Base"}}]),Base}()),RI=Object.freeze({__proto__:null,base:function base$R(o){return{gradientTop:o.color.fillTransparent,radius:o.radius.none}},tone:function tone$o(o){return{neutral:{gradientColor:o.color.material},inverse:{gradientColor:o.color.fillNeutral},brand:{gradientColor:o.color.fillBrand}}}}),OI=function(o){_inherits(Gradient,DI);var s=_createSuper(Gradient);function Gradient(){return _classCallCheck(this,Gradient),s.apply(this,arguments)}return _createClass(Gradient,[{key:"_update",value:function _update(){this.patch({rect:!0,rtt:!0,colorTop:this.style.gradientTop,colorBottom:this.style.gradientColor,texture:E.Tools.getRoundRect(this.w,this.h,this.style.radius)})}}],[{key:"__componentName",get:function get(){return"Gradient"}},{key:"__themeStyle",get:function get(){return RI}}]),Gradient}(),MI=Object.freeze({__proto__:null,base:function base$Q(o){return{animationBlurEntrance:o.animation.utilityEntrance,animationBlurExit:o.animation.utilityExit,animationComponentEntrance:o.animation.utilityEntrance,animationGradientEntrance:o.animation.utilityEntrance,animationGradientExit:o.animation.utilityExit,animationImageScaleEntrance:o.animation.standardEntrance,animationImageScaleExit:o.animation.standardEntrance,blur:4,centerImageRadius:o.radius.md,fallbackSrc:void 0,fillColor:o.color.overlay,gradientColor:o.color.material,imageScale:void 0,imageScalePivotX:.5,imageScalePivotY:.5,padding:o.spacer.md,radius:0,zIndexSet:{image:1,blur:2,centerImage:3,fill:4,gradient:5,foreground:6}}}}),FI=function(o){_inherits(CustomImageTexture,E.Texture);var s=_createSuper(CustomImageTexture);function CustomImageTexture(o){var m;return _classCallCheck(this,CustomImageTexture),(m=s.call(this,o))._src=void 0,m._hasAlpha=!1,m}return _createClass(CustomImageTexture,[{key:"src",get:function get(){return this._src},set:function set(o){this._src!==o&&(this._src=o,this._changed())}},{key:"hasAlpha",get:function get(){return this._hasAlpha},set:function set(o){this._hasAlpha!==o&&(this._hasAlpha=o,this._changed())}},{key:"w",get:function get(){return this._w},set:function set(o){this._w=o,this._changed()}},{key:"h",get:function get(){return this._h},set:function set(o){this._h=o,this._changed()}},{key:"_getIsValid",value:function _getIsValid(){return!!this._src}},{key:"_getLookupId",value:function _getLookupId(){return this._src}},{key:"_getSourceLoader",value:function _getSourceLoader(){var o=this,s=this._w,m=this._h,_=this._src,S=this._hasAlpha;if(this.stage.getOption("srcBasePath")){var A=_.charCodeAt(0);-1===_.indexOf("//")&&(A>=65&&A<=90||A>=97&&A<=122||46==A)&&(_=this.stage.getOption("srcBasePath")+_)}return function(A){switch(function checkFileType(o){return o.startsWith("<svg")?"SVG":o.startsWith("blob:")?"Blob":/\.(jpeg|jpg|gif|png|svg)$/i.test(o)?"Image":"Unknown"}(_)){case"SVG":return function createSvg(o,s,m,_,S){var A=s.platform.getDrawingCanvas(),O=A.getContext("2d");O.imageSmoothingEnabled=!0;var H=new Image;H.onload=function(){A.width=_,A.height=S,O.drawImage(H,0,0,A.width,A.height),o(null,{source:A,w:_,h:S})},H.onerror=function(s){o(s)},E.Utils.isPS4||(H.crossOrigin="Anonymous"),H.src=m}(A,o.stage,"data:image/svg+xml,".concat(encodeURIComponent(_)),s,m);case"Blob":return function imageLoader(o,s){var m=o.src,_=new Image;return"data:"==m.substr(0,5)||E.Utils.isPS4||(_.crossOrigin="Anonymous"),_.onerror=function(){if(_.src)return s("Image load error")},_.onload=function(){s(null,{source:_,renderInfo:{src:m,compressed:!1},hasAlpha:!0})},_.src=m,function(){_.onerror=null,_.onload=null,_.removeAttribute("src")}}({src:_},A);default:return o.stage.platform.loadSrcTexture({src:_,hasAlpha:S},A)}}}},{key:"getNonDefaults",value:function getNonDefaults(){var o=_get(_getPrototypeOf(CustomImageTexture.prototype),"getNonDefaults",this).call(this);return this._src&&(o.src=this._src),o}}]),CustomImageTexture}(),NI=function(o){_inherits(Artwork,DI);var s,m,_,S,A=_createSuper(Artwork);function Artwork(){return _classCallCheck(this,Artwork),A.apply(this,arguments)}return _createClass(Artwork,[{key:"_shouldBlur",get:function get(){var o=this._blur||this._hasCenterImage;return this._Image.rtt=o,o}},{key:"_hasCenterImage",get:function get(){return-1<["circle","square"].indexOf(this.format)||"contain"===this.format&&!this._aspectRatioEqual}},{key:"w",get:function get(){return _get(_getPrototypeOf(Artwork.prototype),"w",this)},set:function set(o){_set(_getPrototypeOf(Artwork.prototype),"w",o,this,!0),this._componentSrc=this._generatePromise()}},{key:"h",get:function get(){return _get(_getPrototypeOf(Artwork.prototype),"h",this)},set:function set(o){_set(_getPrototypeOf(Artwork.prototype),"h",o,this,!0),this._componentSrc=this._generatePromise()}},{key:"_actualAspectRatio",get:function get(){return this.w&&this.h?reduceFraction("".concat(this.w,"/").concat(this.h)).replace("/","x"):null}},{key:"_supportedAspectRatioHeights",get:function get(){var o=this;return this.srcCallbackAspectRatios.map((function(s){var m=_slicedToArray(s.split("x").map((function(o){return parseInt(o)})),2),_=m[0],S=m[1];return o.w/_*S}))}},{key:"_closestSupportedAspectRatio",get:function get(){var o=this,s=this._supportedAspectRatioHeights.reduce((function(s,m){return Math.abs(m-o.h)<Math.abs(s-o.h)?m:s}));return this.srcCallbackAspectRatios[this._supportedAspectRatioHeights.indexOf(s)]}},{key:"_processedImageSrc",get:function get(){var o=this.src||this.fallbackSrc;return o!==this.fallbackSrc&&this.srcCallback&&"function"==typeof this.srcCallback&&(o=this.srcCallback({closestAspectRatio:this._closestSupportedAspectRatio,aspectRatio:this._actualAspectRatio,src:this.src,w:this.w,h:this.h})),o&&o.then?o:Promise.resolve(o)}},{key:"_gradientPatch",get:function get(){return{alpha:!this._Gradient&&this.shouldSmooth?.001:1,style:{gradientColor:getValidColor(this.style.gradientColor)},h:this.h+4,type:OI,w:this.w+4,x:-2,y:-2,zIndex:this.core.findZContext().zIndex+this.style.zIndexSet.gradient}}},{key:"_construct",value:function _construct(){_get(_getPrototypeOf(Artwork.prototype),"_construct",this).call(this),this._srcCallbackAspectRatios=["16x9","3x4","4x3","2x1","1x1"]}},{key:"_setSrc",value:function _setSrc(o){return this._componentSrc=this._generatePromise(),o}},{key:"_getFallbackSrc",value:function _getFallbackSrc(){return this._fallbackSrc||this.style&&this.style.fallbackSrc}},{key:"_generatePromise",value:function _generatePromise(){var o,s;return{complete:new Promise((function(m,_){o=m,s=_})),resolve:o,reject:s}}},{key:"_setup",value:function _setup(){this.alpha=.001,this._componentSrc=this._generatePromise(),this._aspectRatioEqual=!1,this._Image.on("txLoaded",this._resolveLoading.bind(this)),this._Image.on("txError",this._rejectLoading.bind(this))}},{key:"_resolveLoading",value:function _resolveLoading(){this._aspectRatioEqual=!!this._Image.texture.source&&parseFloat(this.finalW/this.finalH).toFixed(2)===parseFloat(this._Image.texture.source.w/this._Image.texture.source.h).toFixed(2),this._componentSrc.resolve&&this._componentSrc.resolve(),this.signal("imageLoaded")}},{key:"_rejectLoading",value:function _rejectLoading(o){this._componentSrc.reject&&this._componentSrc.reject(o)}},{key:"_update",value:(S=_asyncToGenerator(_regeneratorRuntime().mark((function _callee9(){return _regeneratorRuntime().wrap((function _callee9$(o){for(;;)switch(o.prev=o.next){case 0:return this._updateRadius(),this._updateGradient(),o.next=4,this._updateImage();case 4:if(this._updateFillColor(),this._updateForegroundImage(),this.src){o.next=9;break}return this._showComponent(),o.abrupt("return");case 9:return o.prev=9,o.next=12,this._componentSrc.complete;case 12:return o.next=14,this._updateCenterImage();case 14:this._updateBlur(),this._showComponent(),this._updateScale(),o.next=22;break;case 19:o.prev=19,o.t0=o.catch(9),this._handleImageLoadError();case 22:void 0===this.shouldSmooth&&(this.shouldSmooth=!0);case 23:case"end":return o.stop()}}),_callee9,this,[[9,19]])}))),function _update(){return S.apply(this,arguments)})},{key:"_updateScale",value:function _updateScale(){if(this.shouldScale){var o;switch(_typeof(this.style.imageScale)){case"function":o=this.style.imageScale(this.w);break;case"number":o=this.style.imageScale;break;default:o=1}this._Image.smooth={pivotX:this.style.imageScalePivotX,pivotY:this.style.imageScalePivotY,scale:[o,this._Image.scale<o?this.style.animationImageScaleEntrance:this.style.animationImageScaleExit]}}else this._Image.smooth={scale:[1,this.style.animationImageScaleExit]}}},{key:"_handleImageLoadError",value:function _handleImageLoadError(){this.src!==this.fallbackSrc&&(hI.error("Image ".concat(this._src," failed to load")),this.fallbackSrc&&this.fallbackSrc!==this.src&&(this.src=this.fallbackSrc))}},{key:"_showComponent",value:function _showComponent(){this.smooth={alpha:[1,this.style.animationComponentEntrance]}}},{key:"_updateForegroundImage",value:(_=_asyncToGenerator(_regeneratorRuntime().mark((function _callee10(){var o,s=this;return _regeneratorRuntime().wrap((function _callee10$(m){for(;;)switch(m.prev=m.next){case 0:if(this._foregroundSrc){m.next=3;break}return this._ForegroundImage&&this.patch({ForegroundImage:void 0}),m.abrupt("return");case 3:o={mount:.5,x:this.w/2,y:this.h/2,zIndex:this.core.findZContext().zIndex+this.style.zIndexSet.foreground,texture:{type:FI,src:this._foregroundSrc,hasAlpha:!0}},this.foregroundW&&this.foregroundH?(o.h=this.foregroundH,o.w=this.foregroundW,this.patch({ForegroundImage:o})):(this.foregroundW||this.foregroundH)&&(this.patch({ForegroundImage:_objectSpread(_objectSpread({},o),{},{alpha:.001})}),this._ForegroundImage.once("txLoaded",(function(){var o=s._ForegroundImage.texture.getRenderWidth(),m=s._ForegroundImage.texture.getRenderHeight();s._ForegroundImage.patch({alpha:1,w:s.foregroundH?s.foregroundH*(o/m):s.foregroundW,h:s.foregroundW?s.foregroundW*(m/o):s.foregroundH})}))),this.patch({ForegroundImage:o});case 6:case"end":return m.stop()}}),_callee10,this)}))),function _updateForegroundImage(){return _.apply(this,arguments)})},{key:"_updateBlur",value:function _updateBlur(){var o=this;(!this._shouldBlur||this._Image&&this._Image.texture&&this._Image.texture.src===this.fallbackSrc)&&this._Blur?this.shouldSmooth?(this._Blur._getTransition("alpha").once("finish",(function(){o.patch({Blur:void 0})})),this._Blur.smooth={alpha:[0,this.style.animationBlurExit]}):this.patch({Blur:void 0}):!this._srcFailed&&this._shouldBlur&&(this.patch({Blur:{alpha:!this._Blur&&this.shouldSmooth?.001:1,amount:this.style.blur,zIndex:this.core.findZContext().zIndex+this.style.zIndexSet.blur,content:{Image:{h:this.h,texture:this._Image.getTexture(),w:this.w}},h:this.h,rtt:!0,type:E.components.FastBlurComponent,w:this.w}}),this._Blur.alpha<1&&(this._Blur.smooth={alpha:[1,this.style.animationBlurEntrance]}))}},{key:"_updateCenterImage",value:function _updateCenterImage(){"contain"===this.format?this._updateFormatContain():"circle"===this.format||"square"===this.format?this._updateFormatSquareCircle():this._CenterImage&&this.patch({CenterImage:void 0})}},{key:"_updateFormatContain",value:(m=_asyncToGenerator(_regeneratorRuntime().mark((function _callee11(){var o,s,m,_,S;return _regeneratorRuntime().wrap((function _callee11$(E){for(;;)switch(E.prev=E.next){case 0:if(!(this._CenterImage&&this._CenterImage.mode!==this.format||this.src===this.fallbackSrc||this._aspectRatioEqual)){E.next=5;break}if(this.patch({CenterImage:void 0}),this.src!==this.fallbackSrc&&!this._aspectRatioEqual){E.next=5;break}return this._Image.alpha=1,E.abrupt("return");case 5:return m=Math.abs(this._Image.texture.source.w/this._Image.texture.source.h),_=Math.abs(this._Image.texture.source.h/this._Image.texture.source.w),this._Image.texture.source.w<this._Image.texture.source.h?this.h*m<this.w?(o=this.h*m,s=this.h):(o=this.w,s=this.w*_):this._Image.texture.source.w>this._Image.texture.source.h?this.w*_<this.h?(o=this.w,s=this.w*_):(o=this.h*m,s=this.h):(o=Math.min(this.w,this.h),s=o),E.next=10,this._processedImageSrc;case 10:S=E.sent,this.patch({CenterImage:{format:this.format,mount:.5,w:o,h:s,x:this.w/2,y:this.h/2,zIndex:this.core.findZContext().zIndex+this.style.zIndexSet.centerImage,texture:{src:S,resizeMode:{h:s,type:"cover",w:o},type:FI}}});case 12:case"end":return E.stop()}}),_callee11,this)}))),function _updateFormatContain(){return m.apply(this,arguments)})},{key:"_updateFormatSquareCircle",value:function _updateFormatSquareCircle(){if(!(this._CenterImage&&this._CenterImage.mode!==this.format||this.src===this.fallbackSrc)||(this.patch({CenterImage:void 0}),this.src!==this.fallbackSrc)){var o=Math.min(this.w,this.h)-2*this.style.padding;this.patch({CenterImage:{format:this.format,h:o,shader:{radius:"circle"===this.format?o/2:this.style.centerImageRadius,type:E.shaders.RoundedRectangle},w:o,zIndex:this.core.findZContext().zIndex+this.style.zIndexSet.centerImage,Image:{h:o,mount:.5,rtt:!0,w:o,x:this.w/2,y:this.h/2,texture:{src:this._Image.texture.src,resizeMode:{h:o,type:"cover",w:o},type:FI}}}})}}},{key:"_updateGradient",value:function _updateGradient(){var o=this;this.gradient?this._createGradient():this._Gradient&&(this.shouldSmooth?(this._Gradient._getTransition("alpha").once("finish",(function(){var s=o._Gradient&&o._Gradient._getTransition("alpha");!o.gradient&&s&&1===s.p&&o.patch({Gradient:void 0})})),this._Gradient.patch(this._gradientPatch),this._Gradient.smooth={alpha:[0,this.style.animationGradientExit]}):this.patch({Gradient:void 0}))}},{key:"_createGradient",value:function _createGradient(){this.patch({Gradient:this._gradientPatch}),this.shouldSmooth&&this.applySmooth(this._Gradient,{alpha:[1,this.style.animationGradientEntrance]})}},{key:"_updateImage",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function _callee12(){var o;return _regeneratorRuntime().wrap((function _callee12$(s){for(;;)switch(s.prev=s.next){case 0:if(this._aspectRatioEqual=!1,this._processedImageSrc){s.next=4;break}return this._Image&&(this._Image.texture=void 0),s.abrupt("return");case 4:return s.next=6,this._processedImageSrc;case 6:o=s.sent,this._Image.patch({alpha:this.src!==this.fallbackSrc&&(this._blur||this._hasCenterImage)?.001:1,h:this.h,texture:{type:FI,src:o,resizeMode:{type:"cover",w:this.w,h:this.h}},w:this.w,zIndex:this.core.findZContext().zIndex+this.style.zIndexSet.image});case 8:case"end":return s.stop()}}),_callee12,this)}))),function _updateImage(){return s.apply(this,arguments)})},{key:"_updateFillColor",value:function _updateFillColor(){this.fill?this.patch({FillColor:{rect:!0,w:this.w,h:this.h,color:this.style.fillColor,zIndex:5}}):this.patch({FillColor:void 0})}},{key:"_updateRadius",value:function _updateRadius(){this.patch(this.style.radius?{shader:{type:E.shaders.RoundedRectangle,radius:this.style.radius}}:{shader:void 0})}}],[{key:"__componentName",get:function get(){return"Artwork"}},{key:"__themeStyle",get:function get(){return MI}},{key:"properties",get:function get(){return["blur","fallbackSrc","foregroundH","foregroundSrc","foregroundW","gradient","format","src","fill","shouldScale","srcCallback","srcCallbackAspectRatios"]}},{key:"tags",get:function get(){return["Blur","CenterImage","FillColor","ForegroundImage","Gradient","Image","Item"]}},{key:"_template",value:function _template(){return{rtt:!0,Image:{}}}}]),Artwork}(),UI=Object.freeze({__proto__:null,tone:function tone$n(o){return{neutral:{color:o.color.fillNeutral},inverse:{color:o.color.fillInverse},brand:{color:o.color.fillBrand}}}}),BI=function(o){_inherits(Icon,DI);var s=_createSuper(Icon);function Icon(){return _classCallCheck(this,Icon),s.apply(this,arguments)}return _createClass(Icon,[{key:"_init",value:function _init(){var o=this;this.on("txLoaded",(function(){o.fixed||o._notify.bind(o)()})),this.on("txError",this._handleTxtError.bind(this))}},{key:"_getColor",value:function _getColor(){return this._color||this.style.color}},{key:"_notify",value:function _notify(){this.w=this.finalW,this.h=this.finalH,this.signal("itemChanged",this),this.fireAncestors("$itemChanged")}},{key:"_handleTxtError",value:function _handleTxtError(){hI.error("Unable to load icon ".concat(this._icon)),this._icon=null,this.texture=null}},{key:"_update",value:function _update(){this._icon?this.patch(this._iconPatch):this.texture=null}},{key:"_iconPatch",get:function get(){var o,s=_slicedToArray([/^<svg.*<\/svg>$/,/\.svg$/].map((function(o){return RegExp.prototype.test.bind(o)})),2),m=s[0],_=s[1],S=m(this.icon),A=_(this.icon);o=S?E.Tools.getSvgTexture("data:image/svg+xml,".concat(encodeURIComponent(this.icon)),this.w,this.h):A?E.Tools.getSvgTexture(this.icon,this.w,this.h):{type:FI,w:this.w,h:this.h,src:this.icon};var O=!Boolean(S||A),H=getValidColor(this._color||this.style.color);return!O&&H&&hI.warn("icon does not allow colors to be applied to an SVG"),_objectSpread({texture:o,shader:this.radius||this.style.radius?{radius:this.radius||this.style.radius,type:E.shaders.RoundedRectangle}:void 0},O&&H?{colorUl:H,colorUr:H,colorBl:H,colorBr:H}:{})}}],[{key:"__componentName",get:function get(){return"Icon"}},{key:"__themeStyle",get:function get(){return UI}},{key:"properties",get:function get(){return["icon","fixed","color"]}}]),Icon}(),jI=Object.freeze({__proto__:null,base:function base$P(o){return{contentSpacing:o.spacer.sm,offsetY:1,paddingX:o.spacer.md+o.spacer.xxs,paddingY:o.spacer.xs,radius:o.radius.sm,strokeWidth:o.stroke.sm,textStyle:_objectSpread(_objectSpread({},o.typography.caption1),{},{textAlign:"center"})}},tone:function tone$m(o){return{neutral:{backgroundColor:o.color.fillInverseSecondary,iconColor:o.color.textNeutral,textStyle:{textColor:o.color.textNeutral},strokeColor:o.color.strokeNeutral},inverse:{backgroundColor:o.color.fillNeutralSecondary,iconColor:o.color.textInverse,textStyle:{textColor:o.color.textInverse},strokeColor:o.color.strokeInverse},brand:{backgroundColor:o.color.fillBrand,iconColor:o.color.textNeutral,textStyle:{textColor:o.color.textNeutral},strokeColor:o.color.strokeInverse}}}}),$I=function(o){_inherits(Badge,DI);var s=_createSuper(Badge);function Badge(){return _classCallCheck(this,Badge),s.apply(this,arguments)}return _createClass(Badge,[{key:"_init",value:function _init(){this._Text.on("txLoaded",this._updateLayout.bind(this)),_get(_getPrototypeOf(Badge.prototype),"_init",this).call(this)}},{key:"_update",value:function _update(){this._updateText(),this._updateIcon(),this._updateLayout(),this._updateVisibility()}},{key:"_updateVisibility",value:function _updateVisibility(){this.alpha=this.title||this.icon?1:0}},{key:"_updateLayout",value:function _updateLayout(){this._updateWidth(),this._updateBackground(),this._updatePositions(),this.signal("loadedBadge",this)}},{key:"_updateBackground",value:function _updateBackground(){var o=Math.max(this._Text.renderHeight,this._Icon.h)+2*this.style.paddingY;this.patch({h:o,texture:E.Tools.getRoundRect(this.w,o,this.style.radius,this.style.strokeWidth,this.style.strokeColor,!0,this.style.backgroundColor)})}},{key:"_updateText",value:function _updateText(){this._Text&&this._Text.patch({text:_objectSpread(_objectSpread({},this.style.textStyle),{},{text:this.title||""})})}},{key:"_updateIcon",value:function _updateIcon(){this._Icon.patch({icon:this.icon,w:this.iconWidth,h:this.iconHeight,style:{color:getHexColor(this.style.iconColor)}})}},{key:"_updateWidth",value:function _updateWidth(){var o=0;this.title&&this.icon?o=this._Text.renderWidth+this._Icon.finalW+this.style.contentSpacing+2*this.style.paddingX:this.title?o=this._Text.renderWidth+2*this.style.paddingX:this.icon&&(o=this._Icon.finalW+2*this.style.paddingX),this.w=o}},{key:"_updatePositions",value:function _updatePositions(){this._Icon.y=this.h/2,"left"===this.iconAlign&&this.title&&this.icon?(this._Icon.x=this.style.paddingX,this._Text.x=this._Icon.x+this._Icon.finalW+this.style.contentSpacing):"right"===this.iconAlign&&this.title&&this.icon?(this._Text.x=this.style.paddingX,this._Icon.x=this._Text.x+this._Text.renderWidth+this.style.contentSpacing):(this._Text.x=this.style.paddingX,this._Icon.x=this.style.paddingX),this._Text.y=this._h/2+this.style.offsetY}},{key:"_getIconHeight",value:function _getIconHeight(){return this.icon?!this._Icon.finalH&&this._Text?this._Text.text.lineHeight:this._Icon.finalH:0}},{key:"announce",get:function get(){return this._announce||this.title},set:function set(o){_set(_getPrototypeOf(Badge.prototype),"announce",o,this,!0)}}],[{key:"_template",value:function _template(){return{Text:{mountY:.5},Icon:{type:BI,mountY:.5,signals:{itemChanged:"_updateLayout"}}}}},{key:"__componentName",get:function get(){return"Badge"}},{key:"__themeStyle",get:function get(){return jI}},{key:"properties",get:function get(){return["title","icon","iconAlign","iconWidth","iconHeight"]}},{key:"tags",get:function get(){return["Background","Text","Icon"]}}]),Badge}(),VI=Object.freeze({__proto__:null,base:function base$O(o){return{h:10*o.spacer.md,w:0,justify:"center",minWidth:getWidthByColumnSpan(o,3),paddingX:o.spacer.xxxl,paddingXNoTitle:o.spacer.xl,titlePadding:o.spacer.md,itemSpacing:o.spacer.md,textStyle:_objectSpread(_objectSpread({},o.typography.button1),{},{maxLines:1,textColor:o.color.textNeutral}),contentColor:o.color.fillNeutral}},mode:function mode$g(o){return{focused:{textStyle:{textColor:o.color.textInverse},contentColor:o.color.fillInverse,tone:{inverse:{textStyle:{textColor:o.color.textNeutral},contentColor:o.color.fillNeutral},brand:{contentColor:o.color.fillNeutral}}},disabled:{textStyle:{textColor:o.color.textNeutralDisabled},contentColor:o.color.fillNeutralDisabled}}}}),HI=function(o){_inherits(FocusManager,DI);var s=_createSuper(FocusManager);function FocusManager(){return _classCallCheck(this,FocusManager),s.apply(this,arguments)}return _createClass(FocusManager,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(FocusManager.prototype),"_construct",this).call(this),this._selectedIndex=0,this._itemPosX=0,this._itemPosY=0,this.direction=this.direction||"row"}},{key:"_init",value:function _init(){this._checkSkipFocus()}},{key:"Items",get:function get(){return this.tag("Items")||this.patch({Items:{}}),this._Items}},{key:"_setDirection",value:function _setDirection(o){var s={none:"None",column:"Column",row:"Row"}[o];return s&&this._setState(s),o}},{key:"_getItems",value:function _getItems(){return this._Items.children}},{key:"items",get:function get(){return this.Items.children},set:function set(o){this._resetItems(),this._selectedIndex=0,this.appendItems(o),this._checkSkipFocus()}},{key:"itemPosX",get:function get(){return this._itemPosX},set:function set(o){this.Items.x=this._itemPosX=o}},{key:"itemPosY",get:function get(){return this._itemPosY},set:function set(o){this.Items.y=this._itemPosY=o}},{key:"_resetItems",value:function _resetItems(){this.Items.childList.clear(),this.Items.patch({w:0,h:0,x:this.itemPosX,y:this.itemPosY})}},{key:"_appendLazyItem",value:function _appendLazyItem(o){this.appendItems([o])}},{key:"appendItems",value:function appendItems(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.Items.childList.a(o),this._refocus()}},{key:"appendItemsAt",value:function appendItemsAt(){var o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],m=arguments.length>1?arguments[1]:void 0,_=Number.isInteger(m)?m:this.Items.children.length;this.shouldSmooth=!1,this._lastAppendedIdx=_,s.forEach((function(s,m){o.Items.childList.addAt(_objectSpread(_objectSpread({},s),{},{parentFocus:o.hasFocus()}),_+m)})),this.selectedIndex>=this._lastAppendedIdx&&(this._selectedIndex+=s.length),this.requestUpdate(),this._refocus()}},{key:"prependItems",value:function prependItems(o){this.appendItemsAt(o,0)}},{key:"removeItemAt",value:function removeItemAt(o){this.shouldSmooth=!1,this.Items.childList.removeAt(o),(this.selectedIndex>o||this.selectedIndex===this.Items.children.length)&&this._selectedIndex--,this.requestUpdate(),this._refocus()}},{key:"_checkSkipFocus",value:function _checkSkipFocus(){var o=this.Items.children[this.selectedIndex];o&&o.skipFocus&&this.selectNext()}},{key:"selected",get:function get(){return this.Items.children[this.selectedIndex]}},{key:"selectedIndex",get:function get(){return this._selectedIndex},set:function set(o){this.prevSelected=this.selected,this.Items.children.length&&this.Items.children[o]&&this.Items.children[o].skipFocus||(o!==this._selectedIndex&&(this._selectedIndex=o),this.selected&&this._selectedChange(this.selected,this.prevSelected),this._refocus())}},{key:"_selectedChange",value:function _selectedChange(o,s){this._render(o,s),this.signal("selectedChange",o,s)}},{key:"_render",value:function _render(){}},{key:"_firstFocusableIndex",value:function _firstFocusableIndex(){return this.items.length?this.items.reduce((function(o,s,m){return s.skipFocus||o.push(_objectSpread(_objectSpread({},s),{},{originalIdx:m})),o}),[]).shift().originalIdx:0}},{key:"_lastFocusableIndex",value:function _lastFocusableIndex(){return this.items.length?this.items.reduce((function(o,s,m){return s.skipFocus||o.push(_objectSpread(_objectSpread({},s),{},{originalIdx:m})),o}),[]).pop().originalIdx:0}},{key:"selectPrevious",value:function selectPrevious(){this.shouldSmooth=!0;var o=!!(this.items||[]).filter((function(o){return!o.skipFocus})).length;if(0===this.selectedIndex&&!this.wrapSelected||!o)return!1;var s=this.items.map((function(o){return!!o.skipFocus})).lastIndexOf(!1,this._selectedIndex-1);return s>-1?(this.selectedIndex=s,!0):!!this.wrapSelected&&(this.selectedIndex=this._lastFocusableIndex(),!0)}},{key:"selectNext",value:function selectNext(){var o=this;this.shouldSmooth=!0,this._lazyItems&&this._lazyItems.length&&delayForAnimation((function(){o._appendLazyItem(o._lazyItems.splice(0,1)[0])}));var s=!!(this.items||[]).filter((function(o){return!o.skipFocus})).length;if(this.selectedIndex===this.Items.children.length-1&&!this.wrapSelected||!s)return!1;var m=this.items.findIndex((function(s,m){return!s.skipFocus&&m>o._selectedIndex}));return m>-1?(this.selectedIndex=m,!0):!!this.wrapSelected&&(this.selectedIndex=this._firstFocusableIndex(),!0)}},{key:"_getIndexOfItemNear",value:function _getIndexOfItemNear(o,s){var m=s.selected;if(!(o&&o.items&&o.items.length&&m))return 0;var _=_slicedToArray(m.core.getAbsoluteCoords(0,0),2),S=_[0],E=_[1],A=[S+m.w/2,E+m.h/2],O=o.items.map((function(o,s){return{index:s,distance:o.skipFocus?null:(m=A,_=o,S=_slicedToArray(m,2),E=S[0],O=S[1],H=_slicedToArray(_.core?_.core.getAbsoluteCoords(0,0):[0,0],2),K=H[0],z=H[1],G=getEuclideanDistance(E,O,K,z),q=getEuclideanDistance(E,O,K+_.w/2,z+_.h/2),X=getEuclideanDistance(E,O,K+_.w,z+_.h),Math.min(G,q,X))};var m,_,S,E,O,H,K,z,G,q,X})).filter((function(o){return null!==o.distance})).sort((function(o,s){return o.distance-s.distance}));return O[0].index}},{key:"_focus",value:function _focus(){this.items.forEach((function(o){return o.parentFocus=!0}))}},{key:"_unfocus",value:function _unfocus(){this.items.forEach((function(o){return o.parentFocus=!1}))}},{key:"_getFocused",value:function _getFocused(){var o=this.selected;if(o){if(o.focusRef)return o.tag(o.focusRef);if(o.cparent)return o}return this}},{key:"_updateTransitionTarget",value:function _updateTransitionTarget(o,s,m){o&&o.transition(s)&&!o.transition(s).isRunning()&&o.transition(s).targetValue!==m&&o.transition(s).updateTargetValue(m)}},{key:"onScreenItems",get:function get(){var o=this;return this.Items.children.filter((function(s){return o._isOnScreen(s)}))}},{key:"_isOnScreenCompletely",value:function _isOnScreenCompletely(o){return o.isFullyOnScreen?o.isFullyOnScreen():isComponentOnScreen(o)}},{key:"fullyOnScreenItems",get:function get(){var o=this;return this.Items.children.reduce((function(s,m){return m instanceof FocusManager?[].concat(_toConsumableArray(s),_toConsumableArray(m.Items.children.filter(o._isOnScreenCompletely))):o._isOnScreenCompletely(m)?[].concat(_toConsumableArray(s),[m]):s}),[])}},{key:"_isOnScreen",value:function _isOnScreen(){throw new Error("'_isOnScreen' must be implemented by 'row'/'column'")}},{key:"_isComponentHorizontallyVisible",value:function _isComponentHorizontallyVisible(o){var s=XE(o);if(!Number.isFinite(s))return!1;var m=this.getTransitionXTargetValue(),_=this.core.renderContext.px+m+s,S=_slicedToArray(this.core._scissor||[],3),E=S[0],A=void 0===E?null:E,O=S[2],H=void 0===O?null:O,K=this.stage.w/this.stage.getRenderPrecision(),z=o.w;if(!(_>=0&&_+z<=K))return!1;var G=!0,q=!0;return Number.isFinite(A)&&(G=Math.round(_+z)>=Math.round(A),q=Math.round(_)<=Math.round(A+H)),G&&q}},{key:"_isComponentVerticallyVisible",value:function _isComponentVerticallyVisible(o){var s=YE(o);if(!Number.isFinite(s))return!1;var m=this.getTransitionYTargetValue(),_=this.core.renderContext.py,S=_slicedToArray(this.core._scissor||[],4),E=S[1],A=void 0===E?null:E,O=S[3],H=void 0===O?null:O,K=o.h,z=_+m+s,G=this.stage.h/this.stage.getRenderPrecision();if(!(z+K>=0&&z<=G))return!1;var q=!0,X=!0;return Number.isFinite(A)&&(q=Math.round(z+K)>Math.round(A),X=Math.round(z)<Math.round(A+H)),q&&X}},{key:"getTransitionXTargetValue",value:function getTransitionXTargetValue(){return this.Items.transition("x").targetValue}},{key:"getTransitionYTargetValue",value:function getTransitionYTargetValue(){return this.Items.transition("y").targetValue}}],[{key:"__componentName",get:function get(){return"FocusManager"}},{key:"tags",get:function get(){return["Items"]}},{key:"properties",get:function get(){return["direction","wrapSelected"]}},{key:"_states",value:function _states(){return[function(o){_inherits(None,o);var s=_createSuper(None);function None(){return _classCallCheck(this,None),s.apply(this,arguments)}return _createClass(None)}(this),function(o){_inherits(Row,o);var s=_createSuper(Row);function Row(){return _classCallCheck(this,Row),s.apply(this,arguments)}return _createClass(Row,[{key:"_handleLeft",value:function _handleLeft(){return this.selectPrevious()}},{key:"_handleRight",value:function _handleRight(){return this.selectNext()}}]),Row}(this),function(o){_inherits(Column,o);var s=_createSuper(Column);function Column(){return _classCallCheck(this,Column),s.apply(this,arguments)}return _createClass(Column,[{key:"_handleUp",value:function _handleUp(){return this.selectPrevious()}},{key:"_handleDown",value:function _handleDown(){return this.selectNext()}}]),Column}(this)]}}]),FocusManager}(),KI=Object.freeze({__proto__:null,base:function base$N(o){return{alwaysScroll:!1,itemSpacing:o.layout.gutterX.xs,itemTransition:o.animation.utility,neverScroll:!1,scrollIndex:0}}}),zI={row:{axis:"x",crossAxis:"y",lengthDimension:"w",crossDimension:"h",innerLengthDimension:"innerW",innerCrossDimension:"innerH"},column:{axis:"y",crossAxis:"x",lengthDimension:"h",crossDimension:"w",innerLengthDimension:"innerH",innerCrossDimension:"innerW"}},WI=function(o){_inherits(NavigationManager,HI);var s=_createSuper(NavigationManager);function NavigationManager(){return _classCallCheck(this,NavigationManager),s.apply(this,arguments)}return _createClass(NavigationManager,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(NavigationManager.prototype),"_construct",this).call(this),this.shouldSmooth=!1,this._lazyUpCountBuffer=2}},{key:"_init",value:function _init(){var o=this._directionPropNames,s=o.lengthDimension,m=o.axis;this[s]||this._initComponentSize(),this.Items.transition(m).on("finish",this._transitionListener.bind(this)),_get(_getPrototypeOf(NavigationManager.prototype),"_init",this).call(this)}},{key:"_initComponentSize",value:function _initComponentSize(){var o=this._directionPropNames.lengthDimension;if((null==this?void 0:this.parent.parent)instanceof NavigationManager&&null!=this&&this.parent.parent[o])this[o]=this.parent.parent[o];else{for(var s=this.parent;s&&!s[o];)s=s.parent;this[o]=s&&s[o]||this.stage.h/this.stage.getRenderPrecision()}}},{key:"_update",value:function _update(){this._updateLayout()}},{key:"_updateLayout",value:function _updateLayout(){for(var o,s=this._directionPropNames,m=s.lengthDimension,_=s.crossDimension,S=s.crossAxis,E=s.innerCrossDimension,A=0,O=0,H=0,K=[],z=0;z<this.Items.children.length;z++){var G=this.Items.children[z];if(O=max(O,this._calcCrossDimensionSize(G)),H=max(H,G[E]||0),this.updatePositionOnAxis(G,A),A+=G[m],z<this.Items.children.length-1){var q=G.extraItemSpacing||0;A+=this.style.itemSpacing+q}if(G.centerInParent){var X=G.Items&&G.Items[_]||G[_];(X<this[_]||!this.Items[E])&&K.push({childIdx:z,childCrossDimensionSize:X})}else G[S]=0}var J=this.Items[_]!==O||this.Items[m]!==A;this.Items.patch((_defineProperty(o={},_,O),_defineProperty(o,E,H||O),_defineProperty(o,m,A+(this._totalAddedWidth||0)),o)),this._autoResize(),this._centerItemsInParent(K),this._updateLastScrollIndex(),J&&(this._performRender(),this.fireAncestors("$itemChanged"))}},{key:"_centerItemsInParent",value:function _centerItemsInParent(o){var s=this,m=this._directionPropNames,_=m.crossDimension,S=m.crossAxis,E=m.innerCrossDimension;if(o.length){var A=[this.Items[_],this.Items[E]];1===this.children.length&&A.push(this[_]);var O=Math.max.apply(Math,A);o.forEach((function(o){var m=o.childIdx,_=o.childCrossDimensionSize;s.Items.children[m][S]=(O-_)/2}))}}},{key:"_autoResize",value:function _autoResize(){this.autoResizeWidth&&(this.w=this.Items.w),this.autoResizeHeight&&(this.h=this.Items.h)}},{key:"_updateLastScrollIndex",value:function _updateLastScrollIndex(){var o=this._directionPropNames,s=o.axis,m=o.lengthDimension;if(this.alwaysScroll)this._lastScrollIndex=this.Items.children.length-1;else{var _=(this.Items.children[this.scrollIndex]||_defineProperty({},s,0))[s],S=this.Items.childList.last,E=S?this._calcAxisPosition(S)+S[m]:0;if(E>this[m]){for(var A,O=this.Items.children.length-1;O>=0&&this._calcAxisPosition(this.Items.children[O])+this[m]-_>E;O--)A=O;this._lastScrollIndex=A}else this._lastScrollIndex>this.items.length&&(this._lastScrollIndex=this.items.length-1)}}},{key:"_calcCrossDimensionSize",value:function _calcCrossDimensionSize(o){return this._isRow?function getH(o){return getDimension("h",o)||o.renderHeight}(o):this._isColumn?function getW(o){return getDimension("w",o)||o.renderWidth}(o):void 0}},{key:"_calcAxisPosition",value:function _calcAxisPosition(o){return this._isRow?XE(o):this._isColumn?YE(o):void 0}},{key:"_transitionListener",value:function _transitionListener(){this.shouldSmooth=!1,this.transitionDone()}},{key:"_withAfterUpdate",value:function _withAfterUpdate(o){return watchForUpdates({element:o,watchProps:[this._directionPropNames.crossAxis,"w","h","innerW","innerH"],sideEffect:this.queueRequestUpdate.bind(this)})}},{key:"_performRender",value:function _performRender(){}},{key:"_appendItem",value:function _appendItem(o){this.shouldSmooth=!1,o.parentFocus=this.hasFocus(),o=this.Items.childList.a(o);var s=this._directionPropNames.crossDimension;if(!o[s]){var m=this._isRow?this.renderHeight:this.renderWidth;o[s]=o[s]||m}o=this._withAfterUpdate(o)}},{key:"_appendLazyItem",value:function _appendLazyItem(o){this._appendItem(o),this.queueRequestUpdate(),this._refocus()}},{key:"$itemChanged",value:function $itemChanged(){this.queueRequestUpdate()}},{key:"appendItems",value:function appendItems(){var o,s=this,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.shouldSmooth=!1,this._lazyItems?(o=this._lazyItems).push.apply(o,_toConsumableArray(m)):(m.length>this.lazyUpCount+this.lazyUpCountBuffer&&(this._lazyItems=m.splice(this.lazyUpCount+this.lazyUpCountBuffer)),m.forEach((function(o){return s._appendItem(o)})),this.queueRequestUpdate(),this._refocus())}},{key:"appendItemsAt",value:function appendItemsAt(){var o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],m=arguments.length>1?arguments[1]:void 0;if(this._lazyItems&&m>this.items.length-1){var _,S=m-this.items.length;(_=this._lazyItems).splice.apply(_,[S,0].concat(_toConsumableArray(s)))}else{var E=this._directionPropNames,A=E.crossDimension,O=E.lengthDimension,H=E.innerLengthDimension,K=Number.isInteger(m)?m:this.Items.children.length;this.shouldSmooth=!1,this._lastAppendedIdx=K,this._totalAddedLength=0,s.forEach((function(s,m){var _=_objectSpread(_objectSpread({},o._withAfterUpdate(s)),{},{parentFocus:o.hasFocus()});s[A]||(_[A]=s[A]||o.Items[A]),o.Items.childList.addAt(_,K+m);var S=s[O]||s[H]||0,E=s.extraItemSpacing||0;o._totalAddedLength+=S+o.style.itemSpacing+E})),this.selectedIndex>=this._lastAppendedIdx&&(this._selectedPastAdded=!0,this._selectedIndex+=s.length),this.requestUpdate(),this._refocus()}}},{key:"updatePositionOnAxis",value:function updatePositionOnAxis(o,s){var m=this._directionPropNames.axis;this.applySmooth(o,_defineProperty({},m,s),_defineProperty({},m,[s,this.style.itemTransition])),this.shouldSmooth||this._updateTransitionTarget(o,m,s)}},{key:"scrollTo",value:function scrollTo(o){var s=this,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100*this.style.itemTransition.duration;if(null!=o)if(0!==m)for(var _=0;_!==Math.abs(this.selectedIndex-o);_++)setTimeout((function(){s.selectedIndex>o?s.selectPrevious():s.selectNext()}),m*_);else this.selectedIndex=o}},{key:"transitionDone",value:function transitionDone(){}},{key:"shouldScrollLeft",value:function shouldScrollLeft(){return this._isRow&&this._canScrollBack}},{key:"shouldScrollRight",value:function shouldScrollRight(){return this._isRow&&this._canScrollNext}},{key:"shouldScrollUp",value:function shouldScrollUp(){return this._isColumn&&this._canScrollBack}},{key:"shouldScrollDown",value:function shouldScrollDown(){return this._isColumn&&this._canScrollNext}},{key:"_directionPropNames",get:function get(){return zI[this.direction]}},{key:"_canScrollBack",get:function get(){var o=!1;return this._lastScrollIndex?(o=this.selectedIndex<this._lastScrollIndex,void 0!==this._prevLastScrollIndex&&this._prevLastScrollIndex!==this._lastScrollIndex&&(o=!0)):o=this.selectedIndex>=this.scrollIndex,(this._isRow?this._itemsX:this._itemsY)<0&&o}},{key:"_canScrollNext",get:function get(){var o,s=this._directionPropNames,m=s.axis,_=s.lengthDimension,S=this.Items.childList.last;return this._isRow&&(o=Math.abs(this._itemsX-this.w)),this._isColumn&&(o=Math.abs(this.itemPosY-this.h)),this.selectedIndex>this.scrollIndex&&o<S[m]+S[_]}},{key:"_isColumn",get:function get(){return"column"===this.direction}},{key:"_isRow",get:function get(){return"row"===this.direction}},{key:"_itemsX",get:function get(){return XE(this.Items)}},{key:"_getAlwaysScroll",value:function _getAlwaysScroll(){return void 0!==this._alwaysScroll?this._alwaysScroll:this.style.alwaysScroll}},{key:"_getNeverScroll",value:function _getNeverScroll(){return!this.alwaysScroll&&(void 0!==this._neverScroll?this._neverScroll:this.style.neverScroll)}},{key:"_setScrollIndex",value:function _setScrollIndex(o){return o>=0?o:0}},{key:"_getScrollIndex",value:function _getScrollIndex(){return void 0!==this._scrollIndex?this._scrollIndex:this.style.scrollIndex}}],[{key:"__componentName",get:function get(){return"NavigationManager"}},{key:"__themeStyle",get:function get(){return KI}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(NavigationManager),"properties",this)),["alwaysScroll","neverScroll","scrollIndex","autoResizeWidth","autoResizeHeight","lazyUpCount","lazyUpCountBuffer"])}}]),NavigationManager}(),GI=Object.freeze({__proto__:null,base:function base$M(o){return{itemSpacing:o.layout.gutterX.xs,scrollIndex:0,alwaysScroll:!1,neverScroll:!1,itemTransition:_objectSpread(_objectSpread({},o.animation.standardEntrance),{},{duration:o.animation.duration.fast})}}}),qI=function(o){_inherits(Row,WI);var s=_createSuper(Row);function Row(){return _classCallCheck(this,Row),s.apply(this,arguments)}return _createClass(Row,[{key:"_isOnScreenForScrolling",value:function _isOnScreenForScrolling(o){if(!o)return!1;var s=XE(o);if(!Number.isFinite(s))return!1;var m=this.getTransitionXTargetValue(),_=this.core.renderContext.px,S=_+m+s;return o.transition("x")&&(S-=o.x-o.transition("x").targetValue),S>=_&&S+o.w<=_+this.w}},{key:"_shouldScroll",value:function _shouldScroll(){if(this.lazyScroll&&(this.selectedIndex<=this.startLazyScrollIndex||this.selectedIndex>=this.stopLazyScrollIndex))return!0;var o=this.alwaysScroll||this._selectedPastAdded;if(!o&&!this.neverScroll){var s=this._isOnScreenForScrolling(this.selected);o=this.lazyScroll?!s:this.Items.childList.last&&(this.shouldScrollLeft()||this.shouldScrollRight()||!s)}return o}},{key:"_getPrependedOffset",value:function _getPrependedOffset(){return this._selectedPastAdded=!1,this.Items.x-this._totalAddedWidth}},{key:"_getLazyScrollX",value:function _getLazyScrollX(o){var s=this.Items.childList.getIndex(this.prevSelected);if(this._selectedPastAdded)return this._getPrependedOffset();if(this.selectedIndex<=this.startLazyScrollIndex)return this._getScrollX();if(this.selectedIndex>=this.stopLazyScrollIndex&&this.selectedIndex<s)return(this.Items.transition("x")?this.Items.transition("x").targetValue:this.Items.x)+(this.prevSelected.w+this.style.itemSpacing+(this.selected.extraItemSpacing||0));if(o){var m,_=this.Items.childList.getIndex(o),S=this.selected.transition("x")?this.selected.transition("x").targetValue:this.selected.x;if(-1===_)return;return _>this.selectedIndex?m=-S:_<this.selectedIndex&&(m=this.w-S-this.selected.w),m}return this._getScrollX()}},{key:"_getScrollX",value:function _getScrollX(){if(this._selectedPastAdded)return this._getPrependedOffset();var o,s=this.selectedIndex-this.scrollIndex;return(s=s<0?0:s)===this._firstFocusableIndex()&&(s=0),this.Items.children[s]&&(o=this.Items.children[s].transition("x")?-this.Items.children[s].transition("x").targetValue:-this.Items.children[s].x),o}},{key:"_render",value:function _render(o,s){var m;this.plinko&&s&&s.selected&&(o.selectedIndex=this._getIndexOfItemNear(o,s)),this._prevLastScrollIndex=this._lastScrollIndex,this.Items.children.length?this._shouldScroll()&&(m=this.lazyScroll&&s?this._getLazyScrollX(s):this._getScrollX()):m=this.itemPosX,void 0!==m&&this.updatePositionOnAxis(this.Items,m),this.onScreenEffect(this.onScreenItems)}},{key:"_performRender",value:function _performRender(){this._render(this.selected,this.prevSelected)}},{key:"_isOnScreen",value:function _isOnScreen(o){return!!o&&this._isComponentHorizontallyVisible(o)}},{key:"onScreenEffect",value:function onScreenEffect(){}},{key:"_totalAddedWidth",get:function get(){return this._totalAddedLength}},{key:"_getLazyScroll",value:function _getLazyScroll(){return!this.alwaysScroll&&(void 0!==this._lazyScroll?this._lazyScroll:this.style.lazyScroll)}},{key:"_getNeverScroll",value:function _getNeverScroll(){return!this.alwaysScroll&&!this.lazyScroll&&(void 0!==this._neverScroll?this._neverScroll:this.style.neverScroll)}}],[{key:"__componentName",get:function get(){return"Row"}},{key:"__themeStyle",get:function get(){return GI}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(Row),"_template",this).call(this)),{},{direction:"row"})}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Row),"properties",this)),["lazyScroll","startLazyScrollIndex","stopLazyScrollIndex"])}}]),Row}(),XI=Object.freeze({__proto__:null,base:function base$L(o){return{backgroundColor:o.color.fillNeutralTertiary,radius:o.radius.md,animation:{}}},mode:function mode$f(o){return{focused:{backgroundColor:o.color.interactiveNeutralFocus,tone:{inverse:{backgroundColor:o.color.interactiveInverseFocus}}},disabled:{backgroundColor:o.color.fillNeutralDisabled}}}}),YI=function(o){_inherits(Surface,DI);var s=_createSuper(Surface);function Surface(){return _classCallCheck(this,Surface),s.apply(this,arguments)}return _createClass(Surface,[{key:"innerH",get:function get(){return this.h}},{key:"innerW",get:function get(){return this.w}},{key:"_update",value:function _update(){this._updateLayout(),this._updateScale()}},{key:"_updateLayout",value:function _updateLayout(){this._Background.patch({texture:E.Tools.getRoundRect(this.innerW-2,this.innerH-2,this.style.radius,0,null,!0,this.style.backgroundColor)})}},{key:"_updateScale",value:function _updateScale(){var o=this._isFocusedMode?this.getFocusScale(this.w,this.h):this.getUnfocusScale(this.w,this.h);this.applySmooth(this,{scale:o},{scale:[o,this.style.animation]})}}],[{key:"_template",value:function _template(){return{Background:{}}}},{key:"__componentName",get:function get(){return"Surface"}},{key:"__themeStyle",get:function get(){return XI}},{key:"properties",get:function get(){return[]}},{key:"tags",get:function get(){return["Background"]}}]),Surface}(),QI=Object.freeze({__proto__:null,base:function base$K(o){return{offsetY:o.spacer.xxs,offsetX:0,textStyle:o.typography.body1}},tone:function tone$l(o){return{neutral:{textStyle:{textColor:o.color.fillNeutral}},inverse:{textStyle:{textColor:o.color.fillInverse}},brand:{textStyle:{textColor:o.color.fillBrand}}}}}),JI=Object.freeze({__proto__:null,base:function base$J(o){return{textY:0,iconW:o.spacer.xxl+o.spacer.xs,iconH:o.spacer.xxl+o.spacer.xs,contentSpacing:o.spacer.md,marginBottom:o.typography.body1.lineHeight/-10,textStyle:_objectSpread(_objectSpread({},o.typography.body1),{},{verticalAlign:"bottom"}),maxLines:1,justify:"flex-start"}}}),ZI=function isText(o){return"string"==typeof o||!!o.text},eA=function isIcon(o){return!!o.icon},tA=function(o){_inherits(InlineContent,DI);var s=_createSuper(InlineContent);function InlineContent(){return _classCallCheck(this,InlineContent),s.apply(this,arguments)}return _createClass(InlineContent,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(InlineContent.prototype),"_construct",this).call(this),this._maxLinesSuffix=".."}},{key:"_update",value:function _update(){this._updateContent(),this._waitForComponentLoad()}},{key:"_updateContent",value:function _updateContent(){var o=this;this.childList.clear(),this._shouldTruncate&&(this.alpha=.001),this._parsedContent&&this._parsedContent.length&&(this.patch({flex:{direction:"row",wrap:!!this.contentWrap,justifyContent:null!=this.justify?this.justify:this.style.justify}}),this._parsedContent.forEach((function(s,m){var _=m===o._parsedContent.length-1,S={flexItem:_objectSpread(_objectSpread({},o.contentProperties),{},{marginBottom:_?0:o._marginBottom,marginRight:_?0:o.contentProperties.marginRight||o.style.contentSpacing})};ZI(s)?("string"==typeof o._parsedContent[m+1]&&(S.flexItem.marginRight=0),o.childList.a(o._createText(S,s))):eA(s)?o.childList.a(o._createIcon(S,s)):function isBadge(o){return!!o.badge}(s)?o.childList.a(o._createBadge(S,s.badge)):s.newline&&o.contentWrap&&o.childList.a({h:0,w:o.w})})))}},{key:"_waitForComponentLoad",value:function _waitForComponentLoad(){var o=this;this.children.length?Promise.all(this.children.map((function(s){return new Promise((function(m){0===s.h&&s.w===o.w?m():s.on("txLoaded",m)}))}))).finally((function(){return o._contentLoaded()})):(this.h=0,this._contentLoaded())}},{key:"_notifyAncestors",value:function _notifyAncestors(){this.fireAncestors("$loadedInlineContent",this),this.signal("loadedInlineContent",this.finalW,this.multiLineHeight)}},{key:"_contentLoaded",value:function _contentLoaded(){var o=this;this.children.length?setTimeout((function(){o.multiLineHeight=o.finalH,o.flex&&o.flex._layout&&o.flex._layout._lineLayouter&&o.flex._layout._lineLayouter._lines?(o.multiLineHeight=o.style.textStyle.lineHeight*o.flex._layout._lineLayouter._lines.length,o.h=o.multiLineHeight,o._shouldTruncate&&o._renderMaxLines(),o._notifyAncestors()):o._contentLoaded()}),10):this._notifyAncestors()}},{key:"_renderMaxLines",value:function _renderMaxLines(){var o=this,s=this._calcChildrenDimensions();this.childList.clear(),s.forEach((function(m,_){var S=s[_+1],E=!S||m.line===o.maxLines&&S.line>o.maxLines;m.line<=o.maxLines&&(E&&_!==s.length-1?o._addSuffix(m):o.childList.add(m.component))})),this.alpha=1}},{key:"_calcChildrenDimensions",value:function _calcChildrenDimensions(){var o=this,s=0,m=1;return this.children.reduce((function(_,S){var E,A,O,H=S;if(S.w==o.w&&0===S.h)return m++,s=O,_;ZI(S)?(E="text",A=S.text.text,O=S.texture.getRenderWidth()):eA(S)?(E="icon",O=S.w):"Badge"===S.constructor.__componentName&&(E="badge",O=S.w),s+=O,s+=S.flexItem.marginRight,Math.ceil(s)>=o.w&&(m++,s=O);var K={type:E,component:H,content:A,line:m};return _.push(K),_}),[])}},{key:"_addSuffix",value:function _addSuffix(o){var s,m=o.type,_=o.component,S=o.content,E=-1*_.flexItem.marginRight;s="text"===m?this._createText({flexItem:this.contentProperties},"".concat(S.trim()).concat(this.maxLinesSuffix)):this._createText({flexItem:_objectSpread(_objectSpread({},this.contentProperties),{},{marginLeft:E})},this.maxLinesSuffix),this.childList.add(s)}},{key:"_createIcon",value:function _createIcon(o,s){var m=(this.textHeight>this.style.textStyle.lineHeight?this.textHeight:this.style.textStyle.lineHeight)-this.style.iconH;return _objectSpread(_objectSpread({},o),{},{type:BI,y:m,w:this.style.iconW,h:this.style.iconH,signals:{itemChanged:"_updateIconPosition"}},s)}},{key:"_createText",value:function _createText(o,s){var m="string"==typeof s.style?this.customStyleMappings[s.style]:s.style;return _objectSpread(_objectSpread({},o),{},{y:void 0!==this.textY?this.textY:this.style.textY,h:this.textHeight,text:_objectSpread(_objectSpread(_objectSpread({},this.style.textStyle),m),{},{text:s.text||s})})}},{key:"_createBadge",value:function _createBadge(o,s){return _objectSpread(_objectSpread(_objectSpread({},o),{},{y:this.badgeY||0},this.badgeProperties),{},{type:$I,title:s,signals:{loadedBadge:"_loadedBadge"}})}},{key:"_updateIconPosition",value:function _updateIconPosition(o){o.y=this.style.textStyle.lineHeight-o.h}},{key:"_loadedBadge",value:function _loadedBadge(o){void 0===this.badgeY&&(o.y=this.style.textStyle.lineHeight-o.h)}},{key:"_formatSpaces",value:function _formatSpaces(o){var s=/(\s+)/;return flatten$1((o||[]).reduce((function(o,m){var _=m;if(ZI(m)){if("object"===_typeof(m)){var S=m.text.split(s).map((function(o){return _objectSpread(_objectSpread({},m),{},{text:o.trim()})}));return o.push.apply(o,_toConsumableArray(S)),o}_=m.split(s)}return o.push(_),o}),[])).map((function(o,s,m){return" "!==o&&(" "===m[s+1]?o+" ":o)})).filter(Boolean)}},{key:"_setContent",value:function _setContent(o){if(o!==this._content){this._content=o;var s=this._content;o&&!Array.isArray(o)&&(s=function parseInlineContent(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=[];if(o&&"string"==typeof o||o.text){var m="string"==typeof o?o:o.text,_=/^{ICON:(.*?)?\|(.*?)?}$/g,S=/^{BADGE:(.*?)}$/g,E=/^{NEWLINE}$/g,A=/^{TEXT:(.*?)?\|(.*?)?}$/g,O=m.split(JE);O&&O.length&&O.forEach((function(o){var m=o,O=S.exec(o),H=_.exec(o),K=E.exec(o),z=A.exec(o);O&&O[1]?m={badge:O[1]}:H&&H[1]?m={title:H[1],icon:H[2]||H[1]}:K?m={newline:!0}:z&&z[1]&&(m={text:z[1],style:z[2]}),s.push(m)}))}return s}(o)),this._parsedContent=this._formatSpaces(s)}return o}},{key:"_setBadgeProperties",value:function _setBadgeProperties(o){if("object"===_typeof(o))return o}},{key:"_getBadgeProperties",value:function _getBadgeProperties(){return this._badgeProperties||{}}},{key:"_setContentProperties",value:function _setContentProperties(o){if("object"===_typeof(o))return o}},{key:"_getContentProperties",value:function _getContentProperties(){return this._contentProperties||{}}},{key:"_setCustomStyleMappings",value:function _setCustomStyleMappings(o){if("object"===_typeof(o))return o}},{key:"_getCustomStyleMappings",value:function _getCustomStyleMappings(){return this._customStyleMappings||{}}},{key:"textHeight",get:function get(){return this.style.textStyle.lineHeight||this.style.textStyle.fontSize}},{key:"_marginBottom",get:function get(){return void 0!==this.contentProperties.marginBottom?this.contentProperties.marginBottom:this.style.marginBottom?this.style.marginBottom:0}},{key:"_shouldTruncate",get:function get(){return this.contentWrap&&this.maxLines}},{key:"announce",get:function get(){if(this._announce)return this._announce;var o=this._parsedContent&&this._parsedContent.reduce((function(o,s){return"string"==typeof s?o+=s:s.announce?o+=s.announce:s.text?o+=s.text:s.title?o+=s.title:s.badge&&(o+=s.badge),o+" "}),"");return o?o.replace(/\s+(?=\s)|\s$/g,""):""},set:function set(o){_set(_getPrototypeOf(InlineContent.prototype),"announce",o,this,!0)}}],[{key:"properties",get:function get(){return["content","contentProperties","badgeY","badgeProperties","justify","contentWrap","customStyleMappings","maxLines","maxLinesSuffix"]}},{key:"__componentName",get:function get(){return"InlineContent"}},{key:"__themeStyle",get:function get(){return JI}}]),InlineContent}(),nA=Object.freeze({__proto__:null,base:function base$I(o){return{fadeW:o.layout.gutterX.lg,offset:o.spacer.xxl,shouldSmooth:!1,textStyle:o.typography.body1}}}),rA=function(o){_inherits(FadeShader,E.shaders.WebGLDefaultShader);var s=_createSuper(FadeShader);function FadeShader(o){var m;return _classCallCheck(this,FadeShader),(m=s.call(this,o))._margin={left:0,right:0},m}return _createClass(FadeShader,[{key:"positionLeft",set:function set(o){this._positionLeft=o}},{key:"positionRight",set:function set(o){this._positionRight=o}},{key:"setupUniforms",value:function setupUniforms(o){_get(_getPrototypeOf(FadeShader.prototype),"setupUniforms",this).call(this,o);var s=o.shaderOwner;0===this._positionLeft&&(this._positionLeft=.001),0===this._positionRight&&(this._positionRight=.001);var m=this.ctx.stage.getRenderPrecision();this._setUniform("margin",[this._positionLeft*m,this._positionRight*m],this.gl.uniform1fv),this._setUniform("resolution",new Float32Array([s._w*m,s._h*m]),this.gl.uniform2fv)}}]),FadeShader}();rA.fragmentShaderSource="\n  #ifdef GL_ES\n  # ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  # else\n  precision lowp float;\n  # endif\n  #endif\n\n  #define PI 3.14159265359\n\n  varying vec2 vTextureCoord;\n  varying vec4 vColor;\n\n  uniform sampler2D uSampler;\n  uniform vec2 resolution;\n  uniform float margin[2];\n\n  void main() {\n      vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n      vec2 halfRes = 0.5 * resolution.xy;\n      vec2 point = vTextureCoord.xy * resolution;\n\n\n      vec2 pos1 = vec2(point.x, point.y);\n      vec2 pos2 = pos1;\n      pos2.x += margin[0];\n\n      vec2 d = pos2 - pos1;\n      float t = dot(pos1, d) / dot(d, d);\n      t = smoothstep(0.0, 1.0, clamp(t, 0.0, 1.0));\n\n      vec2 pos3 = vec2(vTextureCoord.x * resolution.x, vTextureCoord.y);\n      pos3.x -= resolution.x - margin[1];\n      vec2 pos4 = vec2(vTextureCoord.x + margin[1], vTextureCoord.y);\n\n      vec2 d2 = pos4 - pos3;\n      float t2 = dot(pos3, d2) / dot(d2, d2);\n      t2 = smoothstep(0.0, 1.0, clamp(t2, 0.0, 1.0));\n\n      color = mix(vec4(0.0), color, t);\n      color = mix(color, vec4(0.0), t2);\n\n      gl_FragColor = color;\n  }\n";var iA=function(o){_inherits(Marquee,DI);var s=_createSuper(Marquee);function Marquee(){return _classCallCheck(this,Marquee),s.apply(this,arguments)}return _createClass(Marquee,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(Marquee.prototype),"_construct",this).call(this),this._scrolling=!1,this._autoStart=!1,this._centerAlign=!1}},{key:"_init",value:function _init(){this._Content.on("txLoaded",this._updateContentTexture.bind(this)),_get(_getPrototypeOf(Marquee.prototype),"_init",this).call(this)}},{key:"_updateContentTexture",value:function _updateContentTexture(){var o=this._restartScrolling;this.stopScrolling(),this._currentTexture.h||(this._ContentClipper.h=this._currentTexture.text&&this._currentTexture.text.lineHeight?this._currentTexture.text.lineHeight:this._Content.finalH),this._shouldClip?this._updateShader():(this._ContentClipper.shader=null,this._positionTexture()),o&&this.startScrolling(),this.signal("marqueeContentLoaded")}},{key:"_update",value:function _update(){this._updateColor(),this._updateTexture(),this._updateShader(),this._restartScrolling&&this.startScrolling()}},{key:"_restartScrolling",get:function get(){return this.autoStart||this._scrolling||this._shouldTryScrolling}},{key:"_updateColor",value:function _updateColor(){this.color&&(this._Content.smooth={color:eI.getValidColor(this.color)})}},{key:"_currentTexture",get:function get(){return this._Content.text||this._Content.texture||{}}},{key:"_updateTexture",value:function _updateTexture(){var o={rtt:!0};this.contentTexture?o.texture=this.contentTexture:this.title&&(o.text=_objectSpread(_objectSpread(_objectSpread({},this.style.textStyle),this.title),{},{text:this.textContent})),this.patch({ContentClipper:{w:this.w+14,ContentBox:{Content:o,ContentLoopTexture:{}}}}),this.signal("marqueeContentLoaded")}},{key:"_updateShader",value:function _updateShader(){this._ContentClipper.patch({w:this.w>0?this.w+this.style.fadeW/2:0,shader:{type:rA,positionLeft:0,positionRight:this.style.fadeW},rtt:!0})}},{key:"_updateAnimation",value:function _updateAnimation(){this._scrollAnimation&&this._scrollAnimation.stopNow(),this._scrollAnimation=this.animation({duration:this._loopWidth/50,delay:isNaN(this.delay)?1.5:this.delay,repeat:isNaN(this.repeat)?-1:this.repeat,actions:[{t:"ContentBox",p:"x",v:{sm:0,0:{v:0},.5:{v:-(this._loopWidth+this.style.offset)}}},{t:"ContentClipper",p:"shader.positionLeft",v:{sm:0,0:{v:0},.1:{v:this.style.fadeW},.4:{v:this.style.fadeW},.5:{v:0}}}]})}},{key:"_positionTexture",value:function _positionTexture(){var o=this._shouldCenter()?(this.w-this._textRenderedW)/2:0;this.style.shouldSmooth?this._ContentBox.smooth={x:o}:this._ContentBox.x=o}},{key:"startScrolling",value:function startScrolling(){this._Content.off("txLoaded",this.startScrolling.bind(this)),this._shouldTryScrolling=!0,0===this._textRenderedW&&this._Content.on("txLoaded",this.startScrolling.bind(this)),this._shouldClip?(this._scrolling=!0,this._ContentLoopTexture.x=this._loopWidth+this.style.offset,this._ContentLoopTexture.texture=this._Content.getTexture(),this._updateAnimation(),this._scrollAnimation.start()):this._scrolling=!1}},{key:"stopScrolling",value:function stopScrolling(){this._shouldTryScrolling=!1,this._scrolling=!1,this._scrollAnimation&&(this._scrollAnimation.stopNow(),this._ContentLoopTexture.texture=null)}},{key:"_shouldClip",get:function get(){return this._textRenderedW>this.w-this.style.fadeW/4}},{key:"_shouldCenter",value:function _shouldCenter(){return this._centerAlign||this._Content.text&&"center"===this._Content.text.textAlign}},{key:"_setAutoStart",value:function _setAutoStart(o){return this.autoStart&&!o&&this._updateContentTexture(),o}},{key:"_setCenterAlign",value:function _setCenterAlign(o){return this._centerAlign=o,this._updateContentTexture(),o}},{key:"textContent",get:function get(){var o,s,m;return null!==(o=null!==(s=null===(m=this.title)||void 0===m?void 0:m.text)&&void 0!==s?s:this.title)&&void 0!==o?o:""}},{key:"_loopWidth",get:function get(){return this.overrideLoopX||this._textRenderedW}},{key:"_textRenderedW",get:function get(){return this._Content.renderWidth}},{key:"announce",get:function get(){return this._announce||this.title&&this.title.text},set:function set(o){_set(_getPrototypeOf(Marquee.prototype),"announce",o,this,!0)}}],[{key:"_template",value:function _template(){return{ContentClipper:{boundsMargin:[],ContentBox:{Content:{},ContentLoopTexture:{}}}}}},{key:"__componentName",get:function get(){return"Marquee"}},{key:"__themeStyle",get:function get(){return nA}},{key:"tags",get:function get(){return["ContentClipper",{name:"ContentBox",path:"ContentClipper.ContentBox"},{name:"Content",path:"ContentClipper.ContentBox.Content"},{name:"ContentLoopTexture",path:"ContentClipper.ContentBox.ContentLoopTexture"}]}},{key:"properties",get:function get(){return["autoStart","title","contentTexture","color","centerAlign","delay","repeat","overrideLoopX"]}}]),Marquee}(),aA=Object.entries(Object.getOwnPropertyDescriptors(E.textures.TextTexture.prototype)).reduce((function(o,s){var m=_slicedToArray(s,1)[0],_=E.textures.TextTexture.prototype[m];return m.startsWith("_")||["undefined","function"].includes(_typeof(_))?o:_objectSpread(_defineProperty({},m,_),o)}),{}),oA=function(o){_inherits(TextBox,DI);var s=_createSuper(TextBox);function TextBox(){return _classCallCheck(this,TextBox),s.apply(this,arguments)}return _createClass(TextBox,[{key:"_setDimensions",value:function _setDimensions(o,s){var m=o,_=s;this._isInlineContent||(m=this._Text.texture.getRenderWidth(),_=this._Text.texture.getRenderHeight());var S=this.w!==m||this.h!==_;m&&_&&S&&(this.h=_,this.fixed||(this.w=m),this.alpha<1&&(this.alpha=1),this._notifyAncestors())}},{key:"_setContent",value:function _setContent(o){return this._isInlineContent=!1,(Array.isArray(o)||eI.isMarkupString(o))&&(this._isInlineContent=!0),"string"==typeof o||this._isInlineContent?o:""}},{key:"title",get:function get(){return this._content}},{key:"_notifyAncestors",value:function _notifyAncestors(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.w,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.h;this.fireAncestors("$itemChanged"),this.signal("textBoxChanged",{w:o,h:s})}},{key:"_construct",value:function _construct(){_get(_getPrototypeOf(TextBox.prototype),"_construct",this).call(this),this._marqueeContentListenerAttached=!1,this._marqueeOverrideLoopX=void 0,this._resetMarqueePromise()}},{key:"_update",value:function _update(){this.content?(this._isInlineContent?this._updateInlineContent():this._updateText(),this._updateMarquee()):(this._Text||this._InlineContent)&&(this.w=this.h=0,this._notifyAncestors(),this._updateMarquee(),this.patch({Text:void 0,InlineContent:void 0}))}},{key:"_updateInlineContent",value:function _updateInlineContent(){var o=this;this.patch({Text:void 0});var s=tA.properties.reduce((function(s,m){return null!=o[m]&&(s[m]=o[m]),s}),{});this._textStyleSet.wordWrapWidth&&(s.w=this._textStyleSet.wordWrapWidth,s.rtt=!0),this._textStyleSet.maxLines&&(s.maxLines=this._textStyleSet.maxLines),this._textStyleSet.maxLinesSuffix&&(s.maxLinesSuffix=this._textStyleSet.maxLinesSuffix),this._textStyleSet.textAlign&&(s.justify=eI.convertTextAlignToFlexJustify(this._textStyleSet.textAlign)),this.patch({alpha:1,InlineContent:_objectSpread(_objectSpread({type:tA,w:this.w},s),{},{signals:{loadedInlineContent:"_setDimensions"}})})}},{key:"_updateText",value:function _updateText(){this.patch({InlineContent:void 0}),this._Text||(this.patch({Text:{}}),this._Text.on("txLoaded",this._setDimensions.bind(this)));var o=this._textStyleSet;this._Text&&this._Text.patch({y:this.style.offsetY,x:this.style.offsetX,text:_objectSpread(_objectSpread({},aA),o)})}},{key:"marqueeOverrideLoopX",get:function get(){return this._marqueeOverrideLoopX},set:function set(o){this._marqueeOverrideLoopX=o,this._Marquee&&(this._Marquee.overrideLoopX=this._marqueeOverrideLoopX),this._resolveAwaitMarqueeOverrideX()}},{key:"_resetMarqueePromise",value:function _resetMarqueePromise(){var o=this;this._awaitMarqueeOverrideX=new Promise((function(s,m){o._resolveAwaitMarqueeOverrideX=s,o._rejectAwaitMarqueeOverrideX=m}))}},{key:"_loadedMarqueeContent",value:function _loadedMarqueeContent(){this.signal("willMarquee",this._Marquee)}},{key:"_updateMarquee",value:function _updateMarquee(){var o=this,s=this._isInlineContent?this._InlineContent:this._Text;if(this._Marquee&&!this.marquee&&this._toggleMarquee(s),this.marquee){this._resetMarqueePromise();var m={w:this._textStyleSet.wordWrapWidth||this.w,h:this.h,y:this.style.offsetY,x:this.style.offsetX,signals:{marqueeContentLoaded:"_loadedMarqueeContent"}};this._Marquee||(m.type=iA),this._isInlineContent?(this._InlineContent.w=0,m.contentTexture=s.getTexture(),m.w=this._textStyleSet.wordWrapWidth||this.w):m.title=_objectSpread(_objectSpread({text:s.text.text},this._textStyleSet),{},{wordWrapWidth:0,maxLines:1}),this.patch({Marquee:m}),this._marqueeContentListenerAttached||(this._marqueeContentListenerAttached=!0),void 0!==this._marqueeOverrideLoopX?this._awaitMarqueeOverrideX.then((function(){o._toggleMarquee(s)})):this._toggleMarquee(s)}}},{key:"_textStyleSet",get:function get(){var o=this,s=_objectSpread(_objectSpread({},this.theme.typography.body1),null!==this.style.textStyle&&"object"===_typeof(this.style.textStyle)&&Object.keys(this.style.textStyle)?this.style.textStyle:this.theme.typography[this.style.textStyle]);return this.constructor.properties.forEach((function(m){"fontStyle"!==m&&void 0!==o["_".concat(m)]&&(s["content"===m?"text":m]=o["_".concat(m)])})),this.w&&!this._isInlineContent&&!this.style.textStyle.wordWrapWidth&&this.fixed&&(s.wordWrapWidth=this.w),s}},{key:"_toggleMarquee",value:function _toggleMarquee(o){this.marquee?(o.alpha=.001,this._Marquee.alpha=1,this._Marquee.startScrolling()):(o.alpha=1,this._Marquee.alpha=.001,this._Marquee.stopScrolling())}},{key:"toggleMarquee",value:function toggleMarquee(){var o=this._isInlineContent?this._InlineContent:this._Text;this._toggleMarquee(o)}},{key:"announce",get:function get(){return this._announce||(this._isInlineContent&&this._InlineContent?this._InlineContent.announce:this.content)},set:function set(o){_set(_getPrototypeOf(TextBox.prototype),"announce",o,this,!0)}},{key:"smooth",set:function set(o){hI.warn("warning: value smoothing is known to cause bugs with the TextBox - patch updated values instead."),_set(_getPrototypeOf(TextBox.prototype),"smooth",o,this,!0)}}],[{key:"_template",value:function _template(){return{alpha:.001}}},{key:"__componentName",get:function get(){return"TextBox"}},{key:"__themeStyle",get:function get(){return QI}},{key:"tags",get:function get(){return["InlineContent","Marquee","Text"]}},{key:"properties",get:function get(){return["content","fixed","marquee"].concat(_toConsumableArray(tA.properties))}}]),TextBox}(),sA=function(o){_inherits(Button,YI);var s=_createSuper(Button);function Button(){return _classCallCheck(this,Button),s.apply(this,arguments)}return _createClass(Button,[{key:"_update",value:function _update(){this._updatePrefix(),this._updateTitle(),this._updateSuffix(),this._updateAllPositioning(),this._updateTruncation()}},{key:"_updateAllPositioning",value:function _updateAllPositioning(){this._updatePositions(),this._updateContentDimensions(),this._updateSurfaceDimensions(),this._updateContentPosition(),_get(_getPrototypeOf(Button.prototype),"_update",this).call(this)}},{key:"$itemChanged",value:function $itemChanged(){this._updateAllPositioning(),this._updateTruncation()}},{key:"_onTitleTextBoxChanged",value:function _onTitleTextBoxChanged(){this._updateAllPositioning()}},{key:"_updatePositions",value:function _updatePositions(){this._hasPrefix&&(this._Prefix.x=this._prefixX),this._hasTitle&&(this._TextWrapper.x=this._titleX),this._hasSuffix&&(this._Suffix.x=this._suffixX)}},{key:"_updatePrefix",value:function _updatePrefix(){if(this.prefix){var o={style:{itemSpacing:this.style.itemSpacing}};this._Prefix||(o=_objectSpread(_objectSpread({},this._rowProps),o)),this._Content.patch({Prefix:o}),this._Prefix.items=this._addButtonProps(this.prefix)}else this._Content.patch({Prefix:void 0})}},{key:"_updateTitle",value:function _updateTitle(){if(this._hasTitle){var o={content:this.title,style:{textStyle:this.style.textStyle}};this._Title||(o=_objectSpread({type:oA,mountY:.5,y:function y(o){return o/2},signals:{textBoxChanged:"_onTitleTextBoxChanged"}},o)),this._Content.patch({TextWrapper:{mountY:.5,Title:o}})}else this._Content.patch({TextWrapper:{Title:void 0}})}},{key:"_updateSuffix",value:function _updateSuffix(){if(this.suffix){var o={style:{itemSpacing:this.style.itemSpacing}};this._Suffix||(o=_objectSpread(_objectSpread({},this._rowProps),o)),this._Content.patch({Suffix:o}),this._Suffix.items=this._addButtonProps(this.suffix)}else this._Content.patch({Suffix:void 0})}},{key:"_updateTruncation",value:function _updateTruncation(){this._Title&&this._Title.patch({style:{textStyle:_objectSpread(_objectSpread({},this.style.textStyle),{},{wordWrap:this.fixed,wordWrapWidth:this.fixed?this._fixedWordWrapWidth:0})}})}},{key:"_updateContentDimensions",value:function _updateContentDimensions(){var o={},s=this.h/2;this._Content.transition("w").targetValue!==this._contentW&&(this._Content.w=this._contentW),this._Content.y!==s&&(o.y=s),Object.keys(o).length>0&&this.applySmooth(this._Content,o)}},{key:"_updateContentPosition",value:function _updateContentPosition(){this._Content.patch(this._contentProps)}},{key:"_updateSurfaceDimensions",value:function _updateSurfaceDimensions(){var o=this.w;(o=this.fixed?this._w:!this._hasTitle&&(this._hasPrefix||this._hasSuffix)||this._Title&&!this._Title.visible&&(this._hasPrefix||this._hasSuffix)?this._contentW+this._paddingX:Math.max(this._contentW+this._paddingX,this.style.minWidth))!==this.w&&(this.w=o),this.fireAncestors("$itemChanged")}},{key:"_addButtonProps",value:function _addButtonProps(o){var s=this;return(Array.isArray(o)?o:[o]).map((function(o){return _objectSpread(_objectSpread(_objectSpread({},s._buttonProps),o),{},{style:_objectSpread({color:s.style.contentColor},o.style)})}))}},{key:"_getJustify",value:function _getJustify(){return this._justify?this._justify:this.style.justify}},{key:"_contentProps",get:function get(){var o,s;switch(this.justify){case"left":o=0,s=this._paddingLeft;break;case"right":o=1,s=this.w-this._paddingRight;break;default:o=.5,s=this.w/2}return{mountX:o,x:s}}},{key:"_buttonProps",get:function get(){return{centerInParent:!0,mode:this.mode}}},{key:"_hasPrefix",get:function get(){return!(!this.prefix||!Object.keys(this.prefix).length)}},{key:"_prefixW",get:function get(){return this._hasPrefix?this._Prefix.w:0}},{key:"_prefixX",get:function get(){return 0}},{key:"_hasTitle",get:function get(){return!!this.title}},{key:"_titleW",get:function get(){return this._hasTitle&&this._Title&&this._Title._Text&&this._Title.visible?this._Title.w:0}},{key:"_titleX",get:function get(){return this._hasPrefix?this._prefixW+this.style.titlePadding:0}},{key:"_hasSuffix",get:function get(){return!(!this.suffix||!Object.keys(this.suffix).length)}},{key:"_suffixW",get:function get(){return this._hasSuffix?this._Suffix.w:0}},{key:"_suffixX",get:function get(){return this._hasTitle?this._titleW+this._TextWrapper.x+this.style.titlePadding:this._hasPrefix?this._prefixW+this.style.itemSpacing:0}},{key:"_contentW",get:function get(){return this._hasSuffix?this._suffixX+this._suffixW:this._hasTitle&&this._Title&&this._Title.visible?this._titleX+this._titleW:this._hasPrefix?this._prefixX+this._prefixW:0}},{key:"_rowProps",get:function get(){return{type:qI,mountY:.5,autoResizeHeight:!0,autoResizeWidth:!0}}},{key:"_totalTitlePaddingX",get:function get(){var o=0;return this._hasPrefix&&(o+=this.style.titlePadding),this._hasSuffix&&(o+=this.style.titlePadding),o}},{key:"_fixedWordWrapWidth",get:function get(){var o=this.w,s=this._paddingX+this._prefixW+this._suffixW+this._totalTitlePaddingX;return Math.max(1,o-s)}},{key:"announce",get:function get(){if(this._announce)return this._announce;var o=[];return this.title&&o.push(this.title),o.push(this._announceComponentName),this._hasPrefix&&this._Prefix.items.length&&o.push.apply(o,_toConsumableArray(this._Prefix.items.map((function(o){return o.announce})))),this._hasSuffix&&this._Suffix.items.length&&o.push.apply(o,_toConsumableArray(this._Suffix.items.map((function(o){return o.announce})))),o},set:function set(o){_set(_getPrototypeOf(Button.prototype),"announce",o,this,!0)}},{key:"_announceComponentName",get:function get(){return Button.__componentName}},{key:"_paddingX",get:function get(){return this._paddingLeft+this._paddingRight}},{key:"_paddingLeft",get:function get(){return this._hasTitle?this.style.paddingX:this.style.paddingXNoTitle}},{key:"_paddingRight",get:function get(){return this._hasTitle?this.style.paddingX:this.style.paddingXNoTitle}}],[{key:"__componentName",get:function get(){return"Button"}},{key:"__themeStyle",get:function get(){return VI}},{key:"properties",get:function get(){return["fixed","justify","prefix","suffix","title"]}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Button),"tags",this)),["Content",{name:"TextWrapper",path:"Content.TextWrapper"},{name:"Title",path:"Content.TextWrapper.Title"},{name:"Prefix",path:"Content.Prefix"},{name:"Suffix",path:"Content.Suffix"}])}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(Button),"_template",this).call(this)),{},{Content:{mount:.5,x:function x(o){return o/2},y:function y(o){return o/2},zIndex:2}})}}]),Button}(),uA=Object.freeze({__proto__:null,base:function base$H(o){return{h:8*o.spacer.md,minWidth:getWidthByColumnSpan(o,1),paddingX:o.spacer.xxl,prefixH:o.spacer.xl,suffixH:o.spacer.xl,textStyle:o.typography.button2}}}),lA=function(o){_inherits(ButtonSmall,sA);var s=_createSuper(ButtonSmall);function ButtonSmall(){return _classCallCheck(this,ButtonSmall),s.apply(this,arguments)}return _createClass(ButtonSmall,null,[{key:"__componentName",get:function get(){return"ButtonSmall"}},{key:"__themeStyle",get:function get(){return uA}}]),ButtonSmall}(),cA=Object.freeze({__proto__:null,base:function base$G(o){return{h:12*o.spacer.xxl,paddingHorizontal:o.spacer.xl,paddingVertical:o.spacer.xl,radius:o.radius.md,titleTextStyle:_objectSpread(_objectSpread({},o.typography.headline1),{},{wordWrap:!0,maxLines:2,textColor:o.color.textNeutral}),w:eI.getWidthByUpCount(o,6)}},mode:function mode$e(o){return{focused:{tone:{neutral:{backgroundColor:o.color.interactiveNeutralFocusSoft},inverse:{backgroundColor:o.color.interactiveInverseFocusSoft},brand:{backgroundColor:o.color.interactiveBrandFocusSoft}}},disabled:{titleTextStyle:{textColor:o.color.textNeutralDisabled}}}}}),dA=function(o){_inherits(Card,YI);var s=_createSuper(Card);function Card(){return _classCallCheck(this,Card),s.apply(this,arguments)}return _createClass(Card,[{key:"_update",value:function _update(){_get(_getPrototypeOf(Card.prototype),"_update",this).call(this),this._updateTitle(),this._updatePositions()}},{key:"_updatePositions",value:function _updatePositions(){this._updateTitlePosition()}},{key:"_updateTitle",value:function _updateTitle(){this._Title.patch({content:this.title,style:{textStyle:_objectSpread(_objectSpread({},this.style.titleTextStyle),{},{wordWrapWidth:this._calculateTextWidth()})}})}},{key:"_calculateTextWidth",value:function _calculateTextWidth(){return this.w-2*this.style.paddingHorizontal}},{key:"_updateTitlePosition",value:function _updateTitlePosition(){this._Title.x=this.style.paddingHorizontal,this._Title.y=this.style.paddingVertical}},{key:"announce",get:function get(){return this._announce||this._Title&&this._Title.announce},set:function set(o){_set(_getPrototypeOf(Card.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Card"}},{key:"__themeStyle",get:function get(){return cA}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Card),"properties",this)),["title"])}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Card),"tags",this)),["Title"])}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(Card),"_template",this).call(this)),{},{Title:{type:oA,signals:{textBoxChanged:"_updatePositions"}}})}}]),Card}(),hA=Object.freeze({__proto__:null,base:function base$F(o){return{descriptionTextStyle:_objectSpread(_objectSpread({},o.typography.body2),{},{textColor:o.color.textNeutralSecondary,wordWrap:!0,maxLines:3}),detailsTextStyle:_objectSpread(_objectSpread({},o.typography.body3),{},{textColor:o.color.textNeutral,wordWrap:!0,maxLines:1})}},mode:function mode$d(o){return{disabled:{descriptionTextStyle:{textColor:o.color.textNeutralDisabled},detailsTextStyle:{textColor:o.color.textNeutralDisabled}}}}}),pA=function(o){_inherits(CardTitle,dA);var s=_createSuper(CardTitle);function CardTitle(){return _classCallCheck(this,CardTitle),s.apply(this,arguments)}return _createClass(CardTitle,[{key:"_update",value:function _update(){_get(_getPrototypeOf(CardTitle.prototype),"_update",this).call(this),this._updateDescription(),this._updateDetails(),this._updatePositions()}},{key:"_updatePositions",value:function _updatePositions(){_get(_getPrototypeOf(CardTitle.prototype),"_updatePositions",this).call(this),this._updateDescriptionPosition(),this._updateDetailsPosition()}},{key:"_updateDescription",value:function _updateDescription(){this._Description.patch({content:this.description,style:{textStyle:_objectSpread(_objectSpread({},this.style.descriptionTextStyle),{},{wordWrapWidth:this._calculateTextWidth()})}})}},{key:"_updateDescriptionPosition",value:function _updateDescriptionPosition(){this._Description.x=this.style.paddingHorizontal,this._Description.y=this.style.paddingVertical+this._Title.h}},{key:"_updateDetails",value:function _updateDetails(){this._Details.patch({content:this.details,style:{textStyle:_objectSpread(_objectSpread({},this.style.detailsTextStyle),{},{wordWrapWidth:this._calculateTextWidth()})}})}},{key:"_updateDetailsPosition",value:function _updateDetailsPosition(){this._Details.x=this.style.paddingHorizontal,this._Details.y=this.h-this.style.paddingVertical}},{key:"announce",get:function get(){return this._announce||[this._Title&&this._Title.announce,this._Description&&this._Description.announce,this._Details&&this._Details.announce]},set:function set(o){_set(_getPrototypeOf(CardTitle.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"CardTitle"}},{key:"__themeStyle",get:function get(){return hA}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(CardTitle),"tags",this)),["Description","Details"])}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(CardTitle),"properties",this)),["description","details"])}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(CardTitle),"_template",this).call(this)),{},{Description:{type:oA,signals:{textBoxChanged:"_updatePositions"}},Details:{type:oA,mountY:1}})}}]),CardTitle}(),fA=Object.freeze({__proto__:null,base:function base$E(o){return{descriptionTextStyle:_objectSpread(_objectSpread({},o.typography.body2),{},{textColor:o.color.textNeutralSecondary,wordWrap:!0,maxLines:8}),h:15*o.spacer.xxxl,subtitleTextStyle:_objectSpread(_objectSpread({},o.typography.body3),{},{maxLines:2,textColor:o.color.textNeutral,wordWrap:!0}),w:eI.getWidthByColumnSpan(o,4)}},mode:function mode$c(o){return{disabled:{descriptionTextStyle:{textColor:o.color.textNeutralDisabled},subtitleTextStyle:{textColor:o.color.textNeutralDisabled}}}}}),gA=Object.freeze({__proto__:null,base:function base$D(o){var s=o.spacer.xxl;return{alpha:o.alpha.primary,w:s,h:s,knobHeight:s/2,knobWidth:s/2,radius:s/2,strokeWidth:o.stroke.sm}},mode:function mode$b(o){return{disabled:{alpha:o.alpha.inactive}}},tone:function tone$k(o){return{neutral:{backgroundColor:o.color.fillNeutralDisabled,backgroundColorChecked:o.color.fillNeutral,knobColor:o.color.fillInverse,strokeColor:o.color.strokeInverse},inverse:{backgroundColor:o.color.fillInverseDisabled,backgroundColorChecked:o.color.fillInverse,knobColor:o.color.fillNeutral,strokeColor:o.color.strokeNeutral},brand:{backgroundColor:o.color.fillInverseDisabled,backgroundColorChecked:o.color.fillBrand,knobColor:o.color.fillNeutral,strokeColor:o.color.strokeNeutral}}}}),mA=function(o){_inherits(Radio,DI);var s=_createSuper(Radio);function Radio(){return _classCallCheck(this,Radio),s.apply(this,arguments)}return _createClass(Radio,[{key:"_update",value:function _update(){this._updateBody(),this._updateStroke(),this._updateKnob(),this._checkedChanged&&(this.fireAncestors("$announce",this.announce),this._checkedChanged=!1),this._updateOpacity()}},{key:"_updateBody",value:function _updateBody(){var o=this.checked?this.style.backgroundColorChecked:this.style.backgroundColor,s=this.style.radius>=this.w/2?(this.w-this.style.strokeWidth)/2:0;this._Body.patch({texture:E.Tools.getRoundRect(this.w-this.style.strokeWidth,this.h-this.style.strokeWidth,s,null,null,!0,o)})}},{key:"_updateStroke",value:function _updateStroke(){this._Stroke.patch({texture:E.Tools.getRoundRect(this.w,this.h,this.style.radius,this.style.strokeWidth,this.style.strokeColor,!1)})}},{key:"_updateKnob",value:function _updateKnob(){this._Knob.patch({texture:E.Tools.getRoundRect(this.style.knobWidth,this.style.knobHeight,this.style.knobWidth/2,null,null,!0,this.style.knobColor)}),this.applySmooth(this._Knob,{alpha:this.checked?1:0})}},{key:"_updateOpacity",value:function _updateOpacity(){this.applySmooth(this,{alpha:this.style.alpha})}},{key:"_setChecked",value:function _setChecked(o){return this._checkedChanged=o!==this._checked,o}},{key:"toggle",value:function toggle(){return this._isDisabledMode||(this.checked=!this.checked),this}},{key:"_handleEnter",value:function _handleEnter(){return"function"==typeof this.onEnter?this.onEnter(this):(this.toggle(),!1)}},{key:"announce",get:function get(){return this._announce||(this.checked?"Checked":"Unchecked")},set:function set(o){_set(_getPrototypeOf(Radio.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Radio"}},{key:"__themeStyle",get:function get(){return gA}},{key:"_template",value:function _template(){var o={mount:.5,x:function x(o){return o/2},y:function y(o){return o/2}};return{Body:_objectSpread(_objectSpread({rtt:!0},o),{},{Knob:_objectSpread(_objectSpread({},o),{},{alpha:0})}),Stroke:o}}},{key:"tags",get:function get(){return["Knob","Body","Stroke"]}},{key:"properties",get:function get(){return["checked"]}}]),Radio}(),yA=Object.freeze({__proto__:null,base:function base$C(o){var s=o.spacer.xl;return{w:s,h:s,knobHeight:s/2,knobWidth:s/2,radius:s/2}}});!function(o){_inherits(RadioSmall,mA);var s=_createSuper(RadioSmall);function RadioSmall(){return _classCallCheck(this,RadioSmall),s.apply(this,arguments)}_createClass(RadioSmall,null,[{key:"__componentName",get:function get(){return"RadioSmall"}},{key:"__themeStyle",get:function get(){return yA}}])}(),function(o){_inherits(CardRadio,pA);var s=_createSuper(CardRadio);function CardRadio(){return _classCallCheck(this,CardRadio),s.apply(this,arguments)}_createClass(CardRadio,[{key:"_update",value:function _update(){_get(_getPrototypeOf(CardRadio.prototype),"_update",this).call(this),this._updateRadio(),this._updateSubtitle(),this._updatePositions()}},{key:"_updatePositions",value:function _updatePositions(){_get(_getPrototypeOf(CardRadio.prototype),"_updatePositions",this).call(this),this._updateSubtitlePosition()}},{key:"_updateSubtitle",value:function _updateSubtitle(){this._Subtitle.patch({content:this.subtitle,style:{textStyle:_objectSpread(_objectSpread({},this.style.subtitleTextStyle),{},{wordWrapWidth:this._calculateTextWidth()})}})}},{key:"_updateRadio",value:function _updateRadio(){var o=_objectSpread(_objectSpread({},this.radio),{},{mode:this.mode,mountX:1,x:this.w-this.style.paddingHorizontal,y:this.style.paddingVertical});this._Radio||(o.type=mA),this.patch({Radio:o})}},{key:"_updateSubtitlePosition",value:function _updateSubtitlePosition(){this._Subtitle.x=this.style.paddingHorizontal,this._Subtitle.y=this.style.paddingVertical+this._Title.h}},{key:"_updateDescriptionPosition",value:function _updateDescriptionPosition(){this._Description.x=this.style.paddingHorizontal,this._Description.y=2*this.style.paddingVertical+this._Title.h+this._Subtitle.h}},{key:"announce",get:function get(){return this._announce||[this._Title&&this._Title.announce,this._Subtitle&&this._Subtitle.announce,this._Description&&this._Description.announce,this._Details&&this._Details.announce]},set:function set(o){_set(_getPrototypeOf(CardRadio.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"CardRadio"}},{key:"__themeStyle",get:function get(){return fA}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(CardRadio),"properties",this)),["radio","subtitle"])}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(CardRadio),"tags",this)),["Radio","Subtitle"])}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(CardRadio),"_template",this).call(this)),{},{Subtitle:{type:oA,signals:{textBoxChanged:"_updatePositions"}}})}}])}();var vA=Object.freeze({__proto__:null,base:function base$B(o){return{h:5*o.spacer.xxl,iconWidth:o.spacer.xxl,iconHeight:o.spacer.xxl,w:eI.getWidthByColumnSpan(o,3)}}});!function(o){_inherits(CardSection,dA);var s=_createSuper(CardSection);function CardSection(){return _classCallCheck(this,CardSection),s.apply(this,arguments)}_createClass(CardSection,[{key:"_update",value:function _update(){_get(_getPrototypeOf(CardSection.prototype),"_update",this).call(this),this._updateIcon()}},{key:"_updateIcon",value:function _updateIcon(){var o=this.style,s=o.iconWidth,m=o.iconHeight,_={w:s,h:m,icon:this.iconSrc,x:this.w-s-this.style.paddingHorizontal,y:(this._Title.style.textStyle.lineHeight-m)/2+this.style.paddingVertical};this._Icon||(_.type=BI),this.patch({Icon:_})}},{key:"_calculateTextWidth",value:function _calculateTextWidth(){var o=this.w-2*this.style.paddingHorizontal;return this.iconSrc?o-this.iconWidth:o}}],[{key:"__componentName",get:function get(){return"CardSection"}},{key:"__themeStyle",get:function get(){return vA}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(CardSection),"tags",this)),["Icon"])}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(CardSection),"properties",this)),["iconWidth","iconHeight","iconSrc"])}}])}();var _A=Object.freeze({__proto__:null,base:function base$A(o){var s=o.stroke.sm,m=o.spacer.xxl-2*s;return{alpha:o.alpha.primary,w:m,h:m,checkW:o.spacer.lg,checkH:o.spacer.md+o.spacer.xs,checkSrc:o.asset.check,radius:m/2,strokeWidth:s}},mode:function mode$a(o){return{disabled:{alpha:o.alpha.inactive}}},tone:function tone$j(o){return{neutral:{strokeColor:o.color.strokeInverse,checkColor:o.color.textInverse,backgroundColor:o.color.fillNeutralDisabled,backgroundColorChecked:o.color.fillNeutral},inverse:{strokeColor:o.color.strokeNeutral,checkColor:o.color.textNeutral,backgroundColor:o.color.fillInverseDisabled,backgroundColorChecked:o.color.fillInverse},brand:{strokeColor:o.color.strokeNeutral,checkColor:o.color.textNeutral,backgroundColor:o.color.fillInverseDisabled,backgroundColorChecked:o.color.fillBrand}}}}),bA=function(o){_inherits(Checkbox,DI);var s=_createSuper(Checkbox);function Checkbox(){return _classCallCheck(this,Checkbox),s.apply(this,arguments)}return _createClass(Checkbox,[{key:"_update",value:function _update(){this._updateBody(),this._updateStroke(),this._updateCheck(),this._checkedChanged&&(this.fireAncestors("$announce",this.announce),this._checkedChanged=!1),this._updateOpacity()}},{key:"_updateCheck",value:function _updateCheck(){this._Check.patch({w:this.style.checkW,h:this.style.checkH,icon:this.style.checkSrc,style:{color:this.style.checkColor}});var o={alpha:this.checked?1:0};this.applySmooth(this._Check,o)}},{key:"_updateBody",value:function _updateBody(){var o=this.checked?this.style.backgroundColorChecked:this.style.backgroundColor,s=this.style.radius>=this.w/2?(this.w-this.style.strokeWidth)/2:0;this._Body.patch({texture:E.Tools.getRoundRect(this.w-this.style.strokeWidth,this.h-this.style.strokeWidth,s,0,null,!0,o)})}},{key:"_updateStroke",value:function _updateStroke(){this._Stroke.patch({texture:E.Tools.getRoundRect(this.w,this.h,this.style.radius,this.style.strokeWidth,this.style.strokeColor,!1)})}},{key:"_updateOpacity",value:function _updateOpacity(){this.applySmooth(this,{alpha:this.style.alpha})}},{key:"_setChecked",value:function _setChecked(o){return this._checkedChanged=o!==this._checked,o}},{key:"toggle",value:function toggle(){return this._isDisabledMode||(this.checked=!this.checked),this}},{key:"_handleEnter",value:function _handleEnter(){return"function"==typeof this.onEnter?this.onEnter(this):(this.toggle(),!1)}},{key:"announce",get:function get(){return this._announce||(this.checked?"Checked":"Unchecked")},set:function set(o){_set(_getPrototypeOf(Checkbox.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Checkbox"}},{key:"__themeStyle",get:function get(){return _A}},{key:"_template",value:function _template(){var o={mount:.5,x:function x(o){return o/2},y:function y(o){return o/2}};return{Body:_objectSpread(_objectSpread({rtt:!0},o),{},{Check:_objectSpread(_objectSpread({type:BI},o),{},{alpha:0})}),Stroke:o}}},{key:"tags",get:function get(){return["Check","Body","Stroke"]}},{key:"properties",get:function get(){return["checked"]}}]),Checkbox}(),SA=Object.freeze({__proto__:null,base:function base$z(o){return{radius:[o.radius.md,o.radius.md,o.radius.md,o.radius.none],paddingX:o.spacer.lg,paddingY:o.spacer.md,offsetY:o.spacer.xxs,textStyle:o.typography.caption1}},tone:function tone$i(o){return{neutral:{textStyle:{textColor:o.color.textInverse},backgroundColor:o.color.fillNeutral},inverse:{textStyle:{textColor:o.color.textNeutral},backgroundColor:o.color.fillInverse},brand:{textStyle:{textColor:o.color.textNeutral},backgroundColor:o.color.fillBrand}}}}),TA=function(o){_inherits(Label,DI);var s=_createSuper(Label);function Label(){return _classCallCheck(this,Label),s.apply(this,arguments)}return _createClass(Label,[{key:"_init",value:function _init(){this._Text.on("txLoaded",this._updateBackground.bind(this)),_get(_getPrototypeOf(Label.prototype),"_init",this).call(this)}},{key:"_update",value:function _update(){this._updateBackground(),this._updateText()}},{key:"_updateText",value:function _updateText(){this._Text&&this._Text.patch({text:_objectSpread(_objectSpread({},this.style.textStyle),{},{text:this.title})})}},{key:"_updateBackground",value:function _updateBackground(){this._Text.x=this.w/2,this._Text.y=this.h/2+this.style.offsetY,this.h=this.title?this._Text.renderHeight+2*this.style.paddingY:0,this.w=this.title?this._Text.renderWidth+2*this.style.paddingX:0,this._Background.patch({texture:E.Tools.getRoundRect(this.w-2,this.h-2,this.style.radius,0,null,!0,this.style.backgroundColor)}),this.signal("loadedLabel",this)}},{key:"announce",get:function get(){return this._announce||this._Text&&this._Text.text.text},set:function set(o){_set(_getPrototypeOf(Label.prototype),"announce",o,this,!0)}}],[{key:"_template",value:function _template(){return{Background:{},Text:{mountY:.5,mountX:.5,text:{}}}}},{key:"__componentName",get:function get(){return"Label"}},{key:"__themeStyle",get:function get(){return SA}},{key:"properties",get:function get(){return["title"]}},{key:"tags",get:function get(){return["Background","Text"]}}]),Label}(),kA=Object.freeze({__proto__:null,base:function base$y(o){return{descriptionTextStyle:_objectSpread(_objectSpread({},o.typography.body2),{},{maxLines:1}),fadeWidth:o.layout.gutterX.lg,logoWidth:o.typography.body3.lineHeight,logoHeight:o.typography.body3.lineHeight,logoPadding:o.spacer.lg,subtitleTextStyle:o.typography.body3,titleTextStyle:_objectSpread(_objectSpread({},o.typography.headline1),{},{maxLines:1}),marqueeSync:!0,alpha:o.alpha.primary}},mode:function mode$9(o){return{disabled:{subtitleTextStyle:{textColor:o.color.textNeutralDisabled},alpha:o.alpha.inactive}}},tone:function tone$h(o){return{neutral:{titleTextStyle:{textColor:o.color.textNeutral},subtitleTextStyle:{textColor:o.color.textNeutral},descriptionTextStyle:{textColor:o.color.textNeutralSecondary},mode:{disabled:{titleTextStyle:{textColor:o.color.textNeutralDisabled},subtitleTextStyle:{textColor:o.color.textNeutralDisabled},descriptionTextStyle:{textColor:o.color.textNeutralDisabled}}}},inverse:{titleTextStyle:{textColor:o.color.textInverse},subtitleTextStyle:{textColor:o.color.textInverse},descriptionTextStyle:{textColor:o.color.textInverseSecondary},mode:{disabled:{titleTextStyle:{textColor:o.color.textNeutralDisabled},subtitleTextStyle:{textColor:o.color.textNeutralDisabled},descriptionTextStyle:{textColor:o.color.textNeutralDisabled}}}},brand:{titleTextStyle:{textColor:o.color.textNeutral},subtitleTextStyle:{textColor:o.color.textNeutral},descriptionTextStyle:{textColor:o.color.textNeutralSecondary},mode:{disabled:{titleTextStyle:{textColor:o.color.textNeutralDisabled},subtitleTextStyle:{textColor:o.color.textNeutralDisabled},descriptionTextStyle:{textColor:o.color.textNeutralDisabled}}}}}}}),CA=function withMarqueeSync(o){return function(s){_inherits(_class4,s);var m=_createSuper(_class4);function _class4(){return _classCallCheck(this,_class4),m.apply(this,arguments)}return _createClass(_class4,[{key:"_init",value:function _init(){_get(_getPrototypeOf(_class4.prototype),"_init",this).call(this),this._shouldSync&&this._updateSignals()}},{key:"_update",value:function _update(){_get(_getPrototypeOf(_class4.prototype),"_update",this).call(this),this._shouldSync?this._updateSignals():this._cleanupSyncValues()}},{key:"_cleanupSyncValues",value:function _cleanupSyncValues(){this.syncArray.map((function(o){o.marqueeOverrideLoopX=void 0,o.signals&&o.signals.willMarquee&&delete o.signals.willMarquee}))}},{key:"_updateSignals",value:function _updateSignals(){this.syncArray&&this.syncArray.map((function(o){o.signals=_objectSpread(_objectSpread({},o.signals),{},{willMarquee:"_willMarquee"})}))}},{key:"_willMarquee",value:function _willMarquee(o){var s=this;this._shouldSync&&(this._longestMarqueeWidth=Math.max(o._textRenderedW||0,this._longestMarqueeWidth||0),this.syncArray.map((function(o){o.marqueeOverrideLoopX=s._longestMarqueeWidth})))}},{key:"_shouldSync",get:function get(){return!(!1===this.style.marqueeSync||(this.syncArray?Array.isArray(this.syncArray)?this.syncArray.length<2&&(WE.warn("warning: syncArray must contain at least two component references."),1):(WE.warn("warning: syncArray must be typeof array."),1):(WE.warn("warning: components using MarqueeSync must have a syncArray getter defined."),1)))}}],[{key:"name",get:function get(){return o.name}}]),_class4}(o)}(function(o){_inherits(MetadataBase,DI);var s=_createSuper(MetadataBase);function MetadataBase(){return _classCallCheck(this,MetadataBase),s.apply(this,arguments)}return _createClass(MetadataBase,[{key:"_init",value:function _init(){this.requestUpdate(!0)}},{key:"_titleLoaded",value:function _titleLoaded(){this._updateLayout()}},{key:"_subtitleLoaded",value:function _subtitleLoaded(o){var s=o.w,m=o.h;this._updateSubtitleLayout({w:s,h:m}),this._updateLayout()}},{key:"_descriptionLoaded",value:function _descriptionLoaded(){this._updateLayout()}},{key:"_updateSubtitleLayout",value:function _updateSubtitleLayout(o){var s=o.w,m=o.h;this._SubtitleWrapper.alpha=this.style.alpha,this._SubtitleWrapper.w=s,this._SubtitleWrapper.h=m}},{key:"_update",value:function _update(){this._updateLines(),this._updateLayout()}},{key:"_updateLines",value:function _updateLines(){this._Text.w=this._textW(),this._updateTitle(),this._updateSubtitle(),this._updateDescription()}},{key:"_updateLayout",value:function _updateLayout(){this._updatePositions(),this._updateMetadataHeight(),this._updateLogo()}},{key:"_updatePositions",value:function _updatePositions(){this._Text.h=this._textH(),this._Text.x=this.logo&&"left"===this.logoPosition?this.logoWidth+this.style.logoPadding:0,this._Text.y=(this.h-this._Text.h)/2}},{key:"_updateMetadataHeight",value:function _updateMetadataHeight(){var o=Math.max(this.logoHeight,this._Text.h);this.h!==o&&(this.h=o,this.signal("updateComponentDimensions"))}},{key:"_updateTitle",value:function _updateTitle(){this._Title.patch({content:this.title,marquee:this.marquee,style:{textStyle:_objectSpread(_objectSpread({},this.style.titleTextStyle),{},{maxLines:1,wordWrap:!0,wordWrapWidth:this._Text.w})}})}},{key:"resetMarquee",value:function resetMarquee(){this.marquee&&(this.title&&this._Title.toggleMarquee(),this.description&&this._Description.toggleMarquee())}},{key:"_updateSubtitle",value:function _updateSubtitle(){this._Subtitle.patch({content:this.subtitle,style:{textStyle:this.style.subtitleTextStyle}}),this._Subtitle.finalW>this._textW()?this._SubtitleWrapper.patch({w:this._textW()+this.style.fadeWidth/2,shader:{type:rA,positionLeft:0,positionRight:this.style.fadeWidth},rtt:!0}):this._SubtitleWrapper.shader=void 0,this._SubtitleWrapper.visible=!!this.subtitle,this._SubtitleWrapper.alpha=this.style.alpha}},{key:"_updateDescription",value:function _updateDescription(){this._Description.patch({content:this.description,marquee:this.marquee,style:{textStyle:_objectSpread(_objectSpread({},this.style.descriptionTextStyle),{},{maxLines:1,wordWrap:!0,wordWrapWidth:this._Text.w})}})}},{key:"_updateLogo",value:function _updateLogo(){this.logoPosition=this.logoPosition||"right",this._Logo.patch({type:BI,w:this.logoWidth,h:this.logoHeight,icon:this.logo,alpha:this.style.alpha}),this._Logo.x="left"===this.logoPosition?0:this.w-this._Logo.w,this._Logo.y=(this.h-this.logoHeight)/2}},{key:"_textW",value:function _textW(){return this.w-(this.logo?this.logoWidth+this.style.logoPadding:0)}},{key:"_textH",value:function _textH(){return(this.title&&this._Title&&this._Title.h||0)+(this.subtitle&&this._SubtitleWrapper&&this._SubtitleWrapper.h||0)+(this.description&&this._Description&&this._Description.h||0)}},{key:"_getLogoWidth",value:function _getLogoWidth(){return void 0!==this._logoWidth?this._logoWidth:this.style.logoWidth}},{key:"_setLogoWidth",value:function _setLogoWidth(o){return void 0!==o?o:this.logoWidth}},{key:"_getLogoHeight",value:function _getLogoHeight(){return void 0!==this._logoHeight?this._logoHeight:this.style.logoHeight}},{key:"_setLogoHeight",value:function _setLogoHeight(o){return void 0!==o?o:this.logoHeight}},{key:"syncArray",get:function get(){return[].concat(_toConsumableArray(this.title?[this._Title]:[]),_toConsumableArray(this.description?[this._Description]:[]),_toConsumableArray(this.subtitle?[this._Subtitle]:[]))}},{key:"announce",get:function get(){return this._announce||[this._Title&&this._Title.announce,this._Subtitle&&this._Subtitle.announce,this._Description&&this._Description.announce,this.logoTitle]},set:function set(o){_set(_getPrototypeOf(MetadataBase.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"MetadataBase"}},{key:"__themeStyle",get:function get(){return kA}},{key:"_template",value:function _template(){return{Text:{flex:{direction:"column",justifyContent:"flex-start"},Title:{type:oA,signals:{textBoxChanged:"_titleLoaded"}},SubtitleWrapper:{Subtitle:{type:oA,signals:{textBoxChanged:"_subtitleLoaded"}}},Description:{type:oA,signals:{textBoxChanged:"_descriptionLoaded"}}},Logo:{flexItem:!1,type:BI}}}},{key:"properties",get:function get(){return["description","logo","logoHeight","logoPosition","logoTitle","logoWidth","subtitle","title","marquee"]}},{key:"tags",get:function get(){return["Text",{name:"Title",path:"Text.Title"},{name:"SubtitleWrapper",path:"Text.SubtitleWrapper"},{name:"Subtitle",path:"Text.SubtitleWrapper.Subtitle"},{name:"Description",path:"Text.Description"},"Logo"]}}]),MetadataBase}()),wA=Object.freeze({__proto__:null,base:function base$x(o){return{titleTextStyle:o.typography.headline3,descriptionTextStyle:o.typography.body3}},tone:function tone$g(o){return{neutral:{subtitleTextStyle:{textColor:o.color.textNeutralSecondary},descriptionTextStyle:{textColor:o.color.textNeutral},mode:{disabled:{subtitleTextStyle:{textColor:o.color.textNeutralDisabled},descriptionTextStyle:{textColor:o.color.textNeutralDisabled}}}},inverse:{subtitleTextStyle:{textColor:o.color.textInverseSecondary},descriptionTextStyle:{textColor:o.color.textInverse},mode:{disabled:{subtitleTextStyle:{textColor:o.color.textNeutralDisabled},descriptionTextStyle:{textColor:o.color.textNeutralDisabled}}}},brand:{subtitleTextStyle:{textColor:o.color.textNeutralSecondary},descriptionTextStyle:{textColor:o.color.textNeutral},mode:{disabled:{subtitleTextStyle:{textColor:o.color.textNeutralDisabled},descriptionTextStyle:{textColor:o.color.textNeutralDisabled}}}}}}}),xA=function(o){_inherits(MetadataTile,CA);var s=_createSuper(MetadataTile);function MetadataTile(){return _classCallCheck(this,MetadataTile),s.apply(this,arguments)}return _createClass(MetadataTile,[{key:"_updateSubtitle",value:function _updateSubtitle(){this.description?(this._Subtitle.patch({content:""}),this._Subtitle.alpha=0,this._Subtitle.visible=!1):(this._Subtitle.alpha=1,this._Subtitle.visible=!0,_get(_getPrototypeOf(MetadataTile.prototype),"_updateSubtitle",this).call(this))}},{key:"_updateSubtitleLayout",value:function _updateSubtitleLayout(o){var s=o.h;this.subtitle&&!this.description?(this._SubtitleWrapper.h=s,this._SubtitleWrapper.alpha=this.style.alpha):this._SubtitleWrapper.h=0}},{key:"announce",get:function get(){return this._announce||[this._Title&&this._Title.announce,this._Subtitle&&this._Subtitle.announce||this._Description&&this._Description.announce,this.logoTitle]},set:function set(o){_set(_getPrototypeOf(MetadataTile.prototype),"announce",o,this,!0)}},{key:"_textH",value:function _textH(){return(this.title&&this._Title&&this._Title.h||0)+(this.subtitle&&this._Subtitle&&this._Subtitle.visible&&this._SubtitleWrapper.h||0)+(this.description&&this._Description&&this._Description.h||0)}}],[{key:"__componentName",get:function get(){return"MetadataTile"}},{key:"__themeStyle",get:function get(){return wA}}]),MetadataTile}(),EA=Object.freeze({__proto__:null,base:function base$w(o){return{h:o.spacer.md,animation:o.animation.utility,radius:o.radius.xs}},tone:function tone$f(o){return{neutral:{barColor:o.color.fillNeutralTertiary,progressColor:o.color.fillNeutral},inverse:{barColor:o.color.fillInverseTertiary,progressColor:o.color.fillInverse},brand:{barColor:o.color.fillNeutralTertiary,progressColor:o.color.fillBrand}}}}),IA=function(o){_inherits(ProgressBar,DI);var s=_createSuper(ProgressBar);function ProgressBar(){return _classCallCheck(this,ProgressBar),s.apply(this,arguments)}return _createClass(ProgressBar,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(ProgressBar.prototype),"_construct",this)&&_get(_getPrototypeOf(ProgressBar.prototype),"_construct",this).call(this),this._progress=0}},{key:"_update",value:function _update(){this._updateTextures(),this._updateProgress(),this._progressChanged&&(this.fireAncestors("$announce",this.announce),this._progressChanged=!1)}},{key:"_updateTextures",value:function _updateTextures(){var o=this._getProgressWidth();this._Bar.texture=E.Tools.getRoundRect(this.w-2,this.h,this.style.radius,0,0,!0,this.style.barColor),this._Progress.texture=E.Tools.getRoundRect(o+1,this.h,this.style.radius,0,0,!0,this.style.progressColor)}},{key:"_updateProgress",value:function _updateProgress(){var o=this._getProgressWidth();this._Progress.smooth={w:[o,this.style.animation],alpha:Number(o>0)}}},{key:"_setProgress",value:function _setProgress(o){return this._progressChanged=o!==this._progress,o}},{key:"announce",get:function get(){if(void 0!==this._announce&&null!==this._announce)return this._announce;var o=this.progress;return o>1?o=1:o<0&&(o=0),"".concat(Math.round(100*o),"%")},set:function set(o){_set(_getPrototypeOf(ProgressBar.prototype),"announce",o,this,!0)}},{key:"_getProgressWidth",value:function _getProgressWidth(){var o=this.w*this._progress;return o<=0?0:Math.min(o,this.w)}}],[{key:"_template",value:function _template(){return{Bar:{zIndex:1},Progress:{alpha:0,zIndex:2}}}},{key:"__themeStyle",get:function get(){return EA}},{key:"__componentName",get:function get(){return"ProgressBar"}},{key:"properties",get:function get(){return["progress"]}},{key:"tags",get:function get(){return["Bar","Progress"]}}]),ProgressBar}(),AA=Object.freeze({__proto__:null,base:function base$v(o){return{animationEntrance:o.animation.standardEntrance,animationExit:o.animation.standardExit,metadataLocation:"standard",paddingX:o.spacer.xl,paddingY:o.spacer.lg,paddingYProgress:o.spacer.xl,paddingYBetweenContent:o.spacer.md,radius:o.radius.md,alpha:o.alpha.primary}},mode:function mode$8(o){return{disabled:{alpha:o.alpha.inactive}}},tone:function tone$e(o){return{neutral:{mode:{focused:{backgroundColor:o.color.interactiveNeutralFocusSoft}}},inverse:{mode:{focused:{backgroundColor:o.color.interactiveInverseFocusSoft}}},brand:{mode:{focused:{backgroundColor:o.color.interactiveBrandFocusSoft}}}}}}),PA=function(o){_inherits(Tile,YI);var s=_createSuper(Tile);function Tile(){return _classCallCheck(this,Tile),s.apply(this,arguments)}return _createClass(Tile,[{key:"announce",get:function get(){return this._announce||[this._Metadata&&this._Metadata.announce,this._Badge&&this._Badge.announce,this._Label&&this._Label.announce,this._ProgressBar&&this._ProgressBar.announce]},set:function set(o){_set(_getPrototypeOf(Tile.prototype),"announce",o,this,!0)}},{key:"_update",value:function _update(){_get(_getPrototypeOf(Tile.prototype),"_update",this).call(this),this._updateTileColor(),this._updateContent(),this._updateArtwork(),this._updateBadge(),this._updateLabel(),this._updateCheckbox(),this._updateProgressBar(),this._updateMetadata()}},{key:"h",get:function get(){return this._isInsetMetadata?_get(_getPrototypeOf(Tile.prototype),"h",this):_get(_getPrototypeOf(Tile.prototype),"h",this)+(this._Metadata&&this._Metadata.h||0)},set:function set(o){_set(_getPrototypeOf(Tile.prototype),"h",o,this,!0)}},{key:"innerH",get:function get(){return this._h}},{key:"_gradient",get:function get(){return!this._isCircleLayout&&Boolean(this._isInsetMetadata&&this._hasMetadata&&this._shouldShowMetadata)}},{key:"_isCircleLayout",get:function get(){return Boolean(this._itemLayout&&this._itemLayout.circle)}},{key:"_foregroundDefaultWidth",get:function get(){return parseFloat(this._w/this._h).toFixed(2)===parseFloat(16/9).toFixed(2)?.5*this.innerW:.75*this.innerW}},{key:"_updateTileColor",value:function _updateTileColor(){this._Tile.alpha=this.style.alpha}},{key:"_updateContent",value:function _updateContent(){var o=this,s={h:this._h,w:this._w,x:this._w/2,y:this._h/2};this.applySmooth(this._Content,s,Object.keys(s).reduce((function(m,_){return m[_]=[s[_],o._isFocusedMode?o.style.animationEntrance:o.style.animationExit],m}),{}))}},{key:"_updateArtwork",value:function _updateArtwork(){var o,s;this._Artwork.patch(_objectSpread(_objectSpread({mode:this.mode,h:this._h,w:this._w,x:this._w/2,y:this._h/2,src:this.src},this.artwork||{}),{},{style:_objectSpread({radius:null===(o=this.style)||void 0===o?void 0:o.radius},null===(s=this.artwork)||void 0===s?void 0:s.style),gradient:this._gradient,shouldScale:this._isFocusedMode}))}},{key:"_getSrc",value:function _getSrc(){return this.artwork&&this.artwork.src||this._src}},{key:"_imageLoaded",value:function _imageLoaded(){this._Background.alpha=0}},{key:"_updateBadge",value:function _updateBadge(){var o;if(null!==(o=this.badge)&&void 0!==o&&o.title&&!this._isCircleLayout){var s=_objectSpread(_objectSpread({},this.badge),{},{mode:this.mode,x:this.style.paddingX,y:this.style.paddingY,alpha:this._shouldShowBadgeLabel?1:.001});this._Badge?(this._Badge.patch(s),this.applySmooth(this._Badge,s,_objectSpread(_objectSpread({},s),this._badgeLabelTransitions))):this._Content.patch({Badge:_objectSpread(_objectSpread({type:$I},s),{},{signals:{loadedBadge:"_updateBadge"}})})}else this._Badge&&this._Content.patch({Badge:void 0})}},{key:"_updateLabel",value:function _updateLabel(){var o;if(null!==(o=this.label)&&void 0!==o&&o.title&&!this._isCircleLayout){var s=_objectSpread(_objectSpread({},this.label),{},{mode:this.mode,x:this._w-this.style.paddingX,y:this.style.paddingY,alpha:this._shouldShowBadgeLabel?1:.001});this._Label?(this._Label.patch(s),this.applySmooth(this._Label,s,_objectSpread(_objectSpread({},s),{},{x:[s.x,this._shouldShowBadgeLabel?this.style.animationEntrance:this.style.animationExit]},this._badgeLabelTransitions))):this._Content.patch({Label:_objectSpread(_objectSpread({type:TA,mountX:1},s),{},{signals:{loadedLabel:"_updateLabel"}})})}else this._Label&&this._Content.patch({Label:void 0})}},{key:"_shouldShowBadgeLabel",get:function get(){return this.persistentMetadata||this._isFocusedMode&&!this._isCircleLayout}},{key:"_badgeLabelTransitions",get:function get(){return{y:[this._shouldShowBadgeLabel?this.style.paddingY:0,this._shouldShowBadgeLabel?this.style.animationEntrance:this.style.animationExit],alpha:[this._shouldShowBadgeLabel?1:.001,this._shouldShowBadgeLabel?this.style.animationEntrance:this.style.animationExit]}}},{key:"_updateCheckbox",value:function _updateCheckbox(){var o;if("boolean"==typeof(null===(o=this.checkbox)||void 0===o?void 0:o.checked)&&this.checkbox.checked&&!this._isCircleLayout){var s=_objectSpread(_objectSpread({},this.checkbox),{},{mode:this.mode,x:this._w-this.style.paddingX,y:this._h-this.style.paddingY});this._Checkbox?this.applySmooth(this._Checkbox,s):this._Content.patch({Checkbox:_objectSpread(_objectSpread({},s),{},{type:bA,mount:1})})}else this._Checkbox&&this._Content.patch({Checkbox:void 0})}},{key:"_progressBarY",get:function get(){return(this._ProgressBar&&0!==this._ProgressBar._getTransition("alpha")._targetValue?this._ProgressBar._getTransition("y")._targetValue||this._ProgressBar.y:0)||0}},{key:"_updateProgressBar",value:function _updateProgressBar(){var o,s=this;if("number"==typeof(null===(o=this.progressBar)||void 0===o?void 0:o.progress)&&this.progressBar.progress&&!this._isCircleLayout){if(this.progressBar.progress>0){var m=_objectSpread(_objectSpread({},this.progressBar),{},{mode:this.mode,w:this._w-2*this.style.paddingX,x:this._w/2,y:this._h-this.style.paddingYProgress});if(!this._ProgressBar)return this._Content.patch({ProgressBar:_objectSpread(_objectSpread({},m),{},{type:IA,mountX:.5,mountY:1,alpha:this._hasMetadata&&this.shouldSmooth?.001:1})}),void(this.shouldSmooth&&(this._ProgressBar.smooth={alpha:[1,{delay:this.style.animationEntrance.duration}]}));this.applySmooth(this._ProgressBar,m,Object.keys(m).reduce((function(o,_){return o[_]=[m[_],s._isFocusedMode?s.style.animationEntrance:s.style.animationExit],o}),{}))}}else this._ProgressBar&&(this.shouldSmooth?(this._ProgressBar._getTransition("alpha").once("finish",(function(){s._removeProgressBar()})),this._ProgressBar.smooth={alpha:0}):this._removeProgressBar())}},{key:"_removeProgressBar",value:function _removeProgressBar(){this._Content.patch({ProgressBar:void 0}),this._updateMetadata()}},{key:"_shouldShowMetadata",get:function get(){return this._hasMetadata&&(this.persistentMetadata&&!this._isInsetMetadata||this._isFocusedMode&&!this._isInsetMetadata||(this.persistentMetadata||this._isFocusedMode)&&this._isInsetMetadata&&!this._isCircleLayout)}},{key:"_isInsetMetadata",get:function get(){return"inset"===this.metadataLocation}},{key:"_metadataTransitions",get:function get(){return{y:[this._shouldShowMetadata?this._metadataY:this._h+this.style.paddingY,this._shouldShowMetadata?this.style.animationEntrance:this.style.animationExit],alpha:[this._metadataAlpha,this._shouldShowMetadata?this.style.animationEntrance:this.style.animationExit]}}},{key:"_hasMetadata",get:function get(){var o=this;return xA.properties.some((function(s){return o.metadata&&o.metadata[s]}))}},{key:"_metadataY",get:function get(){return this._isInsetMetadata?this._progressBarY?this._progressBarY-this.style.paddingYBetweenContent:this._h-this.style.paddingY:this._h+this.style.paddingY}},{key:"_metadataAlpha",get:function get(){return this._shouldShowMetadata?1:.001}},{key:"_metadataPatch",get:function get(){return _objectSpread({mode:this.mode,alpha:this._metadataAlpha,mountX:.5,mountY:this._isInsetMetadata?1:0,marquee:this._isFocusedMode,w:this._w-2*this.style.paddingX,x:this._w/2,y:!this.persistentMetadata&&this._isInsetMetadata&&this._isFocusedMode?this._h+this.style.paddingY:this._metadataY},this.metadata||{})}},{key:"_getMetadataLocation",value:function _getMetadataLocation(){var o;return null!==(o=this.style.metadataLocation)&&void 0!==o?o:this._metadataLocation}},{key:"_setMetadataLocation",value:function _setMetadataLocation(o){return o&&(this.style={metadataLocation:o}),o}},{key:"_updateMetadata",value:function _updateMetadata(){this._hasMetadata?this._Metadata||!this._hasMetadata?(this._Metadata.patch(this._metadataPatch),this._animateMetadata()):this._Content.patch({Metadata:_objectSpread({type:xA,signals:{updateComponentDimensions:"_metadataLoaded"}},this._metadataPatch)}):this._Content.patch({Metadata:void 0})}},{key:"_animateMetadata",value:function _animateMetadata(){this._Metadata&&(this.applySmooth(this._Metadata,this._metadataPatch,this._metadataTransitions),this._isFocusedMode||this._resetMarqueeAnimation())}},{key:"_metadataLoaded",value:function _metadataLoaded(){this._animateMetadata(),this._isInsetMetadata||this.fireAncestors("$itemChanged")}},{key:"_resetMarqueeAnimation",value:function _resetMarqueeAnimation(){var o=this,s=this._Metadata._getTransition("alpha");s?s.on("finish",(function(){o._Metadata&&o._Metadata.resetMarquee()})):this._Metadata.resetMarquee()}}],[{key:"__componentName",get:function get(){return"Tile"}},{key:"__themeStyle",get:function get(){return AA}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(Tile),"_template",this).call(this)),{},{Tile:{Artwork:{type:NI,signals:{imageLoaded:"_imageLoaded"},mount:.5},Content:{mount:.5}}})}},{key:"properties",get:function get(){return["artwork","circle","badge","checkbox","metadata","metadataLocation","persistentMetadata","progressBar","label","src"]}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Tile),"tags",this)),["Artwork","Content","Tile",{name:"Badge",path:"Content.Badge"},{name:"Checkbox",path:"Content.Checkbox"},{name:"Metadata",path:"Content.Metadata"},{name:"ProgressBar",path:"Content.ProgressBar"},{name:"Label",path:"Content.Label"}])}}]),Tile}(),LA=Object.freeze({__proto__:null,base:function base$u(o){return{alpha:o.alpha.primary,counterTextStyle:o.typography.headline3,itemSize:o.layout.gutterX.sm,itemSpacing:o.spacer.md,radius:o.radius.sm}},mode:function mode$7(o){return{disabled:{alpha:o.alpha.inactive}}},tone:function tone$d(o){return{neutral:{counterBackgroundColor:o.color.fillInverseSecondary},inverse:{counterBackgroundColor:o.color.fillNeutralSecondary},brand:{counterBackgroundColor:o.color.fillInverseSecondary}}}}),DA=function(o){_inherits(Provider,DI);var s=_createSuper(Provider);function Provider(){return _classCallCheck(this,Provider),s.apply(this,arguments)}return _createClass(Provider,[{key:"providersHidden",get:function get(){return this.providers.length-this._visibleCount}},{key:"_construct",value:function _construct(){this._providers=[],_get(_getPrototypeOf(Provider.prototype),"_construct",this).call(this)}},{key:"_update",value:function _update(){this._updateProviders(),this._updateCounter()}},{key:"_updateProviders",value:function _updateProviders(){var o=this,s=[];this.providers.slice(0,this.visibleCount).forEach((function(m){var _={centerInParent:!0,radius:o.disableRadius?0:o.style.radius,alpha:o.style.alpha,style:m.style||{}};if(m.type===BI&&m.icon&&m.w&&m.h){var S=m.w/m.h;_=_objectSpread(_objectSpread({type:BI,icon:m.icon},m),{},{w:o.style.itemSize*S,h:o.style.itemSize},_)}else _=_objectSpread({type:BI,w:o.style.itemSize,h:o.style.itemSize},_),"object"===_typeof(m)?_=_objectSpread(_objectSpread({},_),m):_.icon=m;s.push(_)})),this._Row.patch({style:{itemSpacing:this.style.itemSpacing},items:s,h:this.style.itemSize})}},{key:"_updateCounter",value:function _updateCounter(){if(this.providers.length>this.visibleCount){var o=this.providersHidden,s={announce:"+".concat(o),alpha:this.style.alpha,w:this.style.itemSize,h:this.style.itemSize,centerInParent:!0,Background:{w:this.style.itemSize,h:this.style.itemSize,texture:E.Tools.getRoundRect(this.style.itemSize,this.style.itemSize,this.style.radius,0,null,!0,this.style.counterBackgroundColor)},Text:{type:oA,mountX:.5,mountY:.5,x:this.style.itemSize/2,y:this.style.itemSize/2,content:this.counterText||"+".concat(o),style:{textStyle:this.style.counterTextStyle}}};this._Row.appendItems([s])}}},{key:"$itemChanged",value:function $itemChanged(){this.signal("providerChanged")}},{key:"_getVisibleCount",value:function _getVisibleCount(){var o=this.providers.length,s=Math.min(Math.max(1,this._visibleCount),o);return this._visibleCount<1&&console.warn("Warning: The specified visible count (".concat(this._visibleCount,") is less than the minimum value (").concat(1,"). Setting it to ").concat(1,".")),this._visibleCount>o&&console.warn("Warning: The specified visible count (".concat(this._visibleCount,") is greater than the maximum value (").concat(o,"). Setting it to ").concat(o,".")),s}},{key:"w",get:function get(){return this._Row.w}},{key:"announce",get:function get(){return this._announce||this._Row.items&&this._Row.items.length&&this._Row.items.map((function(o){return o.announce}))},set:function set(o){_set(_getPrototypeOf(Provider.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Provider"}},{key:"__themeStyle",get:function get(){return LA}},{key:"_template",value:function _template(){return{Row:{type:qI,autoResizeWidth:!0}}}},{key:"properties",get:function get(){return["disableRadius","counterText","providers","visibleCount"]}},{key:"tags",get:function get(){return["Row"]}}]),Provider}(),RA=Object.freeze({__proto__:null,base:function base$t(o){return{detailsTextStyle:o.typography.body3,descriptionTextStyle:{maxLines:3},provider:{fadeWidth:o.spacer.md*o.spacer.md,itemSize:o.spacer.xxxl+o.spacer.md}}},tone:function tone$c(o){return{neutral:{detailsTextStyle:{textColor:o.color.textNeutral},mode:{disabled:{detailsTextStyle:{textColor:o.color.textNeutralDisabled}}}},inverse:{detailsTextStyle:{textColor:o.color.textInverse},mode:{disabled:{detailsTextStyle:{textColor:o.color.textNeutralDisabled}}}},brand:{detailsTextStyle:{textColor:o.color.textNeutral},mode:{disabled:{detailsTextStyle:{textColor:o.color.textNeutralDisabled}}}}}}}),OA=function(o){_inherits(MetadataCardContent,CA);var s,m=_createSuper(MetadataCardContent);function MetadataCardContent(){return _classCallCheck(this,MetadataCardContent),m.apply(this,arguments)}return _createClass(MetadataCardContent,[{key:"_setDetails",value:function _setDetails(o){var s=this;return this._detailsPromise=o?new Promise((function(o){s._detailsPromiseResolver=o})):void 0,o}},{key:"_setProvider",value:function _setProvider(o){var s=this;return this._providerPromise=o?new Promise((function(o){s._providerPromiseResolver=o})):void 0,o}},{key:"_update",value:(s=_asyncToGenerator(_regeneratorRuntime().mark((function _callee13(){return _regeneratorRuntime().wrap((function _callee13$(o){for(;;)switch(o.prev=o.next){case 0:return this._updateLines(),this._updateProvider(),o.next=4,Promise.all([this._detailsPromise,this._providerPromise].filter(Boolean));case 4:this._updatePositions();case 5:case"end":return o.stop()}}),_callee13,this)}))),function _update(){return s.apply(this,arguments)})},{key:"_updateLines",value:function _updateLines(){this._Text.w=this.w,this._updateTitle(),this._updateDescription(),this._updateDetails()}},{key:"_updateDescription",value:function _updateDescription(){this._Description.patch({content:this.description,style:{textStyle:_objectSpread(_objectSpread({},this.style.descriptionTextStyle),{},{wordWrap:!0,wordWrapWidth:this._Text.w})}})}},{key:"_updateDetails",value:function _updateDetails(){var o=this._detailsMaxW;this._Details.patch({content:this.details,style:{textStyle:_objectSpread(_objectSpread({},this.style.detailsTextStyle),{},{wordWrap:!0,maxLines:1,wordWrapWidth:o+this.style.fadeWidth/2})}}),this._Details.finalW>o?this._DetailsFader.patch({w:o+this.style.fadeWidth/2,shader:{type:rA,positionLeft:0,positionRight:this.style.fadeWidth}}):this._DetailsFader.shader=void 0}},{key:"_resolveDetails",value:function _resolveDetails(){this._detailsPromiseResolver&&this._detailsPromiseResolver(),this._updatePositions()}},{key:"_updateProvider",value:function _updateProvider(){this.provider&&this._Provider.patch(_objectSpread(_objectSpread({mode:this.mode},this.provider),{},{style:this.style.provider}))}},{key:"_resolveProvider",value:function _resolveProvider(){this._providerPromiseResolver&&this._providerPromiseResolver(),this._updatePositions()}},{key:"_updatePositions",value:function _updatePositions(){this._Text.h=this._textH,this._Text.w=this._textW,this._DetailsWrapper.w=this._textW,this._DetailsWrapper.h=Math.max(this._providerH,this._Details.h),this._DetailsWrapper.y=this.h-this._DetailsWrapper.h,this._Details.y=this._DetailsWrapper.h/2,this._Provider.x=this._DetailsWrapper.w-this._providerW,this._Provider.y=this._DetailsWrapper.h-this._providerH}},{key:"_textW",get:function get(){return this.w}},{key:"_textH",get:function get(){return this.h-this._providerH}},{key:"_providerW",get:function get(){return this._Provider.w}},{key:"_providerH",get:function get(){return this._Provider._Row._Items.h}},{key:"_detailsMaxW",get:function get(){return this.w-this._providerW-this.style.fadeWidth/2}},{key:"announce",get:function get(){return this._announce||[this._Title&&this._Title.announce,this._Description&&this._Description.announce,this._Details&&this._Details.announce,this._Provider&&this._Provider.announce]},set:function set(o){_set(_getPrototypeOf(MetadataCardContent.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"MetadataCardContent"}},{key:"__themeStyle",get:function get(){return RA}},{key:"_template",value:function _template(){return{Text:{flex:{direction:"column",justifyContent:"flex-start"},Title:{type:oA},Description:{type:oA}},DetailsWrapper:{DetailsFader:{Details:{mountY:.5,type:oA,signals:{textBoxChanged:"_resolveDetails"}}},Provider:{mount:1,type:DA,signals:{providerChanged:"_resolveProvider"}}}}}},{key:"properties",get:function get(){return["description","details","provider","title"]}},{key:"tags",get:function get(){return["Text",{name:"Title",path:"Text.Title"},{name:"Description",path:"Text.Description"},"DetailsWrapper",{name:"DetailsFader",path:"DetailsWrapper.DetailsFader"},{name:"Details",path:"DetailsWrapper.DetailsFader.Details"},{name:"Provider",path:"DetailsWrapper.Provider"}]}}]),MetadataCardContent}(),MA=Object.freeze({__proto__:null,base:function base$s(o){return{expandedW:eI.getWidthByUpCount(o,2),expandedH:eI.getDimensions(o,{ratioX:16,ratioY:9,upCount:4}).h,imageSize:{w:eI.getDimensions(o,{ratioX:16,ratioY:9,upCount:4}).w,h:eI.getDimensions(o,{ratioX:16,ratioY:9,upCount:4}).h},metadata:{descriptionTextStyle:{maxLines:2}},paddingVertical:1.5*o.spacer.md}}}),FA=function(o){_inherits(CardContent,dA);var s=_createSuper(CardContent);function CardContent(){return _classCallCheck(this,CardContent),s.apply(this,arguments)}return _createClass(CardContent,[{key:"_update",value:function _update(){this._updateSize(),this._updateTile(),this._updateRadius(),this._updateMetadata(),_get(_getPrototypeOf(CardContent.prototype),"_update",this).call(this)}},{key:"_updateTitle",value:function _updateTitle(){}},{key:"_updateTitlePosition",value:function _updateTitlePosition(){}},{key:"_updateTile",value:function _updateTile(){var o=this.style.imageSize.w,s=this.style.expandedH;"horizontal"!==this._orientation&&(o=this.style.expandedW,s=this.style.imageSize.h);var m=this.tile;this.src&&(m=eI.clone({src:this.src},this.tile)),this._Tile.patch(_objectSpread(_objectSpread({w:o,h:s},m),{},{persistentMetadata:!0,alpha:this._shouldShowTile?1:0}))}},{key:"_updateMetadata",value:function _updateMetadata(){var o=_objectSpread(_objectSpread(_objectSpread(_objectSpread({},this.metadata),this._metadataPosition),this._metadataDimensions),{},{mode:this.mode,alpha:this._shouldShowMetadata?1:0,style:this.style.metadata});this._Metadata||(o.type=OA),this.patch({Metadata:o})}},{key:"_updateSize",value:function _updateSize(){var o=this.style.expandedW,s=this.style.expandedH;this._collapse&&("horizontal"===this._orientation?o=this._collapseW:s=this._collapseH),this.w=o,this.h=s}},{key:"_updateRadius",value:function _updateRadius(){var o=Array.isArray(this.style.radius)&&4===this.style.radius.length?this.style.radius:Array(4).fill(this.style.radius),s=o;this._collapse||(s="horizontal"===this._orientation?[o[0],0,0,o[3]]:[o[0],o[1],0,0]),this._Tile.patch({style:{radius:s}})}},{key:"_getSrc",value:function _getSrc(){return this.tile&&(this.tile.artwork&&this.tile.artwork.src||this.tile.src)||this._src}},{key:"_metadataDimensions",get:function get(){var o=2*this.style.paddingHorizontal,s=2*this.style.paddingVertical,m=this.style.expandedW-this.style.imageSize.w-o,_=this.style.expandedH-s;return"horizontal"!==this.orientation&&(m=this.style.expandedW-o,_=this.style.expandedH-this.style.imageSize.h-s),{w:m,h:_}}},{key:"_metadataPosition",get:function get(){var o=this.style.paddingHorizontal,s=this.style.paddingVertical,m=o+(this._collapse?0:this.style.imageSize.w),_=s;return"horizontal"!==this.orientation&&(m=o,_=s+(this._collapse?0:this.style.imageSize.h)),{x:m,y:_}}},{key:"_shouldShowMetadata",get:function get(){return!this._collapse||this.collapseToMetadata}},{key:"_shouldShowTile",get:function get(){return!this._collapse||this._collapse&&!this.collapseToMetadata}},{key:"_collapse",get:function get(){return this.shouldCollapse&&!this._isFocusedMode}},{key:"_collapseW",get:function get(){return this.collapseToMetadata?this.style.expandedW-this.style.imageSize.w:this.style.imageSize.w}},{key:"_collapseH",get:function get(){return this.collapseToMetadata?this.style.expandedH-this.style.imageSize.h:this.style.imageSize.h}},{key:"announce",get:function get(){return this._announce||[this._Metadata&&this._Metadata.announce,this._Tile&&this._Tile.announce]},set:function set(o){_set(_getPrototypeOf(CardContent.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"CardContent"}},{key:"__themeStyle",get:function get(){return MA}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(CardContent),"_template",this).call(this)),{},{Tile:{type:PA}})}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(CardContent),"properties",this)),["tile","metadata","orientation","collapseToMetadata","shouldCollapse","src"])}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(CardContent),"tags",this)),["Metadata","Tile"])}}]),CardContent}(),NA=function(o){_inherits(CardContentHorizontal,FA);var s=_createSuper(CardContentHorizontal);function CardContentHorizontal(){return _classCallCheck(this,CardContentHorizontal),s.apply(this,arguments)}return _createClass(CardContentHorizontal,[{key:"_init",value:function _init(){this._orientation="horizontal",_get(_getPrototypeOf(CardContentHorizontal.prototype),"_init",this).call(this)}}],[{key:"__componentName",get:function get(){return"CardContentHorizontal"}},{key:"__themeStyle",get:function get(){return MA}}]),CardContentHorizontal}(),UA=Object.freeze({__proto__:null,base:function base$r(o){var s=eI.getDimensions(o,{ratioX:16,ratioY:9,upCount:3}),m=s.w,_=s.h;return{expandedW:eI.getWidthByColumnSpan(o,8),expandedH:_,imageSize:{w:m,h:_},metadata:{descriptionTextStyle:{maxLines:3}}}}});!function(o){_inherits(CardContentHorizontalLarge,NA);var s=_createSuper(CardContentHorizontalLarge);function CardContentHorizontalLarge(){return _classCallCheck(this,CardContentHorizontalLarge),s.apply(this,arguments)}_createClass(CardContentHorizontalLarge,null,[{key:"__componentName",get:function get(){return"CardContentHorizontalLarge"}},{key:"__themeStyle",get:function get(){return UA}}])}();var BA=Object.freeze({__proto__:null,base:function base$q(o){return{expandedW:eI.getWidthByUpCount(o,4),expandedH:eI.getDimensions(o,{ratioX:16,ratioY:9,upCount:4}).h+7*o.spacer.xxxl+o.spacer.lg+o.spacer.xxs,metadata:{descriptionTextStyle:{maxLines:3}}}}}),jA=function(o){_inherits(CardContentVertical,FA);var s=_createSuper(CardContentVertical);function CardContentVertical(){return _classCallCheck(this,CardContentVertical),s.apply(this,arguments)}return _createClass(CardContentVertical,[{key:"_init",value:function _init(){this._orientation="vertical",_get(_getPrototypeOf(CardContentVertical.prototype),"_init",this).call(this)}}],[{key:"__componentName",get:function get(){return"CardContentVertical"}},{key:"__themeStyle",get:function get(){return BA}}]),CardContentVertical}(),$A=Object.freeze({__proto__:null,base:function base$p(o){return{expandedH:eI.getDimensions(o,{ratioX:16,ratioY:9,upCount:4}).h+14*o.spacer.md,metadata:{descriptionTextStyle:{maxLines:1}}}}});!function(o){_inherits(CardContentVerticalSmall,jA);var s=_createSuper(CardContentVerticalSmall);function CardContentVerticalSmall(){return _classCallCheck(this,CardContentVerticalSmall),s.apply(this,arguments)}_createClass(CardContentVerticalSmall,[{key:"_setMetadata",value:function _setMetadata(o){return _objectSpread(_objectSpread({},o),{},{details:void 0,provider:void 0})}}],[{key:"__componentName",get:function get(){return"CardContentVerticalSmall"}},{key:"__themeStyle",get:function get(){return $A}}])}();var VA=Object.freeze({__proto__:null,base:function base$o(o){var s=o.stroke.sm,m=o.spacer.xl-2*s;return{w:m,h:m,checkW:o.spacer.md,checkH:o.spacer.md+o.spacer.xxs,radius:m/2,strokeWidth:s}}});!function(o){_inherits(CheckboxSmall,bA);var s=_createSuper(CheckboxSmall);function CheckboxSmall(){return _classCallCheck(this,CheckboxSmall),s.apply(this,arguments)}_createClass(CheckboxSmall,null,[{key:"__themeStyle",get:function get(){return VA}}])}();var HA=Object.freeze({__proto__:null,base:function base$n(o){return{itemSpacing:o.layout.gutterY.xs,scrollIndex:0,itemTransition:_objectSpread(_objectSpread({},o.animation.standardEntrance),{},{duration:o.animation.duration.fast})}}}),KA=function(o){_inherits(Column,WI);var s=_createSuper(Column);function Column(){return _classCallCheck(this,Column),s.apply(this,arguments)}return _createClass(Column,[{key:"_shouldScroll",value:function _shouldScroll(){var o=this.alwaysScroll;return o||this.neverScroll||(o=this.Items.childList.last&&(this.shouldScrollUp()||this.shouldScrollDown())),o}},{key:"_render",value:function _render(o,s){if(this._prevLastScrollIndex=this._lastScrollIndex,this.plinko&&s&&s.selected&&(0!==this.items.indexOf(s)||!s.skipPlinko)){var m=this.checkSkipPlinko(s,o);o.selectedIndex=this._getIndexOfItemNear(o,m||s)}else o&&!o.selectedIndex&&(o.selectedIndex=0);if(this.Items.children.length){if(this._shouldScroll()){var _=this.selectedIndex>this._lastScrollIndex?this.Items.children[this._lastScrollIndex-this.scrollIndex]:this.selected;this.Items.children[this._firstFocusableIndex()]===_&&(_=this.Items.children[0]);var S=(this.Items.children[this.scrollIndex]||{y:0}).y,E=[-(_||this.Items.childList.first).transition("y").targetValue+(_===this.selected?S:0),this.style.itemTransition],A=-_.y+(_===this.selected?S:0);this.applySmooth(this.Items,{y:A},{y:E}),this.shouldSmooth||this._updateTransitionTarget(this.Items,"y",A)}}else this.applySmooth(this.Items,{y:this.itemPosY}),this.shouldSmooth||this._updateTransitionTarget(this.Items,"y",this.itemPosY);this.onScreenEffect(this.onScreenItems)}},{key:"_performRender",value:function _performRender(){this._render(this.selected,this.prevSelected)}},{key:"checkSkipPlinko",value:function checkSkipPlinko(o,s){var m=this;if(!o||!o.skipPlinko||[0,this.items.length-1].includes(this.items.indexOf(o)))return null;var _=this.items.indexOf(o),S=_-this.items.indexOf(s),E=(S>0?this.items.slice(_).map((function(o){return{skipPlinko:o.skipPlinko,index:m.items.indexOf(o)}})):this.items.slice(0,_+1).map((function(o){return{skipPlinko:o.skipPlinko,index:m.items.indexOf(o)}})).reverse()).find((function(o){return o.skipPlinko&&!m.items[o.index+S].skipPlinko})),A=E?E.index+S:_+S;return this.items[A]}},{key:"_itemsY",get:function get(){return YE(this.Items)}},{key:"$removeItem",value:function $removeItem(o){if(o){var s=o===this.selected;this.Items.childList.remove(o),this.queueRequestUpdate(),(s||this.selectedIndex>=this.items.length)&&(this.selectedIndex=this._selectedIndex),this.items.length||this.fireAncestors("$columnEmpty")}}},{key:"$columnChanged",value:function $columnChanged(){this.queueRequestUpdate()}},{key:"_isOnScreen",value:function _isOnScreen(o){return!!o&&this._isComponentVerticallyVisible(o)}},{key:"onScreenEffect",value:function onScreenEffect(){}}],[{key:"__componentName",get:function get(){return"Column"}},{key:"__themeStyle",get:function get(){return HA}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(Column),"_template",this).call(this)),{},{direction:"column"})}}]),Column}(),zA=function base$m(o){var s=o.spacer.lg,m=o.radius.xl,_=Math.max(m-s/2,0);return{h:8*o.spacer.md,iconStyle:{radius:m,w:o.spacer.xxxl,h:o.spacer.xxxl},logoStyle:{radius:_,w:7*o.spacer.md,h:6*o.spacer.md},minWidth:9*o.spacer.md,paddingX:s,paddingXNoTitle:o.spacer.md,prefixH:6*o.spacer.md,prefixPadding:o.spacer.md,radius:m,titlePadding:o.spacer.md}},WA=Object.freeze({__proto__:null,base:zA}),GA=function(o){_inherits(Control,lA);var s=_createSuper(Control);function Control(){return _classCallCheck(this,Control),s.apply(this,arguments)}return _createClass(Control,[{key:"_update",value:function _update(){this._updatePrefixStyle(),_get(_getPrototypeOf(Control.prototype),"_update",this).call(this),this._updateCollapseStatus()}},{key:"_updateCollapseStatus",value:function _updateCollapseStatus(){this._Title&&(this._Title.visible=!this._collapse)}},{key:"_updatePrefixStyle",value:function _updatePrefixStyle(){this._prefix&&(this.logo?this._updatePrefixObj(this.logo,{style:_objectSpread({color:void 0},this.style.logoStyle)}):this.icon&&this._updatePrefixObj(this.icon,{style:this.style.iconStyle}))}},{key:"_patchTitle",value:function _patchTitle(o,s){this._Title.patch({x:o,mountX:s})}},{key:"_updateContentPosition",value:function _updateContentPosition(){if(this._prefix&&this._Title)switch(this._Content.patch({mountX:0,x:this._paddingLeft}),this._justify){case"left":this._patchTitle(0,0);break;case"right":if(this.w<this._Prefix.w+this._Title.w)this._patchTitle(0,0);else{var o=this.w-(this._paddingLeft+this._paddingRight+this._Prefix.w+this.style.titlePadding);this._patchTitle(o,1)}break;default:if(this.fixed)if(this.w<this._Prefix.w+this._Title.w)this._patchTitle(0,0);else{var s=(this.w-(this._paddingLeft+this._Prefix.w+this._paddingRight))/2;this._patchTitle(s,.5)}else{var m=(this.w-(this._paddingLeft+this._Prefix.w+this.style.titlePadding+this._paddingRight))/2;this._patchTitle(m,.5)}}else _get(_getPrototypeOf(Control.prototype),"_updateContentPosition",this).call(this),this._Title&&this._patchTitle(0,0)}},{key:"_setPrefix",value:function _setPrefix(){}},{key:"_setSuffix",value:function _setSuffix(){}},{key:"_updatePrefixObj",value:function _updatePrefixObj(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._prefix=_objectSpread({type:BI,icon:o},s)}},{key:"_setIcon",value:function _setIcon(o){return this.logo||(o?this._updatePrefixObj(o,{style:this.style.iconStyle}):this._prefix=o),o}},{key:"_setLogo",value:function _setLogo(o){return o?this._updatePrefixObj(o,{style:_objectSpread({color:void 0},this.style.logoStyle)}):this.icon?this._updatePrefixObj(this.icon,{style:this.style.iconStyle}):this._prefix=o,o}},{key:"_paddingLeft",get:function get(){return this.logo?this.style.paddingXNoTitle:this.style.paddingX}},{key:"_paddingRight",get:function get(){return!this.logo||this._hasTitle&&!this._collapse?this.style.paddingX:this.style.paddingXNoTitle}},{key:"_collapse",get:function get(){return this.shouldCollapse&&!this._isFocusedMode}},{key:"_announceComponentName",get:function get(){return Control.__componentName}}],[{key:"__componentName",get:function get(){return"Control"}},{key:"__themeStyle",get:function get(){return WA}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Control),"properties",this)),["icon","logo","shouldCollapse"])}}]),Control}(),qA=Object.freeze({__proto__:null,base:function base$l(o){var s=zA(o),m=7*o.spacer.md,_=(s.h-m)/2,S=Math.max(s.radius-_,0);return{h:m,logoStyle:{radius:Math.max(S-s.paddingX/2,0),h:5*o.spacer.md,w:6*o.spacer.md},prefixH:5*o.spacer.md,radius:S,minWidth:8*o.spacer.md,textStyle:o.typography.button2}}});!function(o){_inherits(ControlSmall,GA);var s=_createSuper(ControlSmall);function ControlSmall(){return _classCallCheck(this,ControlSmall),s.apply(this,arguments)}_createClass(ControlSmall,null,[{key:"__componentName",get:function get(){return"ControlSmall"}},{key:"__themeStyle",get:function get(){return qA}}])}();var XA=Object.freeze({__proto__:null,base:function base$k(o){return{w:getWidthByUpCount(o,1),titleMarginLeft:o.layout.gutterX.xs,titleTextStyle:_objectSpread(_objectSpread({},o.typography.headline1),{},{textColor:o.color.textNeutral}),rowMarginTop:o.layout.gutterY.xs}},tone:function tone$b(o){return{neutral:{titleTextStyle:{textColor:o.color.textNeutral}},inverse:{titleTextStyle:{textColor:o.color.textInverse}},brand:{titleTextStyle:{textColor:o.color.textNeutral}}}}}),YA=function(o){_inherits(TitleRow,qI);var s=_createSuper(TitleRow);function TitleRow(){return _classCallCheck(this,TitleRow),s.apply(this,arguments)}return _createClass(TitleRow,[{key:"_titleLoaded",value:function _titleLoaded(){this._updateRow()}},{key:"_update",value:function _update(){_get(_getPrototypeOf(TitleRow.prototype),"_update",this).call(this),this._updateTitle(),this._updateRow()}},{key:"_updateTitle",value:function _updateTitle(){this.title?this._Title.patch({x:this.style.titleMarginLeft,content:this.title,style:{textStyle:this.style.titleTextStyle}}):this._Title&&this._Title.patch({h:0,content:""})}},{key:"_updateRow",value:function _updateRow(){this.Items.patch({y:this._Title.finalH+this.style.rowMarginTop}),this.patch({w:this.w||this.style.w,h:this.Items.y+this.Items.h})}},{key:"announce",get:function get(){return this._announce||this._Title&&this._Title.announce},set:function set(o){_set(_getPrototypeOf(TitleRow.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"TitleRow"}},{key:"__themeStyle",get:function get(){return XA}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({Title:{type:oA,signals:{textBoxChanged:"_titleLoaded"}}},_get(_getPrototypeOf(TitleRow),"_template",this).call(this)),{},{autoResizeHeight:!1})}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(TitleRow),"properties",this)),["title"])}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(TitleRow),"tags",this)),["Title"])}}]),TitleRow}(),QA=Object.freeze({__proto__:null,base:function base$j(o){return{extraItemSpacing:o.spacer.lg}}});!function(o){_inherits(ControlRow,YA);var s=_createSuper(ControlRow);function ControlRow(){return _classCallCheck(this,ControlRow),s.apply(this,arguments)}_createClass(ControlRow,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(ControlRow.prototype),"_construct",this).call(this),this._leftControls=[],this._contentItems=[],this._rightControls=[],this._lastLeftControlIndex=-1,this._lastItemIndex=-1,this._lazyLoadBuffer=0}},{key:"_updateContent",value:function _updateContent(){var o=[];this.leftControls.length&&o.push.apply(o,_toConsumableArray(this._withExtraSpacing(this.leftControls,!0))),this.contentItems.length&&o.push.apply(o,_toConsumableArray(this._withExtraSpacing(this.contentItems))),this.rightControls.length&&o.push.apply(o,_toConsumableArray(this.rightControls)),o.length&&this.patch({alpha:1,items:o,selectedIndex:this.leftControls.length,startLazyScrollIndex:this.leftControls.length,stopLazyScrollIndex:this.leftControls.length+this.contentItems.length-1})}},{key:"_withExtraSpacing",value:function _withExtraSpacing(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],m=_toConsumableArray(o),_=s?this._prevLeftControls:this._prevItems;return _&&_.length&&m[_.length-1]&&(m[_.length-1].extraItemSpacing=0),m[m.length-1].extraItemSpacing=null==this.extraItemSpacing?this.style.extraItemSpacing:this.extraItemSpacing,s?this._prevLeftControls=m:this._prevItems=m,m}},{key:"_getMoreItems",value:function _getMoreItems(){if(this.lazyLoadBuffer){var o=this.contentItems.length-1-this.lazyLoadBuffer;this.selectedIndex-this.leftControls.length>=o&&this.selectedIndex<this.leftControls.length+this.contentItems.length&&this.loadMoreItems()}}},{key:"loadMoreItems",value:function loadMoreItems(){this.signal("loadMoreItems")}},{key:"_selectedChange",value:function _selectedChange(o,s){_get(_getPrototypeOf(ControlRow.prototype),"_selectedChange",this).call(this,o,s),this._getMoreItems()}},{key:"_appendItemsAt",value:function _appendItemsAt(o,s,m){var _=_toConsumableArray(o);null!=m&&(this.items[m].extraItemSpacing=void 0,_[_.length-1].extraItemSpacing=null==this.extraItemSpacing?this.style.extraItemSpacing:this.extraItemSpacing),this.appendItemsAt(_,s)}},{key:"addContentItems",value:function addContentItems(o){var s=this._createContentItems(o),m=this._lastItemIndex+1;this._appendItemsAt(s,m,this._lastItemIndex),this._lastItemIndex+=s.length,this._contentItems&&(this._contentItems=[].concat(_toConsumableArray(this.contentItems),_toConsumableArray(s))),this.patch({stopLazyScrollIndex:m+s.length-1})}},{key:"addContentItemsAt",value:function addContentItemsAt(o,s){var m,_=this._createContentItems(o),S=this._lastLeftControlIndex+1+s;S===this._lastItemIndex+1?this.addContentItems(_):(this._appendItemsAt(_,S),this._contentItems&&((m=this._contentItems).splice.apply(m,[S,0].concat(_toConsumableArray(_))),this._lastItemIndex=this.contentItems.length-1),this.patch({stopLazyScrollIndex:this._lastItemIndex+_.length}))}},{key:"removeContentItemAt",value:function removeContentItemAt(o){var s=this._lastLeftControlIndex+1+o;this.removeItemAt(s),this._lastItemIndex--,this._contentItems&&this._contentItems.splice(o,1),this.patch({stopLazyScrollIndex:this.leftControls.length+this.contentItems.length-1})}},{key:"addLeftControls",value:function addLeftControls(o){var s=this._createControls(o),m=this._lastLeftControlIndex+1;this._appendItemsAt(s,m,this._lastLeftControlIndex),this._leftControls&&(this._leftControls=[].concat(_toConsumableArray(this._leftControls),_toConsumableArray(o)),this._lastLeftControlIndex=this._leftControls.length-1,this._lastItemIndex+=o.length),this.patch({startLazyScrollIndex:m+s.length})}},{key:"addLeftControlsAt",value:function addLeftControlsAt(o,s){var m,_=this._createControls(o);s===this._lastLeftControlIndex+1?this.addLeftControls(o):(this._appendItemsAt(_,s),this.leftControls&&((m=this._leftControls).splice.apply(m,[s,0].concat(_toConsumableArray(o))),this._lastLeftControlIndex=this._leftControls.length-1,this._lastItemIndex+=o.length),this.patch({startLazyScrollIndex:this._lastLeftControlIndex?this._lastLeftControlIndex+1:o.length}))}},{key:"removeLeftControlAt",value:function removeLeftControlAt(o){this.removeItemAt(o),this._lastLeftControlIndex--,this._lastItemIndex--,this.leftControls&&this._leftControls.splice(o,1),this.stopLazyScrollIndex=this.leftControls.length+this.contentItems.length-1}},{key:"addRightControls",value:function addRightControls(o){var s;(s=this._rightControls).push.apply(s,_toConsumableArray(o)),this._appendItemsAt(this._createControls(o),this.items.length)}},{key:"addRightControlsAt",value:function addRightControlsAt(o,s){var m,_=this._leftControls.length+this._contentItems.length+s;(m=this._rightControls).splice.apply(m,[s,0].concat(_toConsumableArray(o))),this._appendItemsAt(this._createControls(o),_)}},{key:"removeRightControlAt",value:function removeRightControlAt(o){var s=this.leftControls.length+this.contentItems.length+o;this.removeItemAt(s),this.rightControls&&this._rightControls.splice(o,1)}},{key:"_createControls",value:function _createControls(o){return o.map((function(o){return _objectSpread({backgroundType:"fill",centerInParent:!0},o)}))}},{key:"_createContentItems",value:function _createContentItems(o){return o.map((function(o){return _objectSpread(_objectSpread({},o),{},{centerInParent:!0})}))}},{key:"_setLeftControls",value:function _setLeftControls(o){this._leftControls=this._createControls(o),this._lastLeftControlIndex=o.length-1,this._updateContent()}},{key:"_getLeftControls",value:function _getLeftControls(){return this._leftControls}},{key:"_setRightControls",value:function _setRightControls(o){this._rightControls=this._createControls(o),this._updateContent()}},{key:"_getRightControls",value:function _getRightControls(){return this._rightControls}},{key:"_getContentItems",value:function _getContentItems(){return this._contentItems}},{key:"_setContentItems",value:function _setContentItems(o){this._contentItems=this._createContentItems(o),this._lastItemIndex=this._lastLeftControlIndex+o.length,this._updateContent()}},{key:"_getLeftControlItems",value:function _getLeftControlItems(){return this.leftControls.length?this.items.slice(0,this._lastLeftControlIndex+1):[]}},{key:"_getContentItemItems",value:function _getContentItemItems(){return this.contentItems.length?this.items.slice(this._lastLeftControlIndex+1,this._lastItemIndex+1):[]}},{key:"_getRightControlItems",value:function _getRightControlItems(){if(this.rightControls.length){var o=this._lastItemIndex||this._lastLeftControlIndex;return o?this.items.slice(o+1):this.items}return[]}},{key:"leftControls",get:function get(){return this._getLeftControls()},set:function set(o){this._setLeftControls(o)}},{key:"rightControls",get:function get(){return this._getRightControls()},set:function set(o){this._setRightControls(o)}},{key:"contentItems",get:function get(){return this._getContentItems()},set:function set(o){this._setContentItems(o)}},{key:"lazyLoadBuffer",get:function get(){return this._lazyLoadBuffer},set:function set(o){this._lazyLoadBuffer=o,this._getMoreItems()}}],[{key:"__componentName",get:function get(){return"ControlRow"}},{key:"__themeStyles",get:function get(){return QA}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(ControlRow),"_template",this).call(this)),{},{alpha:0,lazyScroll:!0,signals:{selectedChange:"_getMoreItems"}})}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(ControlRow),"properties",this)),["extraItemSpacing"])}}])}();var JA=Object.freeze({__proto__:null,base:function base$i(o){return{propertyTextStyle:_objectSpread(_objectSpread({},o.typography.headline1),{},{textColor:o.color.textNeutral}),valueTextStyle:_objectSpread(_objectSpread({},o.typography.body1),{},{textColor:o.color.textNeutral})}}}),ZA=function(o){_inherits(Spacer,DI);var s=_createSuper(Spacer);function Spacer(){return _classCallCheck(this,Spacer),s.apply(this,arguments)}return _createClass(Spacer,[{key:"_update",value:function _update(){this._Line.w=this.w,this._TickRight.x=this._Line.w,this.lineColor&&(this._Line.color=this._TickLeft.color=this._TickRight.color=this.lineColor),this.rotation=this.vertical?Math.PI/2:0,this.signal("spacerLoaded")}}],[{key:"__componentName",get:function get(){return"Spacer"}},{key:"_template",value:function _template(){return{Line:{h:Spacer._lineThickness,rect:!0,mountY:.5,TickLeft:_objectSpread(_objectSpread({},Spacer._tick),{},{x:-1*Spacer._lineThickness}),TickRight:Spacer._tick}}}},{key:"properties",get:function get(){return["lineColor"]}},{key:"tags",get:function get(){return["Line","TickLeft","TickRight"]}},{key:"_lineThickness",get:function get(){return 3}},{key:"_tickLength",get:function get(){return 25}},{key:"_tick",get:function get(){return{rect:!0,mountY:.5,w:Spacer._lineThickness,h:Spacer._tickLength,y:Spacer._lineThickness/2}}}]),Spacer}();!function(o){_inherits(GridOverlay,DI);var s=_createSuper(GridOverlay);function GridOverlay(){return _classCallCheck(this,GridOverlay),s.apply(this,arguments)}_createClass(GridOverlay,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(GridOverlay.prototype),"_construct",this).call(this),this._showColumns=this._showMargins=this._showSafe=this._showGutters=this._showText=!0}},{key:"_update",value:function _update(){this._updateGlobalThemeProps(),this._updateMargins(),this._updateSafe(),this._updateColumns(),this._updateGutters(),this._updateText(),this._updateVisibility()}},{key:"_updateVisibility",value:function _updateVisibility(){this._Columns.smooth={alpha:Number(this.showColumns)},this._Margins.smooth={alpha:Number(this.showMargins)},this._Safe.smooth={alpha:Number(this.showSafe)},this._Gutters.smooth={alpha:Number(this.showGutters)},this._TextPanel.smooth={alpha:Number(this.showText)}}},{key:"_updateGlobalThemeProps",value:function _updateGlobalThemeProps(){var o=hI.theme,s=o.layout,m=o.color,_=s.screenW,S=s.screenH,E=s.columnCount,A=s.marginX,O=s.marginY,H=s.gutterX,K=s.gutterY,z=s.safe;this._screenW=_,this._screenH=S,this._columnCount=E,this._marginX=A,this._marginY=O,this._safe=z,this._gutterX=H.xs,this._gutterY=K.xs,this._columnColor=m.interactiveNeutralFocusSoft,this._marginColor=m.green,this._safeColor=m.red,this._gutterColor=m.blue}},{key:"_updateMargins",value:function _updateMargins(){var o={lineColor:this._marginColor},s=_objectSpread(_objectSpread({},o),{},{w:this._marginX});this._MarginHorizontal.y=this._screenH/2,this._MarginLeft.patch(s),this._MarginRight.patch(s),this._MarginRight.x=this._screenW-this._marginX;var m=_objectSpread(_objectSpread({},o),{},{w:this._marginY});this._MarginVertical.x=this._marginX-m.w/2,this._MarginTop.patch(m),this._MarginTop.patch(m),this._MarginTop.y=m.w/2}},{key:"_updateSafe",value:function _updateSafe(){var o={lineColor:this._safeColor,w:this._safe};this._SafeHorizontal.y=this._screenH/4,this._SafeLeft.patch(o),this._SafeRight.patch(o),this._SafeRight.x=this._screenW-this._safe,this._SafeVertical.x=(this._screenW-o.w)/2,this._SafeVertical.y=o.w/2,this._SafeTop.patch(o),this._SafeBottom.patch(o),this._SafeBottom.y=this._screenH-this._safe}},{key:"_updateColumns",value:function _updateColumns(){this._Columns.patch({w:this._screenW,h:this._screenH,x:this._marginX,style:{itemSpacing:this._gutterX},items:this._columnRects})}},{key:"_columnRects",get:function get(){var o=this;return Array.apply(null,{length:this._columnCount}).map((function(){return{rect:!0,w:getWidthByColumnSpan(o.theme,1),h:o._screenH,color:o._columnColor}}))}},{key:"_updateGutters",value:function _updateGutters(){var o={lineColor:this._gutterColor,w:this._gutterY};this._GutterHorizontal.patch(_objectSpread(_objectSpread({},o),{},{x:(this._screenW-o.w)/2,y:this._screenH/4}))}},{key:"_updatePropertyTextStyle",value:function _updatePropertyTextStyle(o,s){var m={textStyle:_objectSpread({},this.style.propertyTextStyle)};s&&(m.textStyle.textColor=s),o.Items.tag("Property").style=m}},{key:"_updateValueTextStyle",value:function _updateValueTextStyle(o){o.Items.tag("Value").style={textStyle:this.style.valueTextStyle}}},{key:"_updateText",value:function _updateText(){var o="Property",s="Value";this._TextPanel.x=this._screenW-this._marginX-getWidthByColumnSpan(this.theme,3),this._TextPanel.y=this._safe,this._TextScreenW.Items.tag(o).content="Screen Width",this._TextScreenW.Items.tag(s).content="".concat(this._screenW,"px"),this._updatePropertyTextStyle(this._TextScreenW),this._updateValueTextStyle(this._TextScreenW),this._TextScreenH.Items.tag(o).content="Screen Height",this._TextScreenH.Items.tag(s).content="".concat(this._screenH,"px"),this._updatePropertyTextStyle(this._TextScreenH),this._updateValueTextStyle(this._TextScreenH),this._TextColumnCount.Items.tag(o).content="Columns",this._TextColumnCount.Items.tag(s).content="".concat(this._columnCount,", ").concat(Math.round(getWidthByColumnSpan(this.theme,1)),"px each"),this._updatePropertyTextStyle(this._TextColumnCount),this._updateValueTextStyle(this._TextColumnCount),this._TextMarginX.Items.tag(o).content="Margin-X",this._TextMarginX.Items.tag(s).content="".concat(this._marginX,"px"),this._updatePropertyTextStyle(this._TextMarginX,this._marginColor),this._updateValueTextStyle(this._TextMarginX),this._TextMarginY.Items.tag(o).content="Margin-Y",this._TextMarginY.Items.tag(s).content="".concat(this._marginY,"px"),this._updatePropertyTextStyle(this._TextMarginY,this._marginColor),this._updateValueTextStyle(this._TextMarginY),this._TextGutterY.Items.tag(o).content="Gutter-Y",this._TextGutterY.Items.tag(s).content="XSmall, ".concat(this._gutterY,"px"),this._updatePropertyTextStyle(this._TextGutterY,this._gutterColor),this._updateValueTextStyle(this._TextGutterY),this._TextSafe.Items.tag(o).content="Safe",this._TextSafe.Items.tag(s).content="".concat(this._safe,"px"),this._updatePropertyTextStyle(this._TextSafe,this._safeColor),this._updateValueTextStyle(this._TextSafe)}}],[{key:"__componentName",get:function get(){return"GridOverlay"}},{key:"__themeStyle",get:function get(){return JA}},{key:"_template",value:function _template(){var o={type:qI,autoResizeHeight:!0,Items:{Property:{type:oA,signals:{textBoxChanged:"_update"}},Value:{type:oA,signals:{textBoxChanged:"_update"},centerInParent:!0}}};return{Columns:{alpha:.001,type:qI},Margins:{alpha:.001,Horizontal:{Left:{type:ZA,signals:{spacerLoaded:"_update"}},Right:{type:ZA,signals:{spacerLoaded:"_update"}}},Vertical:{Top:{type:ZA,vertical:!0}}},Safe:{alpha:.001,Horizontal:{Left:{type:ZA,signals:{spacerLoaded:"_update"}},Right:{type:ZA,signals:{spacerLoaded:"_update"}}},Vertical:{Top:{type:ZA,vertical:!0},Bottom:{type:ZA,vertical:!0}}},Gutters:{alpha:.001,Horizontal:{type:ZA,signals:{spacerLoaded:"_update"}}},TextPanel:{alpha:.001,type:KA,autoResizeHeight:!0,Items:{ScreenW:o,ScreenH:o,ColumnCount:o,MarginX:o,MarginY:o,GutterY:o,Safe:o}}}}},{key:"properties",get:function get(){return["showColumns","showMargins","showSafe","showGutters","showText"]}},{key:"tags",get:function get(){return["Columns","Margins",{name:"MarginHorizontal",path:"Margins.Horizontal"},{name:"MarginLeft",path:"Margins.Horizontal.Left"},{name:"MarginRight",path:"Margins.Horizontal.Right"},{name:"MarginVertical",path:"Margins.Vertical"},{name:"MarginTop",path:"Margins.Vertical.Top"},"Safe",{name:"SafeHorizontal",path:"Safe.Horizontal"},{name:"SafeLeft",path:"Safe.Horizontal.Left"},{name:"SafeRight",path:"Safe.Horizontal.Right"},{name:"SafeVertical",path:"Safe.Vertical"},{name:"SafeTop",path:"Safe.Vertical.Top"},{name:"SafeBottom",path:"Safe.Vertical.Bottom"},"Gutters",{name:"GutterHorizontal",path:"Gutters.Horizontal"},"TextPanel",{name:"TextScreenW",path:"TextPanel.Items.ScreenW"},{name:"TextScreenH",path:"TextPanel.Items.ScreenH"},{name:"TextColumnCount",path:"TextPanel.Items.ColumnCount"},{name:"TextMarginX",path:"TextPanel.Items.MarginX"},{name:"TextMarginY",path:"TextPanel.Items.MarginY"},{name:"TextGutterY",path:"TextPanel.Items.GutterY"},{name:"TextSafe",path:"TextPanel.Items.Safe"}]}}])}();var eP=Object.freeze({__proto__:null,base:function base$h(o){return{cursorStyle:{textColor:o.color.textNeutral,blink:!0,w:o.spacer.xs,h:o.spacer.xxl},eyebrowTextStyle:_objectSpread(_objectSpread({},o.typography.caption1),{},{maxLines:1,textColor:o.color.textNeutral}),helpTextStyle:_objectSpread(_objectSpread({},o.typography.caption1),{},{maxLines:1,textColor:o.color.textNeutralSecondary}),minWidth:getWidthByUpCount(o,4),paddingX:o.spacer.xl,paddingY:o.spacer.xl}},mode:function mode$6(o){return{disabled:{eyebrowTextStyle:{textColor:o.color.textNeutralDisabled},helpTextStyle:{textColor:o.color.textNeutralDisabled}},focused:{cursorStyle:{textColor:o.color.textInverse},eyebrowTextStyle:{textColor:o.color.textNeutral},helpTextStyle:{textColor:o.color.textNeutralSecondary}}}},tone:function tone$a(o){return{inverse:{mode:{focused:{eyebrowTextStyle:{textColor:o.color.textNeutral},helpTextStyle:{textColor:o.color.textNeutral}}}}}}}),tP=function(o){_inherits(Input,sA);var s=_createSuper(Input);function Input(){return _classCallCheck(this,Input),s.apply(this,arguments)}return _createClass(Input,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(Input.prototype),"_construct",this).call(this),this._title="",this.actualTitle="",this.position=this.title?this.title.length:0,this._justify="left",this._fixed=!0,this.w=this.style.minWidth}},{key:"$itemChanged",value:function $itemChanged(){_get(_getPrototypeOf(Input.prototype),"$itemChanged",this).call(this),this._updateTextWrapper(),this._updateHiddenContent(),this._updateCursorPosition(),this._updateTitleScrollPosition()}},{key:"_onTitleTextBoxChanged",value:function _onTitleTextBoxChanged(){this._updateHiddenContent()}},{key:"_onHiddenTextBoxChanged",value:function _onHiddenTextBoxChanged(){this._updateCursorPosition()}},{key:"_update",value:function _update(){this._updatePassword(),_get(_getPrototypeOf(Input.prototype),"_update",this).call(this),this._updateEyebrow(),this._updateHelpText(),this._updateTextWrapper(),this._updateHiddenContent(),this._updateCursor(),this._updateCursorListening(),this._updateCursorBlink(),this._updateCursorPosition(),this._updateTitleScrollPosition()}},{key:"_updatePassword",value:function _updatePassword(){this.title=this.password?this.mask.repeat(this.actualTitle.length):this.actualTitle}},{key:"_updateTruncation",value:function _updateTruncation(){this._Title&&this._Title.patch({style:{textStyle:_objectSpread(_objectSpread({},this.style.textStyle),{},{wordWrap:!1})}})}},{key:"_updateEyebrow",value:function _updateEyebrow(){this._Eyebrow.patch({content:this.eyebrow,style:{textStyle:this.style.eyebrowTextStyle},mountY:1,x:this.style.paddingX,y:this.y-this.style.paddingY})}},{key:"_updateHelpText",value:function _updateHelpText(){this._HelpText.patch({content:this.helpText,style:{textStyle:this.style.helpTextStyle},x:this.style.paddingX,y:this.y+this.innerH+this.style.paddingY})}},{key:"_updateTextWrapper",value:function _updateTextWrapper(){this._TextWrapper.clipping=!0,this._TextWrapper.w=this._visibleContentWidth,this._Title&&(this._TextWrapper.h=this._Title.h)}},{key:"_updateHiddenContent",value:function _updateHiddenContent(){this._HiddenContent||this._Content.patch({HiddenContent:{type:oA,mountY:.5,y:function y(o){return o/2},signals:{textBoxChanged:"_onHiddenTextBoxChanged"}}});var o=this.title,s=void 0===o?"":o,m=this.position,_=this.password,S=this.mask,E=_?S.repeat(s.length).substring(0,m):s.substring(0,m);this._HiddenContent.patch({style:{textStyle:this.style.textStyle},content:E}),this._HiddenContent._Text&&this._HiddenContent._Text.patch({alpha:.001})}},{key:"_updateCursor",value:function _updateCursor(){this.style.cursorStyle&&this.style.cursorStyle.blink&&(this._Cursor||(this._Content.patch({Cursor:{rect:!0,mountY:.5}}),this.cursorBlink=this._Cursor.animation({duration:1.5,repeat:-1,actions:[{p:"alpha",v:{0:0,.5:1,1:0}}]})),this._Cursor.patch(this.style.cursorStyle))}},{key:"_updateCursorListening",value:function _updateCursorListening(){this._isDisabledMode?this.cursorBlink&&(this.isCursorActive?this.cursorBlink.start():this.cursorBlink.stop()):this.cursorBlink&&!this.cursorBlink.isPlaying()&&this.cursorBlink.start(),this._Cursor.smooth={color:this.style.cursorStyle.textColor}}},{key:"_updateCursorBlink",value:function _updateCursorBlink(){this.cursorBlink&&(this.isCursorActive?this.cursorBlink.start():(this.cursorBlink.stop(),this._Cursor.patch({alpha:.001})))}},{key:"_updateCursorPosition",value:function _updateCursorPosition(){this._Cursor.x=this._titleX+(this._isOverflow?this._TextWrapper.w:this._HiddenContent.w)}},{key:"_updateTitleScrollPosition",value:function _updateTitleScrollPosition(){this._Title&&(this._Title.x=this._isOverflow?this._visibleContentWidth-this._HiddenContent.w:0,this._HiddenContent&&this._TextWrapper&&(this._HiddenContent.x=this._TextWrapper.x+this._Title.x))}},{key:"_suffixX",get:function get(){var o=this._hasPrefix?this.w-this._paddingLeft-this._paddingRight-this._prefixW:this.w-this._paddingLeft-this._paddingRight-this.style.paddingX;return o>0?o:0}},{key:"isCursorActive",get:function get(){return this.listening&&(this._isFocusedMode||this._isUnfocusedMode)}},{key:"_isOverflow",get:function get(){return this._HiddenContent.w>this._visibleContentWidth}},{key:"_visibleContentWidth",get:function get(){return this._fixedWordWrapWidth}},{key:"value",get:function get(){return this.actualTitle},set:function set(o){this.title=this.actualTitle=o,this.position=0,this._updatePassword()}},{key:"clear",value:function clear(){this.isCursorActive&&(this.title=this.actualTitle="",this.position=0)}},{key:"insert",value:function insert(o){this.isCursorActive&&(this.actualTitle=this.actualTitle.slice(0,this.position)+o+this.actualTitle.slice(this.position),this._updatePassword(),this.position+=o.length)}},{key:"backspace",value:function backspace(){this.isCursorActive&&this.position>0&&(this.actualTitle=this.actualTitle.slice(0,this.position-1)+this.actualTitle.slice(this.position),this._updatePassword(),this.position--)}},{key:"_handleLeft",value:function _handleLeft(){return!this._isDisabledMode&&(this.moveLeft(),"function"!=typeof this.onLeft||this.onLeft(this))}},{key:"_handleRight",value:function _handleRight(){return!this._isDisabledMode&&(this.moveRight(),"function"!=typeof this.onRight||this.onRight(this))}},{key:"moveLeft",value:function moveLeft(){return this.position>=0&&(this.position--,!0)}},{key:"moveRight",value:function moveRight(){return this.position<this.title.length&&(this.position++,!0)}},{key:"announce",get:function get(){return this._announce?this._announce:this.password?[this.eyebrow,this.helpText]:[this.eyebrow,"Input: "+this.title,this.helpText]},set:function set(o){_set(_getPrototypeOf(Input.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Input"}},{key:"__themeStyle",get:function get(){return eP}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(Input),"_template",this).call(this)),{},{Eyebrow:{type:oA},HelpText:{type:oA}})}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Input),"properties",this)),["actualTitle","cursor","eyebrow","helpText","listening","mask","password","position"])}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Input),"tags",this)),["Eyebrow","HelpText",{name:"Cursor",path:"Content.Cursor"},{name:"HiddenContent",path:"Content.HiddenContent"}])}}]),Input}(),nP=Object.freeze({__proto__:null,base:function base$g(o){var s=o.typography.headline2;return{h:9*o.spacer.md,minWidth:7*o.spacer.md,paddingX:o.spacer.md,textStyle:s,sizes:{sm:7*o.spacer.md,md:15*o.spacer.md,lg:23*o.spacer.md,xl:47*o.spacer.md,xxl:95*o.spacer.md},iconW:s.lineHeight,iconH:s.lineHeight}}}),rP={a:"alpha",b:"bravo",c:"charlie",d:"delta",e:"echo",f:"foxtrot",g:"golf",h:"hotel",i:"india",j:"juliett",k:"kilo",l:"lima",m:"mike",n:"november",o:"oscar",p:"papa",q:"quebec",r:"romeo",s:"sierra",t:"tango",u:"uniform",v:"victor",w:"whiskey",x:"x-ray",y:"yankee",z:"zulu"};function getNato(o){return function isAlphaChar(o){return/^[A-Za-z]$/.test(o)}(o)?"".concat(o,", ").concat(rP[o.toLowerCase()]):o}var iP=function(o){_inherits(Key,sA);var s=_createSuper(Key);function Key(){return _classCallCheck(this,Key),s.apply(this,arguments)}return _createClass(Key,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(Key.prototype),"_construct",this).call(this),this._size="sm",this._fixed=!0}},{key:"_update",value:function _update(){this.w=this.style.sizes[this.size]||this.style.sizes.sm,this._updatePrefixStyle(),_get(_getPrototypeOf(Key.prototype),"_update",this).call(this)}},{key:"_updatePrefixStyle",value:function _updatePrefixStyle(){this._prefix&&this.icon&&this._updatePrefixObj(this.icon,{style:this.style.iconStyle})}},{key:"_updatePrefixObj",value:function _updatePrefixObj(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._prefix=_objectSpread({type:BI,icon:o,w:this.style.iconW,h:this.style.iconH},s)}},{key:"_setIcon",value:function _setIcon(o){return o?this._updatePrefixObj(o,{style:this.style.iconStyle}):this._prefix=o,o}},{key:"announce",get:function get(){return this._announce?this._announce:function isUpperCase(o){return/^[A-Z]$/.test(o)}(this.title)?"Capital ".concat(getNato(this.title),", button"):getNato(this.title)+", button"},set:function set(o){_set(_getPrototypeOf(Key.prototype),"announce",o,this,!0)}},{key:"_handleEnter",value:function _handleEnter(){return"function"==typeof this.onEnter?this.onEnter(this):(this.toggle&&this.fireAncestors("$toggleKeyboard",this.toggle),this.fireAncestors("$onSoftKey",{key:this.keyId||this.title,toggle:this.toggle}),!1)}}],[{key:"__componentName",get:function get(){return"Key"}},{key:"__themeStyle",get:function get(){return nP}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Key),"properties",this)),["icon","size","toggle"])}}]),Key}(),aP=Object.freeze({__proto__:null,base:function base$f(o){return{keySpacing:o.spacer.md,screenW:o.layout.screenW,marginX:o.layout.marginX,inputSpacing:10*o.spacer.md+o.spacer.md,inputStyle:{radius:o.radius.md}}}}),oP=function capitalize(o){return o.charAt(0).toUpperCase()+o.slice(1)},sP=function(o){_inherits(Keyboard,DI);var s=_createSuper(Keyboard);function Keyboard(){return _classCallCheck(this,Keyboard),s.apply(this,arguments)}return _createClass(Keyboard,[{key:"_init",value:function _init(){this._setShouldUpdateThemeBound=this._setShouldUpdateTheme.bind(this),hI.on("themeUpdate",this._setShouldUpdateThemeBound),_get(_getPrototypeOf(Keyboard.prototype),"_init",this).call(this)}},{key:"_setShouldUpdateTheme",value:function _setShouldUpdateTheme(){this.shouldUpdateTheme=!0}},{key:"_detach",value:function _detach(){_get(_getPrototypeOf(Keyboard.prototype),"_detach",this).call(this),hI.off("themeUpdate",this._setShouldUpdateThemeBound)}},{key:"_focus",value:function _focus(){_get(_getPrototypeOf(Keyboard.prototype),"_focus",this).call(this),this.fireAncestors("$keyboardFocused",!0)}},{key:"_getFocused",value:function _getFocused(){return this._currentKeyboard||this}},{key:"_update",value:function _update(){this._currentFormat||(this._currentFormat=this.defaultFormat),this.centerKeyboard?this.x=(this.style.screenW-this.w)/2-this.style.marginX:this.x=0,this._formatsChanged||this.shouldUpdateTheme?(this._createFormat(this._currentFormat),this._refocus(),this._formatsChanged=!1,this.shouldUpdateTheme=!1):this._formatKeys()}},{key:"_createFormat",value:function _createFormat(o){var s=this.formats[o];if(s){var m=this._formatKeyboardData(s);this._createKeyboard(o,this._createRows(m,o))}}},{key:"_createKeyboard",value:function _createKeyboard(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];o=oP(o),1===s.length?this.patch(_defineProperty({},o,s[0])):this.patch(_defineProperty({},o,{type:KA,plinko:!0,items:s,style:{itemSpacing:this.style.keySpacing},autoResizeWidth:!0,autoResizeHeight:!0,neverScroll:!0}))}},{key:"_createRows",value:function _createRows(){var o=this,s=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(m){return{type:qI,autoResizeHeight:!0,autoResizeWidth:!0,centerInParent:o.centerKeyboard,neverScroll:!0,wrapSelected:void 0===o.rowWrap||o.rowWrap,style:{itemSpacing:o.style.keySpacing},items:o._createKeys(m,s)}}))}},{key:"_createKeys",value:function _createKeys(){var o=this,s=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(m){if(!m)return{skipFocus:!0};var _={type:o.keyComponent||iP};if("object"===_typeof(m)){var S,E,A,O=m.keyId||m.title,H=(null===(S=o.style.keyProps)||void 0===S||null===(S=S[s])||void 0===S?void 0:S[O])||(null===(E=o.style.keyProps)||void 0===E?void 0:E[O]);return H&&H.icon?_objectSpread(_objectSpread(_objectSpread({type:o.keyComponent||iP},m),null===(A=o.style.keyProps)||void 0===A?void 0:A[O]),{},{style:{iconStyle:_objectSpread({},H.iconStyle)},size:H.size||m.size}):_objectSpread(_objectSpread({},_),m)}return _objectSpread(_objectSpread({},_),{},{title:m})}))}},{key:"_formatKeyboardData",value:function _formatKeyboardData(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(Array.isArray(o)&&o.length){if(!Array.isArray(o[0])&&!this.inline){var s,m,_=[];for(s=0,m=-1;s<o.length;s++)s%this.columnCount==0&&(_[++m]=[]),_[m].push(o[s]);return _}return this.inline?[o]:o}}},{key:"_formatKeys",value:function _formatKeys(){var o=this;Object.keys(this.formats).forEach((function(s){var m=o.tag(oP(s));m&&(m.patch({style:{itemSpacing:o.style.keySpacing}}),m.items.forEach((function(s){s.patch({style:{itemSpacing:o.style.keySpacing},centerInParent:o.centerKeys,wrapSelected:void 0===o.rowWrap||o.rowWrap})})),m.queueRequestUpdate())}))}},{key:"$toggleKeyboard",value:function $toggleKeyboard(o){var s=oP(o);if(o!==this._currentFormat){this._createFormat(o);var m=this.tag(s);this.selectKeyOn(m),this._currentKeyboard.alpha=0,m.alpha=1,this._currentFormat=o}}},{key:"selectKeyOn",value:function selectKeyOn(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getSelectedKey(),m=s.row,_=s.column;o&&o.constructor&&("Row"===o.constructor.name?o.selectedIndex=_:(o.selectedIndex=m,o.selected.selectedIndex=_))}},{key:"getSelectedKey",value:function getSelectedKey(){var o,s,m=this._currentKeyboard;return"Row"===m.constructor.name?(o=0,s=m.selectedIndex):(o=m.selectedIndex,s=m.selected.selectedIndex),{row:o,column:s}}},{key:"$itemChanged",value:function $itemChanged(){this.w=this._currentKeyboard.w,this.fireAncestors("$itemChanged"),this.signal("keyboardWidthChanged")}},{key:"_setFormats",value:function _setFormats(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._formatsChanged=!0,o}},{key:"defaultFormat",get:function get(){return this._defaultFormat||Object.keys(this.formats)[0]},set:function set(o){this._defaultFormat=o}},{key:"_currentKeyboard",get:function get(){return this.tag(oP(this._currentFormat))}},{key:"columnCount",get:function get(){return this._columnCount?this._columnCount:this.rowCount?this.formats[this.defaultFormat.toLowerCase()].length/this.rowCount:this.inline?this.formats[this.defaultFormat.toLowerCase()].length:11},set:function set(o){this._columnCount=o}},{key:"announce",get:function get(){return this._announce?this._announce:"Keyboard"+(this.title?", ".concat(this.title):"")},set:function set(o){_set(_getPrototypeOf(Keyboard.prototype),"announce",o,this,!0)}},{key:"announceContext",get:function get(){return this._announceContext||["PAUSE-2","Use arrow keys to choose characters, press center to select"]},set:function set(o){_set(_getPrototypeOf(Keyboard.prototype),"announceContext",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Keyboard"}},{key:"__themeStyle",get:function get(){return aP}},{key:"properties",get:function get(){return["formats","centerKeyboard","rowWrap","centerKeys","keyComponent"]}}]),Keyboard}();!function(o){_inherits(KeyboardEmail,sP);var s=_createSuper(KeyboardEmail);function KeyboardEmail(){return _classCallCheck(this,KeyboardEmail),s.apply(this,arguments)}_createClass(KeyboardEmail,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(KeyboardEmail.prototype),"_construct",this).call(this),this.formats=this.emailFormat}},{key:"emailFormat",get:function get(){return{uppercase:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],["Q","W","E","R","T","Y","U","I","O","P",{title:"#@!",size:"md",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"}],["A","S","D","F","G","H","J","K","L","@",{title:"áöû",size:"md",toggle:"accents",announce:"accents, button",keyId:"accents"}],["Z","X","C","V","B","N","M",{title:".",announce:"period, button"},{title:"-",announce:"dash, button"},{title:"_",announce:"underscore, button"},{title:"shift",size:"md",toggle:"lowercase",announce:"shift off, button",keyId:"shift"}],[{title:".com",announce:"dot, com",size:"md"},{title:".net",announce:"dot, net",size:"md"},{title:".edu",announce:"dot, edu",size:"md"},{title:".org",announce:"dot, org",size:"md"},{title:".co",announce:"dot, co",size:"md"},{title:".uk",announce:"dot, uk",size:"md"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]],lowercase:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],["q","w","e","r","t","y","u","i","o","p",{title:"#@!",size:"md",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"}],["a","s","d","f","g","h","j","k","l","@",{title:"áöû",size:"md",toggle:"accents",announce:"accents, button",keyId:"accents"}],["z","x","c","v","b","n","m",{title:"_",announce:"underscore, button"},{title:".",announce:"period, button"},{title:"-",announce:"dash, button"},{title:"shift",size:"md",toggle:"uppercase",announce:"shift on, button",keyId:"shift"}],[{title:".com",announce:"dot, com",size:"md"},{title:".net",announce:"dot, net",size:"md"},{title:".edu",announce:"dot, edu",size:"md"},{title:".org",announce:"dot, org",size:"md"},{title:".co",announce:"dot, co",size:"md"},{title:".uk",announce:"dot, uk",size:"md"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]],accents:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],["ä","ë","ï","ö","ü","ÿ","à","è","ì","ò",{title:"#@!",size:"md",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"}],["ù","á","é","í","ó","ú","ý","â","ê","@",{title:"abc",size:"md",toggle:"lowercase",announce:"alpha mode, button"}],["î","ô","û","ã","ñ","","","","","","","","","","","","","","","","",{title:"_",announce:"underscore, button"},{title:".",announce:"period, button"},{title:"-",announce:"dash, button"},{title:"shift",size:"md",toggle:"accentsUpper",announce:"shift off, button",keyId:"shift"}],[{title:".com",announce:"dot, com",size:"md"},{title:".net",announce:"dot, net",size:"md"},{title:".edu",announce:"dot, edu",size:"md"},{title:".org",announce:"dot, org",size:"md"},{title:".co",announce:"dot, co",size:"md"},{title:".uk",announce:"dot, uk",size:"md"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]],accentsUpper:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],["Ä","Ë","Ï","Ö","Ü","Ÿ","À","È","Ì","Ò",{title:"#@!",size:"md",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"}],["Ù","Á","É","Í","Ó","Ú","Ý","Â","Ê","@",{title:"abc",size:"md",toggle:"lowercase",announce:"alpha mode, button"}],["Î","Ô","Û","Ã","Ñ","","","","","","","","","","","","","","","","",{title:"_",announce:"underscore, button"},{title:".",announce:"period, button"},{title:"-",announce:"dash, button"},{title:"shift",size:"md",toggle:"accents",announce:"shift off, button",keyId:"shift"}],[{title:".com",announce:"dot, com",size:"md"},{title:".net",announce:"dot, net",size:"md"},{title:".edu",announce:"dot, edu",size:"md"},{title:".org",announce:"dot, org",size:"md"},{title:".co",announce:"dot, co",size:"md"},{title:".uk",announce:"dot, uk",size:"md"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]],symbols:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],[{title:"!",announce:"exclamation, button"},"@","#","$","%",{title:"^",announce:"caret circumflex, button"},"&","*",{title:"(",announce:"open parenthesis, button"},{title:")",announce:"close parenthesis, button"},{title:"abc",size:"md",toggle:"lowercase",announce:"alpha mode, button"}],[{title:"{",announce:"open brace, button"},{title:"}",announce:"close brace, button"},{title:"[",announce:"open bracket, button"},{title:"]",announce:"close bracket, button"},{title:";",announce:"semicolon, button"},{title:'"',announce:"doublequote, button"},{title:",",announce:"comma, button"},{title:"|",announce:"vertical bar, button"},{title:"\\",announce:"backslash, button"},{title:"/",announce:"forwardslash, button"},{title:"áöû",size:"md",toggle:"accents",announce:"accents, button",keyId:"accents"}],[{title:"<",announce:"less than, button"},{title:">",announce:"greater than, button"},{title:"?",announce:"question mark, button"},{title:"=",announce:"equal sign, button"},{title:"`",announce:"grave accent, button"},{title:"~",announce:"tilde, button"},{title:"_",announce:"underscore, button"},{title:":",announce:"colon, button"},{title:"-",announce:"dash, button"},{title:"+",announce:"plus sign, button"}],[{title:".com",announce:"dot, com",size:"md"},{title:".net",announce:"dot, net",size:"md"},{title:".edu",announce:"dot, edu",size:"md"},{title:".org",announce:"dot, org",size:"md"},{title:".co",announce:"dot, co",size:"md"},{title:".uk",announce:"dot, uk",size:"md"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]]}}}],[{key:"__componentName",get:function get(){return"KeyboardEmail"}},{key:"__themeStyle",get:function get(){return aP}}])}(),function(o){_inherits(KeyboardFullScreen,sP);var s=_createSuper(KeyboardFullScreen);function KeyboardFullScreen(){return _classCallCheck(this,KeyboardFullScreen),s.apply(this,arguments)}_createClass(KeyboardFullScreen,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(KeyboardFullScreen.prototype),"_construct",this).call(this),this.formats=this.fullscreenFormat}},{key:"fullscreenFormat",get:function get(){return{letters:[["","","","","","","","","",{title:"#@!",size:"lg",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"},{title:"Space",size:"lg",keyId:"space",announce:"space, button"},{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"},"","","","","","","","",""],["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]],symbols:[["","","","","","","","","",{title:"ABC",size:"lg",toggle:"letters",announce:"caps on, button"},{title:"Space",size:"lg",keyId:"space",announce:"space, button"},{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"},"","","","","","","","",""],["1","2","3","4","5","6","7","8","9","0",{title:"!",announce:"exclamation, button"},"@","#","$","%",{title:"^",announce:"caret circumflex, button"},"&","*",{title:"(",announce:"open parenthesis, button"},{title:")",announce:"close parenthesis, button"},{title:"`",announce:"grave accent, button"},"~","_",".","-","+"]]}}}],[{key:"__componentName",get:function get(){return"KeyboardFullScreen"}},{key:"__themeStyle",get:function get(){return aP}}])}(),function(o){_inherits(KeyboardNumbers,sP);var s=_createSuper(KeyboardNumbers);function KeyboardNumbers(){return _classCallCheck(this,KeyboardNumbers),s.apply(this,arguments)}_createClass(KeyboardNumbers,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(KeyboardNumbers.prototype),"_construct",this).call(this),this.formats=this.numbersFormat}},{key:"numbersFormat",get:function get(){return{numbers:["1","2","3","4","5","6","7","8","9","0"],dialpad:[["1","2","3"],["4","5","6"],["7","8","9"],["0"]],dialpadExtended:[["1","2","3"],["4","5","6"],["7","8","9"],["0"],[{title:"Delete",size:"lg",keyId:"delete",announce:"delete, button"}]]}}}],[{key:"__componentName",get:function get(){return"KeyboardNumbers"}},{key:"__themeStyle",get:function get(){return aP}}])}(),function(o){_inherits(KeyboardQwerty,sP);var s=_createSuper(KeyboardQwerty);function KeyboardQwerty(){return _classCallCheck(this,KeyboardQwerty),s.apply(this,arguments)}_createClass(KeyboardQwerty,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(KeyboardQwerty.prototype),"_construct",this).call(this),this.formats=this.qwertyFormat}},{key:"qwertyFormat",get:function get(){return{uppercase:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],["Q","W","E","R","T","Y","U","I","O","P",{title:"#@!",size:"md",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"}],["A","S","D","F","G","H","J","K","L","@",{title:"áöû",size:"md",toggle:"accents",announce:"accents, button",keyId:"accents"}],["Z","X","C","V","B","N","M",{title:"_",announce:"underscore, button"},{title:".",announce:"period, button"},{title:"-",announce:"dash, button"},{title:"shift",size:"md",toggle:"lowercase",announce:"shift off, button",keyId:"shift"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]],lowercase:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],["q","w","e","r","t","y","u","i","o","p",{title:"#@!",size:"md",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"}],["a","s","d","f","g","h","j","k","l","@",{title:"áöû",size:"md",toggle:"accents",announce:"accents, button",keyId:"accents"}],["z","x","c","v","b","n","m",{title:"_",announce:"underscore, button"},{title:".",announce:"period, button"},{title:"-",announce:"dash, button"},{title:"shift",size:"md",toggle:"uppercase",announce:"shift on, button",keyId:"shift"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]],accents:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],["ä","ë","ï","ö","ü","ÿ","à","è","ì","ò",{title:"#@!",size:"md",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"}],["ù","á","é","í","ó","ú","ý","â","ê","@",{title:"abc",size:"md",toggle:"lowercase",announce:"alpha mode, button"}],["î","ô","û","ã","ñ","","","","","","","","","","","","","","","","",{title:"_",announce:"underscore, button"},{title:".",announce:"period, button"},{title:"-",announce:"dash, button"},{title:"shift",size:"md",toggle:"accentsUpper",announce:"shift off, button",keyId:"shift"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]],accentsUpper:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],["Ä","Ë","Ï","Ö","Ü","Ÿ","À","È","Ì","Ò",{title:"#@!",size:"md",toggle:"symbols",announce:"symbol mode, button",keyId:"symbols"}],["Ù","Á","É","Í","Ó","Ú","Ý","Â","Ê","@",{title:"abc",size:"md",toggle:"lowercase",announce:"alpha mode, button"}],["Î","Ô","Û","Ã","Ñ","","","","","","","","","","","","","","","","",{title:".",announce:"period, button"},{title:"-",announce:"dash, button"},{title:"_",announce:"underscore, button"},{title:"shift",size:"md",toggle:"accents",announce:"shift off, button",keyId:"shift"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]],symbols:[["1","2","3","4","5","6","7","8","9","0",{title:"Delete",size:"md",keyId:"delete",announce:"delete, button"}],[{title:"!",announce:"exclamation, button"},"@","#","$","%",{title:"^",announce:"caret circumflex, button"},"&","*",{title:"(",announce:"open parenthesis, button"},{title:")",announce:"close parenthesis, button"},{title:"abc",size:"md",toggle:"lowercase",announce:"alpha mode, button"}],[{title:"{",announce:"open brace, button"},{title:"}",announce:"close brace, button"},{title:"[",announce:"open bracket, button"},{title:"]",announce:"close bracket, button"},{title:";",announce:"semicolon, button"},{title:'"',announce:"doublequote, button"},{title:",",announce:"comma, button"},{title:"|",announce:"vertical bar, button"},{title:"\\",announce:"backslash, button"},{title:"/",announce:"forwardslash, button"},{title:"áöû",size:"md",toggle:"accents",announce:"accents, button",keyId:"accents"}],[{title:"<",announce:"less than, button"},{title:">",announce:"greater than, button"},{title:"?",announce:"question mark, button"},{title:"=",announce:"equal sign, button"},{title:"`",announce:"grave accent, button"},{title:"~",announce:"tilde, button"},{title:"_",announce:"underscore, button"},{title:":",announce:"colon, button"},{title:"-",announce:"dash, button"},{title:"+",announce:"plus sign, button"}],[{title:"Clear",size:"lg",keyId:"clear",announce:"clear, button"},{title:"Space",size:"xl",keyId:"space",announce:"space, button"},{title:"Done",size:"lg",keyId:"done",announce:"done, button"}]]}}}],[{key:"__componentName",get:function get(){return"KeyboardQwerty"}},{key:"__themeStyle",get:function get(){return aP}}])}(),function(o){_inherits(KeyboardInput,DI);var s=_createSuper(KeyboardInput);function KeyboardInput(){return _classCallCheck(this,KeyboardInput),s.apply(this,arguments)}_createClass(KeyboardInput,[{key:"_update",value:function _update(){this._Wrapper.style.itemSpacing=this.style.inputSpacing,this._updateKeyboardType(),this._updateInput(),this._updateKeyboard(),this._updateCenterKeyboard()}},{key:"_updateKeyboardType",value:function _updateKeyboardType(){this._Keyboard.constructor!==this.keyboardType&&(this._Wrapper._resetItems(),this._Wrapper.items=[{type:tP,ref:"Input"},{type:this.keyboardType,ref:"Keyboard",passSignals:{keyboardWidthChanged:!0}}])}},{key:"_updateInput",value:function _updateInput(){this._Input.patch(_objectSpread(_objectSpread({},this.input),{},{centerInParent:this.centerKeyboard,w:this._Keyboard.w,style:_objectSpread({},this.style.inputStyle),listening:this._isFocusedMode}))}},{key:"_updateKeyboard",value:function _updateKeyboard(){this._Keyboard.patch({defaultFormat:this.defaultFormat||"lowercase",centerKeyboard:this.centerKeyboard})}},{key:"_updateWidth",value:function _updateWidth(){this._Input.w=this.w=this._Keyboard.w,this.fireAncestors("$itemChanged")}},{key:"_updateCenterKeyboard",value:function _updateCenterKeyboard(){this.centerKeyboard?this.x=(this.style.screenW-this.w)/2-this.style.marginX:this.x=0}},{key:"$onSoftKey",value:function $onSoftKey(o){var s=o.key,m=void 0===s?"":s;if(!o.toggle)switch(m.toLowerCase()){case"delete":this._Input.backspace();break;case"done":break;case"space":this._Input.insert(" ");break;case"clear":this._Input.clear();break;default:this._Input.insert(m)}}},{key:"$keyboardFocused",value:function $keyboardFocused(o){this._Input.listening=!!o}},{key:"_getFocused",value:function _getFocused(){return this._Wrapper||this}}],[{key:"__componentName",get:function get(){return"KeyboardInput"}},{key:"properties",get:function get(){return["centerKeyboard","defaultFormat","input","keyboardType"]}},{key:"__themeStyle",get:function get(){return aP}},{key:"_template",value:function _template(){return{Wrapper:{type:KA,neverScroll:!0,w:this.w,items:[{type:tP,ref:"Input"},{type:sP,ref:"Keyboard",passSignals:{keyboardWidthChanged:!0}}],selectedIndex:1,signals:{keyboardWidthChanged:"_updateWidth"}}}}},{key:"tags",get:function get(){return["Wrapper",{name:"Input",path:"Wrapper.Input"},{name:"Keyboard",path:"Wrapper.Keyboard"}]}}])}();var uP=Object.freeze({__proto__:null,base:function base$e(o){var s=o.spacer.lg;return{w:s,h:s,radius:s/2}},tone:function tone$9(o){return{neutral:{circleColor:o.color.interactiveNeutralFocus,mode:{disabled:{circleColor:o.color.fillNeutralDisabled}}},inverse:{circleColor:o.color.interactiveInverseFocus,mode:{disabled:{circleColor:o.color.fillInverseDisabled}}},brand:{circleColor:o.color.interactiveBrandFocus,mode:{disabled:{circleColor:o.color.fillInverseDisabled}}}}}}),lP=function(o){_inherits(Knob,DI);var s=_createSuper(Knob);function Knob(){return _classCallCheck(this,Knob),s.apply(this,arguments)}return _createClass(Knob,[{key:"_update",value:function _update(){this._updateCircleLayout()}},{key:"_updateCircleLayout",value:function _updateCircleLayout(){this.patch({texture:E.Tools.getRoundRect(this.w,this.h,this.style.radius,null,null,!0,this.style.circleColor)})}}],[{key:"__componentName",get:function get(){return"Knob"}},{key:"__themeStyle",get:function get(){return uP}},{key:"_template",value:function _template(){return{mount:.5}}}]),Knob}(),cP=Object.freeze({__proto__:null,base:function base$d(o){return{alpha:o.alpha.primary,descriptionTextStyle:_objectSpread(_objectSpread({},o.typography.body3),{},{maxLines:1,textColor:o.color.textNeutralSecondary}),h:3*o.spacer.xxl,logoStyle:{w:2*o.spacer.xxl,h:2*o.spacer.xxl,radius:o.radius.sm},paddingX:o.spacer.xl,prefixH:o.spacer.xxxl+o.spacer.xl,suffixH:o.spacer.xxxl+o.spacer.xl,titlePadding:o.spacer.lg,titleTextStyle:_objectSpread(_objectSpread({},o.typography.headline3),{},{maxLines:1,textColor:o.color.textNeutral}),w:eI.getWidthByColumnSpan(o,3)}},mode:function mode$5(o){return{disabled:{alpha:o.alpha.inactive,descriptionTextStyle:{textColor:o.color.textNeutralDisabled},titleTextStyle:{textColor:o.color.textNeutralDisabled}},focused:{descriptionTextStyle:{textColor:o.color.textInverseSecondary},titleTextStyle:{textColor:o.color.textInverse}}}},tone:function tone$8(o){return{inverse:{mode:{focused:{descriptionTextStyle:{textColor:o.color.textNeutral},titleTextStyle:{textColor:o.color.textNeutral}}}}}}}),dP=function(o){_inherits(ListItem,sA);var s=_createSuper(ListItem);function ListItem(){return _classCallCheck(this,ListItem),s.apply(this,arguments)}return _createClass(ListItem,[{key:"_onTextBoxChanged",value:function _onTextBoxChanged(){this._updateTitle(),this._updateTruncation()}},{key:"_update",value:function _update(){this._updatePrefixLogo(),this._updateSuffixLogo(),_get(_getPrototypeOf(ListItem.prototype),"_update",this).call(this),this._updateDescription()}},{key:"_updateTitle",value:function _updateTitle(){this._TextWrapper.patch({Title:{content:this.title,style:{textStyle:this.style.titleTextStyle}}})}},{key:"_updateDescription",value:function _updateDescription(){if(this._hasDescription){var o={content:this.description,style:{textStyle:this.style.descriptionTextStyle},visible:!this._collapse};this._Description||(o=_objectSpread({type:oA,signals:{textBoxChanged:"_onTextBoxChanged"}},o)),this._TextWrapper.patch({Description:o})}else this._TextWrapper.patch({Description:void 0})}},{key:"_updateTruncation",value:function _updateTruncation(){this._Title&&this._Title.patch({style:{textStyle:_objectSpread(_objectSpread({},this.style.titleTextStyle),{},{wordWrap:this.fixed,wordWrapWidth:this.fixed?this._fixedWordWrapWidth:0})}}),this._Description&&this._Description.patch({style:{textStyle:_objectSpread(_objectSpread({},this.style.descriptionTextStyle),{},{wordWrap:!0,wordWrapWidth:this._fixedWordWrapWidth})}})}},{key:"_updatePrefixLogo",value:function _updatePrefixLogo(){this._hasPrefixLogo&&(this._prefix=this._addLogoProps(this._prefixLogo))}},{key:"_updateSuffixLogo",value:function _updateSuffixLogo(){this._hasSuffixLogo&&(this._suffix=this._addLogoProps(this._suffixLogo))}},{key:"_addLogoProps",value:function _addLogoProps(o){return{type:BI,icon:o,style:_objectSpread({color:void 0},this.style.logoStyle)}}},{key:"_hasPrefixLogo",get:function get(){return this.prefixLogo}},{key:"_hasSuffixLogo",get:function get(){return this.suffixLogo}},{key:"_rowProps",get:function get(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(ListItem.prototype),"_rowProps",this)),{},{autoResizeHeight:!0})}},{key:"_buttonProps",get:function get(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(ListItem.prototype),"_buttonProps",this)),{},{alpha:this.style.alpha})}},{key:"_hasDescription",get:function get(){return!!this.description}},{key:"_suffixX",get:function get(){return this.w-this._paddingRight-this._suffixW-this.style.paddingX}},{key:"_collapse",get:function get(){return this.shouldCollapse&&!this._isFocusedMode}},{key:"announce",get:function get(){return this._announce?this._announce:this.title+this.description+", List Item"},set:function set(o){_set(_getPrototypeOf(ListItem.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"ListItem"}},{key:"__themeStyle",get:function get(){return cP}},{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(ListItem),"_template",this).call(this)),{},{justify:"left",fixed:!0,Content:_objectSpread(_objectSpread({},_get(_getPrototypeOf(ListItem),"_template",this).call(this).Content),{},{TextWrapper:{mountY:.5,flex:{direction:"column"},Title:{type:oA,signals:{textBoxChanged:"_onTextBoxChanged"}}}})})}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(ListItem),"properties",this)),["description","prefixLogo","suffixLogo","shouldCollapse"])}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(ListItem),"tags",this)),[{name:"Description",path:"Content.TextWrapper.Description"}])}}]),ListItem}(),hP=Object.freeze({__proto__:null,base:function base$c(){return{showArrows:!1,showKnob:!1}},mode:function mode$4(){return{focused:{showArrows:!0}}},tone:function tone$7(o){return{neutral:{mode:{focused:{arrowColor:o.color.fillInverse,progressBar:{barColor:o.color.fillInverseTertiary,progressColor:o.color.fillInverse}}}},inverse:{mode:{focused:{arrowColor:o.color.fillNeutral,progressBar:{barColor:o.color.fillNeutralTertiary,progressColor:o.color.fillNeutral}}}},brand:{mode:{focused:{arrowColor:o.color.fillInverse,progressBar:{barColor:o.color.fillBrandTertiary,progressColor:o.color.fillBrand}}}}}}}),pP=Object.freeze({__proto__:null,base:function base$b(o){var s=o.spacer.lg;return{arrowAlphaValue:o.alpha.primary,arrowAlphaValueLimit:o.alpha.secondary,arrowHeight:o.spacer.xxl,arrowSpacing:o.spacer.md,arrowWidth:o.spacer.xxl,arrowColor:o.color.fillNeutral,containerHeight:o.spacer.lg+o.spacer.xs,iconLeftSrc:o.asset.arrowLeft,iconRightSrc:o.asset.arrowRight,minWidth:getWidthByColumnSpan(o,2),progressBar:{},w:s,h:s,radius:s/2,showArrows:!0,showKnob:!0,circleAnimation:{}}},mode:function mode$3(){return{disabled:{arrowAlphaValue:0}}},tone:function tone$6(o){return{neutral:{arrowColor:o.color.fillNeutral,circleColor:o.color.interactiveNeutralFocus},inverse:{arrowColor:o.color.fillInverse,circleColor:o.color.interactiveInverseFocus},brand:{arrowColor:o.color.fillNeutral,circleColor:o.color.interactiveNeutralFocus}}}}),fP=function(o){_inherits(Slider,DI);var s=_createSuper(Slider);function Slider(){return _classCallCheck(this,Slider),s.apply(this,arguments)}return _createClass(Slider,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(Slider.prototype),"_construct",this).call(this),this._min=0,this._max=100,this._step=1,this._value=0,this._vertical=!1}},{key:"_update",value:function _update(){this._updateDirection(),this._updateSliderLayout(),this._updatePositions(),this._updateArrowAlpha(),this._updateArrows(),this.signal("onChange",this.value,this),this._valueChanged&&(this.fireAncestors("$announce",this.announce),this._valueChanged=!1)}},{key:"_handleLeft",value:function _handleLeft(){return!this._isDisabledMode&&(this._decrementValue(),"function"!=typeof this.onLeft||this.onLeft(this))}},{key:"_handleRight",value:function _handleRight(){return!this._isDisabledMode&&(this._incrementValue(),"function"!=typeof this.onRight||this.onRight(this))}},{key:"_updateDirection",value:function _updateDirection(){this.patch({pivotX:0,rotation:this.vertical?QE(90):0,mountY:this.vertical?.5:0})}},{key:"_updateSliderLayout",value:function _updateSliderLayout(){var o=this.w||this.style.minWidth;this._Container.patch({h:this.style.containerHeight,w:o,Bar:{x:this._calculatedSliderX,SliderBar:{y:this.style.containerHeight/2,w:this._calculatedSliderWidth,style:_objectSpread({duration:0},this.style.progressBar)}}}),this.h=Math.max(this.style.containerHeight,this.style.arrowHeight)}},{key:"_updatePositions",value:function _updatePositions(){this._updateSliderProgress(),this._updateCirclePosition()}},{key:"_updateSliderProgress",value:function _updateSliderProgress(){var o=this.value<this.min?this.min/this.max:this.value/this.max;this.value>this.max||this.value-this.step>this.max?o=this._calculatedSliderWidth:(this.min<0||this.max<0)&&(o=(this.value-this.min)/(this.max-this.min)),this._SliderBar.progress=o}},{key:"_updateCirclePosition",value:function _updateCirclePosition(){var o;o=this.value<this.min||this.value+this.step<this.min?this.min/this.max*this._calculatedSliderWidth:this.value>this.max||this.value-this.step>this.max?this._calculatedSliderWidth:this.min<0||this.max<0?(this.value-this.min)/(this.max-this.min)*this._calculatedSliderWidth:this.value/this.max*this._calculatedSliderWidth,this._Circle&&(this._Circle.patch({mode:this.mode,style:{radius:this.style.radius,w:this.style.w,h:this.style.h,circleColor:this.style.circleColor},y:this._SliderBar.y+1,alpha:this._isFocusedMode&&this.style.showKnob?1:0}),this.style.circleAnimation&&Object.keys(this.style.circleAnimation).length?this._Circle.smooth={x:[o,this.style.circleAnimation]}:this._Circle.x=o)}},{key:"_updateArrowAlpha",value:function _updateArrowAlpha(){var o,s,m=this.style.showArrows?this.style.arrowAlphaValue:.001,_=this.style.showArrows?this.style.arrowAlphaValueLimit:.001;o=s=m,!this._isDisabledMode&&this.value<=this.min?(o=_,s=m):!this._isDisabledMode&&this.value>=this.max&&(o=m,s=_),this._LeftArrow.smooth={alpha:o},this._RightArrow.smooth={alpha:s}}},{key:"_updateArrows",value:function _updateArrows(){var o={w:this.style.arrowWidth,h:this.style.arrowHeight,style:{color:this.style.arrowColor}};this._LeftArrow.patch(_objectSpread(_objectSpread({},o),{},{icon:this.style.iconLeftSrc})),this._RightArrow.patch(_objectSpread(_objectSpread({},o),{},{icon:this.style.iconRightSrc})),this._RightArrow.smooth={x:this.style.arrowSpacing+this._calculatedSliderWidth+this._Bar.x}}},{key:"_decrementValue",value:function _decrementValue(){var o=this.value-this.step;this.value=o>=this.min?o:this.min,this._updatePositions()}},{key:"_incrementValue",value:function _incrementValue(){var o=this.value+this.step;this.value=o<=this.max?o:this.max,this._updatePositions()}},{key:"_handleUp",value:function _handleUp(){return!1}},{key:"_handleDown",value:function _handleDown(){return!1}},{key:"_calculatedSliderX",get:function get(){return this.style.showArrows?this.style.arrowSpacing+this.style.arrowWidth:0}},{key:"_calculatedSliderWidth",get:function get(){var o=this.style.showArrows?2*this.style.arrowSpacing+2*this.style.arrowWidth:0;return this.w<o+this._circleW?this.style.minWidth-o:this.w-o}},{key:"_circleW",get:function get(){return this._Circle?this._Circle.w:0}},{key:"_setVertical",value:function _setVertical(o){return this._setState(o?"VerticalSlider":""),o}},{key:"_setValue",value:function _setValue(o){return this._valueChanged=o!==this._value,o}},{key:"announce",get:function get(){return void 0!==this._announce&&null!==this._announce?this._announce:this.value.toString()},set:function set(o){_set(_getPrototypeOf(Slider.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Slider"}},{key:"__themeStyle",get:function get(){return pP}},{key:"_template",value:function _template(){return{Container:{mountY:.5,y:function y(o){return o/2},Bar:{mountY:.5,SliderBar:{type:IA,progress:.5,mountY:.5,announce:""},Circle:{type:lP,zIndex:5}},LeftArrow:{type:BI,mountY:.5,y:function y(o){return o/2}},RightArrow:{type:BI,mountY:.5,y:function y(o){return o/2}}}}}},{key:"properties",get:function get(){return["max","min","step","value","vertical"]}},{key:"tags",get:function get(){return["Container",{name:"Bar",path:"Container.Bar"},{name:"SliderBar",path:"Container.Bar.SliderBar"},{name:"Circle",path:"Container.Bar.Circle"},{name:"LeftArrow",path:"Container.LeftArrow"},{name:"RightArrow",path:"Container.RightArrow"}]}},{key:"_states",value:function _states(){return[function(o){_inherits(VerticalSlider,o);var s=_createSuper(VerticalSlider);function VerticalSlider(){return _classCallCheck(this,VerticalSlider),s.apply(this,arguments)}return _createClass(VerticalSlider,[{key:"_handleLeft",value:function _handleLeft(){return!1}},{key:"_handleRight",value:function _handleRight(){return!1}},{key:"_handleUp",value:function _handleUp(){return!this._isDisabledMode&&(this._decrementValue(),"function"!=typeof this.onUp||this.onUp(this))}},{key:"_handleDown",value:function _handleDown(){return!this._isDisabledMode&&(this._incrementValue(),"function"!=typeof this.onDown||this.onDown(this))}}]),VerticalSlider}(this)]}}]),Slider}(),gP=function(o){_inherits(NestedSlider,fP);var s=_createSuper(NestedSlider);function NestedSlider(){return _classCallCheck(this,NestedSlider),s.apply(this,arguments)}return _createClass(NestedSlider,null,[{key:"__componentName",get:function get(){return"NestedSlider"}},{key:"__themeStyle",get:function get(){return hP}}]),NestedSlider}(),mP=Object.freeze({__proto__:null,base:function base$a(o){return{paddingY:o.spacer.md+o.spacer.xs,valueTextStyle:_objectSpread(_objectSpread({},o.typography.headline3),{},{maxLines:1,textColor:o.color.textNeutralSecondary})}},mode:function mode$2(o){return{disabled:{valueTextStyle:{textColor:o.color.textNeutralDisabled}},focused:{valueTextStyle:{textColor:o.color.textInverseSecondary}}}},tone:function tone$5(o){return{neutral:{mode:{focused:{valueTextStyle:{textColor:o.color.textInverseSecondary}}}},inverse:{mode:{focused:{valueTextStyle:{textColor:o.color.textNeutralSecondary}}}},brand:{mode:{focused:{valueTextStyle:{textColor:o.color.textInverseSecondary}}}}}}});!function(o){_inherits(ListItemSlider,dP);var s=_createSuper(ListItemSlider);function ListItemSlider(){return _classCallCheck(this,ListItemSlider),s.apply(this,arguments)}_createClass(ListItemSlider,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(ListItemSlider.prototype),"_construct",this).call(this),this.value=50}},{key:"_update",value:function _update(){_get(_getPrototypeOf(ListItemSlider.prototype),"_update",this).call(this),this._updateSliderPosition(),this._updateValue()}},{key:"_onTextBoxChanged",value:function _onTextBoxChanged(){_get(_getPrototypeOf(ListItemSlider.prototype),"_onTextBoxChanged",this).call(this),this._TextWrapper.h=Math.max(this._Title?this._Title.h:0,this._Value?this._Value.h:0)}},{key:"_updateValue",value:function _updateValue(){if(this._hasValue){var o={content:this.value.toString(),style:{textStyle:_objectSpread({},this.style.valueTextStyle)},mountX:1,x:this.w-this._paddingX};this._Value||(o=_objectSpread({type:oA,signals:{textBoxChanged:"_onTextBoxChanged"}},o)),this._TextWrapper.patch({Value:o})}else this._TextWrapper.patch({Value:void 0})}},{key:"_updateSliderPosition",value:function _updateSliderPosition(){var o=this.w-this._paddingLeft-this._paddingRight,s=_objectSpread(_objectSpread({mode:this.mode,tone:this.tone,w:o,x:o/2,visible:!this._collapse,alpha:this.style.alpha},this.slider),{},{value:this.value});this._Slider.patch(s)}},{key:"_hasValue",get:function get(){return null!=this.value||null!=this.value}},{key:"_fixedWordWrapWidth",get:function get(){return this.w-this._paddingLeft-this._paddingRight-this._paddingX}},{key:"_onSliderChanged",value:function _onSliderChanged(o,s){o>=s.max?this.value=s.max:o<=s.min?this.value=s.min:this.value=s.value}},{key:"_handleLeft",value:function _handleLeft(){return"function"==typeof this.onLeft?this.onLeft(this):!(!this._Slider||this._isDisabledMode)&&this._Slider._handleLeft()}},{key:"_handleRight",value:function _handleRight(){return"function"==typeof this.onRight?this.onRight(this):!(!this._Slider||this._isDisabledMode)&&this._Slider._handleRight()}},{key:"announce",get:function get(){return this._announce?this._announce:this.title+this.value+", List Item Slider"},set:function set(o){_set(_getPrototypeOf(ListItemSlider.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"ListItemSlider"}},{key:"__themeStyle",get:function get(){return mP}},{key:"_template",value:function _template(){var o=_get(_getPrototypeOf(ListItemSlider),"_template",this);return _objectSpread(_objectSpread({},o()),{},{Content:_objectSpread(_objectSpread({},o().Content),{},{flex:{direction:"column"},TextWrapper:_objectSpread(_objectSpread({},o().Content.TextWrapper),{},{mountY:0,flex:void 0}),Slider:{type:gP,mountX:.5,signals:{onChange:"_onSliderChanged"}}})})}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(ListItemSlider),"properties",this)),["slider","value"])}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(ListItemSlider),"tags",this)),[{name:"Slider",path:"Content.Slider"},{name:"Value",path:"Content.TextWrapper.Value"}])}}])}();var yP=Object.freeze({__proto__:null,base:function base$9(o){return{arrowAlphaValue:o.alpha.primary,arrowAlphaValueLimit:o.alpha.secondary,arrowWidth:o.spacer.xxl,arrowHeight:o.spacer.xxl,iconLeftSrc:o.asset.arrowLeft,iconRightSrc:o.asset.arrowRight}},tone:function tone$4(o){return{neutral:{mode:{focused:{arrowColor:o.color.fillInverse}}},inverse:{mode:{focused:{arrowColor:o.color.fillNeutral}}},brand:{mode:{focused:{arrowColor:o.color.fillInverse}}}}}});!function(o){_inherits(ListItemPicker,dP);var s=_createSuper(ListItemPicker);function ListItemPicker(){return _classCallCheck(this,ListItemPicker),s.apply(this,arguments)}_createClass(ListItemPicker,[{key:"_onTextBoxChanged",value:function _onTextBoxChanged(){_get(_getPrototypeOf(ListItemPicker.prototype),"_onTextBoxChanged",this).call(this),this._alignPicker()}},{key:"_construct",value:function _construct(){_get(_getPrototypeOf(ListItemPicker.prototype),"_construct",this).call(this),this._options=[],this._selectedIndex=0}},{key:"_update",value:function _update(){_get(_getPrototypeOf(ListItemPicker.prototype),"_update",this).call(this),this._updatePicker(),this._updateArrows(),this._updateArrowsAlpha(),this._updateAlignment()}},{key:"_updateAlignment",value:function _updateAlignment(){this._isFocusedMode?this.patch({justify:"center"}):this.patch({justify:"left"})}},{key:"_updateArrows",value:function _updateArrows(){if(!this._isFocusedMode)return this._LeftArrow&&(this._LeftArrow.alpha=.001),void(this._RightArrow&&(this._RightArrow.alpha=.001));var o={w:this.style.arrowWidth,h:this.style.arrowHeight,style:{color:this.style.arrowColor},alpha:this.style.arrowAlphaValue};this._LeftArrow||this.patch({LeftArrow:{type:BI,mountY:.5,y:function y(o){return o/2}}}),this._LeftArrow.patch(_objectSpread(_objectSpread({},o),{},{icon:this.style.iconLeftSrc})),this._LeftArrow.smooth={x:this.style.paddingX},this._RightArrow||this.patch({RightArrow:{type:BI,mountY:.5,mountX:1,y:function y(o){return o/2}}}),this._RightArrow.patch(_objectSpread(_objectSpread({},o),{},{icon:this.style.iconRightSrc})),this._RightArrow.smooth={x:this.w-this.style.paddingX}}},{key:"_updatePicker",value:function _updatePicker(){var o=this,s=this.w-this._paddingX-2*this.style.arrowWidth;this._Picker||this._TextWrapper.patch({Picker:{type:qI,clipping:!0,alwaysScroll:!0,signals:{selectedChange:"_updateArrowsAlpha"}}}),this._Picker.patch({visible:!this._collapse,h:this.style.descriptionTextStyle.lineHeight,w:s,items:this.options.map((function(m){return{type:iA,h:o.style.descriptionTextStyle.lineHeight,w:s,centerAlign:o._isFocusedMode,title:_objectSpread(_objectSpread({},o.style.descriptionTextStyle),{},{text:m})}})),selectedIndex:this.selectedIndex}),this._alignPicker()}},{key:"_alignPicker",value:function _alignPicker(){this._Picker.patch({mountX:this._isFocusedMode?.5:0,x:this._isFocusedMode?this._Title.w/2:0})}},{key:"_updateArrowsAlpha",value:function _updateArrowsAlpha(){this._Picker&&(this._selectedIndex=this._Picker.selectedIndex);var o=this._isFocusedMode?this.style.arrowAlphaValue:0;this._RightArrow&&(this._RightArrow.alpha=this.selectedIndex===this.options.length-1&&this._isFocusedMode?this.style.arrowAlphaValueLimit:o),this._LeftArrow&&(this._LeftArrow.alpha=0===this.selectedIndex&&this._isFocusedMode?this.style.arrowAlphaValueLimit:o),this.fireAncestors("$announce",this.announce)}},{key:"_fixedWordWrapWidth",get:function get(){var o=this.w-this._paddingX-2*this.style.arrowWidth-2*this.style.titlePadding,s=this.w-this._paddingLeft-this._paddingRight;return this._isFocusedMode?o:s}},{key:"_collapse",get:function get(){return this.shouldCollapse&&!this._isFocusedMode}},{key:"selectedOption",get:function get(){return this._Picker.selected}},{key:"_handleLeft",value:function _handleLeft(){return"function"==typeof this.onLeft?this.onLeft(this):(this._Picker.selectPrevious(),!0)}},{key:"_handleRight",value:function _handleRight(){return"function"==typeof this.onRight?this.onRight(this):(this._Picker.selectNext(),!0)}},{key:"announce",get:function get(){return this._announce?this._announce:this.title+this.options[this.selectedIndex]+", List Item"},set:function set(o){_set(_getPrototypeOf(ListItemPicker.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"ListItemPicker"}},{key:"__themeStyle",get:function get(){return yP}},{key:"properties",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(ListItemPicker),"properties",this)),["options","selectedIndex"])}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(ListItemPicker),"tags",this)),["LeftArrow","RightArrow",{name:"Picker",path:"Content.TextWrapper.Picker"}])}}])}(),function(o){_inherits(MetadataCard,CA);var s=_createSuper(MetadataCard);function MetadataCard(){return _classCallCheck(this,MetadataCard),s.apply(this,arguments)}_createClass(MetadataCard,null,[{key:"__componentName",get:function get(){return"MetadataCard"}}])}();var vP=function base$8(o){return{textStyle:o.typography.body2,fadeHeight:100,scroll:{timingFunction:"linear",duration:o.animation.duration.xfast},contentMarginTop:o.spacer.md,contentMarginLeft:o.spacer.xl,sliderMarginLeft:o.spacer.lg+o.spacer.xxs}},_P=Object.freeze({__proto__:null,base:vP}),bP=Object.freeze({__proto__:null,base:function base$7(o){var s=vP(o).scroll;return{progressBar:{animation:s},circleAnimation:s}}}),SP=function(o){_inherits(ScrollSlider,fP);var s=_createSuper(ScrollSlider);function ScrollSlider(){return _classCallCheck(this,ScrollSlider),s.apply(this,arguments)}return _createClass(ScrollSlider,null,[{key:"__componentName",get:function get(){return"ScrollSlider"}},{key:"__themeStyle",get:function get(){return bP}}]),ScrollSlider}();!function(o){_inherits(ScrollWrapper,DI);var s=_createSuper(ScrollWrapper);function ScrollWrapper(){return _classCallCheck(this,ScrollWrapper),s.apply(this,arguments)}_createClass(ScrollWrapper,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(ScrollWrapper.prototype),"_construct",this).call(this),this._scrollStep=10,this._shouldWrap=!1,this._flexDirection="column",this._fadeContent=!0,this._sliderWidth=0}},{key:"_afterTextBoxUpdate",value:function _afterTextBoxUpdate(o){this._prevW===o.finalW&&this._prevH===o.finalH||(this._prevW=o.finalW,this._prevH=o.finalH,this._updateScrollWrapperLayout(),this._updateAlpha())}},{key:"_resetFlexContainer",value:function _resetFlexContainer(){this._FadeContainer.patch({ScrollContainer:void 0}),this._FadeContainer.patch({ScrollContainer:{w:function w(o){return o},wordWrap:!0}})}},{key:"_update",value:function _update(){this._contentChanged&&(this._resetFlexContainer(),this._updateAutoScroll()),this._updateScrollContainer(),this._updateScrollWrapperLayout(),this._updateAlpha()}},{key:"_updateAutoScroll",value:function _updateAutoScroll(){this.resetScroll(),this._setupAutoScroll(),this._contentChanged=!1}},{key:"_updateScrollWrapperLayout",value:function _updateScrollWrapperLayout(){this._ScrollContainer.patch({w:this._contentWidth}),this._updateFadeContainer(),this._updateSlider()}},{key:"_updateAlpha",value:function _updateAlpha(){this._Slider.smooth={alpha:this.showScrollBar&&this._isFocusedMode?1:0}}},{key:"_updateFadeContainer",value:function _updateFadeContainer(){var o=this._ScrollContainer.finalH>this.h,s=this.fadeContent&&o&&!this._isEndContentVisible;this._FadeContainer.patch({h:this.h,w:this._contentWidth,y:this.style.contentMarginTop,x:this.style.contentMarginLeft,rtt:!0,shader:s?{type:E.shaders.FadeOut,bottom:this.style.fadeHeight}:void 0})}},{key:"_scrollContainerLoaded",value:function _scrollContainerLoaded(o){var s=o.h;this._ScrollContainer.h=s,this._updateScrollWrapperLayout()}},{key:"_updateScrollContainer",value:function _updateScrollContainer(){var o=this;if(this.content)if("string"==typeof this.content)this._ScrollContainer.patch({flex:{direction:"column"},ScrollableText:{h:0,w:this._contentWidth,type:oA,content:this.content,style:{textStyle:_objectSpread(_objectSpread({},this.style.textStyle),{},{wordWrap:!0,wordWrapWidth:this._contentWidth})},signals:{textBoxChanged:"_scrollContainerLoaded"},onAfterUpdate:this._afterTextBoxUpdate.bind(this)}});else if(Array.isArray(this.content)){var s={};this.content.forEach((function(m,_){var S="ScrollText".concat(_);s[S]=_objectSpread({w:o._contentWidth},m),m.text&&(s[S]={type:oA,content:m.text,style:{textStyle:_objectSpread(_objectSpread(_objectSpread({},o.style.textStyle),m.style),{},{wordWrap:!0,wordWrapWidth:o._contentWidth})},onAfterUpdate:o._afterTextBoxUpdate.bind(o)})})),this._ScrollContainer.patch(_objectSpread({flex:{direction:this.flexDirection,wrap:this.shouldWrap}},s))}}},{key:"_scrollDown",value:function _scrollDown(){if(this._scrollContainerY+this._ScrollContainer.finalH>this.renderHeight){var o=this._scrollContainerY-this.scrollStep,s=o+this._ScrollContainer.finalH>this.renderHeight,m=this.renderHeight-this._ScrollContainer.finalH-this.style.contentMarginTop;this._ScrollContainer.patch({smooth:{y:[s?o:m,this._scrollAnimation]}}),this._scrollContainerY+this._ScrollContainer.finalH<=this.h&&(this._isEndContentVisible=!0,this._autoScrollComplete=!0,this.fireAncestors("$scrollChanged","endDown",this),this._updateFadeContainer())}}},{key:"_scrollUp",value:function _scrollUp(){if(this._scrollContainerY<0){var o=this._scrollContainerY+this.scrollStep,s=o<0;this._ScrollContainer.patch({smooth:{y:[s?o:0,this._scrollAnimation]}}),this._scrollContainerY+this._ScrollContainer.finalH>this.renderHeight&&(this._autoScrollComplete=!1),this._scrollContainerY>=0&&this.fireAncestors("$scrollChanged","endUp",this),this._isEndContentVisible&&(this._isEndContentVisible=!1,this._updateFadeContainer())}}},{key:"resetScroll",value:function resetScroll(){this._ScrollContainer.y=0,this._Slider.value=0,this._ScrollContainer.transition("y").finish(),delete this._ScrollContainer._transitions,this._autoScrollComplete=!1}},{key:"_setAutoScroll",value:function _setAutoScroll(o){return this._autoScroll!==o&&(this._autoScroll=o),this._setupAutoScroll(),o}},{key:"_setupAutoScroll",value:function _setupAutoScroll(){var o=this;clearTimeout(this._startAutoScroll),clearTimeout(this._performAutoScrollTimer),this.autoScroll&&(this._startAutoScroll=setTimeout((function(){return o._performAutoScroll()}),isNaN(this.autoScrollDelay)?2e3:this.autoScrollDelay))}},{key:"_performAutoScroll",value:function _performAutoScroll(){var o=this;this.autoScroll&&!this._autoScrollComplete&&(this._Slider._handleDown(),this._performAutoScrollTimer=setTimeout((function(){return o._performAutoScroll()}),isNaN(this.autoScrollSpeed)?200:this.autoScrollSpeed))}},{key:"_setContent",value:function _setContent(o){return o!==this._content&&this.enabled&&(this._contentChanged=!0),o}},{key:"_updateScrollContainerSize",value:function _updateScrollContainerSize(o,s){this._sliderWidth!==s._Container.h&&(this._sliderWidth=s._Container.h,this._updateScrollContainer())}},{key:"_updateSlider",value:function _updateSlider(){var o=this._ScrollContainer.finalH-this.renderHeight,s=Math.ceil(o/this.scrollStep),m=this.renderHeight,_=m/s;this._Slider.patch({x:this.w-this._sliderWidth,w:m,min:0,max:m,step:_,onUp:this._scrollUp.bind(this),onDown:this._scrollDown.bind(this)})}},{key:"_contentWidth",get:function get(){return this.w-this.style.contentMarginLeft-this.style.sliderMarginLeft-this._sliderWidth}},{key:"_scrollContainerY",get:function get(){return this._ScrollContainer.transition("y").targetValue}},{key:"_scrollAnimation",get:function get(){var o=isNaN(this.scrollDuration)?this.style.scroll.duration:this.scrollDuration;return _objectSpread(_objectSpread({},this.style.scroll),{},{duration:o})}},{key:"_getFocused",value:function _getFocused(){return this._Slider}},{key:"announce",get:function get(){return this._announce?this._announce:Array.isArray(this.content)?this._ScrollContainer&&this._ScrollContainer.children&&this._ScrollContainer.children.length?this._ScrollContainer.children.map((function(o){return o.announce})):this.content.map((function(o){return o.announce||o.text})):this.content},set:function set(o){_set(_getPrototypeOf(ScrollWrapper.prototype),"announce",o,this,!0)}}],[{key:"__themeStyle",get:function get(){return _P}},{key:"_template",value:function _template(){return{clipping:!0,FadeContainer:{ScrollContainer:{w:function w(o){return o},wordWrap:!0}},Slider:{type:SP,vertical:!0,signals:{onChange:"_updateScrollContainerSize"},announce:" "}}}},{key:"__componentName",get:function get(){return"ScrollWrapper"}},{key:"properties",get:function get(){return["autoScroll","autoScrollDelay","autoScrollSpeed","content","fadeContent","scrollDuration","scrollStep","showScrollBar","shouldWrap","flexDirection"]}},{key:"tags",get:function get(){return["FadeContainer","Slider",{name:"ScrollContainer",path:"FadeContainer.ScrollContainer"},{name:"ScrollableText",path:"ScrollContainer.ScrollableText"}]}}])}();var TP=Object.freeze({__proto__:null,base:function base$6(o){return{alpha:o.alpha.none,animation:o.animation.standardEntrance,blur:o.spacer.xxl,color:o.color.shadowNeutralFocus,offsetX:0,offsetY:o.spacer.lg,radius:o.radius.md,spread:-1*o.spacer.md,maxOffsetY:o.spacer.xxl,maxOffsetX:0}},mode:function mode$1(o){return{focused:{alpha:o.alpha.secondary,offsetY:o.spacer.xxl}}},tone:function tone$3(o){return{neutral:{color:o.color.shadowNeutralFocus},inverse:{color:o.color.shadowInverseFocus},brand:{color:o.color.shadowBrandFocus}}}});!function(o){_inherits(Shadow,DI);var s=_createSuper(Shadow);function Shadow(){return _classCallCheck(this,Shadow),s.apply(this,arguments)}_createClass(Shadow,[{key:"_updateFocusStyle",value:function _updateFocusStyle(){this._Shadow&&this.applySmooth(this._Shadow,{alpha:this.style.alpha,y:this.style.offsetY,x:this.style.offsetX},{alpha:[this.style.alpha,this.style.animation],y:[this.style.offsetY,this.style.animation],x:[this.style.offsetX,this.style.animation]})}},{key:"_update",value:function _update(){var o=this.style.spread+2*this.style.blur,s=this.style.maxOffsetY,m=this.style.maxOffsetX;this.patch({Frame:{w:this.w+2*o+m,h:this.h+2*o+s,x:(this.w+m)/2,y:(this.h+s)/2,mount:.5,rtt:this.maskShadow,shader:this.maskShadow?{type:E.shaders.Hole,w:this.w-4,h:this.h-4,x:o+2,y:o+2,radius:this.style.radius}:void 0,Shadow:{color:this.style.color,texture:E.Tools.getShadowRect(this.w+2*this.style.spread,this.h+2*this.style.spread,this.style.radius,this.style.blur)}}}),void 0===this.shouldSmooth&&(this.shouldSmooth=!0),this._updateFocusStyle()}}],[{key:"__componentName",get:function get(){return"Shadow"}},{key:"__themeStyle",get:function get(){return TP}},{key:"properties",get:function get(){return["maskShadow"]}},{key:"tags",get:function get(){return["Frame",{name:"Shadow",path:"Frame.Shadow"}]}}])}();var kP=Object.freeze({__proto__:null,base:function base$5(o){var s=o.spacer.xxl;return{w:s,h:s,radius:s/2}}});!function(o){_inherits(SliderLarge,fP);var s=_createSuper(SliderLarge);function SliderLarge(){return _classCallCheck(this,SliderLarge),s.apply(this,arguments)}_createClass(SliderLarge,null,[{key:"__componentName",get:function get(){return"SliderLarge"}},{key:"__themeStyle",get:function get(){return kP}}])}();var CP=function(o){_inherits(ContentSwitcher,DI);var s=_createSuper(ContentSwitcher);function ContentSwitcher(){return _classCallCheck(this,ContentSwitcher),s.apply(this,arguments)}return _createClass(ContentSwitcher,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(ContentSwitcher.prototype),"_construct",this).call(this),this._selectedIndex=0,this._contentItems=[]}},{key:"_update",value:function _update(){_get(_getPrototypeOf(ContentSwitcher.prototype),"_update",this).call(this),this._updateSelected()}},{key:"_updateSelected",value:function _updateSelected(){var o=this;if(this._preveSelectedIndex!==this.selectedIndex){if(void 0!==this._preveSelectedIndex){var s=this.tag("Content".concat(this._preveSelectedIndex));s.smooth={alpha:0},this._hasContent?s._getTransition("alpha").once("finish",(function(){o._fadeInContent()})):void 0!==this.selectedIndex&&this._fadeInContent()}else this._hasContent&&this._fadeInContent();this._preveSelectedIndex=this.selectedIndex}}},{key:"_fadeInContent",value:function _fadeInContent(){var o=this;this._selectedContent.smooth={alpha:1},this._selectedContent._getTransition("alpha").once("finish",(function(){o.h=o._selectedContent.h,o.signal("contentHeightChange",o.h)}))}},{key:"_updateContent",value:function _updateContent(){var o=this,s=this.contentItems.reduce((function(s,m,_){var S,E="Content".concat(_);if("function"==typeof m){var A=m();A.then?o._loadAsyncComponent(A,_):S=A}else S=m;return S&&(s[E]=_objectSpread(_objectSpread({},S),{},{alpha:0})),s}),{});this.patch(s)}},{key:"_loadAsyncComponent",value:function _loadAsyncComponent(o,s){var m=this;o.then((function(o){var _="Content".concat(s);m.patch(_defineProperty({},_,_objectSpread(_objectSpread({},o),{},{alpha:0})))}))}},{key:"contentItems",get:function get(){return this._contentItems},set:function set(o){stringifyCompare(o,this._contentItems)||(this._contentItems=o,this._updateContent())}},{key:"_hasContent",get:function get(){return this._selectedContent&&this._selectedContent.children.length>0}},{key:"_selectedContent",get:function get(){return this.tag("Content".concat(this.selectedIndex))}},{key:"_getFocused",value:function _getFocused(){if(this._hasContent)return this._selectedContent}}],[{key:"__componentName",get:function get(){return"ContentSwitcher"}},{key:"properties",get:function get(){return["selectedIndex"]}}]),ContentSwitcher}(),wP=Object.freeze({__proto__:null,base:function base$4(o){return{tabSpacing:o.spacer.lg,tabsMarginBottom:o.spacer.xxl}}});!function(o){_inherits(TabBar,DI);var s=_createSuper(TabBar);function TabBar(){return _classCallCheck(this,TabBar),s.apply(this,arguments)}_createClass(TabBar,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(TabBar.prototype),"_construct",this).call(this),this._tabContent=[],this._isTabsFocused=!0}},{key:"_selectedTabChange",value:function _selectedTabChange(){return"object"===_typeof(this._tabContent)&&"function"==typeof this._tabContent.then?this._tabContent.then(this.queueRequestUpdate):this.queueRequestUpdate()}},{key:"_update",value:function _update(){this._updateTabsLayout(),this._updateTabs(),this._updateTabContent(),this._updateTabBarHeight()}},{key:"_updateTabsLayout",value:function _updateTabsLayout(){var o=this,s={style:{itemSpacing:this.style.tabSpacing}},m=qI.properties.reduce((function(s,m){return null!=o[m]&&(s[m]=o[m]),s}),s);this._Tabs.patch(m)}},{key:"_updateTabs",value:function _updateTabs(){var o=this;this._Tabs.wrapSelected=this.wrapSelected,this._Tabs.items.forEach((function(s){var m=s===o._Tabs.selected;o._isUnfocusedMode?s.mode="unfocused":o._isFocusedMode&&(o._isTabsFocused?s.mode=m?"focused":"unfocused":s.mode=m?"selected":"unfocused")})),this.alphaSelectedTab&&this._updateTabAlphas()}},{key:"_updateTabAlphas",value:function _updateTabAlphas(){var o=this;this._isTabsFocused?this._Tabs.items.forEach((function(o){o.patch({alpha:1})})):this._Tabs.items.forEach((function(s){s.patch({alpha:s===o._Tabs.selected?1:.3})}))}},{key:"_updateTabContent",value:function _updateTabContent(){var o=this.style.tabsMarginBottom;this._TabContent.patch({y:this._Tabs.h+o,contentItems:this._tabContent,selectedIndex:this._isFocusedMode?this._Tabs.selectedIndex:void 0})}},{key:"_updateTabBarHeight",value:function _updateTabBarHeight(){var o;o=this.collapse?this._isFocusedMode&&this._tabContent.filter((function(o){return Object.keys(o).length})).length?this._expandedHeight:this._collapsedHeight:this._expandedHeight,this._TabContent.smooth={alpha:!this.collapse||this._isFocusedMode?1:.001},this.h!==o&&(this.h=o,this.fireAncestors("$itemChanged"))}},{key:"selectTabs",value:function selectTabs(){this._isTabsFocused||(this._isTabsFocused=!0,this._updateTabs(),this._updateTabBarHeight())}},{key:"resetTabs",value:function resetTabs(){this._Tabs.selectedIndex=0}},{key:"_handleDown",value:function _handleDown(){this._isTabsFocused&&this._TabContent._hasContent&&(this._isTabsFocused=!1,this._updateTabs(),this._updateTabBarHeight())}},{key:"_handleUp",value:function _handleUp(){this.selectTabs()}},{key:"_setTabs",value:function _setTabs(o){return this._tabContent=[],this._tabContent=o.map((function(o){return o.tabContent||{}})),this._Tabs.items=o,o}},{key:"_collapsedHeight",get:function get(){return this._Tabs.h}},{key:"_expandedHeight",get:function get(){return this._Tabs.h+this.style.tabsMarginBottom+this._TabContent.h}},{key:"_getFocused",value:function _getFocused(){return this._isTabsFocused?this._Tabs:this._TabContent}},{key:"_unfocus",value:function _unfocus(){_get(_getPrototypeOf(TabBar.prototype),"_unfocus",this).call(this),this.reset&&this.resetTabs()}}],[{key:"_template",value:function _template(){return{Tabs:{type:qI,autoResizeHeight:!0,signals:{selectedChange:"_selectedTabChange"}},TabContent:{type:CP,signals:{contentHeightChange:"_updateTabBarHeight"}}}}},{key:"__themeStyle",get:function get(){return wP}},{key:"__componentName",get:function get(){return"TabBar"}},{key:"properties",get:function get(){return["alphaSelectedTab","collapse","reset","tabs","wrapSelected"].concat(_toConsumableArray(qI.properties))}},{key:"tags",get:function get(){return["Tabs","TabContent"]}}])}();var xP=Object.freeze({__proto__:null,base:function base$3(o){return{radius:o.radius.xl,paddingX:o.spacer.xxxl+o.spacer.xxs,paddingY:o.spacer.md+o.spacer.xs,noTitlePaddingX:o.spacer.xl,iconSize:o.spacer.xxxl,iconMarginRight:o.spacer.md,textStyle:_objectSpread(_objectSpread({},o.typography.headline3),{},{textColor:o.color.textNeutral}),backgroundColor:o.color.fillTransparent,contentColor:o.color.fillNeutral}},mode:function mode(o){return{focused:{backgroundColor:o.color.interactiveNeutralFocus,contentColor:o.color.fillInverse,textStyle:{textColor:o.color.textInverse}},selected:{backgroundColor:o.color.interactiveNeutralFocusSoft,contentColor:o.color.fillNeutral,textStyle:{textColor:o.color.textNeutral}},disabled:{backgroundColor:o.color.fillTransparent,contentColor:o.color.fillNeutralDisabled,textStyle:{textColor:o.color.textNeutralDisabled}}}},tone:function tone$2(o){return{neutral:{},inverse:{mode:{focused:{contentColor:o.color.fillNeutral,textStyle:{textColor:o.color.textNeutral}}}},brand:{mode:{focused:{contentColor:o.color.fillNeutral,textStyle:{textColor:o.color.textNeutral}}}}}}});!function(o){_inherits(Tab,YI);var s=_createSuper(Tab);function Tab(){return _classCallCheck(this,Tab),s.apply(this,arguments)}_createClass(Tab,[{key:"_onTextBoxChanged",value:function _onTextBoxChanged(){this._updateContent(),this._updateTabSize()}},{key:"_update",value:function _update(){_get(_getPrototypeOf(Tab.prototype),"_update",this).call(this),this._updateIcon(),this._updateText(),this._updateContent(),this._updateTabSize()}},{key:"_updateIcon",value:function _updateIcon(){if(this.icon){var o={icon:this.icon,w:this.style.iconSize,h:this.style.iconSize,y:this._Content.h/2,style:{color:this.style.contentColor}};this.title?(o.x=0,o.mountX=0):(o.x=this._Content.w/2,o.mountX=.5),this._Icon?this._Icon.patch(o):this._Content.patch({Icon:_objectSpread({type:BI,mountY:.5},o)})}else this._Content.patch({Icon:void 0})}},{key:"_updateText",value:function _updateText(){var o={content:this.title,style:{textStyle:this.style.textStyle},y:this._Content.h/2};this.icon?(o.x=this._iconW+this.style.iconMarginRight,o.mountX=0):(o.x=this._Content.w/2,o.mountX=.5),this._Text.patch(o)}},{key:"_updateContent",value:function _updateContent(){this._Content.patch({w:this._iconW+(this.title?this.style.iconMarginRight:0)+this._textW,h:Math.max(this._iconH,this._Text.h)})}},{key:"_updateTabSize",value:function _updateTabSize(){this.title||this.icon?this.patch({w:2*this._paddingX+this._Content.w,h:2*this.style.paddingY+this._Content.h}):this.patch({w:0,h:0})}},{key:"_textW",get:function get(){return this.title?this._Text.w:0}},{key:"_iconW",get:function get(){return this.icon?this._Icon.w:0}},{key:"_iconH",get:function get(){return this.icon?this._Icon.h:0}},{key:"_paddingX",get:function get(){return this.title?this.style.paddingX:this.style.noTitlePaddingX}},{key:"announce",get:function get(){return this._announce||this._Text&&this._Text.announce},set:function set(o){_set(_getPrototypeOf(Tab.prototype),"announce",o,this,!0)}}],[{key:"_template",value:function _template(){return _objectSpread(_objectSpread({},_get(_getPrototypeOf(Tab),"_template",this).call(this)),{},{Content:{mount:.5,x:function x(o){return o/2},y:function y(o){return o/2},Text:{type:oA,mountY:.5,signals:{textBoxChanged:"_onTextBoxChanged"}}}})}},{key:"__themeStyle",get:function get(){return xP}},{key:"__componentName",get:function get(){return"Tab"}},{key:"properties",get:function get(){return["icon","title"]}},{key:"tags",get:function get(){return[].concat(_toConsumableArray(_get(_getPrototypeOf(Tab),"tags",this)),["Content",{name:"Icon",path:"Content.Icon"},{name:"Text",path:"Content.Text"}])}}])}();var EP=Object.freeze({__proto__:null,base:function base$2(o){return{h:o.spacer.xxl,knobWidth:o.spacer.xl,knobHeight:o.spacer.xl,knobRadius:o.radius.sm+o.radius.xs,knobPadding:o.spacer.xxs,knobX:o.spacer.xs,knobXChecked:o.spacer.xxl+o.spacer.xs,strokeRadius:o.radius.md,strokeWeight:o.stroke.sm,w:2*o.spacer.xxl}},tone:function tone$1(o){return{neutral:{strokeColor:o.color.fillInverse,backgroundColor:o.color.fillNeutralDisabled,backgroundColorChecked:o.color.fillNeutral,knobColor:o.color.fillInverse,knobColorChecked:o.color.fillInverse,mode:{disabled:{strokeColor:o.color.fillInverseDisabled,backgroundColor:o.color.fillNeutralDisabled,backgroundColorChecked:o.color.fillNeutralDisabled,knobColor:o.color.fillInverseDisabled,knobColorChecked:o.color.fillInverseDisabled}}},inverse:{strokeColor:o.color.fillNeutral,backgroundColor:o.color.fillInverseDisabled,backgroundColorChecked:o.color.fillInverse,knobColor:o.color.fillNeutral,knobColorChecked:o.color.fillNeutral,mode:{disabled:{strokeColor:o.color.fillInverseDisabled,backgroundColor:o.color.fillNeutralDisabled,backgroundColorChecked:o.color.fillNeutralDisabled,knobColor:o.color.fillInverseDisabled,knobColorChecked:o.color.fillInverseDisabled}}},brand:{strokeColor:o.color.fillNeutral,backgroundColor:o.color.fillInverseDisabled,backgroundColorChecked:o.color.fillBrand,knobColor:o.color.fillNeutral,knobColorChecked:o.color.fillNeutral,mode:{disabled:{strokeColor:o.color.fillNeutralDisabled,backgroundColor:o.color.fillInverseDisabled,backgroundColorChecked:o.color.fillInverseDisabled,knobColor:o.color.fillNeutralDisabled,knobColorChecked:o.color.fillNeutralDisabled}}}}}}),IP=function(o){_inherits(Toggle,DI);var s=_createSuper(Toggle);function Toggle(){return _classCallCheck(this,Toggle),s.apply(this,arguments)}return _createClass(Toggle,[{key:"_construct",value:function _construct(){_get(_getPrototypeOf(Toggle.prototype),"_construct",this)&&_get(_getPrototypeOf(Toggle.prototype),"_construct",this).call(this),this._checked=!1}},{key:"_update",value:function _update(){this._updateKnobPosition(),this._updateColors(),this._updateContainer(),this._updateStroke(),this._updateKnob(),this._checkedChanged&&(this.fireAncestors("$announce",this.announce),this._checkedChanged=!1)}},{key:"_updateKnobPosition",value:function _updateKnobPosition(){var o=this.style,s=o.knobXChecked,m=o.knobX,_=o.knobPadding,S=o.knobWidth,E=o.strokeWeight;this._knobX=m||E+_,this._knobXChecked=s||this.w-E-_-S;var A=this.checked?this._knobXChecked:this._knobX;this.applySmooth(this._Knob,{x:A})}},{key:"_updateColors",value:function _updateColors(){var o=this.style,s=o.backgroundColor,m=o.backgroundColorChecked,_=o.knobColor,S=o.knobColorChecked,E=this.checked?S:_,A=this.checked?m:s;this.applySmooth(this._Knob,{color:E}),this.applySmooth(this._Container,{color:A})}},{key:"_updateContainer",value:function _updateContainer(){var o,s=this.style,m=s.knobRadius,_=s.knobPadding,S=s.strokeRadius,A=s.strokeWeight;o=void 0!==S?0===S?0:Math.max(0,S-A):Math.max(0,m+_+A),this._Container.patch({w:this.w,h:this.h,texture:E.Tools.getRoundRect(this.w-2*A,this.h-2*A,o,A,0,!0,!1)})}},{key:"_updateStroke",value:function _updateStroke(){var o=this.style,s=o.knobRadius,m=o.knobPadding,_=o.strokeColor,S=o.strokeRadius,A=o.strokeWeight;this._Stroke.patch({w:this.w,h:this.h,texture:E.Tools.getRoundRect(this.w,this.h,void 0!==S?S:s+m+A,A,_,!1,!1)})}},{key:"_updateKnob",value:function _updateKnob(){var o=this.style,s=o.knobHeight,m=o.knobWidth,_=o.knobRadius;this._Knob.patch({zIndex:2,y:(this.h-s)/2,texture:E.Tools.getRoundRect(m-2,s-2,_,0,0,!0,!1)})}},{key:"_setChecked",value:function _setChecked(o){return this._checkedChanged=o!==this._checked,o}},{key:"toggle",value:function toggle(){return this._isDisabledMode||(this.checked=!this.checked),this}},{key:"_handleEnter",value:function _handleEnter(){return"function"==typeof this.onEnter?this.onEnter(this):(this.toggle(),!1)}},{key:"announce",get:function get(){return this._announce||(this.checked?"Checked":"Unchecked")},set:function set(o){_set(_getPrototypeOf(Toggle.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Toggle"}},{key:"__themeStyle",get:function get(){return EP}},{key:"_template",value:function _template(){return{Container:{Stroke:{},Knob:{}}}}},{key:"tags",get:function get(){return["Container",{name:"Knob",path:"Container.Knob"},{name:"Stroke",path:"Container.Stroke"}]}},{key:"properties",get:function get(){return["checked"]}}]),Toggle}(),AP=Object.freeze({__proto__:null,base:function base$1(o){return{h:3*o.spacer.md,strokeRadius:.75*o.radius.md,strokeWeight:o.stroke.sm,knobWidth:o.spacer.lg,knobHeight:o.spacer.lg,knobRadius:o.radius.sm,knobPadding:o.spacer.xs,knobXChecked:o.spacer.xl+o.spacer.xs,w:6*o.spacer.md}}});!function(o){_inherits(ToggleSmall,IP);var s=_createSuper(ToggleSmall);function ToggleSmall(){return _classCallCheck(this,ToggleSmall),s.apply(this,arguments)}_createClass(ToggleSmall,null,[{key:"__componentName",get:function get(){return"ToggleSmall"}},{key:"__themeStyle",get:function get(){return AP}}])}(),function(o){_inherits(Circle,E.Texture);var s=_createSuper(Circle);function Circle(o){var m;return _classCallCheck(this,Circle),(m=s.call(this,o))._color="rgb(0,0,0)",m._fill=!0,m._radius=100,m._stroke=!1,m._strokeColor="rgb(0,0,0)",m._strokeWidth=1,m}_createClass(Circle,[{key:"fill",get:function get(){return this._fill},set:function set(o){this._fill=o,this._changed()}},{key:"radius",get:function get(){return this._radius},set:function set(o){this._radius=o,this._changed()}},{key:"color",get:function get(){return this._color},set:function set(o){this._color=o,this._changed()}},{key:"stroke",get:function get(){return this._stroke},set:function set(o){this._stroke=o,this._changed()}},{key:"strokeWidth",get:function get(){return this._strokeWidth},set:function set(o){this._strokeWidth=o,this._changed()}},{key:"strokeColor",get:function get(){return this._strokeColor},set:function set(o){this._strokeColor=o,this._changed()}},{key:"_getLookupId",value:function _getLookupId(){return"__circle_".concat(this._radius)}},{key:"_getSourceLoader",value:function _getSourceLoader(){var o=this._color,s=this._fill,m=this._radius,_=this._stroke,S=this._strokeColor,E=this._strokeWidth,A=this.stage.platform.getDrawingCanvas(),O=m;return _&&(O=m+2*E),A.width=2*O,A.height=2*O,function(H){var K=A.getContext("2d");K.lineWidth=E,K.strokeStyle=S,K.fillStyle=o,K.beginPath(),K.arc(O,O,m,0,2*Math.PI),s&&K.fill(),_&&K.stroke(),H(null,{source:A,radius:m})}}}])}(),function(o){_inherits(Arrow,E.Texture);var s=_createSuper(Arrow);function Arrow(o){var m;return _classCallCheck(this,Arrow),(m=s.call(this,o))._color="rgb(13, 13, 15)",m._w=0,m._h=0,m._direction="right",m}_createClass(Arrow,[{key:"w",get:function get(){return this._w},set:function set(o){this._w=o,this._changed()}},{key:"h",get:function get(){return this._h},set:function set(o){this._h=o,this._changed()}},{key:"direction",get:function get(){return this._direction},set:function set(o){this._direction=o,this._changed()}},{key:"color",get:function get(){return this._color},set:function set(o){this._color=o,this._changed()}},{key:"_getLookupId",value:function _getLookupId(){return"__triangle_".concat(this._direction,"_").concat(this._w,"x").concat(this._h)}},{key:"_getSourceLoader",value:function _getSourceLoader(){var o=this._color,s=this._w,m=this._h,_=this._direction,S=this.stage.platform.getDrawingCanvas();return function(E){var A=S.getContext("2d");S.width=s,S.height=m,A.fillStyle=o,A.strokeStyle=A.fillStyle,A.lineWidth=2,A.lineCap="round",A.lineJoin="round";var O=A.lineWidth/2;A.beginPath(),"right"===_?(A.moveTo(O,O),A.lineTo(O,m-O),A.lineTo(s-O,m/2)):"down"===_?(A.moveTo(O,O),A.lineTo(s-O,O),A.lineTo(s/2,m-O)):(A.moveTo(O,m/2),A.lineTo(s-O,O),A.lineTo(s-O,m-O)),A.closePath(),A.stroke(),A.fill(),E(null,{source:S,w:s,h:m,direction:_})}}}])}(),function(o){_inherits(Line,E.Texture);var s=_createSuper(Line);function Line(o){var m;return _classCallCheck(this,Line),(m=s.call(this,o))._w=0,m._h=0,m._rounded=!1,m}_createClass(Line,[{key:"w",get:function get(){return this._w},set:function set(o){this._w=o,this._changed()}},{key:"h",get:function get(){return this._h},set:function set(o){this._h=o,this._changed()}},{key:"rounded",get:function get(){return this._rounded},set:function set(o){this._rounded=o,this._changed()}},{key:"_getLookupId",value:function _getLookupId(){return"__line_".concat(this._w,"x").concat(this._h).concat(this._rounded?"_rounded":"")}},{key:"_getSourceLoader",value:function _getSourceLoader(){var o=this._w,s=this._h,m=this._rounded,_=this.stage.platform.getDrawingCanvas();return function(S){var E=_.getContext("2d");_.width=o,_.height=s,E.lineWidth=s,m&&(E.lineCap="round"),E.strokeStyle="white",E.beginPath(),E.moveTo(m?2:0,s/2),E.lineTo(m?o-2:o,s/2),E.stroke(),S(null,{source:_,w:o,h:s,rounded:m})}}}])}();var PP=function(o){_inherits(Bubble,E.Texture);var s=_createSuper(Bubble);function Bubble(o){var m;return _classCallCheck(this,Bubble),(m=s.call(this,o))._w=0,m._h=0,m._radius=0,m._pointerW=0,m._pointerH=0,m._strokeWidth=0,m._color="white",m}return _createClass(Bubble,[{key:"w",get:function get(){return this._w},set:function set(o){this._w=o,this._changed()}},{key:"h",get:function get(){return this._h},set:function set(o){this._h=o,this._changed()}},{key:"radius",get:function get(){return this._radius},set:function set(o){Array.isArray(o)?this._radius=new Array(4).fill().map((function(s,m){return o[m]||0})):this._radius=o,this._changed()}},{key:"pointerW",get:function get(){return this._pointerW},set:function set(o){this._pointerW=o,this._changed()}},{key:"pointerH",get:function get(){return this._pointerH},set:function set(o){this._pointerH=o,this._changed()}},{key:"strokeWidth",get:function get(){return this._strokeWidth},set:function set(o){this._strokeWidth=o,this._changed()}},{key:"color",get:function get(){return this._color},set:function set(o){this._color=E.StageUtils.getRgbaString(o),this._changed()}},{key:"createBubble",value:function createBubble(o){var s=o.stage,m=o.w,_=void 0===m?0:m,S=o.h,E=void 0===S?0:S,A=o.radius,O=void 0===A?0:A,H=o.pointerW,K=void 0===H?0:H,z=o.pointerH,G=void 0===z?0:z,q=o.strokeWidth,X=void 0===q?1:q,J=o.color,ae=void 0===J?"white":J,pe=s.platform.getDrawingCanvas(),me=pe.getContext("2d");pe.width=_+X+4,pe.height=E+X+4,me.imageSmoothingEnabled=!0,me.fillStyle=ae,me.strokeStyle=ae,me.lineWidth=X,me.lineCap="round",me.lineJoin="round";var _e=.5*X+1,Se=_e,Ee=Se+_,De=_e,$e=De+E,He=$e-G,et=Array.isArray(O);return me.beginPath(),me.moveTo(Se+(et?O[0]:O),De),me.lineTo(Ee-(et?O[0]:O),De),me.arcTo(Ee,De,Ee,De+(et?O[1]:O),et?O[1]:O),me.lineTo(Ee,He-(et?O[2]:O)),me.arcTo(Ee,He,Ee-(et?O[2]:O),He,et?O[2]:O),me.lineTo(_/2+K/2,He),me.arcTo(_/2,$e,_/2-K/2,He,2),me.lineTo(_/2-K/2,He),me.lineTo(Se+(et?O[3]:O),He),me.arcTo(Se,He,Se,He-(et?O[3]:O),et?O[3]:O),me.lineTo(Se,De+(et?O[0]:O)),me.arcTo(Se,De,Se+(et?O[0]:O),De,et?O[0]:O),me.stroke(),me.fill(),pe}},{key:"_getLookupId",value:function _getLookupId(){var o=this.w,s=this.h,m=this.radius,_=this.pointerW,S=this.pointerH,E=this.color;return"__bubble_".concat(o,"x").concat(s,"_radius-").concat(m,"_pointer-").concat(_,"x").concat(S,"_fill-").concat(E)}},{key:"_getSourceLoader",value:function _getSourceLoader(){var o=this;return function(s){s(null,{source:o.createBubble(o)})}}}]),Bubble}(),LP=Object.freeze({__proto__:null,base:function base(o){return{marginBottom:o.spacer.xxxl,paddingX:o.spacer.lg,paddingY:o.spacer.md,pointerW:o.spacer.xl,pointerH:o.spacer.md+o.spacer.xs,radius:o.radius.md,textStyle:_objectSpread(_objectSpread({},o.typography.caption1),{},{textColor:o.color.textInverse}),transition:o.animation.utility}},tone:function tone(o){return{neutral:{backgroundColor:o.color.fillNeutral,textStyle:{textColor:o.color.textInverse}},inverse:{backgroundColor:o.color.fillInverse,textStyle:{textColor:o.color.textNeutral}},brand:{backgroundColor:o.color.fillBrand,textStyle:{textColor:o.color.textNeutral}}}}});!function(o){_inherits(Tooltip,DI);var s=_createSuper(Tooltip);function Tooltip(){return _classCallCheck(this,Tooltip),s.apply(this,arguments)}_createClass(Tooltip,[{key:"_update",value:function _update(){this._updateText()}},{key:"_updateText",value:function _updateText(){this._Text&&this._Text.patch({content:this.title,style:{textStyle:this.style.textStyle}})}},{key:"_textLoaded",value:function _textLoaded(){this._updateBackground(),this._updateTextPosition()}},{key:"_updateBackground",value:function _updateBackground(){var o=this._Text.finalH+2*this.style.paddingY+this.style.pointerH,s=this._Text.finalW+2*this.style.paddingX;this.patch({w:s,h:o,mountY:1,y:-this.style.marginBottom,Background:{w:s,h:o,texture:{type:PP,w:s,h:o,radius:this.style.radius,pointerW:this.style.pointerW,pointerH:this.style.pointerH,color:this.style.backgroundColor}}})}},{key:"_updateTextPosition",value:function _updateTextPosition(){this._Text&&this._Text.patch({mount:.5,x:this._Background.w/2,y:(this._Background.h-this.style.pointerH)/2})}},{key:"_clearTimers",value:function _clearTimers(){clearTimeout(this._hideTimer),clearTimeout(this._showTimer)}},{key:"_transitionIn",value:function _transitionIn(){var o=this,s={smooth:{alpha:[1,this.style.transition],scale:[1,this.style.transition]}};this.delayVisible?this._showTimer=setTimeout((function(){o.patch({smooth:s})}),this.delayVisible):(this._showTimer=void 0,this.patch({smooth:s})),this._hideTimer=this.timeVisible?setTimeout((function(){o._unfocus()}),this.timeVisible+(this.delayVisible||0)):void 0}},{key:"_transitionOut",value:function _transitionOut(){this.patch({smooth:{alpha:[0,this.style.transition],scale:[.5,this.style.transition]}})}},{key:"_focus",value:function _focus(){this._clearTimers(),this._transitionIn()}},{key:"_unfocus",value:function _unfocus(){this._clearTimers(),this._transitionOut()}},{key:"announce",get:function get(){return this._announce||this._Text&&this._Text.announce},set:function set(o){_set(_getPrototypeOf(Tooltip.prototype),"announce",o,this,!0)}}],[{key:"__componentName",get:function get(){return"Tooltip"}},{key:"__themeStyle",get:function get(){return LP}},{key:"_template",value:function _template(){return{alpha:0,scale:.5,mountX:.5,x:function x(o){return o/2},Background:{Text:{type:oA,signals:{textBoxChanged:"_textLoaded"}}}}}},{key:"properties",get:function get(){return["title","delayVisible","timeVisible"]}},{key:"tags",get:function get(){return["Background",{name:"Text",path:"Background.Text"}]}}])}();var DP=function(o){_inherits$1(Row,o);var s=_createSuper$1(Row);function Row(){var o;return _classCallCheck$1(this,Row),(o=s.apply(this,arguments)).infinite=!1,o.fastScrollDelay=0,o.infiniteScrollingFirstIndex=0,o.infiniteScrollingLastIndex=0,o.itemsData=[],o.scrollTimer=0,o}return _createClass$1(Row,[{key:"selectPrevious",value:function selectPrevious(){return!!this.shouldThrottleScroll()||(this.infinite?this.items.length>0&&(this.prependItems([this.itemsData[this.getPreviousIndex()]]),this.Items.childList.removeAt(this.Items.childList.length-1),this.shouldSmooth=!0,this.requestUpdate(),this._refocus(),!0):_get$1(_getPrototypeOf$1(Row.prototype),"selectPrevious",this).call(this))}},{key:"selectNext",value:function selectNext(){return!!this.shouldThrottleScroll()||(this.infinite?this.items.length>0&&(this.appendItems([this.itemsData[this.getNextIndex()]]),this.Items.childList.removeAt(0),this.shouldSmooth=!0,this.requestUpdate(),this._refocus(),!0):_get$1(_getPrototypeOf$1(Row.prototype),"selectNext",this).call(this))}},{key:"_handleLeft",value:function _handleLeft(){return this.selectPrevious()}},{key:"_handleRight",value:function _handleRight(){return this.selectNext()}},{key:"appendItems",value:function appendItems(o){var s,m=this;(this.infinite||(this.shouldSmooth=!1),this._lazyItems)?(s=this._lazyItems).push.apply(s,_toConsumableArray$1(o)):(this.lazyUpCount&&this.lazyUpCountBuffer&&o.length>this.lazyUpCount+this.lazyUpCountBuffer&&(this._lazyItems=o.splice(this.lazyUpCount+this.lazyUpCountBuffer)),o.forEach((function(o){return m._appendItem(o)})),this.infinite||(this.queueRequestUpdate(),this._refocus()))}},{key:"appendItemsAt",value:function appendItemsAt(o,s){var m=this;if(this._lazyItems&&s>this.items.length-1){var _,S=s-this.items.length;(_=this._lazyItems).splice.apply(_,[S,0].concat(_toConsumableArray$1(o)))}else{var E=this._directionPropNames,A=E.crossDimension,O=E.lengthDimension,H=E.innerLengthDimension,K=Number.isInteger(s)?s:this.Items.children.length;this.infinite||(this.shouldSmooth=!1),this._lastAppendedIdx=K,this._totalAddedLength=0,o.forEach((function(o,s){var _=Object.assign(Object.assign({},m._withAfterUpdate(o)),{parentFocus:m.hasFocus()});o[A]||(_[A]=o[A]||m.Items[A]),m.Items.childList.addAt(_,K+s);var S=o[O]||o[H]||0,E=o.extraItemSpacing||0;m._totalAddedLength+=S+m.style.itemSpacing+E})),this.selectedIndex>=this._lastAppendedIdx&&(this.infinite?this._selectedIndex+=o.length-1:(this._selectedPastAdded=!0,this._selectedIndex+=o.length)),this.infinite||(this.requestUpdate(),this._refocus())}}},{key:"_appendItem",value:function _appendItem(o){this.infinite||(this.shouldSmooth=!1),o.parentFocus=this.hasFocus(),o=this.Items.childList.a(o);var s=this._directionPropNames.crossDimension;if(!o[s]||this.infinite){var m=this._isRow?this.renderHeight:this.renderWidth;o[s]=o[s]||m,this.infinite&&(o.x=this.renderWidth)}o=this._withAfterUpdate(o)}},{key:"shouldThrottleScroll",value:function shouldThrottleScroll(){if(this.fastScrollDelay>0){if(Date.now()<this.scrollTimer)return!0;this.scrollTimer=Date.now()+this.fastScrollDelay}return!1}},{key:"getNextIndex",value:function getNextIndex(){return this.infiniteScrollingFirstIndex=this.validateNextIndex(this.infiniteScrollingFirstIndex,this.itemsData),this.infiniteScrollingLastIndex=this.validateNextIndex(this.infiniteScrollingLastIndex,this.itemsData),this.infiniteScrollingLastIndex}},{key:"getPreviousIndex",value:function getPreviousIndex(){return this.infiniteScrollingLastIndex=this.validatePreviousIndex(this.infiniteScrollingLastIndex,this.itemsData),this.infiniteScrollingFirstIndex=this.validatePreviousIndex(this.infiniteScrollingFirstIndex,this.itemsData),this.infiniteScrollingFirstIndex}},{key:"validateNextIndex",value:function validateNextIndex(o,s){return o+1===s.length?0:o+1}},{key:"validatePreviousIndex",value:function validatePreviousIndex(o,s){return o-1<0?s.length-1:o-1}}]),Row}(qI),RP=function(o){_inherits$1(Column,o);var s=_createSuper$1(Column);function Column(){var o;return _classCallCheck$1(this,Column),(o=s.apply(this,arguments)).infinite=!1,o.fastScrollDelay=0,o.defaultSelectedIndex=-1,o.infiniteScrollingFirstIndex=0,o.infiniteScrollingLastIndex=0,o.itemsData=[],o.scrollTimer=0,o}return _createClass$1(Column,[{key:"selectPrevious",value:function selectPrevious(){return!!this.shouldThrottleScroll()||(this.infinite?this.items.length>0&&(this.prependItems([this.itemsData[this.getPreviousIndex()]]),this.Items.childList.removeAt(this.Items.childList.length-1),this.shouldSmooth=!0,this.requestUpdate(),this._refocus(),!0):_get$1(_getPrototypeOf$1(Column.prototype),"selectPrevious",this).call(this))}},{key:"selectNext",value:function selectNext(){return!!this.shouldThrottleScroll()||(this.infinite?this.items.length>0&&(this.appendItems([this.itemsData[this.getNextIndex()]]),this.Items.childList.removeAt(0),this.shouldSmooth=!0,this.requestUpdate(),this._refocus(),!0):_get$1(_getPrototypeOf$1(Column.prototype),"selectNext",this).call(this))}},{key:"_focus",value:function _focus(){this.defaultSelectedIndex>-1&&(this.selectedIndex=this.defaultSelectedIndex)}},{key:"_handleUp",value:function _handleUp(){return this.selectPrevious()}},{key:"_handleDown",value:function _handleDown(){return this.selectNext()}},{key:"appendItems",value:function appendItems(o){var s,m=this;(this.infinite||(this.shouldSmooth=!1),this._lazyItems)?(s=this._lazyItems).push.apply(s,_toConsumableArray$1(o)):(this.lazyUpCount&&this.lazyUpCountBuffer&&o.length>this.lazyUpCount+this.lazyUpCountBuffer&&(this._lazyItems=o.splice(this.lazyUpCount+this.lazyUpCountBuffer)),o.forEach((function(o){return m._appendItem(o)})),this.infinite||(this.queueRequestUpdate(),this._refocus()))}},{key:"appendItemsAt",value:function appendItemsAt(o,s){var m=this;if(this._lazyItems&&s>this.items.length-1){var _,S=s-this.items.length;(_=this._lazyItems).splice.apply(_,[S,0].concat(_toConsumableArray$1(o)))}else{var E=this._directionPropNames,A=E.crossDimension,O=E.lengthDimension,H=E.innerLengthDimension,K=Number.isInteger(s)?s:this.Items.children.length;this.infinite||(this.shouldSmooth=!1),this._lastAppendedIdx=K,this._totalAddedLength=0,o.forEach((function(o,s){var _=Object.assign(Object.assign({},m._withAfterUpdate(o)),{parentFocus:m.hasFocus()});o[A]||(_[A]=o[A]||m.Items[A]),m.Items.childList.addAt(_,K+s);var S=o[O]||o[H]||0,E=o.extraItemSpacing||0;m._totalAddedLength+=S+m.style.itemSpacing+E})),this.selectedIndex>=this._lastAppendedIdx&&(this.infinite?this._selectedIndex+=o.length-1:(this._selectedPastAdded=!0,this._selectedIndex+=o.length)),this.infinite||(this.requestUpdate(),this._refocus())}}},{key:"_appendItem",value:function _appendItem(o){this.infinite||(this.shouldSmooth=!1),o.parentFocus=this.hasFocus(),o=this.Items.childList.a(o);var s=this._directionPropNames.crossDimension;if(!o[s]||this.infinite){var m=this._isRow?this.renderHeight:this.renderWidth;o[s]=o[s]||m,this.infinite&&(o.y=this.renderHeight)}o=this._withAfterUpdate(o)}},{key:"shouldThrottleScroll",value:function shouldThrottleScroll(){if(this.fastScrollDelay>0){if(Date.now()<this.scrollTimer)return!0;this.scrollTimer=Date.now()+this.fastScrollDelay}return!1}},{key:"getNextIndex",value:function getNextIndex(){return this.infiniteScrollingFirstIndex=this.validateNextIndex(this.infiniteScrollingFirstIndex,this.itemsData),this.infiniteScrollingLastIndex=this.validateNextIndex(this.infiniteScrollingLastIndex,this.itemsData),this.infiniteScrollingLastIndex}},{key:"getPreviousIndex",value:function getPreviousIndex(){return this.infiniteScrollingLastIndex=this.validatePreviousIndex(this.infiniteScrollingLastIndex,this.itemsData),this.infiniteScrollingFirstIndex=this.validatePreviousIndex(this.infiniteScrollingFirstIndex,this.itemsData),this.infiniteScrollingFirstIndex}},{key:"validateNextIndex",value:function validateNextIndex(o,s){return o+1===s.length?0:o+1}},{key:"validatePreviousIndex",value:function validatePreviousIndex(o,s){return o-1<0?s.length-1:o-1}}]),Column}(KA),OP=function(o){_inherits$1(Carousel,o);var s=_createSuper$1(Carousel);function Carousel(){var o;return _classCallCheck$1(this,Carousel),(o=s.apply(this,arguments)).maxAmountOfItems=0,o.carouselWrapSelected=!1,o.carouselLazyScroll=!1,o.carouselLazyUpCount=void 0,o.carouselLazyUpCountBuffer=2,o.carouselStartLazyScrollIndex=0,o.carouselStopLazyScrollIndex=0,o.carouselPlinko=!1,o.itemsData=[],o.prevIconStyle={w:0,h:0,src:""},o.nextIconStyle={w:0,h:0,src:""},o.enableCarouselArrows=!1,o.useShadowsforArrows=!1,o.carouselStyles={itemSpacing:20,alwaysScroll:!1},o.leftGradientElement={},o.rightGradientElement={},o.carouselIsInfinite=!1,o.carouselFastScrollDelay=0,o.carouselInfiniteFill=!1,o.carouselInfinityItemsOffset=2,o.maxWidth=1920,o.maxHeight=1080,o}return _createClass$1(Carousel,[{key:"_getFocused",value:function _getFocused(){return this.carousel}},{key:"_init",value:function _init(){this.setupCarousel()}},{key:"_captureUp",value:function _captureUp(){return"column"===this.direction&&this.goingPrev(),!1}},{key:"_captureLeft",value:function _captureLeft(){return"row"===this.direction&&this.goingPrev(),!1}},{key:"_captureDown",value:function _captureDown(){return"column"===this.direction&&this.goingNext(),!1}},{key:"_captureRight",value:function _captureRight(){return"row"===this.direction&&this.goingNext(),!1}},{key:"setupCarousel",value:function setupCarousel(){this.patch({Carousel:Object.assign(Object.assign(Object.assign(Object.assign({},!this.carousel&&{type:"column"===this.direction?RP:"row"===this.direction?DP:null}),{style:this.carouselStyles,wrapSelected:this.wrapSelected,lazyScroll:this.lazyScroll,lazyUpCount:this.lazyUpCount,infinite:this.infinite,fastScrollDelay:this.fastScrollDelay}),"row"===this.direction&&{startLazyScrollIndex:this.startLazyScrollIndex,stopLazyScrollIndex:this.stopLazyScrollIndex,lazyUpCountBuffer:this.lazyUpCountBuffer}),{plinko:this.plinko})})}},{key:"setupItems",value:function setupItems(){var o=this;if(this.carousel){this.carousel.itemsData=this.itemsData;var s=[];if(this.itemsData.length>this.maxAmount&&this.maxAmount>0){var m=(s=this.itemsData.slice(0,this.maxAmount+1)).length-1;Object.defineProperty(s[m],"showMore",{value:!0})}else s=_toConsumableArray$1(this.itemsData);0===this.maxAmount&&this.infinite&&(this.infiniteFill||this.shouldMakeCarouselInfinite(s))?(this.carousel.infinite=!0,s=this.generateInfiniteCarouselItems(s),this.carousel.items=s,this.carousel.selectedIndex=this.infinityItemsOffset,this.carousel._update()):(this.carousel.infinite=!1,this.carousel.items=s);var _=this.itemsData.reduce((function(s,m){var _,S=null!==(_=m[o.crossDimension])&&void 0!==_?_:0;return Math.max(s,S)}),0),S=s.reduce((function(s,m){var _;return s+(null!==(_=m[o.lengthDimension])&&void 0!==_?_:0)}),0)+(s.length-1)*this.itemSpacing;"row"===this.direction?(this.h=_,this.infinite&&(this.w=S)):"column"===this.direction&&(this.w=_,this.infinite&&(this.h=S)),this.carouselWidth=this.w,this.carouselHeight=this.h,this.onRenderedItems()}}},{key:"onRenderedItems",value:function onRenderedItems(){this.tag("Arrows").patch(Object.assign(Object.assign({alpha:this.enableCarouselArrows?1:0},this.prevIconStyle.src&&{Prev:Object.assign(Object.assign(Object.assign({},"column"===this.direction&&{x:this.carouselWidth/2,y:.02*this.carouselHeight,mountX:.5}),"row"===this.direction&&{x:.02*this.carouselWidth,y:this.carouselHeight/2,mountY:.5}),this.useShadow&&{Shadow:{x:-1*this.prevIconStyle.w,y:-1*this.prevIconStyle.h,alpha:1,zIndex:-1,color:OE,texture:E.Tools.getShadowRect(this.prevIconStyle.w,this.prevIconStyle.h,this.prevIconStyle.w/2,this.prevIconStyle.w/2)}})}),this.nextIconStyle.src&&{Next:Object.assign(Object.assign(Object.assign({},"column"===this.direction&&{x:this.carouselWidth/2,y:this.carouselHeight-.02*this.carouselHeight,mountX:.5,mountY:1}),"row"===this.direction&&{x:this.carouselWidth-.02*this.carouselWidth,y:this.carouselHeight/2,mountX:1,mountY:.5}),this.useShadow&&{Shadow:{x:-1*this.nextIconStyle.w,y:-1*this.nextIconStyle.h,alpha:1,zIndex:-1,color:OE,texture:E.Tools.getShadowRect(this.nextIconStyle.w,this.nextIconStyle.h,this.nextIconStyle.w/2,this.nextIconStyle.w/2)}})})),this.carousel&&this.carousel.items.length&&0===this.carousel.selectedIndex&&(this.prev.alpha=0)}},{key:"onShowPrevArrow",value:function onShowPrevArrow(){this.prev.alpha=1}},{key:"onShowNextArrow",value:function onShowNextArrow(){this.next.alpha=1}},{key:"onHidePrevArrow",value:function onHidePrevArrow(){this.prev.alpha=0}},{key:"onHideNextArrow",value:function onHideNextArrow(){this.next.alpha=0}},{key:"isOnFirstPosition",value:function isOnFirstPosition(o){var s=this.carousel.selectedIndex-1==0,m=this.carousel.selectedIndex+1===this.carousel.items.length&&!0===this.wrapSelected,_=0===this.carousel.selectedIndex&&!this.wrapSelected;return"goingNext"===o?m:s||_}},{key:"isOnLastPosition",value:function isOnLastPosition(o){var s=this.carousel.selectedIndex+1===this.carousel.items.length-1,m=this.carousel.selectedIndex-1==-1&&!0===this.wrapSelected,_=this.carousel.selectedIndex===this.carousel.items.length-1&&!this.wrapSelected;return"goingNext"===o?s||_:m}},{key:"goingPrev",value:function goingPrev(){this.carousel&&this.carousel.items&&(this.prevIconStyle.src&&(this.isOnFirstPosition("goingPrev")?this.onHidePrevArrow():this.onShowPrevArrow()),this.nextIconStyle.src&&(this.isOnLastPosition("goingPrev")?this.onHideNextArrow():this.onShowNextArrow()))}},{key:"goingNext",value:function goingNext(){this.carousel&&this.carousel.items&&(this.nextIconStyle.src&&(this.isOnLastPosition("goingNext")?this.onHideNextArrow():this.onShowNextArrow()),this.prevIconStyle.src&&(this.isOnFirstPosition("goingNext")?this.onHidePrevArrow():this.onShowPrevArrow()))}},{key:"appendItems",value:function appendItems(o){this.carousel.appendItems(o)}},{key:"appendItemsAt",value:function appendItemsAt(o,s){this.carousel.appendItemsAt(o,s)}},{key:"removeItemAt",value:function removeItemAt(o){this.carousel.removeItemAt(o)}},{key:"updateGradientElements",value:function updateGradientElements(o){this.tag("GradientLeft").patch(Object.assign({alpha:o},this.leftGradientElement)),this.tag("GradientRight").patch(Object.assign({alpha:o},this.rightGradientElement))}},{key:"shouldMakeCarouselInfinite",value:function shouldMakeCarouselInfinite(o){var s=this;return o.reduce((function(o,m){return o+m[s.lengthDimension]}),0)+(o.length-1)*this.itemSpacing>this.maxLength}},{key:"generateInfiniteCarouselItems",value:function generateInfiniteCarouselItems(o){for(var s=[],m=o.length-1,_=0,S=0,E=0,A=0,O=0;_<this.maxLength;){O=S-E*o.length,s.push(o[O]),++S-E*o.length===o.length&&E++;var H=o[O],K=H&&H[this.lengthDimension];if(K&&(_+=K+this.itemSpacing),S===m&&0===_)break}for(var z=0;z<this.infinityItemsOffset;z++)O=S-E*o.length,s.push(o[O]),++S-E*o.length===o.length&&E++;S=0,E=0;for(var G=0;G<this.infinityItemsOffset;G++)A=m-S-E*o.length*-1,s.unshift(o[A]),m-++S-E*o.length*-1<0&&E++;return this.carousel.infiniteScrollingFirstIndex=A,this.carousel.infiniteScrollingLastIndex=O,s}},{key:"items",get:function get(){return this.carousel.items},set:function set(o){this.itemsData=o,this.carousel&&this.setupItems()}},{key:"totalItems",get:function get(){return this.carousel.items.length}},{key:"selectedIndex",get:function get(){return this.carousel.selectedIndex},set:function set(o){this.carousel.selectedIndex=o}},{key:"selected",get:function get(){return this.carousel.selected}},{key:"lazyScroll",get:function get(){return this.carouselLazyScroll},set:function set(o){this.carouselLazyScroll=o}},{key:"startLazyScrollIndex",get:function get(){return this.carouselStartLazyScrollIndex},set:function set(o){this.carouselStartLazyScrollIndex=o}},{key:"stopLazyScrollIndex",get:function get(){return this.carouselStopLazyScrollIndex},set:function set(o){this.carouselStopLazyScrollIndex=o}},{key:"lazyUpCount",get:function get(){return this.carouselLazyUpCount},set:function set(o){this.carouselLazyUpCount=o}},{key:"lazyUpCountBuffer",get:function get(){return this.carouselLazyUpCountBuffer},set:function set(o){this.carouselLazyUpCountBuffer=o}},{key:"maxAmount",get:function get(){return this.maxAmountOfItems},set:function set(o){this.maxAmountOfItems=o}},{key:"itemSpacing",get:function get(){return this.carouselStyles.itemSpacing?this.carouselStyles.itemSpacing:0},set:function set(o){this.carouselStyles.itemSpacing=o}},{key:"alwaysScroll",get:function get(){return!!this.carouselStyles.alwaysScroll&&this.carouselStyles.alwaysScroll},set:function set(o){this.carouselStyles.alwaysScroll=o}},{key:"neverScroll",get:function get(){return!!this.carouselStyles.neverScroll&&this.carouselStyles.neverScroll},set:function set(o){this.carouselStyles.neverScroll=o}},{key:"scrollIndex",get:function get(){return this.carouselStyles.scrollIndex?this.carouselStyles.scrollIndex:0},set:function set(o){this.carouselStyles.scrollIndex=o}},{key:"itemTransition",set:function set(o){this.carouselStyles.itemTransition=o}},{key:"style",get:function get(){return this.carouselStyles},set:function set(o){this.carouselStyles=o}},{key:"wrapSelected",get:function get(){return this.carouselWrapSelected},set:function set(o){this.carouselWrapSelected=o}},{key:"direction",get:function get(){return this.carouselDirection},set:function set(o){this.carouselDirection=o}},{key:"prevArrow",set:function set(o){var s=o.src,m=o.w,_=o.h;this.prevIconStyle.w=m,this.prevIconStyle.h=_,this.prevIconStyle.src=s,this.enableCarouselArrows=!0,this.prev.patch(Object.assign({},renderImage(s,m,_)))}},{key:"nextArrow",set:function set(o){var s=o.src,m=o.w,_=o.h;this.nextIconStyle.w=m,this.nextIconStyle.h=_,this.nextIconStyle.src=s,this.enableCarouselArrows=!0,this.next.patch(Object.assign({},renderImage(s,m,_)))}},{key:"enableArrows",get:function get(){return this.enableCarouselArrows},set:function set(o){this.enableCarouselArrows=o,this.tag("Arrows").patch({alpha:o?1:0})}},{key:"useShadow",get:function get(){return this.useShadowsforArrows},set:function set(o){this.useShadowsforArrows=o}},{key:"infinite",get:function get(){return this.carouselIsInfinite},set:function set(o){this.carouselIsInfinite=o}},{key:"infiniteFill",get:function get(){return this.carouselInfiniteFill},set:function set(o){this.carouselInfiniteFill=o}},{key:"infinityItemsOffset",get:function get(){return this.carouselInfinityItemsOffset},set:function set(o){this.carouselInfinityItemsOffset=o}},{key:"fastScrollDelay",get:function get(){return this.carouselFastScrollDelay},set:function set(o){this.carouselFastScrollDelay=o}},{key:"plinko",get:function get(){return this.carouselPlinko},set:function set(o){this.carouselPlinko=o}},{key:"prev",get:function get(){return this.tag("Arrows.Prev")}},{key:"next",get:function get(){return this.tag("Arrows.Next")}},{key:"carouselWidth",get:function get(){return this.carousel.w},set:function set(o){this.carousel.w=o}},{key:"carouselHeight",get:function get(){return this.carousel.h},set:function set(o){this.carousel.h=o}},{key:"lengthDimension",get:function get(){return"column"===this.direction?"h":"w"}},{key:"crossDimension",get:function get(){return"column"===this.direction?"w":"h"}},{key:"maxLength",get:function get(){return"column"===this.direction?this.maxHeight:this.maxWidth}},{key:"carousel",get:function get(){return this.tag("Carousel")}},{key:"gradientVisible",set:function set(o){this.updateGradientElements(o)}},{key:"gradientRight",set:function set(o){this.rightGradientElement=o}},{key:"gradientLeft",set:function set(o){this.leftGradientElement=o}}],[{key:"_template",value:function _template(){return{GradientLeft:{rect:!0,zIndex:1,alpha:0},Arrows:{zIndex:2,Prev:{},Next:{}},GradientRight:{rect:!0,zIndex:1,alpha:0}}}}]),Carousel}(E.Component),MP=function(o){_inherits$1(Modal,o);var s=_createSuper$1(Modal);function Modal(){var o;return _classCallCheck$1(this,Modal),(o=s.apply(this,arguments)).defaultWidth=800,o.defaultHeight=600,o.modalTitle={text:""},o.modalBodyText={text:""},o.defaultBackground={color:NE},o.defaultBoxBackground={color:FE},o.defaultBoxBackgroundImage="",o.defaultBoxColor=FE,o.buttonsAlign="center",o.buttonLeftProps={},o.buttonRightProps={},o.buttonsItemSpacing=50,o.defaultMargin=75,o.modalRadius=10,o.titleXMargin=75,o.titleYMargin=75,o.bodyXMargin=75,o.bodyYMargin=75,o.buttonXMargin=0,o.buttonYMargin=0,o.buttonsDirection="row",o._whenEnabled=new Promise((function(s){return o._enable=s})).catch(console.error),o}return _createClass$1(Modal,[{key:"_getFocused",value:function _getFocused(){return this.modalButtons}},{key:"_enable",value:function _enable(){}},{key:"_handleEnter",value:function _handleEnter(){}},{key:"_unfocus",value:function _unfocus(){this.modalButtons.items.length>0&&(this.modalButtons.selectedIndex=0)}},{key:"renderModal",value:function renderModal(){var o=this;this._whenEnabled.then((function(){o.setBoxBackground(),o.patch({Background:Object.assign({},o.defaultBackground),Box:Object.assign(Object.assign({},o.defaultBoxBackground),{w:o.defaultWidth,h:o.defaultHeight,Title:{x:o.titleXMargin,y:o.titleYMargin,w:function w(s){return s-2*o.titleXMargin},h:function h(o){return o},text:o.modalTitle},Body:{x:o.bodyXMargin,y:o.bodyYMargin,w:function w(s){return s-2*o.bodyXMargin},h:function h(o){return o},text:o.modalBodyText},Buttons:{x:function x(s){return o.getButtonsX(s)},y:function y(s){return o.getButtonsY(s)},mountX:o.getButtonsMountX(),type:"column"===o.buttonsDirection?RP:DP,neverScroll:!0,shader:null,style:{itemSpacing:o.buttonsItemSpacing}},shader:{radius:o.modalRadius}})}),o.renderButtons(),o.modalButtons.w=o.getButtonsWidth(),o.modalButtons.h=o.getButtonsHeight()}))}},{key:"renderButtons",value:function renderButtons(){var o=this,s=[];JSON.stringify(this.buttonLeftProps)!==JSON.stringify({})&&s.push(Object.assign(Object.assign({},this.buttonLeftProps),{type:zE,onEnter:function onEnter(){if("function"==typeof o.onLButtonPressedEvent)return o.onLButtonPressedEvent()}})),JSON.stringify(this.buttonRightProps)!==JSON.stringify({})&&s.push(Object.assign(Object.assign({},this.buttonRightProps),{type:zE,onEnter:function onEnter(){if("function"==typeof o.onRButtonPressedEvent)return o.onRButtonPressedEvent()}})),this.modalButtons.items=s,s.length>0?this._setState("ButtonsFocused"):this._setState("DefaultButtonFocused")}},{key:"areButtonsCentered",value:function areButtonsCentered(){return"center"===this.buttonsAlign}},{key:"areButtonsOntheLeft",value:function areButtonsOntheLeft(){return"left"===this.buttonsAlign}},{key:"getButtonsX",value:function getButtonsX(o){return this.areButtonsCentered()?Math.ceil(o/2+this.buttonXMargin):this.areButtonsOntheLeft()?this.defaultMargin+this.buttonXMargin:o-this.defaultMargin}},{key:"getButtonsY",value:function getButtonsY(o){return this.buttonYMargin>0?this.buttonYMargin:o-this.defaultMargin-50}},{key:"getButtonsWidth",value:function getButtonsWidth(){var o=this;return this.modalButtons.items.reduce((function(s,m,_){var S=0;return _<o.modalButtons.items.length-1&&(S+=o.buttonsItemSpacing),"number"==typeof m.w&&(S+=m.w),s+S}),0)}},{key:"getButtonsHeight",value:function getButtonsHeight(){var o=this;return this.modalButtons.items.reduce((function(s,m,_){var S=0;return _<o.modalButtons.items.length-1&&(S+=o.buttonsItemSpacing),"number"==typeof m.h&&(S+=m.h),s+S}),0)}},{key:"getButtonsMountX",value:function getButtonsMountX(){return this.areButtonsCentered()?.5:this.areButtonsOntheLeft()?0:1}},{key:"setBoxBackground",value:function setBoxBackground(){this.defaultBoxBackgroundImage&&!this.defaultBoxColor?this.defaultBoxBackground={src:this.defaultBoxBackgroundImage}:this.defaultBoxColor&&!this.defaultBoxBackgroundImage?this.defaultBoxBackground={color:this.defaultBoxColor}:this.defaultBoxBackground={src:this.defaultBoxBackgroundImage,color:this.defaultBoxColor}}},{key:"resetButtons",value:function resetButtons(){this.modalButtons.items=[],this.buttonLeftProps={},this.buttonRightProps={}}},{key:"box",set:function set(o){var s,m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se;this.defaultWidth=o.w,this.defaultHeight=o.h,this.defaultMargin=o.margin,this.titleXMargin=null!==(s=o.titleXMargin)&&void 0!==s?s:this.defaultMargin,this.titleYMargin=null!==(m=o.titleYMargin)&&void 0!==m?m:this.defaultMargin,this.bodyXMargin=null!==(_=o.bodyXMargin)&&void 0!==_?_:this.defaultMargin,this.bodyYMargin=null!==(S=o.bodyYMargin)&&void 0!==S?S:this.defaultMargin+50,this.defaultBoxColor=o.color,this.boxBackgroundImage=o.src||this.defaultBoxBackgroundImage,this.defaultBackground="number"==typeof o.background?{color:o.background}:o.background,this.modalTitle="string"==typeof o.title?{text:o.title}:o.title,this.modalBodyText="string"==typeof o.body?{text:o.body}:o.body,this.buttonLeftProps=null!==(A=null===(E=o.buttons)||void 0===E?void 0:E.left)&&void 0!==A?A:this.buttonLeftProps,this.buttonRightProps=null!==(H=null===(O=o.buttons)||void 0===O?void 0:O.right)&&void 0!==H?H:this.buttonRightProps,this.buttonsAlign=null!==(z=null===(K=o.buttons)||void 0===K?void 0:K.align)&&void 0!==z?z:this.buttonsAlign,this.buttonsItemSpacing=null!==(q=null===(G=o.buttons)||void 0===G?void 0:G.spacing)&&void 0!==q?q:this.buttonsItemSpacing,this.modalRadius=null!==(X=o.radius)&&void 0!==X?X:this.modalRadius,this.buttonXMargin=null!==(ae=null===(J=o.buttons)||void 0===J?void 0:J.x)&&void 0!==ae?ae:this.buttonXMargin,this.buttonYMargin=null!==(me=null===(pe=o.buttons)||void 0===pe?void 0:pe.y)&&void 0!==me?me:this.buttonYMargin,this.buttonsDirection=null!==(Se=null===(_e=o.buttons)||void 0===_e?void 0:_e.direction)&&void 0!==Se?Se:this.buttonsDirection,this.renderModal()}},{key:"title",set:function set(o){this.modalTitle={text:o},this.tag("Box.Title").patch({text:this.modalTitle})}},{key:"body",set:function set(o){this.modalBodyText={text:o},this.tag("Box.Body").patch({text:this.modalBodyText})}},{key:"leftButtonProps",set:function set(o){this.buttonLeftProps=Object.assign(Object.assign({},this.buttonLeftProps),o),this.modalButtons&&this.renderButtons()}},{key:"onLButtonPressed",set:function set(o){this.onLButtonPressedEvent=o}},{key:"rightButtonProps",set:function set(o){this.buttonRightProps=Object.assign(Object.assign({},this.buttonRightProps),o),this.modalButtons&&this.renderButtons()}},{key:"onRButtonPressed",set:function set(o){this.onRButtonPressedEvent=o}},{key:"boxBackgroundImage",set:function set(o){this.defaultBoxBackgroundImage=o}},{key:"modalButtons",get:function get(){return this.tag("Box.Buttons")}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,Background:{w:function w(o){return o},h:function h(o){return o},rect:!0},Box:{x:function x(o){return o/2},y:function y(o){return o/2},mount:.5,rect:!0,Title:{shader:null},Body:{shader:null},shader:{type:E.shaders.RoundedRectangle,radius:10}}}}}]),Modal}(E.Component);E.Component;var FP=function(o){_inherits$1(SplashScreen,o);var s=_createSuper$1(SplashScreen);function SplashScreen(){var o;return _classCallCheck$1(this,SplashScreen),(o=s.apply(this,arguments)).defaultBackground={color:OE},o.logoProps={src:"",w:0,h:0},o.spinnerProps={w:100,h:100,shader:{radius:50,stroke:20,color:RE,showDot:!0,period:1}},o}return _createClass$1(SplashScreen,[{key:"_firstEnable",value:function _firstEnable(){this.patch({Background:Object.assign({},this.defaultBackground)})}},{key:"background",set:function set(o){this.defaultBackground="number"==typeof o?{color:o}:"string"==typeof o?{src:o}:this.defaultBackground=o,this.patch({Background:Object.assign({},this.defaultBackground)})}},{key:"logo",set:function set(o){var s,m,_,S="object"==typeof o?renderImage(null!==(s=o.src)&&void 0!==s?s:"",null!==(m=o.w)&&void 0!==m?m:0,null!==(_=o.h)&&void 0!==_?_:0):null;this.logoProps=S||("string"==typeof o?{src:o}:o),this.patch({Logo:Object.assign({},this.logoProps)})}},{key:"spinner",set:function set(o){var s,m;this.spinnerProps.w=null!==(s=null==o?void 0:o.w)&&void 0!==s?s:this.spinnerProps.w,this.spinnerProps.h=null!==(m=null==o?void 0:o.h)&&void 0!==m?m:this.spinnerProps.h,this.spinnerProps.shader=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.spinnerProps.shader),(null==o?void 0:o.radius)&&{radius:o.radius}),(null==o?void 0:o.stroke)&&{stroke:o.stroke}),(null==o?void 0:o.color)&&{color:o.color}),(null==o?void 0:o.showDot)&&{showDot:o.showDot}),(null==o?void 0:o.period)&&{period:o.period}),this.patch({LoadingIndicator:Object.assign({x:o.x?o.x:function(o){return o/2},y:o.y?o.y:function(o){return o/1.2}},this.spinnerProps)})}}],[{key:"_template",value:function _template(){return{w:function w(o){return o},h:function h(o){return o},Background:{w:function w(o){return o},h:function h(o){return o},rect:!0},Logo:{x:function x(o){return o/2},y:function y(o){return o/3},mount:.5},LoadingIndicator:{x:function x(o){return o/2},y:function y(o){return o/1.2},rect:!0,mount:.5,shader:{type:E.shaders.Spinner2,backgroundColor:OE}}}}}]),SplashScreen}(E.Component),NP=function(o){_inherits$1(SkeletonLoader,o);var s=_createSuper$1(SkeletonLoader);function SkeletonLoader(){return _classCallCheck$1(this,SkeletonLoader),s.apply(this,arguments)}return _createClass$1(SkeletonLoader,[{key:"radius",set:function set(o){this.patch({shader:{radius:o}})}}],[{key:"_template",value:function _template(){return{w:function w(o){return o},h:function h(o){return o},rect:!0,color:SkeletonLoader._color,shader:{type:E.shaders.RoundedRectangle,radius:SkeletonLoader._radius}}}}]),SkeletonLoader}(E.Component);NP._color=4292467161,NP._radius=6;var UP=function(o){_inherits$1(InputField,o);var s=_createSuper$1(InputField);function InputField(){var o;return _classCallCheck$1(this,InputField),(o=s.apply(this,arguments)).maxLength=0,o.maxLengthSuffix=0,o.inputFieldValue="",o.cursorPosition=0,o}return _createClass$1(InputField,[{key:"_init",value:function _init(){this.blinkAnimation=this.inputCursor.animation({duration:1,repeat:-1,actions:[{p:"alpha",v:{0:1,.5:0,1:1}}]})}},{key:"_active",value:function _active(){this.blinkAnimation&&this.blinkAnimation.start()}},{key:"_inactive",value:function _inactive(){this.blinkAnimation&&this.blinkAnimation.stop()}},{key:"_focus",value:function _focus(){this.patch({Cursor:{smooth:{w:3}}})}},{key:"_unfocus",value:function _unfocus(){this.patch({Cursor:{smooth:{w:4}}})}},{key:"_handleLeft",value:function _handleLeft(){var o=this.cursorPosition;if(o>0){var s=this.calculatePositionByIndex(this.inputFieldValue,o-1);this.inputCursor.setSmooth("x",s),--this.cursorPosition}}},{key:"_handleRight",value:function _handleRight(){var o=this.cursorPosition;if(o<this.inputFieldValue.length){var s=this.calculatePositionByIndex(this.inputFieldValue,o+1);this.inputCursor.setSmooth("x",s),++this.cursorPosition}}},{key:"calculatePositionByIndex",value:function calculatePositionByIndex(o,s){var m=o.substring(0,s),_=this.tag("HiddenValue");return _.text&&(_.text.text=m),_.loadTexture(),this.tag("HiddenValue").renderWidth}},{key:"applyMask",value:function applyMask(o){return this.inputFieldMask?this.inputFieldMask(o):o}},{key:"truncateText",value:function truncateText(o){var s=o;return this.maxLengthSuffix>0&&s.length>this.maxLengthSuffix&&(s=s.substring(0,this.maxLengthSuffix)+"..."),s}},{key:"changeValue",value:function changeValue(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",_=this.inputFieldValue;if(o.length>this.maxLength)return _;var S=this.cursorPosition,E=this.tag("Field"),A=o;if(A=this.applyMask(A),A=this.truncateText(A),E.patch({text:A}),E.loadTexture(),0===o.length)this.cursorPosition=0,this.inputCursor.setSmooth("x",0),this.placeholderProps&&E.patch({text:this.placeholderProps});else if(this.textStyleProps&&E.patch({text:this.textStyleProps}),S<_.length){var O=s?S-1:S+m.length,H=this.calculatePositionByIndex(o,O);this.inputCursor.setSmooth("x",H),this.cursorPosition=O}else this.inputCursor.setSmooth("x",E.renderWidth+4),this.cursorPosition=o.length;return this.inputFieldValue=o,this.signal("onValueChanged",o),o}},{key:"insert",value:function insert(o){var s=this.inputFieldValue,m=this.cursorPosition;if(m<s.length){var _=s.substring(0,m),S=s.substring(m,s.length);s="".concat(_).concat(o).concat(S)}else s+="".concat(o);return this.changeValue(s)}},{key:"delete",value:function _delete(){var o=this.inputFieldValue,s=this.cursorPosition;if(s<o.length){var m=o.substring(0,s-1),_=o.substring(s,o.length);return o="".concat(m).concat(_),this.changeValue(o,!0)}return this.changeValue(o.substring(0,o.length-1))}},{key:"clear",value:function clear(){this.changeValue("",!0)}},{key:"addDotCom",value:function addDotCom(){this.insert(".com")}},{key:"inputCursor",get:function get(){return this.tag("Cursor")}},{key:"value",get:function get(){return this.inputFieldValue}},{key:"mask",set:function set(o){this.inputFieldMask=o,this.changeValue(this.inputFieldValue)}},{key:"resetValue",set:function set(o){this.changeValue(o,!0)}},{key:"textStyle",set:function set(o){this.textStyleProps=o,this.changeValue(this.inputFieldValue)}},{key:"placeholder",set:function set(o){this.placeholderProps=o,this.changeValue(this.inputFieldValue)}},{key:"inputCursorProps",set:function set(o){this.cursorProps=o,this.inputCursor.patch(this.cursorProps)}},{key:"inputFieldTextPosition",set:function set(o){this.tag("Field").patch({y:o})}}],[{key:"_template",value:function _template(){return{Field:{text:{text:"",textColor:$E,fontSize:44,fontFace:"Regular"}},Cursor:{rect:!0,color:VE,h:40,w:2,y:7},HiddenValue:{alpha:1e-5,text:{text:"",textColor:$E}}}}}]),InputField}(E.Component),BP=_createClass$1((function Masks(){_classCallCheck$1(this,Masks)}));BP.Password=function(o){return new Array(o.length).fill("●").join("")},BP.Number=function(o){return"".concat(parseInt(o))},BP.CreditCard=function(o){return o.replace(/(\d{4})(?=\d)/gi,"$1-")};var jP=_createClass$1((function Layouts(){_classCallCheck$1(this,Layouts)}));jP.searchLowerCase={label:"abc",characters:"abcdefghijklmnopqrstuvwxyz1234567890".split("")},jP.searchUpperCase={label:"ABC",characters:"ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".split("")},jP.emailLowerCase={label:"abc",characters:"1234567890qwertyuiopasdfghjkl@zxcvbnm,.-".split("")},jP.emailUpperCase={label:"ABC",characters:"1234567890QWERTYUIOPASDFGHJKL@ZXCVBNM,.-".split("")},jP.lowercaseDiacritics={label:"àèü",characters:"äëïöüÿàèìòùáéíóúýâêîôûãñ".split("")},jP.uppercaseAccents={label:"ÀÈÜ",characters:"ÄËÏÖÜŸÀÈÌÒÙÁÉÍÓÚÝÂÊÎÔÛÃÑ".split("")},jP.uppercaseAlphaNumeric={label:"ABC123",characters:"1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")},jP.lowercaseAlphaNumeric={label:"abc123",characters:"1234567890abcdefghijklmnopqrstuvwxyz".split("")},jP.numbers={label:"123",characters:"1234567890".split("")},jP.special={label:"!?#&",characters:"1234567890!@#$%^&*(){}[];\"'|\\/<>?±-_`~".split("")};var $P=function(o){_inherits$1(Key,o);var s=_createSuper$1(Key);function Key(){var o;return _classCallCheck$1(this,Key),(o=s.apply(this,arguments)).backgroundOpacity=.5,o}return _createClass$1(Key,[{key:"_init",value:function _init(){this.focused=!1}},{key:"_focus",value:function _focus(){this.focused=!0}},{key:"_unfocus",value:function _unfocus(){this.focused=!1}},{key:"focused",set:function set(o){this.patch({Background:{smooth:{alpha:o?1:this.backgroundOpacity}},Label:{smooth:{color:o?ME:RE}}})}},{key:"focusedOpacity",set:function set(o){this.backgroundOpacity=o}},{key:"label",get:function get(){return this.labelComponent.text?this.labelComponent.text.text:""},set:function set(o){this.labelComponent.text&&(this.labelComponent.text.text=o)}},{key:"labelTextStyles",set:function set(o){this.labelComponent.patch({text:o})}},{key:"backgroundColor",set:function set(o){this.tag("Background").patch({color:o})}},{key:"labelComponent",get:function get(){return this.tag("Label")}}],[{key:"_template",value:function _template(){return{Background:{w:function w(o){return o},h:function h(o){return o},rect:!0},Label:{x:function x(o){return o/2},y:function y(o){return o/2},mount:.5,zIndex:1,text:{fontSize:32,fontFace:"Regular"}}}}}]),Key}(E.Component),VP=function(o){_inherits$1(FunctionKey,o);var s=_createSuper$1(FunctionKey);function FunctionKey(){var o;return _classCallCheck$1(this,FunctionKey),(o=s.apply(this,arguments)).useTexture=!1,o.mainSRC="",o.alternateSRC="",o.specialKeyLabel="!?#$%",o}return _createClass$1(FunctionKey,[{key:"keyLabel",get:function get(){return this.label}},{key:"data",set:function set(o){var s,m;if(this.label="Special"===o.label?this.specialKeyLabel:o.label,o.src){this.useTexture=null!==(s=o.useTexture)&&void 0!==s&&s;var _=this.useTexture?{texture:o.src}:{src:o.src};this.patch({Label:{visible:!1},Icon:Object.assign(Object.assign(Object.assign({},_),{visible:!0}),o.rotation&&{rotation:o.rotation})})}o.alternateSRC&&(this.mainSRC=null!==(m=o.src)&&void 0!==m?m:"",this.alternateSRC=o.alternateSRC)}},{key:"rotationValue",set:function set(o){this.patch({Icon:{rotation:o}})}},{key:"focused",set:function set(o){var s=RE,m=ME;this.patch({Background:{smooth:{alpha:o?1:this.backgroundOpacity}},Label:{smooth:{color:o?m:s}},Icon:this.useTexture?{shader:{type:E.shaders.Inversion,amount:o?10:0}}:{smooth:{color:o?m:s}}})}}],[{key:"_template",value:function _template(){return Object.assign(Object.assign({},_get$1(_getPrototypeOf$1(FunctionKey),"_template",this).call(this)),{Icon:{x:function x(o){return o/2},y:function y(o){return o/2},zIndex:1,mount:.5,visible:!1}})}}]),FunctionKey}($P),HP=function(o){_inherits$1(KeyGroup,o);var s=_createSuper$1(KeyGroup);function KeyGroup(){var o;return _classCallCheck$1(this,KeyGroup),(o=s.apply(this,arguments))._index=0,o.keyWidth=90,o.keyHeight=90,o.keySpacingX=0,o.keySpacingY=0,o.keyRadius=6,o.keyBackgroundColor=BE,o}return _createClass$1(KeyGroup,[{key:"_getFocused",value:function _getFocused(){return this.activeKey}},{key:"setIndex",value:function setIndex(o){return!(o<0||o>this.keys.length-1)&&(this._index=function clamp$1(o,s,m){return Math.max(s,Math.min(o,m))}(o,0,this.keys.length-1),this.signal("indexChanged",this._index),!0)}},{key:"keys",get:function get(){return this.children}},{key:"activeKey",get:function get(){return this.keys[this.index]}},{key:"getActiveKey",value:function getActiveKey(){return this.keys[this.index]}},{key:"index",get:function get(){return this._index},set:function set(o){this.setIndex(o)}},{key:"_handleLeft",value:function _handleLeft(){return this.setIndex(this.index-1)}},{key:"_handleRight",value:function _handleRight(){return this.setIndex(this.index+1)}},{key:"_handleEnter",value:function _handleEnter(){this.signal("keyPressed",this.activeKey)}}]),KeyGroup}(E.Component),KP=function(o){_inherits$1(CharacterKeyGroup,o);var s=_createSuper$1(CharacterKeyGroup);function CharacterKeyGroup(){var o;return _classCallCheck$1(this,CharacterKeyGroup),(o=s.apply(this,arguments)).columnCount=10,o.backgroundOpacity=.5,o.labelTextStyles={fontSize:32,fontFace:"Regular"},o}return _createClass$1(CharacterKeyGroup,[{key:"activeKey",get:function get(){return _get$1(_getPrototypeOf$1(CharacterKeyGroup.prototype),"getActiveKey",this).call(this)}},{key:"layoutLabel",get:function get(){var o;return null===(o=this._layout)||void 0===o?void 0:o.label}},{key:"layout",set:function set(o){var s=this;if(this._layout!=o){this._layout=o;var m=o.characters.map((function(o,m){return{type:$P,label:o,labelTextStyles:s.labelTextStyles,focusedOpacity:s.backgroundOpacity,x:m%s.columnCount*(s.keyWidth+s.keySpacingX),y:Math.floor(m/s.columnCount)*(s.keyHeight+s.keySpacingY),w:s.keyWidth,h:s.keyHeight,backgroundColor:s.keyBackgroundColor,shader:{type:E.shaders.RoundedRectangle,radius:s.keyRadius}}}));this.patch({children:void 0}),this.patch({children:m}),this.index=0,this.signal("onReady")}}},{key:"_handleRight",value:function _handleRight(){var o=this._index;return o%this.columnCount<this.columnCount-1&&o<this.keys.length-1&&(this.index=o+1,!0)}},{key:"_handleLeft",value:function _handleLeft(){var o=this._index;return o%this.columnCount>0&&(this.index=o-1,!0)}},{key:"_handleUp",value:function _handleUp(){var o=this._index-this.columnCount;return o>=0&&(this.index=o,!0)}},{key:"_handleDown",value:function _handleDown(){var o=this._index+this.columnCount;return o<this.keys.length&&(this.index=o,!0)}},{key:"focusedOpacity",set:function set(o){this.backgroundOpacity=o}}]),CharacterKeyGroup}(HP),zP=function(o){_inherits$1(FunctionKeyGroup,o);var s=_createSuper$1(FunctionKeyGroup);function FunctionKeyGroup(){var o;return _classCallCheck$1(this,FunctionKeyGroup),(o=s.apply(this,arguments)).keyWidth=270,o.specialKeyVariable="!?#&",o.backgroundOpacity=.5,o}return _createClass$1(FunctionKeyGroup,[{key:"functionalKeys",set:function set(o){var s=this,m=o.map((function(o,m){return{x:m*(s.keyWidth+s.keySpacingX),w:s.keyWidth,h:s.keyHeight,type:VP,data:o,focusedOpacity:s.backgroundOpacity,specialKeyLabel:s.specialKeyVariable,backgroundColor:s.keyBackgroundColor,shader:{type:E.shaders.RoundedRectangle,radius:s.keyRadius}}}));this.patch({children:m})}},{key:"updateChildren",value:function updateChildren(){var o=this;this.children.forEach((function(s,m){s.patch({x:m*(o.keyWidth+o.keySpacingX),w:o.keyWidth,h:o.keyHeight,backgroundColor:o.keyBackgroundColor,shader:{type:E.shaders.RoundedRectangle,radius:o.keyRadius}})}))}},{key:"updateChildrenImage",value:function updateChildrenImage(o){var s=Object.keys(o);this.children.forEach((function(m){var _=m;if(s.includes(_.keyLabel)){var S=o[_.keyLabel];m.patch({data:Object.assign({label:_.keyLabel},S)})}}))}},{key:"focusedOpacity",set:function set(o){this.backgroundOpacity=o}}]),FunctionKeyGroup}(HP),__awaiter$8=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},WP=function(o){_inherits$1(Keyboard,o);var s=_createSuper$1(Keyboard);function Keyboard(){var o;return _classCallCheck$1(this,Keyboard),(o=s.apply(this,arguments)).keyWidth=62,o.keyHeight=82,o.keySpacingX=30,o.keySpacingY=18,o.keyRadius=5,o._charGroupRowCount=3,o._charGroupColumnCount=12,o._focusedKeyPadding=16,o._charKeyCount=o._charGroupRowCount*o._charGroupColumnCount,o.characterKeyGroupYOffset=0,o.functionGroupRowCount=1,o.inputFieldTextPadding=0,o.inputFieldAndKeyboardGap=32,o.inputFieldWidth=1074,o.inputFieldHeight=72,o.inputFieldTextPosition=0,o.useFunctionKeys=!1,o.keyIndicatorColor=RE,o.indicatorInnerContainerColor=RE,o.inputFieldBackgroundColor=OE,o.inputFieldRadius=0,o.keyIndicatorPosition=4,o.keyBackgroundColor=BE,o.textStyleProps={fontSize:22,textColor:RE,fontFace:"Bold"},o.isMasked=!1,o.keyboardMode=null,o.characterLayout=jP.uppercaseAlphaNumeric,o.functionKeysSet=!1,o.keyboardXOffset=0,o.characterKeysXOffset=0,o.functionKeysXOffset=0,o}return _createClass$1(Keyboard,[{key:"_init",value:function _init(){return __awaiter$8(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:this.inputField.maxLength=20,this.keyboardMode||(this.mode="search"),this._setState("CharacterKeyGroupFocused");case 3:case"end":return o.stop()}}),_callee,this)})))}},{key:"_enable",value:function _enable(){}},{key:"_focus",value:function _focus(){this.focusedKeyIndicator.setSmooth("alpha",1)}},{key:"_unfocus",value:function _unfocus(){this.focusedKeyIndicator.setSmooth("alpha",0)}},{key:"_captureKey",value:function _captureKey(o){var s=o.key;if(s&&1===s.length&&RegExp(/[a-zA-Z0-9]/).test(s)){this.inputField.insert(s);var m="ABC123"===this.characterKeyGroup.layoutLabel?s.toUpperCase():s,_=this.characterKeyGroup.keys.findIndex((function(o){return o.label===m}));return _>=0&&(this.characterKeyGroup.index=_,this._setState("CharacterKeyGroupFocused")),this.inputField.value.length>0&&(this.tag("Field").alpha=1),!0}return"Delete"===s?!!this.useFunctionKeys&&(this.inputField.clear(),this.tag("Field").alpha=.5,this.functionKeyGroup.index=0,this._setState("FunctionKeyGroupFocused"),!0):" "===s?!(0===this.inputField.value.length||!this.useFunctionKeys)&&(this.inputField.insert(s),this.functionKeyGroup.index=1,this._setState("FunctionKeyGroupFocused"),!0):!("Backspace"!==s||!this.inputField.value)&&(!!this.useFunctionKeys&&(this.inputField.delete(),this.functionKeyGroup.index=2,0===this.inputField.value.length&&(this.tag("Field").alpha=.5),this._setState("FunctionKeyGroupFocused"),!0))}},{key:"onIndexChanged",value:function onIndexChanged(){this.updateFocusedKeyIndicator()}},{key:"getKeyboardLayoutType",value:function getKeyboardLayoutType(o){switch(this.keyboardMode){case"email":return"uppercase"===o?jP.emailUpperCase:jP.emailLowerCase;case"search":return"uppercase"===o?jP.searchUpperCase:jP.searchLowerCase;default:return"uppercase"===o?jP.uppercaseAlphaNumeric:jP.lowercaseAlphaNumeric}}},{key:"onKeyPressed",value:function onKeyPressed(o){if(o instanceof VP){if(!this.useFunctionKeys)return;switch(o.label){case"Clear":this.inputField.clear(),this.tag("Field").alpha=.5;break;case"Space":if(0===this.inputField.value.length||!this.useFunctionKeys)break;this.inputField.insert(" ");break;case"Delete":this.inputField.delete(),0===this.inputField.value.length&&(this.tag("Field").alpha=.5);break;case"Uppercase":this.characterKeyGroup.layout=this.getKeyboardLayoutType("uppercase"),o.label="Lowercase";break;case"Lowercase":this.characterKeyGroup.layout=this.getKeyboardLayoutType("lowercase"),o.label="Uppercase";break;case"!?#&":this.characterKeyGroup.layout=jP.special,o.label="abc";break;case"abc":this.characterKeyGroup.layout=this.getKeyboardLayoutType("lowercase"),o.label="!?#&";break;case".com":this.inputField.addDotCom();break;case"Password":if(this.isMasked=!this.isMasked,this.inputField.mask=this.getInputFieldMask(this.isMasked?"password":""),o.alternateSRC){var s=o.alternateSRC,m=o.mainSRC;o.data={label:"Password",src:s,alternateSRC:m}}}}else this.inputField.insert(o.label),this.inputField.value.length>0&&(this.tag("Field").alpha=1)}},{key:"updateFocusedKeyIndicator",value:function updateFocusedKeyIndicator(){if(this.activeKey){var o=this.activeKey.x,s=this.activeKeyGroup.y+this.activeKey.y;this.focusedKeyIndicator.patch({smooth:{w:this.activeKey.w+this._focusedKeyPadding,h:this.activeKey.h+this._focusedKeyPadding,x:o+this.activeKey.w/2,y:s+this.activeKey.h/2}})}}},{key:"updateKeyBoard",value:function updateKeyBoard(){var o=(this.keyBoardKeyHeight+this.keyboardKeySpacingY)*this.keyboardCharGroupRowCount,s=(this.keyBoardKeyWidth+this.keyBoardKeySpacingX)*this.keyBoardCharGroupColumnCount-this.keyBoardKeySpacingX,m=this.keyBoardKeyHeight,_=o+m*this.keyboardFunctionGroupRowCount,S=s,E=this.keyboardInputFieldHeight+this.keyboardInputFieldAndKeyboardGap,A=E+_,O=2*this.keyBoardKeyWidth+this.keyBoardKeySpacingX;this.patch({w:S,h:A,Keyboard:{h:_,x:this.keyboardXOffset,y:E,CharacterKeyGroup:{w:function w(o){return o},h:o,x:this.characterKeysXOffset,columnCount:this.keyBoardCharGroupColumnCount,keyWidth:this.keyBoardKeyWidth,keyHeight:this.keyBoardKeyHeight,keySpacingX:this.keyBoardKeySpacingX,keySpacingY:this.keyboardKeySpacingY,keyRadius:this.keyboardKeyRadius,keyBackgroundColor:this.keyBackgroundColor,layout:this.characterLayout},FunctionKeyGroup:{w:function w(o){return o},h:this.keyBoardKeyHeight,x:this.functionKeysXOffset,y:o,keyWidth:O,keyHeight:m,keySpacingX:this.keyBoardKeySpacingX,keySpacingY:this.keyboardKeySpacingY,keyRadius:this.keyboardKeyRadius,keyBackgroundColor:this.keyBackgroundColor},FocusedKeyIndicator:{x:this.keyBoardKeyWidth/2,y:this.keyBoardKeyHeight/2,w:this.keyBoardKeyWidth+this.keyboardFocusedKeyPadding,h:this.keyBoardKeyHeight+this.keyboardFocusedKeyPadding,InnerContainer:{w:function w(o){return o-8},h:function h(o){return o-8},InnerContainer2:{w:function w(o){return o-8},h:function h(o){return o-8}}}}}}),this.functionKeyGroup.updateChildren()}},{key:"updateInputField",value:function updateInputField(){this.inputField.placeholder=this.placeHolderProps,this.inputField.textStyle=this.textStyleProps,this.input.patch(Object.assign(Object.assign({x:this.inputFieldTextPadding,w:this.inputFieldWidth,h:this.inputFieldHeight,color:this.inputFieldBackgroundColor},this.inputFieldIconProps&&{InputIcon:this.inputFieldIconProps}),{shader:{radius:this.inputFieldRadius}}))}},{key:"updateFunctionKeys",value:function updateFunctionKeys(){this.tag("FunctionKeyGroup").patch({alpha:this.useFunctionKeys})}},{key:"updateIndicatorAttributes",value:function updateIndicatorAttributes(){this.tag("FocusedKeyIndicator").patch({color:this.keyIndicatorColor,InnerContainer:{x:this.keyIndicatorPosition,y:this.keyIndicatorPosition,InnerContainer2:{x:this.keyIndicatorPosition,y:this.keyIndicatorPosition,color:this.indicatorInnerContainerColor}}})}},{key:"getInputFieldMask",value:function getInputFieldMask(o){switch(o){case"password":return BP.Password;case"creditCard":return BP.CreditCard;case"number":return BP.Number;default:return}}},{key:"defineKeyboardMode",value:function defineKeyboardMode(o){return __awaiter$8(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:if(!this.functionKeysSet){s.next=2;break}return s.abrupt("return");case 2:s.t0=o,s.next="email"===s.t0?5:"password"===s.t0?8:"search"===s.t0?11:14;break;case 5:return this.characterLayout=jP.emailLowerCase,this.setUpEmailFunctionalKeys(),s.abrupt("break",16);case 8:return this.characterLayout=jP.lowercaseAlphaNumeric,this.setUpPasswordFunctionalKeys(),s.abrupt("break",16);case 11:return this.characterLayout=jP.searchLowerCase,this.setUpSearchFunctionalKeys(),s.abrupt("break",16);case 14:return this.characterLayout=jP.lowercaseAlphaNumeric,s.abrupt("break",16);case 16:this.useFunctionKeys=!0,this.updateFunctionKeys();case 18:case"end":return s.stop()}}),_callee2,this)})))}},{key:"setUpEmailFunctionalKeys",value:function setUpEmailFunctionalKeys(){this.functionKeyGroup.functionalKeys=[{label:"Uppercase"},{label:"!?#&"},{label:".com"},{label:"Clear"},{label:"Delete"}]}},{key:"setUpPasswordFunctionalKeys",value:function setUpPasswordFunctionalKeys(){this.functionKeyGroup.functionalKeys=[{label:"Uppercase"},{label:"!?#&"},{label:"Space"},{label:"Clear"},{label:"Delete"},{label:"Password"}]}},{key:"setUpSearchFunctionalKeys",value:function setUpSearchFunctionalKeys(){this.functionKeyGroup.functionalKeys=[{label:"Uppercase"},{label:"Space"},{label:"Clear"},{label:"Delete"}]}},{key:"input",get:function get(){return this.tag("InputField")}},{key:"inputField",get:function get(){return this.tag("InputField.Field")}},{key:"characterKeyGroup",get:function get(){return this.tag("Keyboard.CharacterKeyGroup")}},{key:"functionKeyGroup",get:function get(){return this.tag("Keyboard.FunctionKeyGroup")}},{key:"focusedKeyIndicator",get:function get(){return this.tag("FocusedKeyIndicator")}},{key:"activeKeyGroup",get:function get(){return"CharacterKeyGroupFocused"==this._getState()?this.characterKeyGroup:this.functionKeyGroup}},{key:"activeKey",get:function get(){return this.activeKeyGroup.activeKey}},{key:"keyboard",get:function get(){return this.tag("Keyboard")}},{key:"keyBoardKeyWidth",get:function get(){return this.keyWidth}},{key:"keyBoardKeyHeight",get:function get(){return this.keyHeight}},{key:"keyBoardKeySpacingX",get:function get(){return this.keySpacingX}},{key:"keyboardKeySpacingY",get:function get(){return this.keySpacingY}},{key:"keyboardKeyRadius",get:function get(){return this.keyRadius}},{key:"keyboardCharGroupRowCount",get:function get(){return this._charGroupRowCount}},{key:"keyBoardCharGroupColumnCount",get:function get(){return this._charGroupColumnCount}},{key:"keyboardFocusedKeyPadding",get:function get(){return this._focusedKeyPadding}},{key:"keyboardFunctionGroupRowCount",get:function get(){return this.functionGroupRowCount}},{key:"keyboardInputFieldTextPadding",get:function get(){return this.inputFieldTextPadding}},{key:"keyboardInputFieldAndKeyboardGap",get:function get(){return this.inputFieldAndKeyboardGap}},{key:"keyboardInputFieldHeight",get:function get(){return this.inputFieldHeight}},{key:"value",set:function set(o){this.inputField.resetValue=o}},{key:"keyboardAttributes",set:function set(o){var s=o.keyWidth,m=o.keyHeight,_=o.keySpacingX,S=o.keySpacingY,E=o.keyRadius,A=o.charGroupRowCount,O=o.charGroupColumnCount,H=o.focusedKeyPadding,K=o.keyBackgroundColor,z=o.characterKeyGroupYOffset,G=o.keyboardXOffset,q=o.characterKeysXOffset,X=o.functionKeysXOffset;this.keyWidth=null!=s?s:this.keyWidth,this.keyHeight=null!=m?m:this.keyHeight,this.keySpacingX=null!=_?_:this.keySpacingX,this.keySpacingY=null!=S?S:this.keySpacingY,this.keyRadius=null!=E?E:this.keyRadius,this._charGroupRowCount=null!=A?A:this._charGroupRowCount,this._charGroupColumnCount=null!=O?O:this._charGroupColumnCount,this._focusedKeyPadding=null!=H?H:this._focusedKeyPadding,this.keyBackgroundColor=null!=K?K:this.keyBackgroundColor,this.characterKeyGroupYOffset=null!=z?z:this.characterKeyGroupYOffset,this.keyboardXOffset=null!=G?G:this.keyboardXOffset,this.characterKeysXOffset=null!=q?q:this.characterKeysXOffset,this.functionKeysXOffset=null!=X?X:this.functionKeysXOffset,this.updateKeyBoard()}},{key:"inputFieldAttributes",set:function set(o){var s=o.placeHolderProps,m=o.textStyleProps,_=o.maxLength,S=o.inputFieldTextPadding,E=o.inputFieldAndKeyboardGap,A=o.inputFieldWidth,O=o.inputFieldHeight,H=o.inputFieldIcon,K=o.cursorProps,z=o.inputFieldTextPosition,G=o.backgroundColor,q=o.fieldRadius;this.placeHolderProps=null!=s?s:this.placeHolderProps,this.textStyleProps=null!=m?m:this.textStyleProps,this.inputField.maxLength=null!=_?_:this.inputField.maxLength,this.inputFieldTextPadding=null!=S?S:this.inputFieldTextPadding,this.inputFieldAndKeyboardGap=null!=E?E:this.inputFieldAndKeyboardGap,this.inputFieldWidth=null!=A?A:this.inputFieldWidth,this.inputFieldHeight=null!=O?O:this.inputFieldHeight,this.inputFieldTextPosition=null!=z?z:this.inputFieldTextPosition,this.inputFieldIconProps=H,this.cursorProps=K,this.inputFieldBackgroundColor=null!=G?G:this.inputFieldBackgroundColor,this.inputFieldRadius=null!=q?q:this.inputFieldRadius,this.updateInputField()}},{key:"functionKeys",set:function set(o){var s=Object.keys(o),m=Object.values(o).map((function(o,m){return Object.assign(Object.assign({},o),{label:s[m]})}));this.useFunctionKeys=!0,this.functionKeyGroup.functionalKeys=m,this.functionKeysSet=!0,this.updateFunctionKeys()}},{key:"indicatorAttributes",set:function set(o){var s=o.keyIndicatorColor,m=o.innerIndicatorColor,_=o.indicatorPosition;this.keyIndicatorColor=null!=s?s:this.keyIndicatorColor,this.indicatorInnerContainerColor=null!=m?m:this.indicatorInnerContainerColor,this.keyIndicatorPosition=null!=_?_:this.keyIndicatorPosition,this.updateIndicatorAttributes()}},{key:"mode",set:function set(o){this.keyboardMode=o,this.defineKeyboardMode(o)}},{key:"functionKeyIcons",set:function set(o){this.functionKeyProps=o,this.functionKeyGroup.updateChildrenImage(this.functionKeyProps)}}],[{key:"_template",value:function _template(){var o={indexChanged:"onIndexChanged",keyPressed:"onKeyPressed"};return{title:"Keyboard",w:1074,h:426,InputField:{x:0,w:function w(o){return o},h:72,rect:!0,color:OE,Field:{w:function w(o){return o},x:80,type:UP,passSignals:{onValueChanged:!0},textStyle:{fontSize:48,textColor:RE,fontFace:"Regular"},placeholder:{fontSize:48,textColor:UE,fontFace:"Regular",text:""}},shader:{type:E.shaders.RoundedRectangle,radius:0}},Keyboard:{w:function w(o){return o},h:322,y:104,CharacterKeyGroup:{w:function w(o){return o},h:240,type:KP,columnCount:12,keyWidth:62,keyHeight:82,keySpacingX:30,keySpacingY:18,keyRadius:5,signals:o},FunctionKeyGroup:{w:function w(o){return o},h:82,y:290,type:zP,keyWidth:154,keyHeight:82,keySpacingX:30,keySpacingY:50,keyRadius:5,signals:o,alpha:1},FocusedKeyIndicator:{x:31,y:41,w:78,h:98,mount:.5,rect:!0,color:RE,shader:{type:E.shaders.RoundedRectangle,radius:23},InnerContainer:{x:4,y:4,w:function w(o){return o-8},h:function h(o){return o-8},rect:!0,color:ME,InnerContainer2:{x:4,y:4,w:function w(o){return o-8},h:function h(o){return o-8},rect:!0,color:RE}}}}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(CharacterKeyGroupFocused,o);var s=_createSuper$1(CharacterKeyGroupFocused);function CharacterKeyGroupFocused(){return _classCallCheck$1(this,CharacterKeyGroupFocused),s.apply(this,arguments)}return _createClass$1(CharacterKeyGroupFocused,[{key:"$enter",value:function $enter(){this.updateFocusedKeyIndicator()}},{key:"_getFocused",value:function _getFocused(){return this.characterKeyGroup}},{key:"_handleDown",value:function _handleDown(){if(this.useFunctionKeys){var o=this._charKeyCount-this._charGroupRowCount,s=Math.floor((this.characterKeyGroup.index-o)/2);this.functionKeyGroup.index=s,this._setState("FunctionKeyGroupFocused")}}}]),CharacterKeyGroupFocused}(this),function(o){_inherits$1(FunctionKeyGroupFocused,o);var s=_createSuper$1(FunctionKeyGroupFocused);function FunctionKeyGroupFocused(){return _classCallCheck$1(this,FunctionKeyGroupFocused),s.apply(this,arguments)}return _createClass$1(FunctionKeyGroupFocused,[{key:"$enter",value:function $enter(){this.updateFocusedKeyIndicator()}},{key:"_getFocused",value:function _getFocused(){return this.tag("Keyboard.FunctionKeyGroup")}},{key:"_handleUp",value:function _handleUp(){var o=this._charKeyCount-this._charGroupRowCount+2*this.functionKeyGroup.index;this.characterKeyGroup.index=o,this._setState("CharacterKeyGroupFocused")}}]),FunctionKeyGroupFocused}(this)]}}]),Keyboard}(E.Component),GP=function(o){_inherits$1(CustomSpinner,o);var s=_createSuper$1(CustomSpinner);function CustomSpinner(){return _classCallCheck$1(this,CustomSpinner),s.apply(this,arguments)}return _createClass$1(CustomSpinner,[{key:"_init",value:function _init(){this.setupSpinAnimation()}},{key:"_enable",value:function _enable(){this.spinAnimation.start()}},{key:"_disable",value:function _disable(){this.spinAnimation.stop()}},{key:"_spinner",get:function get(){return this.tag("Spinner")}},{key:"setupSpinAnimation",value:function setupSpinAnimation(){this.spinAnimation=this._spinner.animation({duration:1,repeat:-1,actions:[{t:"RotatingItem",p:"rotation",v:{sm:0,0:0,1:6.29}}]})}},{key:"image",set:function set(o){if(o){var s=renderImage(o,this.w,this.h);this._spinner.patch({RatingCircle:Object.assign(Object.assign({},s),{shader:null})})}}},{key:"radius",set:function set(o){o&&this._spinner.patch({RatingCircle:{shader:{radius:o}}})}},{key:"spinnerColor",set:function set(o){o&&this._spinner.patch({RatingCircle:{shader:{color:o}}})}},{key:"period",set:function set(o){this._spinner.patch({RatingCircle:{shader:{period:o}}})}},{key:"stroke",set:function set(o){this._spinner.patch({RatingCircle:{shader:{stroke:o}}})}},{key:"clockwise",set:function set(o){this._spinner.patch({RatingCircle:{shader:{clockwise:o}}})}},{key:"showDot",set:function set(o){this._spinner.patch({RatingCircle:{shader:{showDot:o}}})}}],[{key:"_template",value:function _template(){return{Spinner:{w:function w(o){return o},h:function h(o){return o},RotatingItem:{rect:!0,w:function w(o){return o},h:function h(o){return o},shader:{type:E.shaders.Spinner2,radius:50,period:2,color:4294967295,backgroundColor:0,stroke:10,showDot:!0,clockwise:!0}}}}}}]),CustomSpinner}(E.Component);function withTTS(o){var s=function(o){_inherits$1(TTS,o);var s=_createSuper$1(TTS);function TTS(){var o;return _classCallCheck$1(this,TTS),(o=s.apply(this,arguments)).announceString="",o.announceContextString="",o}return _createClass$1(TTS,[{key:"announce",get:function get(){return this.announceString},set:function set(o){this.announceString=o,this.onAnnounce(o)}},{key:"announceContext",get:function get(){return this.announceContextString},set:function set(o){this.announceContextString=o}},{key:"onAnnounce",value:function onAnnounce(o){}}]),TTS}(o);return s}var qP={regular:"fonts/arial/arial.ttf",boldItalic:"fonts/arial/arialbi.ttf",bold:"fonts/arial/arialbold.ttf",thin:"fonts/arial/arialn.ttf",medium:"fonts/arial/arialmedium.ttf"},XP={regular:"Regular",bold:"Bold",thin:"Thin",medium:"Medium",boldItalic:"BoldItalic"},YP={search:"images/icons/search.svg",delete:"images/icons/delete_2_w.svg",space:"images/icons/shape_w.svg",backspace:"images/icons/backspace_2_w.svg",arrow:"images/icons/arrow-up-bold.svg",view:"images/icons/view.png",hide:"images/icons/hide.png"},QP=[{url:"QAOverlayImages/1.png"},{url:"QAOverlayImages/2.png"}],JP={playFocused:"images/icons/player/play-black.svg",playUnfocused:"images/icons/player/play-gray.svg",pauseFocused:"images/icons/player/pause-black.svg",pauseUnfocused:"images/icons/player/pause-gray.svg",backFocused:"images/icons/player/back-black.svg",backUnfocused:"images/icons/player/back-gray.svg",forwardFocused:"images/icons/player/forward-black.svg",forwardUnfocused:"images/icons/player/forward-gray.svg",playerMutedFocused:"images/icons/player/mute-black.svg",playerMutedUnfocused:"images/icons/player/mute-gray.svg",playerUnmutedFocused:"images/icons/player/unmute-black.svg",playerUnmutedUnfocused:"images/icons/player/unmute-gray.svg",fullScreenFocused:"images/icons/player/expand-black.svg",fullScreenUnfocused:"images/icons/player/expand-gray.svg"},ZP="images/logo-green.png",eL="images/logo-small.jpg",tL="images/arrow-forward.svg",nL="images/arrow-back.svg",rL="images/background.png",iL=function(o){_inherits$1(CarouselView,o);var s=_createSuper$1(CarouselView);function CarouselView(){var o;return _classCallCheck$1(this,CarouselView),(o=s.apply(this,arguments)).presenter={},o.textProvider={},o.handleCarouselError=function(s){s.newValue&&o.presenter.callAppError({type:"API",onRetry:function onRetry(){return __awaiter$h(_assertThisInitialized(o),void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return Oy.focusPage(),o.next=3,this.presenter.initAsync();case 3:this.setUpCarouselProcess();case 4:case"end":return o.stop()}}),_callee,this)})))},useDismissButton:!0})},o}return _createClass$1(CarouselView,[{key:"_init",value:function _init(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return this.presenter=a_.resolveType(DE.dependencyKeys.CarouselPresenter),this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.presenter.propertyChanged.addListener(this.handleCarouselError),o.next=5,this.presenter.initAsync();case 5:this.setUpCarouselProcess();case 6:case"end":return o.stop()}}),_callee2,this)})))}},{key:"setUpCarouselProcess",value:function setUpCarouselProcess(){var o=this,s=this.carouselData;this.items=null==s?void 0:s.map((function(s){var m=o.presenter.formatPosterUrl(500,s.backdrop_path);return{w:500,h:282,type:HE,itemImage:m,strokeColorOnUnfocus:XS.get("white"),strokeColorOnFocus:XS.get("velopeGreen"),strokeWidth:3,focusedStrokeWidth:6,strokeRadius:0}})),this.tag("Title").patch({text:{text:this.textProvider.getText(cT)}}),this._carousel.onShowPrevArrow=function(){o._carousel.prev.setSmooth("alpha",1)},this._carousel.onHidePrevArrow=function(){o._carousel.prev.setSmooth("alpha",0)},this._carousel.onShowNextArrow=function(){o._carousel.next.setSmooth("alpha",1)},this._carousel.onHideNextArrow=function(){o._carousel.next.setSmooth("alpha",0)}}},{key:"_active",value:function _active(){this._setState("CarouselFocused")}},{key:"items",get:function get(){return this._carousel.items},set:function set(o){this._carousel.items=o}},{key:"selectedIndex",get:function get(){return this._carousel.selectedIndex}},{key:"_carousel",get:function get(){return this.tag("Carousel")}},{key:"carouselData",get:function get(){return this.presenter.carouselData}}],[{key:"_template",value:function _template(){return{w:1920,Title:{w:function w(o){return o},h:45,x:105,text:{fontSize:30,wordWrapWidth:function wordWrapWidth(o){return o},textColor:XS.get("eggshell"),fontFace:XP.bold}},Carousel:{y:51,type:OP,direction:"row",enableArrows:!0,prevArrow:{src:ca.asset(nL),w:102,h:102},nextArrow:{src:ca.asset(tL),w:102,h:102},useShadow:!0,itemSpacing:9,scrollIndex:1,alwaysScroll:!1,wrapSelected:!0,items:[],gradientLeft:{w:180,h:281,colorLeft:XS.get("black"),colorRight:XS.get("clear")},gradientRight:{w:180,h:281,x:getLngOptimalElementSize(1920/1.09),colorLeft:XS.get("clear"),colorRight:XS.get("black")},gradientVisible:!0}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(CarouselFocused,o);var s=_createSuper$1(CarouselFocused);function CarouselFocused(){return _classCallCheck$1(this,CarouselFocused),s.apply(this,arguments)}return _createClass$1(CarouselFocused,[{key:"_getFocused",value:function _getFocused(){return this._carousel}},{key:"_handleEnter",value:function _handleEnter(){var o=this.carouselData[this.selectedIndex].id;Oy.navigate("details/".concat(o),{assetData:this.carouselData[this.selectedIndex]})}}]),CarouselFocused}(this)]}}]),CarouselView}(E.Component),aL=function(o){_inherits$1(RouterScreen,o);var s=_createSuper$1(RouterScreen);function RouterScreen(){var o;return _classCallCheck$1(this,RouterScreen),(o=s.apply(this,arguments)).appWidgets=o.widgets,o}return _createClass$1(RouterScreen,[{key:"_handleBack",value:function _handleBack(){var o=Oy.getHistory(),s=Oy.getActiveHash();if(s){var m=s.search(/home/)>-1,_=o.length>0;!m&&!_?Oy.navigate("home"):Oy.back()}}}]),RouterScreen}(E.Component),oL=function(o){_inherits$1(HomeView,o);var s=_createSuper$1(HomeView);function HomeView(){var o;return _classCallCheck$1(this,HomeView),(o=s.apply(this,arguments)).presenter={},o.textProvider={},o.onFullScreenEnabled=function(s){s.propertyName===JT&&(o.visible=!s.newValue)},o}return _createClass$1(HomeView,[{key:"_firstEnable",value:function _firstEnable(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:this.presenter=a_.resolveType(DE.dependencyKeys.HomePresenter),this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.appWidgets=this.widgets,this.presenter.propertyChanged.addListener(this.onFullScreenEnabled),this.announce=this.textProvider.getText(eT),this.setUpContent(),this._setState("ButtonsSectionFocused"),this.setUpButtons();case 8:case"end":return o.stop()}}),_callee,this)})))}},{key:"_active",value:function _active(){this._setState("ButtonsSectionFocused")}},{key:"_handleUp",value:function _handleUp(){this._setState("CarouselFocused")}},{key:"_handleBack",value:function _handleBack(){}},{key:"_focus",value:function _focus(){this.hideHoleShaders(),this._setState("ButtonsSectionFocused")}},{key:"showWidget",value:function showWidget(){this.showHoleShaders(),Oy.focusWidget("PlayerWidgetContainer")}},{key:"hideHoleShaders",value:function hideHoleShaders(){this._carouselSection.alpha=1,this.patch({Background:{shader:{w:0,h:0}},BottomSection:{SecondTitle:{shader:{w:0,h:0}},Description:{shader:{w:0,h:0}}}}),this._features.items.forEach((function(o){o.patch({shader:{w:0,h:0}})}))}},{key:"showHoleShaders",value:function showHoleShaders(){this._carouselSection.alpha=0,this.patch({Background:{shader:{w:1077,h:606}},BottomSection:{SecondTitle:{shader:{w:1077,h:606}},Description:{shader:{w:1077,h:606}}}}),this._features.items.forEach((function(o){o.patch({shader:{w:1077,h:606}})}))}},{key:"setUpContent",value:function setUpContent(){this.tag("Title").patch({text:{text:this.textProvider.getText(eT)}}),this.tag("SecondTitle").patch({text:{text:this.textProvider.getText(tT)}}),this.tag("Description").patch({text:{text:this.textProvider.getText(rT)}}),this.tag("DemosTitle").patch({text:{text:this.textProvider.getText(nT)}});var o=[this.textProvider.getText(iT),this.textProvider.getText(aT),this.textProvider.getText(oT),this.textProvider.getText(sT),this.textProvider.getText(uT),this.textProvider.getText(lT)];this._features.items=o.map((function(o){return{text:{text:o,fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.regular},shader:{w:0,h:0,x:324,y:0,type:E.shaders.Hole}}}))}},{key:"setUpButtons",value:function setUpButtons(){var o=this;this._playerTestButton.patch({onEnter:function onEnter(){Oy.navigate("playerDemo")}}),this._audioTestButton.patch({onEnter:function onEnter(){Oy.navigate("audioDemo")}}),this._exitButton.patch({onEnter:function onEnter(){Oy.focusWidget("ExitModal")}}),this.keyboardButton.patch({onEnter:function onEnter(){Oy.navigate("keyboard")}}),this._playerWidgetButton.patch({onEnter:function onEnter(){return o.showWidget()}}),this.soundBoardButton.patch({onEnter:function onEnter(){return Oy.navigate("soundBoard")}})}},{key:"onAnnounce",value:function onAnnounce(o){qw.announce(o,!0)}},{key:"_carouselSection",get:function get(){return this.tag("CarouselSection")}},{key:"buttonsRow",get:function get(){return this.tag("Buttons")}},{key:"_playerTestButton",get:function get(){return this.buttonsRow.items[0]}},{key:"_audioTestButton",get:function get(){return this.buttonsRow.items[1]}},{key:"_exitButton",get:function get(){return this.buttonsRow.items[2]}},{key:"_playerWidgetButton",get:function get(){return this.buttonsRow.items[3]}},{key:"keyboardButton",get:function get(){return this.buttonsRow.items[4]}},{key:"soundBoardButton",get:function get(){return this.buttonsRow.items[5]}},{key:"_liveButton",get:function get(){return this.tag("Live")}},{key:"_features",get:function get(){return this.tag("Features")}},{key:"playerContainer",get:function get(){return this.tag("PlayerContainer")}}],[{key:"_template",value:function _template(){var o={color:XS.get("black"),focusedColor:XS.get("velopeGreen"),radius:getLngOptimalElementSize(17),stroke:3,strokeColor:XS.get("white"),focusedStroke:0,textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")}};return{w:1920,h:1080,Background:{w:function w(o){return o},h:function h(o){return o},rect:!0,color:XS.get("black"),shader:{w:0,h:0,x:getLngOptimalElementSize(421),y:getLngOptimalElementSize(192),type:E.shaders.Hole}},Header:{w:function w(o){return o},h:66,y:45,Logo:{w:204,h:63,x:57,src:ca.asset(eL)},Title:{w:getLngOptimalElementSize(400),h:getLngOptimalElementSize(45),x:309,y:9,text:{fontSize:39,wordWrapWidth:function wordWrapWidth(o){return o},textColor:XS.get("eggshell"),fontFace:XP.bold}}},CarouselSection:{w:function w(o){return o},h:function h(o){return o},y:159,type:iL},BottomSection:{x:102,y:getLngOptimalElementSize(539),w:function w(o){return o},h:function h(o){return o},SecondTitle:{w:function w(o){return o},h:getLngOptimalElementSize(40),text:{fontSize:30,wordWrapWidth:function wordWrapWidth(o){return o},textColor:XS.get("eggshell"),fontFace:XP.bold},shader:{w:0,h:0,x:321,y:0,type:E.shaders.Hole}},Description:{w:function w(o){return o},h:42,y:getLngOptimalElementSize(47),text:{fontSize:27,wordWrapWidth:function wordWrapWidth(o){return o},fontFace:XP.regular,textColor:XS.get("eggshell"),lineHeight:42},shader:{w:0,h:0,x:321,y:0,type:E.shaders.Hole}},Features:{y:getLngOptimalElementSize(110),type:RP,style:{itemSpacing:33},items:[]},DemosTitle:{w:function w(o){return o},h:getLngOptimalElementSize(40),y:360,text:{fontSize:30,textColor:XS.get("eggshell"),fontFace:XP.bold}},Buttons:{y:getLngOptimalElementSize(420),w:1820,type:DP,items:[Object.assign({w:327,h:69,type:zE,title:"Show Video Player Test"},o),Object.assign({x:getLngOptimalElementSize(343),w:324,h:69,type:zE,title:"Show Audio Player Test"},o),Object.assign({x:getLngOptimalElementSize(687),w:252,h:69,type:zE,title:"Show Exit Modal"},o),Object.assign({x:getLngOptimalElementSize(958),w:291,h:69,type:zE,title:"Show Player Widget"},o),Object.assign({x:getLngOptimalElementSize(1272),w:291,h:69,type:zE,title:"Keyboard sample"},o),Object.assign({x:getLngOptimalElementSize(1590),w:291,h:69,type:zE,title:"Soundboard"},o)]}}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(CarouselFocused,o);var s=_createSuper$1(CarouselFocused);function CarouselFocused(){return _classCallCheck$1(this,CarouselFocused),s.apply(this,arguments)}return _createClass$1(CarouselFocused,[{key:"_getFocused",value:function _getFocused(){return this.tag("CarouselSection")}},{key:"_handleDown",value:function _handleDown(){this._setState("ButtonsSectionFocused")}}]),CarouselFocused}(this),function(o){_inherits$1(ButtonsSectionFocused,o);var s=_createSuper$1(ButtonsSectionFocused);function ButtonsSectionFocused(){return _classCallCheck$1(this,ButtonsSectionFocused),s.apply(this,arguments)}return _createClass$1(ButtonsSectionFocused,[{key:"_getFocused",value:function _getFocused(){return this.buttonsRow}}]),ButtonsSectionFocused}(this)]}}]),HomeView}(withTTS(aL)),sL=function(o){_inherits$1(PlayerView,o);var s=_createSuper$1(PlayerView);function PlayerView(){return _classCallCheck$1(this,PlayerView),s.apply(this,arguments)}return _createClass$1(PlayerView,[{key:"_active",value:function _active(){Oy.focusWidget("PlayerWidget")}}],[{key:"_template",value:function _template(){return{PlayerPageContainer:{Text:{text:"Player"}}}}}]),PlayerView}(aL),uL=function(o){_inherits$1(SplashView,o);var s=_createSuper$1(SplashView);function SplashView(){var o;return _classCallCheck$1(this,SplashView),(o=s.apply(this,arguments)).presenter={},o.textProvider={},o.onBooting=function(o){"isBooting"===o.propertyName&&(o.newValue||setTimeout((function(){Oy.resume()}),1e3))},o}return _createClass$1(SplashView,[{key:"_init",value:function _init(){if(document.querySelectorAll("#splashgif"))for(var o=document.querySelectorAll("#splashgif"),s=0;s<o.length;s++)o[s].parentNode.removeChild(o[s]);this.presenter=a_.resolveType(DE.dependencyKeys.SplashPresenter),this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.presenter.propertyChanged.addListener(this.onBooting),this.announce=this.textProvider.getText(bT),this.tag("CustomLabel").text.text=this.textProvider.getText(bT)}},{key:"onAnnounce",value:function onAnnounce(o){qw.announce(o,!0)}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,alpha:1,SplashScreen:{type:FP,background:{src:ca.asset("images/videoWall.jpg")},spinner:{w:130,h:130,color:XS.get("white"),showDot:!1,x:500,y:708,period:1.3}},Logo:{x:234,y:292,w:542,h:169,src:ca.asset(ZP)},CustomLabel:{x:244,y:493,w:function w(o){return o},h:function h(o){return o},text:{fontSize:51,wordWrapWidth:522,fontFace:XP.regular,textAlign:"left",text:""}}}}}]),SplashView}(withTTS(E.Component)),lL=function(o){_inherits$1(NotFoundView,o);var s=_createSuper$1(NotFoundView);function NotFoundView(){var o;return _classCallCheck$1(this,NotFoundView),(o=s.apply(this,arguments)).textProvider={},o}return _createClass$1(NotFoundView,[{key:"_init",value:function _init(){this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.tag("Title").text.text=this.textProvider.getText(dT)}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,Background:{w:function w(o){return o},h:function h(o){return o},color:XS.get("black"),rect:!0},Box:{mount:.5,w:800,h:600,x:function x(o){return o/2},y:function y(o){return o/2},color:XS.get("black"),rect:!0,Title:{mountX:.5,x:function x(o){return o/2},y:70,text:{textColor:XS.get("white"),fontStyle:"bold",text:""}}}}}}]),NotFoundView}(aL),cL=function(o){_inherits$1(Layouts,o);var s=_createSuper$1(Layouts);function Layouts(){return _classCallCheck$1(this,Layouts),s.apply(this,arguments)}return _createClass$1(Layouts)}(jP);cL.coreSearchLowerCase={label:"abc",characters:"abcdefghijklmnopqrstuvwxyz-_".split("")},cL.coreSearchUpperCase={label:"ABC",characters:"ABCDEFGHIJKLMNOPQRSTUVWXYZ-_".split("")},cL.numberKeyboard={label:"123@",characters:"123456789@0.".split("")},cL.special={label:"!?#&",characters:"!@#$%^&*(){}[];\"'|\\/<>?±-_`~".split("")},cL.specialNumeric={label:"123!?#&",characters:"1234567890!@#$%^&*(){}[];\"'|\\/<>?±-_`~".split("")};var dL,hL,pL,fL,gL=function(o){_inherits$1(FunctionKeyWithTTS,o);var s=_createSuper$1(FunctionKeyWithTTS);function FunctionKeyWithTTS(){var o;return _classCallCheck$1(this,FunctionKeyWithTTS),(o=s.apply(this,arguments)).textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),o}return _createClass$1(FunctionKeyWithTTS,[{key:"_focus",value:function _focus(){this.focused=!0,this.announce=this.getAnnounceText()}},{key:"getAnnounceText",value:function getAnnounceText(){var o=this.textProvider.getText(this.label);return o||this.label}}]),FunctionKeyWithTTS}(withTTS(VP)),mL=function(o){_inherits$1(FunctionKeyGroup,o);var s=_createSuper$1(FunctionKeyGroup);function FunctionKeyGroup(){var o;return _classCallCheck$1(this,FunctionKeyGroup),(o=s.apply(this,arguments)).specialKeyVariable="!?#$%",o}return _createClass$1(FunctionKeyGroup,[{key:"functionalKeys",set:function set(o){var s=this,m=o.map((function(o,m){return{y:m*(s.keyHeight+s.keySpacingY),w:s.keyWidth,h:s.keyHeight,type:gL,data:o,focusedOpacity:s.backgroundOpacity,specialKeyLabel:s.specialKeyVariable,backgroundColor:s.keyBackgroundColor,shader:{type:E.shaders.RoundedRectangle,radius:s.keyRadius}}}));this.patch({children:m})}},{key:"_handleLeft",value:function _handleLeft(){return!1}},{key:"_handleRight",value:function _handleRight(){return!1}},{key:"_handleUp",value:function _handleUp(){return this.setIndex(this.index-1)}},{key:"_handleDown",value:function _handleDown(){return this.setIndex(this.index+1)}}]),FunctionKeyGroup}(zP),yL=function(o){_inherits$1(KeyWithTTS,o);var s=_createSuper$1(KeyWithTTS);function KeyWithTTS(){var o;return _classCallCheck$1(this,KeyWithTTS),(o=s.apply(this,arguments)).textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),o}return _createClass$1(KeyWithTTS,[{key:"_focus",value:function _focus(){this.focused=!0,this.announce=this.getAnnounceText()}},{key:"getAnnounceText",value:function getAnnounceText(){var o=this.textProvider.getText(this.label);return o||this.label}}]),KeyWithTTS}(withTTS($P)),vL=function(o){_inherits$1(CharacterKeyGroup,o);var s=_createSuper$1(CharacterKeyGroup);function CharacterKeyGroup(){return _classCallCheck$1(this,CharacterKeyGroup),s.apply(this,arguments)}return _createClass$1(CharacterKeyGroup,[{key:"layout",set:function set(o){var s=this;if(this._layout!=o){this._layout=o;var m=o.characters.map((function(o,m){return{type:yL,label:o,labelTextStyles:s.labelTextStyles,focusedOpacity:s.backgroundOpacity,x:m%s.columnCount*(s.keyWidth+s.keySpacingX),y:Math.floor(m/s.columnCount)*(s.keyHeight+s.keySpacingY),w:s.keyWidth,h:s.keyHeight,backgroundColor:s.keyBackgroundColor,shader:{type:E.shaders.RoundedRectangle,radius:s.keyRadius}}}));this.patch({children:void 0}),this.patch({children:m}),this.index=0,this.signal("onReady")}}}]),CharacterKeyGroup}(KP),_L=function(o){_inherits$1(Keyboard,o);var s=_createSuper$1(Keyboard);function Keyboard(){var o;return _classCallCheck$1(this,Keyboard),(o=s.apply(this,arguments)).keyWidth=62,o.keyHeight=82,o.keySpacingX=30,o.keySpacingY=18,o.keyRadius=5,o._charGroupRowCount=3,o._charGroupColumnCount=12,o._charNumberGroupRowCount=3,o._charNumberGroupColumnCount=12,o._focusedKeyPadding=16,o._charKeyCount=o._charGroupRowCount*o._charGroupColumnCount,o._numberKeyCount=o._charNumberGroupRowCount*o._charNumberGroupColumnCount,o.characterKeyGroupYOffset=0,o.functionGroupRowCount=1,o.inputFieldTextPadding=0,o.inputFieldAndKeyboardGap=32,o.inputFieldWidth=1503,o.inputFieldHeight=91,o.inputFieldTextPosition=0,o.inputFieldBackgroundColor=OE,o.inputFieldRadius=0,o.useFunctionKeys=!1,o.keyIndicatorColor=RE,o.indicatorInnerContainerColor=RE,o.keyIndicatorPosition=4,o.keyBackgroundColor=BE,o.textStyleProps={fontSize:22,textColor:RE,fontFace:"Bold"},o.isMasked=!1,o.keyboardMode=null,o.characterLayout=cL.coreSearchLowerCase,o.numberKeyLayout=cL.numberKeyboard,o.functionKeysSet=!1,o}return _createClass$1(Keyboard,[{key:"_init",value:function _init(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:this.inputField.maxLength=50,this.keyboardMode||(this.mode="default"),this._setState("CharacterKeyGroupFocused");case 3:case"end":return o.stop()}}),_callee,this)})))}},{key:"_enable",value:function _enable(){}},{key:"_focus",value:function _focus(){this.focusedKeyIndicator.setSmooth("alpha",1)}},{key:"_unfocus",value:function _unfocus(){this.focusedKeyIndicator.setSmooth("alpha",0)}},{key:"_captureKey",value:function _captureKey(o){var s=o.key;if(s&&1===s.length&&RegExp(/[a-zA-Z0-9]/).test(s)){this.inputField.insert(s);var m="ABC123"===this.characterKeyGroup.layoutLabel?s.toUpperCase():s,_=this.characterKeyGroup.keys.findIndex((function(o){return o.label===m}));return _>=0&&(this.characterKeyGroup.index=_,this._setState("CharacterKeyGroupFocused")),this.inputField.value.length>0&&(this.tag("Field").alpha=1),!0}return"Delete"===s?!!this.useFunctionKeys&&(this.inputField.clear(),this.tag("Field").alpha=.5,this.functionKeyGroup.index=0,this._setState("FunctionKeyGroupFocused"),!0):" "===s?!(0===this.inputField.value.length||!this.useFunctionKeys)&&(this.inputField.insert(s),this.functionKeyGroup.index=1,this._setState("FunctionKeyGroupFocused"),!0):!("Backspace"!==s||!this.inputField.value)&&(!!this.useFunctionKeys&&(this.inputField.delete(),this.functionKeyGroup.index=2,0===this.inputField.value.length&&(this.tag("Field").alpha=.5),this._setState("FunctionKeyGroupFocused"),!0))}},{key:"onIndexChanged",value:function onIndexChanged(){this.updateFocusedKeyIndicator()}},{key:"getKeyboardLayoutType",value:function getKeyboardLayoutType(o){switch(this.keyboardMode){case"email":return"uppercase"===o?cL.emailUpperCase:cL.emailLowerCase;case"search":return"uppercase"===o?cL.searchUpperCase:cL.searchLowerCase;default:return"uppercase"===o?cL.coreSearchUpperCase:cL.coreSearchLowerCase}}},{key:"onKeyPressed",value:function onKeyPressed(o){if(o instanceof VP){if(!this.useFunctionKeys)return;switch(o.label){case"Clear":this.inputField.clear(),this.tag("Field").alpha=.5;break;case"Space":if(0===this.inputField.value.length||!this.useFunctionKeys)break;this.inputField.insert(" ");break;case"Delete":this.inputField.delete(),0===this.inputField.value.length&&(this.tag("Field").alpha=.5);break;case"Uppercase":this.characterKeyGroup.layout=this.getKeyboardLayoutType("uppercase"),o.label="Lowercase";break;case"Lowercase":this.characterKeyGroup.layout=this.getKeyboardLayoutType("lowercase"),o.label="Uppercase";break;case"!?#$%":this.characterKeyGroup.layout=cL.special,o.label="abc";break;case"abc":this.characterKeyGroup.layout=this.getKeyboardLayoutType("lowercase"),o.label="!?#$%";break;case".com":this.inputField.addDotCom();break;case"Password":if(this.isMasked=!this.isMasked,this.inputField.mask=this.getInputFieldMask(this.isMasked?"password":""),o.alternateSRC){var s=o.alternateSRC,m=o.mainSRC;o.data={label:"Password",src:s,alternateSRC:m}}}}else this.inputField.insert(o.label),this.inputField.value.length>0&&(this.tag("Field").alpha=1)}},{key:"updateFocusedKeyIndicator",value:function updateFocusedKeyIndicator(){if(this.activeKey){var o=this.activeKeyGroup.x+this.activeKey.x,s=this.activeKeyGroup.y+this.activeKey.y;this.focusedKeyIndicator.patch({smooth:{w:this.activeKey.w+this._focusedKeyPadding,h:this.activeKey.h+this._focusedKeyPadding,x:o+this.activeKey.w/2,y:s+this.activeKey.h/2}})}}},{key:"updateKeyBoard",value:function updateKeyBoard(){var o=(this.keyBoardKeyHeight+this.keyboardKeySpacingY)*this.keyboardCharGroupRowCount,s=(this.keyBoardKeyHeight+this.keyboardKeySpacingY)*this.keyboardNumberGroupRowCount,m=(this.keyBoardKeyWidth+this.keyBoardKeySpacingX)*this.keyBoardCharGroupColumnCount-this.keyBoardKeySpacingX,_=(this.keyBoardKeyWidth+this.keyBoardKeySpacingX)*this.keyBoardNumberGroupColumnCount-this.keyBoardKeySpacingX,S=this.keyBoardKeyHeight,E=o+S*this.keyboardFunctionGroupRowCount,A=this.keyboardInputFieldHeight+this.keyboardInputFieldAndKeyboardGap,O=A+E,H=2*this.keyBoardKeyWidth+this.keyBoardKeySpacingX;this.patch({w:1513,h:O,Keyboard:{h:E,y:A,FunctionKeyGroup:{w:function w(o){return o},h:this.keyBoardKeyHeight,keyWidth:H,keyHeight:S,keySpacingX:this.keyBoardKeySpacingX,keySpacingY:this.keyboardKeySpacingY,keyRadius:this.keyboardKeyRadius,keyBackgroundColor:this.keyBackgroundColor},CharacterKeyGroup:{w:m,h:o,columnCount:this.keyBoardCharGroupColumnCount,keyWidth:this.keyBoardKeyWidth,keyHeight:this.keyBoardKeyHeight,keySpacingX:this.keyBoardKeySpacingX,keySpacingY:this.keyboardKeySpacingY,labelTextStyles:{fontSize:57,fontFace:XP.bold},keyRadius:this.keyboardKeyRadius,keyBackgroundColor:this.keyBackgroundColor,layout:this.characterLayout},NumberKeyGroup:{w:_,h:s,columnCount:this.keyBoardNumberGroupColumnCount,keyWidth:this.keyBoardKeyWidth,keyHeight:this.keyBoardKeyHeight,keySpacingX:this.keyBoardKeySpacingX,keySpacingY:this.keyboardKeySpacingY,labelTextStyles:{fontSize:57,fontFace:XP.bold},keyRadius:this.keyboardKeyRadius,keyBackgroundColor:this.keyBackgroundColor,layout:this.numberKeyLayout},FocusedKeyIndicator:{x:this.keyBoardKeyWidth/2,y:this.keyBoardKeyHeight/2,w:this.keyBoardKeyWidth+this.keyboardFocusedKeyPadding,h:this.keyBoardKeyHeight+this.keyboardFocusedKeyPadding,InnerContainer:{w:function w(o){return o-8},h:function h(o){return o-8},InnerContainer2:{w:function w(o){return o-8},h:function h(o){return o-8}}}}}}),this.functionKeyGroup.updateChildren()}},{key:"updateInputField",value:function updateInputField(){this.inputField.placeholder=this.placeHolderProps,this.inputField.textStyle=this.textStyleProps,this.input.patch(Object.assign(Object.assign({x:this.inputFieldTextPadding,w:this.inputFieldWidth,h:this.inputFieldHeight,color:this.inputFieldBackgroundColor},this.inputFieldIconProps&&{InputIcon:this.inputFieldIconProps}),{shader:{radius:this.inputFieldRadius}}))}},{key:"updateFunctionKeys",value:function updateFunctionKeys(){this.tag("FunctionKeyGroup").patch({alpha:this.useFunctionKeys})}},{key:"updateIndicatorAttributes",value:function updateIndicatorAttributes(){this.tag("FocusedKeyIndicator").patch({color:this.keyIndicatorColor,InnerContainer:{x:this.keyIndicatorPosition,y:this.keyIndicatorPosition,InnerContainer2:{x:this.keyIndicatorPosition,y:this.keyIndicatorPosition,color:this.indicatorInnerContainerColor}}})}},{key:"input",get:function get(){return this.tag("InputField")}},{key:"inputField",get:function get(){return this.tag("InputField.Field")}},{key:"characterKeyGroup",get:function get(){return this.tag("Keyboard.CharacterKeyGroup")}},{key:"functionKeyGroup",get:function get(){return this.tag("Keyboard.FunctionKeyGroup")}},{key:"numberKeyGroup",get:function get(){return this.tag("Keyboard.NumberKeyGroup")}},{key:"focusedKeyIndicator",get:function get(){return this.tag("FocusedKeyIndicator")}},{key:"activeKeyGroup",get:function get(){switch(this._getState()){case"CharacterKeyGroupFocused":default:return this.characterKeyGroup;case"FunctionKeyGroupFocused":return this.functionKeyGroup;case"NumberKeyGroupFocused":return this.numberKeyGroup}}},{key:"activeKey",get:function get(){return this.activeKeyGroup.activeKey}},{key:"keyboard",get:function get(){return this.tag("Keyboard")}},{key:"keyBoardKeyWidth",get:function get(){return this.keyWidth}},{key:"keyBoardKeyHeight",get:function get(){return this.keyHeight}},{key:"keyBoardKeySpacingX",get:function get(){return this.keySpacingX}},{key:"keyboardKeySpacingY",get:function get(){return this.keySpacingY}},{key:"keyboardKeyRadius",get:function get(){return this.keyRadius}},{key:"keyboardCharGroupRowCount",get:function get(){return this._charGroupRowCount}},{key:"keyBoardCharGroupColumnCount",get:function get(){return this._charGroupColumnCount}},{key:"keyboardNumberGroupRowCount",get:function get(){return this._charNumberGroupRowCount}},{key:"keyBoardNumberGroupColumnCount",get:function get(){return this._charNumberGroupColumnCount}},{key:"keyboardFocusedKeyPadding",get:function get(){return this._focusedKeyPadding}},{key:"keyboardFunctionGroupRowCount",get:function get(){return this.functionGroupRowCount}},{key:"keyboardInputFieldTextPadding",get:function get(){return this.inputFieldTextPadding}},{key:"keyboardInputFieldAndKeyboardGap",get:function get(){return this.inputFieldAndKeyboardGap}},{key:"keyboardInputFieldHeight",get:function get(){return this.inputFieldHeight}},{key:"value",set:function set(o){this.inputField.resetValue=o}},{key:"keyboardAttributes",set:function set(o){var s=o.keyWidth,m=o.keyHeight,_=o.keySpacingX,S=o.keySpacingY,E=o.keyRadius,A=o.charGroupRowCount,O=o.charGroupColumnCount,H=o.focusedKeyPadding,K=o.keyBackgroundColor,z=o.characterKeyGroupYOffset,G=o.numberGroupRowCount,q=o.numberGroupColumnCount;this.keyWidth=null!=s?s:this.keyWidth,this.keyHeight=null!=m?m:this.keyHeight,this.keySpacingX=null!=_?_:this.keySpacingX,this.keySpacingY=null!=S?S:this.keySpacingY,this.keyRadius=null!=E?E:this.keyRadius,this._charGroupRowCount=null!=A?A:this._charGroupRowCount,this._charGroupColumnCount=null!=O?O:this._charGroupColumnCount,this._charNumberGroupRowCount=null!=G?G:this._charNumberGroupRowCount,this._charNumberGroupColumnCount=null!=q?q:this._charNumberGroupColumnCount,this._focusedKeyPadding=null!=H?H:this._focusedKeyPadding,this.keyBackgroundColor=null!=K?K:this.keyBackgroundColor,this.characterKeyGroupYOffset=null!=z?z:this.characterKeyGroupYOffset,this.updateKeyBoard()}},{key:"inputFieldAttributes",set:function set(o){var s=o.placeHolderProps,m=o.textStyleProps,_=o.maxLength,S=o.inputFieldTextPadding,E=o.inputFieldAndKeyboardGap,A=o.inputFieldWidth,O=o.inputFieldHeight,H=o.inputFieldIcon,K=o.cursorProps,z=o.inputFieldTextPosition,G=o.backgroundColor,q=o.fieldRadius;this.placeHolderProps=null!=s?s:this.placeHolderProps,this.textStyleProps=null!=m?m:this.textStyleProps,this.inputField.maxLength=null!=_?_:this.inputField.maxLength,this.inputFieldTextPadding=null!=S?S:this.inputFieldTextPadding,this.inputFieldAndKeyboardGap=null!=E?E:this.inputFieldAndKeyboardGap,this.inputFieldWidth=null!=A?A:this.inputFieldWidth,this.inputFieldHeight=null!=O?O:this.inputFieldHeight,this.inputFieldTextPosition=null!=z?z:this.inputFieldTextPosition,this.inputFieldIconProps=H,this.cursorProps=K,this.inputFieldBackgroundColor=null!=G?G:this.inputFieldBackgroundColor,this.inputFieldRadius=null!=q?q:this.inputFieldRadius,this.updateInputField()}},{key:"getInputFieldMask",value:function getInputFieldMask(o){switch(o){case"password":return BP.Password;case"creditCard":return BP.CreditCard;case"number":return BP.Number;default:return}}},{key:"defineKeyboardMode",value:function defineKeyboardMode(o){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:if(!this.functionKeysSet){s.next=2;break}return s.abrupt("return");case 2:s.t0=o,s.next="email"===s.t0?5:"password"===s.t0?8:"search"===s.t0?11:14;break;case 5:return this.characterLayout=cL.emailLowerCase,this.setUpEmailFunctionalKeys(),s.abrupt("break",17);case 8:return this.characterLayout=cL.lowercaseAlphaNumeric,this.setUpPasswordFunctionalKeys(),s.abrupt("break",17);case 11:return this.characterLayout=cL.searchLowerCase,this.setUpSearchFunctionalKeys(),s.abrupt("break",17);case 14:return this.characterLayout=cL.coreSearchLowerCase,this.setUpDefaultFunctionalKeys(),s.abrupt("break",17);case 17:this.useFunctionKeys=!0,this.updateFunctionKeys();case 19:case"end":return s.stop()}}),_callee2,this)})))}},{key:"setUpEmailFunctionalKeys",value:function setUpEmailFunctionalKeys(){this.functionKeyGroup.functionalKeys=[{label:"Uppercase"},{label:"!?#$%"},{label:".com"},{label:"Clear"},{label:"Delete"}]}},{key:"setUpPasswordFunctionalKeys",value:function setUpPasswordFunctionalKeys(){this.functionKeyGroup.functionalKeys=[{label:"Uppercase"},{label:"!?#$%"},{label:"Space"},{label:"Clear"},{label:"Delete"},{label:"Password"}]}},{key:"setUpSearchFunctionalKeys",value:function setUpSearchFunctionalKeys(){this.functionKeyGroup.functionalKeys=[{label:"Uppercase"},{label:"Space"},{label:"Clear"},{label:"Delete"}]}},{key:"setUpDefaultFunctionalKeys",value:function setUpDefaultFunctionalKeys(){this.functionKeyGroup.functionalKeys=[{label:"!?#$%"},{label:"Uppercase"},{label:"Delete"},{label:"Space"}]}},{key:"functionKeys",set:function set(o){var s=Object.keys(o),m=Object.values(o).map((function(o,m){return Object.assign(Object.assign({},o),{label:s[m]})}));this.useFunctionKeys=!0,this.functionKeyGroup.functionalKeys=m,this.functionKeysSet=!0,this.updateFunctionKeys()}},{key:"indicatorAttributes",set:function set(o){var s=o.keyIndicatorColor,m=o.innerIndicatorColor,_=o.indicatorPosition;this.keyIndicatorColor=null!=s?s:this.keyIndicatorColor,this.indicatorInnerContainerColor=null!=m?m:this.indicatorInnerContainerColor,this.keyIndicatorPosition=null!=_?_:this.keyIndicatorPosition,this.updateIndicatorAttributes()}},{key:"mode",set:function set(o){this.keyboardMode=o,this.defineKeyboardMode(o)}},{key:"functionKeyIcons",set:function set(o){this.functionKeyProps=o,this.functionKeyGroup.updateChildrenImage(this.functionKeyProps)}},{key:"focusedKeyIndicatorRadius",set:function set(o){this.tag("FocusedKeyIndicator").patch({shader:{radius:o}})}}],[{key:"_template",value:function _template(){var o={indexChanged:"onIndexChanged",keyPressed:"onKeyPressed"};return{title:"Keyboard",w:1503,h:426,InputField:{x:0,w:function w(o){return o},h:91,rect:!0,color:OE,Field:{w:function w(o){return o},x:127,y:15,type:UP,passSignals:{onValueChanged:!0},textStyle:{fontSize:48,textColor:RE,fontFace:"Regular"},placeholder:{fontSize:48,textColor:UE,fontFace:"Regular",text:""}},shader:{type:E.shaders.RoundedRectangle,radius:0}},Keyboard:{w:function w(o){return o},h:322,y:104,FunctionKeyGroup:{w:function w(o){return o},h:82,type:mL,keyWidth:154,keyHeight:82,keySpacingX:30,keySpacingY:50,keyRadius:5,signals:o,focusedOpacity:1,alpha:1},CharacterKeyGroup:{w:function w(o){return o},h:240,x:301,type:vL,columnCount:12,keyWidth:62,keyHeight:82,keySpacingX:30,keySpacingY:18,focusedOpacity:1,keyRadius:5,signals:o},NumberKeyGroup:{w:function w(o){return o},h:240,x:1173,type:vL,columnCount:12,keyWidth:62,keyHeight:82,keySpacingX:30,keySpacingY:18,keyRadius:5,focusedOpacity:1,signals:o},FocusedKeyIndicator:{x:31,y:41,w:78,h:98,mount:.5,rect:!0,color:RE,shader:{type:E.shaders.RoundedRectangle,radius:23},InnerContainer:{x:4,y:4,w:function w(o){return o-8},h:function h(o){return o-8},rect:!0,color:RE,InnerContainer2:{x:4,y:4,w:function w(o){return o-8},h:function h(o){return o-8},rect:!0,color:RE}}}}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(CharacterKeyGroupFocused,o);var s=_createSuper$1(CharacterKeyGroupFocused);function CharacterKeyGroupFocused(){return _classCallCheck$1(this,CharacterKeyGroupFocused),s.apply(this,arguments)}return _createClass$1(CharacterKeyGroupFocused,[{key:"$enter",value:function $enter(){this.updateFocusedKeyIndicator()}},{key:"_getFocused",value:function _getFocused(){return this.characterKeyGroup}},{key:"_handleRight",value:function _handleRight(){var o=this._charNumberGroupRowCount+2*this.characterKeyGroup.index;this.numberKeyGroup.index=o,this._setState("NumberKeyGroupFocused")}},{key:"_handleLeft",value:function _handleLeft(){if(this.useFunctionKeys){var o=this._charKeyCount-this._charGroupRowCount,s=Math.floor((this.characterKeyGroup.index-o)/2);this.functionKeyGroup.index=s,this._setState("FunctionKeyGroupFocused")}}}]),CharacterKeyGroupFocused}(this),function(o){_inherits$1(NumberKeyGroupFocused,o);var s=_createSuper$1(NumberKeyGroupFocused);function NumberKeyGroupFocused(){return _classCallCheck$1(this,NumberKeyGroupFocused),s.apply(this,arguments)}return _createClass$1(NumberKeyGroupFocused,[{key:"$enter",value:function $enter(){this.updateFocusedKeyIndicator()}},{key:"_getFocused",value:function _getFocused(){return this.numberKeyGroup}},{key:"_handleLeft",value:function _handleLeft(){var o=this._charKeyCount-this._charGroupRowCount+2*this.numberKeyGroup.index;this.characterKeyGroup.index=o,this._setState("CharacterKeyGroupFocused")}}]),NumberKeyGroupFocused}(this),function(o){_inherits$1(FunctionKeyGroupFocused,o);var s=_createSuper$1(FunctionKeyGroupFocused);function FunctionKeyGroupFocused(){return _classCallCheck$1(this,FunctionKeyGroupFocused),s.apply(this,arguments)}return _createClass$1(FunctionKeyGroupFocused,[{key:"$enter",value:function $enter(){this.updateFocusedKeyIndicator()}},{key:"_getFocused",value:function _getFocused(){return this.tag("Keyboard.FunctionKeyGroup")}},{key:"_handleRight",value:function _handleRight(){var o=this._charKeyCount-this._charGroupRowCount+2*this.functionKeyGroup.index;this.characterKeyGroup.index=o,this._setState("CharacterKeyGroupFocused")}}]),FunctionKeyGroupFocused}(this)]}}]),Keyboard}(withTTS(E.Component)),bL=function(o){_inherits$1(KeyboardView,o);var s=_createSuper$1(KeyboardView);function KeyboardView(){var o;return _classCallCheck$1(this,KeyboardView),(o=s.apply(this,arguments)).inputText="",o.textProvider={},o.selectedKeyboard="email",o}return _createClass$1(KeyboardView,[{key:"_init",value:function _init(){this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.tag("Title").text.text=this.textProvider.getText(gT),this.switchKeyboard(this.selectedKeyboard),this._setState("EmailKeyboardButtonFocused"),this.setUpContent(),this.setUpButtons()}},{key:"_handleDown",value:function _handleDown(){this._setState("KeyboardFocused")}},{key:"setUpContent",value:function setUpContent(){this.tag("Description").patch({text:{text:this.textProvider.getText(jT)}}),this.emailKeyboardButton.title=this.textProvider.getText($T),this.searchKeyboardButton.title=this.textProvider.getText(VT)}},{key:"switchKeyboard",value:function switchKeyboard(o){this.selectedKeyboard=o,"email"===o?(this.searchKeyboard.setSmooth("alpha",0),this.searchKeyboardButton.isSelected=!1,this.emailKeyboard.setSmooth("alpha",1),this.emailKeyboardButton.isSelected=!0):"search"===o&&(this.emailKeyboard.setSmooth("alpha",0),this.emailKeyboardButton.isSelected=!1,this.searchKeyboard.setSmooth("alpha",1),this.searchKeyboardButton.isSelected=!0)}},{key:"setUpButtons",value:function setUpButtons(){var o=this;this.searchKeyboardButton.patch({onEnter:function onEnter(){o.switchKeyboard("search")}}),this.emailKeyboardButton.patch({onEnter:function onEnter(){o.switchKeyboard("email")}})}},{key:"emailKeyboard",get:function get(){return this.tag("Keyboard.Email")}},{key:"searchKeyboard",get:function get(){return this.tag("Keyboard.Search")}},{key:"searchKeyboardButton",get:function get(){return this.tag("Buttons.Search")}},{key:"emailKeyboardButton",get:function get(){return this.tag("Buttons.Email")}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,Background:{w:function w(o){return o},h:function h(o){return o},rect:!0,color:XS.get("black")},Header:{w:function w(o){return o},h:getLngOptimalElementSize(80),y:getLngOptimalElementSize(46),zIndex:99,Logo:{w:204,h:63,x:57,src:ca.asset(eL),shader:{type:E.shaders.RoundedRectangle,radius:10}},Title:{w:402,h:getLngOptimalElementSize(64),x:getLngOptimalElementSize(308),y:9,text:{fontSize:39,wordWrapWidth:function wordWrapWidth(o){return o},textColor:XS.get("eggshell"),fontFace:XP.bold}}},Description:{w:function w(o){return o},h:getLngOptimalElementSize(200),x:15,y:140,text:{fontSize:30,wordWrapWidth:1500,textColor:XS.get("eggshell"),textAlign:"center",fontFace:XP.regular,text:""}},Buttons:{w:function w(o){return o},h:69,x:function x(o){return o/3.5},y:getLngOptimalElementSize(280),Email:{w:321,h:69,type:zE,color:XS.get("black"),focusedColor:XS.get("eggshell"),selectedColor:XS.get("velopeGreen"),radius:18,stroke:3,strokeColor:XS.get("white"),focusedStroke:0,textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")},selectedStyle:{textColor:XS.get("black")}},Search:{x:getLngOptimalElementSize(343),w:321,h:69,type:zE,color:XS.get("black"),focusedColor:XS.get("eggshell"),selectedColor:XS.get("velopeGreen"),radius:18,stroke:3,strokeColor:XS.get("white"),focusedStroke:0,textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")},selectedStyle:{textColor:XS.get("black")}}},Keyboard:{x:204,y:390,Email:{w:1503,type:_L,zIndex:0,alpha:0,signals:{onValueChanged:!0},focusedKeyIndicatorRadius:0,keyboardAttributes:{keyWidth:114,keyHeight:114,keySpacingX:getLngOptimalElementSize(2),keySpacingY:getLngOptimalElementSize(2),keyBackgroundColor:XS.get("keyboardGray"),keyRadius:getLngOptimalElementSize(2),charGroupRowCount:4,charGroupColumnCount:7,numberGroupColumnCount:3,numberGroupRowCount:4,focusedKeyPadding:0},inputFieldAttributes:{placeHolderProps:{fontSize:48,textColor:XS.get("black"),fontFace:XP.medium,text:"Placeholder for search"},textStyleProps:{fontSize:48,textColor:XS.get("black"),fontFace:XP.medium},backgroundColor:XS.get("white"),fieldRadius:18,maxLength:40,inputFieldIcon:{x:24,y:24,texture:E.Tools.getSvgTexture(ca.asset(YP.search),42,42),alpha:1}},functionKeys:{Special:{},Uppercase:{src:E.Tools.getSvgTexture(ca.asset(YP.arrow),49,51),shader:{type:E.shaders.Inversion,amount:10},useTexture:!0},Delete:{src:E.Tools.getSvgTexture(ca.asset(YP.backspace),45,33),useTexture:!0},Space:{src:E.Tools.getSvgTexture(ca.asset(YP.space),45,20),useTexture:!0}}},Search:{type:WP,x:50,zIndex:0,alpha:0,signals:{onValueChanged:!0},keyboardAttributes:{keyWidth:60,keyHeight:72,keySpacingX:getLngOptimalElementSize(10),keySpacingY:getLngOptimalElementSize(11),keyRadius:getLngOptimalElementSize(16),keyBackgroundColor:XS.get("lightGray"),charGroupRowCount:6,charGroupColumnCount:6,focusedKeyPadding:16,keyboardXOffset:400},inputFieldAttributes:{placeHolderProps:{fontSize:48,textColor:XS.get("black"),fontFace:XP.medium,text:"Placeholder for search"},textStyleProps:{fontSize:48,textColor:XS.get("black"),fontFace:XP.medium},inputFieldWidth:1400,backgroundColor:XS.get("white"),fieldRadius:18,maxLength:50,inputFieldIcon:{x:9,y:9,texture:E.Tools.getSvgTexture(ca.asset(YP.search),48,48),alpha:1}},functionKeys:{Clear:{src:E.Tools.getSvgTexture(ca.asset(YP.delete),getLngOptimalElementSize(31.14),getLngOptimalElementSize(32)),useTexture:!0},Space:{src:E.Tools.getSvgTexture(ca.asset(YP.space),45,20),useTexture:!0},Delete:{src:E.Tools.getSvgTexture(ca.asset(YP.backspace),45,33),useTexture:!0},Uppercase:{src:E.Tools.getSvgTexture(ca.asset(YP.arrow),49,51),shader:{type:E.shaders.Inversion,amount:10},useTexture:!0}}}}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(EmailKeyboardButtonFocused,o);var s=_createSuper$1(EmailKeyboardButtonFocused);function EmailKeyboardButtonFocused(){return _classCallCheck$1(this,EmailKeyboardButtonFocused),s.apply(this,arguments)}return _createClass$1(EmailKeyboardButtonFocused,[{key:"_getFocused",value:function _getFocused(){return this.emailKeyboardButton}},{key:"_handleRight",value:function _handleRight(){this._setState("GeneralKeyboardButtonFocused")}}]),EmailKeyboardButtonFocused}(this),function(o){_inherits$1(GeneralKeyboardButtonFocused,o);var s=_createSuper$1(GeneralKeyboardButtonFocused);function GeneralKeyboardButtonFocused(){return _classCallCheck$1(this,GeneralKeyboardButtonFocused),s.apply(this,arguments)}return _createClass$1(GeneralKeyboardButtonFocused,[{key:"_getFocused",value:function _getFocused(){return this.searchKeyboardButton}},{key:"_handleLeft",value:function _handleLeft(){this._setState("EmailKeyboardButtonFocused")}}]),GeneralKeyboardButtonFocused}(this),function(o){_inherits$1(KeyboardFocused,o);var s=_createSuper$1(KeyboardFocused);function KeyboardFocused(){return _classCallCheck$1(this,KeyboardFocused),s.apply(this,arguments)}return _createClass$1(KeyboardFocused,[{key:"_getFocused",value:function _getFocused(){return"email"===this.selectedKeyboard?this.emailKeyboard:"search"===this.selectedKeyboard?this.searchKeyboard:void 0}},{key:"_handleBack",value:function _handleBack(){"email"===this.selectedKeyboard&&this._setState("EmailKeyboardButtonFocused"),"search"===this.selectedKeyboard&&this._setState("GeneralKeyboardButtonFocused")}},{key:"_handleUp",value:function _handleUp(){this._handleBack()}}]),KeyboardFocused}(this)]}}]),KeyboardView}(aL),SL=function(o){_inherits$1(IconButton,o);var s=_createSuper$1(IconButton);function IconButton(){var o;return _classCallCheck$1(this,IconButton),(o=s.apply(this,arguments))._buttonWidth=112,o._buttonHeight=112,o._radius=56,o._buttonColor=XS.get("clear"),o._focusedColor=XS.get("white"),o.selectedButtonColor=FE,o.buttonDisabled=!1,o.iconProps={src:"",w:0,h:0},o.focusedIconProps={src:"",w:0,h:0},o.selectedIconProps={src:"",w:0,h:0},o.buttonSelected=!1,o.buttonInvertIcon=!0,o.updateFocusedIcon=!1,o.buttonStroke=0,o.buttonFocusedStroke=0,o.buttonSelectedStroke=0,o.defaultButtonStrokeColor=OE,o.focusedButtonStrokeColor=OE,o.buttonSelectedStrokeColor=OE,o}return _createClass$1(IconButton,[{key:"_focus",value:function _focus(){this._updateColor(),this.updateFocusedIcon&&this._updateIcon()}},{key:"_unfocus",value:function _unfocus(){this._updateColor(),this.updateFocusedIcon&&this._updateIcon()}},{key:"_handleEnter",value:function _handleEnter(){"function"==typeof this.onEnter&&this.onEnter()}},{key:"_enable",value:function _enable(){this._update()}},{key:"_update",value:function _update(){this._updateIcon(),this._updateSize(),this._updateColor()}},{key:"_updateIcon",value:function _updateIcon(){if(this.iconProps.src){var o=this.iconProps;this.hasFocus()&&!this.buttonInvertIcon?o=this.focusedIconProps:this.isSelected&&(o=this.selectedIconProps),this.buttonIcon.patch(Object.assign(Object.assign(Object.assign({},renderImage(o.src,o.w,o.h)),{rotation:o.rotation?o.rotation:0}),this.buttonInvertIcon&&{shader:{type:E.shaders.Inversion,amount:this.hasFocus()?0:10}}))}}},{key:"_updateSize",value:function _updateSize(){this.button.patch({h:this._buttonHeight,w:this._buttonWidth})}},{key:"_updateColor",value:function _updateColor(){var o=this.hasFocus(),s=this._buttonColor,m=this.isSelected?this.selectedStroke:this.stroke,_=this.isSelected?this.selectedStrokeColor:this.strokeColor;o?s=this._focusedColor:this.isSelected&&(s=this.selectedColor),this.background.patch({alpha:1,shader:{fillColor:s,radius:this._radius,stroke:this.hasFocus()?this.focusedStroke:m,strokeColor:this.hasFocus()?this.focusedStrokeColor:_}}),this.buttonIcon.patch({shader:{amount:o&&this.buttonInvertIcon?6:0}})}},{key:"w",get:function get(){return this._buttonWidth},set:function set(o){this._buttonWidth=o,this._updateSize()}},{key:"h",get:function get(){return this._buttonHeight},set:function set(o){this._buttonHeight=o,this._updateSize()}},{key:"icon",set:function set(o){this.iconProps=o,this._update()}},{key:"focusedIcon",set:function set(o){this.focusedIconProps=o,this._update()}},{key:"selectedIcon",set:function set(o){this.selectedIconProps=o,this._update()}},{key:"disabled",get:function get(){return this.buttonDisabled},set:function set(o){this.buttonDisabled=o,o?this.patch({Icon:{alpha:.5}}):this.patch({Icon:{alpha:1}})}},{key:"radius",get:function get(){return this._radius},set:function set(o){this._radius=o}},{key:"isSelected",get:function get(){return this.buttonSelected},set:function set(o){this.buttonSelected=o,this._update()}},{key:"buttonColor",get:function get(){return this._buttonColor},set:function set(o){this._buttonColor=o,this._updateColor()}},{key:"focusedColor",get:function get(){return this._focusedColor},set:function set(o){this._focusedColor=o,this._updateColor()}},{key:"selectedColor",get:function get(){return this.selectedButtonColor},set:function set(o){this.selectedButtonColor=o,this._updateColor()}},{key:"button",get:function get(){return this.tag("Button")}},{key:"buttonTitle",get:function get(){return this.tag("Button.Content.Title")}},{key:"buttonIcon",get:function get(){return this.tag("Button.Content.Icon")}},{key:"background",get:function get(){return this.tag("Button.Background")}},{key:"invertIcon",set:function set(o){this.buttonInvertIcon=o}},{key:"updateIcon",set:function set(o){this.updateFocusedIcon=o}},{key:"stroke",get:function get(){return this.buttonStroke},set:function set(o){this.buttonStroke=o,this._update()}},{key:"strokeColor",get:function get(){return this.defaultButtonStrokeColor},set:function set(o){this.defaultButtonStrokeColor=o,this._update()}},{key:"focusedStrokeColor",get:function get(){return this.focusedButtonStrokeColor},set:function set(o){this.focusedButtonStrokeColor=o,this._update()}},{key:"focusedStroke",get:function get(){return this.buttonFocusedStroke},set:function set(o){this.buttonFocusedStroke=o,this._updateColor()}},{key:"selectedStroke",get:function get(){return this.buttonSelectedStroke},set:function set(o){this.buttonSelectedStroke=o,this._updateColor()}},{key:"selectedStrokeColor",get:function get(){return this.buttonSelectedStrokeColor},set:function set(o){this.buttonSelectedStrokeColor=o,this._updateColor()}}],[{key:"_template",value:function _template(){return{Button:{w:function w(o){return o},h:function h(o){return o},Background:{w:function w(o){return o},h:function h(o){return o},rect:!0,color:4294967295,shader:{type:E.shaders.RoundedRectangle,radius:56}},Content:{w:function w(o){return o},h:function h(o){return o},Icon:{x:function x(o){return o/2},y:function y(o){return o/2},mount:.5}}}}}}]),IconButton}(E.Component),TL=function(o){_inherits$1(PlayerControlButton,o);var s=_createSuper$1(PlayerControlButton);function PlayerControlButton(){return _classCallCheck$1(this,PlayerControlButton),s.apply(this,arguments)}return _createClass$1(PlayerControlButton,[{key:"_getFocused",value:function _getFocused(){return this.button}},{key:"width",set:function set(o){this.patch({w:o,Button:{w:o}})}},{key:"height",set:function set(o){this.patch({h:o,Button:{h:o}})}},{key:"isActive",set:function set(o){this.button.isSelected=o}},{key:"button",get:function get(){return this.tag("Button")}},{key:"icon",set:function set(o){this.button.icon=o}},{key:"focusedIcon",set:function set(o){this.button.focusedIcon=o}},{key:"selectedIcon",set:function set(o){this.button.selectedIcon=o}},{key:"xOffset",set:function set(o){this.button.x=o}},{key:"yOffset",set:function set(o){this.button.y=o}},{key:"onEnter",set:function set(o){this.button.onEnter=o}}],[{key:"_template",value:function _template(){return{w:72,h:72,Button:{w:72,h:72,type:SL,buttonColor:XS.get("clear"),focusedColor:XS.get("eggshell"),updateIcon:!0,invertIcon:!1,radius:getLngOptimalElementSize(35),stroke:3,strokeColor:XS.get("gray"),focusedStroke:0}}}}]),PlayerControlButton}(E.Component),kL=function(o){_inherits$1(PlayerControls,o);var s=_createSuper$1(PlayerControls);function PlayerControls(){var o;return _classCallCheck$1(this,PlayerControls),(o=s.apply(this,arguments)).playerMuted=!1,o.autoplayEnabled=!0,o.playerWidget={},o.store={},o.textProvider={},o}return _createClass$1(PlayerControls,[{key:"_init",value:function _init(){this.store=a_.resolveType(a_.dependencyKeys.Store),this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.setUpButtonText()}},{key:"_active",value:function _active(){this.autoplayEnabled&&(this.autoPlayButton.isSelected=!0),this.playerMuted=this.store.getByProperty("playerMuted"),this.refreshMuteButton()}},{key:"_focus",value:function _focus(){this.visible=!0}},{key:"_getFocused",value:function _getFocused(){return this.controlButtons}},{key:"setUpButtonText",value:function setUpButtonText(){this.fullscreenButton.patch({announce:this.textProvider.getText(BT)}),this.autoPlayButton.patch({announce:this.textProvider.getText(OT)}),this.playButton.patch({announce:this.textProvider.getText(FT)}),this.pauseButton.patch({announce:this.textProvider.getText(NT)}),this.seekForwardButton.patch({announce:this.textProvider.getText(UT)}),this.seekBackwardsButton.patch({announce:this.textProvider.getText(MT)})}},{key:"setUpButtons",value:function setUpButtons(){var o=this;this.fullscreenButton.onEnter=function(){o.playerWidget.isPlayerWidgetContainer||Oy.focusWidget("PlayerWidget"),o.visible=!1,o.playerWidget.fullscreen()},this.autoPlayButton.onEnter=function(){o.autoplayEnabled=!o.autoplayEnabled,o.autoPlayButton.isSelected=o.autoplayEnabled},this.playButton.onEnter=function(){o.playerWidget.play()},this.pauseButton.onEnter=function(){o.playerWidget.pause()},this.muteButton.onEnter=function(){o.playerMuted?(o.playerWidget.unmute(),o.playerMuted=!1,o.store.set("playerMuted",o.playerMuted)):(o.playerWidget.mute(),o.playerMuted=!0,o.store.set("playerMuted",o.playerMuted)),o.refreshMuteButton()},this.seekForwardButton.onEnter=function(){o.playerWidget.seek(10),o.playerWidget.pause()},this.seekBackwardsButton.onEnter=function(){o.playerWidget.seek(-10),o.playerWidget.pause()}}},{key:"refreshMuteButton",value:function refreshMuteButton(){var o=this.playerMuted?ca.asset(JP.playerMutedUnfocused):ca.asset(JP.playerUnmutedUnfocused),s=this.playerMuted?ca.asset(JP.playerMutedFocused):ca.asset(JP.playerUnmutedFocused);this.muteButton.patch({icon:{w:50,h:50,src:o},focusedIcon:{w:50,h:50,src:s},announce:this.textProvider.getText(this.playerMuted?RT:DT)})}},{key:"widget",set:function set(o){this.playerWidget=o,this.setUpButtons()}},{key:"selectedIndex",get:function get(){return this.controlButtons.selectedIndex}},{key:"controlButtons",get:function get(){return this.tag("Buttons")}},{key:"autoPlayButton",get:function get(){return this.controlButtons.items[0]}},{key:"seekBackwardsButton",get:function get(){return this.controlButtons.items[1]}},{key:"playButton",get:function get(){return this.controlButtons.items[2]}},{key:"pauseButton",get:function get(){return this.controlButtons.items[3]}},{key:"seekForwardButton",get:function get(){return this.controlButtons.items[4]}},{key:"muteButton",get:function get(){return this.controlButtons.items[5]}},{key:"fullscreenButton",get:function get(){return this.controlButtons.items[6]}}],[{key:"_template",value:function _template(){return{Buttons:{type:DP,alwaysScroll:!1,style:{itemSpacing:24},items:[{w:244,h:69,type:zE,extraItemSpacing:96,title:"Autoplay",color:XS.get("black"),focusedColor:XS.get("eggshell"),selectedColor:XS.get("velopeGreen"),radius:18,stroke:3,focusedStroke:0,selectedStroke:0,isSelected:!1,strokeColor:XS.get("white"),textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")},selectedStyle:{textColor:XS.get("black")}},{type:TL,icon:{w:50,h:50,src:ca.asset(JP.backUnfocused)},focusedIcon:{w:50,h:50,src:ca.asset(JP.backFocused)}},{type:TL,icon:{w:50,h:50,src:ca.asset(JP.playUnfocused)},focusedIcon:{w:50,h:50,src:ca.asset(JP.playFocused)}},{type:TL,icon:{w:50,h:50,src:ca.asset(JP.pauseUnfocused)},focusedIcon:{w:50,h:50,src:ca.asset(JP.pauseFocused)}},{type:TL,extraItemSpacing:160,icon:{w:50,h:50,src:ca.asset(JP.forwardFocused)},focusedIcon:{w:50,h:50,src:ca.asset(JP.forwardUnfocused)}},{type:TL,icon:{w:50,h:50,src:ca.asset(JP.playerUnmutedUnfocused)},focusedIcon:{w:50,h:50,src:ca.asset(JP.playerUnmutedFocused)}},{type:TL,icon:{w:50,h:50,src:ca.asset(JP.fullScreenUnfocused)},focusedIcon:{w:50,h:50,src:ca.asset(JP.fullScreenFocused)}}]}}}}]),PlayerControls}(withTTS(E.Component));!function(o){o.HEADER="header",o.QUERY="query"}(dL||(dL={})),function(o){o.HTTP="http",o.HTTPS="https"}(hL||(hL={})),function(o){o.MD5="md5",o.CRC32="crc32",o.CRC32C="crc32c",o.SHA1="sha1",o.SHA256="sha256"}(pL||(pL={})),function(o){o[o.HEADER=0]="HEADER",o[o.TRAILER=1]="TRAILER"}(fL||(fL={}));var CL,wL,xL="__smithy_context";!function(o){o.PROFILE="profile",o.SSO_SESSION="sso-session",o.SERVICES="services"}(CL||(CL={})),function(o){o.HTTP_0_9="http/0.9",o.HTTP_1_0="http/1.0",o.TDS_8_0="tds/8.0"}(wL||(wL={}));var EL=function(){function HttpRequest(o){_classCallCheck$1(this,HttpRequest),this.method=o.method||"GET",this.hostname=o.hostname||"localhost",this.port=o.port,this.query=o.query||{},this.headers=o.headers||{},this.body=o.body,this.protocol=o.protocol?":"!==o.protocol.slice(-1)?"".concat(o.protocol,":"):o.protocol:"https:",this.path=o.path?"/"!==o.path.charAt(0)?"/".concat(o.path):o.path:"/",this.username=o.username,this.password=o.password,this.fragment=o.fragment}return _createClass$1(HttpRequest,[{key:"clone",value:function clone(){var o=new HttpRequest(_objectSpread2(_objectSpread2({},this),{},{headers:_objectSpread2({},this.headers)}));return o.query&&(o.query=function cloneQuery$1(o){return Object.keys(o).reduce((function(s,m){var _=o[m];return _objectSpread2(_objectSpread2({},s),{},_defineProperty$2({},m,Array.isArray(_)?_toConsumableArray$1(_):_))}),{})}(o.query)),o}}],[{key:"isInstance",value:function isInstance(o){if(!o)return!1;var s=o;return"method"in s&&"protocol"in s&&"hostname"in s&&"path"in s&&"object"==typeof s.query&&"object"==typeof s.headers}}]),HttpRequest}();var IL=function(){function HttpResponse(o){_classCallCheck$1(this,HttpResponse),this.statusCode=o.statusCode,this.reason=o.reason,this.headers=o.headers||{},this.body=o.body}return _createClass$1(HttpResponse,null,[{key:"isInstance",value:function isInstance(o){if(!o)return!1;var s=o;return"number"==typeof s.statusCode&&"object"==typeof s.headers}}]),HttpResponse}();var AL={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},PL=function getHostHeaderPlugin(o){return{applyToStack:function applyToStack(s){s.add(function hostHeaderMiddleware(o){return function(s){return function(){var m=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(m){var _,S,E,A;return _regeneratorRuntime$1().wrap((function _callee$(O){for(;;)switch(O.prev=O.next){case 0:if(EL.isInstance(m.request)){O.next=2;break}return O.abrupt("return",s(m));case 2:return _=m.request,S=o.requestHandler.metadata||{},(void 0===(E=S.handlerProtocol)?"":E).indexOf("h2")>=0&&!_.headers[":authority"]?(delete _.headers.host,_.headers[":authority"]=_.hostname+(_.port?":"+_.port:"")):_.headers.host||(A=_.hostname,null!=_.port&&(A+=":".concat(_.port)),_.headers.host=A),O.abrupt("return",s(m));case 6:case"end":return O.stop()}}),_callee)})));return function(o){return m.apply(this,arguments)}}()}}(o),AL)}}},LL=["$metadata"],DL={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},RL=function getLoggerPlugin(o){return{applyToStack:function applyToStack(o){o.add(function loggerMiddleware(){return function(o,s){return function(){var m=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(m){var _,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He;return _regeneratorRuntime$1().wrap((function _callee$(et){for(;;)switch(et.prev=et.next){case 0:return et.prev=0,et.next=3,o(m);case 3:return S=et.sent,E=s.clientName,A=s.commandName,O=s.logger,H=s.dynamoDbDocumentClientOptions,z=(K=void 0===H?{}:H).overrideInputFilterSensitiveLog,G=K.overrideOutputFilterSensitiveLog,q=null!=z?z:s.inputFilterSensitiveLog,X=null!=G?G:s.outputFilterSensitiveLog,J=S.output,ae=J.$metadata,pe=_objectWithoutProperties(J,LL),null==O||null===(_=O.info)||void 0===_||_.call(O,{clientName:E,commandName:A,input:q(m.input),output:X(pe),metadata:ae}),et.abrupt("return",S);case 13:throw et.prev=13,et.t0=et.catch(0),_e=s.clientName,Se=s.commandName,Ee=s.logger,De=s.dynamoDbDocumentClientOptions,$e=(void 0===De?{}:De).overrideInputFilterSensitiveLog,He=null!=$e?$e:s.inputFilterSensitiveLog,null==Ee||null===(me=Ee.error)||void 0===me||me.call(Ee,{clientName:_e,commandName:Se,input:He(m.input),error:et.t0,metadata:et.t0.$metadata}),et.t0;case 20:case"end":return et.stop()}}),_callee,null,[[0,13]])})));return function(o){return m.apply(this,arguments)}}()}}(),DL)}}},OL="X-Amzn-Trace-Id",ML={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},FL=function getRecursionDetectionPlugin(o){return{applyToStack:function applyToStack(s){s.add(function recursionDetectionMiddleware(o){return function(s){return function(){var m=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(m){var _,S,E;return _regeneratorRuntime$1().wrap((function _callee$(A){for(;;)switch(A.prev=A.next){case 0:if(_=m.request,EL.isInstance(_)&&"node"===o.runtime&&!_.headers.hasOwnProperty(OL)){A.next=3;break}return A.abrupt("return",s(m));case 3:return S=oE._X_AMZN_TRACE_ID,(E=function nonEmptyString(o){return"string"==typeof o&&o.length>0})(oE.AWS_LAMBDA_FUNCTION_NAME)&&E(S)&&(_.headers[OL]=S),A.abrupt("return",s(_objectSpread2(_objectSpread2({},m),{},{request:_})));case 8:case"end":return A.stop()}}),_callee)})));return function(o){return m.apply(this,arguments)}}()}}(o),ML)}}},NL=function memoize(o,s,m){var _,S,E,A=!1,O=function(){var s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return S||(S=o()),s.prev=1,s.next=4,S;case 4:_=s.sent,E=!0,A=!1;case 7:return s.prev=7,S=void 0,s.finish(7);case 10:return s.abrupt("return",_);case 11:case"end":return s.stop()}}),_callee,null,[[1,,7,10]])})));return function coalesceProvider(){return s.apply(this,arguments)}}();return void 0===s?function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o){return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:if(E&&(null==o||!o.forceRefresh)){s.next=4;break}return s.next=3,O();case 3:_=s.sent;case 4:return s.abrupt("return",_);case 5:case"end":return s.stop()}}),_callee2)})));return function(s){return o.apply(this,arguments)}}():function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee3(o){return _regeneratorRuntime$1().wrap((function _callee3$(S){for(;;)switch(S.prev=S.next){case 0:if(E&&(null==o||!o.forceRefresh)){S.next=4;break}return S.next=3,O();case 3:_=S.sent;case 4:if(!A){S.next=6;break}return S.abrupt("return",_);case 6:if(!m||m(_)){S.next=9;break}return A=!0,S.abrupt("return",_);case 9:if(!s(_)){S.next=13;break}return S.next=12,O();case 12:case 13:return S.abrupt("return",_);case 14:case"end":return S.stop()}}),_callee3)})));return function(s){return o.apply(this,arguments)}}()},UL={},BL=getAugmentedNamespace(KS),jL={},$L={};var VL=Object.freeze({__proto__:null,fromUtf8:function fromUtf8(o){return"function"==typeof TextEncoder?function fromUtf8$3(o){return(new TextEncoder).encode(o)}(o):function fromUtf8(o){for(var s=[],m=0,_=o.length;m<_;m++){var S=o.charCodeAt(m);if(S<128)s.push(S);else if(S<2048)s.push(S>>6|192,63&S|128);else if(m+1<o.length&&55296==(64512&S)&&56320==(64512&o.charCodeAt(m+1))){var E=65536+((1023&S)<<10)+(1023&o.charCodeAt(++m));s.push(E>>18|240,E>>12&63|128,E>>6&63|128,63&E|128)}else s.push(S>>12|224,S>>6&63|128,63&S|128)}return Uint8Array.from(s)}(o)},toUtf8:function toUtf8(o){return"function"==typeof TextDecoder?function toUtf8$2(o){return new TextDecoder("utf-8").decode(o)}(o):function toUtf8(o){for(var s="",m=0,_=o.length;m<_;m++){var S=o[m];if(S<128)s+=String.fromCharCode(S);else if(192<=S&&S<224){var E=o[++m];s+=String.fromCharCode((31&S)<<6|63&E)}else if(240<=S&&S<365){var A="%"+[S,o[++m],o[++m],o[++m]].map((function(o){return o.toString(16)})).join("%");s+=decodeURIComponent(A)}else s+=String.fromCharCode((15&S)<<12|(63&o[++m])<<6|63&o[++m])}return s}(o)}}),HL=getAugmentedNamespace(VL);Object.defineProperty($L,"__esModule",{value:!0}),$L.convertToBuffer=void 0;var KL=HL,zL="undefined"!=typeof Buffer&&Buffer.from?function(o){return Buffer.from(o,"utf8")}:KL.fromUtf8;$L.convertToBuffer=function convertToBuffer(o){return o instanceof Uint8Array?o:"string"==typeof o?zL(o):ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(o)};var WL={};Object.defineProperty(WL,"__esModule",{value:!0}),WL.isEmptyData=void 0,WL.isEmptyData=function isEmptyData$2(o){return"string"==typeof o?0===o.length:0===o.byteLength};var GL={};Object.defineProperty(GL,"__esModule",{value:!0}),GL.numToUint8=void 0,GL.numToUint8=function numToUint8(o){return new Uint8Array([(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o])};var qL={};Object.defineProperty(qL,"__esModule",{value:!0}),qL.uint32ArrayFrom=void 0,qL.uint32ArrayFrom=function uint32ArrayFrom(o){if(!Uint32Array.from){for(var s=new Uint32Array(o.length),m=0;m<o.length;)s[m]=o[m],m+=1;return s}return Uint32Array.from(o)},function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.uint32ArrayFrom=o.numToUint8=o.isEmptyData=o.convertToBuffer=void 0;var s=$L;Object.defineProperty(o,"convertToBuffer",{enumerable:!0,get:function get(){return s.convertToBuffer}});var m=WL;Object.defineProperty(o,"isEmptyData",{enumerable:!0,get:function get(){return m.isEmptyData}});var _=GL;Object.defineProperty(o,"numToUint8",{enumerable:!0,get:function get(){return _.numToUint8}});var S=qL;Object.defineProperty(o,"uint32ArrayFrom",{enumerable:!0,get:function get(){return S.uint32ArrayFrom}})}(jL);var XL={};Object.defineProperty(XL,"__esModule",{value:!0}),XL.AwsCrc32=void 0;var YL=BL,QL=jL,JL=UL,ZL=function(){function AwsCrc32(){this.crc32=new JL.Crc32}return AwsCrc32.prototype.update=function(o){(0,QL.isEmptyData)(o)||this.crc32.update((0,QL.convertToBuffer)(o))},AwsCrc32.prototype.digest=function(){return YL.__awaiter(this,void 0,void 0,(function(){return YL.__generator(this,(function(o){return[2,(0,QL.numToUint8)(this.crc32.digest())]}))}))},AwsCrc32.prototype.reset=function(){this.crc32=new JL.Crc32},AwsCrc32}();XL.AwsCrc32=ZL,function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.AwsCrc32=o.Crc32=o.crc32=void 0;var s=BL,m=jL;o.crc32=function crc32(o){return(new _).update(o).digest()};var _=function(){function Crc32(){this.checksum=4294967295}return Crc32.prototype.update=function(o){var m,_;try{for(var E=s.__values(o),A=E.next();!A.done;A=E.next()){var O=A.value;this.checksum=this.checksum>>>8^S[255&(this.checksum^O)]}}catch(o){m={error:o}}finally{try{A&&!A.done&&(_=E.return)&&_.call(E)}finally{if(m)throw m.error}}return this},Crc32.prototype.digest=function(){return(4294967295^this.checksum)>>>0},Crc32}();o.Crc32=_;var S=(0,m.uint32ArrayFrom)([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),E=XL;Object.defineProperty(o,"AwsCrc32",{enumerable:!0,get:function get(){return E.AwsCrc32}})}(UL);for(var eD={},tD={},nD=0;nD<256;nD++){var rD=nD.toString(16).toLowerCase();1===rD.length&&(rD="0".concat(rD)),eD[nD]=rD,tD[rD]=nD}function toHex(o){for(var s="",m=0;m<o.byteLength;m++)s+=eD[o[m]];return s}var iD=function(){function Int64(o){if(_classCallCheck$1(this,Int64),this.bytes=o,8!==o.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}return _createClass$1(Int64,[{key:"valueOf",value:function valueOf(){var o=this.bytes.slice(0),s=128&o[0];return s&&negate(o),parseInt(toHex(o),16)*(s?-1:1)}},{key:"toString",value:function toString(){return String(this.valueOf())}}],[{key:"fromNumber",value:function fromNumber(o){if(o>0x8000000000000000||o<-0x8000000000000000)throw new Error("".concat(o," is too large (or, if negative, too small) to represent as an Int64"));for(var s=new Uint8Array(8),m=7,_=Math.abs(Math.round(o));m>-1&&_>0;m--,_/=256)s[m]=_;return o<0&&negate(s),new Int64(s)}}]),Int64}();function negate(o){for(var s=0;s<8;s++)o[s]^=255;for(var m=7;m>-1&&(o[m]++,0===o[m]);m--);}var aD,oD=function(){function HeaderMarshaller(o,s){_classCallCheck$1(this,HeaderMarshaller),this.toUtf8=o,this.fromUtf8=s}return _createClass$1(HeaderMarshaller,[{key:"format",value:function format(o){for(var s=[],m=0,_=Object.keys(o);m<_.length;m++){var S=_[m],E=this.fromUtf8(S);s.push(Uint8Array.from([E.byteLength]),E,this.formatHeaderValue(o[S]))}for(var A=new Uint8Array(s.reduce((function(o,s){return o+s.byteLength}),0)),O=0,H=0,K=s;H<K.length;H++){var z=K[H];A.set(z,O),O+=z.byteLength}return A}},{key:"formatHeaderValue",value:function formatHeaderValue(o){switch(o.type){case"boolean":return Uint8Array.from([o.value?0:1]);case"byte":return Uint8Array.from([2,o.value]);case"short":var s=new DataView(new ArrayBuffer(3));return s.setUint8(0,3),s.setInt16(1,o.value,!1),new Uint8Array(s.buffer);case"integer":var m=new DataView(new ArrayBuffer(5));return m.setUint8(0,4),m.setInt32(1,o.value,!1),new Uint8Array(m.buffer);case"long":var _=new Uint8Array(9);return _[0]=5,_.set(o.value.bytes,1),_;case"binary":var S=new DataView(new ArrayBuffer(3+o.value.byteLength));S.setUint8(0,6),S.setUint16(1,o.value.byteLength,!1);var E=new Uint8Array(S.buffer);return E.set(o.value,3),E;case"string":var A=this.fromUtf8(o.value),O=new DataView(new ArrayBuffer(3+A.byteLength));O.setUint8(0,7),O.setUint16(1,A.byteLength,!1);var H=new Uint8Array(O.buffer);return H.set(A,3),H;case"timestamp":var K=new Uint8Array(9);return K[0]=8,K.set(iD.fromNumber(o.value.valueOf()).bytes,1),K;case"uuid":if(!mD.test(o.value))throw new Error("Invalid UUID received: ".concat(o.value));var z=new Uint8Array(17);return z[0]=9,z.set(function fromHex(o){if(o.length%2!=0)throw new Error("Hex encoded strings must have an even number length");for(var s=new Uint8Array(o.length/2),m=0;m<o.length;m+=2){var _=o.slice(m,m+2).toLowerCase();if(!(_ in tD))throw new Error("Cannot decode unrecognized sequence ".concat(_," as hexadecimal"));s[m/2]=tD[_]}return s}(o.value.replace(/\-/g,"")),1),z}}},{key:"parse",value:function parse(o){for(var s={},m=0;m<o.byteLength;){var _=o.getUint8(m++),S=this.toUtf8(new Uint8Array(o.buffer,o.byteOffset+m,_));switch(m+=_,o.getUint8(m++)){case 0:s[S]={type:sD,value:!0};break;case 1:s[S]={type:sD,value:!1};break;case 2:s[S]={type:uD,value:o.getInt8(m++)};break;case 3:s[S]={type:lD,value:o.getInt16(m,!1)},m+=2;break;case 4:s[S]={type:cD,value:o.getInt32(m,!1)},m+=4;break;case 5:s[S]={type:dD,value:new iD(new Uint8Array(o.buffer,o.byteOffset+m,8))},m+=8;break;case 6:var E=o.getUint16(m,!1);m+=2,s[S]={type:hD,value:new Uint8Array(o.buffer,o.byteOffset+m,E)},m+=E;break;case 7:var A=o.getUint16(m,!1);m+=2,s[S]={type:pD,value:this.toUtf8(new Uint8Array(o.buffer,o.byteOffset+m,A))},m+=A;break;case 8:s[S]={type:fD,value:new Date(new iD(new Uint8Array(o.buffer,o.byteOffset+m,8)).valueOf())},m+=8;break;case 9:var O=new Uint8Array(o.buffer,o.byteOffset+m,16);m+=16,s[S]={type:gD,value:"".concat(toHex(O.subarray(0,4)),"-").concat(toHex(O.subarray(4,6)),"-").concat(toHex(O.subarray(6,8)),"-").concat(toHex(O.subarray(8,10)),"-").concat(toHex(O.subarray(10)))};break;default:throw new Error("Unrecognized header type tag")}}return s}}]),HeaderMarshaller}();!function(o){o[o.boolTrue=0]="boolTrue",o[o.boolFalse=1]="boolFalse",o[o.byte=2]="byte",o[o.short=3]="short",o[o.integer=4]="integer",o[o.long=5]="long",o[o.byteArray=6]="byteArray",o[o.string=7]="string",o[o.timestamp=8]="timestamp",o[o.uuid=9]="uuid"}(aD||(aD={}));var sD="boolean",uD="byte",lD="short",cD="integer",dD="long",hD="binary",pD="string",fD="timestamp",gD="uuid",mD=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,yD=function normalizeProvider(o){if("function"==typeof o)return o;var s=Promise.resolve(o);return function(){return s}},vD=function fromUtf8(o){return(new TextEncoder).encode(o)},_D=function toUint8Array(o){return"string"==typeof o?vD(o):ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(o)},bD=function toUtf8(o){return new TextDecoder("utf-8").decode(o)},SD="X-Amz-Date",TD="X-Amz-Signature",kD="X-Amz-Security-Token",CD="authorization",wD=SD.toLowerCase(),xD=[CD,wD,"date"],ED=TD.toLowerCase(),ID="x-amz-content-sha256",AD=kD.toLowerCase(),PD={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},LD=/^proxy-/,DD=/^sec-/,RD="AWS4-HMAC-SHA256",OD="AWS4-HMAC-SHA256-PAYLOAD",MD="aws4_request",FD={},ND=[],UD=function createScope(o,s,m){return"".concat(o,"/").concat(s,"/").concat(m,"/").concat(MD)},BD=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o,s,m,_,S){var E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,jD(o,s.secretAccessKey,s.accessKeyId);case 2:if(E=G.sent,!((A="".concat(m,":").concat(_,":").concat(S,":").concat(toHex(E),":").concat(s.sessionToken))in FD)){G.next=6;break}return G.abrupt("return",FD[A]);case 6:for(ND.push(A);ND.length>50;)delete FD[ND.shift()];O="AWS4".concat(s.secretAccessKey),H=0,K=[m,_,S,MD];case 10:if(!(H<K.length)){G.next=18;break}return z=K[H],G.next=14,jD(o,O,z);case 14:O=G.sent;case 15:H++,G.next=10;break;case 18:return G.abrupt("return",FD[A]=O);case 19:case"end":return G.stop()}}),_callee)})));return function getSigningKey(s,m,_,S,E){return o.apply(this,arguments)}}(),jD=function hmac(o,s,m){var _=new o(s);return _.update(_D(m)),_.digest()},$D=function getCanonicalHeaders(o,s,m){var _,S=o.headers,E={},A=_createForOfIteratorHelper(Object.keys(S).sort());try{for(A.s();!(_=A.n()).done;){var O=_.value;if(null!=S[O]){var H=O.toLowerCase();(H in PD||null!=s&&s.has(H)||LD.test(H)||DD.test(H))&&(!m||m&&!m.has(H))||(E[H]=S[O].trim().replace(/\s+/g," "))}}}catch(o){A.e(o)}finally{A.f()}return E},VD=function escapeUri(o){return encodeURIComponent(o).replace(/[!'()*]/g,HD)},HD=function hexEncode(o){return"%".concat(o.charCodeAt(0).toString(16).toUpperCase())},KD=function isArrayBuffer(o){return"function"==typeof ArrayBuffer&&o instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(o)},zD=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o,s){var m,_,S,E,A,O;return _regeneratorRuntime$1().wrap((function _callee$(H){for(;;)switch(H.prev=H.next){case 0:m=o.headers,_=o.body,S=0,E=Object.keys(m);case 2:if(!(S<E.length)){H.next=9;break}if((A=E[S]).toLowerCase()!==ID){H.next=6;break}return H.abrupt("return",m[A]);case 6:S++,H.next=2;break;case 9:if(null!=_){H.next=13;break}return H.abrupt("return","e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855");case 13:if("string"!=typeof _&&!ArrayBuffer.isView(_)&&!KD(_)){H.next=21;break}return(O=new s).update(_D(_)),H.t0=toHex,H.next=19,O.digest();case 19:return H.t1=H.sent,H.abrupt("return",(0,H.t0)(H.t1));case 21:return H.abrupt("return","UNSIGNED-PAYLOAD");case 22:case"end":return H.stop()}}),_callee)})));return function getPayloadHash(s,m){return o.apply(this,arguments)}}(),WD=function hasHeader(o,s){o=o.toLowerCase();for(var m=0,_=Object.keys(s);m<_.length;m++){if(o===_[m].toLowerCase())return!0}return!1},GD=["headers","query"],qD=function cloneRequest(o){var s=o.headers,m=o.query;return _objectSpread2(_objectSpread2({},_objectWithoutProperties(o,GD)),{},{headers:_objectSpread2({},s),query:m?XD(m):void 0})},XD=function cloneQuery(o){return Object.keys(o).reduce((function(s,m){var _=o[m];return _objectSpread2(_objectSpread2({},s),{},_defineProperty$2({},m,Array.isArray(_)?_toConsumableArray$1(_):_))}),{})},YD=function moveHeadersToQuery(o){for(var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m="function"==typeof o.clone?o.clone():qD(o),_=m.headers,S=m.query,E=void 0===S?{}:S,A=0,O=Object.keys(_);A<O.length;A++){var H,K=O[A],z=K.toLowerCase();"x-amz-"!==z.slice(0,6)||null!==(H=s.unhoistableHeaders)&&void 0!==H&&H.has(z)||(E[K]=_[K],delete _[K])}return _objectSpread2(_objectSpread2({},o),{},{headers:_,query:E})},QD=function prepareRequest(o){o="function"==typeof o.clone?o.clone():qD(o);for(var s=0,m=Object.keys(o.headers);s<m.length;s++){var _=m[s];xD.indexOf(_.toLowerCase())>-1&&delete o.headers[_]}return o},JD=function toDate(o){return"number"==typeof o?new Date(1e3*o):"string"==typeof o?Number(o)?new Date(1e3*Number(o)):new Date(o):o},ZD=function(){function SignatureV4(o){var s=o.applyChecksum,m=o.credentials,_=o.region,S=o.service,E=o.sha256,A=o.uriEscapePath,O=void 0===A||A;_classCallCheck$1(this,SignatureV4),this.headerMarshaller=new oD(bD,vD),this.service=S,this.sha256=E,this.uriEscapePath=O,this.applyChecksum="boolean"!=typeof s||s,this.regionProvider=yD(_),this.credentialProvider=yD(m)}var o,s,m,_,S,E,A,O;return _createClass$1(SignatureV4,[{key:"presign",value:(O=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){var s,m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se=arguments;return _regeneratorRuntime$1().wrap((function _callee$(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return m=(s=Se.length>1&&void 0!==Se[1]?Se[1]:{}).signingDate,_=void 0===m?new Date:m,S=s.expiresIn,E=void 0===S?3600:S,A=s.unsignableHeaders,O=s.unhoistableHeaders,H=s.signableHeaders,K=s.signingRegion,z=s.signingService,Ee.next=4,this.credentialProvider();case 4:if(G=Ee.sent,this.validateResolvedCredentials(G),null==K){Ee.next=10;break}Ee.t0=K,Ee.next=13;break;case 10:return Ee.next=12,this.regionProvider();case 12:Ee.t0=Ee.sent;case 13:if(q=Ee.t0,X=eR(_),J=X.longDate,ae=X.shortDate,!(E>604800)){Ee.next=17;break}return Ee.abrupt("return",Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future"));case 17:return pe=UD(ae,q,null!=z?z:this.service),me=YD(QD(o),{unhoistableHeaders:O}),G.sessionToken&&(me.query[kD]=G.sessionToken),me.query["X-Amz-Algorithm"]=RD,me.query["X-Amz-Credential"]="".concat(G.accessKeyId,"/").concat(pe),me.query[SD]=J,me.query["X-Amz-Expires"]=E.toString(10),_e=$D(me,A,H),me.query["X-Amz-SignedHeaders"]=tR(_e),Ee.t1=this,Ee.t2=J,Ee.t3=pe,Ee.t4=this.getSigningKey(G,q,ae,z),Ee.t5=this,Ee.t6=me,Ee.t7=_e,Ee.next=35,zD(o,this.sha256);case 35:return Ee.t8=Ee.sent,Ee.t9=Ee.t5.createCanonicalRequest.call(Ee.t5,Ee.t6,Ee.t7,Ee.t8),Ee.next=39,Ee.t1.getSignature.call(Ee.t1,Ee.t2,Ee.t3,Ee.t4,Ee.t9);case 39:return me.query[TD]=Ee.sent,Ee.abrupt("return",me);case 41:case"end":return Ee.stop()}}),_callee,this)}))),function presign(o){return O.apply(this,arguments)})},{key:"sign",value:(A=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o,s){return _regeneratorRuntime$1().wrap((function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:if("string"!=typeof o){m.next=4;break}return m.abrupt("return",this.signString(o,s));case 4:if(!o.headers||!o.payload){m.next=8;break}return m.abrupt("return",this.signEvent(o,s));case 8:if(!o.message){m.next=12;break}return m.abrupt("return",this.signMessage(o,s));case 12:return m.abrupt("return",this.signRequest(o,s));case 13:case"end":return m.stop()}}),_callee2,this)}))),function sign(o,s){return A.apply(this,arguments)})},{key:"signEvent",value:(E=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee3(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me;return _regeneratorRuntime$1().wrap((function _callee3$(_e){for(;;)switch(_e.prev=_e.next){case 0:if(m=o.headers,_=o.payload,S=s.signingDate,E=void 0===S?new Date:S,A=s.priorSignature,O=s.signingRegion,H=s.signingService,null==O){_e.next=6;break}_e.t0=O,_e.next=9;break;case 6:return _e.next=8,this.regionProvider();case 8:_e.t0=_e.sent;case 9:return K=_e.t0,z=eR(E),G=z.shortDate,q=z.longDate,X=UD(G,K,null!=H?H:this.service),_e.next=14,zD({headers:{},body:_},this.sha256);case 14:return J=_e.sent,(ae=new this.sha256).update(m),_e.t1=toHex,_e.next=20,ae.digest();case 20:return _e.t2=_e.sent,pe=(0,_e.t1)(_e.t2),me=[OD,q,X,A,pe,J].join("\n"),_e.abrupt("return",this.signString(me,{signingDate:E,signingRegion:K,signingService:H}));case 24:case"end":return _e.stop()}}),_callee3,this)}))),function signEvent(o,s){return E.apply(this,arguments)})},{key:"signMessage",value:(S=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee4(o,s){var m,_,S,E,A;return _regeneratorRuntime$1().wrap((function _callee4$(O){for(;;)switch(O.prev=O.next){case 0:return m=s.signingDate,_=void 0===m?new Date:m,S=s.signingRegion,E=s.signingService,A=this.signEvent({headers:this.headerMarshaller.format(o.message.headers),payload:o.message.body},{signingDate:_,signingRegion:S,signingService:E,priorSignature:o.priorSignature}),O.abrupt("return",A.then((function(s){return{message:o.message,signature:s}})));case 3:case"end":return O.stop()}}),_callee4,this)}))),function signMessage(o,s){return S.apply(this,arguments)})},{key:"signString",value:(_=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee5(o){var s,m,_,S,E,A,O,H,K,z,G=arguments;return _regeneratorRuntime$1().wrap((function _callee5$(q){for(;;)switch(q.prev=q.next){case 0:return m=(s=G.length>1&&void 0!==G[1]?G[1]:{}).signingDate,_=void 0===m?new Date:m,S=s.signingRegion,E=s.signingService,q.next=3,this.credentialProvider();case 3:if(A=q.sent,this.validateResolvedCredentials(A),null==S){q.next=9;break}q.t0=S,q.next=12;break;case 9:return q.next=11,this.regionProvider();case 11:q.t0=q.sent;case 12:return O=q.t0,H=eR(_),K=H.shortDate,q.t1=this.sha256,q.next=17,this.getSigningKey(A,O,K,E);case 17:return q.t2=q.sent,(z=new q.t1(q.t2)).update(_D(o)),q.t3=toHex,q.next=23,z.digest();case 23:return q.t4=q.sent,q.abrupt("return",(0,q.t3)(q.t4));case 25:case"end":return q.stop()}}),_callee5,this)}))),function signString(o){return _.apply(this,arguments)})},{key:"signRequest",value:(m=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee6(o){var s,m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e=arguments;return _regeneratorRuntime$1().wrap((function _callee6$(Se){for(;;)switch(Se.prev=Se.next){case 0:return m=(s=_e.length>1&&void 0!==_e[1]?_e[1]:{}).signingDate,_=void 0===m?new Date:m,S=s.signableHeaders,E=s.unsignableHeaders,A=s.signingRegion,O=s.signingService,Se.next=3,this.credentialProvider();case 3:if(H=Se.sent,this.validateResolvedCredentials(H),null==A){Se.next=9;break}Se.t0=A,Se.next=12;break;case 9:return Se.next=11,this.regionProvider();case 11:Se.t0=Se.sent;case 12:return K=Se.t0,z=QD(o),G=eR(_),q=G.longDate,X=G.shortDate,J=UD(X,K,null!=O?O:this.service),z.headers[wD]=q,H.sessionToken&&(z.headers[AD]=H.sessionToken),Se.next=20,zD(z,this.sha256);case 20:return ae=Se.sent,!WD(ID,z.headers)&&this.applyChecksum&&(z.headers[ID]=ae),pe=$D(z,E,S),Se.next=25,this.getSignature(q,J,this.getSigningKey(H,K,X,O),this.createCanonicalRequest(z,pe,ae));case 25:return me=Se.sent,z.headers[CD]="".concat(RD," ")+"Credential=".concat(H.accessKeyId,"/").concat(J,", ")+"SignedHeaders=".concat(tR(pe),", ")+"Signature=".concat(me),Se.abrupt("return",z);case 28:case"end":return Se.stop()}}),_callee6,this)}))),function signRequest(o){return m.apply(this,arguments)})},{key:"createCanonicalRequest",value:function createCanonicalRequest(o,s,m){var _=Object.keys(s).sort();return"".concat(o.method,"\n").concat(this.getCanonicalPath(o),"\n").concat(function getCanonicalQuery(o){var s,m=o.query,_=void 0===m?{}:m,S=[],E={},A=_createForOfIteratorHelper(Object.keys(_).sort());try{var O=function _loop(){var o=s.value;if(o.toLowerCase()===ED)return"continue";S.push(o);var m=_[o];"string"==typeof m?E[o]="".concat(VD(o),"=").concat(VD(m)):Array.isArray(m)&&(E[o]=m.slice(0).reduce((function(s,m){return s.concat(["".concat(VD(o),"=").concat(VD(m))])}),[]).sort().join("&"))};for(A.s();!(s=A.n()).done;)O()}catch(o){A.e(o)}finally{A.f()}return S.map((function(o){return E[o]})).filter((function(o){return o})).join("&")}(o),"\n").concat(_.map((function(o){return"".concat(o,":").concat(s[o])})).join("\n"),"\n\n").concat(_.join(";"),"\n").concat(m)}},{key:"createStringToSign",value:(s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee7(o,s,m){var _,S;return _regeneratorRuntime$1().wrap((function _callee7$(E){for(;;)switch(E.prev=E.next){case 0:return(_=new this.sha256).update(_D(m)),E.next=4,_.digest();case 4:return S=E.sent,E.abrupt("return","".concat(RD,"\n").concat(o,"\n").concat(s,"\n").concat(toHex(S)));case 6:case"end":return E.stop()}}),_callee7,this)}))),function createStringToSign(o,m,_){return s.apply(this,arguments)})},{key:"getCanonicalPath",value:function getCanonicalPath(o){var s=o.path;if(this.uriEscapePath){var m,_=[],S=_createForOfIteratorHelper(s.split("/"));try{for(S.s();!(m=S.n()).done;){var E=m.value;0!==(null==E?void 0:E.length)&&("."!==E&&(".."===E?_.pop():_.push(E)))}}catch(o){S.e(o)}finally{S.f()}var A="".concat(null!=s&&s.startsWith("/")?"/":"").concat(_.join("/")).concat(_.length>0&&null!=s&&s.endsWith("/")?"/":"");return encodeURIComponent(A).replace(/%2F/g,"/")}return s}},{key:"getSignature",value:(o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee8(o,s,m,_){var S,E;return _regeneratorRuntime$1().wrap((function _callee8$(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.createStringToSign(o,s,_);case 2:return S=A.sent,A.t0=this.sha256,A.next=6,m;case 6:return A.t1=A.sent,(E=new A.t0(A.t1)).update(_D(S)),A.t2=toHex,A.next=12,E.digest();case 12:return A.t3=A.sent,A.abrupt("return",(0,A.t2)(A.t3));case 14:case"end":return A.stop()}}),_callee8,this)}))),function getSignature(s,m,_,S){return o.apply(this,arguments)})},{key:"getSigningKey",value:function getSigningKey$1(o,s,m,_){return BD(this.sha256,o,m,s,_||this.service)}},{key:"validateResolvedCredentials",value:function validateResolvedCredentials(o){if("object"!=typeof o||"string"!=typeof o.accessKeyId||"string"!=typeof o.secretAccessKey)throw new Error("Resolved credential object is not valid")}}]),SignatureV4}(),eR=function formatDate(o){var s=function iso8601(o){return JD(o).toISOString().replace(/\.\d{3}Z$/,"Z")}(o).replace(/[\-:]/g,"");return{longDate:s,shortDate:s.slice(0,8)}},tR=function getCanonicalHeaderList(o){return Object.keys(o).sort().join(";")},nR=function normalizeCredentialProvider(o){return"function"==typeof o?NL(o,(function(o){return void 0!==o.expiration&&o.expiration.getTime()-Date.now()<3e5}),(function(o){return void 0!==o.expiration})):yD(o)},rR=function getSkewCorrectedDate(o){return new Date(Date.now()+o)},iR=function getUpdatedSystemClockOffset(o,s){var m=Date.parse(o);return function isClockSkewed(o,s){return Math.abs(rR(s).getTime()-o)>=3e5}(m,s)?m-Date.now():s},aR=function getDateHeader(o){var s,m,_;return IL.isInstance(o)?null!==(s=null===(m=o.headers)||void 0===m?void 0:m.date)&&void 0!==s?s:null===(_=o.headers)||void 0===_?void 0:_.Date:void 0},oR={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},sR=function getAwsAuthPlugin(o){return{applyToStack:function applyToStack(s){s.addRelativeTo(function awsAuthMiddleware(o){return function(s,m){return function(){var _=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(_){var S,E,A,O,H,K,z,G,q;return _regeneratorRuntime$1().wrap((function _callee$(X){for(;;)switch(X.prev=X.next){case 0:if(EL.isInstance(_.request)){X.next=2;break}return X.abrupt("return",s(_));case 2:return H=null===(S=m.endpointV2)||void 0===S||null===(E=S.properties)||void 0===E||null===(A=E.authSchemes)||void 0===A?void 0:A[0],K="sigv4a"===(null==H?void 0:H.name)?null==H||null===(O=H.signingRegionSet)||void 0===O?void 0:O.join(","):void 0,X.next=6,o.signer(H);case 6:return z=X.sent,X.t0=s,X.t1=_objectSpread2,X.t2=_objectSpread2({},_),X.t3={},X.next=13,z.sign(_.request,{signingDate:rR(o.systemClockOffset),signingRegion:K||m.signing_region,signingService:m.signing_service});case 13:return X.t4=X.sent,X.t5={request:X.t4},X.t6=(0,X.t1)(X.t2,X.t3,X.t5),X.next=18,(0,X.t0)(X.t6).catch((function(s){var m,_=null!==(m=s.ServerTime)&&void 0!==m?m:aR(s.$response);throw _&&(o.systemClockOffset=iR(_,o.systemClockOffset)),s}));case 18:return G=X.sent,(q=aR(G.response))&&(o.systemClockOffset=iR(q,o.systemClockOffset)),X.abrupt("return",G);case 22:case"end":return X.stop()}}),_callee)})));return function(o){return _.apply(this,arguments)}}()}}(o),oR)}}};var uR={partitions:[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{}}],version:"1.1"},lR=uR,cR="",dR=function setPartitionInfo(o){lR=o,cR=arguments.length>1&&void 0!==arguments[1]?arguments[1]:""},hR=function getUserAgentPrefix(){return cR},pR=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),fR=function isIpAddress(o){return pR.test(o)||o.startsWith("[")&&o.endsWith("]")},gR="endpoints";function toDebugString(o){return"object"!=typeof o||null==o?o:"ref"in o?"$".concat(toDebugString(o.ref)):"fn"in o?"".concat(o.fn,"(").concat((o.argv||[]).map(toDebugString).join(", "),")"):JSON.stringify(o,null,2)}var mR,yR,vR=function(o){_inherits$1(EndpointError,o);var s=_createSuper$1(EndpointError);function EndpointError(o){var m;return _classCallCheck$1(this,EndpointError),(m=s.call(this,o)).name="EndpointError",m}return _createClass$1(EndpointError)}(_wrapNativeSuper(Error)),_R=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),bR=function isValidHostLabel(o){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return _R.test(o);var s,m=_createForOfIteratorHelper(o.split("."));try{for(m.s();!(s=m.n()).done;){if(!isValidHostLabel(s.value))return!1}}catch(o){m.e(o)}finally{m.f()}return!0},SR=Object.freeze({__proto__:null,isVirtualHostableS3Bucket:function isVirtualHostableS3Bucket(o){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){var s,m=_createForOfIteratorHelper(o.split("."));try{for(m.s();!(s=m.n()).done;){if(!isVirtualHostableS3Bucket(s.value))return!1}}catch(o){m.e(o)}finally{m.f()}return!0}return!!bR(o)&&(!(o.length<3||o.length>63)&&(o===o.toLowerCase()&&!fR(o)))},parseArn:function parseArn(o){var s=o.split(":");if(s.length<6)return null;var m=_toArray(s),_=m[0],S=m[1],E=m[2],A=m[3],O=m[4],H=m.slice(5);return"arn"!==_||""===S||""===E||""===H[0]?null:{partition:S,service:E,region:A,accountId:O,resourceId:H[0].includes("/")?H[0].split("/"):H}},partition:function partition(o){var s,m=lR.partitions,_=_createForOfIteratorHelper(m);try{for(_.s();!(s=_.n()).done;)for(var S=s.value,E=S.regions,A=S.outputs,O=0,H=Object.entries(E);O<H.length;O++){var K=_slicedToArray$1(H[O],2),z=K[0],G=K[1];if(z===o)return _objectSpread2(_objectSpread2({},A),G)}}catch(o){_.e(o)}finally{_.f()}var q,X=_createForOfIteratorHelper(m);try{for(X.s();!(q=X.n()).done;){var J=q.value,ae=J.regionRegex,pe=J.outputs;if(new RegExp(ae).test(o))return _objectSpread2({},pe)}}catch(o){X.e(o)}finally{X.f()}var me=m.find((function(o){return"aws"===o.id}));if(!me)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return _objectSpread2({},me.outputs)},setPartitionInfo:dR,useDefaultPartitionInfo:function useDefaultPartitionInfo(){dR(uR,"")},getUserAgentPrefix:hR}),TR=function getAttr(o,s){return function getAttrPathList(o){var s,m=[],_=_createForOfIteratorHelper(o.split("."));try{for(_.s();!(s=_.n()).done;){var S=s.value,E=S.indexOf("[");if(-1!==E){if(S.indexOf("]")!==S.length-1)throw new vR("Path: '".concat(o,"' does not end with ']'"));var A=S.slice(E+1,-1);if(Number.isNaN(parseInt(A)))throw new vR("Invalid array index: '".concat(A,"' in path: '").concat(o,"'"));0!==E&&m.push(S.slice(0,E)),m.push(A)}else m.push(S)}}catch(o){_.e(o)}finally{_.f()}return m}(s).reduce((function(m,_){if("object"!=typeof m)throw new vR("Index '".concat(_,"' in '").concat(s,"' not found in '").concat(JSON.stringify(o),"'"));return Array.isArray(m)?m[parseInt(_)]:m[_]}),o)};!function(o){o.AAAA="AAAA",o.A="A"}(mR||(mR={}));var kR,CR=(_defineProperty$2(yR={},hL.HTTP,80),_defineProperty$2(yR,hL.HTTPS,443),yR),wR=Object.freeze({__proto__:null,aws:SR,booleanEquals:function booleanEquals(o,s){return o===s},getAttr:TR,isSet:function isSet(o){return null!=o},isValidHostLabel:bR,not:function not(o){return!o},parseURL:function parseURL(o){var s=function(){try{if(o instanceof URL)return o;if("object"==typeof o&&"hostname"in o){var s=o.hostname,m=o.port,_=o.protocol,S=void 0===_?"":_,E=o.path,A=void 0===E?"":E,O=o.query,H=void 0===O?{}:O,K=new URL("".concat(S,"//").concat(s).concat(m?":".concat(m):"").concat(A));return K.search=Object.entries(H).map((function(o){var s=_slicedToArray$1(o,2),m=s[0],_=s[1];return"".concat(m,"=").concat(_)})).join("&"),K}return new URL(o)}catch(o){return null}}();if(!s)return console.error("Unable to parse ".concat(JSON.stringify(o)," as a whatwg URL.")),null;var m=s.href,_=s.host,S=s.hostname,E=s.pathname,A=s.protocol;if(s.search)return null;var O=A.slice(0,-1);if(!Object.values(hL).includes(O))return null;var H=fR(S),K=m.includes("".concat(_,":").concat(CR[O]))||"string"==typeof o&&o.includes("".concat(_,":").concat(CR[O]));return{scheme:O,authority:"".concat(_).concat(K?":".concat(CR[O]):""),path:E,normalizedPath:E.endsWith("/")?E:"".concat(E,"/"),isIp:H}},stringEquals:function stringEquals(o,s){return o===s},substring:function substring(o,s,m,_){return s>=m||o.length<m?null:_?o.substring(o.length-m,o.length-s):o.substring(s,m)},uriEncode:function uriEncode(o){return encodeURIComponent(o).replace(/[!*'()]/g,(function(o){return"%".concat(o.charCodeAt(0).toString(16).toUpperCase())}))}}),xR=function evaluateTemplate(o,s){for(var m=[],_=_objectSpread2(_objectSpread2({},s.endpointParams),s.referenceRecord),S=0;S<o.length;){var E=o.indexOf("{",S);if(-1===E){m.push(o.slice(S));break}m.push(o.slice(S,E));var A=o.indexOf("}",E);if(-1===A){m.push(o.slice(E));break}"{"===o[E+1]&&"}"===o[A+1]&&(m.push(o.slice(E+1,A)),S=A+2);var O=o.substring(E+1,A);if(O.includes("#")){var H=_slicedToArray$1(O.split("#"),2),K=H[0],z=H[1];m.push(TR(_[K],z))}else m.push(_[O]);S=A+1}return m.join("")},ER=function evaluateExpression(o,s,m){if("string"==typeof o)return xR(o,m);if(o.fn)return IR(o,m);if(o.ref)return function getReferenceValue(o,s){var m=o.ref;return _objectSpread2(_objectSpread2({},s.endpointParams),s.referenceRecord)[m]}(o,m);throw new vR("'".concat(s,"': ").concat(String(o)," is not a string, function or reference."))},IR=function callFunction(o,s){var m=o.fn,_=o.argv.map((function(o){return["boolean","number"].includes(typeof o)?o:ER(o,"arg",s)}));return m.split(".").reduce((function(o,s){return o[s]}),wR).apply(void 0,_toConsumableArray$1(_))},AR=["assign"],PR=function evaluateCondition(o,s){var m,_,S=o.assign,E=_objectWithoutProperties(o,AR);if(S&&S in s.referenceRecord)throw new vR("'".concat(S,"' is already defined in Reference Record."));var A=IR(E,s);return null===(m=s.logger)||void 0===m||null===(_=m.debug)||void 0===_||_.call(m,gR,"evaluateCondition: ".concat(toDebugString(E)," = ").concat(toDebugString(A))),_objectSpread2({result:""===A||!!A},null!=S&&{toAssign:{name:S,value:A}})},LR=function evaluateConditions(){var o,s=arguments.length>1?arguments[1]:void 0,m={},_=_createForOfIteratorHelper(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);try{for(_.s();!(o=_.n()).done;){var S,E,A,O=o.value,H=PR(O,_objectSpread2(_objectSpread2({},s),{},{referenceRecord:_objectSpread2(_objectSpread2({},s.referenceRecord),m)})),K=H.result,z=H.toAssign;if(!K)return{result:K};if(z)m[z.name]=z.value,null===(S=s.logger)||void 0===S||null===(E=(A=S).debug)||void 0===E||E.call(A,gR,"assign: ".concat(z.name," := ").concat(toDebugString(z.value)))}}catch(o){_.e(o)}finally{_.f()}return{result:!0,referenceRecord:m}},DR=function getEndpointHeaders(o,s){return Object.entries(o).reduce((function(o,m){var _=_slicedToArray$1(m,2),S=_[0],E=_[1];return _objectSpread2(_objectSpread2({},o),{},_defineProperty$2({},S,E.map((function(o){var m=ER(o,"Header value entry",s);if("string"!=typeof m)throw new vR("Header '".concat(S,"' value '").concat(m,"' is not a string"));return m}))))}),{})},RR=function getEndpointProperty(o,s){if(Array.isArray(o))return o.map((function(o){return getEndpointProperty(o,s)}));switch(typeof o){case"string":return xR(o,s);case"object":if(null===o)throw new vR("Unexpected endpoint property: ".concat(o));return OR(o,s);case"boolean":return o;default:throw new vR("Unexpected endpoint property type: ".concat(typeof o))}},OR=function getEndpointProperties(o,s){return Object.entries(o).reduce((function(o,m){var _=_slicedToArray$1(m,2),S=_[0],E=_[1];return _objectSpread2(_objectSpread2({},o),{},_defineProperty$2({},S,RR(E,s)))}),{})},MR=function getEndpointUrl(o,s){var m=ER(o,"Endpoint URL",s);if("string"==typeof m)try{return new URL(m)}catch(o){throw console.error("Failed to construct URL with ".concat(m),o),o}throw new vR("Endpoint URL must be a string, got ".concat(typeof m))},FR=function evaluateEndpointRule(o,s){var m,_,S=o.conditions,E=o.endpoint,A=LR(S,s),O=A.result,H=A.referenceRecord;if(O){var K=_objectSpread2(_objectSpread2({},s),{},{referenceRecord:_objectSpread2(_objectSpread2({},s.referenceRecord),H)}),z=E.url,G=E.properties,q=E.headers;return null===(m=s.logger)||void 0===m||null===(_=m.debug)||void 0===_||_.call(m,gR,"Resolving endpoint from template: ".concat(toDebugString(E))),_objectSpread2(_objectSpread2(_objectSpread2({},null!=q&&{headers:DR(q,K)}),null!=G&&{properties:OR(G,K)}),{},{url:MR(z,K)})}},NR=function evaluateErrorRule(o,s){var m=o.conditions,_=o.error,S=LR(m,s),E=S.result,A=S.referenceRecord;if(E)throw new vR(ER(_,"Error",_objectSpread2(_objectSpread2({},s),{},{referenceRecord:_objectSpread2(_objectSpread2({},s.referenceRecord),A)})))},UR=function evaluateTreeRule(o,s){var m=o.conditions,_=o.rules,S=LR(m,s),E=S.result,A=S.referenceRecord;if(E)return BR(_,_objectSpread2(_objectSpread2({},s),{},{referenceRecord:_objectSpread2(_objectSpread2({},s.referenceRecord),A)}))},BR=function evaluateRules(o,s){var m,_=_createForOfIteratorHelper(o);try{for(_.s();!(m=_.n()).done;){var S=m.value;if("endpoint"===S.type){var E=FR(S,s);if(E)return E}else if("error"===S.type)NR(S,s);else{if("tree"!==S.type)throw new vR("Unknown endpoint rule: ".concat(S));var A=UR(S,s);if(A)return A}}}catch(o){_.e(o)}finally{_.f()}throw new vR("Rules evaluation failed")},jR="user-agent",$R="x-amz-user-agent",VR=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,HR=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,KR=function escapeUserAgent(o){var s,m=o[0].split("/").map((function(o){return o.replace(VR,"-")})).join("/"),_=null===(s=o[1])||void 0===s?void 0:s.replace(HR,"-"),S=m.indexOf("/"),E=m.substring(0,S),A=m.substring(S+1);return"api"===E&&(A=A.toLowerCase()),[E,A,_].filter((function(o){return o&&o.length>0})).reduce((function(o,s,m){switch(m){case 0:return s;case 1:return"".concat(o,"/").concat(s);default:return"".concat(o,"#").concat(s)}}),"")},zR={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},WR=function getUserAgentPlugin(o){return{applyToStack:function applyToStack(s){s.add(function userAgentMiddleware(o){return function(s,m){return function(){var _=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(_){var S,E,A,O,H,K,z,G,q,X;return _regeneratorRuntime$1().wrap((function _callee$(J){for(;;)switch(J.prev=J.next){case 0:if(A=_.request,EL.isInstance(A)){J.next=3;break}return J.abrupt("return",s(_));case 3:return O=A.headers,H=(null==m||null===(S=m.userAgent)||void 0===S?void 0:S.map(KR))||[],J.next=7,o.defaultUserAgentProvider();case 7:return K=J.sent.map(KR),z=(null==o||null===(E=o.customUserAgent)||void 0===E?void 0:E.map(KR))||[],G=hR(),q=(G?[G]:[]).concat([].concat(_toConsumableArray$1(K),_toConsumableArray$1(H),_toConsumableArray$1(z))).join(" "),X=[].concat(_toConsumableArray$1(K.filter((function(o){return o.startsWith("aws-sdk-")}))),_toConsumableArray$1(z)).join(" "),"browser"!==o.runtime?(X&&(O[$R]=O[$R]?"".concat(O[jR]," ").concat(X):X),O[jR]=q):O[$R]=q,J.abrupt("return",s(_objectSpread2(_objectSpread2({},_),{},{request:A})));case 14:case"end":return J.stop()}}),_callee)})));return function(o){return _.apply(this,arguments)}}()}}(o),zR)}}};!function(o){o.ENV="env",o.CONFIG="shared config entry"}(kR||(kR={}));var GR=function isFipsRegion(o){return"string"==typeof o&&(o.startsWith("fips-")||o.endsWith("-fips"))},qR=function getRealRegion(o){return GR(o)?["fips-aws-global","aws-fips"].includes(o)?"us-east-1":o.replace(/fips-(dkr-|prod-)?|-fips/,""):o},XR="content-length";var YR={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},QR=function getContentLengthPlugin(o){return{applyToStack:function applyToStack(s){s.add(function contentLengthMiddleware(o){return function(s){return function(){var m=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(m){var _,S,E,A;return _regeneratorRuntime$1().wrap((function _callee$(O){for(;;)switch(O.prev=O.next){case 0:if(_=m.request,EL.isInstance(_)&&(S=_.body,E=_.headers,S&&-1===Object.keys(E).map((function(o){return o.toLowerCase()})).indexOf(XR)))try{A=o(S),_.headers=_objectSpread2(_objectSpread2({},_.headers),{},_defineProperty$2({},XR,String(A)))}catch(o){}return O.abrupt("return",s(_objectSpread2(_objectSpread2({},m),{},{request:_})));case 3:case"end":return O.stop()}}),_callee)})));return function(o){return m.apply(this,arguments)}}()}}(o.bodyLengthChecker),YR)}}},JR=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){var s;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if(s=(null==o?void 0:o.Bucket)||"","string"==typeof o.Bucket&&(o.Bucket=s.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),!rO(s)){m.next=7;break}if(!0!==o.ForcePathStyle){m.next=5;break}throw new Error("Path-style addressing cannot be used with ARN buckets");case 5:m.next=8;break;case 7:(!nO(s)||-1!==s.indexOf(".")&&!String(o.Endpoint).startsWith("http:")||s.toLowerCase()!==s||s.length<3)&&(o.ForcePathStyle=!0);case 8:return o.DisableMultiRegionAccessPoints&&(o.disableMultiRegionAccessPoints=!0,o.DisableMRAP=!0),m.abrupt("return",o);case 10:case"end":return m.stop()}}),_callee)})));return function resolveParamsForS3(s){return o.apply(this,arguments)}}(),ZR=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,eO=/(\d+\.){3}\d+/,tO=/\.\./,nO=function isDnsCompatibleBucketName(o){return ZR.test(o)&&!eO.test(o)&&!tO.test(o)},rO=function isArnBucketName(o){var s=_slicedToArray$1(o.split(":"),6),m=s[0],_=s[1],S=s[2];s[3];var E=s[4],A=s[5],O="arn"===m&&o.split(":").length>=6,H=5===[m,_,S,E,A].filter(Boolean).length;if(O&&!H)throw new Error("Invalid ARN: ".concat(o," was an invalid ARN."));return!!("arn"===m&&_&&S&&E&&A)},iO=function createConfigValueProvider(o,s,m){var _=function(){var _=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){var _,S;return _regeneratorRuntime$1().wrap((function _callee$(E){for(;;)switch(E.prev=E.next){case 0:if("function"!=typeof(S=null!==(_=m[o])&&void 0!==_?_:m[s])){E.next=3;break}return E.abrupt("return",S());case 3:return E.abrupt("return",S);case 4:case"end":return E.stop()}}),_callee)})));return function configProvider(){return _.apply(this,arguments)}}();return"endpoint"===o||"endpoint"===s?_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(){var o,s,m,S,E;return _regeneratorRuntime$1().wrap((function _callee2$(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,_();case 2:if(!(o=A.sent)||"object"!=typeof o){A.next=9;break}if(!("url"in o)){A.next=6;break}return A.abrupt("return",o.url.href);case 6:if(!("hostname"in o)){A.next=9;break}return s=o.protocol,m=o.hostname,S=o.port,E=o.path,A.abrupt("return","".concat(s,"//").concat(m).concat(S?":"+S:"").concat(E));case 9:return A.abrupt("return",o);case 10:case"end":return A.stop()}}),_callee2)}))):_},aO=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",void 0);case 1:case"end":return o.stop()}}),_callee)})));return function getEndpointFromConfig(s){return o.apply(this,arguments)}}();var oO=function parseUrl(o){if("string"==typeof o)return parseUrl(new URL(o));var s,m=o.hostname,_=o.pathname,S=o.port,E=o.protocol,A=o.search;return A&&(s=function parseQueryString(o){var s={};if(o=o.replace(/^\?/,"")){var m,_=_createForOfIteratorHelper(o.split("&"));try{for(_.s();!(m=_.n()).done;){var S=_slicedToArray$1(m.value.split("="),2),E=S[0],A=S[1],O=void 0===A?null:A;E=decodeURIComponent(E),O&&(O=decodeURIComponent(O)),E in s?Array.isArray(s[E])?s[E].push(O):s[E]=[s[E],O]:s[E]=O}}catch(o){_.e(o)}finally{_.f()}}return s}(A)),{hostname:m,port:S?parseInt(S):void 0,protocol:E,path:_,query:s}},sO=function toEndpointV1(o){return"object"==typeof o?"url"in o?oO(o.url):o:oO(o)},uO=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o,s,m,_){var S,E,A;return _regeneratorRuntime$1().wrap((function _callee$(O){for(;;)switch(O.prev=O.next){case 0:if(m.endpoint){O.next=5;break}return O.next=3,aO(m.serviceId||"");case 3:(S=O.sent)&&(m.endpoint=function(){return Promise.resolve(sO(S))});case 5:return O.next=7,lO(o,s,m);case 7:if(E=O.sent,"function"==typeof m.endpointProvider){O.next=10;break}throw new Error("config.endpointProvider is not set.");case 10:return A=m.endpointProvider(E,_),O.abrupt("return",A);case 12:case"end":return O.stop()}}),_callee)})));return function getEndpointFromInstructions(s,m,_,S){return o.apply(this,arguments)}}(),lO=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o,s,m){var _,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee2$(G){for(;;)switch(G.prev=G.next){case 0:S={},E=(null==s||null===(_=s.getEndpointParameterInstructions)||void 0===_?void 0:_.call(s))||{},A=0,O=Object.entries(E);case 3:if(!(A<O.length)){G.next=20;break}H=_slicedToArray$1(O[A],2),K=H[0],z=H[1],G.t0=z.type,G.next="staticContextParams"===G.t0?8:"contextParams"===G.t0?10:"clientContextParams"===G.t0||"builtInParams"===G.t0?12:16;break;case 8:return S[K]=z.value,G.abrupt("break",17);case 10:return S[K]=o[z.name],G.abrupt("break",17);case 12:return G.next=14,iO(z.name,K,m)();case 14:return S[K]=G.sent,G.abrupt("break",17);case 16:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(z));case 17:A++,G.next=3;break;case 20:if(0===Object.keys(E).length&&Object.assign(S,m),"s3"!==String(m.serviceId).toLowerCase()){G.next=24;break}return G.next=24,JR(S);case 24:return G.abrupt("return",S);case 25:case"end":return G.stop()}}),_callee2)})));return function resolveParams(s,m,_){return o.apply(this,arguments)}}(),cO=function deserializerMiddleware(o,s){return function(m,_){return function(){var _=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(_){var S,E,A;return _regeneratorRuntime$1().wrap((function _callee$(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,m(_);case 2:return S=O.sent,E=S.response,O.prev=4,O.next=7,s(E,o);case 7:return A=O.sent,O.abrupt("return",{response:E,output:A});case 11:throw O.prev=11,O.t0=O.catch(4),Object.defineProperty(O.t0,"$response",{value:E}),"$metadata"in O.t0||("Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.",O.t0.message+="\n  Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object."),O.t0;case 16:case"end":return O.stop()}}),_callee,null,[[4,11]])})));return function(o){return _.apply(this,arguments)}}()}},dO=function serializerMiddleware(o,s){return function(m,_){return function(){var S=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(S){var E,A,O;return _regeneratorRuntime$1().wrap((function _callee2$(H){for(;;)switch(H.prev=H.next){case 0:if(A=null!==(E=_.endpointV2)&&void 0!==E&&E.url&&o.urlParser?_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",o.urlParser(_.endpointV2.url));case 1:case"end":return s.stop()}}),_callee)}))):o.endpoint){H.next=3;break}throw new Error("No valid endpoint provider available.");case 3:return H.next=5,s(S.input,_objectSpread2(_objectSpread2({},o),{},{endpoint:A}));case 5:return O=H.sent,H.abrupt("return",m(_objectSpread2(_objectSpread2({},S),{},{request:O})));case 7:case"end":return H.stop()}}),_callee2)})));return function(o){return S.apply(this,arguments)}}()}},hO={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},pO={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function getSerdePlugin(o,s,m){return{applyToStack:function applyToStack(_){_.add(cO(o,m),hO),_.add(dO(o,s),pO)}}}var fO,gO={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:pO.name},mO=function getEndpointPlugin(o,s){return{applyToStack:function applyToStack(m){m.addRelativeTo(function endpointMiddleware(o){var s=o.config,m=o.instructions;return function(o,_){return function(){var S=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(S){var E,A,O,H;return _regeneratorRuntime$1().wrap((function _callee$(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,uO(S.input,{getEndpointParameterInstructions:function getEndpointParameterInstructions(){return m}},_objectSpread2({},s),_);case 2:return O=K.sent,_.endpointV2=O,_.authSchemes=null===(E=O.properties)||void 0===E?void 0:E.authSchemes,(H=null===(A=_.authSchemes)||void 0===A?void 0:A[0])&&(_.signing_region=H.signingRegion,_.signing_service=H.signingName),K.abrupt("return",o(_objectSpread2({},S)));case 8:case"end":return K.stop()}}),_callee)})));return function(o){return S.apply(this,arguments)}}()}}({config:o,instructions:s}),gO)}}};!function(o){o.STANDARD="standard",o.ADAPTIVE="adaptive"}(fO||(fO={}));var yO,vO=fO.STANDARD,_O=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],bO=["TimeoutError","RequestTimeout","RequestTimeoutException"],SO=[500,502,503,504],TO=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],kO=function isThrottlingError(o){var s,m;return 429===(null===(s=o.$metadata)||void 0===s?void 0:s.httpStatusCode)||_O.includes(o.name)||1==(null===(m=o.$retryable)||void 0===m?void 0:m.throttling)},CO=function isTransientError(o){var s;return bO.includes(o.name)||TO.includes((null==o?void 0:o.code)||"")||SO.includes((null===(s=o.$metadata)||void 0===s?void 0:s.httpStatusCode)||0)},wO=function(){function DefaultRateLimiter(o){var s,m,_,S,E;_classCallCheck$1(this,DefaultRateLimiter),this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=null!==(s=null==o?void 0:o.beta)&&void 0!==s?s:.7,this.minCapacity=null!==(m=null==o?void 0:o.minCapacity)&&void 0!==m?m:1,this.minFillRate=null!==(_=null==o?void 0:o.minFillRate)&&void 0!==_?_:.5,this.scaleConstant=null!==(S=null==o?void 0:o.scaleConstant)&&void 0!==S?S:.4,this.smooth=null!==(E=null==o?void 0:o.smooth)&&void 0!==E?E:.8;var A=this.getCurrentTimeInSeconds();this.lastThrottleTime=A,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}var o,s;return _createClass$1(DefaultRateLimiter,[{key:"getCurrentTimeInSeconds",value:function getCurrentTimeInSeconds(){return Date.now()/1e3}},{key:"getSendToken",value:(s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.acquireTokenBucket(1));case 1:case"end":return o.stop()}}),_callee,this)}))),function getSendToken(){return s.apply(this,arguments)})},{key:"acquireTokenBucket",value:(o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o){var s;return _regeneratorRuntime$1().wrap((function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:if(this.enabled){m.next=2;break}return m.abrupt("return");case 2:if(this.refillTokenBucket(),!(o>this.currentCapacity)){m.next=7;break}return s=(o-this.currentCapacity)/this.fillRate*1e3,m.next=7,new Promise((function(o){return setTimeout(o,s)}));case 7:this.currentCapacity=this.currentCapacity-o;case 8:case"end":return m.stop()}}),_callee2,this)}))),function acquireTokenBucket(s){return o.apply(this,arguments)})},{key:"refillTokenBucket",value:function refillTokenBucket(){var o=this.getCurrentTimeInSeconds();if(this.lastTimestamp){var s=(o-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+s),this.lastTimestamp=o}else this.lastTimestamp=o}},{key:"updateClientSendingRate",value:function updateClientSendingRate(o){var s;if(this.updateMeasuredRate(),kO(o)){var m=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=m,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),s=this.cubicThrottle(m),this.enableTokenBucket()}else this.calculateTimeWindow(),s=this.cubicSuccess(this.getCurrentTimeInSeconds());var _=Math.min(s,2*this.measuredTxRate);this.updateTokenBucketRate(_)}},{key:"calculateTimeWindow",value:function calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}},{key:"cubicThrottle",value:function cubicThrottle(o){return this.getPrecise(o*this.beta)}},{key:"cubicSuccess",value:function cubicSuccess(o){return this.getPrecise(this.scaleConstant*Math.pow(o-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}},{key:"enableTokenBucket",value:function enableTokenBucket(){this.enabled=!0}},{key:"updateTokenBucketRate",value:function updateTokenBucketRate(o){this.refillTokenBucket(),this.fillRate=Math.max(o,this.minFillRate),this.maxCapacity=Math.max(o,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}},{key:"updateMeasuredRate",value:function updateMeasuredRate(){var o=this.getCurrentTimeInSeconds(),s=Math.floor(2*o)/2;if(this.requestCount++,s>this.lastTxRateBucket){var m=this.requestCount/(s-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(m*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=s}}},{key:"getPrecise",value:function getPrecise(o){return parseFloat(o.toFixed(8))}}]),DefaultRateLimiter}(),xO=function createDefaultRetryToken(o){var s=o.retryDelay,m=o.retryCount,_=o.retryCost;return{getRetryCount:function getRetryCount(){return m},getRetryDelay:function getRetryDelay(){return Math.min(2e4,s)},getRetryCost:function getRetryCost(){return _}}},EO=function(){function StandardRetryStrategy(o){_classCallCheck$1(this,StandardRetryStrategy),this.maxAttempts=o,this.mode=fO.STANDARD,this.capacity=500,this.retryBackoffStrategy=function getDefaultRetryBackoffStrategy(){var o=100;return{computeNextBackoffDelay:function computeNextBackoffDelay(s){return Math.floor(Math.min(2e4,Math.random()*Math.pow(2,s)*o))},setDelayBase:function setDelayBase(s){o=s}}}(),this.maxAttemptsProvider="function"==typeof o?o:_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",o);case 1:case"end":return s.stop()}}),_callee)})))}var o,s,m;return _createClass$1(StandardRetryStrategy,[{key:"acquireInitialRetryToken",value:(m=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o){return _regeneratorRuntime$1().wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",xO({retryDelay:100,retryCount:0}));case 1:case"end":return o.stop()}}),_callee2)}))),function acquireInitialRetryToken(o){return m.apply(this,arguments)})},{key:"refreshRetryTokenForRetry",value:(s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee3(o,s){var m,_,S,E,A;return _regeneratorRuntime$1().wrap((function _callee3$(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,this.getMaxAttempts();case 2:if(m=O.sent,!this.shouldRetry(o,s,m)){O.next=11;break}return _=s.errorType,this.retryBackoffStrategy.setDelayBase("THROTTLING"===_?500:100),S=this.retryBackoffStrategy.computeNextBackoffDelay(o.getRetryCount()),E=s.retryAfterHint?Math.max(s.retryAfterHint.getTime()-Date.now()||0,S):S,A=this.getCapacityCost(_),this.capacity-=A,O.abrupt("return",xO({retryDelay:E,retryCount:o.getRetryCount()+1,retryCost:A}));case 11:throw new Error("No retry token available");case 12:case"end":return O.stop()}}),_callee3,this)}))),function refreshRetryTokenForRetry(o,m){return s.apply(this,arguments)})},{key:"recordSuccess",value:function recordSuccess(o){var s;this.capacity=Math.max(500,this.capacity+(null!==(s=o.getRetryCost())&&void 0!==s?s:1))}},{key:"getCapacity",value:function getCapacity(){return this.capacity}},{key:"getMaxAttempts",value:(o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,this.maxAttemptsProvider();case 3:return o.abrupt("return",o.sent);case 6:return o.prev=6,o.t0=o.catch(0),console.warn("Max attempts provider could not resolve. Using default of ".concat(3)),o.abrupt("return",3);case 10:case"end":return o.stop()}}),_callee4,this,[[0,6]])}))),function getMaxAttempts(){return o.apply(this,arguments)})},{key:"shouldRetry",value:function shouldRetry(o,s,m){return o.getRetryCount()+1<m&&this.capacity>=this.getCapacityCost(s.errorType)&&this.isRetryableError(s.errorType)}},{key:"getCapacityCost",value:function getCapacityCost(o){return"TRANSIENT"===o?10:5}},{key:"isRetryableError",value:function isRetryableError(o){return"THROTTLING"===o||"TRANSIENT"===o}}]),StandardRetryStrategy}(),IO=function(){function AdaptiveRetryStrategy(o,s){_classCallCheck$1(this,AdaptiveRetryStrategy),this.maxAttemptsProvider=o,this.mode=fO.ADAPTIVE;var m=(null!=s?s:{}).rateLimiter;this.rateLimiter=null!=m?m:new wO,this.standardRetryStrategy=new EO(o)}var o,s;return _createClass$1(AdaptiveRetryStrategy,[{key:"acquireInitialRetryToken",value:(s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.rateLimiter.getSendToken();case 2:return s.abrupt("return",this.standardRetryStrategy.acquireInitialRetryToken(o));case 3:case"end":return s.stop()}}),_callee,this)}))),function acquireInitialRetryToken(o){return s.apply(this,arguments)})},{key:"refreshRetryTokenForRetry",value:(o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o,s){return _regeneratorRuntime$1().wrap((function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:return this.rateLimiter.updateClientSendingRate(s),m.abrupt("return",this.standardRetryStrategy.refreshRetryTokenForRetry(o,s));case 2:case"end":return m.stop()}}),_callee2,this)}))),function refreshRetryTokenForRetry(s,m){return o.apply(this,arguments)})},{key:"recordSuccess",value:function recordSuccess(o){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(o)}}]),AdaptiveRetryStrategy}(),AO=new Uint8Array(16);function rng(){if(!yO&&!(yO="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return yO(AO)}var PO=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var LO=[],DO=0;DO<256;++DO)LO.push((DO+256).toString(16).substr(1));function stringify(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,m=(LO[o[s+0]]+LO[o[s+1]]+LO[o[s+2]]+LO[o[s+3]]+"-"+LO[o[s+4]]+LO[o[s+5]]+"-"+LO[o[s+6]]+LO[o[s+7]]+"-"+LO[o[s+8]]+LO[o[s+9]]+"-"+LO[o[s+10]]+LO[o[s+11]]+LO[o[s+12]]+LO[o[s+13]]+LO[o[s+14]]+LO[o[s+15]]).toLowerCase();if(!function validate(o){return"string"==typeof o&&PO.test(o)}(m))throw TypeError("Stringified UUID is invalid");return m}function v4(o,s,m){var _=(o=o||{}).random||(o.rng||rng)();if(_[6]=15&_[6]|64,_[8]=63&_[8]|128,s){m=m||0;for(var S=0;S<16;++S)s[m+S]=_[S];return s}return stringify(_)}for(var RO=function asSdkError(o){return o instanceof Error?o:o instanceof Object?Object.assign(new Error,o):"string"==typeof o?new Error(o):new Error("AWS SDK error wrapper for ".concat(o))},OO=function isRetryStrategyV2(o){return void 0!==o.acquireInitialRetryToken&&void 0!==o.refreshRetryTokenForRetry&&void 0!==o.recordSuccess},MO=function getRetryErrorInfo(o){var s={errorType:FO(o)},m=BO(o.$response);return m&&(s.retryAfterHint=m),s},FO=function getRetryErrorType(o){return kO(o)?"THROTTLING":CO(o)?"TRANSIENT":function isServerError(o){var s;if(void 0!==(null===(s=o.$metadata)||void 0===s?void 0:s.httpStatusCode)){var m=o.$metadata.httpStatusCode;return 500<=m&&m<=599&&!CO(o)}return!1}(o)?"SERVER_ERROR":"CLIENT_ERROR"},NO={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},UO=function getRetryPlugin(o){return{applyToStack:function applyToStack(s){s.add(function retryMiddleware(o){return function(s,m){return function(){var _=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(_){var S,E,A,O,H,K,z,G,q,X;return _regeneratorRuntime$1().wrap((function _callee$(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,o.retryStrategy();case 2:return S=J.sent,J.next=5,o.maxAttempts();case 5:if(E=J.sent,!OO(S)){J.next=26;break}return J.next=10,S.acquireInitialRetryToken(m.partition_id);case 10:A=J.sent,O=new Error,H=0,K=0,z=_.request,EL.isInstance(z)&&(z.headers["amz-sdk-invocation-id"]=v4()),G=_regeneratorRuntime$1().mark((function _loop(){var o,m,G,q,X;return _regeneratorRuntime$1().wrap((function _loop$(J){for(;;)switch(J.prev=J.next){case 0:return J.prev=0,EL.isInstance(z)&&(z.headers["amz-sdk-request"]="attempt=".concat(H+1,"; max=").concat(E)),J.next=4,s(_);case 4:return o=J.sent,m=o.response,G=o.output,S.recordSuccess(A),G.$metadata.attempts=H+1,G.$metadata.totalRetryDelay=K,J.abrupt("return",{v:{response:m,output:G}});case 13:return J.prev=13,J.t0=J.catch(0),q=MO(J.t0),O=RO(J.t0),J.prev=17,J.next=20,S.refreshRetryTokenForRetry(A,q);case 20:A=J.sent,J.next=29;break;case 23:throw J.prev=23,J.t1=J.catch(17),O.$metadata||(O.$metadata={}),O.$metadata.attempts=H+1,O.$metadata.totalRetryDelay=K,O;case 29:return H=A.getRetryCount(),X=A.getRetryDelay(),K+=X,J.next=34,new Promise((function(o){return setTimeout(o,X)}));case 34:case"end":return J.stop()}}),_loop,null,[[0,13],[17,23]])}));case 17:return J.delegateYield(G(),"t0",19);case 19:if("object"!=typeof(q=J.t0)){J.next=22;break}return J.abrupt("return",q.v);case 22:J.next=17;break;case 24:J.next=29;break;case 26:return null!==(X=S)&&void 0!==X&&X.mode&&(m.userAgent=[].concat(_toConsumableArray$1(m.userAgent||[]),[["cfg/retry-mode",S.mode]])),J.abrupt("return",S.retry(s,_));case 29:case"end":return J.stop()}}),_callee)})));return function(o){return _.apply(this,arguments)}}()}}(o),NO)}}},BO=function getRetryAfterHint(o){if(IL.isInstance(o)){var s=Object.keys(o.headers).find((function(o){return"retry-after"===o.toLowerCase()}));if(s){var m=o.headers[s],_=Number(m);return Number.isNaN(_)?new Date(m):new Date(1e3*_)}}},jO=function(){function NoOpLogger(){_classCallCheck$1(this,NoOpLogger)}return _createClass$1(NoOpLogger,[{key:"trace",value:function trace(){}},{key:"debug",value:function debug(){}},{key:"info",value:function info(){}},{key:"warn",value:function warn(){}},{key:"error",value:function error(){}}]),NoOpLogger}(),$O=function getAllAliases(o,s){var m=[];if(o&&m.push(o),s){var _,S=_createForOfIteratorHelper(s);try{for(S.s();!(_=S.n()).done;){var E=_.value;m.push(E)}}catch(o){S.e(o)}finally{S.f()}}return m},VO=function getMiddlewareNameWithAliases(o,s){return"".concat(o||"anonymous").concat(s&&s.length>0?" (a.k.a. ".concat(s.join(","),")"):"")},HO=function constructStack(){var o=[],s=[],m=!1,_=new Set,S=function cloneTo(m){var _;return o.forEach((function(o){m.add(o.middleware,_objectSpread2({},o))})),s.forEach((function(o){m.addRelativeTo(o.middleware,_objectSpread2({},o))})),null===(_=m.identifyOnResolve)||void 0===_||_.call(m,O.identifyOnResolve()),m},E=function expandRelativeMiddlewareList(o){var s=[];return o.before.forEach((function(o){0===o.before.length&&0===o.after.length?s.push(o):s.push.apply(s,_toConsumableArray$1(expandRelativeMiddlewareList(o)))})),s.push(o),o.after.reverse().forEach((function(o){0===o.before.length&&0===o.after.length?s.push(o):s.push.apply(s,_toConsumableArray$1(expandRelativeMiddlewareList(o)))})),s},A=function getMiddlewareList(){var m=arguments.length>0&&void 0!==arguments[0]&&arguments[0],_=[],S=[],A={};o.forEach((function(o){var s,m=_objectSpread2(_objectSpread2({},o),{},{before:[],after:[]}),S=_createForOfIteratorHelper($O(m.name,m.aliases));try{for(S.s();!(s=S.n()).done;){var E=s.value;A[E]=m}}catch(o){S.e(o)}finally{S.f()}_.push(m)})),s.forEach((function(o){var s,m=_objectSpread2(_objectSpread2({},o),{},{before:[],after:[]}),_=_createForOfIteratorHelper($O(m.name,m.aliases));try{for(_.s();!(s=_.n()).done;){var E=s.value;A[E]=m}}catch(o){_.e(o)}finally{_.f()}S.push(m)})),S.forEach((function(o){if(o.toMiddleware){var s=A[o.toMiddleware];if(void 0===s){if(m)return;throw new Error("".concat(o.toMiddleware," is not found when adding ")+"".concat(VO(o.name,o.aliases)," ")+"middleware ".concat(o.relation," ").concat(o.toMiddleware))}"after"===o.relation&&s.after.push(o),"before"===o.relation&&s.before.push(o)}}));var O=function sort(o){return o.sort((function(o,s){return KO[s.step]-KO[o.step]||zO[s.priority||"normal"]-zO[o.priority||"normal"]}))}(_).map(E).reduce((function(o,s){return o.push.apply(o,_toConsumableArray$1(s)),o}),[]);return O},O={add:function add(s){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},S=m.name,E=m.override,A=m.aliases,O=_objectSpread2({step:"initialize",priority:"normal",middleware:s},m),H=$O(S,A);if(H.length>0){if(H.some((function(o){return _.has(o)}))){if(!E)throw new Error("Duplicate middleware name '".concat(VO(S,A),"'"));var K,z=_createForOfIteratorHelper(H);try{var G=function _loop(){var s=K.value,m=o.findIndex((function(o){var m;return o.name===s||(null===(m=o.aliases)||void 0===m?void 0:m.some((function(o){return o===s})))}));if(-1===m)return"continue";var _=o[m];if(_.step!==O.step||O.priority!==_.priority)throw new Error('"'.concat(VO(_.name,_.aliases),'" middleware with ')+"".concat(_.priority," priority in ").concat(_.step," step cannot ")+'be overridden by "'.concat(VO(S,A),'" middleware with ')+"".concat(O.priority," priority in ").concat(O.step," step."));o.splice(m,1)};for(z.s();!(K=z.n()).done;)G()}catch(o){z.e(o)}finally{z.f()}}var q,X=_createForOfIteratorHelper(H);try{for(X.s();!(q=X.n()).done;){var J=q.value;_.add(J)}}catch(o){X.e(o)}finally{X.f()}}o.push(O)},addRelativeTo:function addRelativeTo(o,m){var S=m.name,E=m.override,A=m.aliases,O=_objectSpread2({middleware:o},m),H=$O(S,A);if(H.length>0){if(H.some((function(o){return _.has(o)}))){if(!E)throw new Error("Duplicate middleware name '".concat(VO(S,A),"'"));var K,z=_createForOfIteratorHelper(H);try{var G=function _loop2(){var o=K.value,m=s.findIndex((function(s){var m;return s.name===o||(null===(m=s.aliases)||void 0===m?void 0:m.some((function(s){return s===o})))}));if(-1===m)return"continue";var _=s[m];if(_.toMiddleware!==O.toMiddleware||_.relation!==O.relation)throw new Error('"'.concat(VO(_.name,_.aliases),'" middleware ')+"".concat(_.relation,' "').concat(_.toMiddleware,'" middleware cannot be overridden ')+'by "'.concat(VO(S,A),'" middleware ').concat(O.relation," ")+'"'.concat(O.toMiddleware,'" middleware.'));s.splice(m,1)};for(z.s();!(K=z.n()).done;)G()}catch(o){z.e(o)}finally{z.f()}}var q,X=_createForOfIteratorHelper(H);try{for(X.s();!(q=X.n()).done;){var J=q.value;_.add(J)}}catch(o){X.e(o)}finally{X.f()}}s.push(O)},clone:function clone(){return S(constructStack())},use:function use(o){o.applyToStack(O)},remove:function remove(m){return"string"==typeof m?function removeByName(m){var S=!1,E=function filterCb(o){var s=$O(o.name,o.aliases);if(s.includes(m)){S=!0;var E,A=_createForOfIteratorHelper(s);try{for(A.s();!(E=A.n()).done;){var O=E.value;_.delete(O)}}catch(o){A.e(o)}finally{A.f()}return!1}return!0};return o=o.filter(E),s=s.filter(E),S}(m):function removeByReference(m){var S=!1,E=function filterCb(o){if(o.middleware===m){S=!0;var s,E=_createForOfIteratorHelper($O(o.name,o.aliases));try{for(E.s();!(s=E.n()).done;){var A=s.value;_.delete(A)}}catch(o){E.e(o)}finally{E.f()}return!1}return!0};return o=o.filter(E),s=s.filter(E),S}(m)},removeByTag:function removeByTag(m){var S=!1,E=function filterCb(o){var s=o.tags,E=o.name,A=o.aliases;if(s&&s.includes(m)){var O,H=_createForOfIteratorHelper($O(E,A));try{for(H.s();!(O=H.n()).done;){var K=O.value;_.delete(K)}}catch(o){H.e(o)}finally{H.f()}return S=!0,!1}return!0};return o=o.filter(E),s=s.filter(E),S},concat:function concat(o){var s,_,E=S(constructStack());return E.use(o),E.identifyOnResolve(m||E.identifyOnResolve()||null!==(s=null===(_=o.identifyOnResolve)||void 0===_?void 0:_.call(o))&&void 0!==s&&s),E},applyToStack:S,identify:function identify(){return A(!0).map((function(o){var s,m=null!==(s=o.step)&&void 0!==s?s:o.relation+" "+o.toMiddleware;return VO(o.name,o.aliases)+" - "+m}))},identifyOnResolve:function identifyOnResolve(o){return"boolean"==typeof o&&(m=o),m},resolve:function resolve(o,s){var _,S=_createForOfIteratorHelper(A().map((function(o){return o.middleware})).reverse());try{for(S.s();!(_=S.n()).done;){o=(0,_.value)(o,s)}}catch(o){S.e(o)}finally{S.f()}return m&&console.log(O.identify()),o}};return O},KO={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},zO={high:3,normal:2,low:1},WO=function(){function Client(o){_classCallCheck$1(this,Client),this.middlewareStack=HO(),this.config=o}return _createClass$1(Client,[{key:"send",value:function send(o,s,m){var _="function"!=typeof s?s:void 0,S="function"==typeof s?s:m,E=o.resolveMiddleware(this.middlewareStack,this.config,_);if(!S)return E(o).then((function(o){return o.output}));E(o).then((function(o){return S(null,o.output)}),(function(o){return S(o)})).catch((function(){}))}},{key:"destroy",value:function destroy(){this.config.requestHandler.destroy&&this.config.requestHandler.destroy()}}]),Client}(),GO={},qO=new Array(64),XO=0,YO="A".charCodeAt(0),QO="Z".charCodeAt(0);XO+YO<=QO;XO++){var JO=String.fromCharCode(XO+YO);GO[JO]=XO,qO[XO]=JO}for(var ZO=0,eM="a".charCodeAt(0),tM="z".charCodeAt(0);ZO+eM<=tM;ZO++){var nM=String.fromCharCode(ZO+eM),rM=ZO+26;GO[nM]=rM,qO[rM]=nM}for(var iM=0;iM<10;iM++){GO[iM.toString(10)]=iM+52;var aM=iM.toString(10),oM=iM+52;GO[aM]=oM,qO[oM]=aM}GO["+"]=62,qO[62]="+",GO["/"]=63,qO[63]="/";var sM=6,uM=8,lM=63,cM=function fromBase64(o){var s=o.length/4*3;"=="===o.slice(-2)?s-=2:"="===o.slice(-1)&&s--;for(var m=new ArrayBuffer(s),_=new DataView(m),S=0;S<o.length;S+=4){for(var E=0,A=0,O=S,H=S+3;O<=H;O++)if("="!==o[O]){if(!(o[O]in GO))throw new TypeError("Invalid character ".concat(o[O]," in base64 string."));E|=GO[o[O]]<<(H-O)*sM,A+=sM}else E>>=sM;var K=S/4*3;E>>=A%uM;for(var z=Math.floor(A/uM),G=0;G<z;G++){var q=(z-G-1)*uM;_.setUint8(K+G,(E&255<<q)>>q)}}return new Uint8Array(m)};function toBase64(o){for(var s="",m=0;m<o.length;m+=3){for(var _=0,S=0,E=m,A=Math.min(m+3,o.length);E<A;E++)_|=o[E]<<(A-E-1)*uM,S+=uM;var O=Math.ceil(S/sM);_<<=O*sM-S;for(var H=1;H<=O;H++){var K=(O-H)*sM;s+=qO[(_&lM<<K)>>K]}s+="==".slice(0,4-O)}return s}function transformFromString(o,s){return"base64"===s?dM.mutate(cM(o)):dM.mutate(vD(o))}var dM=function(o){_inherits$1(Uint8ArrayBlobAdapter,o);var s=_createSuper$1(Uint8ArrayBlobAdapter);function Uint8ArrayBlobAdapter(){return _classCallCheck$1(this,Uint8ArrayBlobAdapter),s.apply(this,arguments)}return _createClass$1(Uint8ArrayBlobAdapter,[{key:"transformToString",value:function transformToString$1(){return function transformToString(o){return"base64"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8")?toBase64(o):bD(o)}(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf-8")}}],[{key:"fromString",value:function fromString(o){if("string"==typeof o)return transformFromString(o,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8");throw new Error("Unsupported conversion from ".concat(typeof o," to Uint8ArrayBlobAdapter."))}},{key:"mutate",value:function mutate(o){return Object.setPrototypeOf(o,Uint8ArrayBlobAdapter.prototype),o}}]),Uint8ArrayBlobAdapter}(_wrapNativeSuper(Uint8Array));function buildQueryString(o){var s,m=[],_=_createForOfIteratorHelper(Object.keys(o).sort());try{for(_.s();!(s=_.n()).done;){var S=s.value,E=o[S];if(S=VD(S),Array.isArray(E))for(var A=0,O=E.length;A<O;A++)m.push("".concat(S,"=").concat(VD(E[A])));else{var H=S;(E||"string"==typeof E)&&(H+="=".concat(VD(E))),m.push(H)}}}catch(o){_.e(o)}finally{_.f()}return m.join("&")}function requestTimeout(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(s,m){o&&setTimeout((function(){var s=new Error("Request did not complete within ".concat(o," ms"));s.name="TimeoutError",m(s)}),o)}))}var hM=Boolean("undefined"!=typeof Request&&"keepalive"in new Request("https://[::1]")),pM=function(){function FetchHttpHandler(o){_classCallCheck$1(this,FetchHttpHandler),"function"==typeof o?this.configProvider=o().then((function(o){return o||{}})):(this.config=null!=o?o:{},this.configProvider=Promise.resolve(this.config))}var o;return _createClass$1(FetchHttpHandler,[{key:"destroy",value:function destroy(){}},{key:"handle",value:(o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){var s,m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se=arguments;return _regeneratorRuntime$1().wrap((function _callee$(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(s=(Se.length>1&&void 0!==Se[1]?Se[1]:{}).abortSignal,this.config){Ee.next=5;break}return Ee.next=4,this.configProvider;case 4:this.config=Ee.sent;case 5:if(m=this.config.requestTimeout,_=!0===this.config.keepAlive,null==s||!s.aborted){Ee.next=11;break}return(S=new Error("Request aborted")).name="AbortError",Ee.abrupt("return",Promise.reject(S));case 11:return E=o.path,(A=buildQueryString(o.query||{}))&&(E+="?".concat(A)),o.fragment&&(E+="#".concat(o.fragment)),O="",null==o.username&&null==o.password||(z=null!==(H=o.username)&&void 0!==H?H:"",G=null!==(K=o.password)&&void 0!==K?K:"",O="".concat(z,":").concat(G,"@")),q=o.port,X=o.method,J="".concat(o.protocol,"//").concat(O).concat(o.hostname).concat(q?":".concat(q):"").concat(E),ae="GET"===X||"HEAD"===X?void 0:o.body,pe={body:ae,headers:new Headers(o.headers),method:X},"undefined"!=typeof AbortController&&(pe.signal=s),hM&&(pe.keepalive=_),me=new Request(J,pe),_e=[fetch(me).then((function(o){var s,m=o.headers,_={},S=_createForOfIteratorHelper(m.entries());try{for(S.s();!(s=S.n()).done;){var E=s.value;_[E[0]]=E[1]}}catch(o){S.e(o)}finally{S.f()}return null!=o.body?{response:new IL({headers:_,reason:o.statusText,statusCode:o.status,body:o.body})}:o.blob().then((function(s){return{response:new IL({headers:_,reason:o.statusText,statusCode:o.status,body:s})}}))})),requestTimeout(m)],s&&_e.push(new Promise((function(o,m){s.onabort=function(){var o=new Error("Request aborted");o.name="AbortError",m(o)}}))),Ee.abrupt("return",Promise.race(_e));case 27:case"end":return Ee.stop()}}),_callee,this)}))),function handle(s){return o.apply(this,arguments)})},{key:"updateHttpClientConfig",value:function updateHttpClientConfig(o,s){this.config=void 0,this.configProvider=this.configProvider.then((function(m){return m[o]=s,m}))}},{key:"httpHandlerConfigs",value:function httpHandlerConfigs(){var o;return null!==(o=this.config)&&void 0!==o?o:{}}}]),FetchHttpHandler}(),fM=function streamCollector(o){return"function"==typeof Blob&&o instanceof Blob?function collectBlob(o){return _collectBlob.apply(this,arguments)}(o):function collectStream(o){return _collectStream.apply(this,arguments)}(o)};function _collectBlob(){return(_collectBlob=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o){var s,m;return _regeneratorRuntime$1().wrap((function _callee$(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,readToBase64(o);case 2:return s=_.sent,m=cM(s),_.abrupt("return",new Uint8Array(m));case 5:case"end":return _.stop()}}),_callee)})))).apply(this,arguments)}function _collectStream(){return(_collectStream=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o){var s,m,_,S,E,A,O;return _regeneratorRuntime$1().wrap((function _callee2$(H){for(;;)switch(H.prev=H.next){case 0:s=new Uint8Array(0),m=o.getReader(),_=!1;case 3:if(_){H.next=13;break}return H.next=6,m.read();case 6:S=H.sent,E=S.done,(A=S.value)&&(O=s,(s=new Uint8Array(O.length+A.length)).set(O),s.set(A,O.length)),_=E,H.next=3;break;case 13:return H.abrupt("return",s);case 14:case"end":return H.stop()}}),_callee2)})))).apply(this,arguments)}function readToBase64(o){return new Promise((function(s,m){var _=new FileReader;_.onloadend=function(){var o;if(2!==_.readyState)return m(new Error("Reader aborted too early"));var S=null!==(o=_.result)&&void 0!==o?o:"",E=S.indexOf(","),A=E>-1?E+1:S.length;s(S.substring(A))},_.onabort=function(){return m(new Error("Read aborted"))},_.onerror=function(){return m(_.error)},_.readAsDataURL(o)}))}var gM=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){var o,s,m,_=arguments;return _regeneratorRuntime$1().wrap((function _callee$(S){for(;;)switch(S.prev=S.next){case 0:if(o=_.length>0&&void 0!==_[0]?_[0]:new Uint8Array,s=_.length>1?_[1]:void 0,!(o instanceof Uint8Array)){S.next=4;break}return S.abrupt("return",dM.mutate(o));case 4:if(o){S.next=6;break}return S.abrupt("return",dM.mutate(new Uint8Array));case 6:return m=s.streamCollector(o),S.t0=dM,S.next=10,m;case 10:return S.t1=S.sent,S.abrupt("return",S.t0.mutate.call(S.t0,S.t1));case 12:case"end":return S.stop()}}),_callee)})));return function collectBody(){return o.apply(this,arguments)}}(),mM=_createClass$1((function Command(){_classCallCheck$1(this,Command),this.middlewareStack=HO()})),yM="***SensitiveInformation***",vM=function expectBoolean(o){if(null!=o){if("number"==typeof o){if(0!==o&&1!==o||DM.warn(LM("Expected boolean, got ".concat(typeof o,": ").concat(o))),0===o)return!1;if(1===o)return!0}if("string"==typeof o){var s=o.toLowerCase();if("false"!==s&&"true"!==s||DM.warn(LM("Expected boolean, got ".concat(typeof o,": ").concat(o))),"false"===s)return!1;if("true"===s)return!0}if("boolean"==typeof o)return o;throw new TypeError("Expected boolean, got ".concat(typeof o,": ").concat(o))}},_M=Math.ceil(Math.pow(2,127)*(2-Math.pow(2,-23))),bM=function expectFloat32(o){var s=function expectNumber(o){if(null!=o){if("string"==typeof o){var s=parseFloat(o);if(!Number.isNaN(s))return String(s)!==String(o)&&DM.warn(LM("Expected number but observed string: ".concat(o))),s}if("number"==typeof o)return o;throw new TypeError("Expected number, got ".concat(typeof o,": ").concat(o))}}(o);if(void 0!==s&&!Number.isNaN(s)&&s!==1/0&&s!==-1/0&&Math.abs(s)>_M)throw new TypeError("Expected 32-bit float, got ".concat(o));return s},SM=function expectLong(o){if(null!=o){if(Number.isInteger(o)&&!Number.isNaN(o))return o;throw new TypeError("Expected integer, got ".concat(typeof o,": ").concat(o))}},TM=function expectShort(o){return CM(o,16)},kM=function expectByte(o){return CM(o,8)},CM=function expectSizedInt(o,s){var m=SM(o);if(void 0!==m&&wM(m,s)!==m)throw new TypeError("Expected ".concat(s,"-bit integer, got ").concat(o));return m},wM=function castInt(o,s){switch(s){case 32:return Int32Array.of(o)[0];case 16:return Int16Array.of(o)[0];case 8:return Int8Array.of(o)[0]}},xM=function expectNonNull(o,s){if(null==o){if(s)throw new TypeError("Expected a non-null value for ".concat(s));throw new TypeError("Expected a non-null value")}return o},EM=function expectObject(o){if(null!=o){if("object"==typeof o&&!Array.isArray(o))return o;var s=Array.isArray(o)?"array":typeof o;throw new TypeError("Expected object, got ".concat(s,": ").concat(o))}},IM=function expectString(o){if(null!=o){if("string"==typeof o)return o;if(["boolean","number","bigint"].includes(typeof o))return DM.warn(LM("Expected string, got ".concat(typeof o,": ").concat(o))),String(o);throw new TypeError("Expected string, got ".concat(typeof o,": ").concat(o))}},AM=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,PM=function parseNumber(o){var s=o.match(AM);if(null===s||s[0].length!==o.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(o)},LM=function stackTraceWarning(o){return String(new TypeError(o).stack||o).split("\n").slice(0,5).filter((function(o){return!o.includes("stackTraceWarning")})).join("\n")},DM={warn:console.warn},RM=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],OM=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),MM=function parseRfc3339DateTimeWithOffset(o){if(null!=o){if("string"!=typeof o)throw new TypeError("RFC-3339 date-times must be expressed as strings");var s=OM.exec(o);if(!s)throw new TypeError("Invalid RFC-3339 date-time value");var m=_slicedToArray$1(s,9);m[0];var _=m[1],S=m[2],E=m[3],A=m[4],O=m[5],H=m[6],K=m[7],z=m[8],G=function strictParseShort(o){return TM("string"==typeof o?PM(o):o)}(HM(_)),q=jM(S,"month",1,12),X=jM(E,"day",1,31),J=FM(G,q,X,{hours:A,minutes:O,seconds:H,fractionalMilliseconds:K});return"Z"!=z.toUpperCase()&&J.setTime(J.getTime()-VM(z)),J}},FM=function buildDate(o,s,m,_){var S=s-1;return UM(o,S,m),new Date(Date.UTC(o,S,m,jM(_.hours,"hour",0,23),jM(_.minutes,"minute",0,59),jM(_.seconds,"seconds",0,60),$M(_.fractionalMilliseconds)))},NM=[31,28,31,30,31,30,31,31,30,31,30,31],UM=function validateDayOfMonth(o,s,m){var _=NM[s];if(1===s&&BM(o)&&(_=29),m>_)throw new TypeError("Invalid day for ".concat(RM[s]," in ").concat(o,": ").concat(m))},BM=function isLeapYear(o){return o%4==0&&(o%100!=0||o%400==0)},jM=function parseDateValue(o,s,m,_){var S=function strictParseByte(o){return kM("string"==typeof o?PM(o):o)}(HM(o));if(S<m||S>_)throw new TypeError("".concat(s," must be between ").concat(m," and ").concat(_,", inclusive"));return S},$M=function parseMilliseconds(o){return null==o?0:1e3*function strictParseFloat32(o){return bM("string"==typeof o?PM(o):o)}("0."+o)},VM=function parseOffsetToMilliseconds(o){var s=o[0],m=1;if("+"==s)m=1;else{if("-"!=s)throw new TypeError("Offset direction, ".concat(s,', must be "+" or "-"'));m=-1}return m*(60*Number(o.substring(1,3))+Number(o.substring(4,6)))*60*1e3},HM=function stripLeadingZeroes(o){for(var s=0;s<o.length-1&&"0"===o.charAt(s);)s++;return 0===s?o:o.slice(s)},KM=function(o){_inherits$1(ServiceException,o);var s=_createSuper$1(ServiceException);function ServiceException(o){var m;return _classCallCheck$1(this,ServiceException),m=s.call(this,o.message),Object.setPrototypeOf(_assertThisInitialized(m),ServiceException.prototype),m.name=o.name,m.$fault=o.$fault,m.$metadata=o.$metadata,m}return _createClass$1(ServiceException)}(_wrapNativeSuper(Error)),zM=function decorateServiceException(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.entries(s).filter((function(o){return void 0!==_slicedToArray$1(o,2)[1]})).forEach((function(s){var m=_slicedToArray$1(s,2),_=m[0],S=m[1];null!=o[_]&&""!==o[_]||(o[_]=S)}));var m=o.message||o.Message||"UnknownError";return o.message=m,delete o.Message,o},WM=function deserializeMetadata(o){var s,m;return{httpStatusCode:o.statusCode,requestId:null!==(s=null!==(m=o.headers["x-amzn-requestid"])&&void 0!==m?m:o.headers["x-amzn-request-id"])&&void 0!==s?s:o.headers["x-amz-request-id"],extendedRequestId:o.headers["x-amz-id-2"],cfId:o.headers["x-amz-cf-id"]}},GM=function loadConfigsForDefaultMode(o){switch(o){case"standard":case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},qM=function getDefaultExtensionConfiguration(o){return _objectSpread2(_objectSpread2({},function getChecksumConfiguration(o){var s=[],m=function _loop(){var m=pL[_];if(void 0===o[m])return"continue";s.push({algorithmId:function algorithmId(){return m},checksumConstructor:function checksumConstructor(){return o[m]}})};for(var _ in pL)m();return{_checksumAlgorithms:s,addChecksumAlgorithm:function addChecksumAlgorithm(o){this._checksumAlgorithms.push(o)},checksumAlgorithms:function checksumAlgorithms(){return this._checksumAlgorithms}}}(o)),function getRetryConfiguration(o){var s=o.retryStrategy;return{setRetryStrategy:function setRetryStrategy(o){s=o},retryStrategy:function retryStrategy(){return s}}}(o))};function extendedEncodeURIComponent(o){return encodeURIComponent(o).replace(/[!'()*]/g,(function(o){return"%"+o.charCodeAt(0).toString(16).toUpperCase()}))}var XM=function StringWrapper(){var o=Object.getPrototypeOf(this).constructor,s=new(Function.bind.apply(String,[null].concat(Array.prototype.slice.call(arguments))));return Object.setPrototypeOf(s,o.prototype),s};function map(o,s,m){var _,S;if(void 0===s&&void 0===m)_={},S=o;else{if(_=o,"function"==typeof s)return QM(_,s,S=m);S=s}for(var E=0,A=Object.keys(S);E<A.length;E++){var O=A[E];Array.isArray(S[O])?JM(_,null,S,O):_[O]=S[O]}return _}XM.prototype=Object.create(String.prototype,{constructor:{value:XM,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(XM,String);var YM=function take(o,s){var m={};for(var _ in s)JM(m,o,s,_);return m},QM=function mapWithFilter(o,s,m){return map(o,Object.entries(m).reduce((function(o,m){var _=_slicedToArray$1(m,2),S=_[0],E=_[1];return Array.isArray(E)?o[S]=E:o[S]="function"==typeof E?[s,E()]:[s,E],o}),{}))},JM=function applyInstruction(o,s,m,_){if(null===s){var S=_slicedToArray$1(m[_],2),E=S[0],A=S[1];if("function"==typeof A){var O,H=void 0===E&&null!=(O=A()),K="function"==typeof E&&!!E(void 0)||"function"!=typeof E&&!!E;H?o[_]=O:K&&(o[_]=A())}else{var z=void 0===E&&null!=A,G="function"==typeof E&&!!E(A)||"function"!=typeof E&&!!E;(z||G)&&(o[_]=A)}}else{var q=m[_];"function"==typeof q&&(q=[,q]);var X=_slicedToArray$1(q,3),J=X[0],ae=void 0===J?ZM:J,pe=X[1],me=void 0===pe?eF:pe,_e=X[2],Se=void 0===_e?_:_e;("function"==typeof ae&&ae(s[Se])||"function"!=typeof ae&&ae)&&(o[_]=me(s[Se]))}},ZM=function nonNullish(o){return null!=o},eF=function pass(o){return o},tF=function resolvedPath(o,s,m,_,S,E){if(null==s||void 0===s[m])throw new Error("No value provided for input HTTP label: "+m+".");var A=_();if(A.length<=0)throw new Error("Empty value provided for input HTTP label: "+m+".");return o=o.replace(S,E?A.split("/").map((function(o){return extendedEncodeURIComponent(o)})).join("/"):extendedEncodeURIComponent(A))},nF=function _json(o){if(null==o)return{};if(Array.isArray(o))return o.filter((function(o){return null!=o}));if("object"==typeof o){for(var s={},m=0,_=Object.keys(o);m<_.length;m++){var S=_[m];null!=o[S]&&(s[S]=_json(o[S]))}return s}return o},rF="3.430.0",iF={},aF={},oF={},sF={};Object.defineProperty(sF,"__esModule",{value:!0}),sF.isEmptyData=void 0,sF.isEmptyData=function isEmptyData(o){return"string"==typeof o?0===o.length:0===o.byteLength};var uF={};!function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.EMPTY_DATA_SHA_256=o.SHA_256_HMAC_ALGO=o.SHA_256_HASH=void 0,o.SHA_256_HASH={name:"SHA-256"},o.SHA_256_HMAC_ALGO={name:"HMAC",hash:o.SHA_256_HASH},o.EMPTY_DATA_SHA_256=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85])}(uF);var lF={};var cF=getAugmentedNamespace(Object.freeze({__proto__:null,locateWindow:function locateWindow(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:lF}}));Object.defineProperty(oF,"__esModule",{value:!0}),oF.Sha256=void 0;var dF=sF,hF=uF,pF=HL,fF=cF,gF=function(){function Sha256(o){this.secret=o,this.reset()}return Sha256.prototype.update=function(o){var s=this;(0,dF.isEmptyData)(o)||(this.operation=this.operation.then((function(m){return m.onerror=function(){s.operation=Promise.reject(new Error("Error encountered updating hash"))},m.process(toArrayBufferView(o)),m})),this.operation.catch((function(){})))},Sha256.prototype.digest=function(){return this.operation.then((function(o){return new Promise((function(s,m){o.onerror=function(){m(new Error("Error encountered finalizing hash"))},o.oncomplete=function(){o.result&&s(new Uint8Array(o.result)),m(new Error("Error encountered finalizing hash"))},o.finish()}))}))},Sha256.prototype.reset=function(){this.secret?(this.operation=function getKeyPromise(o){return new Promise((function(s,m){var _=(0,fF.locateWindow)().msCrypto.subtle.importKey("raw",toArrayBufferView(o),hF.SHA_256_HMAC_ALGO,!1,["sign"]);_.oncomplete=function(){_.result&&s(_.result),m(new Error("ImportKey completed without importing key."))},_.onerror=function(){m(new Error("ImportKey failed to import key."))}}))}(this.secret).then((function(o){return(0,fF.locateWindow)().msCrypto.subtle.sign(hF.SHA_256_HMAC_ALGO,o)})),this.operation.catch((function(){}))):this.operation=Promise.resolve((0,fF.locateWindow)().msCrypto.subtle.digest("SHA-256"))},Sha256}();function toArrayBufferView(o){return"string"==typeof o?(0,pF.fromUtf8)(o):ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(o)}oF.Sha256=gF;var mF={};Object.defineProperty(mF,"__esModule",{value:!0}),mF.Sha256=void 0;var yF=jL,vF=uF,_F=cF,bF=function(){function Sha256(o){this.toHash=new Uint8Array(0),this.secret=o,this.reset()}return Sha256.prototype.update=function(o){if(!(0,yF.isEmptyData)(o)){var s=(0,yF.convertToBuffer)(o),m=new Uint8Array(this.toHash.byteLength+s.byteLength);m.set(this.toHash,0),m.set(s,this.toHash.byteLength),this.toHash=m}},Sha256.prototype.digest=function(){var o=this;return this.key?this.key.then((function(s){return(0,_F.locateWindow)().crypto.subtle.sign(vF.SHA_256_HMAC_ALGO,s,o.toHash).then((function(o){return new Uint8Array(o)}))})):(0,yF.isEmptyData)(this.toHash)?Promise.resolve(vF.EMPTY_DATA_SHA_256):Promise.resolve().then((function(){return(0,_F.locateWindow)().crypto.subtle.digest(vF.SHA_256_HASH,o.toHash)})).then((function(o){return Promise.resolve(new Uint8Array(o))}))},Sha256.prototype.reset=function(){var o=this;this.toHash=new Uint8Array(0),this.secret&&void 0!==this.secret&&(this.key=new Promise((function(s,m){(0,_F.locateWindow)().crypto.subtle.importKey("raw",(0,yF.convertToBuffer)(o.secret),vF.SHA_256_HMAC_ALGO,!1,["sign"]).then(s,m)})),this.key.catch((function(){})))},Sha256}();mF.Sha256=bF;var SF={},TF={},kF={};Object.defineProperty(kF,"__esModule",{value:!0}),kF.MAX_HASHABLE_LENGTH=kF.INIT=kF.KEY=kF.DIGEST_LENGTH=kF.BLOCK_SIZE=void 0,kF.BLOCK_SIZE=64,kF.DIGEST_LENGTH=32,kF.KEY=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),kF.INIT=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],kF.MAX_HASHABLE_LENGTH=Math.pow(2,53)-1;var CF={};Object.defineProperty(CF,"__esModule",{value:!0}),CF.RawSha256=void 0;var wF=kF,xF=function(){function RawSha256(){this.state=Int32Array.from(wF.INIT),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return RawSha256.prototype.update=function(o){if(this.finished)throw new Error("Attempted to update an already finished hash.");var s=0,m=o.byteLength;if(this.bytesHashed+=m,8*this.bytesHashed>wF.MAX_HASHABLE_LENGTH)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;m>0;)this.buffer[this.bufferLength++]=o[s++],m--,this.bufferLength===wF.BLOCK_SIZE&&(this.hashBuffer(),this.bufferLength=0)},RawSha256.prototype.digest=function(){if(!this.finished){var o=8*this.bytesHashed,s=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),m=this.bufferLength;if(s.setUint8(this.bufferLength++,128),m%wF.BLOCK_SIZE>=wF.BLOCK_SIZE-8){for(var _=this.bufferLength;_<wF.BLOCK_SIZE;_++)s.setUint8(_,0);this.hashBuffer(),this.bufferLength=0}for(_=this.bufferLength;_<wF.BLOCK_SIZE-8;_++)s.setUint8(_,0);s.setUint32(wF.BLOCK_SIZE-8,Math.floor(o/4294967296),!0),s.setUint32(wF.BLOCK_SIZE-4,o),this.hashBuffer(),this.finished=!0}var S=new Uint8Array(wF.DIGEST_LENGTH);for(_=0;_<8;_++)S[4*_]=this.state[_]>>>24&255,S[4*_+1]=this.state[_]>>>16&255,S[4*_+2]=this.state[_]>>>8&255,S[4*_+3]=this.state[_]>>>0&255;return S},RawSha256.prototype.hashBuffer=function(){for(var o=this.buffer,s=this.state,m=s[0],_=s[1],S=s[2],E=s[3],A=s[4],O=s[5],H=s[6],K=s[7],z=0;z<wF.BLOCK_SIZE;z++){if(z<16)this.temp[z]=(255&o[4*z])<<24|(255&o[4*z+1])<<16|(255&o[4*z+2])<<8|255&o[4*z+3];else{var G=this.temp[z-2],q=(G>>>17|G<<15)^(G>>>19|G<<13)^G>>>10,X=((G=this.temp[z-15])>>>7|G<<25)^(G>>>18|G<<14)^G>>>3;this.temp[z]=(q+this.temp[z-7]|0)+(X+this.temp[z-16]|0)}var J=(((A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7))+(A&O^~A&H)|0)+(K+(wF.KEY[z]+this.temp[z]|0)|0)|0,ae=((m>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10))+(m&_^m&S^_&S)|0;K=H,H=O,O=A,A=E+J|0,E=S,S=_,_=m,m=J+ae|0}s[0]+=m,s[1]+=_,s[2]+=S,s[3]+=E,s[4]+=A,s[5]+=O,s[6]+=H,s[7]+=K},RawSha256}();CF.RawSha256=xF,Object.defineProperty(TF,"__esModule",{value:!0}),TF.Sha256=void 0;var EF=BL,IF=kF,AF=CF,PF=jL,LF=function(){function Sha256(o){this.secret=o,this.hash=new AF.RawSha256,this.reset()}return Sha256.prototype.update=function(o){if(!(0,PF.isEmptyData)(o)&&!this.error)try{this.hash.update((0,PF.convertToBuffer)(o))}catch(o){this.error=o}},Sha256.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},Sha256.prototype.digest=function(){return EF.__awaiter(this,void 0,void 0,(function(){return EF.__generator(this,(function(o){return[2,this.digestSync()]}))}))},Sha256.prototype.reset=function(){if(this.hash=new AF.RawSha256,this.secret){this.outer=new AF.RawSha256;var o=function bufferFromSecret(o){var s=(0,PF.convertToBuffer)(o);if(s.byteLength>IF.BLOCK_SIZE){var m=new AF.RawSha256;m.update(s),s=m.digest()}var _=new Uint8Array(IF.BLOCK_SIZE);return _.set(s),_}(this.secret),s=new Uint8Array(IF.BLOCK_SIZE);s.set(o);for(var m=0;m<IF.BLOCK_SIZE;m++)o[m]^=54,s[m]^=92;this.hash.update(o),this.outer.update(s);for(m=0;m<o.byteLength;m++)o[m]=0}},Sha256}();TF.Sha256=LF,function(o){Object.defineProperty(o,"__esModule",{value:!0}),BL.__exportStar(TF,o)}(SF);var DF={},RF={};Object.defineProperty(RF,"__esModule",{value:!0}),RF.supportsZeroByteGCM=RF.supportsSubtleCrypto=RF.supportsSecureRandom=RF.supportsWebCrypto=void 0;var OF=BL,MF=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function supportsSecureRandom(o){return"object"==typeof o&&"object"==typeof o.crypto&&"function"==typeof o.crypto.getRandomValues}function supportsSubtleCrypto(o){return o&&MF.every((function(s){return"function"==typeof o[s]}))}RF.supportsWebCrypto=function supportsWebCrypto(o){return!(!supportsSecureRandom(o)||"object"!=typeof o.crypto.subtle)&&supportsSubtleCrypto(o.crypto.subtle)},RF.supportsSecureRandom=supportsSecureRandom,RF.supportsSubtleCrypto=supportsSubtleCrypto,RF.supportsZeroByteGCM=function supportsZeroByteGCM(o){return OF.__awaiter(this,void 0,void 0,(function(){var s;return OF.__generator(this,(function(m){switch(m.label){case 0:if(!supportsSubtleCrypto(o))return[2,!1];m.label=1;case 1:return m.trys.push([1,4,,5]),[4,o.generateKey({name:"AES-GCM",length:128},!1,["encrypt"])];case 2:return s=m.sent(),[4,o.encrypt({name:"AES-GCM",iv:new Uint8Array(Array(12)),additionalData:new Uint8Array(Array(16)),tagLength:128},s,new Uint8Array(0))];case 3:return[2,16===m.sent().byteLength];case 4:return m.sent(),[2,!1];case 5:return[2]}}))}))},function(o){Object.defineProperty(o,"__esModule",{value:!0}),BL.__exportStar(RF,o)}(DF);var FF={},NF={};Object.defineProperty(NF,"__esModule",{value:!0});var UF={};Object.defineProperty(UF,"__esModule",{value:!0});var BF={};Object.defineProperty(BF,"__esModule",{value:!0});var jF={};Object.defineProperty(jF,"__esModule",{value:!0});var $F={};Object.defineProperty($F,"__esModule",{value:!0}),$F.isMsWindow=void 0;var VF=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];$F.isMsWindow=function isMsWindow(o){if(function quacksLikeAnMsWindow(o){return"MSInputMethodContext"in o&&"msCrypto"in o}(o)&&void 0!==o.msCrypto.subtle){var s=o.msCrypto,m=s.getRandomValues,_=s.subtle;return VF.map((function(o){return _[o]})).concat(m).every((function(o){return"function"==typeof o}))}return!1},function(o){Object.defineProperty(o,"__esModule",{value:!0});var s=BL;s.__exportStar(NF,o),s.__exportStar(UF,o),s.__exportStar(BF,o),s.__exportStar(jF,o),s.__exportStar($F,o)}(FF),Object.defineProperty(aF,"__esModule",{value:!0}),aF.Sha256=void 0;var HF=oF,KF=mF,zF=SF,WF=DF,GF=FF,qF=cF,XF=jL,YF=function(){function Sha256(o){(0,WF.supportsWebCrypto)((0,qF.locateWindow)())?this.hash=new KF.Sha256(o):(0,GF.isMsWindow)((0,qF.locateWindow)())?this.hash=new HF.Sha256(o):this.hash=new zF.Sha256(o)}return Sha256.prototype.update=function(o,s){this.hash.update((0,XF.convertToBuffer)(o))},Sha256.prototype.digest=function(){return this.hash.digest()},Sha256.prototype.reset=function(){this.hash.reset()},Sha256}();aF.Sha256=YF,function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.WebCryptoSha256=o.Ie11Sha256=void 0,BL.__exportStar(aF,o);var s=oF;Object.defineProperty(o,"Ie11Sha256",{enumerable:!0,get:function get(){return s.Sha256}});var m=mF;Object.defineProperty(o,"WebCryptoSha256",{enumerable:!0,get:function get(){return m.Sha256}})}(iF);var QF,JF,ZF,eN,tN,nN,rN,iN,aN,oN,sN,uN={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},lN={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},cN={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},dN={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},hN={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"},pN=function(){function Utils(){_classCallCheck$1(this,Utils)}return _createClass$1(Utils,null,[{key:"getFirstMatch",value:function getFirstMatch(o,s){var m=s.match(o);return m&&m.length>0&&m[1]||""}},{key:"getSecondMatch",value:function getSecondMatch(o,s){var m=s.match(o);return m&&m.length>1&&m[2]||""}},{key:"matchAndReturnConst",value:function matchAndReturnConst(o,s,m){if(o.test(s))return m}},{key:"getWindowsVersionName",value:function getWindowsVersionName(o){switch(o){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}},{key:"getMacOSVersionName",value:function getMacOSVersionName(o){var s=o.split(".").splice(0,2).map((function(o){return parseInt(o,10)||0}));if(s.push(0),10===s[0])switch(s[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}},{key:"getAndroidVersionName",value:function getAndroidVersionName(o){var s=o.split(".").splice(0,2).map((function(o){return parseInt(o,10)||0}));if(s.push(0),!(1===s[0]&&s[1]<5))return 1===s[0]&&s[1]<6?"Cupcake":1===s[0]&&s[1]>=6?"Donut":2===s[0]&&s[1]<2?"Eclair":2===s[0]&&2===s[1]?"Froyo":2===s[0]&&s[1]>2?"Gingerbread":3===s[0]?"Honeycomb":4===s[0]&&s[1]<1?"Ice Cream Sandwich":4===s[0]&&s[1]<4?"Jelly Bean":4===s[0]&&s[1]>=4?"KitKat":5===s[0]?"Lollipop":6===s[0]?"Marshmallow":7===s[0]?"Nougat":8===s[0]?"Oreo":9===s[0]?"Pie":void 0}},{key:"getVersionPrecision",value:function getVersionPrecision(o){return o.split(".").length}},{key:"compareVersions",value:function compareVersions(o,s){var m=arguments.length>2&&void 0!==arguments[2]&&arguments[2],_=Utils.getVersionPrecision(o),S=Utils.getVersionPrecision(s),E=Math.max(_,S),A=0,O=Utils.map([o,s],(function(o){var s=E-Utils.getVersionPrecision(o),m=o+new Array(s+1).join(".0");return Utils.map(m.split("."),(function(o){return new Array(20-o.length).join("0")+o})).reverse()}));for(m&&(A=E-Math.min(_,S)),E-=1;E>=A;){if(O[0][E]>O[1][E])return 1;if(O[0][E]===O[1][E]){if(E===A)return 0;E-=1}else if(O[0][E]<O[1][E])return-1}}},{key:"map",value:function map(o,s){var m,_=[];if(Array.prototype.map)return Array.prototype.map.call(o,s);for(m=0;m<o.length;m+=1)_.push(s(o[m]));return _}},{key:"find",value:function find(o,s){var m,_;if(Array.prototype.find)return Array.prototype.find.call(o,s);for(m=0,_=o.length;m<_;m+=1){var S=o[m];if(s(S,m))return S}}},{key:"assign",value:function assign(o){for(var s,m,_=o,S=arguments.length,E=new Array(S>1?S-1:0),A=1;A<S;A++)E[A-1]=arguments[A];if(Object.assign)return Object.assign.apply(Object,[o].concat(E));var O=function _loop(){var o=E[s];"object"==typeof o&&null!==o&&Object.keys(o).forEach((function(s){_[s]=o[s]}))};for(s=0,m=E.length;s<m;s+=1)O();return o}},{key:"getBrowserAlias",value:function getBrowserAlias(o){return uN[o]}},{key:"getBrowserTypeByAlias",value:function getBrowserTypeByAlias(o){return lN[o]||""}}]),Utils}(),fN=/version\/(\d+(\.?_?\d+)+)/i,gN=[{test:[/googlebot/i],describe:function describe(o){var s={name:"Googlebot"},m=pN.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/opera/i],describe:function describe(o){var s={name:"Opera"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/opr\/|opios/i],describe:function describe(o){var s={name:"Opera"},m=pN.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/SamsungBrowser/i],describe:function describe(o){var s={name:"Samsung Internet for Android"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/Whale/i],describe:function describe(o){var s={name:"NAVER Whale Browser"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/MZBrowser/i],describe:function describe(o){var s={name:"MZ Browser"},m=pN.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/focus/i],describe:function describe(o){var s={name:"Focus"},m=pN.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/swing/i],describe:function describe(o){var s={name:"Swing"},m=pN.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/coast/i],describe:function describe(o){var s={name:"Opera Coast"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function describe(o){var s={name:"Opera Touch"},m=pN.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/yabrowser/i],describe:function describe(o){var s={name:"Yandex Browser"},m=pN.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/ucbrowser/i],describe:function describe(o){var s={name:"UC Browser"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/Maxthon|mxios/i],describe:function describe(o){var s={name:"Maxthon"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/epiphany/i],describe:function describe(o){var s={name:"Epiphany"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/puffin/i],describe:function describe(o){var s={name:"Puffin"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/sleipnir/i],describe:function describe(o){var s={name:"Sleipnir"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/k-meleon/i],describe:function describe(o){var s={name:"K-Meleon"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/micromessenger/i],describe:function describe(o){var s={name:"WeChat"},m=pN.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/qqbrowser/i],describe:function describe(o){var s={name:/qqbrowserlite/i.test(o)?"QQ Browser Lite":"QQ Browser"},m=pN.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/msie|trident/i],describe:function describe(o){var s={name:"Internet Explorer"},m=pN.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/\sedg\//i],describe:function describe(o){var s={name:"Microsoft Edge"},m=pN.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/edg([ea]|ios)/i],describe:function describe(o){var s={name:"Microsoft Edge"},m=pN.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/vivaldi/i],describe:function describe(o){var s={name:"Vivaldi"},m=pN.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/seamonkey/i],describe:function describe(o){var s={name:"SeaMonkey"},m=pN.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/sailfish/i],describe:function describe(o){var s={name:"Sailfish"},m=pN.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,o);return m&&(s.version=m),s}},{test:[/silk/i],describe:function describe(o){var s={name:"Amazon Silk"},m=pN.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/phantom/i],describe:function describe(o){var s={name:"PhantomJS"},m=pN.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/slimerjs/i],describe:function describe(o){var s={name:"SlimerJS"},m=pN.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function describe(o){var s={name:"BlackBerry"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/(web|hpw)[o0]s/i],describe:function describe(o){var s={name:"WebOS Browser"},m=pN.getFirstMatch(fN,o)||pN.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/bada/i],describe:function describe(o){var s={name:"Bada"},m=pN.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/tizen/i],describe:function describe(o){var s={name:"Tizen"},m=pN.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/qupzilla/i],describe:function describe(o){var s={name:"QupZilla"},m=pN.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/firefox|iceweasel|fxios/i],describe:function describe(o){var s={name:"Firefox"},m=pN.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/electron/i],describe:function describe(o){var s={name:"Electron"},m=pN.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/MiuiBrowser/i],describe:function describe(o){var s={name:"Miui"},m=pN.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/chromium/i],describe:function describe(o){var s={name:"Chromium"},m=pN.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,o)||pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/chrome|crios|crmo/i],describe:function describe(o){var s={name:"Chrome"},m=pN.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/GSA/i],describe:function describe(o){var s={name:"Google Search"},m=pN.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:function test(o){var s=!o.test(/like android/i),m=o.test(/android/i);return s&&m},describe:function describe(o){var s={name:"Android Browser"},m=pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/playstation 4/i],describe:function describe(o){var s={name:"PlayStation 4"},m=pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/safari|applewebkit/i],describe:function describe(o){var s={name:"Safari"},m=pN.getFirstMatch(fN,o);return m&&(s.version=m),s}},{test:[/.*/i],describe:function describe(o){var s=-1!==o.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:pN.getFirstMatch(s,o),version:pN.getSecondMatch(s,o)}}}],mN=[{test:[/Roku\/DVP/],describe:function describe(o){var s=pN.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,o);return{name:dN.Roku,version:s}}},{test:[/windows phone/i],describe:function describe(o){var s=pN.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,o);return{name:dN.WindowsPhone,version:s}}},{test:[/windows /i],describe:function describe(o){var s=pN.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,o),m=pN.getWindowsVersionName(s);return{name:dN.Windows,version:s,versionName:m}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function describe(o){var s={name:dN.iOS},m=pN.getSecondMatch(/(Version\/)(\d[\d.]+)/,o);return m&&(s.version=m),s}},{test:[/macintosh/i],describe:function describe(o){var s=pN.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,o).replace(/[_\s]/g,"."),m=pN.getMacOSVersionName(s),_={name:dN.MacOS,version:s};return m&&(_.versionName=m),_}},{test:[/(ipod|iphone|ipad)/i],describe:function describe(o){var s=pN.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,o).replace(/[_\s]/g,".");return{name:dN.iOS,version:s}}},{test:function test(o){var s=!o.test(/like android/i),m=o.test(/android/i);return s&&m},describe:function describe(o){var s=pN.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,o),m=pN.getAndroidVersionName(s),_={name:dN.Android,version:s};return m&&(_.versionName=m),_}},{test:[/(web|hpw)[o0]s/i],describe:function describe(o){var s=pN.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,o),m={name:dN.WebOS};return s&&s.length&&(m.version=s),m}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function describe(o){var s=pN.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,o)||pN.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,o)||pN.getFirstMatch(/\bbb(\d+)/i,o);return{name:dN.BlackBerry,version:s}}},{test:[/bada/i],describe:function describe(o){var s=pN.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,o);return{name:dN.Bada,version:s}}},{test:[/tizen/i],describe:function describe(o){var s=pN.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,o);return{name:dN.Tizen,version:s}}},{test:[/linux/i],describe:function describe(){return{name:dN.Linux}}},{test:[/CrOS/],describe:function describe(){return{name:dN.ChromeOS}}},{test:[/PlayStation 4/],describe:function describe(o){var s=pN.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,o);return{name:dN.PlayStation4,version:s}}}],yN=[{test:[/googlebot/i],describe:function describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function describe(o){var s=pN.getFirstMatch(/(can-l01)/i,o)&&"Nova",m={type:cN.mobile,vendor:"Huawei"};return s&&(m.model=s),m}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function describe(){return{type:cN.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function describe(){return{type:cN.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function describe(){return{type:cN.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function describe(){return{type:cN.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function describe(){return{type:cN.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function describe(){return{type:cN.tablet}}},{test:function test(o){var s=o.test(/ipod|iphone/i),m=o.test(/like (ipod|iphone)/i);return s&&!m},describe:function describe(o){var s=pN.getFirstMatch(/(ipod|iphone)/i,o);return{type:cN.mobile,vendor:"Apple",model:s}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function describe(){return{type:cN.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function describe(){return{type:cN.mobile}}},{test:function test(o){return"blackberry"===o.getBrowserName(!0)},describe:function describe(){return{type:cN.mobile,vendor:"BlackBerry"}}},{test:function test(o){return"bada"===o.getBrowserName(!0)},describe:function describe(){return{type:cN.mobile}}},{test:function test(o){return"windows phone"===o.getBrowserName()},describe:function describe(){return{type:cN.mobile,vendor:"Microsoft"}}},{test:function test(o){var s=Number(String(o.getOSVersion()).split(".")[0]);return"android"===o.getOSName(!0)&&s>=3},describe:function describe(){return{type:cN.tablet}}},{test:function test(o){return"android"===o.getOSName(!0)},describe:function describe(){return{type:cN.mobile}}},{test:function test(o){return"macos"===o.getOSName(!0)},describe:function describe(){return{type:cN.desktop,vendor:"Apple"}}},{test:function test(o){return"windows"===o.getOSName(!0)},describe:function describe(){return{type:cN.desktop}}},{test:function test(o){return"linux"===o.getOSName(!0)},describe:function describe(){return{type:cN.desktop}}},{test:function test(o){return"playstation 4"===o.getOSName(!0)},describe:function describe(){return{type:cN.tv}}},{test:function test(o){return"roku"===o.getOSName(!0)},describe:function describe(){return{type:cN.tv}}}],vN=[{test:function test(o){return"microsoft edge"===o.getBrowserName(!0)},describe:function describe(o){if(/\sedg\//i.test(o))return{name:hN.Blink};var s=pN.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,o);return{name:hN.EdgeHTML,version:s}}},{test:[/trident/i],describe:function describe(o){var s={name:hN.Trident},m=pN.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:function test(o){return o.test(/presto/i)},describe:function describe(o){var s={name:hN.Presto},m=pN.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:function test(o){var s=o.test(/gecko/i),m=o.test(/like gecko/i);return s&&!m},describe:function describe(o){var s={name:hN.Gecko},m=pN.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}},{test:[/(apple)?webkit\/537\.36/i],describe:function describe(){return{name:hN.Blink}}},{test:[/(apple)?webkit/i],describe:function describe(o){var s={name:hN.WebKit},m=pN.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,o);return m&&(s.version=m),s}}],_N=function(){function Parser(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_classCallCheck$1(this,Parser),null==o||""===o)throw new Error("UserAgent parameter can't be empty");this._ua=o,this.parsedResult={},!0!==s&&this.parse()}return _createClass$1(Parser,[{key:"getUA",value:function getUA(){return this._ua}},{key:"test",value:function test(o){return o.test(this._ua)}},{key:"parseBrowser",value:function parseBrowser(){var o=this;this.parsedResult.browser={};var s=pN.find(gN,(function(s){if("function"==typeof s.test)return s.test(o);if(s.test instanceof Array)return s.test.some((function(s){return o.test(s)}));throw new Error("Browser's test function is not valid")}));return s&&(this.parsedResult.browser=s.describe(this.getUA())),this.parsedResult.browser}},{key:"getBrowser",value:function getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}},{key:"getBrowserName",value:function getBrowserName(o){return o?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}},{key:"getBrowserVersion",value:function getBrowserVersion(){return this.getBrowser().version}},{key:"getOS",value:function getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}},{key:"parseOS",value:function parseOS(){var o=this;this.parsedResult.os={};var s=pN.find(mN,(function(s){if("function"==typeof s.test)return s.test(o);if(s.test instanceof Array)return s.test.some((function(s){return o.test(s)}));throw new Error("Browser's test function is not valid")}));return s&&(this.parsedResult.os=s.describe(this.getUA())),this.parsedResult.os}},{key:"getOSName",value:function getOSName(o){var s=this.getOS().name;return o?String(s).toLowerCase()||"":s||""}},{key:"getOSVersion",value:function getOSVersion(){return this.getOS().version}},{key:"getPlatform",value:function getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}},{key:"getPlatformType",value:function getPlatformType(){var o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=this.getPlatform().type;return o?String(s).toLowerCase()||"":s||""}},{key:"parsePlatform",value:function parsePlatform(){var o=this;this.parsedResult.platform={};var s=pN.find(yN,(function(s){if("function"==typeof s.test)return s.test(o);if(s.test instanceof Array)return s.test.some((function(s){return o.test(s)}));throw new Error("Browser's test function is not valid")}));return s&&(this.parsedResult.platform=s.describe(this.getUA())),this.parsedResult.platform}},{key:"getEngine",value:function getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}},{key:"getEngineName",value:function getEngineName(o){return o?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}},{key:"parseEngine",value:function parseEngine(){var o=this;this.parsedResult.engine={};var s=pN.find(vN,(function(s){if("function"==typeof s.test)return s.test(o);if(s.test instanceof Array)return s.test.some((function(s){return o.test(s)}));throw new Error("Browser's test function is not valid")}));return s&&(this.parsedResult.engine=s.describe(this.getUA())),this.parsedResult.engine}},{key:"parse",value:function parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}},{key:"getResult",value:function getResult(){return pN.assign({},this.parsedResult)}},{key:"satisfies",value:function satisfies(o){var s=this,m={},_=0,S={},E=0;if(Object.keys(o).forEach((function(s){var A=o[s];"string"==typeof A?(S[s]=A,E+=1):"object"==typeof A&&(m[s]=A,_+=1)})),_>0){var A=Object.keys(m),O=pN.find(A,(function(o){return s.isOS(o)}));if(O){var H=this.satisfies(m[O]);if(void 0!==H)return H}var K=pN.find(A,(function(o){return s.isPlatform(o)}));if(K){var z=this.satisfies(m[K]);if(void 0!==z)return z}}if(E>0){var G=Object.keys(S),q=pN.find(G,(function(o){return s.isBrowser(o,!0)}));if(void 0!==q)return this.compareVersion(S[q])}}},{key:"isBrowser",value:function isBrowser(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],m=this.getBrowserName().toLowerCase(),_=o.toLowerCase(),S=pN.getBrowserTypeByAlias(_);return s&&S&&(_=S.toLowerCase()),_===m}},{key:"compareVersion",value:function compareVersion(o){var s=[0],m=o,_=!1,S=this.getBrowserVersion();if("string"==typeof S)return">"===o[0]||"<"===o[0]?(m=o.substr(1),"="===o[1]?(_=!0,m=o.substr(2)):s=[],">"===o[0]?s.push(1):s.push(-1)):"="===o[0]?m=o.substr(1):"~"===o[0]&&(_=!0,m=o.substr(1)),s.indexOf(pN.compareVersions(S,m,_))>-1}},{key:"isOS",value:function isOS(o){return this.getOSName(!0)===String(o).toLowerCase()}},{key:"isPlatform",value:function isPlatform(o){return this.getPlatformType(!0)===String(o).toLowerCase()}},{key:"isEngine",value:function isEngine(o){return this.getEngineName(!0)===String(o).toLowerCase()}},{key:"is",value:function is(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.isBrowser(o,s)||this.isOS(o)||this.isPlatform(o)}},{key:"some",value:function some(){var o=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).some((function(s){return o.is(s)}))}}]),Parser}(),bN=function(){function Bowser(){_classCallCheck$1(this,Bowser)}return _createClass$1(Bowser,null,[{key:"getParser",value:function getParser(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"!=typeof o)throw new Error("UserAgent should be a string");return new _N(o,s)}},{key:"parse",value:function parse(o){return new _N(o).getResult()}},{key:"BROWSER_MAP",get:function get(){return lN}},{key:"ENGINE_MAP",get:function get(){return hN}},{key:"OS_MAP",get:function get(){return dN}},{key:"PLATFORMS_MAP",get:function get(){return cN}}]),Bowser}(),SN=function defaultUserAgent(o){var s=o.serviceId,m=o.clientVersion;return _asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){var o,_,S,E,A,O,H,K,z,G;return _regeneratorRuntime$1().wrap((function _callee$(q){for(;;)switch(q.prev=q.next){case 0:return z="undefined"!=typeof window&&null!==(o=window)&&void 0!==o&&null!==(_=o.navigator)&&void 0!==_&&_.userAgent?bN.parse(window.navigator.userAgent):void 0,G=[["aws-sdk-js",m],["ua","2.0"],["os/".concat((null==z||null===(S=z.os)||void 0===S?void 0:S.name)||"other"),null==z||null===(E=z.os)||void 0===E?void 0:E.version],["lang/js"],["md/browser","".concat(null!==(A=null==z||null===(O=z.browser)||void 0===O?void 0:O.name)&&void 0!==A?A:"unknown","_").concat(null!==(H=null==z||null===(K=z.browser)||void 0===K?void 0:K.version)&&void 0!==H?H:"unknown")]],s&&G.push(["api/".concat(s),m]),q.abrupt("return",G);case 4:case"end":return q.stop()}}),_callee)})))},TN=function invalidProvider(o){return function(){return Promise.reject(o)}},kN=function calculateBodyLength(o){if("string"==typeof o){for(var s=o.length,m=s-1;m>=0;m--){var _=o.charCodeAt(m);_>127&&_<=2047?s++:_>2047&&_<=65535&&(s+=2),_>=56320&&_<=57343&&m--}return s}if("number"==typeof o.byteLength)return o.byteLength;if("number"==typeof o.size)return o.size;throw new Error("Body Length computation failed for ".concat(o))},CN="required",wN="fn",xN="argv",EN="ref",a="isSet",IN="tree",AN="error",PN="endpoint",LN="PartitionResult",DN=(_defineProperty$2(QF={},CN,!1),_defineProperty$2(QF,"type","String"),QF),RN=(_defineProperty$2(JF={},CN,!0),_defineProperty$2(JF,"default",!1),_defineProperty$2(JF,"type","Boolean"),JF),ON=_defineProperty$2({},EN,"Endpoint"),MN=(_defineProperty$2(ZF={},wN,"booleanEquals"),_defineProperty$2(ZF,xN,[_defineProperty$2({},EN,"UseFIPS"),!0]),ZF),FN=(_defineProperty$2(eN={},wN,"booleanEquals"),_defineProperty$2(eN,xN,[_defineProperty$2({},EN,"UseDualStack"),!0]),eN),NN={},UN=(_defineProperty$2(nN={},wN,"booleanEquals"),_defineProperty$2(nN,xN,[!0,(tN={},_defineProperty$2(tN,wN,"getAttr"),_defineProperty$2(tN,xN,[_defineProperty$2({},EN,LN),"supportsFIPS"]),tN)]),nN),BN=(_defineProperty$2(iN={},wN,"booleanEquals"),_defineProperty$2(iN,xN,[!0,(rN={},_defineProperty$2(rN,wN,"getAttr"),_defineProperty$2(rN,xN,[_defineProperty$2({},EN,LN),"supportsDualStack"]),rN)]),iN),jN=[MN],$N=[FN],VN=[_defineProperty$2({},EN,"Region")],HN={version:"1.0",parameters:{Region:DN,UseDualStack:RN,UseFIPS:RN,Endpoint:DN},rules:[{conditions:[(aN={},_defineProperty$2(aN,wN,a),_defineProperty$2(aN,xN,[ON]),aN)],type:IN,rules:[{conditions:jN,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:AN},{conditions:$N,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:AN},{endpoint:{url:ON,properties:NN,headers:NN},type:PN}]},{conditions:[(oN={},_defineProperty$2(oN,wN,a),_defineProperty$2(oN,xN,VN),oN)],type:IN,rules:[{conditions:[(sN={},_defineProperty$2(sN,wN,"aws.partition"),_defineProperty$2(sN,xN,VN),_defineProperty$2(sN,"assign",LN),sN)],type:IN,rules:[{conditions:[MN,FN],type:IN,rules:[{conditions:[UN,BN],type:IN,rules:[{endpoint:{url:"https://ivs-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:NN,headers:NN},type:PN}]},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:AN}]},{conditions:jN,type:IN,rules:[{conditions:[UN],type:IN,rules:[{endpoint:{url:"https://ivs-fips.{Region}.{PartitionResult#dnsSuffix}",properties:NN,headers:NN},type:PN}]},{error:"FIPS is enabled but this partition does not support FIPS",type:AN}]},{conditions:$N,type:IN,rules:[{conditions:[BN],type:IN,rules:[{endpoint:{url:"https://ivs.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:NN,headers:NN},type:PN}]},{error:"DualStack is enabled but this partition does not support DualStack",type:AN}]},{endpoint:{url:"https://ivs.{Region}.{PartitionResult#dnsSuffix}",properties:NN,headers:NN},type:PN}]}]},{error:"Invalid Configuration: Missing Region",type:AN}]},KN=function defaultEndpointResolver(o){return function resolveEndpoint(o,s){var m,_,S,E,A,O=s.endpointParams,H=s.logger,K=o.parameters,z=o.rules;null===(m=s.logger)||void 0===m||null===(_=m.debug)||void 0===_||_.call(m,"".concat(gR," Initial EndpointParams: ").concat(toDebugString(O)));var G=Object.entries(K).filter((function(o){return null!=_slicedToArray$1(o,2)[1].default})).map((function(o){var s=_slicedToArray$1(o,2);return[s[0],s[1].default]}));if(G.length>0){var q,X=_createForOfIteratorHelper(G);try{for(X.s();!(q=X.n()).done;){var J,ae=_slicedToArray$1(q.value,2),pe=ae[0],me=ae[1];O[pe]=null!==(J=O[pe])&&void 0!==J?J:me}}catch(o){X.e(o)}finally{X.f()}}var _e,Se=_createForOfIteratorHelper(Object.entries(K).filter((function(o){return _slicedToArray$1(o,2)[1].required})).map((function(o){return _slicedToArray$1(o,1)[0]})));try{for(Se.s();!(_e=Se.n()).done;){var Ee=_e.value;if(null==O[Ee])throw new vR("Missing required parameter: '".concat(Ee,"'"))}}catch(o){Se.e(o)}finally{Se.f()}var De=BR(z,{endpointParams:O,logger:H,referenceRecord:{}});if(null!==(S=s.endpointParams)&&void 0!==S&&S.Endpoint)try{var $e=new URL(s.endpointParams.Endpoint),He=$e.protocol,et=$e.port;De.url.protocol=He,De.url.port=et}catch(o){}return null===(E=s.logger)||void 0===E||null===(A=E.debug)||void 0===A||A.call(E,"".concat(gR," Resolved endpoint: ").concat(toDebugString(De))),De}(HN,{endpointParams:o,logger:(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).logger})},zN=["in-region","cross-region","mobile","standard","legacy"],WN=function isMobileBrowser(){var o,s,m,_="undefined"!=typeof window&&null!==(o=window)&&void 0!==o&&null!==(s=o.navigator)&&void 0!==s&&s.userAgent?bN.parse(window.navigator.userAgent):void 0,S=null==_||null===(m=_.platform)||void 0===m?void 0:m.type;return"tablet"===S||"mobile"===S},GN=function getRuntimeConfig(o){var s,m,_,S,E,A,O,H,K,z,G,q=function resolveDefaultsModeConfig(){var o=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).defaultsMode;return NL(_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){var s;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if("function"!=typeof o){m.next=6;break}return m.next=3,o();case 3:m.t0=m.sent,m.next=7;break;case 6:m.t0=o;case 7:s=m.t0,m.t1=null==s?void 0:s.toLowerCase(),m.next="auto"===m.t1?11:"mobile"===m.t1||"in-region"===m.t1||"cross-region"===m.t1||"standard"===m.t1||"legacy"===m.t1?12:void 0===m.t1?13:14;break;case 11:return m.abrupt("return",Promise.resolve(WN()?"mobile":"standard"));case 12:return m.abrupt("return",Promise.resolve(null==s?void 0:s.toLocaleLowerCase()));case 13:return m.abrupt("return",Promise.resolve("legacy"));case 14:throw new Error('Invalid parameter for "defaultsMode", expect '.concat(zN.join(", "),", got ").concat(s));case 15:case"end":return m.stop()}}),_callee)}))))}(o),X=function defaultConfigProvider(){return q().then(GM)},J=function getRuntimeConfig(o){var s,m,_,S,E,A,O,H,K,z;return{apiVersion:"2020-07-14",base64Decoder:null!==(s=null==o?void 0:o.base64Decoder)&&void 0!==s?s:cM,base64Encoder:null!==(m=null==o?void 0:o.base64Encoder)&&void 0!==m?m:toBase64,disableHostPrefix:null!==(_=null==o?void 0:o.disableHostPrefix)&&void 0!==_&&_,endpointProvider:null!==(S=null==o?void 0:o.endpointProvider)&&void 0!==S?S:KN,extensions:null!==(E=null==o?void 0:o.extensions)&&void 0!==E?E:[],logger:null!==(A=null==o?void 0:o.logger)&&void 0!==A?A:new jO,serviceId:null!==(O=null==o?void 0:o.serviceId)&&void 0!==O?O:"ivs",urlParser:null!==(H=null==o?void 0:o.urlParser)&&void 0!==H?H:oO,utf8Decoder:null!==(K=null==o?void 0:o.utf8Decoder)&&void 0!==K?K:vD,utf8Encoder:null!==(z=null==o?void 0:o.utf8Encoder)&&void 0!==z?z:bD}}(o);return _objectSpread2(_objectSpread2(_objectSpread2({},J),o),{},{runtime:"browser",defaultsMode:q,bodyLengthChecker:null!==(s=null==o?void 0:o.bodyLengthChecker)&&void 0!==s?s:kN,credentialDefaultProvider:null!==(m=null==o?void 0:o.credentialDefaultProvider)&&void 0!==m?m:function(o){return function(){return Promise.reject(new Error("Credential is missing"))}},defaultUserAgentProvider:null!==(_=null==o?void 0:o.defaultUserAgentProvider)&&void 0!==_?_:SN({serviceId:J.serviceId,clientVersion:rF}),maxAttempts:null!==(S=null==o?void 0:o.maxAttempts)&&void 0!==S?S:3,region:null!==(E=null==o?void 0:o.region)&&void 0!==E?E:TN("Region is missing"),requestHandler:null!==(A=null==o?void 0:o.requestHandler)&&void 0!==A?A:new pM(X),retryMode:null!==(O=null==o?void 0:o.retryMode)&&void 0!==O?O:_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,X();case 2:if(o.t0=o.sent.retryMode,o.t0){o.next=5;break}o.t0=vO;case 5:return o.abrupt("return",o.t0);case 6:case"end":return o.stop()}}),_callee)}))),sha256:null!==(H=null==o?void 0:o.sha256)&&void 0!==H?H:iF.Sha256,streamCollector:null!==(K=null==o?void 0:o.streamCollector)&&void 0!==K?K:fM,useDualstackEndpoint:null!==(z=null==o?void 0:o.useDualstackEndpoint)&&void 0!==z?z:function(){return Promise.resolve(false)},useFipsEndpoint:null!==(G=null==o?void 0:o.useFipsEndpoint)&&void 0!==G?G:function(){return Promise.resolve(false)}})},qN=function resolveRuntimeExtensions(o,s){var m=_objectSpread2(_objectSpread2(_objectSpread2({},function getAwsRegionExtensionConfiguration(o){var s=function(){var s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){var s;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if(void 0!==o.region){m.next=2;break}throw new Error("Region is missing from runtimeConfig");case 2:if("string"!=typeof(s=o.region)){m.next=5;break}return m.abrupt("return",s);case 5:return m.abrupt("return",s());case 6:case"end":return m.stop()}}),_callee)})));return function runtimeConfigRegion(){return s.apply(this,arguments)}}();return{setRegion:function setRegion(o){s=o},region:function region(){return s}}}(o)),qM(o)),function getHttpHandlerExtensionConfiguration(o){var s=o.httpHandler;return{setHttpHandler:function setHttpHandler(o){s=o},httpHandler:function httpHandler(){return s},updateHttpClientConfig:function updateHttpClientConfig(o,m){s.updateHttpClientConfig(o,m)},httpHandlerConfigs:function httpHandlerConfigs(){return s.httpHandlerConfigs()}}}(o));return s.forEach((function(o){return o.configure(m)})),_objectSpread2(_objectSpread2(_objectSpread2(_objectSpread2({},o),function resolveAwsRegionExtensionConfiguration(o){return{region:o.region()}}(m)),function resolveDefaultRuntimeConfig(o){return _objectSpread2(_objectSpread2({},function resolveChecksumRuntimeConfig(o){var s={};return o.checksumAlgorithms().forEach((function(o){s[o.algorithmId()]=o.checksumConstructor()})),s}(o)),function resolveRetryRuntimeConfig(o){var s={};return s.retryStrategy=o.retryStrategy(),s}(o))}(m)),function resolveHttpHandlerRuntimeConfig(o){return{httpHandler:o.httpHandler()}}(m))},XN=function(o){_inherits$1(IvsClient,o);var s=_createSuper$1(IvsClient);function IvsClient(){for(var o,m=arguments.length,_=new Array(m),S=0;S<m;S++)_[S]=arguments[S];var E=_[0];_classCallCheck$1(this,IvsClient);var A=function resolveRegionConfig(o){var s,m,_=o.region,S=o.useFipsEndpoint;if(!_)throw new Error("Region is missing");return _objectSpread2(_objectSpread2({},o),{},{region:(m=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){var o;return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if("string"!=typeof _){s.next=2;break}return s.abrupt("return",qR(_));case 2:return s.next=4,_();case 4:return o=s.sent,s.abrupt("return",qR(o));case 6:case"end":return s.stop()}}),_callee)}))),function region(){return m.apply(this,arguments)}),useFipsEndpoint:(s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(){var o;return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:if("string"!=typeof _){s.next=4;break}s.t0=_,s.next=7;break;case 4:return s.next=6,_();case 6:s.t0=s.sent;case 7:if(o=s.t0,!GR(o)){s.next=10;break}return s.abrupt("return",!0);case 10:return s.abrupt("return","function"!=typeof S?Promise.resolve(!!S):S());case 11:case"end":return s.stop()}}),_callee2)}))),function useFipsEndpoint(){return s.apply(this,arguments)})})}(function resolveClientEndpointParameters(o){var s,m;return _objectSpread2(_objectSpread2({},o),{},{useDualstackEndpoint:null!==(s=o.useDualstackEndpoint)&&void 0!==s&&s,useFipsEndpoint:null!==(m=o.useFipsEndpoint)&&void 0!==m&&m,defaultSigningName:"ivs"})}(GN(E||{}))),O=function resolveRetryConfig(o){var s,m,_=o.retryStrategy,S=yD(null!==(s=o.maxAttempts)&&void 0!==s?s:3);return _objectSpread2(_objectSpread2({},o),{},{maxAttempts:S,retryStrategy:(m=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:if(!_){s.next=2;break}return s.abrupt("return",_);case 2:return s.next=4,yD(o.retryMode)();case 4:if(s.sent!==fO.ADAPTIVE){s.next=7;break}return s.abrupt("return",new IO(S));case 7:return s.abrupt("return",new EO(S));case 8:case"end":return s.stop()}}),_callee)}))),function retryStrategy(){return m.apply(this,arguments)})})}(function resolveEndpointConfig(o){var s,m,_,S=null===(s=o.tls)||void 0===s||s,E=o.endpoint,A=null!=E?_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.t0=sO,o.next=3,yD(E)();case 3:return o.t1=o.sent,o.abrupt("return",(0,o.t0)(o.t1));case 5:case"end":return o.stop()}}),_callee)}))):void 0,O=!!E;return _objectSpread2(_objectSpread2({},o),{},{endpoint:A,tls:S,isCustomEndpoint:O,useDualstackEndpoint:yD(null!==(m=o.useDualstackEndpoint)&&void 0!==m&&m),useFipsEndpoint:yD(null!==(_=o.useFipsEndpoint)&&void 0!==_&&_)})}(A)),H=function resolveAwsAuthConfig(o){var s,m=o.credentials?nR(o.credentials):o.credentialDefaultProvider(o),_=o.signingEscapePath,S=void 0===_||_,E=o.systemClockOffset,A=void 0===E?o.systemClockOffset||0:E,O=o.sha256;return s=o.signer?yD(o.signer):o.regionInfoProvider?function signer(){return yD(o.region)().then(function(){var s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(s){return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return m.t1=o,m.t2=s,m.next=4,o.useFipsEndpoint();case 4:return m.t3=m.sent,m.next=7,o.useDualstackEndpoint();case 7:return m.t4=m.sent,m.t5={useFipsEndpoint:m.t3,useDualstackEndpoint:m.t4},m.next=11,m.t1.regionInfoProvider.call(m.t1,m.t2,m.t5);case 11:if(m.t0=m.sent,m.t0){m.next=14;break}m.t0={};case 14:return m.t6=m.t0,m.t7=s,m.abrupt("return",[m.t6,m.t7]);case 17:case"end":return m.stop()}}),_callee)})));return function(o){return s.apply(this,arguments)}}()).then((function(s){var _=_slicedToArray$1(s,2),E=_[0],A=_[1],H=E.signingRegion,K=E.signingService;o.signingRegion=o.signingRegion||H||A,o.signingName=o.signingName||K||o.serviceId;var z=_objectSpread2(_objectSpread2({},o),{},{credentials:m,region:o.signingRegion,service:o.signingName,sha256:O,uriEscapePath:S});return new(o.signerConstructor||ZD)(z)}))}:function(){var s=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(s){var _,E,A,H;return _regeneratorRuntime$1().wrap((function _callee2$(K){for(;;)switch(K.prev=K.next){case 0:return K.t0=Object,K.t1={},K.t2=o.signingName||o.defaultSigningName,K.next=5,yD(o.region)();case 5:return K.t3=K.sent,K.t4={},K.t5={name:"sigv4",signingName:K.t2,signingRegion:K.t3,properties:K.t4},K.t6=s,s=K.t0.assign.call(K.t0,K.t1,K.t5,K.t6),_=s.signingRegion,E=s.signingName,o.signingRegion=o.signingRegion||_,o.signingName=o.signingName||E||o.serviceId,A=_objectSpread2(_objectSpread2({},o),{},{credentials:m,region:o.signingRegion,service:o.signingName,sha256:O,uriEscapePath:S}),H=o.signerConstructor||ZD,K.abrupt("return",new H(A));case 17:case"end":return K.stop()}}),_callee2)})));return function signer(o){return s.apply(this,arguments)}}(),_objectSpread2(_objectSpread2({},o),{},{systemClockOffset:A,signingEscapePath:S,credentials:m,signer:s})}(O),K=function resolveUserAgentConfig(o){return _objectSpread2(_objectSpread2({},o),{},{customUserAgent:"string"==typeof o.customUserAgent?[[o.customUserAgent]]:o.customUserAgent})}(H),z=qN(K,(null==E?void 0:E.extensions)||[]);return(o=s.call(this,z)).config=z,o.middlewareStack.use(UO(o.config)),o.middlewareStack.use(QR(o.config)),o.middlewareStack.use(PL(o.config)),o.middlewareStack.use(RL(o.config)),o.middlewareStack.use(FL(o.config)),o.middlewareStack.use(sR(o.config)),o.middlewareStack.use(WR(o.config)),o}return _createClass$1(IvsClient,[{key:"destroy",value:function destroy(){_get$1(_getPrototypeOf$1(IvsClient.prototype),"destroy",this).call(this)}}]),IvsClient}(WO),YN=function(o){_inherits$1(IvsServiceException,o);var s=_createSuper$1(IvsServiceException);function IvsServiceException(o){var m;return _classCallCheck$1(this,IvsServiceException),m=s.call(this,o),Object.setPrototypeOf(_assertThisInitialized(m),IvsServiceException.prototype),m}return _createClass$1(IvsServiceException)}(KM),QN=function(o){_inherits$1(AccessDeniedException,o);var s=_createSuper$1(AccessDeniedException);function AccessDeniedException(o){var m;return _classCallCheck$1(this,AccessDeniedException),(m=s.call(this,_objectSpread2({name:"AccessDeniedException",$fault:"client"},o))).name="AccessDeniedException",m.$fault="client",Object.setPrototypeOf(_assertThisInitialized(m),AccessDeniedException.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(AccessDeniedException)}(YN),JN=function(o){_inherits$1(PendingVerification,o);var s=_createSuper$1(PendingVerification);function PendingVerification(o){var m;return _classCallCheck$1(this,PendingVerification),(m=s.call(this,_objectSpread2({name:"PendingVerification",$fault:"client"},o))).name="PendingVerification",m.$fault="client",Object.setPrototypeOf(_assertThisInitialized(m),PendingVerification.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(PendingVerification)}(YN),ZN=function(o){_inherits$1(ThrottlingException,o);var s=_createSuper$1(ThrottlingException);function ThrottlingException(o){var m;return _classCallCheck$1(this,ThrottlingException),(m=s.call(this,_objectSpread2({name:"ThrottlingException",$fault:"client"},o))).name="ThrottlingException",m.$fault="client",Object.setPrototypeOf(_assertThisInitialized(m),ThrottlingException.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(ThrottlingException)}(YN),eU=function(o){_inherits$1(ValidationException,o);var s=_createSuper$1(ValidationException);function ValidationException(o){var m;return _classCallCheck$1(this,ValidationException),(m=s.call(this,_objectSpread2({name:"ValidationException",$fault:"client"},o))).name="ValidationException",m.$fault="client",Object.setPrototypeOf(_assertThisInitialized(m),ValidationException.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(ValidationException)}(YN),tU=function(o){_inherits$1(ResourceNotFoundException,o);var s=_createSuper$1(ResourceNotFoundException);function ResourceNotFoundException(o){var m;return _classCallCheck$1(this,ResourceNotFoundException),(m=s.call(this,_objectSpread2({name:"ResourceNotFoundException",$fault:"client"},o))).name="ResourceNotFoundException",m.$fault="client",Object.setPrototypeOf(_assertThisInitialized(m),ResourceNotFoundException.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(ResourceNotFoundException)}(YN),nU=function(o){_inherits$1(ServiceQuotaExceededException,o);var s=_createSuper$1(ServiceQuotaExceededException);function ServiceQuotaExceededException(o){var m;return _classCallCheck$1(this,ServiceQuotaExceededException),(m=s.call(this,_objectSpread2({name:"ServiceQuotaExceededException",$fault:"client"},o))).name="ServiceQuotaExceededException",m.$fault="client",Object.setPrototypeOf(_assertThisInitialized(m),ServiceQuotaExceededException.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(ServiceQuotaExceededException)}(YN),rU=function(o){_inherits$1(ConflictException,o);var s=_createSuper$1(ConflictException);function ConflictException(o){var m;return _classCallCheck$1(this,ConflictException),(m=s.call(this,_objectSpread2({name:"ConflictException",$fault:"client"},o))).name="ConflictException",m.$fault="client",Object.setPrototypeOf(_assertThisInitialized(m),ConflictException.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(ConflictException)}(YN),iU=function(o){_inherits$1(InternalServerException,o);var s=_createSuper$1(InternalServerException);function InternalServerException(o){var m;return _classCallCheck$1(this,InternalServerException),(m=s.call(this,_objectSpread2({name:"InternalServerException",$fault:"server"},o))).name="InternalServerException",m.$fault="server",Object.setPrototypeOf(_assertThisInitialized(m),InternalServerException.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(InternalServerException)}(YN),aU=function(o){_inherits$1(ChannelNotBroadcasting,o);var s=_createSuper$1(ChannelNotBroadcasting);function ChannelNotBroadcasting(o){var m;return _classCallCheck$1(this,ChannelNotBroadcasting),(m=s.call(this,_objectSpread2({name:"ChannelNotBroadcasting",$fault:"client"},o))).name="ChannelNotBroadcasting",m.$fault="client",Object.setPrototypeOf(_assertThisInitialized(m),ChannelNotBroadcasting.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(ChannelNotBroadcasting)}(YN),oU=function(o){_inherits$1(StreamUnavailable,o);var s=_createSuper$1(StreamUnavailable);function StreamUnavailable(o){var m;return _classCallCheck$1(this,StreamUnavailable),(m=s.call(this,_objectSpread2({name:"StreamUnavailable",$fault:"server"},o))).name="StreamUnavailable",m.$fault="server",Object.setPrototypeOf(_assertThisInitialized(m),StreamUnavailable.prototype),m.exceptionMessage=o.exceptionMessage,m}return _createClass$1(StreamUnavailable)}(YN),sU=function StreamKeyFilterSensitiveLog(o){return _objectSpread2(_objectSpread2({},o),o.value&&{value:yM})},uU=function BatchGetStreamKeyResponseFilterSensitiveLog(o){return _objectSpread2(_objectSpread2({},o),o.streamKeys&&{streamKeys:o.streamKeys.map((function(o){return sU(o)}))})},lU=function CreateChannelResponseFilterSensitiveLog(o){return _objectSpread2(_objectSpread2({},o),o.streamKey&&{streamKey:sU(o.streamKey)})},cU=function CreateStreamKeyResponseFilterSensitiveLog(o){return _objectSpread2(_objectSpread2({},o),o.streamKey&&{streamKey:sU(o.streamKey)})},dU=function GetStreamKeyResponseFilterSensitiveLog(o){return _objectSpread2(_objectSpread2({},o),o.streamKey&&{streamKey:sU(o.streamKey)})},hU=function PutMetadataRequestFilterSensitiveLog(o){return _objectSpread2(_objectSpread2({},o),o.metadata&&{metadata:yM})},pU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/BatchGetChannel",z=JSON.stringify(YM(o,{arns:function arns(o){return nF(o)}})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee)})));return function se_BatchGetChannelCommand(s,m){return o.apply(this,arguments)}}(),fU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee2(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee2$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/BatchGetStreamKey",z=JSON.stringify(YM(o,{arns:function arns(o){return nF(o)}})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee2)})));return function se_BatchGetStreamKeyCommand(s,m){return o.apply(this,arguments)}}(),gU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee3(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee3$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/BatchStartViewerSessionRevocation",z=JSON.stringify(YM(o,{viewerSessions:function viewerSessions(o){return nF(o)}})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee3)})));return function se_BatchStartViewerSessionRevocationCommand(s,m){return o.apply(this,arguments)}}(),mU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee4(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee4$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/CreateChannel",z=JSON.stringify(YM(o,{authorized:[],insecureIngest:[],latencyMode:[],name:[],preset:[],recordingConfigurationArn:[],tags:function tags(o){return nF(o)},type:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee4)})));return function se_CreateChannelCommand(s,m){return o.apply(this,arguments)}}(),yU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee5(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee5$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/CreateRecordingConfiguration",z=JSON.stringify(YM(o,{destinationConfiguration:function destinationConfiguration(o){return nF(o)},name:[],recordingReconnectWindowSeconds:[],renditionConfiguration:function renditionConfiguration(o){return nF(o)},tags:function tags(o){return nF(o)},thumbnailConfiguration:function thumbnailConfiguration(o){return nF(o)}})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee5)})));return function se_CreateRecordingConfigurationCommand(s,m){return o.apply(this,arguments)}}(),vU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee6(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee6$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/CreateStreamKey",z=JSON.stringify(YM(o,{channelArn:[],tags:function tags(o){return nF(o)}})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee6)})));return function se_CreateStreamKeyCommand(s,m){return o.apply(this,arguments)}}(),_U=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee7(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee7$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/DeleteChannel",z=JSON.stringify(YM(o,{arn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee7)})));return function se_DeleteChannelCommand(s,m){return o.apply(this,arguments)}}(),bU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee8(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee8$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/DeletePlaybackKeyPair",z=JSON.stringify(YM(o,{arn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee8)})));return function se_DeletePlaybackKeyPairCommand(s,m){return o.apply(this,arguments)}}(),SU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee9(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee9$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/DeleteRecordingConfiguration",z=JSON.stringify(YM(o,{arn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee9)})));return function se_DeleteRecordingConfigurationCommand(s,m){return o.apply(this,arguments)}}(),TU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee10(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee10$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/DeleteStreamKey",z=JSON.stringify(YM(o,{arn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee10)})));return function se_DeleteStreamKeyCommand(s,m){return o.apply(this,arguments)}}(),kU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee11(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee11$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/GetChannel",z=JSON.stringify(YM(o,{arn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee11)})));return function se_GetChannelCommand(s,m){return o.apply(this,arguments)}}(),CU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee12(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee12$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/GetPlaybackKeyPair",z=JSON.stringify(YM(o,{arn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee12)})));return function se_GetPlaybackKeyPairCommand(s,m){return o.apply(this,arguments)}}(),wU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee13(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee13$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/GetRecordingConfiguration",z=JSON.stringify(YM(o,{arn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee13)})));return function se_GetRecordingConfigurationCommand(s,m){return o.apply(this,arguments)}}(),xU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee14(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee14$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/GetStream",z=JSON.stringify(YM(o,{channelArn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee14)})));return function se_GetStreamCommand(s,m){return o.apply(this,arguments)}}(),EU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee15(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee15$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/GetStreamKey",z=JSON.stringify(YM(o,{arn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee15)})));return function se_GetStreamKeyCommand(s,m){return o.apply(this,arguments)}}(),IU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee16(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee16$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/GetStreamSession",z=JSON.stringify(YM(o,{channelArn:[],streamId:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee16)})));return function se_GetStreamSessionCommand(s,m){return o.apply(this,arguments)}}(),AU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee17(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee17$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/ImportPlaybackKeyPair",z=JSON.stringify(YM(o,{name:[],publicKeyMaterial:[],tags:function tags(o){return nF(o)}})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee17)})));return function se_ImportPlaybackKeyPairCommand(s,m){return o.apply(this,arguments)}}(),PU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee18(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee18$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/ListChannels",z=JSON.stringify(YM(o,{filterByName:[],filterByRecordingConfigurationArn:[],maxResults:[],nextToken:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee18)})));return function se_ListChannelsCommand(s,m){return o.apply(this,arguments)}}(),LU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee19(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee19$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/ListPlaybackKeyPairs",z=JSON.stringify(YM(o,{maxResults:[],nextToken:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee19)})));return function se_ListPlaybackKeyPairsCommand(s,m){return o.apply(this,arguments)}}(),DU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee20(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee20$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/ListRecordingConfigurations",z=JSON.stringify(YM(o,{maxResults:[],nextToken:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee20)})));return function se_ListRecordingConfigurationsCommand(s,m){return o.apply(this,arguments)}}(),RU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee21(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee21$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/ListStreamKeys",z=JSON.stringify(YM(o,{channelArn:[],maxResults:[],nextToken:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee21)})));return function se_ListStreamKeysCommand(s,m){return o.apply(this,arguments)}}(),OU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee22(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee22$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/ListStreams",z=JSON.stringify(YM(o,{filterBy:function filterBy(o){return nF(o)},maxResults:[],nextToken:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee22)})));return function se_ListStreamsCommand(s,m){return o.apply(this,arguments)}}(),MU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee23(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee23$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/ListStreamSessions",z=JSON.stringify(YM(o,{channelArn:[],maxResults:[],nextToken:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee23)})));return function se_ListStreamSessionsCommand(s,m){return o.apply(this,arguments)}}(),FU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee24(o,s){var m,_,S,E,A,O,H,K;return _regeneratorRuntime$1().wrap((function _callee24$(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,s.endpoint();case 2:return m=z.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/tags/{resourceArn}",K=tF(K,o,"resourceArn",(function(){return o.resourceArn}),"{resourceArn}",!1),z.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"GET",headers:H,path:K,body:undefined}));case 12:case"end":return z.stop()}}),_callee24)})));return function se_ListTagsForResourceCommand(s,m){return o.apply(this,arguments)}}(),NU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee25(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee25$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/PutMetadata",z=JSON.stringify(YM(o,{channelArn:[],metadata:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee25)})));return function se_PutMetadataCommand(s,m){return o.apply(this,arguments)}}(),UU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee26(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee26$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/StartViewerSessionRevocation",z=JSON.stringify(YM(o,{channelArn:[],viewerId:[],viewerSessionVersionsLessThanOrEqualTo:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee26)})));return function se_StartViewerSessionRevocationCommand(s,m){return o.apply(this,arguments)}}(),BU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee27(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee27$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/StopStream",z=JSON.stringify(YM(o,{channelArn:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee27)})));return function se_StopStreamCommand(s,m){return o.apply(this,arguments)}}(),jU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee28(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee28$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/tags/{resourceArn}",K=tF(K,o,"resourceArn",(function(){return o.resourceArn}),"{resourceArn}",!1),z=JSON.stringify(YM(o,{tags:function tags(o){return nF(o)}})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 13:case"end":return G.stop()}}),_callee28)})));return function se_TagResourceCommand(s,m){return o.apply(this,arguments)}}(),$U=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee29(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee29$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/tags/{resourceArn}",K=tF(K,o,"resourceArn",(function(){return o.resourceArn}),"{resourceArn}",!1),z=map({tagKeys:[null!=xM(o.tagKeys,"tagKeys"),function(){return(o.tagKeys||[]).map((function(o){return o}))}]}),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"DELETE",headers:H,path:K,query:z,body:undefined}));case 13:case"end":return G.stop()}}),_callee29)})));return function se_UntagResourceCommand(s,m){return o.apply(this,arguments)}}(),VU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee30(o,s){var m,_,S,E,A,O,H,K,z;return _regeneratorRuntime$1().wrap((function _callee30$(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,s.endpoint();case 2:return m=G.sent,_=m.hostname,S=m.protocol,E=void 0===S?"https":S,A=m.port,O=m.path,H={"content-type":"application/json"},K="".concat(null!=O&&O.endsWith("/")?O.slice(0,-1):O||"")+"/UpdateChannel",z=JSON.stringify(YM(o,{arn:[],authorized:[],insecureIngest:[],latencyMode:[],name:[],preset:[],recordingConfigurationArn:[],type:[]})),G.abrupt("return",new EL({protocol:E,hostname:_,port:A,method:"POST",headers:H,path:K,body:z}));case 12:case"end":return G.stop()}}),_callee30)})));return function se_UpdateChannelCommand(s,m){return o.apply(this,arguments)}}(),HU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee31(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee31$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",KU(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{channels:nF,errors:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee31)})));return function de_BatchGetChannelCommand(s,m){return o.apply(this,arguments)}}(),KU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee32(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee32$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:return E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 11:case"end":return E.stop()}}),_callee32)})));return function de_BatchGetChannelCommandError(s,m){return o.apply(this,arguments)}}(),zU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee33(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee33$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",WU(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{errors:nF,streamKeys:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee33)})));return function de_BatchGetStreamKeyCommand(s,m){return o.apply(this,arguments)}}(),WU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee34(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee34$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:return E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 11:case"end":return E.stop()}}),_callee34)})));return function de_BatchGetStreamKeyCommandError(s,m){return o.apply(this,arguments)}}(),GU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee35(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee35$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",qU(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{errors:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee35)})));return function de_BatchStartViewerSessionRevocationCommand(s,m){return o.apply(this,arguments)}}(),qU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee36(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee36$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?15:"ThrottlingException"===E.t5||"com.amazonaws.ivs#ThrottlingException"===E.t5?18:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?21:24;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:throw E.sent;case 15:return E.next=17,yj(m,s);case 18:return E.next=20,zj(m,s);case 21:return E.next=23,e$(m,s);case 24:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 26:case"end":return E.stop()}}),_callee36)})));return function de_BatchStartViewerSessionRevocationCommandError(s,m){return o.apply(this,arguments)}}(),XU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee37(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee37$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",YU(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{channel:nF,streamKey:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee37)})));return function de_CreateChannelCommand(s,m){return o.apply(this,arguments)}}(),YU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee38(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee38$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?15:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?18:"ServiceQuotaExceededException"===E.t5||"com.amazonaws.ivs#ServiceQuotaExceededException"===E.t5?21:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?24:27;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:throw E.sent;case 15:return E.next=17,yj(m,s);case 18:return E.next=20,_j(m,s);case 21:return E.next=23,wj(m,s);case 24:return E.next=26,e$(m,s);case 27:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 29:case"end":return E.stop()}}),_callee38)})));return function de_CreateChannelCommandError(s,m){return o.apply(this,arguments)}}(),QU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee39(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee39$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",JU(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{recordingConfiguration:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee39)})));return function de_CreateRecordingConfigurationCommand(s,m){return o.apply(this,arguments)}}(),JU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee40(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee40$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ConflictException"===E.t5||"com.amazonaws.ivs#ConflictException"===E.t5?15:"InternalServerException"===E.t5||"com.amazonaws.ivs#InternalServerException"===E.t5?18:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?21:"ServiceQuotaExceededException"===E.t5||"com.amazonaws.ivs#ServiceQuotaExceededException"===E.t5?24:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?27:30;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:case 29:throw E.sent;case 15:return E.next=17,JB(m,s);case 18:return E.next=20,ZB(m,s);case 21:return E.next=23,yj(m,s);case 24:return E.next=26,wj(m,s);case 27:return E.next=29,e$(m,s);case 30:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 32:case"end":return E.stop()}}),_callee40)})));return function de_CreateRecordingConfigurationCommandError(s,m){return o.apply(this,arguments)}}(),ZU=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee41(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee41$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",eB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{streamKey:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee41)})));return function de_CreateStreamKeyCommand(s,m){return o.apply(this,arguments)}}(),eB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee42(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee42$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?15:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?18:"ServiceQuotaExceededException"===E.t5||"com.amazonaws.ivs#ServiceQuotaExceededException"===E.t5?21:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?24:27;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:throw E.sent;case 15:return E.next=17,yj(m,s);case 18:return E.next=20,_j(m,s);case 21:return E.next=23,wj(m,s);case 24:return E.next=26,e$(m,s);case 27:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 29:case"end":return E.stop()}}),_callee42)})));return function de_CreateStreamKeyCommandError(s,m){return o.apply(this,arguments)}}(),tB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee43(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee43$(_){for(;;)switch(_.prev=_.next){case 0:if(!(204!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",nB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee43)})));return function de_DeleteChannelCommand(s,m){return o.apply(this,arguments)}}(),nB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee44(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee44$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ConflictException"===E.t5||"com.amazonaws.ivs#ConflictException"===E.t5?15:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?18:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?21:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?24:27;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:throw E.sent;case 15:return E.next=17,JB(m,s);case 18:return E.next=20,yj(m,s);case 21:return E.next=23,_j(m,s);case 24:return E.next=26,e$(m,s);case 27:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 29:case"end":return E.stop()}}),_callee44)})));return function de_DeleteChannelCommandError(s,m){return o.apply(this,arguments)}}(),rB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee45(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee45$(_){for(;;)switch(_.prev=_.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",iB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee45)})));return function de_DeletePlaybackKeyPairCommand(s,m){return o.apply(this,arguments)}}(),iB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee46(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee46$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?15:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?18:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?21:24;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:throw E.sent;case 15:return E.next=17,yj(m,s);case 18:return E.next=20,_j(m,s);case 21:return E.next=23,e$(m,s);case 24:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 26:case"end":return E.stop()}}),_callee46)})));return function de_DeletePlaybackKeyPairCommandError(s,m){return o.apply(this,arguments)}}(),aB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee47(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee47$(_){for(;;)switch(_.prev=_.next){case 0:if(!(204!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",oB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee47)})));return function de_DeleteRecordingConfigurationCommand(s,m){return o.apply(this,arguments)}}(),oB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee48(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee48$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ConflictException"===E.t5||"com.amazonaws.ivs#ConflictException"===E.t5?15:"InternalServerException"===E.t5||"com.amazonaws.ivs#InternalServerException"===E.t5?18:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?21:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?24:27;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:throw E.sent;case 15:return E.next=17,JB(m,s);case 18:return E.next=20,ZB(m,s);case 21:return E.next=23,_j(m,s);case 24:return E.next=26,e$(m,s);case 27:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 29:case"end":return E.stop()}}),_callee48)})));return function de_DeleteRecordingConfigurationCommandError(s,m){return o.apply(this,arguments)}}(),sB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee49(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee49$(_){for(;;)switch(_.prev=_.next){case 0:if(!(204!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",uB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee49)})));return function de_DeleteStreamKeyCommand(s,m){return o.apply(this,arguments)}}(),uB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee50(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee50$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?15:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?18:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?21:24;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:throw E.sent;case 15:return E.next=17,yj(m,s);case 18:return E.next=20,_j(m,s);case 21:return E.next=23,e$(m,s);case 24:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 26:case"end":return E.stop()}}),_callee50)})));return function de_DeleteStreamKeyCommandError(s,m){return o.apply(this,arguments)}}(),lB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee51(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee51$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",cB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{channel:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee51)})));return function de_GetChannelCommand(s,m){return o.apply(this,arguments)}}(),cB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee52(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee52$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee52)})));return function de_GetChannelCommandError(s,m){return o.apply(this,arguments)}}(),dB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee53(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee53$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",hB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{keyPair:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee53)})));return function de_GetPlaybackKeyPairCommand(s,m){return o.apply(this,arguments)}}(),hB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee54(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee54$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee54)})));return function de_GetPlaybackKeyPairCommandError(s,m){return o.apply(this,arguments)}}(),pB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee55(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee55$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",fB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{recordingConfiguration:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee55)})));return function de_GetRecordingConfigurationCommand(s,m){return o.apply(this,arguments)}}(),fB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee56(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee56$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"InternalServerException"===E.t5||"com.amazonaws.ivs#InternalServerException"===E.t5?15:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?18:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?21:24;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:throw E.sent;case 15:return E.next=17,ZB(m,s);case 18:return E.next=20,_j(m,s);case 21:return E.next=23,e$(m,s);case 24:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 26:case"end":return E.stop()}}),_callee56)})));return function de_GetRecordingConfigurationCommandError(s,m){return o.apply(this,arguments)}}(),gB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee57(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee57$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",mB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{stream:function stream(o){return t$(o)}}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee57)})));return function de_GetStreamCommand(s,m){return o.apply(this,arguments)}}(),mB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee58(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee58$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ChannelNotBroadcasting"===E.t5||"com.amazonaws.ivs#ChannelNotBroadcasting"===E.t5?15:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?18:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?21:24;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:throw E.sent;case 15:return E.next=17,QB(m,s);case 18:return E.next=20,_j(m,s);case 21:return E.next=23,e$(m,s);case 24:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 26:case"end":return E.stop()}}),_callee58)})));return function de_GetStreamCommandError(s,m){return o.apply(this,arguments)}}(),yB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee59(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee59$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",vB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{streamKey:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee59)})));return function de_GetStreamKeyCommand(s,m){return o.apply(this,arguments)}}(),vB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee60(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee60$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee60)})));return function de_GetStreamKeyCommandError(s,m){return o.apply(this,arguments)}}(),_B=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee61(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee61$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",bB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{streamSession:function streamSession(o){return i$(o)}}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee61)})));return function de_GetStreamSessionCommand(s,m){return o.apply(this,arguments)}}(),bB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee62(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee62$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee62)})));return function de_GetStreamSessionCommandError(s,m){return o.apply(this,arguments)}}(),SB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee63(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee63$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",TB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{keyPair:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee63)})));return function de_ImportPlaybackKeyPairCommand(s,m){return o.apply(this,arguments)}}(),TB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee64(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee64$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ConflictException"===E.t5||"com.amazonaws.ivs#ConflictException"===E.t5?15:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?18:"ServiceQuotaExceededException"===E.t5||"com.amazonaws.ivs#ServiceQuotaExceededException"===E.t5?21:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?24:27;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:throw E.sent;case 15:return E.next=17,JB(m,s);case 18:return E.next=20,yj(m,s);case 21:return E.next=23,wj(m,s);case 24:return E.next=26,e$(m,s);case 27:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 29:case"end":return E.stop()}}),_callee64)})));return function de_ImportPlaybackKeyPairCommandError(s,m){return o.apply(this,arguments)}}(),kB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee65(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee65$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",CB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{channels:nF,nextToken:IM}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee65)})));return function de_ListChannelsCommand(s,m){return o.apply(this,arguments)}}(),CB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee66(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee66$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ConflictException"===E.t5||"com.amazonaws.ivs#ConflictException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,JB(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee66)})));return function de_ListChannelsCommandError(s,m){return o.apply(this,arguments)}}(),wB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee67(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee67$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",xB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{keyPairs:nF,nextToken:IM}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee67)})));return function de_ListPlaybackKeyPairsCommand(s,m){return o.apply(this,arguments)}}(),xB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee68(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee68$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?15:18;break;case 12:return E.next=14,YB(m,s);case 14:case 17:throw E.sent;case 15:return E.next=17,e$(m,s);case 18:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 20:case"end":return E.stop()}}),_callee68)})));return function de_ListPlaybackKeyPairsCommandError(s,m){return o.apply(this,arguments)}}(),EB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee69(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee69$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",IB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{nextToken:IM,recordingConfigurations:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee69)})));return function de_ListRecordingConfigurationsCommand(s,m){return o.apply(this,arguments)}}(),IB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee70(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee70$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"InternalServerException"===E.t5||"com.amazonaws.ivs#InternalServerException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,ZB(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee70)})));return function de_ListRecordingConfigurationsCommandError(s,m){return o.apply(this,arguments)}}(),AB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee71(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee71$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",PB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{nextToken:IM,streamKeys:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee71)})));return function de_ListStreamKeysCommand(s,m){return o.apply(this,arguments)}}(),PB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee72(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee72$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee72)})));return function de_ListStreamKeysCommandError(s,m){return o.apply(this,arguments)}}(),LB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee73(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee73$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",DB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{nextToken:IM,streams:function streams(o){return r$(o)}}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee73)})));return function de_ListStreamsCommand(s,m){return o.apply(this,arguments)}}(),DB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee74(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee74$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?15:18;break;case 12:return E.next=14,YB(m,s);case 14:case 17:throw E.sent;case 15:return E.next=17,e$(m,s);case 18:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 20:case"end":return E.stop()}}),_callee74)})));return function de_ListStreamsCommandError(s,m){return o.apply(this,arguments)}}(),RB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee75(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee75$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",OB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{nextToken:IM,streamSessions:function streamSessions(o){return a$(o)}}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee75)})));return function de_ListStreamSessionsCommand(s,m){return o.apply(this,arguments)}}(),OB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee76(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee76$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee76)})));return function de_ListStreamSessionsCommandError(s,m){return o.apply(this,arguments)}}(),MB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee77(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee77$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",FB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{tags:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee77)})));return function de_ListTagsForResourceCommand(s,m){return o.apply(this,arguments)}}(),FB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee78(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee78$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="InternalServerException"===E.t5||"com.amazonaws.ivs#InternalServerException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,ZB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee78)})));return function de_ListTagsForResourceCommandError(s,m){return o.apply(this,arguments)}}(),NB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee79(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee79$(_){for(;;)switch(_.prev=_.next){case 0:if(!(204!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",UB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee79)})));return function de_PutMetadataCommand(s,m){return o.apply(this,arguments)}}(),UB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee80(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee80$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ChannelNotBroadcasting"===E.t5||"com.amazonaws.ivs#ChannelNotBroadcasting"===E.t5?15:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?18:"ThrottlingException"===E.t5||"com.amazonaws.ivs#ThrottlingException"===E.t5?21:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?24:27;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:throw E.sent;case 15:return E.next=17,QB(m,s);case 18:return E.next=20,_j(m,s);case 21:return E.next=23,zj(m,s);case 24:return E.next=26,e$(m,s);case 27:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 29:case"end":return E.stop()}}),_callee80)})));return function de_PutMetadataCommandError(s,m){return o.apply(this,arguments)}}(),BB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee81(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee81$(_){for(;;)switch(_.prev=_.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",jB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee81)})));return function de_StartViewerSessionRevocationCommand(s,m){return o.apply(this,arguments)}}(),jB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee82(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee82$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"InternalServerException"===E.t5||"com.amazonaws.ivs#InternalServerException"===E.t5?15:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?18:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?21:"ThrottlingException"===E.t5||"com.amazonaws.ivs#ThrottlingException"===E.t5?24:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?27:30;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:case 29:throw E.sent;case 15:return E.next=17,ZB(m,s);case 18:return E.next=20,yj(m,s);case 21:return E.next=23,_j(m,s);case 24:return E.next=26,zj(m,s);case 27:return E.next=29,e$(m,s);case 30:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 32:case"end":return E.stop()}}),_callee82)})));return function de_StartViewerSessionRevocationCommandError(s,m){return o.apply(this,arguments)}}(),$B=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee83(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee83$(_){for(;;)switch(_.prev=_.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",VB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee83)})));return function de_StopStreamCommand(s,m){return o.apply(this,arguments)}}(),VB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee84(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee84$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ChannelNotBroadcasting"===E.t5||"com.amazonaws.ivs#ChannelNotBroadcasting"===E.t5?15:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?18:"StreamUnavailable"===E.t5||"com.amazonaws.ivs#StreamUnavailable"===E.t5?21:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?24:27;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:throw E.sent;case 15:return E.next=17,QB(m,s);case 18:return E.next=20,_j(m,s);case 21:return E.next=23,$j(m,s);case 24:return E.next=26,e$(m,s);case 27:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 29:case"end":return E.stop()}}),_callee84)})));return function de_StopStreamCommandError(s,m){return o.apply(this,arguments)}}(),HB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee85(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee85$(_){for(;;)switch(_.prev=_.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",KB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee85)})));return function de_TagResourceCommand(s,m){return o.apply(this,arguments)}}(),KB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee86(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee86$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="InternalServerException"===E.t5||"com.amazonaws.ivs#InternalServerException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,ZB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee86)})));return function de_TagResourceCommandError(s,m){return o.apply(this,arguments)}}(),zB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee87(o,s){var m;return _regeneratorRuntime$1().wrap((function _callee87$(_){for(;;)switch(_.prev=_.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){_.next=2;break}return _.abrupt("return",WB(o,s));case 2:return m=map({$metadata:u$(o)}),_.next=5,gM(o.body,s);case 5:return _.abrupt("return",m);case 6:case"end":return _.stop()}}),_callee87)})));return function de_UntagResourceCommand(s,m){return o.apply(this,arguments)}}(),WB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee88(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee88$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="InternalServerException"===E.t5||"com.amazonaws.ivs#InternalServerException"===E.t5?12:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?15:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?18:21;break;case 12:return E.next=14,ZB(m,s);case 14:case 17:case 20:throw E.sent;case 15:return E.next=17,_j(m,s);case 18:return E.next=20,e$(m,s);case 21:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 23:case"end":return E.stop()}}),_callee88)})));return function de_UntagResourceCommandError(s,m){return o.apply(this,arguments)}}(),GB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee89(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee89$(E){for(;;)switch(E.prev=E.next){case 0:if(!(200!==o.statusCode&&o.statusCode>=300)){E.next=2;break}return E.abrupt("return",qB(o,s));case 2:return m=map({$metadata:u$(o)}),E.t0=xM,E.t1=EM,E.next=7,l$(o.body,s);case 7:return E.t2=E.sent,E.t3=(0,E.t1)(E.t2),_=(0,E.t0)(E.t3,"body"),S=YM(_,{channel:nF}),Object.assign(m,S),E.abrupt("return",m);case 13:case"end":return E.stop()}}),_callee89)})));return function de_UpdateChannelCommand(s,m){return o.apply(this,arguments)}}(),qB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee90(o,s){var m,_,S;return _regeneratorRuntime$1().wrap((function _callee90$(E){for(;;)switch(E.prev=E.next){case 0:return E.t0=_objectSpread2,E.t1=_objectSpread2({},o),E.t2={},E.next=5,c$(o.body,s);case 5:E.t3=E.sent,E.t4={body:E.t3},m=(0,E.t0)(E.t1,E.t2,E.t4),_=d$(o,m.body),E.t5=_,E.next="AccessDeniedException"===E.t5||"com.amazonaws.ivs#AccessDeniedException"===E.t5?12:"ConflictException"===E.t5||"com.amazonaws.ivs#ConflictException"===E.t5?15:"PendingVerification"===E.t5||"com.amazonaws.ivs#PendingVerification"===E.t5?18:"ResourceNotFoundException"===E.t5||"com.amazonaws.ivs#ResourceNotFoundException"===E.t5?21:"ValidationException"===E.t5||"com.amazonaws.ivs#ValidationException"===E.t5?24:27;break;case 12:return E.next=14,YB(m,s);case 14:case 17:case 20:case 23:case 26:throw E.sent;case 15:return E.next=17,JB(m,s);case 18:return E.next=20,yj(m,s);case 21:return E.next=23,_j(m,s);case 24:return E.next=26,e$(m,s);case 27:return S=m.body,E.abrupt("return",XB({output:o,parsedBody:S,errorCode:_}));case 29:case"end":return E.stop()}}),_callee90)})));return function de_UpdateChannelCommandError(s,m){return o.apply(this,arguments)}}(),XB=function withBaseException(o){return function(s){var m=s.output,_=s.parsedBody,S=s.errorCode;!function throwDefaultError(o){var s=o.output,m=o.parsedBody,_=o.exceptionCtor,S=o.errorCode,E=WM(s),A=E.httpStatusCode?E.httpStatusCode+"":void 0,O=new _({name:(null==m?void 0:m.code)||(null==m?void 0:m.Code)||S||A||"UnknownError",$fault:"client",$metadata:E});throw zM(O,m)}({output:m,parsedBody:_,exceptionCtor:o,errorCode:S})}}(YN),YB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee91(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee91$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new QN(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee91)})));return function de_AccessDeniedExceptionRes(s,m){return o.apply(this,arguments)}}(),QB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee92(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee92$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new aU(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee92)})));return function de_ChannelNotBroadcastingRes(s,m){return o.apply(this,arguments)}}(),JB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee93(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee93$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new rU(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee93)})));return function de_ConflictExceptionRes(s,m){return o.apply(this,arguments)}}(),ZB=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee94(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee94$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new iU(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee94)})));return function de_InternalServerExceptionRes(s,m){return o.apply(this,arguments)}}(),yj=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee95(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee95$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new JN(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee95)})));return function de_PendingVerificationRes(s,m){return o.apply(this,arguments)}}(),_j=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee96(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee96$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new tU(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee96)})));return function de_ResourceNotFoundExceptionRes(s,m){return o.apply(this,arguments)}}(),wj=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee97(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee97$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new nU(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee97)})));return function de_ServiceQuotaExceededExceptionRes(s,m){return o.apply(this,arguments)}}(),$j=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee98(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee98$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new oU(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee98)})));return function de_StreamUnavailableRes(s,m){return o.apply(this,arguments)}}(),zj=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee99(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee99$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new ZN(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee99)})));return function de_ThrottlingExceptionRes(s,m){return o.apply(this,arguments)}}(),e$=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee100(o,s){var m,_,S,E;return _regeneratorRuntime$1().wrap((function _callee100$(s){for(;;)switch(s.prev=s.next){case 0:return m=map({}),_=o.body,S=YM(_,{exceptionMessage:IM}),Object.assign(m,S),E=new eU(_objectSpread2({$metadata:u$(o)},m)),s.abrupt("return",zM(E,o.body));case 6:case"end":return s.stop()}}),_callee100)})));return function de_ValidationExceptionRes(s,m){return o.apply(this,arguments)}}(),t$=function de__Stream(o,s){return YM(o,{channelArn:IM,health:IM,playbackUrl:IM,startTime:function startTime(o){return xM(MM(o))},state:IM,streamId:IM,viewerCount:SM})},n$=function de_StreamEvents(o,s){var m=(o||[]).filter((function(o){return null!=o})).map((function(o){return function de_StreamEvent(o,s){return YM(o,{eventTime:function eventTime(o){return xM(MM(o))},name:IM,type:IM})}(o)}));return m},r$=function de_StreamList(o,s){var m=(o||[]).filter((function(o){return null!=o})).map((function(o){return s$(o)}));return m},i$=function de_StreamSession(o,s){return YM(o,{channel:nF,endTime:function endTime(o){return xM(MM(o))},ingestConfiguration:nF,recordingConfiguration:nF,startTime:function startTime(o){return xM(MM(o))},streamId:IM,truncatedEvents:function truncatedEvents(o){return n$(o)}})},a$=function de_StreamSessionList(o,s){var m=(o||[]).filter((function(o){return null!=o})).map((function(o){return o$(o)}));return m},o$=function de_StreamSessionSummary(o,s){return YM(o,{endTime:function endTime(o){return xM(MM(o))},hasErrorEvent:vM,startTime:function startTime(o){return xM(MM(o))},streamId:IM})},s$=function de_StreamSummary(o,s){return YM(o,{channelArn:IM,health:IM,startTime:function startTime(o){return xM(MM(o))},state:IM,streamId:IM,viewerCount:SM})},u$=function deserializeMetadata(o){var s,m;return{httpStatusCode:o.statusCode,requestId:null!==(s=null!==(m=o.headers["x-amzn-requestid"])&&void 0!==m?m:o.headers["x-amzn-request-id"])&&void 0!==s?s:o.headers["x-amz-request-id"],extendedRequestId:o.headers["x-amz-id-2"],cfId:o.headers["x-amz-cf-id"]}},l$=function parseBody(o,s){return function collectBodyString(o,s){return gM(o,s).then((function(o){return s.utf8Encoder(o)}))}(o,s).then((function(o){return o.length?JSON.parse(o):{}}))},c$=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee101(o,s){var m,_;return _regeneratorRuntime$1().wrap((function _callee101$(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,l$(o,s);case 2:return(_=S.sent).message=null!==(m=_.message)&&void 0!==m?m:_.Message,S.abrupt("return",_);case 5:case"end":return S.stop()}}),_callee101)})));return function parseErrorBody(s,m){return o.apply(this,arguments)}}(),d$=function loadRestJsonErrorCode(o,s){var m=function sanitizeErrorCode(o){var s=o;return"number"==typeof s&&(s=s.toString()),s.indexOf(",")>=0&&(s=s.split(",")[0]),s.indexOf(":")>=0&&(s=s.split(":")[0]),s.indexOf("#")>=0&&(s=s.split("#")[1]),s},_=function findKey(o,s){return Object.keys(o).find((function(o){return o.toLowerCase()===s.toLowerCase()}))}(o.headers,"x-amzn-errortype");return void 0!==_?m(o.headers[_]):void 0!==s.code?m(s.code):void 0!==s.__type?m(s.__type):void 0},h$=function(o){_inherits$1(BatchGetChannelCommand,o);var s=_createSuper$1(BatchGetChannelCommand);function BatchGetChannelCommand(o){var m;return _classCallCheck$1(this,BatchGetChannelCommand),(m=s.call(this)).input=o,m}return _createClass$1(BatchGetChannelCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,BatchGetChannelCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"BatchGetChannelCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"BatchGetChannel"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return pU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return HU(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),BatchGetChannelCommand}(mM),p$=function(o){_inherits$1(BatchGetStreamKeyCommand,o);var s=_createSuper$1(BatchGetStreamKeyCommand);function BatchGetStreamKeyCommand(o){var m;return _classCallCheck$1(this,BatchGetStreamKeyCommand),(m=s.call(this)).input=o,m}return _createClass$1(BatchGetStreamKeyCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,BatchGetStreamKeyCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"BatchGetStreamKeyCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:uU},xL,{service:"AmazonInteractiveVideoService",operation:"BatchGetStreamKey"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return fU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return zU(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),BatchGetStreamKeyCommand}(mM),f$=function(o){_inherits$1(BatchStartViewerSessionRevocationCommand,o);var s=_createSuper$1(BatchStartViewerSessionRevocationCommand);function BatchStartViewerSessionRevocationCommand(o){var m;return _classCallCheck$1(this,BatchStartViewerSessionRevocationCommand),(m=s.call(this)).input=o,m}return _createClass$1(BatchStartViewerSessionRevocationCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,BatchStartViewerSessionRevocationCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"BatchStartViewerSessionRevocationCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"BatchStartViewerSessionRevocation"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return gU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return GU(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),BatchStartViewerSessionRevocationCommand}(mM),g$=function(o){_inherits$1(CreateChannelCommand,o);var s=_createSuper$1(CreateChannelCommand);function CreateChannelCommand(o){var m;return _classCallCheck$1(this,CreateChannelCommand),(m=s.call(this)).input=o,m}return _createClass$1(CreateChannelCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,CreateChannelCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"CreateChannelCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:lU},xL,{service:"AmazonInteractiveVideoService",operation:"CreateChannel"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return mU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return XU(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),CreateChannelCommand}(mM),m$=function(o){_inherits$1(CreateRecordingConfigurationCommand,o);var s=_createSuper$1(CreateRecordingConfigurationCommand);function CreateRecordingConfigurationCommand(o){var m;return _classCallCheck$1(this,CreateRecordingConfigurationCommand),(m=s.call(this)).input=o,m}return _createClass$1(CreateRecordingConfigurationCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,CreateRecordingConfigurationCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"CreateRecordingConfigurationCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"CreateRecordingConfiguration"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return yU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return QU(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),CreateRecordingConfigurationCommand}(mM),y$=function(o){_inherits$1(CreateStreamKeyCommand,o);var s=_createSuper$1(CreateStreamKeyCommand);function CreateStreamKeyCommand(o){var m;return _classCallCheck$1(this,CreateStreamKeyCommand),(m=s.call(this)).input=o,m}return _createClass$1(CreateStreamKeyCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,CreateStreamKeyCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"CreateStreamKeyCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:cU},xL,{service:"AmazonInteractiveVideoService",operation:"CreateStreamKey"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return vU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return ZU(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),CreateStreamKeyCommand}(mM),v$=function(o){_inherits$1(DeleteChannelCommand,o);var s=_createSuper$1(DeleteChannelCommand);function DeleteChannelCommand(o){var m;return _classCallCheck$1(this,DeleteChannelCommand),(m=s.call(this)).input=o,m}return _createClass$1(DeleteChannelCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,DeleteChannelCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"DeleteChannelCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"DeleteChannel"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return _U(o,s)}},{key:"deserialize",value:function deserialize(o,s){return tB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),DeleteChannelCommand}(mM),_$=function(o){_inherits$1(DeletePlaybackKeyPairCommand,o);var s=_createSuper$1(DeletePlaybackKeyPairCommand);function DeletePlaybackKeyPairCommand(o){var m;return _classCallCheck$1(this,DeletePlaybackKeyPairCommand),(m=s.call(this)).input=o,m}return _createClass$1(DeletePlaybackKeyPairCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,DeletePlaybackKeyPairCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"DeletePlaybackKeyPairCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"DeletePlaybackKeyPair"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return bU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return rB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),DeletePlaybackKeyPairCommand}(mM),b$=function(o){_inherits$1(DeleteRecordingConfigurationCommand,o);var s=_createSuper$1(DeleteRecordingConfigurationCommand);function DeleteRecordingConfigurationCommand(o){var m;return _classCallCheck$1(this,DeleteRecordingConfigurationCommand),(m=s.call(this)).input=o,m}return _createClass$1(DeleteRecordingConfigurationCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,DeleteRecordingConfigurationCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"DeleteRecordingConfigurationCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"DeleteRecordingConfiguration"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return SU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return aB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),DeleteRecordingConfigurationCommand}(mM),S$=function(o){_inherits$1(DeleteStreamKeyCommand,o);var s=_createSuper$1(DeleteStreamKeyCommand);function DeleteStreamKeyCommand(o){var m;return _classCallCheck$1(this,DeleteStreamKeyCommand),(m=s.call(this)).input=o,m}return _createClass$1(DeleteStreamKeyCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,DeleteStreamKeyCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"DeleteStreamKeyCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"DeleteStreamKey"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return TU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return sB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),DeleteStreamKeyCommand}(mM),T$=function(o){_inherits$1(GetChannelCommand,o);var s=_createSuper$1(GetChannelCommand);function GetChannelCommand(o){var m;return _classCallCheck$1(this,GetChannelCommand),(m=s.call(this)).input=o,m}return _createClass$1(GetChannelCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,GetChannelCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"GetChannelCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"GetChannel"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return kU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return lB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),GetChannelCommand}(mM),k$=function(o){_inherits$1(GetPlaybackKeyPairCommand,o);var s=_createSuper$1(GetPlaybackKeyPairCommand);function GetPlaybackKeyPairCommand(o){var m;return _classCallCheck$1(this,GetPlaybackKeyPairCommand),(m=s.call(this)).input=o,m}return _createClass$1(GetPlaybackKeyPairCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,GetPlaybackKeyPairCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"GetPlaybackKeyPairCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"GetPlaybackKeyPair"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return CU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return dB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),GetPlaybackKeyPairCommand}(mM),C$=function(o){_inherits$1(GetRecordingConfigurationCommand,o);var s=_createSuper$1(GetRecordingConfigurationCommand);function GetRecordingConfigurationCommand(o){var m;return _classCallCheck$1(this,GetRecordingConfigurationCommand),(m=s.call(this)).input=o,m}return _createClass$1(GetRecordingConfigurationCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,GetRecordingConfigurationCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"GetRecordingConfigurationCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"GetRecordingConfiguration"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return wU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return pB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),GetRecordingConfigurationCommand}(mM),w$=function(o){_inherits$1(GetStreamCommand,o);var s=_createSuper$1(GetStreamCommand);function GetStreamCommand(o){var m;return _classCallCheck$1(this,GetStreamCommand),(m=s.call(this)).input=o,m}return _createClass$1(GetStreamCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,GetStreamCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"GetStreamCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"GetStream"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return xU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return gB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),GetStreamCommand}(mM),x$=function(o){_inherits$1(GetStreamKeyCommand,o);var s=_createSuper$1(GetStreamKeyCommand);function GetStreamKeyCommand(o){var m;return _classCallCheck$1(this,GetStreamKeyCommand),(m=s.call(this)).input=o,m}return _createClass$1(GetStreamKeyCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,GetStreamKeyCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"GetStreamKeyCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:dU},xL,{service:"AmazonInteractiveVideoService",operation:"GetStreamKey"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return EU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return yB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),GetStreamKeyCommand}(mM),E$=function(o){_inherits$1(GetStreamSessionCommand,o);var s=_createSuper$1(GetStreamSessionCommand);function GetStreamSessionCommand(o){var m;return _classCallCheck$1(this,GetStreamSessionCommand),(m=s.call(this)).input=o,m}return _createClass$1(GetStreamSessionCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,GetStreamSessionCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"GetStreamSessionCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"GetStreamSession"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return IU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return _B(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),GetStreamSessionCommand}(mM),I$=function(o){_inherits$1(ImportPlaybackKeyPairCommand,o);var s=_createSuper$1(ImportPlaybackKeyPairCommand);function ImportPlaybackKeyPairCommand(o){var m;return _classCallCheck$1(this,ImportPlaybackKeyPairCommand),(m=s.call(this)).input=o,m}return _createClass$1(ImportPlaybackKeyPairCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,ImportPlaybackKeyPairCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"ImportPlaybackKeyPairCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"ImportPlaybackKeyPair"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return AU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return SB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),ImportPlaybackKeyPairCommand}(mM),A$=function(o){_inherits$1(ListChannelsCommand,o);var s=_createSuper$1(ListChannelsCommand);function ListChannelsCommand(o){var m;return _classCallCheck$1(this,ListChannelsCommand),(m=s.call(this)).input=o,m}return _createClass$1(ListChannelsCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,ListChannelsCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"ListChannelsCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"ListChannels"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return PU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return kB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),ListChannelsCommand}(mM),P$=function(o){_inherits$1(ListPlaybackKeyPairsCommand,o);var s=_createSuper$1(ListPlaybackKeyPairsCommand);function ListPlaybackKeyPairsCommand(o){var m;return _classCallCheck$1(this,ListPlaybackKeyPairsCommand),(m=s.call(this)).input=o,m}return _createClass$1(ListPlaybackKeyPairsCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,ListPlaybackKeyPairsCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"ListPlaybackKeyPairsCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"ListPlaybackKeyPairs"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return LU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return wB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),ListPlaybackKeyPairsCommand}(mM),L$=function(o){_inherits$1(ListRecordingConfigurationsCommand,o);var s=_createSuper$1(ListRecordingConfigurationsCommand);function ListRecordingConfigurationsCommand(o){var m;return _classCallCheck$1(this,ListRecordingConfigurationsCommand),(m=s.call(this)).input=o,m}return _createClass$1(ListRecordingConfigurationsCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,ListRecordingConfigurationsCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"ListRecordingConfigurationsCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"ListRecordingConfigurations"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return DU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return EB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),ListRecordingConfigurationsCommand}(mM),D$=function(o){_inherits$1(ListStreamKeysCommand,o);var s=_createSuper$1(ListStreamKeysCommand);function ListStreamKeysCommand(o){var m;return _classCallCheck$1(this,ListStreamKeysCommand),(m=s.call(this)).input=o,m}return _createClass$1(ListStreamKeysCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,ListStreamKeysCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"ListStreamKeysCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"ListStreamKeys"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return RU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return AB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),ListStreamKeysCommand}(mM),R$=function(o){_inherits$1(ListStreamsCommand,o);var s=_createSuper$1(ListStreamsCommand);function ListStreamsCommand(o){var m;return _classCallCheck$1(this,ListStreamsCommand),(m=s.call(this)).input=o,m}return _createClass$1(ListStreamsCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,ListStreamsCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"ListStreamsCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"ListStreams"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return OU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return LB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),ListStreamsCommand}(mM),O$=function(o){_inherits$1(ListStreamSessionsCommand,o);var s=_createSuper$1(ListStreamSessionsCommand);function ListStreamSessionsCommand(o){var m;return _classCallCheck$1(this,ListStreamSessionsCommand),(m=s.call(this)).input=o,m}return _createClass$1(ListStreamSessionsCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,ListStreamSessionsCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"ListStreamSessionsCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"ListStreamSessions"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return MU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return RB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),ListStreamSessionsCommand}(mM),M$=function(o){_inherits$1(ListTagsForResourceCommand,o);var s=_createSuper$1(ListTagsForResourceCommand);function ListTagsForResourceCommand(o){var m;return _classCallCheck$1(this,ListTagsForResourceCommand),(m=s.call(this)).input=o,m}return _createClass$1(ListTagsForResourceCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,ListTagsForResourceCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"ListTagsForResourceCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"ListTagsForResource"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return FU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return MB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),ListTagsForResourceCommand}(mM),F$=function(o){_inherits$1(PutMetadataCommand,o);var s=_createSuper$1(PutMetadataCommand);function PutMetadataCommand(o){var m;return _classCallCheck$1(this,PutMetadataCommand),(m=s.call(this)).input=o,m}return _createClass$1(PutMetadataCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,PutMetadataCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"PutMetadataCommand",inputFilterSensitiveLog:hU,outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"PutMetadata"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return NU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return NB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),PutMetadataCommand}(mM),N$=function(o){_inherits$1(StartViewerSessionRevocationCommand,o);var s=_createSuper$1(StartViewerSessionRevocationCommand);function StartViewerSessionRevocationCommand(o){var m;return _classCallCheck$1(this,StartViewerSessionRevocationCommand),(m=s.call(this)).input=o,m}return _createClass$1(StartViewerSessionRevocationCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,StartViewerSessionRevocationCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"StartViewerSessionRevocationCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"StartViewerSessionRevocation"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return UU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return BB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),StartViewerSessionRevocationCommand}(mM),U$=function(o){_inherits$1(StopStreamCommand,o);var s=_createSuper$1(StopStreamCommand);function StopStreamCommand(o){var m;return _classCallCheck$1(this,StopStreamCommand),(m=s.call(this)).input=o,m}return _createClass$1(StopStreamCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,StopStreamCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"StopStreamCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"StopStream"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return BU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return $B(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),StopStreamCommand}(mM),B$=function(o){_inherits$1(TagResourceCommand,o);var s=_createSuper$1(TagResourceCommand);function TagResourceCommand(o){var m;return _classCallCheck$1(this,TagResourceCommand),(m=s.call(this)).input=o,m}return _createClass$1(TagResourceCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,TagResourceCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"TagResourceCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"TagResource"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return jU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return HB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),TagResourceCommand}(mM),j$=function(o){_inherits$1(UntagResourceCommand,o);var s=_createSuper$1(UntagResourceCommand);function UntagResourceCommand(o){var m;return _classCallCheck$1(this,UntagResourceCommand),(m=s.call(this)).input=o,m}return _createClass$1(UntagResourceCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,UntagResourceCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"UntagResourceCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"UntagResource"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return $U(o,s)}},{key:"deserialize",value:function deserialize(o,s){return zB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),UntagResourceCommand}(mM),V$=function(o){_inherits$1(UpdateChannelCommand,o);var s=_createSuper$1(UpdateChannelCommand);function UpdateChannelCommand(o){var m;return _classCallCheck$1(this,UpdateChannelCommand),(m=s.call(this)).input=o,m}return _createClass$1(UpdateChannelCommand,[{key:"resolveMiddleware",value:function resolveMiddleware(o,s,m){this.middlewareStack.use(getSerdePlugin(s,this.serialize,this.deserialize)),this.middlewareStack.use(mO(s,UpdateChannelCommand.getEndpointParameterInstructions()));var _=o.concat(this.middlewareStack),S=_defineProperty$2({logger:s.logger,clientName:"IvsClient",commandName:"UpdateChannelCommand",inputFilterSensitiveLog:function inputFilterSensitiveLog(o){return o},outputFilterSensitiveLog:function outputFilterSensitiveLog(o){return o}},xL,{service:"AmazonInteractiveVideoService",operation:"UpdateChannel"}),E=s.requestHandler;return _.resolve((function(o){return E.handle(o.request,m||{})}),S)}},{key:"serialize",value:function serialize(o,s){return VU(o,s)}},{key:"deserialize",value:function deserialize(o,s){return GB(o,s)}}],[{key:"getEndpointParameterInstructions",value:function getEndpointParameterInstructions(){return{UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}}}}]),UpdateChannelCommand}(mM),H$={BatchGetChannelCommand:h$,BatchGetStreamKeyCommand:p$,BatchStartViewerSessionRevocationCommand:f$,CreateChannelCommand:g$,CreateRecordingConfigurationCommand:m$,CreateStreamKeyCommand:y$,DeleteChannelCommand:v$,DeletePlaybackKeyPairCommand:_$,DeleteRecordingConfigurationCommand:b$,DeleteStreamKeyCommand:S$,GetChannelCommand:T$,GetPlaybackKeyPairCommand:k$,GetRecordingConfigurationCommand:C$,GetStreamCommand:w$,GetStreamKeyCommand:x$,GetStreamSessionCommand:E$,ImportPlaybackKeyPairCommand:I$,ListChannelsCommand:A$,ListPlaybackKeyPairsCommand:P$,ListRecordingConfigurationsCommand:L$,ListStreamKeysCommand:D$,ListStreamsCommand:R$,ListStreamSessionsCommand:O$,ListTagsForResourceCommand:M$,PutMetadataCommand:F$,StartViewerSessionRevocationCommand:N$,StopStreamCommand:U$,TagResourceCommand:B$,UntagResourceCommand:j$,UpdateChannelCommand:V$},K$=function(o){_inherits$1(Ivs,o);var s=_createSuper$1(Ivs);function Ivs(){return _classCallCheck$1(this,Ivs),s.apply(this,arguments)}return _createClass$1(Ivs)}(XN);!function createAggregatedClient(o,s){for(var m=function _loop(){var m=S[_],E=o[m],A=function(){var o=_asyncToGenerator$1(_regeneratorRuntime$1().mark((function _callee(o,s,m){var _;return _regeneratorRuntime$1().wrap((function _callee$(S){for(;;)switch(S.prev=S.next){case 0:if(_=new E(o),"function"!=typeof s){S.next=5;break}this.send(_,s),S.next=12;break;case 5:if("function"!=typeof m){S.next=11;break}if("object"==typeof s){S.next=8;break}throw new Error("Expected http options but got ".concat(typeof s));case 8:this.send(_,s||{},m),S.next=12;break;case 11:return S.abrupt("return",this.send(_,s));case 12:case"end":return S.stop()}}),_callee,this)})));return function methodImpl(s,m,_){return o.apply(this,arguments)}}(),O=(m[0].toLowerCase()+m.slice(1)).replace(/Command$/,"");s.prototype[O]=A},_=0,S=Object.keys(o);_<S.length;_++)m()}(H$,K$);var z$,W$=function(o){_inherits$1(PlayersDemoView,o);var s=_createSuper$1(PlayersDemoView);function PlayersDemoView(){var o;return _classCallCheck$1(this,PlayersDemoView),(o=s.apply(this,arguments)).widgetSizeW=1138,o.widgetSizeH=605,o.widgetPositionX=744,o.widgetPositionY=212,o.presenter={},o.textProvider={},o.buttonStyling={color:XS.get("black"),focusedColor:XS.get("eggshell"),selectedColor:XS.get("velopeGreen"),disabledColor:XS.get("black"),radius:18,stroke:3,disabledStroke:3,disabledStrokeColor:XS.get("white"),focusedStroke:0,selectedStroke:0,isSelected:!1,strokeColor:XS.get("white"),textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},disabledStyle:{fontSize:24,textColor:XS.get("eggshell")},focusedStyle:{fontSize:24,textColor:XS.get("black")},selectedStyle:{textColor:XS.get("black")}},o.onFullScreenEnabled=function(s){s.propertyName===JT&&(o.visible=!s.newValue,o.visible&&(o.controlButtonsRow.visible=!0))},o}return _createClass$1(PlayersDemoView,[{key:"_active",value:function _active(){this.appWidgets.playerwidget._progressBarView.playerSize="widget",this._setState("SetupButtonsFocused"),this.checkDeeplink()}},{key:"_focus",value:function _focus(){this.visible=!0}},{key:"_init",value:function _init(){this.presenter=a_.resolveType(DE.dependencyKeys.PlayersDemoPresenter),this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.appWidgets=this.widgets,this.presenter.propertyChanged.addListener(this.onFullScreenEnabled),this.setUpText(),this.presenter.initAsync()}},{key:"_firstEnable",value:function _firstEnable(){var o=this;this._setState("SetupButtonsFocused"),this.tag("Title").text.text="Video Player",this.announce="Video Player",this.controlButtonsRow.widget=this.appWidgets.playerwidget,this.playersColumn.items=this.presenter.playersButtonsData.map((function(s,m){var _,S,E;return"avplay"===s.player&&"tizen"!==qw.deviceType||"aamp"===s.player&&"X1"!==qw.deviceType?(_=!0,S=null,E=!0):(_=!1,E=!1,S=function onEnter(){o.setSelectedPlayerButton(m),o.appWidgets.playerwidget.player=s.player,o.playersColumn.items.forEach((function(o){return o.isSelected=!1})),o.playersColumn.selected.isSelected=!0}),Object.assign(Object.assign({w:222,h:69,type:zE,id:s.player,title:s.title,alpha:_?.4:1,skipFocus:E,disabled:_},o.buttonStyling),{onEnter:S})})),this.sourcesColumn.items=this.presenter.sourcesButtonsData.map((function(s,m){return Object.assign(Object.assign({w:243,h:69,type:zE,title:s.title,id:s.params.id},o.buttonStyling),{onEnter:function onEnter(){o.setSelectedSourceButton(m);var _=o.presenter.getAssetURL(s.params);_&&(o.appWidgets.playerwidget.source=_),o.sourcesColumn.items.forEach((function(o){return o.isSelected=!1})),o.sourcesColumn.selected.isSelected=!0,o.appWidgets.playerwidget.autoplay=o.controlButtonsRow.autoplayEnabled}})}));var s=this.widgetSizeW,m=this.widgetSizeH,_=this.widgetPositionX,S=this.widgetPositionY;qw.screenWidth===JS&&(s=calculateProportion(s,YS,JS),m=calculateProportion(m,QS,ZS),_=calculateProportion(_,YS,JS),S=calculateProportion(S,QS,ZS)),this.appWidgets.playerwidget.resize(s,m,_,S);this.appWidgets.playerwidget.positionAvailabilityMessage(this.widgetSizeW-42,this.widgetSizeH,this.widgetPositionX+21,this.widgetPositionY),this.showWidget(),this.setupBroadcasting()}},{key:"_captureUp",value:function _captureUp(){if(this.sourcesColumn.hasFocus()&&this.sourcesColumn.selectedIndex-1>=0){var o=this.presenter.sourcesButtonsData[this.sourcesColumn.selectedIndex-1].params;this.changeVideoSourceText(o)}return!1}},{key:"_captureDown",value:function _captureDown(){if(this.sourcesColumn.hasFocus()&&this.sourcesColumn.selectedIndex+1<this.sourcesColumn.items.length){var o=this.presenter.sourcesButtonsData[this.sourcesColumn.selectedIndex+1].params;this.changeVideoSourceText(o)}return!1}},{key:"_captureLeft",value:function _captureLeft(){return this.setupButtonsRow.hasFocus()&&1===this.setupButtonsRow.selectedIndex?this.sourceUrlComponent.alpha=0:this.sourceUrlComponent.alpha=1,!1}},{key:"_captureRight",value:function _captureRight(){return this.setupButtonsRow.hasFocus()&&1===this.setupButtonsRow.selectedIndex?this.sourceUrlComponent.alpha=0:this.sourceUrlComponent.alpha=1,!1}},{key:"_handleBack",value:function _handleBack(){_get$1(_getPrototypeOf$1(PlayersDemoView.prototype),"_handleBack",this).call(this),this.appWidgets.playerwidget.hide(),this.appWidgets.playerwidget.source={format:"",url:"",formattedUrl:"",type:"VOD",tags:[],id:""},this.appWidgets.playerwidget.restart(),this.sourceUrlComponent.alpha=0,this.resetButtons()}},{key:"checkDeeplink",value:function checkDeeplink(){if(this.deeplinkParams){var o=this.presenter.getAssetByID(this.deeplinkParams.assetId);if(o)if(this.appWidgets.playerwidget.source=o,this.sourcesColumn.items.forEach((function(s){s.isSelected=!1,s.id===o.id&&(s.isSelected=!0)})),"hls"===o.format)this.selectPlayerFromDeeplink("hls");else this.selectPlayerFromDeeplink("shaka")}}},{key:"selectPlayerFromDeeplink",value:function selectPlayerFromDeeplink(o){this.appWidgets.playerwidget.player=o,this.playersColumn.items.forEach((function(s){s.isSelected=!1,s.id===o&&(s.isSelected=!0)}))}},{key:"setUpText",value:function setUpText(){this.tag("Title").text.text=this.textProvider.getText(hT),this.tag("PlayerColumnTitle").text.text=this.textProvider.getText(mT),this.tag("SourceColumnTitle").text.text=this.textProvider.getText(yT),this.tag("PlayerColumnTitle").text.text=this.textProvider.getText(vT),this.tag("CurrentSourceUrl.Label").text.text=this.textProvider.getText(_T)}},{key:"_handleMediaPlayPause",value:function _handleMediaPlayPause(){!function timedMetadata(o){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var s;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return s={channelArn:BS.channelARN,metadata:o},m.next=3,new K$(US).putMetadata(s);case 3:case"end":return m.stop()}}),_callee)})))}("Sent metadata when pressing Play/Pause")}},{key:"changeVideoSourceText",value:function changeVideoSourceText(o){var s;if(null===(s=this.sourceUrlText.text)||void 0===s?void 0:s.text){var m=this.presenter.getAssetURL(o);m&&(this.sourceUrlText.text.text="[".concat(m.format.toUpperCase(),"] | ").concat(m.formattedUrl))}}},{key:"onAnnounce",value:function onAnnounce(o){qw.announce(o,!0)}},{key:"showWidget",value:function showWidget(){this.appWidgets.playerwidget.show()}},{key:"resetButtons",value:function resetButtons(){this.playersColumn.items.forEach((function(o){return o.isSelected=!1})),this.sourcesColumn.items.forEach((function(o){return o.isSelected=!1})),this.setupButtonsRow.selectedIndex=0,this.playersColumn.selectedIndex=0,this.sourcesColumn.selectedIndex=0}},{key:"setSelectedPlayerButton",value:function setSelectedPlayerButton(o){this.playersColumn.items.map((function(s,m){s.isSelected=o===m}))}},{key:"setSelectedSourceButton",value:function setSelectedSourceButton(o){this.sourcesColumn.items.map((function(s,m){s.isSelected=o===m}))}},{key:"setupBroadcasting",value:function setupBroadcasting(){var o=a_.resolveType(DE.dependencyKeys.BroadcastClient);o.initBroadcastService(),this.startBroadcastButton.onEnter=function(){o.startBroadcast(BS.streamKey)},this.stopBroadcastButton.onEnter=function(){o.stopBroadcast()}}},{key:"params",set:function set(o){this.deeplinkParams=o}},{key:"setupButtonsRow",get:function get(){return this.tag("SetupButtons")}},{key:"controlButtonsRow",get:function get(){return this.tag("ControlButtons.Buttons")}},{key:"playersColumn",get:function get(){return this.setupButtonsRow.items[0]}},{key:"sourcesColumn",get:function get(){return this.setupButtonsRow.items[1]}},{key:"sourceUrlComponent",get:function get(){return this.tag("CurrentSourceUrl")}},{key:"sourceUrlText",get:function get(){return this.tag("CurrentSourceUrl.Url")}},{key:"startBroadcastButton",get:function get(){return this.tag("StartBroadcastButton")}},{key:"stopBroadcastButton",get:function get(){return this.tag("StopBroadcastButton")}}],[{key:"_template",value:function _template(){var o={type:zE,color:XS.get("black"),focusedColor:XS.get("eggshell"),selectedColor:XS.get("velopeGreen"),radius:getLngOptimalElementSize(17),stroke:3,focusedStroke:0,selectedStroke:0,isSelected:!1,strokeColor:XS.get("white"),textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")},selectedStyle:{textColor:XS.get("black")}};return{w:1920,h:1080,Background:{w:function w(o){return o},h:function h(o){return o},rect:!0,color:XS.get("black"),shader:{w:1148,h:604,x:765,y:213,type:E.shaders.Hole}},Header:{w:function w(o){return o},h:getLngOptimalElementSize(64),y:getLngOptimalElementSize(46),zIndex:99,Logo:{w:204,h:63,x:57,src:ca.asset(eL),shader:{type:E.shaders.RoundedRectangle,radius:10}},Title:{w:402,h:64,x:getLngOptimalElementSize(308),y:9,text:{fontSize:39,wordWrapWidth:function wordWrapWidth(o){return o},textColor:XS.get("eggshell"),fontFace:XP.bold}}},ColumnTitles:{x:getLngOptimalElementSize(74),y:150,PlayerColumnTitle:{text:{fontSize:30,text:"",fontFace:XP.bold}},SourceColumnTitle:{x:309,text:{fontSize:30,text:"",fontFace:XP.bold}}},SetupButtons:{x:getLngOptimalElementSize(74),y:225,type:DP,style:{itemSpacing:72},items:[{type:RP,h:570,w:222,clipping:!0,style:{itemSpacing:36},plinko:!0},{h:591,w:246,clipping:!0,type:RP,style:{itemSpacing:36},plinko:!0}]},ControlButtons:{x:765,y:843,Buttons:{type:kL}},StartBroadcastButton:Object.assign({x:getLngOptimalElementSize(764),y:getLngOptimalElementSize(920),w:getLngOptimalElementSize(244),h:69,title:"Start Broadcast"},o),StopBroadcastButton:Object.assign({x:getLngOptimalElementSize(1064),y:getLngOptimalElementSize(920),w:getLngOptimalElementSize(244),h:69,title:"Stop Broadcast"},o),CurrentSourceUrl:{w:function w(o){return o},h:function h(o){return o},x:getLngOptimalElementSize(366),y:getLngOptimalElementSize(1002),alpha:0,Label:{w:function w(o){return o},h:36,text:{fontSize:33,text:"",fontFace:XP.bold}},Url:{x:315,w:function w(o){return o},h:function h(o){return o},text:{fontSize:27,wordWrapWidth:1848,text:"-Video URL-"}}}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(SetupButtonsFocused,o);var s=_createSuper$1(SetupButtonsFocused);function SetupButtonsFocused(){return _classCallCheck$1(this,SetupButtonsFocused),s.apply(this,arguments)}return _createClass$1(SetupButtonsFocused,[{key:"$enter",value:function $enter(){var o=this.presenter.sourcesButtonsData[this.sourcesColumn.selectedIndex].params;this.changeVideoSourceText(o)}},{key:"_getFocused",value:function _getFocused(){return this.setupButtonsRow}},{key:"_handleRight",value:function _handleRight(){this._setState("ControlButtonsFocused")}}]),SetupButtonsFocused}(this),function(o){_inherits$1(ControlButtonsFocused,o);var s=_createSuper$1(ControlButtonsFocused);function ControlButtonsFocused(){return _classCallCheck$1(this,ControlButtonsFocused),s.apply(this,arguments)}return _createClass$1(ControlButtonsFocused,[{key:"_getFocused",value:function _getFocused(){return this.controlButtonsRow}},{key:"_handleLeft",value:function _handleLeft(){this._setState("SetupButtonsFocused")}},{key:"_handleDown",value:function _handleDown(){this._setState("StartBroadcastButtonFocused")}}]),ControlButtonsFocused}(this),function(o){_inherits$1(StartBroadcastButtonFocused,o);var s=_createSuper$1(StartBroadcastButtonFocused);function StartBroadcastButtonFocused(){return _classCallCheck$1(this,StartBroadcastButtonFocused),s.apply(this,arguments)}return _createClass$1(StartBroadcastButtonFocused,[{key:"_getFocused",value:function _getFocused(){return this.startBroadcastButton}},{key:"_handleUp",value:function _handleUp(){this._setState("ControlButtonsFocused")}},{key:"_handleRight",value:function _handleRight(){this._setState("StopBroadcastButtonFocused")}},{key:"_handleLeft",value:function _handleLeft(){this._setState("SetupButtonsFocused")}}]),StartBroadcastButtonFocused}(this),function(o){_inherits$1(StopBroadcastButtonFocused,o);var s=_createSuper$1(StopBroadcastButtonFocused);function StopBroadcastButtonFocused(){return _classCallCheck$1(this,StopBroadcastButtonFocused),s.apply(this,arguments)}return _createClass$1(StopBroadcastButtonFocused,[{key:"_getFocused",value:function _getFocused(){return this.stopBroadcastButton}},{key:"_handleUp",value:function _handleUp(){this._setState("ControlButtonsFocused")}},{key:"_handleLeft",value:function _handleLeft(){this._setState("StartBroadcastButtonFocused")}}]),StopBroadcastButtonFocused}(this)]}}]),PlayersDemoView}(withTTS(aL)),G$=function(o){_inherits$1(AudioDemoView,o);var s=_createSuper$1(AudioDemoView);function AudioDemoView(){var o;return _classCallCheck$1(this,AudioDemoView),(o=s.apply(this,arguments)).presenter={},o}return _createClass$1(AudioDemoView,[{key:"_init",value:function _init(){this.presenter=a_.resolveType(DE.dependencyKeys.AudioDemoPresenter),this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.appWidgets=this.widgets,this.presenter.initAsync(),this.setUpText()}},{key:"setUpText",value:function setUpText(){this.announce=this.textProvider.getText(pT),this.tag("Title").text.text=this.textProvider.getText(pT),this.tag("PlayerColumnTitle").text.text=this.textProvider.getText(mT),this.tag("SourceColumnTitle").text.text=this.textProvider.getText(yT),this.tag("PlayerColumnTitle").text.text=this.textProvider.getText(vT),this.tag("CurrentSourceUrl.Label").text.text=this.textProvider.getText(_T)}},{key:"_firstEnable",value:function _firstEnable(){var o=this;this._setState("SetupButtonsFocused"),this.controlButtonsRow.widget=this.appWidgets.playerwidget,this.playersColumn.items=this.presenter.playersButtonsData.map((function(s,m){var _,S,E;return"avplay"===s.player&&"tizen"!==qw.deviceType||"aamp"===s.player&&"X1"!==qw.deviceType?(_=!0,S=null,E=!0):(_=!1,E=!1,S=function onEnter(){o.setSelectedPlayerButton(m),o.appWidgets.playerwidget.player=s.player,o.playersColumn.items.forEach((function(o){return o.isSelected=!1})),o.playersColumn.selected.isSelected=!0}),Object.assign(Object.assign({w:222,h:69,type:zE,title:s.title,alpha:_?.5:1,skipFocus:E,disabled:_},o.buttonStyling),{onEnter:S})})),this.sourcesColumn.items=this.presenter.sourcesButtonsData.map((function(s,m){return Object.assign(Object.assign({w:246,h:69,type:zE,title:s.title},o.buttonStyling),{onEnter:function onEnter(){o.setSelectedSourceButton(m);var _=o.presenter.getAssetURL(s.params);_&&(o.appWidgets.playerwidget.source=_),o.sourcesColumn.items.forEach((function(o){return o.isSelected=!1})),o.sourcesColumn.selected.isSelected=!0,o.appWidgets.playerwidget.autoplay=o.controlButtonsRow.autoplayEnabled}})}));var s=this.widgetSizeW,m=this.widgetSizeH,_=this.widgetPositionX,S=this.widgetPositionY;qw.screenWidth===JS&&(s=calculateProportion(s,YS,JS),m=calculateProportion(m,QS,ZS),_=calculateProportion(_,YS,JS),S=calculateProportion(S,QS,ZS)),this.appWidgets.playerwidget.resize(s,m,_,S),this.appWidgets.playerwidget.positionAvailabilityMessage(this.widgetSizeW,this.widgetSizeH,this.widgetPositionX,this.widgetPositionY),this.showWidget()}},{key:"onAnnounce",value:function onAnnounce(o){qw.announce(o,!0)}},{key:"changeVideoSourceText",value:function changeVideoSourceText(o){var s;if(null===(s=this.sourceUrlText.text)||void 0===s?void 0:s.text){var m=this.presenter.getAssetURL(o);m&&(this.sourceUrlText.text.text="[".concat(m.format.toUpperCase(),"] | ").concat(m.formattedUrl))}}},{key:"resetButtons",value:function resetButtons(){this.playersColumn.items.forEach((function(o){return o.isSelected=!1})),this.sourcesColumn.items.forEach((function(o){return o.isSelected=!1})),this.setupButtonsRow.selectedIndex=0,this.playersColumn.selectedIndex=0,this.sourcesColumn.selectedIndex=0}}]),AudioDemoView}(withTTS(W$)),q$=function(){function DependencyRegistry(){_classCallCheck$1(this,DependencyRegistry),this.typeMappings=[],this.dependencyKeys={LogStorage:"LogStorage",API:"API",Store:"Store",Profiling:"Profiling",Logger:"Logger"}}return _createClass$1(DependencyRegistry,[{key:"registerType",value:function registerType(o,s){var m=this.typeMappings.findIndex((function(o){return o.token===s}));-1!==m?this.typeMappings[m]={instance:o,token:s}:this.typeMappings.push({instance:o,token:s})}},{key:"resolveType",value:function resolveType(o){var s=this.typeMappings.find((function(s){return s.token===o}));if(!s)throw new Error("Type registration not found for type ".concat(o));return s.instance}}]),DependencyRegistry}(),X$=new q$,Y$=function(){function DebugProxy(){_classCallCheck$1(this,DebugProxy),this._isStarted=!1}return _createClass$1(DebugProxy,[{key:"startProxy",value:function startProxy(o){if(this._isStarted)console.error("Error starting DebugProxy; it is already started");else{o.indexOf(":")<0&&(o+=":8888"),this._isStarted=!0,console.warn("DebugProxy started using proxyAddress=".concat(o));var s="http://".concat(o,"/;"),m=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(_,S,E,A,O){(S=S.toString()).toString().indexOf(o)<0&&(S="".concat(s).concat(S)),m.bind(this)(_,S.toString(),!!E,A,O)};var _=window.fetch;window.fetch=function(m,S){var E=m.toString();return E.toString().indexOf(o)<0&&(E="".concat(s).concat(E)),_(E,S)}}}}]),DebugProxy}();new Y$,function(o){o[o.ERROR=1]="ERROR",o[o.WARN=2]="WARN",o[o.INFO=3]="INFO",o[o.DEBUG=4]="DEBUG",o[o.PERFORMANCE=5]="PERFORMANCE"}(z$||(z$={}));var __awaiter$7=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},Q$={0:"Playing",1:"Paused",2:"Ended"},J$=[["m3u8","hls"],["mpd","dash"],["mp4","mp4"]],Z$=function(){function AMPPlayer(o){var s,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{min:0,max:0},_=arguments.length>2?arguments[2]:void 0,S=arguments.length>3?arguments[3]:void 0,E=arguments.length>4?arguments[4]:void 0;_classCallCheck$1(this,AMPPlayer),this.eventListeners={},this._width=1920,this._height=1080,this._scaleFactor=100,this._xPos=0,this._yPos=0,this._duration=0,this._currentTime=0,this._ccEnabled=!1,this.shouldRetryOnFailure=!1,this.errorCount=0,this.retryAttempts=2,this.retryWaitTime=0,this.playerURL="",this.timeoutId=null,this.logger=X$.resolveType(X$.dependencyKeys.Logger),this.shouldRetryOnFailure=null!=_&&_,this.retryAttempts=null!=S?S:2,this.retryWaitTime=null!=E?E:this.retryWaitTime,this._bitrateRange=m;try{window.fmw.isLoaded(),this.fmw=window.fmw;var A=null!=o?o:this._width;A!==this._width&&this.size(A)}catch(o){null===(s=this.logger)||void 0===s||s.error("Could not initialize Application Media Player: ".concat(JSON.stringify(o)))}}return _createClass$1(AMPPlayer,[{key:"open",value:function open(o){var s=this;return this.playerURL=o,this.timeoutId&&(clearTimeout(Number(this.timeoutId)),this.timeoutId=null),new Promise((function(m,_){var S,E,A;try{var O=s.getFormat(o);null===(S=s.fmw)||void 0===S||S.amp.type(O),null===(E=s.fmw)||void 0===E||E.amp.start(o,(function(){var o;null===(o=s.fmw)||void 0===o||o.amp.play(0,(function(){var o;null===(o=s.fmw)||void 0===o||o.amp.duration((function(o){s._duration=o}))}))})),m()}catch(o){null===(A=s.logger)||void 0===A||A.error("Could not open stream: ".concat(JSON.stringify(o))),_()}}))}},{key:"close",value:function close(){var o;return __awaiter$7(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:null===(o=this.fmw)||void 0===o||o.amp.stop();case 1:case"end":return s.stop()}}),_callee,this)})))}},{key:"size",value:function size(o){var s;this._scaleFactor=o/this._width*100,null===(s=this.fmw)||void 0===s||s.amp.scale({scaleFactor:this._scaleFactor,xPos:this._xPos,yPos:this._yPos})}},{key:"position",value:function position(o,s){var m;this._xPos=o/this._width*100,this._yPos=s/this._height*100,null===(m=this.fmw)||void 0===m||m.amp.scale({scaleFactor:this._scaleFactor,xPos:this._xPos,yPos:this._yPos})}},{key:"mute",value:function mute(){}},{key:"unmute",value:function unmute(){}},{key:"play",value:function play(){return __awaiter$7(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){var o=this;return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s){var m;null===(m=o.fmw)||void 0===m||m.amp.play(0,(function(){return s()}))})));case 1:case"end":return s.stop()}}),_callee2)})))}},{key:"pause",value:function pause(){return __awaiter$7(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){var o=this;return _regeneratorRuntime$1().wrap((function _callee3$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s){var m;null===(m=o.fmw)||void 0===m||m.amp.pause((function(){return s()}))})));case 1:case"end":return s.stop()}}),_callee3)})))}},{key:"seek",value:function seek(o){return __awaiter$7(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){var s=this;return _regeneratorRuntime$1().wrap((function _callee4$(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise((function(m){var _;null===(_=s.fmw)||void 0===_||_.amp.setCurrentTime(o,(function(){return m()}))})));case 1:case"end":return m.stop()}}),_callee4)})))}},{key:"loop",value:function loop(o){var s;null===(s=this.fmw)||void 0===s||s.amp.loop(o)}},{key:"isFormatSupported",value:function isFormatSupported(){return!0}},{key:"registerEventListeners",value:function registerEventListeners(o){var s,m,_=this;for(var S in null===(s=this.fmw)||void 0===s||s.ampMediaTimeChange((function(o){var s=o.currentTime;_._currentTime=s,_.handleEvent("TimeUpdate")})),null===(m=this.fmw)||void 0===m||m.ampPlaybackStateChange((function(o){var s=o.playbackState,m=s in Q$?Q$[s]:"";_.handleEvent(m)})),Q$)this.on(Q$[S],o);this.on("TimeUpdate",o)}},{key:"deregisterEventListeners",value:function deregisterEventListeners(){var o,s;null===(o=this.fmw)||void 0===o||o.ampMediaTimeChange((function(){})),null===(s=this.fmw)||void 0===s||s.ampPlaybackStateChange((function(){})),this.eventListeners={}}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(o,s){this.on(o,s)}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(o){this.eventListeners[o]=[]}},{key:"handleEvent",value:function handleEvent(o){var s=this;if(o&&this.eventListeners[o]){var m={type:o,timestamp:(new Date).getTime(),metadata:{}};if("Error"===o)if(this.shouldRetryOnFailure&&this.errorCount<=this.retryAttempts){this.errorCount++;var _=this.retryWaitTime>0?this.retryWaitTime:1e3*this.errorCount;this.timeoutId=setTimeout((function(){return __awaiter$7(s,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.open(this.playerURL);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),_callee5,this)})))}),_)}else this.errorCount=0,o in this.eventListeners&&this.eventListeners[o].forEach((function(o){return o(m)}));o in this.eventListeners&&this.eventListeners[o].forEach((function(o){return o(m)}))}}},{key:"onPlayerEvent",set:function set(o){this.registerEventListeners(o)}},{key:"on",value:function on(o,s){this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push(s)}},{key:"fastForward",value:function fastForward(o){return __awaiter$7(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this.seek(this.currentTime+o);case 2:case"end":return s.stop()}}),_callee6,this)})))}},{key:"rewind",value:function rewind(o){return __awaiter$7(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee7(){var s;return _regeneratorRuntime$1().wrap((function _callee7$(m){for(;;)switch(m.prev=m.next){case 0:return s=this.currentTime-o,m.next=3,this.seek(Math.max(s,0));case 3:case"end":return m.stop()}}),_callee7,this)})))}},{key:"status",value:function status(){return __awaiter$7(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee8(){var o=this;return _regeneratorRuntime$1().wrap((function _callee8$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s,m){var _;null===(_=o.fmw)||void 0===_||_.amp.state((function(_,S){var E=S.playbackState;_?(o.logger.error("Application Media Player | ".concat(JSON.stringify(_))),m("Error")):s(Q$[E])}))})));case 1:case"end":return s.stop()}}),_callee8)})))}},{key:"getFormat",value:function getFormat(o){for(var s in J$)if(o.includes(J$[s][0]))return J$[s][1];return"auto"}},{key:"destroy",value:function destroy(){return __awaiter$7(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee9(){return _regeneratorRuntime$1().wrap((function _callee9$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return");case 1:case"end":return o.stop()}}),_callee9)})))}},{key:"hide",value:function hide(){}},{key:"show",value:function show(){}},{key:"renderCC",value:function renderCC(){}},{key:"isPlaying",get:function get(){return!1}},{key:"currentTime",get:function get(){return this._currentTime}},{key:"duration",get:function get(){return this._duration}},{key:"width",get:function get(){return this._width*this._scaleFactor/100}},{key:"height",get:function get(){return this._height*this._scaleFactor/100}},{key:"ccEnabled",get:function get(){return this._ccEnabled},set:function set(o){var s,m;this._ccEnabled=o,this._ccEnabled?null===(s=this.fmw)||void 0===s||s.amp.showtracks():null===(m=this.fmw)||void 0===m||m.amp.hidetracks()}},{key:"bitrateRange",get:function get(){return this._bitrateRange}},{key:"ccAvailable",get:function get(){return!1}}]),AMPPlayer}(),__awaiter$6=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},eV={0:"Playing",1:"Paused",2:"Ended"},tV=function(){function RMPPlayer(o){var s;_classCallCheck$1(this,RMPPlayer),this.timeInterval=null,this._width=1920,this._height=1080,this._scaleFactor=100,this._xPos=0,this._yPos=0,this.times={startTime:0,endTime:0,liveTime:0,startoverTime:0,currentTime:0},this.logger=X$.resolveType(X$.dependencyKeys.Logger);try{window.fmw.isLoaded(),this.fmw=window.fmw;var m=null!=o?o:this._width;m!==this._width&&this.size(m)}catch(o){null===(s=this.logger)||void 0===s||s.error("Could not initialize Receiver Media Player: ".concat(JSON.stringify(o)))}}return _createClass$1(RMPPlayer,[{key:"open",value:function open(o){var s=this;return new Promise((function(m,_){var S,E,A;try{null===(S=s.fmw)||void 0===S||S.rmp.stop(),null===(E=s.fmw)||void 0===E||E.rmp.start(o,(function(){var o;null===(o=s.fmw)||void 0===o||o.rmp.play()})),s.times={startTime:0,endTime:0,liveTime:0,startoverTime:0,currentTime:0},s.timeInterval&&clearInterval(s.timeInterval),s.registerEventListeners(),m()}catch(o){null===(A=s.logger)||void 0===A||A.error("Could not open stream: ".concat(JSON.stringify(o))),_()}}))}},{key:"close",value:function close(){var o;return __awaiter$6(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:null===(o=this.fmw)||void 0===o||o.rmp.stop();case 1:case"end":return s.stop()}}),_callee,this)})))}},{key:"size",value:function size(o){var s;this._scaleFactor=o/this._width*100,null===(s=this.fmw)||void 0===s||s.rmp.scale({scaleFactor:this._scaleFactor,xPos:this._xPos,yPos:this._yPos})}},{key:"position",value:function position(o,s){var m;this._xPos=o/this._width*100,this._yPos=s/this._height*100,null===(m=this.fmw)||void 0===m||m.rmp.scale({scaleFactor:this._scaleFactor,xPos:this._xPos,yPos:this._yPos})}},{key:"mute",value:function mute(){}},{key:"unmute",value:function unmute(){}},{key:"play",value:function play(){return __awaiter$6(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){var o=this;return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s){var m;null===(m=o.fmw)||void 0===m||m.rmp.play((function(){return s()}))})));case 1:case"end":return s.stop()}}),_callee2)})))}},{key:"pause",value:function pause(){return __awaiter$6(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){var o=this;return _regeneratorRuntime$1().wrap((function _callee3$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s){var m;null===(m=o.fmw)||void 0===m||m.rmp.pause((function(){return s()}))})));case 1:case"end":return s.stop()}}),_callee3)})))}},{key:"loop",value:function loop(){}},{key:"isFormatSupported",value:function isFormatSupported(){return!0}},{key:"registerEventListeners",value:function registerEventListeners(){var o,s=this;null===(o=this.fmw)||void 0===o||o.rmpMediaTimeChange((function(o){s.times.currentTime=o.currentTime,0===s.times.liveTime&&o.currentTime>0&&(s.times.liveTime=o.currentTime,s.times.startoverTime=o.currentTime,s.times.startTime=o.currentTime-60,s.times.endTime=s.times.startTime+3e3,s.timeInterval=setInterval((function(){s.times.liveTime+=1}),1e3))}))}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(){}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(){}},{key:"deregisterEventListeners",value:function deregisterEventListeners(){var o;null===(o=this.fmw)||void 0===o||o.rmpMediaTimeChange((function(){}))}},{key:"resume",value:function resume(){var o;null===(o=this.fmw)||void 0===o||o.rmp.resume()}},{key:"status",value:function status(){return __awaiter$6(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){var o=this;return _regeneratorRuntime$1().wrap((function _callee4$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s,m){var _;null===(_=o.fmw)||void 0===_||_.rmp.state((function(_,S){var E=S.playbackState;_?(o.logger.error("Receiver Media Player | ".concat(JSON.stringify(_))),m("Error")):s(eV[E])}))})));case 1:case"end":return s.stop()}}),_callee4)})))}},{key:"seek",value:function seek(){return __awaiter$6(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return");case 1:case"end":return o.stop()}}),_callee5)})))}},{key:"handleEvent",value:function handleEvent(){}},{key:"onPlayerEvent",set:function set(o){}},{key:"destroy",value:function destroy(){return __awaiter$6(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return");case 1:case"end":return o.stop()}}),_callee6)})))}},{key:"hide",value:function hide(){}},{key:"show",value:function show(){}},{key:"renderCC",value:function renderCC(){}},{key:"isPlaying",get:function get(){return!1}},{key:"currentTime",get:function get(){return this.times.currentTime||0}},{key:"duration",get:function get(){return this.times.startTime-this.times.endTime}},{key:"width",get:function get(){return this._width*this._scaleFactor/100}},{key:"height",get:function get(){return this._height*this._scaleFactor/100}},{key:"bitrateRange",get:function get(){return{min:0,max:0}}},{key:"ccEnabled",get:function get(){return!1},set:function set(o){}},{key:"ccAvailable",get:function get(){return!1}}]),RMPPlayer}(),nV=function(o){_inherits$1(CarouselView,o);var s=_createSuper$1(CarouselView);function CarouselView(){return _classCallCheck$1(this,CarouselView),s.apply(this,arguments)}return _createClass$1(CarouselView,[{key:"_getFocused",value:function _getFocused(){return this._carousel}},{key:"appendItems",value:function appendItems(o){this._carousel.appendItems(o)}},{key:"appendItemsAt",value:function appendItemsAt(o,s){this._carousel.appendItemsAt(o,s)}},{key:"removeItemAt",value:function removeItemAt(o){this._carousel.removeItemAt(o)}},{key:"items",get:function get(){return this._carousel.items},set:function set(o){this._carousel.items=o}},{key:"itemSpacing",set:function set(o){this._carousel.patch({itemSpacing:o})}},{key:"titleElement",get:function get(){return this.tag("Title")},set:function set(o){var s=o.text;s&&(this.h=this.h+80),this.patch(Object.assign({Title:Object.assign(Object.assign({},s&&{h:80,alpha:1}),{text:Object.assign({},o)})},s&&{Carousel:{y:70}}))}},{key:"selectedIndex",get:function get(){return this._carousel.selectedIndex},set:function set(o){this._carousel.selectedIndex=o}},{key:"selected",get:function get(){return this._carousel.selected}},{key:"_carousel",get:function get(){return this.tag("Carousel")}},{key:"carouselDirection",get:function get(){return this._carousel.direction},set:function set(o){this._carousel.direction=o}},{key:"wrapSelected",set:function set(o){this._carousel.wrapSelected=o}},{key:"scrollIndex",set:function set(o){this._carousel.scrollIndex=o}},{key:"style",set:function set(o){this._carousel.style=o}},{key:"carouselClipping",set:function set(o){this._carousel.clipping=o}},{key:"lazyScroll",set:function set(o){this._carousel.lazyScroll=o}},{key:"height",set:function set(o){this.h=o,this._carousel.h=o}},{key:"width",set:function set(o){this._carousel.w=o}},{key:"xOffset",set:function set(o){this.patch({Title:{x:o},Carousel:{x:o}})}},{key:"plinko",set:function set(o){this._carousel.plinko=o}},{key:"maxAmount",get:function get(){return this._carousel.maxAmount},set:function set(o){this._carousel.maxAmount=o}}],[{key:"_template",value:function _template(){return{x:5,Title:{alpha:0,text:{}},Carousel:{type:OP,direction:"column",useShadow:!1,alwaysScroll:!1}}}}]),CarouselView}(E.Component),rV=function(o){_inherits$1(SoundboardView,o);var s=_createSuper$1(SoundboardView);function SoundboardView(){var o;return _classCallCheck$1(this,SoundboardView),(o=s.apply(this,arguments)).presenter={},o.sfxTagArray=[],o.logger={},o.ampLooping=!1,o}return _createClass$1(SoundboardView,[{key:"_init",value:function _init(){this.presenter=a_.resolveType(DE.dependencyKeys.SoundBoardPresenter),this.logger=a_.resolveType(a_.dependencyKeys.Logger),this.setupUI()}},{key:"_active",value:function _active(){this._setState("SourcesFocused")}},{key:"getButtonTemplate",value:function getButtonTemplate(o){var s=this;return{title:o.title,w:380,h:55,color:XS.get("black"),focusedColor:XS.get("eggshell"),selectedColor:XS.get("velopeGreen"),radius:17,stroke:3,strokeColor:XS.get("white"),focusedStroke:0,paddingW:0,textStyle:{wordWrapWidth:260,fontSize:24,textAlign:"center",textColor:XS.get("eggshell")},focusedStyle:{wordWrapWidth:260,fontSize:24,textColor:XS.get("black"),textAlign:"center"},onEnter:function onEnter(){return s.switchPlayer(o.params)},type:zE}}},{key:"getCheckBoxTemplate",value:function getCheckBoxTemplate(o){var s=this;return{title:"Loop",w:60,h:60,id:o.params.sfx,color:XS.get("black"),focusedColor:XS.get("eggshell"),selectedColor:XS.get("velopeGreen"),radius:17,stroke:3,strokeColor:XS.get("white"),focusedStroke:0,selectedStroke:0,textStyle:{wordWrapWidth:60,fontSize:20,textAlign:"center",textColor:XS.get("eggshell")},focusedStyle:{wordWrapWidth:60,fontSize:20,textColor:XS.get("black"),textAlign:"center"},isSelected:!1,onEnter:function onEnter(){s.loopSfx(o.params)},type:zE}}},{key:"setupUI",value:function setupUI(){var o=this;this.htmlSourcesButtons.items=this.presenter.htmlSourceButtons.map((function(s){return o.setUpRowTemplate(s)})),this.audioAPISourcesButtons.items=this.presenter.audioAPISourceButtons.map((function(s){return o.setUpRowTemplate(s)})),this.ampSourcesButtons.items=this.presenter.ampSourceButtons.map((function(s){return o.setUpRowTemplate(s)})),this.rmpSourcesButtons.items=this.presenter.rmpSourceButtons.map((function(s){return o.setUpRowTemplate(s)})),this.stopAllButton.patch({onEnter:function onEnter(){return o.stopAllSfx()}}),this.clipControlButton.patch({onEnter:function onEnter(){return o.playPauseClip()}})}},{key:"setUpRowTemplate",value:function setUpRowTemplate(o){return{type:DP,w:440,h:60,neverScroll:!0,style:{itemSpacing:10},items:[this.getButtonTemplate(o),this.getCheckBoxTemplate(o)]}}},{key:"switchPlayer",value:function switchPlayer(o){switch(o.player){case"html":this.setupHTMLPlayer(o);break;case"amp":this.initAMP(),this.initRMP(),this.ampSetup(o);break;case"rmp":this.initAMP(),this.initRMP(),this.rmpSetup(o);break;case"audioAPI":this.setupAudioAPI(o)}}},{key:"loopSfx",value:function loopSfx(o){if("amp"===o.player)this.ampPlayer&&(this.ampLooping=!this.ampLooping,this.ampPlayer.loop(this.ampLooping),this.focusedButton.isSelected=!this.focusedButton.isSelected);else if("audioAPI"===o.player||"html"===o.player){var s=this.sfxTagArray.find((function(s){return s.id===o.sfx}));s&&(s.loop=!s.loop,this.focusedButton.isSelected=!this.focusedButton.isSelected)}}},{key:"stopAllSfx",value:function stopAllSfx(){var o,s;this.sfxTagArray.forEach((function(o){o.pause()})),this.sfxTagArray.forEach((function(o){o.pause()})),null===(o=this.ampPlayer)||void 0===o||o.close(),null===(s=this.rmpPlayer)||void 0===s||s.close()}},{key:"playPauseClip",value:function playPauseClip(){this._handleMediaPlayPause()}},{key:"setupHTMLPlayer",value:function setupHTMLPlayer(o){var s=this.sfxTagArray.find((function(s){if(s.id===o.sfx)return s}));if(!s){var m=this.createAudioTag(o.sfx);m.src=o.route,this.sfxTagArray.push(m),s=m}null==s||s.play()}},{key:"createAudioTag",value:function createAudioTag(o){var s=document.createElement("audio");return document.body.appendChild(s),s.id=o,s}},{key:"initAMP",value:function initAMP(){this.ampPlayer||(this.ampPlayer=new Z$)}},{key:"ampSetup",value:function ampSetup(o){var s,m,_=this;null===(s=this.ampPlayer)||void 0===s||s.close(),null===(m=this.rmpPlayer)||void 0===m||m.close().then((function(){var s;null===(s=_.ampPlayer)||void 0===s||s.open(o.route).then((function(){"tearsOfSteel"===o.sfx&&(_.activeVideoPlayer=_.ampPlayer)})).catch((function(o){return _.logger.error("AMP Player Error on soudboard view' ".concat(o))}))}))}},{key:"initRMP",value:function initRMP(){this.rmpPlayer||(this.rmpPlayer=new tV)}},{key:"rmpSetup",value:function rmpSetup(o){var s,m,_=this;null===(s=this.rmpPlayer)||void 0===s||s.close(),null===(m=this.ampPlayer)||void 0===m||m.close().then((function(){var s;null===(s=_.rmpPlayer)||void 0===s||s.open(o.route).then((function(){"tearsOfSteel"===o.sfx&&(_.activeVideoPlayer=_.rmpPlayer)})).catch((function(o){return _.logger.error("RMP Player Error on soudboard view' ".concat(o))}))}))}},{key:"_handleMediaPlayPause",value:function _handleMediaPlayPause(){var o,s,m;return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,null===(o=this.activeVideoPlayer)||void 0===o?void 0:o.status();case 2:"Playing"===_.sent?null===(s=this.activeVideoPlayer)||void 0===s||s.pause():null===(m=this.activeVideoPlayer)||void 0===m||m.play();case 4:case"end":return _.stop()}}),_callee,this)})))}},{key:"setupAudioAPI",value:function setupAudioAPI(o){this.webAudioContext||(this.webAudioContext=new AudioContext);var s=this.sfxTagArray.find((function(s){if(s.id===o.sfx)return s}));if(!s){var m=this.createAudioTag(o.sfx);this.webAudioContext.createMediaElementSource(m).connect(this.webAudioContext.destination),this.sfxTagArray.push(m),s=m}this.webAudioContext&&(s.src=o.route,"suspended"===this.webAudioContext.state&&this.webAudioContext.resume()),s.play()}},{key:"sfxButtons",get:function get(){return this.tag("SfxButtons")}},{key:"htmlSourcesButtons",get:function get(){return this.sfxButtons.items[0]}},{key:"audioAPISourcesButtons",get:function get(){return this.sfxButtons.items[1]}},{key:"ampSourcesButtons",get:function get(){return this.sfxButtons.items[2]}},{key:"rmpSourcesButtons",get:function get(){return this.sfxButtons.items[3]}},{key:"stopAllButton",get:function get(){return this.tag("StopAll")}},{key:"clipControlButton",get:function get(){return this.tag("ClipControl")}},{key:"focusedButton",get:function get(){return this.sfxButtons.selected.selected.selected}}],[{key:"_template",value:function _template(){var o={color:XS.get("black"),focusedColor:XS.get("eggshell"),selectedColor:XS.get("velopeGreen"),radius:17,stroke:3,strokeColor:XS.get("white"),focusedStroke:0,textStyle:{wordWrapWidth:260,fontSize:24,textAlign:"center",textColor:XS.get("eggshell")},focusedStyle:{wordWrapWidth:260,fontSize:24,textAlign:"center",textColor:XS.get("black")}};return{w:1920,h:1080,Background:{w:function w(o){return o},h:function h(o){return o},rect:!0,color:XS.get("clear")},SfxButtons:{w:1460,h:800,x:340,y:60,type:DP,clipping:!0,items:[{w:500,h:780,type:nV,titleElement:{text:"Audio Tag",textColor:XS.get("velopeGreen"),fontSize:32,letterSpacing:2,fontFace:"bold"},clipping:!0,plinko:!0},{w:500,h:780,type:nV,titleElement:{text:"Web Audio API",textColor:XS.get("velopeGreen"),fontSize:32,letterSpacing:2,fontFace:"bold"},clipping:!0,plinko:!0},{w:500,h:780,type:nV,titleElement:{text:"Run3 AMP Player",textColor:XS.get("velopeGreen"),fontSize:32,letterSpacing:2,fontFace:"bold"},clipping:!0,plinko:!0},{w:500,h:780,type:nV,titleElement:{text:"Run3 RMP Player",textColor:XS.get("velopeGreen"),fontSize:32,letterSpacing:2,fontFace:"bold"},clipping:!0,plinko:!0}]},StopAll:Object.assign({title:"Stop ALL",x:50,y:332,w:240,h:55,type:zE},o),ClipControl:Object.assign({title:"Play/Pause Clip",x:50,y:460,w:240,h:55},o)}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(SourcesFocused,o);var s=_createSuper$1(SourcesFocused);function SourcesFocused(){return _classCallCheck$1(this,SourcesFocused),s.apply(this,arguments)}return _createClass$1(SourcesFocused,[{key:"_getFocused",value:function _getFocused(){return this.sfxButtons}},{key:"_handleLeft",value:function _handleLeft(){this._setState("StopAllFocused")}}]),SourcesFocused}(this),function(o){_inherits$1(StopAllFocused,o);var s=_createSuper$1(StopAllFocused);function StopAllFocused(){return _classCallCheck$1(this,StopAllFocused),s.apply(this,arguments)}return _createClass$1(StopAllFocused,[{key:"_getFocused",value:function _getFocused(){return this.stopAllButton}},{key:"_handleRight",value:function _handleRight(){this._setState("SourcesFocused")}},{key:"_handleDown",value:function _handleDown(){this._setState("ClipButtonFocused")}}]),StopAllFocused}(this),function(o){_inherits$1(ClipButtonFocused,o);var s=_createSuper$1(ClipButtonFocused);function ClipButtonFocused(){return _classCallCheck$1(this,ClipButtonFocused),s.apply(this,arguments)}return _createClass$1(ClipButtonFocused,[{key:"_getFocused",value:function _getFocused(){return this.clipControlButton}},{key:"_handleRight",value:function _handleRight(){this._setState("SourcesFocused")}},{key:"_handleUp",value:function _handleUp(){this._setState("StopAllFocused")}}]),ClipButtonFocused}(this)]}}]),SoundboardView}(aL),iV=function(o){_inherits$1(DetailsView,o);var s=_createSuper$1(DetailsView);function DetailsView(){var o;return _classCallCheck$1(this,DetailsView),(o=s.apply(this,arguments)).presenter={},o.assetId="",o}return _createClass$1(DetailsView,[{key:"_init",value:function _init(){this.playButton.onEnter=function(){Oy.navigate("playerDemo")},this.presenter=a_.resolveType(DE.dependencyKeys.DetailsPresenter)}},{key:"_active",value:function _active(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:if(this.assetData){o.next=9;break}return o.prev=1,o.next=4,this.presenter.fetchAssetData(this.assetId);case 4:o.next=9;break;case 6:o.prev=6,o.t0=o.catch(1),Oy.navigate("notfound");case 9:this.updateUI();case 10:case"end":return o.stop()}}),_callee,this,[[1,6]])})))}},{key:"updateUI",value:function updateUI(){this.assetData&&(this.thumbnailImage=this.presenter.formatPosterUrl(500,this.assetData.backdrop_path),this.descriptionText=this.assetData.overview)}},{key:"_getFocused",value:function _getFocused(){return this.playButton}},{key:"params",set:function set(o){this.assetData=o.assetData,this.assetId=o.assetId}},{key:"playButton",get:function get(){return this.tag("PlayButton")}},{key:"description",get:function get(){return this.tag("Description")}},{key:"thumbnail",get:function get(){return this.tag("Thumbnail")}},{key:"thumbnailImage",set:function set(o){this.thumbnail.patch({src:o})}},{key:"descriptionText",set:function set(o){this.description.patch({Text:{text:{text:o}}})}},{key:"assetData",get:function get(){return this.presenter.assetData},set:function set(o){this.presenter.assetData=o}}],[{key:"_template",value:function _template(){return{Thumbnail:{src:"",w:620,h:400,x:140,y:40},Description:{x:800,y:40,w:800,h:400,Text:{text:{text:"",fontSize:24,wordWrap:!0,wordWrapWidth:800}}},PlayButton:{x:600,y:520,type:zE,h:100,w:300,title:"Play",color:XS.get("black"),focusedColor:XS.get("velopeGreen"),radius:17,stroke:3,strokeColor:XS.get("white"),focusedStroke:0,textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")}}}}}]),DetailsView}(aL),aV={boot:function boot(){return __awaiter$h(void 0,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:BootRouter();case 1:case"end":return o.stop()}}),_callee)})))},root:"home",beforeEachRoute:function beforeEachRoute(o,s){return new Promise((function(m){if("$"===o){var _=a_.resolveType(DE.dependencyKeys.AnalyticsImplementation),S=s.hash,E=S.split("/"),A=E.length-1,O={client_id:"velope-test",content_id:A>-1?E[A]:S,source:"text_search"};_.send({EventType:"Deeplink",EventPayload:O})}m(!0)}))},routes:[{path:"$",component:uL},{path:"home",component:oL,widgets:["ExitModal","ExampleModal","ProfilingMonitor","PlayerWidgetContainer","ErrorModal"]},{path:"keyboard",component:bL,widgets:["ProfilingMonitor"]},{path:"player",component:sL,widgets:["ProfilingMonitor","LoadSpinner","PlayerWidget"]},{path:"playerDemo/:assetId?",component:W$,widgets:["ProfilingMonitor","PlayerWidget"]},{path:"audioDemo/:assetId?",component:G$,widgets:["ProfilingMonitor","PlayerWidget"]},{path:"soundBoard",component:rV,widgets:["ProfilingMonitor"]},{path:"details/:assetId",component:iV,widgets:["ProfilingMonitor"]},{path:"*",component:lL}]},oV=function(o){_inherits$1(ProgressBarView,o);var s=_createSuper$1(ProgressBarView);function ProgressBarView(){var o;return _classCallCheck$1(this,ProgressBarView),(o=s.apply(this,arguments)).presenter={},o.seekValue=0,o.seekBy=10,o.player={},o.progressBarTemplates={default:{w:getLngOptimalElementSize(1625),h:getLngOptimalElementSize(52),x:getLngOptimalElementSize(148),y:getLngOptimalElementSize(980),ProgressBarView:{w:getLngOptimalElementSize(1370)},TimeStamps:{x:getLngOptimalElementSize(1462)}},minimized:{w:1110,h:getLngOptimalElementSize(60),x:786,y:getLngOptimalElementSize(745),ProgressBarView:{w:790},TimeStamps:{x:880,y:30}},minimizedAndCentered:{w:getLngOptimalElementSize(1070),h:60,x:435,y:getLngOptimalElementSize(730),ProgressBarView:{w:810},TimeStamps:{x:894,y:30}}},o.onPlayerEvent=function(s){if(s.propertyName===QT){var m=s.newValue;"Seeking"!==o._getState()&&("LoadedData"!==m.type&&"TimeUpdate"!==m.type||o.setProgressBarValue(),"Playing"===m.type&&(o.stateIcon="pause"),"Pause"===m.type&&(o.stateIcon="play"))}},o}return _createClass$1(ProgressBarView,[{key:"_init",value:function _init(){this.presenter=a_.resolveType(DE.dependencyKeys.ProgressBarPresenter)}},{key:"_getFocused",value:function _getFocused(){return this}},{key:"_focus",value:function _focus(){this.progressBarFocused=!0}},{key:"_unfocus",value:function _unfocus(){this.progressBarFocused=!1,this.showKnob=!1}},{key:"_firstActive",value:function _firstActive(){this.presenter.propertyChanged.addListener(this.onPlayerEvent)}},{key:"_active",value:function _active(){this._setState("Playing")}},{key:"_detatch",value:function _detatch(){this.presenter.destroy(),this.presenter.propertyChanged.removeListener(this.onPlayerEvent),this.setProgressBarValue(0)}},{key:"_handleMediaFastForward",value:function _handleMediaFastForward(){this.onFastForward()}},{key:"_handleRight",value:function _handleRight(){this.onFastForward()}},{key:"_handleMediaRewind",value:function _handleMediaRewind(){this.onRewind()}},{key:"_handleLeft",value:function _handleLeft(){this.onRewind()}},{key:"_handleMediaPlayPause",value:function _handleMediaPlayPause(){this._handleEnter()}},{key:"_handleEnter",value:function _handleEnter(){}},{key:"setProgressBarValue",value:function setProgressBarValue(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player.currentTime,s=this.tag("ProgressBarView").w,m=this.videoDuration,_=Math.ceil(m/60/60),S=this.presenter.calculateProgress(s,o,m),E=this.presenter.getTimeStamps(o,m);this.patch({ProgressBarView:{Progress:{w:S}},TimeStamps:{text:{fontSize:getLngOptimalElementSize(_>9?23:32),fontFace:XP.regular,textColor:XS.get("white"),text:E}}})}},{key:"onFastForward",value:function onFastForward(){this.seekByNumber(10)}},{key:"onRewind",value:function onRewind(){this.seekByNumber(-10)}},{key:"seekByNumber",value:function seekByNumber(o){this.seekBy=o,this.stateIcon="play",this.showKnob=!0,"Seeking"!==this._getState()?this._setState("Seeking"):this.seek(o)}},{key:"seek",value:function seek(o){this.seekValue=this.presenter.calculateSeekValue(this.seekValue,this.videoDuration,o),this.setProgressBarValue(this.seekValue)}},{key:"progressBarFocused",set:function set(o){var s={shader:{radius:o?6:3}};this.patch({StatusIcon:{color:o?XS.get("white"):XS.get("dimGrey")},ProgressBarView:{h:o?ProgressBarView._progressBarHeight.focused:ProgressBarView._progressBarHeight.unfocused,Background:s,Progress:s}})}},{key:"showKnob",set:function set(o){this.tag("ProgressBarView.Progress.Knob").setSmooth("scale",o)}},{key:"statusIcon",get:function get(){return this.tag("StatusIcon")}},{key:"stateIcon",set:function set(o){this.statusIcon.src=ca.asset("images/player/".concat(o,".png"))}},{key:"playerSize",set:function set(o){"fullscreen"===o?this.patch(Object.assign({},this.progressBarTemplates.default)):"widget"===o?this.patch(Object.assign({},this.progressBarTemplates.minimized)):"widgetCenter"===o&&this.patch(Object.assign({},this.progressBarTemplates.minimizedAndCentered))}},{key:"videoDuration",get:function get(){return this.player.duration}}],[{key:"_template",value:function _template(){var o=getLngOptimalElementSize(52),s=(getLngOptimalElementSize(52),o+20),m={w:getLngOptimalElementSize(1370),h:ProgressBarView._progressBarHeight.unfocused},_=s+m.w+20,S={type:E.shaders.RoundedRectangle,radius:7};return{w:getLngOptimalElementSize(1625),h:getLngOptimalElementSize(52),x:getLngOptimalElementSize(148),y:getLngOptimalElementSize(980),StatusIcon:{x:getLngOptimalElementSize(26),y:function y(o){return.5*o},mount:.5,src:ca.asset("images/player/pause.png")},ProgressBarView:{x:s,y:function y(o){return.5*o},w:m.w,h:m.h,mountY:.5,Background:{w:function w(o){return o},h:function h(o){return o},rect:!0,color:XS.get("gray"),shader:S},Progress:{w:function w(o){return.5*o},h:function h(o){return o},rect:!0,color:XS.get("white"),shader:S,Knob:{w:36,h:36,x:function x(o){return o},y:function y(o){return.5*o},mount:.5,rect:!0,color:XS.get("white"),scale:0,shader:{type:E.shaders.RoundedRectangle,radius:18}}}},TimeStamps:{x:_,y:function y(o){return.5*o},mountY:.45,text:{text:"0:00/0:00",fontFace:XP.regular,fontSize:32,textColor:XS.get("white")}}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(Initial,o);var s=_createSuper$1(Initial);function Initial(){return _classCallCheck$1(this,Initial),s.apply(this,arguments)}return _createClass$1(Initial,[{key:"_handleEnter",value:function _handleEnter(){return this._setState("Paused"),!1}}]),Initial}(this),function(o){_inherits$1(Playing,o);var s=_createSuper$1(Playing);function Playing(){return _classCallCheck$1(this,Playing),s.apply(this,arguments)}return _createClass$1(Playing,[{key:"$enter",value:function $enter(){this.stateIcon="pause"}},{key:"_handleEnter",value:function _handleEnter(){return this._setState("Paused"),!1}}]),Playing}(this),function(o){_inherits$1(Paused,o);var s=_createSuper$1(Paused);function Paused(){return _classCallCheck$1(this,Paused),s.apply(this,arguments)}return _createClass$1(Paused,[{key:"$enter",value:function $enter(){this.stateIcon="play"}},{key:"_handleEnter",value:function _handleEnter(){return this._setState("Playing"),!1}}]),Paused}(this),function(o){_inherits$1(Seeking,o);var s=_createSuper$1(Seeking);function Seeking(){return _classCallCheck$1(this,Seeking),s.apply(this,arguments)}return _createClass$1(Seeking,[{key:"$enter",value:function $enter(){var o=this;this.player.isPlaying?this.player.pause().then((function(){o.seekValue=o.player.currentTime,o.seek(o.seekBy)})):(this.seekValue=this.player.currentTime,this.seek(this.seekBy))}},{key:"$exit",value:function $exit(){var o=this;this.player.play().then((function(){o.showKnob=!1}))}},{key:"_handleEnter",value:function _handleEnter(){var o=this;return this.seekValue>=0&&this.player.seek(this.seekValue).then((function(){return o.seekValue=0,o._setState("Playing"),!0})).catch((function(){return!1})),!1}}]),Seeking}(this)]}}]),ProgressBarView}(E.Component);oV._progressBarHeight={focused:getLngOptimalElementSize(16),unfocused:getLngOptimalElementSize(10)};var sV={exports:{}};!function(o,s){"undefined"!=typeof window&&function webpackUniversalModuleDefinition(s,m){o.exports=m()}(0,(function(){return function(){var o={"./src/config.ts":
/*!***********************!*\
    !*** ./src/config.ts ***!
    \***********************/function srcConfigTs(o,s,m){m.r(s),m.d(s,{enableStreamingMode:function enableStreamingMode(){return _enableStreamingMode},hlsDefaultConfig:function hlsDefaultConfig(){return Se},mergeConfig:function mergeConfig(){return _mergeConfig}});var _=m(/*! ./controller/abr-controller */"./src/controller/abr-controller.ts"),S=m(/*! ./controller/audio-stream-controller */"./src/controller/audio-stream-controller.ts"),E=m(/*! ./controller/audio-track-controller */"./src/controller/audio-track-controller.ts"),A=m(/*! ./controller/subtitle-stream-controller */"./src/controller/subtitle-stream-controller.ts"),O=m(/*! ./controller/subtitle-track-controller */"./src/controller/subtitle-track-controller.ts"),H=m(/*! ./controller/buffer-controller */"./src/controller/buffer-controller.ts"),K=m(/*! ./controller/timeline-controller */"./src/controller/timeline-controller.ts"),z=m(/*! ./controller/cap-level-controller */"./src/controller/cap-level-controller.ts"),G=m(/*! ./controller/fps-controller */"./src/controller/fps-controller.ts"),q=m(/*! ./controller/eme-controller */"./src/controller/eme-controller.ts"),X=m(/*! ./controller/cmcd-controller */"./src/controller/cmcd-controller.ts"),J=m(/*! ./utils/xhr-loader */"./src/utils/xhr-loader.ts"),ae=m(/*! ./utils/fetch-loader */"./src/utils/fetch-loader.ts"),pe=m(/*! ./utils/cues */"./src/utils/cues.ts"),me=m(/*! ./utils/mediakeys-helper */"./src/utils/mediakeys-helper.ts"),_e=m(/*! ./utils/logger */"./src/utils/logger.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}function ownKeys(o,s){var m=Object.keys(o);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(o);s&&(_=_.filter((function(s){return Object.getOwnPropertyDescriptor(o,s).enumerable}))),m.push.apply(m,_)}return m}function _objectSpread(o){for(var s=1;s<arguments.length;s++){var m=null!=arguments[s]?arguments[s]:{};s%2?ownKeys(Object(m),!0).forEach((function(s){_defineProperty(o,s,m[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(m)):ownKeys(Object(m)).forEach((function(s){Object.defineProperty(o,s,Object.getOwnPropertyDescriptor(m,s))}))}return o}function _defineProperty(o,s,m){return(s=function _toPropertyKey(o){var s=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(o,"string");return"symbol"==typeof s?s:String(s)}(s))in o?Object.defineProperty(o,s,{value:m,enumerable:!0,configurable:!0,writable:!0}):o[s]=m,o}var Se=_objectSpread(_objectSpread({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:J.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:_.default,bufferController:H.default,capLevelController:z.default,fpsController:G.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:me.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},function timelineConfig(){return{cueHandler:pe.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}()),{},{subtitleStreamController:A.SubtitleStreamController,subtitleTrackController:O.default,timelineController:K.TimelineController,audioStreamController:S.default,audioTrackController:E.default,emeController:q.default,cmcdController:X.default});function _mergeConfig(o,s){if((s.liveSyncDurationCount||s.liveMaxLatencyDurationCount)&&(s.liveSyncDuration||s.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==s.liveMaxLatencyDurationCount&&(void 0===s.liveSyncDurationCount||s.liveMaxLatencyDurationCount<=s.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==s.liveMaxLatencyDuration&&(void 0===s.liveSyncDuration||s.liveMaxLatencyDuration<=s.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return _extends({},o,s)}function _enableStreamingMode(o){var s=o.loader;s!==ae.default&&s!==J.default?(_e.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),o.progressive=!1):(0,ae.fetchSupported)()&&(o.loader=ae.default,o.progressive=!0,o.enableSoftwareAES=!0,_e.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}},"./src/controller/abr-controller.ts":
/*!******************************************!*\
    !*** ./src/controller/abr-controller.ts ***!
    \******************************************/function srcControllerAbrControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return z}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../utils/ewma-bandwidth-estimator */"./src/utils/ewma-bandwidth-estimator.ts"),E=m(/*! ../events */"./src/events.ts"),A=m(/*! ../errors */"./src/errors.ts"),O=m(/*! ../types/loader */"./src/types/loader.ts"),H=m(/*! ../utils/logger */"./src/utils/logger.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}var K=function(){function AbrController(o){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=o;var s=o.config;this.bwEstimator=new S.default(s.abrEwmaSlowVoD,s.abrEwmaFastVoD,s.abrEwmaDefaultEstimate),this.registerListeners()}var o=AbrController.prototype;return o.registerListeners=function registerListeners(){var o=this.hls;o.on(E.Events.FRAG_LOADING,this.onFragLoading,this),o.on(E.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(E.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.on(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(E.Events.ERROR,this.onError,this)},o.unregisterListeners=function unregisterListeners(){var o=this.hls;o.off(E.Events.FRAG_LOADING,this.onFragLoading,this),o.off(E.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(E.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.off(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(E.Events.ERROR,this.onError,this)},o.destroy=function destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},o.onFragLoading=function onFragLoading(o,s){var m,_=s.frag;_.type===O.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=_,this.partCurrent=null!=(m=s.part)?m:null,this.timer=self.setInterval(this.onCheck,100)))},o.onLevelLoaded=function onLevelLoaded(o,s){var m=this.hls.config;s.details.live?this.bwEstimator.update(m.abrEwmaSlowLive,m.abrEwmaFastLive):this.bwEstimator.update(m.abrEwmaSlowVoD,m.abrEwmaFastVoD)},o._abandonRulesCheck=function _abandonRulesCheck(){var o=this.fragCurrent,s=this.partCurrent,m=this.hls,S=m.autoLevelEnabled,A=m.media;if(o&&A){var O=s?s.stats:o.stats,K=s?s.duration:o.duration;if(O.aborted||O.loaded&&O.loaded===O.total||0===o.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(S&&!A.paused&&A.playbackRate&&A.readyState){var z=m.mainForwardBufferInfo;if(null!==z){var G=performance.now()-O.loading.start,q=Math.abs(A.playbackRate);if(!(G<=500*K/q)){var X=O.loaded&&O.loading.first,J=this.bwEstimator.getEstimate(),ae=m.levels,pe=m.minAutoLevel,me=ae[o.level],_e=O.total||Math.max(O.loaded,Math.round(K*me.maxBitrate/8)),Se=X?1e3*O.loaded/G:0,Ee=Se?(_e-O.loaded)/Se:8*_e/J,De=z.len/q;if(!(Ee<=De)){var $e,He=Number.POSITIVE_INFINITY;for($e=o.level-1;$e>pe;$e--){var et=ae[$e].maxBitrate;if((He=Se?K*et/(6.4*Se):K*et/J)<De)break}He>=Ee||(H.logger.warn("Fragment "+o.sn+(s?" part "+s.index:"")+" of level "+o.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+$e+"\n      Current BW estimate: "+((0,_.isFiniteNumber)(J)?(J/1024).toFixed(3):"Unknown")+" Kb/s\n      Estimated load time for current fragment: "+Ee.toFixed(3)+" s\n      Estimated load time for the next fragment: "+He.toFixed(3)+" s\n      Time to underbuffer: "+De.toFixed(3)+" s"),m.nextLoadLevel=$e,X&&this.bwEstimator.sample(G,O.loaded),this.clearTimer(),(o.loader||o.keyLoader)&&(this.fragCurrent=this.partCurrent=null,o.abortRequests()),m.trigger(E.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:o,part:s,stats:O}))}}}}}},o.onFragLoaded=function onFragLoaded(o,s){var m=s.frag,S=s.part;if(m.type===O.PlaylistLevelType.MAIN&&(0,_.isFiniteNumber)(m.sn)){var A=S?S.stats:m.stats,H=S?S.duration:m.duration;if(this.clearTimer(),this.lastLoadedFragLevel=m.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var K=this.hls.levels[m.level],z=(K.loaded?K.loaded.bytes:0)+A.loaded,G=(K.loaded?K.loaded.duration:0)+H;K.loaded={bytes:z,duration:G},K.realBitrate=Math.round(8*z/G)}if(m.bitrateTest){var q={stats:A,frag:m,part:S,id:m.type};this.onFragBuffered(E.Events.FRAG_BUFFERED,q)}}},o.onFragBuffered=function onFragBuffered(o,s){var m=s.frag,_=s.part,S=_?_.stats:m.stats;if(!S.aborted&&m.type===O.PlaylistLevelType.MAIN&&"initSegment"!==m.sn){var E=S.parsing.end-S.loading.start;this.bwEstimator.sample(E,S.loaded),S.bwEstimate=this.bwEstimator.getEstimate(),m.bitrateTest?this.bitrateTestDelay=E/1e3:this.bitrateTestDelay=0}},o.onError=function onError(o,s){var m;if((null===(m=s.frag)||void 0===m?void 0:m.type)===O.PlaylistLevelType.MAIN){if(s.type===A.ErrorTypes.KEY_SYSTEM_ERROR)return void this.clearTimer();switch(s.details){case A.ErrorDetails.FRAG_LOAD_ERROR:case A.ErrorDetails.FRAG_LOAD_TIMEOUT:case A.ErrorDetails.KEY_LOAD_ERROR:case A.ErrorDetails.KEY_LOAD_TIMEOUT:this.clearTimer()}}},o.clearTimer=function clearTimer(){self.clearInterval(this.timer),this.timer=void 0},o.getNextABRAutoLevel=function getNextABRAutoLevel(){var o=this.fragCurrent,s=this.partCurrent,m=this.hls,_=m.maxAutoLevel,S=m.config,E=m.minAutoLevel,A=m.media,O=s?s.duration:o?o.duration:0,K=A&&0!==A.playbackRate?Math.abs(A.playbackRate):1,z=this.bwEstimator?this.bwEstimator.getEstimate():S.abrEwmaDefaultEstimate,G=m.mainForwardBufferInfo,q=(G?G.len:0)/K,X=this.findBestLevel(z,E,_,q,S.abrBandWidthFactor,S.abrBandWidthUpFactor);if(X>=0)return X;H.logger.trace((q?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var J=O?Math.min(O,S.maxStarvationDelay):S.maxStarvationDelay,ae=S.abrBandWidthFactor,pe=S.abrBandWidthUpFactor;if(!q){var me=this.bitrateTestDelay;if(me)J=(O?Math.min(O,S.maxLoadingDelay):S.maxLoadingDelay)-me,H.logger.trace("bitrate test took "+Math.round(1e3*me)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*J)+" ms"),ae=pe=1}return X=this.findBestLevel(z,E,_,q+J,ae,pe),Math.max(X,0)},o.findBestLevel=function findBestLevel(o,s,m,S,E,A){for(var O,K=this.fragCurrent,z=this.partCurrent,G=this.lastLoadedFragLevel,q=this.hls.levels,X=q[G],J=!(null==X||null===(O=X.details)||void 0===O||!O.live),ae=null==X?void 0:X.codecSet,pe=z?z.duration:K?K.duration:0,me=m;me>=s;me--){var _e=q[me];if(_e&&(!ae||_e.codecSet===ae)){var Se=_e.details,Ee=(z?null==Se?void 0:Se.partTarget:null==Se?void 0:Se.averagetargetduration)||pe,De=void 0;De=me<=G?E*o:A*o;var $e=q[me].maxBitrate,He=$e*Ee/De;if(H.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+me+"/"+Math.round(De)+"/"+$e+"/"+Ee+"/"+S+"/"+He),De>$e&&(0===He||!(0,_.isFiniteNumber)(He)||J&&!this.bitrateTestDelay||He<S))return me}}return-1},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(AbrController,[{key:"nextAutoLevel",get:function get(){var o=this._nextAutoLevel,s=this.bwEstimator;if(-1!==o&&!s.canEstimate())return o;var m=this.getNextABRAutoLevel();return-1!==o&&this.hls.levels[m].loadError?o:(-1!==o&&(m=Math.min(o,m)),m)},set:function set(o){this._nextAutoLevel=o}}]),AbrController}(),z=K},"./src/controller/audio-stream-controller.ts":
/*!***************************************************!*\
    !*** ./src/controller/audio-stream-controller.ts ***!
    \***************************************************/function srcControllerAudioStreamControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _e}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ./base-stream-controller */"./src/controller/base-stream-controller.ts"),E=m(/*! ../events */"./src/events.ts"),A=m(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),O=m(/*! ./fragment-tracker */"./src/controller/fragment-tracker.ts"),H=m(/*! ../types/level */"./src/types/level.ts"),K=m(/*! ../types/loader */"./src/types/loader.ts"),z=m(/*! ../loader/fragment */"./src/loader/fragment.ts"),G=m(/*! ../demux/chunk-cache */"./src/demux/chunk-cache.ts"),q=m(/*! ../demux/transmuxer-interface */"./src/demux/transmuxer-interface.ts"),X=m(/*! ../types/transmuxer */"./src/types/transmuxer.ts"),J=m(/*! ./fragment-finders */"./src/controller/fragment-finders.ts"),ae=m(/*! ../utils/discontinuities */"./src/utils/discontinuities.ts"),pe=m(/*! ../errors */"./src/errors.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var me=function(o){function AudioStreamController(s,m,_){var S;return(S=o.call(this,s,m,_,"[audio-stream-controller]")||this).videoBuffer=null,S.videoTrackCC=-1,S.waitingVideoCC=-1,S.audioSwitch=!1,S.trackId=-1,S.waitingData=null,S.mainDetails=null,S.bufferFlushed=!1,S.cachedTrackLoadedData=null,S._registerListeners(),S}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(AudioStreamController,o);var s=AudioStreamController.prototype;return s.onHandlerDestroying=function onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function _registerListeners(){var o=this.hls;o.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(E.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),o.on(E.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.on(E.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.on(E.Events.ERROR,this.onError,this),o.on(E.Events.BUFFER_RESET,this.onBufferReset,this),o.on(E.Events.BUFFER_CREATED,this.onBufferCreated,this),o.on(E.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.on(E.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.on(E.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function _unregisterListeners(){var o=this.hls;o.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(E.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),o.off(E.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.off(E.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.off(E.Events.ERROR,this.onError,this),o.off(E.Events.BUFFER_RESET,this.onBufferReset,this),o.off(E.Events.BUFFER_CREATED,this.onBufferCreated,this),o.off(E.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.off(E.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.off(E.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.onInitPtsFound=function onInitPtsFound(o,s){var m=s.frag,_=s.id,E=s.initPTS;if("main"===_){var A=m.cc;this.initPTS[m.cc]=E,this.log("InitPTS for cc: "+A+" found from main: "+E),this.videoTrackCC=A,this.state===S.State.WAITING_INIT_PTS&&this.tick()}},s.startLoad=function startLoad(o){if(!this.levels)return this.startPosition=o,void(this.state=S.State.STOPPED);var s=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,s>0&&-1===o?(this.log("Override startPosition with lastCurrentTime @"+s.toFixed(3)),o=s,this.state=S.State.IDLE):(this.loadedmetadata=!1,this.state=S.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=o,this.tick()},s.doTick=function doTick(){switch(this.state){case S.State.IDLE:this.doTickIdle();break;case S.State.WAITING_TRACK:var s,m=this.levels,_=this.trackId,E=null==m||null===(s=m[_])||void 0===s?void 0:s.details;if(E){if(this.waitForCdnTuneIn(E))break;this.state=S.State.WAITING_INIT_PTS}break;case S.State.FRAG_LOADING_WAITING_RETRY:var O,H=performance.now(),K=this.retryDate;(!K||H>=K||null!==(O=this.media)&&void 0!==O&&O.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=S.State.IDLE);break;case S.State.WAITING_INIT_PTS:var z=this.waitingData;if(z){var G=z.frag,q=z.part,X=z.cache,ae=z.complete;if(void 0!==this.initPTS[G.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=S.State.FRAG_LOADING;var pe={frag:G,part:q,payload:X.flush(),networkDetails:null};this._handleFragmentLoadProgress(pe),ae&&o.prototype._handleFragmentLoadComplete.call(this,pe)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+G.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var me=this.getLoadPosition(),_e=A.BufferHelper.bufferInfo(this.mediaBuffer,me,this.config.maxBufferHole);(0,J.fragmentWithinToleranceTest)(_e.end,this.config.maxFragLookUpTolerance,G)<0&&(this.log("Waiting fragment cc ("+G.cc+") @ "+G.start+" cancelled because another fragment at "+_e.end+" is needed"),this.clearWaitingFragment())}}else this.state=S.State.IDLE}this.onTickEnd()},s.clearWaitingFragment=function clearWaitingFragment(){var o=this.waitingData;o&&(this.fragmentTracker.removeFragment(o.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=S.State.IDLE)},s.resetLoadingState=function resetLoadingState(){this.clearWaitingFragment(),o.prototype.resetLoadingState.call(this)},s.onTickEnd=function onTickEnd(){var o=this.media;o&&o.readyState&&(this.lastCurrentTime=o.currentTime)},s.doTickIdle=function doTickIdle(){var o=this.hls,s=this.levels,m=this.media,_=this.trackId,A=o.config;if(s&&s[_]&&(m||!this.startFragRequested&&A.startFragPrefetch)){var O=s[_].details;if(!O||O.live&&this.levelLastLoaded!==_||this.waitForCdnTuneIn(O))this.state=S.State.WAITING_TRACK;else{var H=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&H&&(this.bufferFlushed=!1,this.afterBufferFlushed(H,z.ElementaryStreamTypes.AUDIO,K.PlaylistLevelType.AUDIO));var G=this.getFwdBufferInfo(H,K.PlaylistLevelType.AUDIO);if(null!==G){var q=this.audioSwitch;if(!q&&this._streamEnded(G,O))return o.trigger(E.Events.BUFFER_EOS,{type:"audio"}),void(this.state=S.State.ENDED);var X=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,K.PlaylistLevelType.MAIN);if(!(G.len>=this.getMaxBufferLength(null==X?void 0:X.len))||q){var J=O.fragments[0].start,ae=G.end;if(q&&m){var pe=this.getLoadPosition();ae=pe,O.PTSKnown&&pe<J&&(G.end>J||G.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),m.currentTime=J+.05)}if(!(X&&ae>X.end+O.targetduration)&&(X&&X.len||!G.len)){var me=this.getNextFragment(ae,O);me?this.loadFragment(me,O,ae):this.bufferFlushed=!0}}}}}},s.getMaxBufferLength=function getMaxBufferLength(s){var m=o.prototype.getMaxBufferLength.call(this);return s?Math.max(m,s):m},s.onMediaDetaching=function onMediaDetaching(){this.videoBuffer=null,o.prototype.onMediaDetaching.call(this)},s.onAudioTracksUpdated=function onAudioTracksUpdated(o,s){var m=s.audioTracks;this.resetTransmuxer(),this.levels=m.map((function(o){return new H.Level(o)}))},s.onAudioTrackSwitching=function onAudioTrackSwitching(o,s){var m=!!s.url;this.trackId=s.id;var _=this.fragCurrent;_&&_.abortRequests(),this.fragCurrent=null,this.clearWaitingFragment(),m?this.setInterval(100):this.resetTransmuxer(),m?(this.audioSwitch=!0,this.state=S.State.IDLE):this.state=S.State.STOPPED,this.tick()},s.onManifestLoading=function onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},s.onLevelLoaded=function onLevelLoaded(o,s){this.mainDetails=s.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(E.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},s.onAudioTrackLoaded=function onAudioTrackLoaded(o,s){var m;if(null!=this.mainDetails){var _=this.levels,E=s.details,A=s.id;if(_){this.log("Track "+A+" loaded ["+E.startSN+","+E.endSN+"],duration:"+E.totalduration);var O=_[A],H=0;if(E.live||null!==(m=O.details)&&void 0!==m&&m.live){var K=this.mainDetails;if(E.fragments[0]||(E.deltaUpdateFailed=!0),E.deltaUpdateFailed||!K)return;!O.details&&E.hasProgramDateTime&&K.hasProgramDateTime?((0,ae.alignMediaPlaylistByPDT)(E,K),H=E.fragments[0].start):H=this.alignPlaylists(E,O.details)}O.details=E,this.levelLastLoaded=A,this.startFragRequested||!this.mainDetails&&E.live||this.setStartPosition(O.details,H),this.state!==S.State.WAITING_TRACK||this.waitForCdnTuneIn(E)||(this.state=S.State.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+A)}else this.cachedTrackLoadedData=s},s._handleFragmentLoadProgress=function _handleFragmentLoadProgress(o){var s,m=o.frag,_=o.part,E=o.payload,A=this.config,O=this.trackId,H=this.levels;if(H){var z=H[O];console.assert(z,"Audio track is defined on fragment load progress");var J=z.details;console.assert(J,"Audio track details are defined on fragment load progress");var ae=A.defaultAudioCodec||z.audioCodec||"mp4a.40.2",pe=this.transmuxer;pe||(pe=this.transmuxer=new q.default(this.hls,K.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var me=this.initPTS[m.cc],_e=null===(s=m.initSegment)||void 0===s?void 0:s.data;if(void 0!==me){var Se=_?_.index:-1,Ee=-1!==Se,De=new X.ChunkMetadata(m.level,m.sn,m.stats.chunkCount,E.byteLength,Se,Ee);pe.push(E,_e,ae,"",m,_,J.totalduration,!1,De,me)}else{this.log("Unknown video PTS for cc "+m.cc+", waiting for video PTS before demuxing audio frag "+m.sn+" of ["+J.startSN+" ,"+J.endSN+"],track "+O),(this.waitingData=this.waitingData||{frag:m,part:_,cache:new G.default,complete:!1}).cache.push(new Uint8Array(E)),this.waitingVideoCC=this.videoTrackCC,this.state=S.State.WAITING_INIT_PTS}}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+m.sn+" of level "+m.level+" will not be buffered")},s._handleFragmentLoadComplete=function _handleFragmentLoadComplete(s){this.waitingData?this.waitingData.complete=!0:o.prototype._handleFragmentLoadComplete.call(this,s)},s.onBufferReset=function onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},s.onBufferCreated=function onBufferCreated(o,s){var m=s.tracks.audio;m&&(this.mediaBuffer=m.buffer||null),s.tracks.video&&(this.videoBuffer=s.tracks.video.buffer||null)},s.onFragBuffered=function onFragBuffered(o,s){var m,_=s.frag,S=s.part;_.type===K.PlaylistLevelType.AUDIO?this.fragContextChanged(_)?this.warn("Fragment "+_.sn+(S?" p: "+S.index:"")+" of level "+_.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):("initSegment"!==_.sn&&(this.fragPrevious=_,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(E.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(_,S)):this.loadedmetadata||_.type!==K.PlaylistLevelType.MAIN||null!==(m=this.videoBuffer||this.media)&&void 0!==m&&m.buffered.length&&(this.loadedmetadata=!0)},s.onError=function onError(s,m){if(m.type!==pe.ErrorTypes.KEY_SYSTEM_ERROR)switch(m.details){case pe.ErrorDetails.FRAG_LOAD_ERROR:case pe.ErrorDetails.FRAG_LOAD_TIMEOUT:case pe.ErrorDetails.FRAG_PARSING_ERROR:case pe.ErrorDetails.KEY_LOAD_ERROR:case pe.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(K.PlaylistLevelType.AUDIO,m);break;case pe.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case pe.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==S.State.ERROR&&this.state!==S.State.STOPPED&&(this.state=m.fatal?S.State.ERROR:S.State.IDLE,this.warn(m.details+" while loading frag, switching to "+this.state+" state"));break;case pe.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===m.parent&&(this.state===S.State.PARSING||this.state===S.State.PARSED)){var _=!0,E=this.getFwdBufferInfo(this.mediaBuffer,K.PlaylistLevelType.AUDIO);E&&E.len>.5&&(_=!this.reduceMaxBufferLength(E.len)),_&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,o.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(K.PlaylistLevelType.AUDIO,m)},s.onBufferFlushed=function onBufferFlushed(o,s){s.type===z.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===S.State.ENDED&&(this.state=S.State.IDLE))},s._handleTransmuxComplete=function _handleTransmuxComplete(o){var s,m="audio",_=this.hls,A=o.remuxResult,O=o.chunkMeta,H=this.getCurrentContext(O);if(!H)return this.warn("The loading context changed while buffering fragment "+O.sn+" of level "+O.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(O.level);var K=H.frag,G=H.part,q=H.level.details,X=A.audio,J=A.text,ae=A.id3,pe=A.initSegment;if(!this.fragContextChanged(K)&&q){if(this.state=S.State.PARSING,this.audioSwitch&&X&&this.completeAudioSwitch(),null!=pe&&pe.tracks&&(this._bufferInitSegment(pe.tracks,K,O),_.trigger(E.Events.FRAG_PARSING_INIT_SEGMENT,{frag:K,id:m,tracks:pe.tracks})),X){var me=X.startPTS,_e=X.endPTS,Se=X.startDTS,Ee=X.endDTS;G&&(G.elementaryStreams[z.ElementaryStreamTypes.AUDIO]={startPTS:me,endPTS:_e,startDTS:Se,endDTS:Ee}),K.setElementaryStreamInfo(z.ElementaryStreamTypes.AUDIO,me,_e,Se,Ee),this.bufferFragmentData(X,K,G,O)}if(null!=ae&&null!==(s=ae.samples)&&void 0!==s&&s.length){var De=_extends({id:m,frag:K,details:q},ae);_.trigger(E.Events.FRAG_PARSING_METADATA,De)}if(J){var $e=_extends({id:m,frag:K,details:q},J);_.trigger(E.Events.FRAG_PARSING_USERDATA,$e)}}},s._bufferInitSegment=function _bufferInitSegment(o,s,m){if(this.state===S.State.PARSING){o.video&&delete o.video;var _=o.audio;if(_){_.levelCodec=_.codec,_.id="audio",this.log("Init audio buffer, container:"+_.container+", codecs[parsed]=["+_.codec+"]"),this.hls.trigger(E.Events.BUFFER_CODECS,o);var A=_.initSegment;if(null!=A&&A.byteLength){var O={type:"audio",frag:s,part:null,chunkMeta:m,parent:s.type,data:A};this.hls.trigger(E.Events.BUFFER_APPENDING,O)}this.tick()}}},s.loadFragment=function loadFragment(s,m,E){var A=this.fragmentTracker.getState(s);this.fragCurrent=s,(this.audioSwitch||A===O.FragmentState.NOT_LOADED||A===O.FragmentState.PARTIAL)&&("initSegment"===s.sn?this._loadInitSegment(s,m):m.live&&!(0,_.isFiniteNumber)(this.initPTS[s.cc])?(this.log("Waiting for video PTS in continuity counter "+s.cc+" of live stream before loading audio fragment "+s.sn+" of level "+this.trackId),this.state=S.State.WAITING_INIT_PTS):(this.startFragRequested=!0,o.prototype.loadFragment.call(this,s,m,E)))},s.completeAudioSwitch=function completeAudioSwitch(){var s=this.hls,m=this.media,_=this.trackId;m&&(this.log("Switching audio track : flushing all audio"),o.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,s.trigger(E.Events.AUDIO_TRACK_SWITCHED,{id:_})},AudioStreamController}(S.default),_e=me},"./src/controller/audio-track-controller.ts":
/*!**************************************************!*\
    !*** ./src/controller/audio-track-controller.ts ***!
    \**************************************************/function srcControllerAudioTrackControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return H}});var _=m(/*! ../events */"./src/events.ts"),S=m(/*! ../errors */"./src/errors.ts"),E=m(/*! ./base-playlist-controller */"./src/controller/base-playlist-controller.ts"),A=m(/*! ../types/loader */"./src/types/loader.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var O=function(o){function AudioTrackController(s){var m;return(m=o.call(this,s,"[audio-track-controller]")||this).tracks=[],m.groupId=null,m.tracksInGroup=[],m.trackId=-1,m.trackName="",m.selectDefaultTrack=!0,m.registerListeners(),m}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(AudioTrackController,o);var s=AudioTrackController.prototype;return s.registerListeners=function registerListeners(){var o=this.hls;o.on(_.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(_.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(_.Events.LEVEL_LOADING,this.onLevelLoading,this),o.on(_.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.on(_.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.on(_.Events.ERROR,this.onError,this)},s.unregisterListeners=function unregisterListeners(){var o=this.hls;o.off(_.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(_.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(_.Events.LEVEL_LOADING,this.onLevelLoading,this),o.off(_.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.off(_.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.off(_.Events.ERROR,this.onError,this)},s.destroy=function destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,o.prototype.destroy.call(this)},s.onManifestLoading=function onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},s.onManifestParsed=function onManifestParsed(o,s){this.tracks=s.audioTracks||[]},s.onAudioTrackLoaded=function onAudioTrackLoaded(o,s){var m=s.id,_=s.details,S=this.tracksInGroup[m];if(S){var E=S.details;S.details=s.details,this.log("audioTrack "+m+" loaded ["+_.startSN+"-"+_.endSN+"]"),m===this.trackId&&(this.retryCount=0,this.playlistLoaded(m,s,E))}else this.warn("Invalid audio track id "+m)},s.onLevelLoading=function onLevelLoading(o,s){this.switchLevel(s.level)},s.onLevelSwitching=function onLevelSwitching(o,s){this.switchLevel(s.level)},s.switchLevel=function switchLevel(o){var s=this.hls.levels[o];if(null!=s&&s.audioGroupIds){var m=s.audioGroupIds[s.urlId];if(this.groupId!==m){this.groupId=m;var S=this.tracks.filter((function(o){return!m||o.groupId===m}));this.selectDefaultTrack&&!S.some((function(o){return o.default}))&&(this.selectDefaultTrack=!1),this.tracksInGroup=S;var E={audioTracks:S};this.log("Updating audio tracks, "+S.length+' track(s) found in "'+m+'" group-id'),this.hls.trigger(_.Events.AUDIO_TRACKS_UPDATED,E),this.selectInitialTrack()}}},s.onError=function onError(s,m){o.prototype.onError.call(this,s,m),!m.fatal&&m.context&&m.context.type===A.PlaylistContextType.AUDIO_TRACK&&m.context.id===this.trackId&&m.context.groupId===this.groupId&&this.retryLoadingOrFail(m)},s.setAudioTrack=function setAudioTrack(o){var s=this.tracksInGroup;if(o<0||o>=s.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var m=s[this.trackId];this.log("Now switching to audio-track index "+o);var S=s[o],E=S.id,A=S.groupId,O=void 0===A?"":A,H=S.name,K=S.type,z=S.url;if(this.trackId=o,this.trackName=H,this.selectDefaultTrack=!1,this.hls.trigger(_.Events.AUDIO_TRACK_SWITCHING,{id:E,groupId:O,name:H,type:K,url:z}),!S.details||S.details.live){var G=this.switchParams(S.url,null==m?void 0:m.details);this.loadPlaylist(G)}}},s.selectInitialTrack=function selectInitialTrack(){var o=this.tracksInGroup;console.assert(o.length,"Initial audio track should be selected when tracks are known");var s=this.trackName,m=this.findTrackId(s)||this.findTrackId();-1!==m?this.setAudioTrack(m):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(_.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},s.findTrackId=function findTrackId(o){for(var s=this.tracksInGroup,m=0;m<s.length;m++){var _=s[m];if((!this.selectDefaultTrack||_.default)&&(!o||o===_.name))return _.id}return-1},s.loadPlaylist=function loadPlaylist(s){o.prototype.loadPlaylist.call(this);var m=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(m)){var S=m.id,E=m.groupId,A=m.url;if(s)try{A=s.addDirectives(A)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("loading audio-track playlist for id: "+S),this.clearTimer(),this.hls.trigger(_.Events.AUDIO_TRACK_LOADING,{url:A,id:S,groupId:E,deliveryDirectives:s||null})}},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(AudioTrackController,[{key:"audioTracks",get:function get(){return this.tracksInGroup}},{key:"audioTrack",get:function get(){return this.trackId},set:function set(o){this.selectDefaultTrack=!1,this.setAudioTrack(o)}}]),AudioTrackController}(E.default),H=O},"./src/controller/base-playlist-controller.ts":
/*!****************************************************!*\
    !*** ./src/controller/base-playlist-controller.ts ***!
    \****************************************************/function srcControllerBasePlaylistControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return O}});var _=m(/*! ../types/level */"./src/types/level.ts"),S=m(/*! ./level-helper */"./src/controller/level-helper.ts"),E=m(/*! ../utils/logger */"./src/utils/logger.ts"),A=m(/*! ../errors */"./src/errors.ts"),O=function(){function BasePlaylistController(o,s){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=E.logger.log.bind(E.logger,s+":"),this.warn=E.logger.warn.bind(E.logger,s+":"),this.hls=o}var o=BasePlaylistController.prototype;return o.destroy=function destroy(){this.clearTimer(),this.hls=this.log=this.warn=null},o.onError=function onError(o,s){!s.fatal||s.type!==A.ErrorTypes.NETWORK_ERROR&&s.type!==A.ErrorTypes.KEY_SYSTEM_ERROR||this.stopLoad()},o.clearTimer=function clearTimer(){clearTimeout(this.timer),this.timer=-1},o.startLoad=function startLoad(){this.canLoad=!0,this.retryCount=0,this.requestScheduled=-1,this.loadPlaylist()},o.stopLoad=function stopLoad(){this.canLoad=!1,this.clearTimer()},o.switchParams=function switchParams(o,s){var m=null==s?void 0:s.renditionReports;if(m)for(var S=0;S<m.length;S++){var A=m[S],O=void 0;try{O=new self.URL(A.URI,s.url).href}catch(o){E.logger.warn("Could not construct new URL for Rendition Report: "+o),O=A.URI||""}if(O===o.slice(-O.length)){var H=parseInt(A["LAST-MSN"])||(null==s?void 0:s.lastPartSn),K=parseInt(A["LAST-PART"])||(null==s?void 0:s.lastPartIndex);if(this.hls.config.lowLatencyMode){var z=Math.min(s.age-s.partTarget,s.targetduration);K>=0&&z>s.partTarget&&(K+=1)}return new _.HlsUrlParameters(H,K>=0?K:void 0,_.HlsSkip.No)}}},o.loadPlaylist=function loadPlaylist(o){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())},o.shouldLoadTrack=function shouldLoadTrack(o){return this.canLoad&&o&&!!o.url&&(!o.details||o.details.live)},o.playlistLoaded=function playlistLoaded(o,s,m){var _=this,E=s.details,A=s.stats,O=self.performance.now(),H=A.loading.first?Math.max(0,O-A.loading.first):0;if(E.advancedDateTime=Date.now()-H,E.live||null!=m&&m.live){if(E.reloaded(m),m&&this.log("live playlist "+o+" "+(E.advanced?"REFRESHED "+E.lastPartSn+"-"+E.lastPartIndex:"MISSED")),m&&E.fragments.length>0&&(0,S.mergeDetails)(m,E),!this.canLoad||!E.live)return;var K,z=void 0,G=void 0;if(E.canBlockReload&&E.endSN&&E.advanced){var q=this.hls.config.lowLatencyMode,X=E.lastPartSn,J=E.endSN,ae=E.lastPartIndex,pe=X===J;-1!==ae?(z=pe?J+1:X,G=pe?q?0:ae:ae+1):z=J+1;var me=E.age,_e=me+E.ageHeader,Se=Math.min(_e-E.partTarget,1.5*E.targetduration);if(Se>0){if(m&&Se>m.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+m.tuneInGoal+" to: "+Se+" with playlist age: "+E.age),Se=0;else{var Ee=Math.floor(Se/E.targetduration);if(z+=Ee,void 0!==G)G+=Math.round(Se%E.targetduration/E.partTarget);this.log("CDN Tune-in age: "+E.ageHeader+"s last advanced "+me.toFixed(2)+"s goal: "+Se+" skip sn "+Ee+" to part "+G)}E.tuneInGoal=Se}if(K=this.getDeliveryDirectives(E,s.deliveryDirectives,z,G),q||!pe)return void this.loadPlaylist(K)}else K=this.getDeliveryDirectives(E,s.deliveryDirectives,z,G);var De=this.hls.mainForwardBufferInfo,$e=De?De.end-De.len:0,He=1e3*(E.edge-$e),et=(0,S.computeReloadInterval)(E,He);E.updated?O>this.requestScheduled+et&&(this.requestScheduled=A.loading.start):this.requestScheduled=-1,void 0!==z&&E.canBlockReload?this.requestScheduled=A.loading.first+et-(1e3*E.partTarget||1e3):this.requestScheduled=(-1===this.requestScheduled?O:this.requestScheduled)+et;var rt=this.requestScheduled-O;rt=Math.max(0,rt),this.log("reload live playlist "+o+" in "+Math.round(rt)+" ms"),this.timer=self.setTimeout((function(){return _.loadPlaylist(K)}),rt)}else this.clearTimer()},o.getDeliveryDirectives=function getDeliveryDirectives(o,s,m,S){var E=(0,_.getSkipValue)(o,m);return null!=s&&s.skip&&o.deltaUpdateFailed&&(m=s.msn,S=s.part,E=_.HlsSkip.No),new _.HlsUrlParameters(m,S,E)},o.retryLoadingOrFail=function retryLoadingOrFail(o){var s,m=this,_=this.hls.config,S=this.retryCount<_.levelLoadingMaxRetry;if(S)if(this.requestScheduled=-1,this.retryCount++,o.details.indexOf("LoadTimeOut")>-1&&null!==(s=o.context)&&void 0!==s&&s.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+o.details+'"'),this.loadPlaylist();else{var E=Math.min(Math.pow(2,this.retryCount)*_.levelLoadingRetryDelay,_.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout((function(){return m.loadPlaylist()}),E),this.warn("retry playlist loading #"+this.retryCount+" in "+E+' ms after "'+o.details+'"')}else this.warn('cannot recover from error "'+o.details+'"'),this.clearTimer(),o.fatal=!0;return S},BasePlaylistController}()},"./src/controller/base-stream-controller.ts":
/*!**************************************************!*\
    !*** ./src/controller/base-stream-controller.ts ***!
    \**************************************************/function srcControllerBaseStreamControllerTs(o,s,m){m.r(s),m.d(s,{State:function State(){return Se},default:function _default(){return Ee}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../task-loop */"./src/task-loop.ts"),E=m(/*! ./fragment-tracker */"./src/controller/fragment-tracker.ts"),A=m(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),O=m(/*! ../utils/logger */"./src/utils/logger.ts"),H=m(/*! ../events */"./src/events.ts"),K=m(/*! ../errors */"./src/errors.ts"),z=m(/*! ../types/transmuxer */"./src/types/transmuxer.ts"),G=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),q=m(/*! ../utils/discontinuities */"./src/utils/discontinuities.ts"),X=m(/*! ./fragment-finders */"./src/controller/fragment-finders.ts"),J=m(/*! ./level-helper */"./src/controller/level-helper.ts"),ae=m(/*! ../loader/fragment-loader */"./src/loader/fragment-loader.ts"),pe=m(/*! ../crypt/decrypter */"./src/crypt/decrypter.ts"),me=m(/*! ../utils/time-ranges */"./src/utils/time-ranges.ts"),_e=m(/*! ../types/loader */"./src/types/loader.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var Se={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},Ee=function(o){function BaseStreamController(s,m,_,S){var E;return(E=o.call(this)||this).hls=void 0,E.fragPrevious=null,E.fragCurrent=null,E.fragmentTracker=void 0,E.transmuxer=null,E._state=Se.STOPPED,E.media=null,E.mediaBuffer=null,E.config=void 0,E.bitrateTest=!1,E.lastCurrentTime=0,E.nextLoadPosition=0,E.startPosition=0,E.loadedmetadata=!1,E.fragLoadError=0,E.retryDate=0,E.levels=null,E.fragmentLoader=void 0,E.keyLoader=void 0,E.levelLastLoaded=null,E.startFragRequested=!1,E.decrypter=void 0,E.initPTS=[],E.onvseeking=null,E.onvended=null,E.logPrefix="",E.log=void 0,E.warn=void 0,E.logPrefix=S,E.log=O.logger.log.bind(O.logger,S+":"),E.warn=O.logger.warn.bind(O.logger,S+":"),E.hls=s,E.fragmentLoader=new ae.default(s.config),E.keyLoader=_,E.fragmentTracker=m,E.config=s.config,E.decrypter=new pe.default(s.config),s.on(H.Events.LEVEL_SWITCHING,E.onLevelSwitching,function _assertThisInitialized(o){if(void 0===o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}(E)),E}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(BaseStreamController,o);var s=BaseStreamController.prototype;return s.doTick=function doTick(){this.onTickEnd()},s.onTickEnd=function onTickEnd(){},s.startLoad=function startLoad(o){},s.stopLoad=function stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort();var o=this.fragCurrent;o&&(o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Se.STOPPED},s._streamEnded=function _streamEnded(o,s){if(s.live||o.nextStart||!o.end||!this.media)return!1;var m=s.partList;if(null!=m&&m.length){var _=m[m.length-1];return A.BufferHelper.isBuffered(this.media,_.start+_.duration/2)}var S=s.fragments[s.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(S)},s.getLevelDetails=function getLevelDetails(){var o;if(this.levels&&null!==this.levelLastLoaded)return null===(o=this.levels[this.levelLastLoaded])||void 0===o?void 0:o.details},s.onMediaAttached=function onMediaAttached(o,s){var m=this.media=this.mediaBuffer=s.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),m.addEventListener("seeking",this.onvseeking),m.addEventListener("ended",this.onvended);var _=this.config;this.levels&&_.autoStartLoad&&this.state===Se.STOPPED&&this.startLoad(_.startPosition)},s.onMediaDetaching=function onMediaDetaching(){var o=this.media;null!=o&&o.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),o&&this.onvseeking&&this.onvended&&(o.removeEventListener("seeking",this.onvseeking),o.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},s.onMediaSeeking=function onMediaSeeking(){var o=this.config,s=this.fragCurrent,m=this.media,S=this.mediaBuffer,E=this.state,O=m?m.currentTime:0,H=A.BufferHelper.bufferInfo(S||m,O,o.maxBufferHole);if(this.log("media seeking to "+((0,_.isFiniteNumber)(O)?O.toFixed(3):O)+", state: "+E),this.state===Se.ENDED)this.resetLoadingState();else if(s){var K=o.maxFragLookUpTolerance,z=s.start-K,G=s.start+s.duration+K;if(!H.len||G<H.start||z>H.end){var q=O>G;(O<z||q)&&(q&&s.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.abortRequests()),this.resetLoadingState())}}m&&(this.lastCurrentTime=O),this.loadedmetadata||H.len||(this.nextLoadPosition=this.startPosition=O),this.tickImmediate()},s.onMediaEnded=function onMediaEnded(){this.startPosition=this.lastCurrentTime=0},s.onLevelSwitching=function onLevelSwitching(o,s){this.fragLoadError=0},s.onHandlerDestroying=function onHandlerDestroying(){this.stopLoad(),o.prototype.onHandlerDestroying.call(this)},s.onHandlerDestroyed=function onHandlerDestroyed(){this.state=Se.STOPPED,this.hls.off(H.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,o.prototype.onHandlerDestroyed.call(this)},s.loadFragment=function loadFragment(o,s,m){this._loadFragForPlayback(o,s,m)},s._loadFragForPlayback=function _loadFragForPlayback(o,s,m){var _=this;this._doFragLoad(o,s,m,(function progressCallback(s){if(_.fragContextChanged(o))return _.warn("Fragment "+o.sn+(s.part?" p: "+s.part.index:"")+" of level "+o.level+" was dropped during download."),void _.fragmentTracker.removeFragment(o);o.stats.chunkCount++,_._handleFragmentLoadProgress(s)})).then((function(s){if(s){_.fragLoadError=0;var m=_.state;_.fragContextChanged(o)?(m===Se.FRAG_LOADING||!_.fragCurrent&&m===Se.PARSING)&&(_.fragmentTracker.removeFragment(o),_.state=Se.IDLE):("payload"in s&&(_.log("Loaded fragment "+o.sn+" of level "+o.level),_.hls.trigger(H.Events.FRAG_LOADED,s)),_._handleFragmentLoadComplete(s))}})).catch((function(s){_.state!==Se.STOPPED&&_.state!==Se.ERROR&&(_.warn(s),_.resetFragmentLoading(o))}))},s.flushMainBuffer=function flushMainBuffer(o,s,m){if(void 0===m&&(m=null),o-s){var _={startOffset:o,endOffset:s,type:m};this.fragLoadError=0,this.hls.trigger(H.Events.BUFFER_FLUSHING,_)}},s._loadInitSegment=function _loadInitSegment(o,s){var m=this;this._doFragLoad(o,s).then((function(s){if(!s||m.fragContextChanged(o)||!m.levels)throw new Error("init load aborted");return s})).then((function(s){var _=m.hls,S=s.payload,E=o.decryptdata;if(S&&S.byteLength>0&&E&&E.key&&E.iv&&"AES-128"===E.method){var A=self.performance.now();return m.decrypter.decrypt(new Uint8Array(S),E.key.buffer,E.iv.buffer).then((function(m){var S=self.performance.now();return _.trigger(H.Events.FRAG_DECRYPTED,{frag:o,payload:m,stats:{tstart:A,tdecrypt:S}}),s.payload=m,s}))}return s})).then((function(s){var _=m.fragCurrent,S=m.hls,E=m.levels;if(!E)throw new Error("init load aborted, missing levels");var A=E[o.level].details;console.assert(A,"Level details are defined when init segment is loaded");var O=o.stats;m.state=Se.IDLE,m.fragLoadError=0,o.data=new Uint8Array(s.payload),O.parsing.start=O.buffering.start=self.performance.now(),O.parsing.end=O.buffering.end=self.performance.now(),s.frag===_&&S.trigger(H.Events.FRAG_BUFFERED,{stats:O,frag:_,part:null,id:o.type}),m.tick()})).catch((function(s){m.state!==Se.STOPPED&&m.state!==Se.ERROR&&(m.warn(s),m.resetFragmentLoading(o))}))},s.fragContextChanged=function fragContextChanged(o){var s=this.fragCurrent;return!o||!s||o.level!==s.level||o.sn!==s.sn||o.urlId!==s.urlId},s.fragBufferedComplete=function fragBufferedComplete(o,s){var m,_,S,E,O=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+o.type+" sn: "+o.sn+(s?" part: "+s.index:"")+" of "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+o.level+" (frag:["+(null!=(m=o.startPTS)?m:NaN).toFixed(3)+"-"+(null!=(_=o.endPTS)?_:NaN).toFixed(3)+"] > buffer:"+(O?me.default.toString(A.BufferHelper.getBuffered(O)):"(detached)")+")"),this.state=Se.IDLE,O&&(!this.loadedmetadata&&o.type==_e.PlaylistLevelType.MAIN&&O.buffered.length&&(null===(S=this.fragCurrent)||void 0===S?void 0:S.sn)===(null===(E=this.fragPrevious)||void 0===E?void 0:E.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},s.seekToStartPos=function seekToStartPos(){},s._handleFragmentLoadComplete=function _handleFragmentLoadComplete(o){var s=this.transmuxer;if(s){var m=o.frag,_=o.part,S=o.partsLoaded,E=!S||0===S.length||S.some((function(o){return!o})),A=new z.ChunkMetadata(m.level,m.sn,m.stats.chunkCount+1,0,_?_.index:-1,!E);s.flush(A)}},s._handleFragmentLoadProgress=function _handleFragmentLoadProgress(o){},s._doFragLoad=function _doFragLoad(o,s,m,S){var E,A=this;if(void 0===m&&(m=null),!this.levels)throw new Error("frag load aborted, missing levels");var O=null;if(!o.encrypted||null!==(E=o.decryptdata)&&void 0!==E&&E.key?!o.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(o,s.encryptedFragments):(this.log("Loading key for "+o.sn+" of ["+s.startSN+"-"+s.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+o.level),this.state=Se.KEY_LOADING,this.fragCurrent=o,O=this.keyLoader.load(o).then((function(o){if(!A.fragContextChanged(o.frag))return A.hls.trigger(H.Events.KEY_LOADED,o),A.state===Se.KEY_LOADING&&(A.state=Se.IDLE),o})),this.hls.trigger(H.Events.KEY_LOADING,{frag:o}),this.throwIfFragContextChanged("KEY_LOADING")),m=Math.max(o.start,m||0),this.config.lowLatencyMode&&s){var K=s.partList;if(K&&S){m>o.end&&s.fragmentHint&&(o=s.fragmentHint);var z=this.getNextPart(K,o,m);if(z>-1){var G=K[z];return this.log("Loading part sn: "+o.sn+" p: "+G.index+" cc: "+o.cc+" of playlist ["+s.startSN+"-"+s.endSN+"] parts [0-"+z+"-"+(K.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+o.level+", target: "+parseFloat(m.toFixed(3))),this.nextLoadPosition=G.start+G.duration,this.state=Se.FRAG_LOADING,this.hls.trigger(H.Events.FRAG_LOADING,{frag:o,part:K[z],targetBufferTime:m}),this.throwIfFragContextChanged("FRAG_LOADING parts"),O?O.then((function(s){return!s||A.fragContextChanged(s.frag)?null:A.doFragPartsLoad(o,K,z,S)})).catch((function(o){return A.handleFragLoadError(o)})):this.doFragPartsLoad(o,K,z,S).catch((function(o){return A.handleFragLoadError(o)}))}if(!o.url||this.loadedEndOfParts(K,m))return Promise.resolve(null)}}this.log("Loading fragment "+o.sn+" cc: "+o.cc+" "+(s?"of ["+s.startSN+"-"+s.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+o.level+", target: "+parseFloat(m.toFixed(3))),(0,_.isFiniteNumber)(o.sn)&&!this.bitrateTest&&(this.nextLoadPosition=o.start+o.duration),this.state=Se.FRAG_LOADING,this.hls.trigger(H.Events.FRAG_LOADING,{frag:o,targetBufferTime:m}),this.throwIfFragContextChanged("FRAG_LOADING");var q=this.config.progressive;return q&&O?O.then((function(s){return!s||A.fragContextChanged(null==s?void 0:s.frag)?null:A.fragmentLoader.load(o,S)})).catch((function(o){return A.handleFragLoadError(o)})):Promise.all([this.fragmentLoader.load(o,q?S:void 0),O]).then((function(o){var s=o[0];return!q&&s&&S&&S(s),s})).catch((function(o){return A.handleFragLoadError(o)}))},s.throwIfFragContextChanged=function throwIfFragContextChanged(o){if(null===this.fragCurrent)throw new Error("frag load aborted, context changed in "+o)},s.doFragPartsLoad=function doFragPartsLoad(o,s,m,_){var S=this;return new Promise((function(E,A){var O=[];!function loadPartIndex(m){var K=s[m];S.fragmentLoader.loadPart(o,K,_).then((function(_){O[K.index]=_;var A=_.part;S.hls.trigger(H.Events.FRAG_LOADED,_);var z=s[m+1];if(!z||z.fragment!==o)return E({frag:o,part:A,partsLoaded:O});loadPartIndex(m+1)})).catch(A)}(m)}))},s.handleFragLoadError=function handleFragLoadError(o){if("data"in o){var s=o.data;o.data&&s.details===K.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(s.frag,s.part):this.hls.trigger(H.Events.ERROR,s)}else this.hls.trigger(H.Events.ERROR,{type:K.ErrorTypes.OTHER_ERROR,details:K.ErrorDetails.INTERNAL_EXCEPTION,err:o,fatal:!0});return null},s._handleTransmuxerFlush=function _handleTransmuxerFlush(o){var s=this.getCurrentContext(o);if(s&&this.state===Se.PARSING){var m=s.frag,_=s.part,S=s.level,E=self.performance.now();m.stats.parsing.end=E,_&&(_.stats.parsing.end=E),this.updateLevelTiming(m,_,S,o.partial)}else this.fragCurrent||this.state===Se.STOPPED||this.state===Se.ERROR||(this.state=Se.IDLE)},s.getCurrentContext=function getCurrentContext(o){var s=this.levels,m=o.level,_=o.sn,S=o.part;if(!s||!s[m])return this.warn("Levels object was unset while buffering fragment "+_+" of level "+m+". The current chunk will not be buffered."),null;var E=s[m],A=S>-1?(0,J.getPartWith)(E,_,S):null,O=A?A.fragment:(0,J.getFragmentWithSN)(E,_,this.fragCurrent);return O?{frag:O,part:A,level:E}:null},s.bufferFragmentData=function bufferFragmentData(o,s,m,_){if(o&&this.state===Se.PARSING){var S=o.data1,E=o.data2,A=S;if(S&&E&&(A=(0,G.appendUint8Array)(S,E)),A&&A.length){var O={type:o.type,frag:s,part:m,chunkMeta:_,parent:s.type,data:A};this.hls.trigger(H.Events.BUFFER_APPENDING,O),o.dropped&&o.independent&&!m&&this.flushBufferGap(s)}}},s.flushBufferGap=function flushBufferGap(o){var s=this.media;if(s)if(A.BufferHelper.isBuffered(s,s.currentTime)){var m=s.currentTime,_=A.BufferHelper.bufferInfo(s,m,0),S=o.duration,E=Math.min(2*this.config.maxFragLookUpTolerance,.25*S),O=Math.max(Math.min(o.start-E,_.end-E),m+E);o.start-O>E&&this.flushMainBuffer(O,o.start)}else this.flushMainBuffer(0,o.start)},s.getFwdBufferInfo=function getFwdBufferInfo(o,s){var m=this.config,S=this.getLoadPosition();if(!(0,_.isFiniteNumber)(S))return null;var E=A.BufferHelper.bufferInfo(o,S,m.maxBufferHole);if(0===E.len&&void 0!==E.nextStart){var O=this.fragmentTracker.getBufferedFrag(S,s);if(O&&E.nextStart<O.end)return A.BufferHelper.bufferInfo(o,S,Math.max(E.nextStart,m.maxBufferHole))}return E},s.getMaxBufferLength=function getMaxBufferLength(o){var s,m=this.config;return s=o?Math.max(8*m.maxBufferSize/o,m.maxBufferLength):m.maxBufferLength,Math.min(s,m.maxMaxBufferLength)},s.reduceMaxBufferLength=function reduceMaxBufferLength(o){var s=this.config,m=o||s.maxBufferLength;return s.maxMaxBufferLength>=m&&(s.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+s.maxMaxBufferLength+"s"),!0)},s.getNextFragment=function getNextFragment(o,s){var m=s.fragments,_=m.length;if(!_)return null;var S,E=this.config,A=m[0].start;if(s.live){var O=E.initialLiveManifestSize;if(_<O)return this.warn("Not enough fragments to start playback (have: "+_+", need: "+O+")"),null;s.PTSKnown||this.startFragRequested||-1!==this.startPosition||(S=this.getInitialLiveFragment(s,m),this.startPosition=S?this.hls.liveSyncPosition||S.start:o)}else o<=A&&(S=m[0]);if(!S){var H=E.lowLatencyMode?s.partEnd:s.fragmentEnd;S=this.getFragmentAtPosition(o,H,s)}return this.mapToInitFragWhenRequired(S)},s.mapToInitFragWhenRequired=function mapToInitFragWhenRequired(o){return null==o||!o.initSegment||null!=o&&o.initSegment.data||this.bitrateTest?o:o.initSegment},s.getNextPart=function getNextPart(o,s,m){for(var _=-1,S=!1,E=!0,A=0,O=o.length;A<O;A++){var H=o[A];if(E=E&&!H.independent,_>-1&&m<H.start)break;var K=H.loaded;K?_=-1:(S||H.independent||E)&&H.fragment===s&&(_=A),S=K}return _},s.loadedEndOfParts=function loadedEndOfParts(o,s){var m=o[o.length-1];return m&&s>m.start&&m.loaded},s.getInitialLiveFragment=function getInitialLiveFragment(o,s){var m=this.fragPrevious,_=null;if(m){if(o.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+m.programDateTime),_=(0,X.findFragmentByPDT)(s,m.endProgramDateTime,this.config.maxFragLookUpTolerance)),!_){var S=m.sn+1;if(S>=o.startSN&&S<=o.endSN){var E=s[S-o.startSN];m.cc===E.cc&&(_=E,this.log("Live playlist, switching playlist, load frag with next SN: "+_.sn))}_||(_=(0,X.findFragWithCC)(s,m.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+_.sn)}}else{var A=this.hls.liveSyncPosition;null!==A&&(_=this.getFragmentAtPosition(A,this.bitrateTest?o.fragmentEnd:o.edge,o))}return _},s.getFragmentAtPosition=function getFragmentAtPosition(o,s,m){var _,S=this.config,A=this.fragPrevious,O=m.fragments,H=m.endSN,K=m.fragmentHint,z=S.maxFragLookUpTolerance,G=!!(S.lowLatencyMode&&m.partList&&K);if(G&&K&&!this.bitrateTest&&(O=O.concat(K),H=K.sn),o<s){var q=o>s-z?0:z;_=(0,X.findFragmentByPTS)(A,O,o,q)}else _=O[O.length-1];if(_){var J=_.sn-m.startSN;if(this.fragmentTracker.getState(_)===E.FragmentState.OK&&(A=_),A&&_.sn===A.sn&&!G)if(A&&_.level===A.level){var ae=O[J+1];_.sn<H&&this.fragmentTracker.getState(ae)!==E.FragmentState.OK?(this.log("SN "+_.sn+" just loaded, load next one: "+ae.sn),_=ae):_=null}}return _},s.synchronizeToLiveEdge=function synchronizeToLiveEdge(o){var s=this.config,m=this.media;if(m){var _=this.hls.liveSyncPosition,S=m.currentTime,E=o.fragments[0].start,A=o.edge,O=S>=E-s.maxFragLookUpTolerance&&S<=A;if(null!==_&&m.duration>_&&(S<_||!O)){var H=void 0!==s.liveMaxLatencyDuration?s.liveMaxLatencyDuration:s.liveMaxLatencyDurationCount*o.targetduration;(!O&&m.readyState<4||S<A-H)&&(this.loadedmetadata||(this.nextLoadPosition=_),m.readyState&&(this.warn("Playback: "+S.toFixed(3)+" is located too far from the end of live sliding playlist: "+A+", reset currentTime to : "+_.toFixed(3)),m.currentTime=_))}}},s.alignPlaylists=function alignPlaylists(o,s){var m=this.levels,S=this.levelLastLoaded,E=this.fragPrevious,A=null!==S?m[S]:null,O=o.fragments.length;if(!O)return this.warn("No fragments in live playlist"),0;var H=o.fragments[0].start,K=!s,z=o.alignedSliding&&(0,_.isFiniteNumber)(H);if(K||!z&&!H){(0,q.alignStream)(E,A,o);var G=o.fragments[0].start;return this.log("Live playlist sliding: "+G.toFixed(2)+" start-sn: "+(s?s.startSN:"na")+"->"+o.startSN+" prev-sn: "+(E?E.sn:"na")+" fragments: "+O),G}return H},s.waitForCdnTuneIn=function waitForCdnTuneIn(o){return o.live&&o.canBlockReload&&o.partTarget&&o.tuneInGoal>Math.max(o.partHoldBack,3*o.partTarget)},s.setStartPosition=function setStartPosition(o,s){var m=this.startPosition;if(m<s&&(m=-1),-1===m||-1===this.lastCurrentTime){var S=o.startTimeOffset;(0,_.isFiniteNumber)(S)?(m=s+S,S<0&&(m+=o.totalduration),m=Math.min(Math.max(s,m),s+o.totalduration),this.log("Start time offset "+S+" found in playlist, adjust startPosition to "+m),this.startPosition=m):o.live?m=this.hls.liveSyncPosition||s:this.startPosition=m=0,this.lastCurrentTime=m}this.nextLoadPosition=m},s.getLoadPosition=function getLoadPosition(){var o=this.media,s=0;return this.loadedmetadata&&o?s=o.currentTime:this.nextLoadPosition&&(s=this.nextLoadPosition),s},s.handleFragLoadAborted=function handleFragLoadAborted(o,s){this.transmuxer&&"initSegment"!==o.sn&&o.stats.aborted&&(this.warn("Fragment "+o.sn+(s?" part"+s.index:"")+" of level "+o.level+" was aborted"),this.resetFragmentLoading(o))},s.resetFragmentLoading=function resetFragmentLoading(o){this.fragCurrent&&(this.fragContextChanged(o)||this.state===Se.FRAG_LOADING_WAITING_RETRY)||(this.state=Se.IDLE)},s.onFragmentOrKeyLoadError=function onFragmentOrKeyLoadError(o,s){if(s.fatal)return this.stopLoad(),void(this.state=Se.ERROR);var m=this.config;if(s.chunkMeta){var _=this.getCurrentContext(s.chunkMeta);_&&(s.frag=_.frag,s.levelRetry=!0,this.fragLoadError=m.fragLoadingMaxRetry)}var S=s.frag;if(S&&S.type===o){var E=this.fragCurrent;if(console.assert(E&&S.sn===E.sn&&S.level===E.level&&S.urlId===E.urlId,"Frag load error must match current frag to retry"),this.fragLoadError+1<=m.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var A=Math.min(Math.pow(2,this.fragLoadError)*m.fragLoadingRetryDelay,m.fragLoadingMaxRetryTimeout);this.warn("Fragment "+S.sn+" of "+o+" "+S.level+" failed to load, retrying in "+A+"ms"),this.retryDate=self.performance.now()+A,this.fragLoadError++,this.state=Se.FRAG_LOADING_WAITING_RETRY}else s.levelRetry?(o===_e.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=Se.IDLE):(O.logger.error(s.details+" reaches max retry, redispatch as fatal ..."),s.fatal=!0,this.hls.stopLoad(),this.state=Se.ERROR)}},s.afterBufferFlushed=function afterBufferFlushed(o,s,m){if(o){var _=A.BufferHelper.getBuffered(o);this.fragmentTracker.detectEvictedFragments(s,_,m),this.state===Se.ENDED&&this.resetLoadingState()}},s.resetLoadingState=function resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Se.IDLE},s.resetStartWhenNotLoaded=function resetStartWhenNotLoaded(o){if(!this.loadedmetadata){this.startFragRequested=!1;var s=this.levels?this.levels[o].details:null;null!=s&&s.live?(this.startPosition=-1,this.setStartPosition(s,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},s.updateLevelTiming=function updateLevelTiming(o,s,m,_){var S=this,E=m.details;console.assert(!!E,"level.details must be defined");var A=Object.keys(o.elementaryStreams).reduce((function(s,A){var O=o.elementaryStreams[A];if(O){var K=O.endPTS-O.startPTS;if(K<=0)return S.warn("Could not parse fragment "+o.sn+" "+A+" duration reliably ("+K+")"),s||!1;var z=_?0:(0,J.updateFragPTSDTS)(E,o,O.startPTS,O.endPTS,O.startDTS,O.endDTS);return S.hls.trigger(H.Events.LEVEL_PTS_UPDATED,{details:E,level:m,drift:z,type:A,frag:o,start:O.startPTS,end:O.endPTS}),!0}return s}),!1);A||(this.warn("Found no media in fragment "+o.sn+" of level "+m.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=Se.PARSED,this.hls.trigger(H.Events.FRAG_PARSED,{frag:o,part:s})},s.resetTransmuxer=function resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(BaseStreamController,[{key:"state",get:function get(){return this._state},set:function set(o){var s=this._state;s!==o&&(this._state=o,this.log(s+"->"+o))}}]),BaseStreamController}(S.default)},"./src/controller/buffer-controller.ts":
/*!*********************************************!*\
    !*** ./src/controller/buffer-controller.ts ***!
    \*********************************************/function srcControllerBufferControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return X}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../utils/logger */"./src/utils/logger.ts"),A=m(/*! ../errors */"./src/errors.ts"),O=m(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),H=m(/*! ../utils/mediasource-helper */"./src/utils/mediasource-helper.ts"),K=m(/*! ../loader/fragment */"./src/loader/fragment.ts"),z=m(/*! ./buffer-operation-queue */"./src/controller/buffer-operation-queue.ts"),G=(0,H.getMediaSource)(),q=/([ha]vc.)(?:\.[^.,]+)+/,X=function(){function BufferController(o){var s=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var o=s.media,m=s.mediaSource;E.logger.log("[buffer-controller]: Media source opened"),o&&(o.removeEventListener("emptied",s._onMediaEmptied),s.updateMediaElementDuration(),s.hls.trigger(S.Events.MEDIA_ATTACHED,{media:o})),m&&m.removeEventListener("sourceopen",s._onMediaSourceOpen),s.checkPendingTracks()},this._onMediaSourceClose=function(){E.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){E.logger.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=function(){var o=s.media,m=s._objectUrl;o&&o.src!==m&&E.logger.error("Media element src was set while attaching MediaSource ("+m+" > "+o.src+")")},this.hls=o,this._initSourceBuffer(),this.registerListeners()}var o=BufferController.prototype;return o.hasSourceTypes=function hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},o.destroy=function destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},o.registerListeners=function registerListeners(){var o=this.hls;o.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(S.Events.BUFFER_RESET,this.onBufferReset,this),o.on(S.Events.BUFFER_APPENDING,this.onBufferAppending,this),o.on(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.on(S.Events.BUFFER_EOS,this.onBufferEos,this),o.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),o.on(S.Events.FRAG_PARSED,this.onFragParsed,this),o.on(S.Events.FRAG_CHANGED,this.onFragChanged,this)},o.unregisterListeners=function unregisterListeners(){var o=this.hls;o.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(S.Events.BUFFER_RESET,this.onBufferReset,this),o.off(S.Events.BUFFER_APPENDING,this.onBufferAppending,this),o.off(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.off(S.Events.BUFFER_EOS,this.onBufferEos,this),o.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),o.off(S.Events.FRAG_PARSED,this.onFragParsed,this),o.off(S.Events.FRAG_CHANGED,this.onFragChanged,this)},o._initSourceBuffer=function _initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new z.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},o.onManifestParsed=function onManifestParsed(o,s){var m=2;(s.audio&&!s.video||!s.altAudio)&&(m=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=m,this.details=null,E.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},o.onMediaAttaching=function onMediaAttaching(o,s){var m=this.media=s.media;if(m&&G){var _=this.mediaSource=new G;_.addEventListener("sourceopen",this._onMediaSourceOpen),_.addEventListener("sourceended",this._onMediaSourceEnded),_.addEventListener("sourceclose",this._onMediaSourceClose),m.src=self.URL.createObjectURL(_),this._objectUrl=m.src,m.addEventListener("emptied",this._onMediaEmptied)}},o.onMediaDetaching=function onMediaDetaching(){var o=this.media,s=this.mediaSource,m=this._objectUrl;if(s){if(E.logger.log("[buffer-controller]: media source detaching"),"open"===s.readyState)try{s.endOfStream()}catch(o){E.logger.warn("[buffer-controller]: onMediaDetaching: "+o.message+" while calling endOfStream")}this.onBufferReset(),s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),o&&(o.removeEventListener("emptied",this._onMediaEmptied),m&&self.URL.revokeObjectURL(m),o.src===m?(o.removeAttribute("src"),o.load()):E.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(S.Events.MEDIA_DETACHED,void 0)},o.onBufferReset=function onBufferReset(){var o=this;this.getSourceBufferTypes().forEach((function(s){var m=o.sourceBuffer[s];try{m&&(o.removeBufferListeners(s),o.mediaSource&&o.mediaSource.removeSourceBuffer(m),o.sourceBuffer[s]=void 0)}catch(o){E.logger.warn("[buffer-controller]: Failed to reset the "+s+" buffer",o)}})),this._initSourceBuffer()},o.onBufferCodecs=function onBufferCodecs(o,s){var m=this,_=this.getSourceBufferTypes().length;Object.keys(s).forEach((function(o){if(_){var S=m.tracks[o];if(S&&"function"==typeof S.buffer.changeType){var A=s[o],O=A.id,H=A.codec,K=A.levelCodec,z=A.container,G=A.metadata,X=(S.levelCodec||S.codec).replace(q,"$1"),J=(K||H).replace(q,"$1");if(X!==J){var ae=z+";codecs="+(K||H);m.appendChangeType(o,ae),E.logger.log("[buffer-controller]: switching codec "+X+" to "+J),m.tracks[o]={buffer:S.buffer,codec:H,container:z,levelCodec:K,metadata:G,id:O}}}}else m.pendingTracks[o]=s[o]})),_||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},o.appendChangeType=function appendChangeType(o,s){var m=this,_=this.operationQueue,S={execute:function execute(){var S=m.sourceBuffer[o];S&&(E.logger.log("[buffer-controller]: changing "+o+" sourceBuffer type to "+s),S.changeType(s)),_.shiftAndExecuteNext(o)},onStart:function onStart(){},onComplete:function onComplete(){},onError:function onError(s){E.logger.warn("[buffer-controller]: Failed to change "+o+" SourceBuffer type",s)}};_.append(S,o)},o.onBufferAppending=function onBufferAppending(o,s){var m=this,_=this.hls,H=this.operationQueue,K=this.tracks,z=s.data,G=s.type,q=s.frag,X=s.part,J=s.chunkMeta,ae=J.buffering[G],pe=self.performance.now();ae.start=pe;var me=q.stats.buffering,_e=X?X.stats.buffering:null;0===me.start&&(me.start=pe),_e&&0===_e.start&&(_e.start=pe);var Se=K.audio,Ee=!1;"audio"===G&&"audio/mpeg"===(null==Se?void 0:Se.container)&&(Ee=!this.lastMpegAudioChunk||1===J.id||this.lastMpegAudioChunk.sn!==J.sn,this.lastMpegAudioChunk=J);var De=q.start,$e={execute:function execute(){if(ae.executeStart=self.performance.now(),Ee){var o=m.sourceBuffer[G];if(o){var s=De-o.timestampOffset;Math.abs(s)>=.1&&(E.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+De+" (delta: "+s+") sn: "+q.sn+")"),o.timestampOffset=De)}}m.appendExecutor(z,G)},onStart:function onStart(){},onComplete:function onComplete(){var o=self.performance.now();ae.executeEnd=ae.end=o,0===me.first&&(me.first=o),_e&&0===_e.first&&(_e.first=o);var s=m.sourceBuffer,_={};for(var E in s)_[E]=O.BufferHelper.getBuffered(s[E]);m.appendError=0,m.hls.trigger(S.Events.BUFFER_APPENDED,{type:G,frag:q,part:X,chunkMeta:J,parent:q.type,timeRanges:_})},onError:function onError(o){E.logger.error("[buffer-controller]: Error encountered while trying to append to the "+G+" SourceBuffer",o);var s={type:A.ErrorTypes.MEDIA_ERROR,parent:q.type,details:A.ErrorDetails.BUFFER_APPEND_ERROR,err:o,fatal:!1};o.code===DOMException.QUOTA_EXCEEDED_ERR?s.details=A.ErrorDetails.BUFFER_FULL_ERROR:(m.appendError++,s.details=A.ErrorDetails.BUFFER_APPEND_ERROR,m.appendError>_.config.appendErrorMaxRetry&&(E.logger.error("[buffer-controller]: Failed "+_.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),s.fatal=!0,_.stopLoad())),_.trigger(S.Events.ERROR,s)}};H.append($e,G)},o.onBufferFlushing=function onBufferFlushing(o,s){var m=this,_=this.operationQueue,A=function flushOperation(o){return{execute:m.removeExecutor.bind(m,o,s.startOffset,s.endOffset),onStart:function onStart(){},onComplete:function onComplete(){m.hls.trigger(S.Events.BUFFER_FLUSHED,{type:o})},onError:function onError(s){E.logger.warn("[buffer-controller]: Failed to remove from "+o+" SourceBuffer",s)}}};s.type?_.append(A(s.type),s.type):this.getSourceBufferTypes().forEach((function(o){_.append(A(o),o)}))},o.onFragParsed=function onFragParsed(o,s){var m=this,_=s.frag,A=s.part,O=[],H=A?A.elementaryStreams:_.elementaryStreams;H[K.ElementaryStreamTypes.AUDIOVIDEO]?O.push("audiovideo"):(H[K.ElementaryStreamTypes.AUDIO]&&O.push("audio"),H[K.ElementaryStreamTypes.VIDEO]&&O.push("video"));0===O.length&&E.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+_.type+" level: "+_.level+" sn: "+_.sn),this.blockBuffers((function onUnblocked(){var o=self.performance.now();_.stats.buffering.end=o,A&&(A.stats.buffering.end=o);var s=A?A.stats:_.stats;m.hls.trigger(S.Events.FRAG_BUFFERED,{frag:_,part:A,stats:s,id:_.type})}),O)},o.onFragChanged=function onFragChanged(o,s){this.flushBackBuffer()},o.onBufferEos=function onBufferEos(o,s){var m=this,_=this.getSourceBufferTypes().reduce((function(o,_){var S=m.sourceBuffer[_];return!S||s.type&&s.type!==_||(S.ending=!0,S.ended||(S.ended=!0,E.logger.log("[buffer-controller]: "+_+" sourceBuffer now EOS"))),o&&!(S&&!S.ended)}),!0);_&&(E.logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers((function(){m.getSourceBufferTypes().forEach((function(o){var s=m.sourceBuffer[o];s&&(s.ending=!1)}));var o=m.mediaSource;o&&"open"===o.readyState?(E.logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),o.endOfStream()):o&&E.logger.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+o.readyState)})))},o.onLevelUpdated=function onLevelUpdated(o,s){var m=s.details;m.fragments.length&&(this.details=m,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},o.flushBackBuffer=function flushBackBuffer(){var o=this.hls,s=this.details,m=this.media,A=this.sourceBuffer;if(m&&null!==s){var H=this.getSourceBufferTypes();if(H.length){var K=s.live&&null!==o.config.liveBackBufferLength?o.config.liveBackBufferLength:o.config.backBufferLength;if((0,_.isFiniteNumber)(K)&&!(K<0)){var z=m.currentTime,G=s.levelTargetDuration,q=Math.max(K,G),X=Math.floor(z/G)*G-q;H.forEach((function(m){var _=A[m];if(_){var H=O.BufferHelper.getBuffered(_);if(H.length>0&&X>H.start(0)){if(o.trigger(S.Events.BACK_BUFFER_REACHED,{bufferEnd:X}),s.live)o.trigger(S.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:X});else if(_.ended&&H.end(H.length-1)-z<2*G)return void E.logger.info("[buffer-controller]: Cannot flush "+m+" back buffer while SourceBuffer is in ended state");o.trigger(S.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:X,type:m})}}}))}}}},o.updateMediaElementDuration=function updateMediaElementDuration(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var o=this.details,s=this.hls,m=this.media,S=this.mediaSource,A=o.fragments[0].start+o.totalduration,O=m.duration,H=(0,_.isFiniteNumber)(S.duration)?S.duration:0;o.live&&s.config.liveDurationInfinity?(E.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),S.duration=1/0,this.updateSeekableRange(o)):(A>H&&A>O||!(0,_.isFiniteNumber)(O))&&(E.logger.log("[buffer-controller]: Updating Media Source duration to "+A.toFixed(3)),S.duration=A)}},o.updateSeekableRange=function updateSeekableRange(o){var s=this.mediaSource,m=o.fragments;if(m.length&&o.live&&null!=s&&s.setLiveSeekableRange){var _=Math.max(0,m[0].start),S=Math.max(_,_+o.totalduration);s.setLiveSeekableRange(_,S)}},o.checkPendingTracks=function checkPendingTracks(){var o=this.bufferCodecEventsExpected,s=this.operationQueue,m=this.pendingTracks,_=Object.keys(m).length;if(_&&!o||2===_){this.createSourceBuffers(m),this.pendingTracks={};var E=this.getSourceBufferTypes();if(0===E.length)return void this.hls.trigger(S.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});E.forEach((function(o){s.executeNext(o)}))}},o.createSourceBuffers=function createSourceBuffers(o){var s=this.sourceBuffer,m=this.mediaSource;if(!m)throw Error("createSourceBuffers called when mediaSource was null");var _=0;for(var O in o)if(!s[O]){var H=o[O];if(!H)throw Error("source buffer exists for track "+O+", however track does not");var K=H.levelCodec||H.codec,z=H.container+";codecs="+K;E.logger.log("[buffer-controller]: creating sourceBuffer("+z+")");try{var G=s[O]=m.addSourceBuffer(z),q=O;this.addBufferListener(q,"updatestart",this._onSBUpdateStart),this.addBufferListener(q,"updateend",this._onSBUpdateEnd),this.addBufferListener(q,"error",this._onSBUpdateError),this.tracks[O]={buffer:G,codec:K,container:H.container,levelCodec:H.levelCodec,metadata:H.metadata,id:H.id},_++}catch(o){E.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+o.message),this.hls.trigger(S.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:o,mimeType:z})}}_&&this.hls.trigger(S.Events.BUFFER_CREATED,{tracks:this.tracks})},o._onSBUpdateStart=function _onSBUpdateStart(o){this.operationQueue.current(o).onStart()},o._onSBUpdateEnd=function _onSBUpdateEnd(o){var s=this.operationQueue;s.current(o).onComplete(),s.shiftAndExecuteNext(o)},o._onSBUpdateError=function _onSBUpdateError(o,s){E.logger.error("[buffer-controller]: "+o+" SourceBuffer error",s),this.hls.trigger(S.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var m=this.operationQueue.current(o);m&&m.onError(s)},o.removeExecutor=function removeExecutor(o,s,m){var S=this.media,A=this.mediaSource,O=this.operationQueue,H=this.sourceBuffer[o];if(!S||!A||!H)return E.logger.warn("[buffer-controller]: Attempting to remove from the "+o+" SourceBuffer, but it does not exist"),void O.shiftAndExecuteNext(o);var K=(0,_.isFiniteNumber)(S.duration)?S.duration:1/0,z=(0,_.isFiniteNumber)(A.duration)?A.duration:1/0,G=Math.max(0,s),q=Math.min(m,K,z);q>G&&!H.ending?(H.ended=!1,E.logger.log("[buffer-controller]: Removing ["+G+","+q+"] from the "+o+" SourceBuffer"),console.assert(!H.updating,o+" sourceBuffer must not be updating"),H.remove(G,q)):O.shiftAndExecuteNext(o)},o.appendExecutor=function appendExecutor(o,s){var m=this.operationQueue,_=this.sourceBuffer[s];if(!_)return E.logger.warn("[buffer-controller]: Attempting to append to the "+s+" SourceBuffer, but it does not exist"),void m.shiftAndExecuteNext(s);_.ended=!1,console.assert(!_.updating,s+" sourceBuffer must not be updating"),_.appendBuffer(o)},o.blockBuffers=function blockBuffers(o,s){var m=this;if(void 0===s&&(s=this.getSourceBufferTypes()),!s.length)return E.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(o);var _=this.operationQueue,S=s.map((function(o){return _.appendBlocker(o)}));Promise.all(S).then((function(){o(),s.forEach((function(o){var s=m.sourceBuffer[o];s&&s.updating||_.shiftAndExecuteNext(o)}))}))},o.getSourceBufferTypes=function getSourceBufferTypes(){return Object.keys(this.sourceBuffer)},o.addBufferListener=function addBufferListener(o,s,m){var _=this.sourceBuffer[o];if(_){var S=m.bind(this,o);this.listeners[o].push({event:s,listener:S}),_.addEventListener(s,S)}},o.removeBufferListeners=function removeBufferListeners(o){var s=this.sourceBuffer[o];s&&this.listeners[o].forEach((function(o){s.removeEventListener(o.event,o.listener)}))},BufferController}()},"./src/controller/buffer-operation-queue.ts":
/*!**************************************************!*\
    !*** ./src/controller/buffer-operation-queue.ts ***!
    \**************************************************/function srcControllerBufferOperationQueueTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return S}});var _=m(/*! ../utils/logger */"./src/utils/logger.ts"),S=function(){function BufferOperationQueue(o){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=o}var o=BufferOperationQueue.prototype;return o.append=function append(o,s){var m=this.queues[s];m.push(o),1===m.length&&this.buffers[s]&&this.executeNext(s)},o.insertAbort=function insertAbort(o,s){this.queues[s].unshift(o),this.executeNext(s)},o.appendBlocker=function appendBlocker(o){var s,m=new Promise((function(o){s=o})),_={execute:s,onStart:function onStart(){},onComplete:function onComplete(){},onError:function onError(){}};return this.append(_,o),m},o.executeNext=function executeNext(o){var s=this.buffers,m=this.queues,S=s[o],E=m[o];if(E.length){var A=E[0];try{A.execute()}catch(s){_.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),A.onError(s),S&&S.updating||(E.shift(),this.executeNext(o))}}},o.shiftAndExecuteNext=function shiftAndExecuteNext(o){this.queues[o].shift(),this.executeNext(o)},o.current=function current(o){return this.queues[o][0]},BufferOperationQueue}()},"./src/controller/cap-level-controller.ts":
/*!************************************************!*\
    !*** ./src/controller/cap-level-controller.ts ***!
    \************************************************/function srcControllerCapLevelControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return E}});var _=m(/*! ../events */"./src/events.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}var S=function(){function CapLevelController(o){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=o,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var o=CapLevelController.prototype;return o.setStreamController=function setStreamController(o){this.streamController=o},o.destroy=function destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},o.registerListeners=function registerListeners(){var o=this.hls;o.on(_.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),o.on(_.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.on(_.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(_.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.on(_.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},o.unregisterListener=function unregisterListener(){var o=this.hls;o.off(_.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),o.off(_.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.off(_.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(_.Events.BUFFER_CODECS,this.onBufferCodecs,this),o.off(_.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},o.onFpsDropLevelCapping=function onFpsDropLevelCapping(o,s){CapLevelController.isLevelAllowed(s.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(s.droppedLevel)},o.onMediaAttaching=function onMediaAttaching(o,s){this.media=s.media instanceof HTMLVideoElement?s.media:null,this.clientRect=null},o.onManifestParsed=function onManifestParsed(o,s){var m=this.hls;this.restrictedLevels=[],this.firstLevel=s.firstLevel,m.config.capLevelToPlayerSize&&s.video&&this.startCapping()},o.onBufferCodecs=function onBufferCodecs(o,s){this.hls.config.capLevelToPlayerSize&&s.video&&this.startCapping()},o.onMediaDetaching=function onMediaDetaching(){this.stopCapping()},o.detectPlayerSize=function detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var o=this.hls.levels;if(o.length){var s=this.hls;s.autoLevelCapping=this.getMaxLevel(o.length-1),s.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=s.autoLevelCapping}}},o.getMaxLevel=function getMaxLevel(o){var s=this,m=this.hls.levels;if(!m.length)return-1;var _=m.filter((function(m,_){return CapLevelController.isLevelAllowed(_,s.restrictedLevels)&&_<=o}));return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize(_,this.mediaWidth,this.mediaHeight)},o.startCapping=function startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},o.getDimensions=function getDimensions(){if(this.clientRect)return this.clientRect;var o=this.media,s={width:0,height:0};if(o){var m=o.getBoundingClientRect();s.width=m.width,s.height=m.height,s.width||s.height||(s.width=m.right-m.left||o.width||0,s.height=m.bottom-m.top||o.height||0)}return this.clientRect=s,s},CapLevelController.isLevelAllowed=function isLevelAllowed(o,s){return void 0===s&&(s=[]),-1===s.indexOf(o)},CapLevelController.getMaxLevelByMediaSize=function getMaxLevelByMediaSize(o,s,m){if(!o||!o.length)return-1;for(var _=function atGreatestBandwidth(o,s){return!s||(o.width!==s.width||o.height!==s.height)},S=o.length-1,E=0;E<o.length;E+=1){var A=o[E];if((A.width>=s||A.height>=m)&&_(A,o[E+1])){S=E;break}}return S},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(CapLevelController,[{key:"mediaWidth",get:function get(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function get(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function get(){var o=1;if(!this.hls.config.ignoreDevicePixelRatio)try{o=self.devicePixelRatio}catch(o){}return o}}]),CapLevelController}(),E=S},"./src/controller/cmcd-controller.ts":
/*!*******************************************!*\
    !*** ./src/controller/cmcd-controller.ts ***!
    \*******************************************/function srcControllerCmcdControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return O}});var _=m(/*! ../events */"./src/events.ts"),S=m(/*! ../types/cmcd */"./src/types/cmcd.ts"),E=m(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),A=m(/*! ../utils/logger */"./src/utils/logger.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}function _createForOfIteratorHelperLoose(o,s){var m="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(m)return(m=m.call(o)).next.bind(m);if(Array.isArray(o)||(m=function _unsupportedIterableToArray(o,s){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,s);var m=Object.prototype.toString.call(o).slice(8,-1);"Object"===m&&o.constructor&&(m=o.constructor.name);if("Map"===m||"Set"===m)return Array.from(o);if("Arguments"===m||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return _arrayLikeToArray(o,s)}(o))||s&&o&&"number"==typeof o.length){m&&(o=m);var _=0;return function(){return _>=o.length?{done:!0}:{done:!1,value:o[_++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _arrayLikeToArray(o,s){(null==s||s>o.length)&&(s=o.length);for(var m=0,_=new Array(s);m<s;m++)_[m]=o[m];return _}function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}var O=function(){function CMCDController(o){var s=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){s.initialized&&(s.starved=!0),s.buffering=!0},this.onPlaying=function(){s.initialized||(s.initialized=!0),s.buffering=!1},this.applyPlaylistData=function(o){try{s.apply(o,{ot:S.CMCDObjectType.MANIFEST,su:!s.initialized})}catch(o){A.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=function(o){try{var m=o.frag,_=s.hls.levels[m.level],E=s.getObjectType(m),O={d:1e3*m.duration,ot:E};E!==S.CMCDObjectType.VIDEO&&E!==S.CMCDObjectType.AUDIO&&E!=S.CMCDObjectType.MUXED||(O.br=_.bitrate/1e3,O.tb=s.getTopBandwidth(E)/1e3,O.bl=s.getBufferLength(E)),s.apply(o,O)}catch(o){A.logger.warn("Could not generate segment CMCD data.",o)}},this.hls=o;var m=this.config=o.config,_=m.cmcd;null!=_&&(m.pLoader=this.createPlaylistLoader(),m.fLoader=this.createFragmentLoader(),this.sid=_.sessionId||CMCDController.uuid(),this.cid=_.contentId,this.useHeaders=!0===_.useHeaders,this.registerListeners())}var o=CMCDController.prototype;return o.registerListeners=function registerListeners(){var o=this.hls;o.on(_.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(_.Events.MEDIA_DETACHED,this.onMediaDetached,this),o.on(_.Events.BUFFER_CREATED,this.onBufferCreated,this)},o.unregisterListeners=function unregisterListeners(){var o=this.hls;o.off(_.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(_.Events.MEDIA_DETACHED,this.onMediaDetached,this),o.off(_.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},o.destroy=function destroy(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},o.onMediaAttached=function onMediaAttached(o,s){this.media=s.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},o.onMediaDetached=function onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},o.onBufferCreated=function onBufferCreated(o,s){var m,_;this.audioBuffer=null===(m=s.tracks.audio)||void 0===m?void 0:m.buffer,this.videoBuffer=null===(_=s.tracks.video)||void 0===_?void 0:_.buffer},o.createData=function createData(){var o;return{v:S.CMCDVersion,sf:S.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:null===(o=this.media)||void 0===o?void 0:o.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},o.apply=function apply(o,s){void 0===s&&(s={}),_extends(s,this.createData());var m=s.ot===S.CMCDObjectType.INIT||s.ot===S.CMCDObjectType.VIDEO||s.ot===S.CMCDObjectType.MUXED;if(this.starved&&m&&(s.bs=!0,s.su=!0,this.starved=!1),null==s.su&&(s.su=this.buffering),this.useHeaders){var _=CMCDController.toHeaders(s);if(!Object.keys(_).length)return;o.headers||(o.headers={}),_extends(o.headers,_)}else{var E=CMCDController.toQuery(s);if(!E)return;o.url=CMCDController.appendQueryToUri(o.url,E)}},o.getObjectType=function getObjectType(o){var s=o.type;return"subtitle"===s?S.CMCDObjectType.TIMED_TEXT:"initSegment"===o.sn?S.CMCDObjectType.INIT:"audio"===s?S.CMCDObjectType.AUDIO:"main"===s?this.hls.audioTracks.length?S.CMCDObjectType.VIDEO:S.CMCDObjectType.MUXED:void 0},o.getTopBandwidth=function getTopBandwidth(o){var s,m=0,_=this.hls;if(o===S.CMCDObjectType.AUDIO)s=_.audioTracks;else{var E=_.maxAutoLevel,A=E>-1?E+1:_.levels.length;s=_.levels.slice(0,A)}for(var O,H=_createForOfIteratorHelperLoose(s);!(O=H()).done;){var K=O.value;K.bitrate>m&&(m=K.bitrate)}return m>0?m:NaN},o.getBufferLength=function getBufferLength(o){var s=this.hls.media,m=o===S.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;return m&&s?1e3*E.BufferHelper.bufferInfo(m,s.currentTime,this.config.maxBufferHole).len:NaN},o.createPlaylistLoader=function createPlaylistLoader(){var o=this.config.pLoader,s=this.applyPlaylistData,m=o||this.config.loader;return function(){function CmcdPlaylistLoader(o){this.loader=void 0,this.loader=new m(o)}var o=CmcdPlaylistLoader.prototype;return o.destroy=function destroy(){this.loader.destroy()},o.abort=function abort(){this.loader.abort()},o.load=function load(o,m,_){s(o),this.loader.load(o,m,_)},_createClass(CmcdPlaylistLoader,[{key:"stats",get:function get(){return this.loader.stats}},{key:"context",get:function get(){return this.loader.context}}]),CmcdPlaylistLoader}()},o.createFragmentLoader=function createFragmentLoader(){var o=this.config.fLoader,s=this.applyFragmentData,m=o||this.config.loader;return function(){function CmcdFragmentLoader(o){this.loader=void 0,this.loader=new m(o)}var o=CmcdFragmentLoader.prototype;return o.destroy=function destroy(){this.loader.destroy()},o.abort=function abort(){this.loader.abort()},o.load=function load(o,m,_){s(o),this.loader.load(o,m,_)},_createClass(CmcdFragmentLoader,[{key:"stats",get:function get(){return this.loader.stats}},{key:"context",get:function get(){return this.loader.context}}]),CmcdFragmentLoader}()},CMCDController.uuid=function uuid(){var o=URL.createObjectURL(new Blob),uuid=o.toString();return URL.revokeObjectURL(o),uuid.slice(uuid.lastIndexOf("/")+1)},CMCDController.serialize=function serialize(o){for(var s,m=[],_=function isValid(o){return!Number.isNaN(o)&&null!=o&&""!==o&&!1!==o},S=function toRounded(o){return Math.round(o)},E=function toHundred(o){return 100*S(o/100)},A={br:S,d:S,bl:E,dl:E,mtp:E,nor:function toUrlSafe(o){return encodeURIComponent(o)},rtp:E,tb:S},O=_createForOfIteratorHelperLoose(Object.keys(o||{}).sort());!(s=O()).done;){var H=s.value,K=o[H];if(_(K)&&!("v"===H&&1===K||"pr"==H&&1===K)){var z=A[H];z&&(K=z(K));var G=typeof K,q=void 0;q="ot"===H||"sf"===H||"st"===H?H+"="+K:"boolean"===G?H:"number"===G?H+"="+K:H+"="+JSON.stringify(K),m.push(q)}}return m.join(",")},CMCDController.toHeaders=function toHeaders(o){for(var s={},m=["Object","Request","Session","Status"],_=[{},{},{},{}],S={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},E=0,A=Object.keys(o);E<A.length;E++){var O=A[E];_[null!=S[O]?S[O]:1][O]=o[O]}for(var H=0;H<_.length;H++){var K=CMCDController.serialize(_[H]);K&&(s["CMCD-"+m[H]]=K)}return s},CMCDController.toQuery=function toQuery(o){return"CMCD="+encodeURIComponent(CMCDController.serialize(o))},CMCDController.appendQueryToUri=function appendQueryToUri(o,s){if(!s)return o;var m=o.includes("?")?"&":"?";return""+o+m+s},CMCDController}()},"./src/controller/eme-controller.ts":
/*!******************************************!*\
    !*** ./src/controller/eme-controller.ts ***!
    \******************************************/function srcControllerEmeControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return me}});var _=m(/*! ../events */"./src/events.ts"),S=m(/*! ../errors */"./src/errors.ts"),E=m(/*! ../utils/logger */"./src/utils/logger.ts"),A=m(/*! ../utils/mediakeys-helper */"./src/utils/mediakeys-helper.ts"),O=m(/*! ../utils/keysystem-util */"./src/utils/keysystem-util.ts"),H=m(/*! ../utils/numeric-encoding-utils */"./src/utils/numeric-encoding-utils.ts"),K=m(/*! ../loader/level-key */"./src/loader/level-key.ts"),z=m(/*! ../utils/hex */"./src/utils/hex.ts"),G=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),q=m(/*! eventemitter3 */"./node_modules/eventemitter3/index.js"),X=m.n(q);function _wrapNativeSuper(o){var s="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(o){if(null===o||!function _isNativeFunction(o){return-1!==Function.toString.call(o).indexOf("[native code]")}(o))return o;if("function"!=typeof o)throw new TypeError("Super expression must either be null or a function");if(void 0!==s){if(s.has(o))return s.get(o);s.set(o,Wrapper)}function Wrapper(){return _construct(o,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(o.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,o)},_wrapNativeSuper(o)}function _construct(o,s,m){return _construct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(o){return!1}}()?Reflect.construct.bind():function _construct(o,s,m){var _=[null];_.push.apply(_,s);var S=new(Function.bind.apply(o,_));return m&&_setPrototypeOf(S,m.prototype),S},_construct.apply(null,arguments)}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var J="[eme]",ae=function(){function EMEController(o){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=EMEController.CDMCleanupPromise?[EMEController.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=E.logger.debug.bind(E.logger,J),this.log=E.logger.log.bind(E.logger,J),this.warn=E.logger.warn.bind(E.logger,J),this.error=E.logger.error.bind(E.logger,J),this.hls=o,this.config=o.config,this.registerListeners()}var o=EMEController.prototype;return o.destroy=function destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null},o.registerListeners=function registerListeners(){this.hls.on(_.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(_.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(_.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},o.unregisterListeners=function unregisterListeners(){this.hls.off(_.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(_.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(_.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},o.getLicenseServerUrl=function getLicenseServerUrl(o){var s=this.config,m=s.drmSystems,_=s.widevineLicenseUrl,S=m[o];if(S)return S.licenseUrl;if(o===A.KeySystems.WIDEVINE&&_)return _;throw new Error('no license server URL configured for key-system "'+o+'"')},o.getServerCertificateUrl=function getServerCertificateUrl(o){var s=this.config.drmSystems[o];if(s)return s.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+o+'"]')},o.attemptKeySystemAccess=function attemptKeySystemAccess(o){var s=this,m=this.hls.levels,_=function uniqueCodec(o,s,m){return!!o&&m.indexOf(o)===s},E=m.map((function(o){return o.audioCodec})).filter(_),A=m.map((function(o){return o.videoCodec})).filter(_);return E.length+A.length===0&&A.push("avc1.42e01e"),new Promise((function(m,_){!function attempt(o){var O=o.shift();s.getMediaKeysPromise(O,E,A).then((function(o){return m({keySystem:O,mediaKeys:o})})).catch((function(s){o.length?attempt(o):_(s instanceof pe?s:new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:s,fatal:!0},s.message))}))}(o)}))},o.requestMediaKeySystemAccess=function requestMediaKeySystemAccess(o,s){var m=this.config.requestMediaKeySystemAccessFunc;if("function"!=typeof m){var _="Configured requestMediaKeySystemAccess is not a function "+m;return null===A.requestMediaKeySystemAccess&&"http:"===self.location.protocol&&(_="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(_))}return m(o,s)},o.getMediaKeysPromise=function getMediaKeysPromise(o,s,m){var _=this,S=(0,A.getSupportedMediaKeySystemConfigurations)(o,s,m,this.config.drmSystemOptions),E=this.keySystemAccessPromises[o],O=null==E?void 0:E.keySystemAccess;if(!O){this.log('Requesting encrypted media "'+o+'" key-system access with config: '+JSON.stringify(S)),O=this.requestMediaKeySystemAccess(o,S);var H=this.keySystemAccessPromises[o]={keySystemAccess:O};return O.catch((function(s){_.log('Failed to obtain access to key-system "'+o+'": '+s)})),O.then((function(s){_.log('Access for key-system "'+s.keySystem+'" obtained');var m=_.fetchServerCertificate(o);return _.log('Create media-keys for "'+o+'"'),H.mediaKeys=s.createMediaKeys().then((function(s){return _.log('Media-keys created for "'+o+'"'),m.then((function(m){return m?_.setMediaKeysServerCertificate(s,o,m):s}))})),H.mediaKeys.catch((function(s){_.error('Failed to create media-keys for "'+o+'"}: '+s)})),H.mediaKeys}))}return O.then((function(){return E.mediaKeys}))},o.createMediaKeySessionContext=function createMediaKeySessionContext(o){var s=o.decryptdata,m=o.keySystem,_=o.mediaKeys;console.assert(!!_,"mediaKeys is defined"),this.log('Creating key-system session "'+m+'" keyId: '+z.default.hexDump(s.keyId||[]));var S=_.createSession(),E={decryptdata:s,keySystem:m,mediaKeys:_,mediaKeysSession:S,keyStatus:"status-pending"};return this.mediaKeySessions.push(E),E},o.renewKeySession=function renewKeySession(o){var s=o.decryptdata;if(s.pssh){var m=this.createMediaKeySessionContext(o),_=this.getKeyIdString(s);this.keyIdToKeySessionPromise[_]=this.generateRequestWithPreferredKeySession(m,"cenc",s.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(o)},o.getKeyIdString=function getKeyIdString(o){if(!o)throw new Error("Could not read keyId of undefined decryptdata");if(null===o.keyId)throw new Error("keyId is null");return z.default.hexDump(o.keyId)},o.updateKeySession=function updateKeySession(o,s){var m,_=o.mediaKeysSession;return this.log('Updating key-session "'+_.sessionId+'" for keyID '+z.default.hexDump((null===(m=o.decryptdata)||void 0===m?void 0:m.keyId)||[])+"\n      } (data length: "+(s?s.byteLength:s)+")"),_.update(s)},o.selectKeySystemFormat=function selectKeySystemFormat(o){var s=Object.keys(o.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+o.sn+" "+o.type+": "+o.level+") key formats "+s.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(s)),this.keyFormatPromise},o.getKeyFormatPromise=function getKeyFormatPromise(o){var s=this;return new Promise((function(m,_){var S=(0,A.getKeySystemsForConfig)(s.config),E=o.map(A.keySystemFormatToKeySystemDomain).filter((function(o){return!!o&&-1!==S.indexOf(o)}));return s.getKeySystemSelectionPromise(E).then((function(o){var s=o.keySystem,S=(0,A.keySystemDomainToKeySystemFormat)(s);S?m(S):_(new Error('Unable to find format for key-system "'+s+'"'))})).catch(_)}))},o.loadKey=function loadKey(o){var s=this,m=o.keyInfo.decryptdata,_=this.getKeyIdString(m),S="(keyId: "+_+' format: "'+m.keyFormat+'" method: '+m.method+" uri: "+m.uri+")";this.log("Starting session for key "+S);var E=this.keyIdToKeySessionPromise[_];return E||(E=this.keyIdToKeySessionPromise[_]=this.getKeySystemForKeyPromise(m).then((function(_){var E=_.keySystem,A=_.mediaKeys;return s.throwIfDestroyed(),s.log("Handle encrypted media sn: "+o.frag.sn+" "+o.frag.type+": "+o.frag.level+" using key "+S),s.attemptSetMediaKeys(E,A).then((function(){s.throwIfDestroyed();var o=s.createMediaKeySessionContext({keySystem:E,mediaKeys:A,decryptdata:m});return s.generateRequestWithPreferredKeySession(o,"cenc",m.pssh,"playlist-key")}))}))).catch((function(o){return s.handleError(o)})),E},o.throwIfDestroyed=function throwIfDestroyed(o){if(!this.hls)throw new Error("invalid state")},o.handleError=function handleError(o){this.hls&&(this.error(o.message),o instanceof pe?this.hls.trigger(_.Events.ERROR,o.data):this.hls.trigger(_.Events.ERROR,{type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_KEYS,error:o,fatal:!0}))},o.getKeySystemForKeyPromise=function getKeySystemForKeyPromise(o){var s=this.getKeyIdString(o),m=this.keyIdToKeySessionPromise[s];if(!m){var _=(0,A.keySystemFormatToKeySystemDomain)(o.keyFormat),S=_?[_]:(0,A.getKeySystemsForConfig)(this.config);return this.attemptKeySystemAccess(S)}return m},o.getKeySystemSelectionPromise=function getKeySystemSelectionPromise(o){if(o.length||(o=(0,A.getKeySystemsForConfig)(this.config)),0===o.length)throw new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(o)},o._onMediaEncrypted=function _onMediaEncrypted(o){var s=this,m=o.initDataType,_=o.initData;if(this.debug('"'+o.type+'" event: init data type: "'+m+'"'),null!==_){var S,E;if("sinf"===m&&this.config.drmSystems[A.KeySystems.FAIRPLAY]){var O=(0,G.bin2str)(new Uint8Array(_));try{var q=(0,H.base64Decode)(JSON.parse(O).sinf),X=(0,G.parseSinf)(new Uint8Array(q));if(!X)return;S=X.subarray(8,24),E=A.KeySystems.FAIRPLAY}catch(o){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{var J=(0,G.parsePssh)(_);if(null===J)return;0===J.version&&J.systemId===A.KeySystemIds.WIDEVINE&&J.data&&(S=J.data.subarray(8,24)),E=(0,A.keySystemIdToKeySystemDomain)(J.systemId)}if(E&&S){for(var ae=z.default.hexDump(S),pe=this.keyIdToKeySessionPromise,me=this.mediaKeySessions,_e=pe[ae],Se=function _loop(o){var E=me[o],A=E.decryptdata;if(A.pssh||!A.keyId)return"continue";var O=z.default.hexDump(A.keyId);return ae===O||-1!==A.uri.replace(/-/g,"").indexOf(ae)?(_e=pe[O],delete pe[O],A.pssh=new Uint8Array(_),A.keyId=S,_e=pe[ae]=_e.then((function(){return s.generateRequestWithPreferredKeySession(E,m,_,"encrypted-event-key-match")})),"break"):void 0},Ee=0;Ee<me.length;Ee++){var De=Se(Ee);if("continue"!==De&&"break"===De)break}_e||(_e=pe[ae]=this.getKeySystemSelectionPromise([E]).then((function(o){var E,O=o.keySystem,H=o.mediaKeys;s.throwIfDestroyed();var z=new K.LevelKey("ISO-23001-7",ae,null!=(E=(0,A.keySystemDomainToKeySystemFormat)(O))?E:"");return z.pssh=new Uint8Array(_),z.keyId=S,s.attemptSetMediaKeys(O,H).then((function(){s.throwIfDestroyed();var o=s.createMediaKeySessionContext({decryptdata:z,keySystem:O,mediaKeys:H});return s.generateRequestWithPreferredKeySession(o,m,_,"encrypted-event-no-match")}))}))),_e.catch((function(o){return s.handleError(o)}))}}},o._onWaitingForKey=function _onWaitingForKey(o){this.log('"'+o.type+'" event')},o.attemptSetMediaKeys=function attemptSetMediaKeys(o,s){var m=this,_=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+o+'"');var S=Promise.all(_).then((function(){if(!m.media)throw new Error("Attempted to set mediaKeys without media element attached");return m.media.setMediaKeys(s)}));return this.setMediaKeysQueue.push(S),S.then((function(){m.log('Media-keys set for "'+o+'"'),_.push(S),m.setMediaKeysQueue=m.setMediaKeysQueue.filter((function(o){return-1===_.indexOf(o)}))}))},o.generateRequestWithPreferredKeySession=function generateRequestWithPreferredKeySession(o,s,m,_){var E,H,K=this,z=null===(E=this.config.drmSystems)||void 0===E||null===(H=E[o.keySystem])||void 0===H?void 0:H.generateRequest;if(z)try{var G=z.call(this.hls,s,m,o);if(!G)throw new Error("Invalid response from configured generateRequest filter");s=G.initDataType,m=o.decryptdata.pssh=G.initData?new Uint8Array(G.initData):null}catch(o){var q;if(this.warn(o.message),null!==(q=this.hls)&&void 0!==q&&q.config.debug)throw o}if(null===m)return this.log('Skipping key-session request for "'+_+'" (no initData)'),Promise.resolve(o);var J=this.getKeyIdString(o.decryptdata);this.log('Generating key-session request for "'+_+'": '+J+" (init data type: "+s+" length: "+(m?m.byteLength:null)+")");var ae=new(X());o.mediaKeysSession.onmessage=function(s){var m=o.mediaKeysSession;if(m){var _=s.messageType,S=s.message;K.log('"'+_+'" message event for session "'+m.sessionId+'" message size: '+S.byteLength),"license-request"===_||"license-renewal"===_?K.renewLicense(o,S).catch((function(o){K.handleError(o),ae.emit("error",o)})):"license-release"===_?o.keySystem===A.KeySystems.FAIRPLAY&&(K.updateKeySession(o,(0,O.strToUtf8array)("acknowledged")),K.removeSession(o)):K.warn('unhandled media key message type "'+_+'"')}else ae.emit("error",new Error("invalid state"))},o.mediaKeysSession.onkeystatuseschange=function(s){if(o.mediaKeysSession){K.onKeyStatusChange(o);var m=o.keyStatus;ae.emit("keyStatus",m),"expired"===m&&(K.warn(o.keySystem+" expired for key "+J),K.renewKeySession(o))}else ae.emit("error",new Error("invalid state"))};var me=new Promise((function(o,s){ae.on("error",s),ae.on("keyStatus",(function(m){m.startsWith("usable")?o():"output-restricted"===m?s(new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===m?s(new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+m+'"')):"expired"===m?s(new Error("key expired while generating request")):K.warn('unhandled key status change "'+m+'"')}))}));return o.mediaKeysSession.generateRequest(s,m).then((function(){var s;K.log('Request generated for key-session "'+(null===(s=o.mediaKeysSession)||void 0===s?void 0:s.sessionId)+'" keyId: '+J)})).catch((function(o){throw new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_NO_SESSION,error:o,fatal:!1},"Error generating key-session request: "+o)})).then((function(){return me})).catch((function(s){throw ae.removeAllListeners(),K.removeSession(o),s})).then((function(){return ae.removeAllListeners(),o}))},o.onKeyStatusChange=function onKeyStatusChange(o){var s=this;o.mediaKeysSession.keyStatuses.forEach((function(m,_){s.log('key status change "'+m+'" for keyStatuses keyId: '+z.default.hexDump("buffer"in _?new Uint8Array(_.buffer,_.byteOffset,_.byteLength):new Uint8Array(_))+" session keyId: "+z.default.hexDump(new Uint8Array(o.decryptdata.keyId||[]))+" uri: "+o.decryptdata.uri),o.keyStatus=m}))},o.fetchServerCertificate=function fetchServerCertificate(o){var s=this;return new Promise((function(m,_){var E=s.getServerCertificateUrl(o);if(!E)return m();s.log('Fetching serverCertificate for "'+o+'"');var A=new XMLHttpRequest;A.open("GET",E,!0),A.responseType="arraybuffer",A.onreadystatechange=function(){A.readyState===XMLHttpRequest.DONE&&(200===A.status?m(A.response):_(new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:A},'"'+o+'" certificate request XHR failed ('+E+"). Status: "+A.status+" ("+A.statusText+")")))},A.send()}))},o.setMediaKeysServerCertificate=function setMediaKeysServerCertificate(o,s,m){var _=this;return new Promise((function(E,A){o.setServerCertificate(m).then((function(S){_.log("setServerCertificate "+(S?"success":"not supported by CDM")+" ("+(null==m?void 0:m.byteLength)+') on "'+s+'"'),E(o)})).catch((function(o){A(new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))}))}))},o.renewLicense=function renewLicense(o,s){var m=this;return this.requestLicense(o,new Uint8Array(s)).then((function(s){return m.updateKeySession(o,new Uint8Array(s)).catch((function(o){throw new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:o,fatal:!0},o.message)}))}))},o.setupLicenseXHR=function setupLicenseXHR(o,s,m,_){var S=this,E=this.config.licenseXhrSetup;return E?Promise.resolve().then((function(){if(!m.decryptdata)throw new Error("Key removed");return E.call(S.hls,o,s,m,_)})).catch((function(A){if(!m.decryptdata)throw A;return o.open("POST",s,!0),E.call(S.hls,o,s,m,_)})).then((function(m){return o.readyState||o.open("POST",s,!0),{xhr:o,licenseChallenge:m||_}})):(o.open("POST",s,!0),Promise.resolve({xhr:o,licenseChallenge:_}))},o.requestLicense=function requestLicense(o,s){var m=this;return new Promise((function(_,E){var A=m.getLicenseServerUrl(o.keySystem);m.log("Sending license request to URL: "+A);var O=new XMLHttpRequest;O.responseType="arraybuffer",O.onreadystatechange=function(){if(!m.hls||!o.mediaKeysSession)return E(new Error("invalid state"));if(4===O.readyState)if(200===O.status){m._requestLicenseFailureCount=0;var H=O.response;m.log("License received "+(H instanceof ArrayBuffer?H.byteLength:H));var K=m.config.licenseResponseCallback;if(K)try{H=K.call(m.hls,O,A,o)}catch(o){m.error(o)}_(H)}else if(m._requestLicenseFailureCount++,m._requestLicenseFailureCount>3||O.status>=400&&O.status<500)E(new pe({type:S.ErrorTypes.KEY_SYSTEM_ERROR,details:S.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:O},"License Request XHR failed ("+A+"). Status: "+O.status+" ("+O.statusText+")"));else{var z=3-m._requestLicenseFailureCount+1;m.warn("Retrying license request, "+z+" attempts left"),m.requestLicense(o,s).then(_,E)}},o.licenseXhr&&o.licenseXhr.readyState!==XMLHttpRequest.DONE&&o.licenseXhr.abort(),o.licenseXhr=O,m.setupLicenseXHR(O,A,o,s).then((function(o){var s=o.xhr,m=o.licenseChallenge;s.send(m)}))}))},o.onMediaAttached=function onMediaAttached(o,s){if(this.config.emeEnabled){var m=s.media;this.media=m,m.addEventListener("encrypted",this.onMediaEncrypted),m.addEventListener("waitingforkey",this.onWaitingForKey)}},o.onMediaDetached=function onMediaDetached(){var o=this,s=this.media,m=this.mediaKeySessions;s&&(s.removeEventListener("encrypted",this.onMediaEncrypted),s.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},K.LevelKey.clearKeyUriToKeyIdMap();var _=m.length;EMEController.CDMCleanupPromise=Promise.all(m.map((function(s){return o.removeSession(s)})).concat(null==s?void 0:s.setMediaKeys(null).catch((function(m){o.log("Could not clear media keys: "+m+". media.src: "+(null==s?void 0:s.src))})))).then((function(){_&&(o.log("finished closing key sessions and clearing media keys"),m.length=0)})).catch((function(m){o.log("Could not close sessions and clear media keys: "+m+". media.src: "+(null==s?void 0:s.src))}))},o.onManifestLoaded=function onManifestLoaded(o,s){var m=s.sessionKeys;if(m&&this.config.emeEnabled&&!this.keyFormatPromise){var _=m.reduce((function(o,s){return-1===o.indexOf(s.keyFormat)&&o.push(s.keyFormat),o}),[]);this.log("Selecting key-system from session-keys "+_.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(_)}},o.removeSession=function removeSession(o){var s=this,m=o.mediaKeysSession,_=o.licenseXhr;if(m){this.log("Remove licenses and keys and close session "+m.sessionId),m.onmessage=null,m.onkeystatuseschange=null,_&&_.readyState!==XMLHttpRequest.DONE&&_.abort(),o.mediaKeysSession=o.decryptdata=o.licenseXhr=void 0;var S=this.mediaKeySessions.indexOf(o);return S>-1&&this.mediaKeySessions.splice(S,1),m.remove().catch((function(o){s.log("Could not remove session: "+o)})).then((function(){return m.close()})).catch((function(o){s.log("Could not close session: "+o)}))}},EMEController}();ae.CDMCleanupPromise=void 0;var pe=function(o){function EMEKeyError(s,m){var _;return(_=o.call(this,m)||this).data=void 0,_.data=s,s.err=s.error,_}return function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(EMEKeyError,o),EMEKeyError}(_wrapNativeSuper(Error)),me=ae},"./src/controller/fps-controller.ts":
/*!******************************************!*\
    !*** ./src/controller/fps-controller.ts ***!
    \******************************************/function srcControllerFpsControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return A}});var _=m(/*! ../events */"./src/events.ts"),S=m(/*! ../utils/logger */"./src/utils/logger.ts"),E=function(){function FPSController(o){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=o,this.registerListeners()}var o=FPSController.prototype;return o.setStreamController=function setStreamController(o){this.streamController=o},o.registerListeners=function registerListeners(){this.hls.on(_.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},o.unregisterListeners=function unregisterListeners(){this.hls.off(_.Events.MEDIA_ATTACHING,this.onMediaAttaching)},o.destroy=function destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},o.onMediaAttaching=function onMediaAttaching(o,s){var m=this.hls.config;if(m.capLevelOnFPSDrop){var _=s.media instanceof self.HTMLVideoElement?s.media:null;this.media=_,_&&"function"==typeof _.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),m.fpsDroppedMonitoringPeriod)}},o.checkFPS=function checkFPS(o,s,m){var E=performance.now();if(s){if(this.lastTime){var A=E-this.lastTime,O=m-this.lastDroppedFrames,H=s-this.lastDecodedFrames,K=1e3*O/A,z=this.hls;if(z.trigger(_.Events.FPS_DROP,{currentDropped:O,currentDecoded:H,totalDroppedFrames:m}),K>0&&O>z.config.fpsDroppedMonitoringThreshold*H){var G=z.currentLevel;S.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+G),G>0&&(-1===z.autoLevelCapping||z.autoLevelCapping>=G)&&(G-=1,z.trigger(_.Events.FPS_DROP_LEVEL_CAPPING,{level:G,droppedLevel:z.currentLevel}),z.autoLevelCapping=G,this.streamController.nextLevelSwitch())}}this.lastTime=E,this.lastDroppedFrames=m,this.lastDecodedFrames=s}},o.checkFPSInterval=function checkFPSInterval(){var o=this.media;if(o)if(this.isVideoPlaybackQualityAvailable){var s=o.getVideoPlaybackQuality();this.checkFPS(o,s.totalVideoFrames,s.droppedVideoFrames)}else this.checkFPS(o,o.webkitDecodedFrameCount,o.webkitDroppedFrameCount)},FPSController}(),A=E},"./src/controller/fragment-finders.ts":
/*!********************************************!*\
    !*** ./src/controller/fragment-finders.ts ***!
    \********************************************/function srcControllerFragmentFindersTs(o,s,m){m.r(s),m.d(s,{findFragWithCC:function findFragWithCC(){return _findFragWithCC},findFragmentByPDT:function findFragmentByPDT(){return _findFragmentByPDT},findFragmentByPTS:function findFragmentByPTS(){return _findFragmentByPTS},fragmentWithinToleranceTest:function fragmentWithinToleranceTest(){return _fragmentWithinToleranceTest},pdtWithinToleranceTest:function pdtWithinToleranceTest(){return _pdtWithinToleranceTest}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../utils/binary-search */"./src/utils/binary-search.ts");function _findFragmentByPDT(o,s,m){if(null===s||!Array.isArray(o)||!o.length||!(0,_.isFiniteNumber)(s))return null;if(s<(o[0].programDateTime||0))return null;if(s>=(o[o.length-1].endProgramDateTime||0))return null;m=m||0;for(var S=0;S<o.length;++S){var E=o[S];if(_pdtWithinToleranceTest(s,m,E))return E}return null}function _findFragmentByPTS(o,s,m,_){void 0===m&&(m=0),void 0===_&&(_=0);var E=null;if(o?E=s[o.sn-s[0].sn+1]||null:0===m&&0===s[0].start&&(E=s[0]),E&&0===_fragmentWithinToleranceTest(m,_,E))return E;var A=S.default.search(s,_fragmentWithinToleranceTest.bind(null,m,_));return!A||A===o&&E?E:A}function _fragmentWithinToleranceTest(o,s,m){if(void 0===o&&(o=0),void 0===s&&(s=0),m.start<=o&&m.start+m.duration>o)return 0;var _=Math.min(s,m.duration+(m.deltaPTS?m.deltaPTS:0));return m.start+m.duration-_<=o?1:m.start-_>o&&m.start?-1:0}function _pdtWithinToleranceTest(o,s,m){var _=1e3*Math.min(s,m.duration+(m.deltaPTS?m.deltaPTS:0));return(m.endProgramDateTime||0)-_>o}function _findFragWithCC(o,s){return S.default.search(o,(function(o){return o.cc<s?1:o.cc>s?-1:0}))}},"./src/controller/fragment-tracker.ts":
/*!********************************************!*\
    !*** ./src/controller/fragment-tracker.ts ***!
    \********************************************/function srcControllerFragmentTrackerTs(o,s,m){m.r(s),m.d(s,{FragmentState:function FragmentState(){return _},FragmentTracker:function FragmentTracker(){return O}});var _,S,E=m(/*! ../events */"./src/events.ts"),A=m(/*! ../types/loader */"./src/types/loader.ts");(S=_||(_={})).NOT_LOADED="NOT_LOADED",S.APPENDING="APPENDING",S.PARTIAL="PARTIAL",S.OK="OK";var O=function(){function FragmentTracker(o){this.activeFragment=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=o,this._registerListeners()}var o=FragmentTracker.prototype;return o._registerListeners=function _registerListeners(){var o=this.hls;o.on(E.Events.BUFFER_APPENDED,this.onBufferAppended,this),o.on(E.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.on(E.Events.FRAG_LOADED,this.onFragLoaded,this)},o._unregisterListeners=function _unregisterListeners(){var o=this.hls;o.off(E.Events.BUFFER_APPENDED,this.onBufferAppended,this),o.off(E.Events.FRAG_BUFFERED,this.onFragBuffered,this),o.off(E.Events.FRAG_LOADED,this.onFragLoaded,this)},o.destroy=function destroy(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.activeFragment=this.activeParts=null},o.getAppendedFrag=function getAppendedFrag(o,s){if(s===A.PlaylistLevelType.MAIN){var m=this.activeFragment,_=this.activeParts;if(!m)return null;if(_)for(var S=_.length;S--;){var E=_[S],O=E?E.end:m.appendedPTS;if(E.start<=o&&void 0!==O&&o<=O)return S>9&&(this.activeParts=_.slice(S-9)),E}else if(m.start<=o&&void 0!==m.appendedPTS&&o<=m.appendedPTS)return m}return this.getBufferedFrag(o,s)},o.getBufferedFrag=function getBufferedFrag(o,s){for(var m=this.fragments,_=Object.keys(m),S=_.length;S--;){var E=m[_[S]];if((null==E?void 0:E.body.type)===s&&E.buffered){var A=E.body;if(A.start<=o&&o<=A.end)return A}}return null},o.detectEvictedFragments=function detectEvictedFragments(o,s,m){var _=this;this.timeRanges&&(this.timeRanges[o]=s),Object.keys(this.fragments).forEach((function(S){var E=_.fragments[S];if(E)if(E.buffered||E.loaded){var A=E.range[o];A&&A.time.some((function(o){var m=!_.isTimeBuffered(o.startPTS,o.endPTS,s);return m&&_.removeFragment(E.body),m}))}else E.body.type===m&&_.removeFragment(E.body)}))},o.detectPartialFragments=function detectPartialFragments(o){var s=this,m=this.timeRanges,_=o.frag,S=o.part;if(m&&"initSegment"!==_.sn){var E=getFragmentKey(_),A=this.fragments[E];A&&(Object.keys(m).forEach((function(o){var E=_.elementaryStreams[o];if(E){var O=m[o],H=null!==S||!0===E.partial;A.range[o]=s.getBufferedTimes(_,S,H,O)}})),A.loaded=null,Object.keys(A.range).length?(A.buffered=!0,A.body.endList&&(this.endListFragments[A.body.type]=A)):this.removeFragment(A.body))}},o.fragBuffered=function fragBuffered(o){var s=getFragmentKey(o),m=this.fragments[s];m&&(m.loaded=null,m.buffered=!0)},o.getBufferedTimes=function getBufferedTimes(o,s,m,_){for(var S={time:[],partial:m},E=s?s.start:o.start,A=s?s.end:o.end,O=o.minEndPTS||A,H=o.maxStartPTS||E,K=0;K<_.length;K++){var z=_.start(K)-this.bufferPadding,G=_.end(K)+this.bufferPadding;if(H>=z&&O<=G){S.time.push({startPTS:Math.max(E,_.start(K)),endPTS:Math.min(A,_.end(K))});break}if(E<G&&A>z)S.partial=!0,S.time.push({startPTS:Math.max(E,_.start(K)),endPTS:Math.min(A,_.end(K))});else if(A<=z)break}return S},o.getPartialFragment=function getPartialFragment(o){var s,m,_,S=null,E=0,A=this.bufferPadding,O=this.fragments;return Object.keys(O).forEach((function(H){var K=O[H];K&&isPartial(K)&&(m=K.body.start-A,_=K.body.end+A,o>=m&&o<=_&&(s=Math.min(o-m,_-o),E<=s&&(S=K.body,E=s)))})),S},o.isEndListAppended=function isEndListAppended(o){var s=this.endListFragments[o];return void 0!==s&&(s.buffered||isPartial(s))},o.getState=function getState(o){var s=getFragmentKey(o),m=this.fragments[s];return m?m.buffered?isPartial(m)?_.PARTIAL:_.OK:_.APPENDING:_.NOT_LOADED},o.isTimeBuffered=function isTimeBuffered(o,s,m){for(var _,S,E=0;E<m.length;E++){if(_=m.start(E)-this.bufferPadding,S=m.end(E)+this.bufferPadding,o>=_&&s<=S)return!0;if(s<=_)return!1}return!1},o.onFragLoaded=function onFragLoaded(o,s){var m=s.frag,_=s.part;if("initSegment"!==m.sn&&!m.bitrateTest&&!_){var S=getFragmentKey(m);this.fragments[S]={body:m,loaded:s,buffered:!1,range:Object.create(null)}}},o.onBufferAppended=function onBufferAppended(o,s){var m=this,_=s.frag,S=s.part,E=s.timeRanges;if(_.type===A.PlaylistLevelType.MAIN)if(this.activeFragment!==_&&(this.activeFragment=_,_.appendedPTS=void 0),S){var O=this.activeParts;O||(this.activeParts=O=[]),O.push(S)}else this.activeParts=null;this.timeRanges=E,Object.keys(E).forEach((function(o){var s=E[o];if(m.detectEvictedFragments(o,s),!S&&_.type===A.PlaylistLevelType.MAIN){var O=_.elementaryStreams[o];if(!O)return;for(var H=0;H<s.length;H++){var K=s.end(H);K<=O.endPTS&&K>O.startPTS?_.appendedPTS=Math.max(K,_.appendedPTS||0):_.appendedPTS=O.endPTS}}}))},o.onFragBuffered=function onFragBuffered(o,s){this.detectPartialFragments(s)},o.hasFragment=function hasFragment(o){var s=getFragmentKey(o);return!!this.fragments[s]},o.removeFragmentsInRange=function removeFragmentsInRange(o,s,m){var _=this;Object.keys(this.fragments).forEach((function(S){var E=_.fragments[S];if(E&&E.buffered){var A=E.body;A.type===m&&A.start<s&&A.end>o&&_.removeFragment(A)}}))},o.removeFragment=function removeFragment(o){var s=getFragmentKey(o);o.stats.loaded=0,o.clearElementaryStreamInfo(),o.appendedPTS=void 0,delete this.fragments[s],o.endList&&delete this.endListFragments[o.type]},o.removeAllFragments=function removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activeFragment=null,this.activeParts=null},FragmentTracker}();function isPartial(o){var s,m;return o.buffered&&((null===(s=o.range.video)||void 0===s?void 0:s.partial)||(null===(m=o.range.audio)||void 0===m?void 0:m.partial))}function getFragmentKey(o){return o.type+"_"+o.level+"_"+o.urlId+"_"+o.sn}},"./src/controller/gap-controller.ts":
/*!******************************************!*\
    !*** ./src/controller/gap-controller.ts ***!
    \******************************************/function srcControllerGapControllerTs(o,s,m){m.r(s),m.d(s,{MAX_START_GAP_JUMP:function MAX_START_GAP_JUMP(){return H},SKIP_BUFFER_HOLE_STEP_SECONDS:function SKIP_BUFFER_HOLE_STEP_SECONDS(){return K},SKIP_BUFFER_RANGE_START:function SKIP_BUFFER_RANGE_START(){return z},STALL_MINIMUM_DURATION_MS:function STALL_MINIMUM_DURATION_MS(){return O},default:function _default(){return G}});var _=m(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),S=m(/*! ../errors */"./src/errors.ts"),E=m(/*! ../events */"./src/events.ts"),A=m(/*! ../utils/logger */"./src/utils/logger.ts"),O=250,H=2,K=.1,z=.05,G=function(){function GapController(o,s,m,_){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=o,this.media=s,this.fragmentTracker=m,this.hls=_}var o=GapController.prototype;return o.destroy=function destroy(){this.media=null,this.hls=this.fragmentTracker=null},o.poll=function poll(o,s){var m=this.config,S=this.media,E=this.stalled;if(null!==S){var K=S.currentTime,z=S.seeking,G=this.seeking&&!z,q=!this.seeking&&z;if(this.seeking=z,K===o){if((q||G)&&(this.stalled=null),!(S.paused&&!z||S.ended||0===S.playbackRate)&&_.BufferHelper.getBuffered(S).length){var X=_.BufferHelper.bufferInfo(S,K,0),J=X.len>0,ae=X.nextStart||0;if(J||ae){if(z){var pe=X.len>H,me=!ae||s&&s.start<=K||ae-K>H&&!this.fragmentTracker.getPartialFragment(K);if(pe||me)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var _e,Se=Math.max(ae,X.start||0)-K,Ee=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,De=(null==Ee||null===(_e=Ee.details)||void 0===_e?void 0:_e.live)?2*Ee.details.targetduration:H;if(Se>0&&Se<=De)return void this._trySkipBufferHole(null)}var $e=self.performance.now();if(null!==E){var He=$e-E;if(z||!(He>=O)||(this._reportStall(X),this.media)){var et=_.BufferHelper.bufferInfo(S,K,m.maxBufferHole);this._tryFixBufferStall(et,He)}}else this.stalled=$e}}}else if(this.moved=!0,null!==E){if(this.stallReported){var rt=self.performance.now()-E;A.logger.warn("playback not stuck anymore @"+K+", after "+Math.round(rt)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}}},o._tryFixBufferStall=function _tryFixBufferStall(o,s){var m=this.config,_=this.fragmentTracker,S=this.media;if(null!==S){var E=S.currentTime,O=_.getPartialFragment(E);if(O)if(this._trySkipBufferHole(O)||!this.media)return;o.len>m.maxBufferHole&&s>1e3*m.highBufferWatchdogPeriod&&(A.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},o._reportStall=function _reportStall(o){var s=this.hls,m=this.media;!this.stallReported&&m&&(this.stallReported=!0,A.logger.warn("Playback stalling at @"+m.currentTime+" due to low buffer ("+JSON.stringify(o)+")"),s.trigger(E.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:o.len}))},o._trySkipBufferHole=function _trySkipBufferHole(o){var s=this.config,m=this.hls,O=this.media;if(null===O)return 0;for(var H=O.currentTime,G=0,q=_.BufferHelper.getBuffered(O),X=0;X<q.length;X++){var J=q.start(X);if(H+s.maxBufferHole>=G&&H<J){var ae=Math.max(J+z,O.currentTime+K);return A.logger.warn("skipping hole, adjusting currentTime from "+H+" to "+ae),this.moved=!0,this.stalled=null,O.currentTime=ae,o&&m.trigger(E.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+H+" to "+ae,frag:o}),ae}G=q.end(X)}return 0},o._tryNudgeBuffer=function _tryNudgeBuffer(){var o=this.config,s=this.hls,m=this.media,_=this.nudgeRetry;if(null!==m){var O=m.currentTime;if(this.nudgeRetry++,_<o.nudgeMaxRetry){var H=O+(_+1)*o.nudgeOffset;A.logger.warn("Nudging 'currentTime' from "+O+" to "+H),m.currentTime=H,s.trigger(E.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else A.logger.error("Playhead still not moving while enough data buffered @"+O+" after "+o.nudgeMaxRetry+" nudges"),s.trigger(E.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},GapController}()},"./src/controller/id3-track-controller.ts":
/*!************************************************!*\
    !*** ./src/controller/id3-track-controller.ts ***!
    \************************************************/function srcControllerId3TrackControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return G}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../utils/texttrack-utils */"./src/utils/texttrack-utils.ts"),A=m(/*! ../demux/id3 */"./src/demux/id3.ts"),O=m(/*! ../loader/date-range */"./src/loader/date-range.ts"),H=m(/*! ../types/demuxer */"./src/types/demuxer.ts");function getCueClass(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var K=function(){var o=getCueClass();try{new o(0,Number.POSITIVE_INFINITY,"")}catch(o){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function dateRangeDateToTimelineSeconds(o,s){return o.getTime()/1e3-s}var z=function(){function ID3TrackController(o){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=o,this._registerListeners()}var o=ID3TrackController.prototype;return o.destroy=function destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},o._registerListeners=function _registerListeners(){var o=this.hls;o.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),o.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},o._unregisterListeners=function _unregisterListeners(){var o=this.hls;o.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),o.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},o.onMediaAttached=function onMediaAttached(o,s){this.media=s.media},o.onMediaDetaching=function onMediaDetaching(){this.id3Track&&((0,E.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},o.onManifestLoading=function onManifestLoading(){this.dateRangeCuesAppended={}},o.createTrack=function createTrack(o){var s=this.getID3Track(o.textTracks);return s.mode="hidden",s},o.getID3Track=function getID3Track(o){if(this.media){for(var s=0;s<o.length;s++){var m=o[s];if("metadata"===m.kind&&"id3"===m.label)return(0,E.sendAddTrackEvent)(m,this.media),m}return this.media.addTextTrack("metadata","id3")}},o.onFragParsingMetadata=function onFragParsingMetadata(o,s){if(this.media){var m=this.hls.config,_=m.enableEmsgMetadataCues,S=m.enableID3MetadataCues;if(_||S){var E=s.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var O=getCueClass(),z=0;z<E.length;z++){var G=E[z].type;if((G!==H.MetadataSchema.emsg||_)&&S){var q=A.getID3Frames(E[z].data);if(q){var X=E[z].pts,J=X+E[z].duration;J>K&&(J=K),J-X<=0&&(J=X+.25);for(var ae=0;ae<q.length;ae++){var pe=q[ae];if(!A.isTimeStampFrame(pe)){this.updateId3CueEnds(X);var me=new O(X,J,"");me.value=pe,G&&(me.type=G),this.id3Track.addCue(me)}}}}}}}},o.updateId3CueEnds=function updateId3CueEnds(o){var s,m=null===(s=this.id3Track)||void 0===s?void 0:s.cues;if(m)for(var _=m.length;_--;){var S=m[_];S.startTime<o&&S.endTime===K&&(S.endTime=o)}},o.onBufferFlushing=function onBufferFlushing(o,s){var m=s.startOffset,_=s.endOffset,S=s.type,A=this.id3Track,O=this.hls;if(O){var K,z=O.config,G=z.enableEmsgMetadataCues,q=z.enableID3MetadataCues;if(A&&(G||q))K="audio"===S?function predicate(o){return o.type===H.MetadataSchema.audioId3&&q}:"video"===S?function predicate(o){return o.type===H.MetadataSchema.emsg&&G}:function predicate(o){return o.type===H.MetadataSchema.audioId3&&q||o.type===H.MetadataSchema.emsg&&G},(0,E.removeCuesInRange)(A,m,_,K)}},o.onLevelUpdated=function onLevelUpdated(o,s){var m=this,S=s.details;if(this.media&&S.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var E=this.dateRangeCuesAppended,A=this.id3Track,z=S.dateRanges,G=Object.keys(z);if(A)for(var q=Object.keys(E).filter((function(o){return!G.includes(o)})),X=function _loop(o){var s=q[o];Object.keys(E[s].cues).forEach((function(o){A.removeCue(E[s].cues[o])})),delete E[s]},J=q.length;J--;)X(J);var ae=S.fragments[S.fragments.length-1];if(0!==G.length&&(0,_.isFiniteNumber)(null==ae?void 0:ae.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var pe=ae.programDateTime/1e3-ae.start,me=getCueClass(),_e=function _loop2(o){var s=G[o],_=z[s],S=E[s],A=(null==S?void 0:S.cues)||{},q=(null==S?void 0:S.durationKnown)||!1,X=dateRangeDateToTimelineSeconds(_.startDate,pe),J=K,ae=_.endDate;if(ae)J=dateRangeDateToTimelineSeconds(ae,pe),q=!0;else if(_.endOnNext&&!q){var _e=G.reduce((function(o,s){var m=z[s];return m.class===_.class&&m.id!==s&&m.startDate>_.startDate&&o.push(m),o}),[]).sort((function(o,s){return o.startDate.getTime()-s.startDate.getTime()}))[0];_e&&(J=dateRangeDateToTimelineSeconds(_e.startDate,pe),q=!0)}for(var Se,Ee=Object.keys(_.attr),De=0;De<Ee.length;De++){var $e=Ee[De];if($e!==O.DateRangeAttribute.ID&&$e!==O.DateRangeAttribute.CLASS&&$e!==O.DateRangeAttribute.START_DATE&&$e!==O.DateRangeAttribute.DURATION&&$e!==O.DateRangeAttribute.END_DATE&&$e!==O.DateRangeAttribute.END_ON_NEXT){var He=A[$e];if(He)q&&!S.durationKnown&&(He.endTime=J);else{var et=_.attr[$e];He=new me(X,J,""),$e!==O.DateRangeAttribute.SCTE35_OUT&&$e!==O.DateRangeAttribute.SCTE35_IN||(Se=et,et=Uint8Array.from(Se.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),He.value={key:$e,data:et},He.type=H.MetadataSchema.dateRange,m.id3Track.addCue(He),A[$e]=He}}}E[s]={cues:A,dateRange:_,durationKnown:q}},Se=0;Se<G.length;Se++)_e(Se)}}},ID3TrackController}(),G=z},"./src/controller/latency-controller.ts":
/*!**********************************************!*\
    !*** ./src/controller/latency-controller.ts ***!
    \**********************************************/function srcControllerLatencyControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return A}});var _=m(/*! ../errors */"./src/errors.ts"),S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../utils/logger */"./src/utils/logger.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}var A=function(){function LatencyController(o){var s=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return s.timeupdate()},this.hls=o,this.config=o.config,this.registerListeners()}var o=LatencyController.prototype;return o.destroy=function destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},o.registerListeners=function registerListeners(){this.hls.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(S.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(S.Events.ERROR,this.onError,this)},o.unregisterListeners=function unregisterListeners(){this.hls.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(S.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(S.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(S.Events.ERROR,this.onError)},o.onMediaAttached=function onMediaAttached(o,s){this.media=s.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},o.onMediaDetaching=function onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},o.onManifestLoading=function onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0},o.onLevelUpdated=function onLevelUpdated(o,s){var m=s.details;this.levelDetails=m,m.advanced&&this.timeupdate(),!m.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},o.onError=function onError(o,s){s.details===_.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,E.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},o.timeupdate=function timeupdate(){var o=this.media,s=this.levelDetails;if(o&&s){this.currentTime=o.currentTime;var m=this.computeLatency();if(null!==m){this._latency=m;var _=this.config,S=_.lowLatencyMode,E=_.maxLiveSyncPlaybackRate;if(S&&1!==E){var A=this.targetLatency;if(null!==A){var O=m-A,H=O<Math.min(this.maxLatency,A+s.targetduration);if(s.live&&H&&O>.05&&this.forwardBufferLength>1){var K=Math.min(2,Math.max(1,E)),z=Math.round(2/(1+Math.exp(-.75*O-this.edgeStalled))*20)/20;o.playbackRate=Math.min(K,Math.max(1,z))}else 1!==o.playbackRate&&0!==o.playbackRate&&(o.playbackRate=1)}}}}},o.estimateLiveEdge=function estimateLiveEdge(){var o=this.levelDetails;return null===o?null:o.edge+o.age},o.computeLatency=function computeLatency(){var o=this.estimateLiveEdge();return null===o?null:o-this.currentTime},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(LatencyController,[{key:"latency",get:function get(){return this._latency||0}},{key:"maxLatency",get:function get(){var o=this.config,s=this.levelDetails;return void 0!==o.liveMaxLatencyDuration?o.liveMaxLatencyDuration:s?o.liveMaxLatencyDurationCount*s.targetduration:0}},{key:"targetLatency",get:function get(){var o=this.levelDetails;if(null===o)return null;var s=o.holdBack,m=o.partHoldBack,_=o.targetduration,S=this.config,E=S.liveSyncDuration,A=S.liveSyncDurationCount,O=S.lowLatencyMode,H=this.hls.userConfig,K=O&&m||s;(H.liveSyncDuration||H.liveSyncDurationCount||0===K)&&(K=void 0!==E?E:A*_);var z=_;return K+Math.min(1*this.stallCount,z)}},{key:"liveSyncPosition",get:function get(){var o=this.estimateLiveEdge(),s=this.targetLatency,m=this.levelDetails;if(null===o||null===s||null===m)return null;var _=m.edge,S=o-s-this.edgeStalled,E=_-m.totalduration,A=_-(this.config.lowLatencyMode&&m.partTarget||m.targetduration);return Math.min(Math.max(E,S),A)}},{key:"drift",get:function get(){var o=this.levelDetails;return null===o?1:o.drift}},{key:"edgeStalled",get:function get(){var o=this.levelDetails;if(null===o)return 0;var s=3*(this.config.lowLatencyMode&&o.partTarget||o.targetduration);return Math.max(o.age-s,0)}},{key:"forwardBufferLength",get:function get(){var o=this.media,s=this.levelDetails;if(!o||!s)return 0;var m=o.buffered.length;return(m?o.buffered.end(m-1):s.edge)-this.currentTime}}]),LatencyController}()},"./src/controller/level-controller.ts":
/*!********************************************!*\
    !*** ./src/controller/level-controller.ts ***!
    \********************************************/function srcControllerLevelControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return G}});var _=m(/*! ../types/level */"./src/types/level.ts"),S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../errors */"./src/errors.ts"),A=m(/*! ../utils/codecs */"./src/utils/codecs.ts"),O=m(/*! ./level-helper */"./src/controller/level-helper.ts"),H=m(/*! ./base-playlist-controller */"./src/controller/base-playlist-controller.ts"),K=m(/*! ../types/loader */"./src/types/loader.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var z=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),G=function(o){function LevelController(s){var m;return(m=o.call(this,s,"[level-controller]")||this)._levels=[],m._firstLevel=-1,m._startLevel=void 0,m.currentLevelIndex=-1,m.manualLevelIndex=-1,m.onParsedComplete=void 0,m._registerListeners(),m}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(LevelController,o);var s=LevelController.prototype;return s._registerListeners=function _registerListeners(){var o=this.hls;o.on(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(S.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(S.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(S.Events.ERROR,this.onError,this)},s._unregisterListeners=function _unregisterListeners(){var o=this.hls;o.off(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(S.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(S.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(S.Events.ERROR,this.onError,this)},s.destroy=function destroy(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,o.prototype.destroy.call(this)},s.startLoad=function startLoad(){this._levels.forEach((function(o){o.loadError=0})),o.prototype.startLoad.call(this)},s.onManifestLoaded=function onManifestLoaded(o,s){var m,H,K=[],G=[],q=[],X={},J=!1,ae=!1,pe=!1;if(s.levels.forEach((function(o){var s=o.attrs;J=J||!(!o.width||!o.height),ae=ae||!!o.videoCodec,pe=pe||!!o.audioCodec,z&&o.audioCodec&&-1!==o.audioCodec.indexOf("mp4a.40.34")&&(o.audioCodec=void 0);var m=o.bitrate+"-"+o.attrs.RESOLUTION+"-"+o.attrs.CODECS;(H=X[m])?H.url.push(o.url):(H=new _.Level(o),X[m]=H,K.push(H)),s&&(s.AUDIO&&(0,O.addGroupId)(H,"audio",s.AUDIO),s.SUBTITLES&&(0,O.addGroupId)(H,"text",s.SUBTITLES))})),(J||ae)&&pe&&(K=K.filter((function(o){var s=o.videoCodec,m=o.width,_=o.height;return!!s||!(!m||!_)}))),K=K.filter((function(o){var s=o.audioCodec,m=o.videoCodec;return(!s||(0,A.isCodecSupportedInMp4)(s,"audio"))&&(!m||(0,A.isCodecSupportedInMp4)(m,"video"))})),s.audioTracks&&(G=s.audioTracks.filter((function(o){return!o.audioCodec||(0,A.isCodecSupportedInMp4)(o.audioCodec,"audio")})),(0,O.assignTrackIdsByGroup)(G)),s.subtitles&&(q=s.subtitles,(0,O.assignTrackIdsByGroup)(q)),K.length>0){m=K[0].bitrate,K.sort((function(o,s){return o.attrs["HDCP-LEVEL"]!==s.attrs["HDCP-LEVEL"]?(o.attrs["HDCP-LEVEL"]||"")>(s.attrs["HDCP-LEVEL"]||"")?1:-1:o.bitrate!==s.bitrate?o.bitrate-s.bitrate:o.attrs.SCORE!==s.attrs.SCORE?o.attrs.decimalFloatingPoint("SCORE")-s.attrs.decimalFloatingPoint("SCORE"):J&&o.height!==s.height?o.height-s.height:0})),this._levels=K;for(var me=0;me<K.length;me++)if(K[me].bitrate===m){this._firstLevel=me,this.log("manifest loaded, "+K.length+" level(s) found, first bitrate: "+m);break}var _e=pe&&!ae,Se={levels:K,audioTracks:G,subtitleTracks:q,sessionData:s.sessionData,sessionKeys:s.sessionKeys,firstLevel:this._firstLevel,stats:s.stats,audio:pe,video:ae,altAudio:!_e&&G.some((function(o){return!!o.url}))};this.hls.trigger(S.Events.MANIFEST_PARSED,Se),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(S.Events.ERROR,{type:E.ErrorTypes.MEDIA_ERROR,details:E.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,reason:"no level with compatible codecs found in manifest"})},s.onError=function onError(s,m){var S,A;if(o.prototype.onError.call(this,s,m),!m.fatal){var O=m.context,H=this._levels[this.currentLevelIndex];if(O&&(O.type===K.PlaylistContextType.AUDIO_TRACK&&H.audioGroupIds&&O.groupId===H.audioGroupIds[H.urlId]||O.type===K.PlaylistContextType.SUBTITLE_TRACK&&H.textGroupIds&&O.groupId===H.textGroupIds[H.urlId]))this.redundantFailover(this.currentLevelIndex);else{var z,G=!1,q=!0;switch(m.details){case E.ErrorDetails.FRAG_LOAD_ERROR:case E.ErrorDetails.FRAG_LOAD_TIMEOUT:case E.ErrorDetails.KEY_LOAD_ERROR:case E.ErrorDetails.KEY_LOAD_TIMEOUT:if(m.frag){var X=m.frag.type===K.PlaylistLevelType.MAIN?m.frag.level:this.currentLevelIndex,J=this._levels[X];J?(J.fragmentError++,J.fragmentError>this.hls.config.fragLoadingMaxRetry&&(z=X)):z=X}break;case E.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var ae=H.attrs["HDCP-LEVEL"];ae&&(this.hls.maxHdcpLevel=_.HdcpLevels[_.HdcpLevels.indexOf(ae)-1],this.warn('Restricting playback to HDCP-LEVEL of "'+this.hls.maxHdcpLevel+'" or lower'));case E.ErrorDetails.FRAG_PARSING_ERROR:case E.ErrorDetails.KEY_SYSTEM_NO_SESSION:z=(null===(S=m.frag)||void 0===S?void 0:S.type)===K.PlaylistLevelType.MAIN?m.frag.level:this.currentLevelIndex,m.levelRetry=!1;break;case E.ErrorDetails.LEVEL_LOAD_ERROR:case E.ErrorDetails.LEVEL_LOAD_TIMEOUT:O&&(O.deliveryDirectives&&(q=!1),z=O.level),G=!0;break;case E.ErrorDetails.REMUX_ALLOC_ERROR:z=null!=(A=m.level)?A:this.currentLevelIndex,G=!0}void 0!==z&&this.recoverLevel(m,z,G,q)}}},s.recoverLevel=function recoverLevel(o,s,m,_){var S=o.details,E=this._levels[s];if(E.loadError++,m){if(!this.retryLoadingOrFail(o))return void(this.currentLevelIndex=-1);o.levelRetry=!0}if(_){var A=E.url.length;if(A>1&&E.loadError<A)o.levelRetry=!0,this.redundantFailover(s);else if(-1===this.manualLevelIndex){for(var O=-1,H=this._levels,K=H.length;K--;){var z=(K+this.currentLevelIndex)%H.length;if(z!==this.currentLevelIndex&&0===H[z].loadError){O=z;break}}O>-1&&this.currentLevelIndex!==O?(this.warn(S+": switch to "+O),o.levelRetry=!0,this.hls.nextAutoLevel=O):!1===o.levelRetry&&(o.fatal=!0)}}},s.redundantFailover=function redundantFailover(o){var s=this._levels[o],m=s.url.length;if(m>1){var _=(s.urlId+1)%m;this.warn("Switching to redundant URL-id "+_),this._levels.forEach((function(o){o.urlId=_})),this.level=o}},s.onFragLoaded=function onFragLoaded(o,s){var m=s.frag;if(void 0!==m&&m.type===K.PlaylistLevelType.MAIN){var _=this._levels[m.level];void 0!==_&&(_.fragmentError=0,_.loadError=0)}},s.onLevelLoaded=function onLevelLoaded(o,s){var m,_,S=s.level,E=s.details,A=this._levels[S];if(!A)return this.warn("Invalid level index "+S),void(null!==(_=s.deliveryDirectives)&&void 0!==_&&_.skip&&(E.deltaUpdateFailed=!0));S===this.currentLevelIndex?(0===A.fragmentError&&(A.loadError=0,this.retryCount=0),this.playlistLoaded(S,s,A.details)):null!==(m=s.deliveryDirectives)&&void 0!==m&&m.skip&&(E.deltaUpdateFailed=!0)},s.onAudioTrackSwitched=function onAudioTrackSwitched(o,s){var m=this.hls.levels[this.currentLevelIndex];if(m&&m.audioGroupIds){for(var _=-1,S=this.hls.audioTracks[s.id].groupId,E=0;E<m.audioGroupIds.length;E++)if(m.audioGroupIds[E]===S){_=E;break}_!==m.urlId&&(m.urlId=_,this.startLoad())}},s.loadPlaylist=function loadPlaylist(s){o.prototype.loadPlaylist.call(this);var m=this.currentLevelIndex,_=this._levels[m];if(this.canLoad&&_&&_.url.length>0){var E=_.urlId,A=_.url[E];if(s)try{A=s.addDirectives(A)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("Attempt loading level index "+m+(void 0!==(null==s?void 0:s.msn)?" at sn "+s.msn+" part "+s.part:"")+" with URL-id "+E+" "+A),this.clearTimer(),this.hls.trigger(S.Events.LEVEL_LOADING,{url:A,level:m,id:E,deliveryDirectives:s||null})}},s.removeLevel=function removeLevel(o,s){var m=function filterLevelAndGroupByIdIndex(o,m){return m!==s},_=this._levels.filter((function(_,S){return S!==o||_.url.length>1&&void 0!==s&&(_.url=_.url.filter(m),_.audioGroupIds&&(_.audioGroupIds=_.audioGroupIds.filter(m)),_.textGroupIds&&(_.textGroupIds=_.textGroupIds.filter(m)),_.urlId=0,!0)})).map((function(o,s){var m=o.details;return null!=m&&m.fragments&&m.fragments.forEach((function(o){o.level=s})),o}));this._levels=_,this.hls.trigger(S.Events.LEVELS_UPDATED,{levels:_})},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(LevelController,[{key:"levels",get:function get(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function get(){return this.currentLevelIndex},set:function set(o){var s,m=this._levels;if(0!==m.length&&(this.currentLevelIndex!==o||null===(s=m[o])||void 0===s||!s.details)){if(o<0||o>=m.length){var _=o<0;if(this.hls.trigger(S.Events.ERROR,{type:E.ErrorTypes.OTHER_ERROR,details:E.ErrorDetails.LEVEL_SWITCH_ERROR,level:o,fatal:_,reason:"invalid level idx"}),_)return;o=Math.min(o,m.length-1)}this.clearTimer();var A=this.currentLevelIndex,O=m[A],H=m[o];this.log("switching to level "+o+" from "+A),this.currentLevelIndex=o;var K=_extends({},H,{level:o,maxBitrate:H.maxBitrate,uri:H.uri,urlId:H.urlId});delete K._urlId,this.hls.trigger(S.Events.LEVEL_SWITCHING,K);var z=H.details;if(!z||z.live){var G=this.switchParams(H.uri,null==O?void 0:O.details);this.loadPlaylist(G)}}}},{key:"manualLevel",get:function get(){return this.manualLevelIndex},set:function set(o){this.manualLevelIndex=o,void 0===this._startLevel&&(this._startLevel=o),-1!==o&&(this.level=o)}},{key:"firstLevel",get:function get(){return this._firstLevel},set:function set(o){this._firstLevel=o}},{key:"startLevel",get:function get(){if(void 0===this._startLevel){var o=this.hls.config.startLevel;return void 0!==o?o:this._firstLevel}return this._startLevel},set:function set(o){this._startLevel=o}},{key:"nextLoadLevel",get:function get(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function set(o){this.level=o,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=o)}}]),LevelController}(H.default)},"./src/controller/level-helper.ts":
/*!****************************************!*\
    !*** ./src/controller/level-helper.ts ***!
    \****************************************/function srcControllerLevelHelperTs(o,s,m){m.r(s),m.d(s,{addGroupId:function addGroupId(){return _addGroupId},addSliding:function addSliding(){return _addSliding},adjustSliding:function adjustSliding(){return _adjustSliding},assignTrackIdsByGroup:function assignTrackIdsByGroup(){return _assignTrackIdsByGroup},computeReloadInterval:function computeReloadInterval(){return _computeReloadInterval},getFragmentWithSN:function getFragmentWithSN(){return _getFragmentWithSN},getPartWith:function getPartWith(){return _getPartWith},mapFragmentIntersection:function mapFragmentIntersection(){return _mapFragmentIntersection},mapPartIntersection:function mapPartIntersection(){return _mapPartIntersection},mergeDetails:function mergeDetails(){return _mergeDetails},updateFragPTSDTS:function updateFragPTSDTS(){return _updateFragPTSDTS},updatePTS:function updatePTS(){return _updatePTS}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../utils/logger */"./src/utils/logger.ts"),E=m(/*! ../loader/date-range */"./src/loader/date-range.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}function _addGroupId(o,s,m){switch(s){case"audio":o.audioGroupIds||(o.audioGroupIds=[]),o.audioGroupIds.push(m);break;case"text":o.textGroupIds||(o.textGroupIds=[]),o.textGroupIds.push(m)}}function _assignTrackIdsByGroup(o){var s={};o.forEach((function(o){var m=o.groupId||"";o.id=s[m]=s[m]||0,s[m]++}))}function _updatePTS(o,s,m){updateFromToPTS(o[s],o[m])}function updateFromToPTS(o,s){var m=s.startPTS;if((0,_.isFiniteNumber)(m)){var S,E=0;s.sn>o.sn?(E=m-o.start,S=o):(E=o.start-m,S=s),S.duration!==E&&(S.duration=E)}else if(s.sn>o.sn){o.cc===s.cc&&o.minEndPTS?s.start=o.start+(o.minEndPTS-o.start):s.start=o.start+o.duration}else s.start=Math.max(o.start-s.duration,0)}function _updateFragPTSDTS(o,s,m,E,A,O){E-m<=0&&(S.logger.warn("Fragment should have a positive duration",s),E=m+s.duration,O=A+s.duration);var H=m,K=E,z=s.startPTS,G=s.endPTS;if((0,_.isFiniteNumber)(z)){var q=Math.abs(z-m);(0,_.isFiniteNumber)(s.deltaPTS)?s.deltaPTS=Math.max(q,s.deltaPTS):s.deltaPTS=q,H=Math.max(m,z),m=Math.min(m,z),A=Math.min(A,s.startDTS),K=Math.min(E,G),E=Math.max(E,G),O=Math.max(O,s.endDTS)}s.duration=E-m;var X=m-s.start;s.start=s.startPTS=m,s.maxStartPTS=H,s.startDTS=A,s.endPTS=E,s.minEndPTS=K,s.endDTS=O;var J,ae=s.sn;if(!o||ae<o.startSN||ae>o.endSN)return 0;var pe=ae-o.startSN,me=o.fragments;for(me[pe]=s,J=pe;J>0;J--)updateFromToPTS(me[J],me[J-1]);for(J=pe;J<me.length-1;J++)updateFromToPTS(me[J],me[J+1]);return o.fragmentHint&&updateFromToPTS(me[me.length-1],o.fragmentHint),o.PTSKnown=o.alignedSliding=!0,X}function _mergeDetails(o,s){for(var m=null,A=o.fragments,O=A.length-1;O>=0;O--){var H=A[O].initSegment;if(H){m=H;break}}o.fragmentHint&&delete o.fragmentHint.endPTS;var K,z=0;(_mapFragmentIntersection(o,s,(function(o,S){o.relurl&&(z=o.cc-S.cc),(0,_.isFiniteNumber)(o.startPTS)&&(0,_.isFiniteNumber)(o.endPTS)&&(S.start=S.startPTS=o.startPTS,S.startDTS=o.startDTS,S.appendedPTS=o.appendedPTS,S.maxStartPTS=o.maxStartPTS,S.endPTS=o.endPTS,S.endDTS=o.endDTS,S.minEndPTS=o.minEndPTS,S.duration=o.endPTS-o.startPTS,S.duration&&(K=S),s.PTSKnown=s.alignedSliding=!0),S.elementaryStreams=o.elementaryStreams,S.loader=o.loader,S.stats=o.stats,S.urlId=o.urlId,o.initSegment&&(S.initSegment=o.initSegment,m=o.initSegment)})),m)&&(s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments).forEach((function(o){var s;o.initSegment&&o.initSegment.relurl!==(null===(s=m)||void 0===s?void 0:s.relurl)||(o.initSegment=m)}));if(s.skippedSegments)if(s.deltaUpdateFailed=s.fragments.some((function(o){return!o})),s.deltaUpdateFailed){S.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var G=s.skippedSegments;G--;)s.fragments.shift();s.startSN=s.fragments[0].sn,s.startCC=s.fragments[0].cc}else s.canSkipDateRanges&&(s.dateRanges=function mergeDateRanges(o,s,m){var _=_extends({},o);m&&m.forEach((function(o){delete _[o]}));return Object.keys(s).forEach((function(o){var m=new E.DateRange(s[o].attr,_[o]);m.isValid?_[o]=m:S.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(s[o].attr)+'"')})),_}(o.dateRanges,s.dateRanges,s.recentlyRemovedDateranges));var q=s.fragments;if(z){S.logger.warn("discontinuity sliding from playlist, take drift into account");for(var X=0;X<q.length;X++)q[X].cc+=z}s.skippedSegments&&(s.startCC=s.fragments[0].cc),_mapPartIntersection(o.partList,s.partList,(function(o,s){s.elementaryStreams=o.elementaryStreams,s.stats=o.stats})),K?_updateFragPTSDTS(s,K,K.startPTS,K.endPTS,K.startDTS,K.endDTS):_adjustSliding(o,s),q.length&&(s.totalduration=s.edge-q[0].start),s.driftStartTime=o.driftStartTime,s.driftStart=o.driftStart;var J=s.advancedDateTime;if(s.advanced&&J){var ae=s.edge;s.driftStart||(s.driftStartTime=J,s.driftStart=ae),s.driftEndTime=J,s.driftEnd=ae}else s.driftEndTime=o.driftEndTime,s.driftEnd=o.driftEnd,s.advancedDateTime=o.advancedDateTime}function _mapPartIntersection(o,s,m){if(o&&s)for(var _=0,S=0,E=o.length;S<=E;S++){var A=o[S],O=s[S+_];A&&O&&A.index===O.index&&A.fragment.sn===O.fragment.sn?m(A,O):_--}}function _mapFragmentIntersection(o,s,m){for(var _=s.skippedSegments,S=Math.max(o.startSN,s.startSN)-s.startSN,E=(o.fragmentHint?1:0)+(_?s.endSN:Math.min(o.endSN,s.endSN))-s.startSN,A=s.startSN-o.startSN,O=s.fragmentHint?s.fragments.concat(s.fragmentHint):s.fragments,H=o.fragmentHint?o.fragments.concat(o.fragmentHint):o.fragments,K=S;K<=E;K++){var z=H[A+K],G=O[K];_&&!G&&K<_&&(G=s.fragments[K]=z),z&&G&&m(z,G)}}function _adjustSliding(o,s){var m=s.startSN+s.skippedSegments-o.startSN,_=o.fragments;m<0||m>=_.length||_addSliding(s,_[m].start)}function _addSliding(o,s){if(s){for(var m=o.fragments,_=o.skippedSegments;_<m.length;_++)m[_].start+=s;o.fragmentHint&&(o.fragmentHint.start+=s)}}function _computeReloadInterval(o,s){void 0===s&&(s=1/0);var m=1e3*o.targetduration;if(o.updated){var _=o.fragments;if(_.length&&4*m>s){var S=1e3*_[_.length-1].duration;S<m&&(m=S)}}else m/=2;return Math.round(m)}function _getFragmentWithSN(o,s,m){if(!o||!o.details)return null;var _=o.details,S=_.fragments[s-_.startSN];return S||((S=_.fragmentHint)&&S.sn===s?S:s<_.startSN&&m&&m.sn===s?m:null)}function _getPartWith(o,s,m){if(!o||!o.details)return null;var _=o.details.partList;if(_)for(var S=_.length;S--;){var E=_[S];if(E.index===m&&E.fragment.sn===s)return E}return null}},"./src/controller/stream-controller.ts":
/*!*********************************************!*\
    !*** ./src/controller/stream-controller.ts ***!
    \*********************************************/function srcControllerStreamControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return ae}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ./base-stream-controller */"./src/controller/base-stream-controller.ts"),E=m(/*! ../is-supported */"./src/is-supported.ts"),A=m(/*! ../events */"./src/events.ts"),O=m(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),H=m(/*! ./fragment-tracker */"./src/controller/fragment-tracker.ts"),K=m(/*! ../types/loader */"./src/types/loader.ts"),z=m(/*! ../loader/fragment */"./src/loader/fragment.ts"),G=m(/*! ../demux/transmuxer-interface */"./src/demux/transmuxer-interface.ts"),q=m(/*! ../types/transmuxer */"./src/types/transmuxer.ts"),X=m(/*! ./gap-controller */"./src/controller/gap-controller.ts"),J=m(/*! ../errors */"./src/errors.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var ae=function(o){function StreamController(s,m,_){var S;return(S=o.call(this,s,m,_,"[stream-controller]")||this).audioCodecSwap=!1,S.gapController=null,S.level=-1,S._forceStartLoad=!1,S.altAudio=!1,S.audioOnly=!1,S.fragPlaying=null,S.onvplaying=null,S.onvseeked=null,S.fragLastKbps=0,S.couldBacktrack=!1,S.backtrackFragment=null,S.audioCodecSwitch=!1,S.videoBuffer=null,S._registerListeners(),S}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(StreamController,o);var s=StreamController.prototype;return s._registerListeners=function _registerListeners(){var o=this.hls;o.on(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(A.Events.LEVEL_LOADING,this.onLevelLoading,this),o.on(A.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(A.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),o.on(A.Events.ERROR,this.onError,this),o.on(A.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.on(A.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(A.Events.BUFFER_CREATED,this.onBufferCreated,this),o.on(A.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.on(A.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),o.on(A.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function _unregisterListeners(){var o=this.hls;o.off(A.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(A.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(A.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(A.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(A.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(A.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),o.off(A.Events.ERROR,this.onError,this),o.off(A.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.off(A.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(A.Events.BUFFER_CREATED,this.onBufferCreated,this),o.off(A.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.off(A.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),o.off(A.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.onHandlerDestroying=function onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()},s.startLoad=function startLoad(o){if(this.levels){var s=this.lastCurrentTime,m=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var _=m.startLevel;-1===_&&(m.config.testBandwidth&&this.levels.length>1?(_=0,this.bitrateTest=!0):_=m.nextAutoLevel),this.level=m.nextLoadLevel=_,this.loadedmetadata=!1}s>0&&-1===o&&(this.log("Override startPosition with lastCurrentTime @"+s.toFixed(3)),o=s),this.state=S.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=o,this.tick()}else this._forceStartLoad=!0,this.state=S.State.STOPPED},s.stopLoad=function stopLoad(){this._forceStartLoad=!1,o.prototype.stopLoad.call(this)},s.doTick=function doTick(){switch(this.state){case S.State.IDLE:this.doTickIdle();break;case S.State.WAITING_LEVEL:var o,s=this.levels,m=this.level,_=null==s||null===(o=s[m])||void 0===o?void 0:o.details;if(_&&(!_.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(_))break;this.state=S.State.IDLE;break}break;case S.State.FRAG_LOADING_WAITING_RETRY:var E,A=self.performance.now(),O=this.retryDate;(!O||A>=O||null!==(E=this.media)&&void 0!==E&&E.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=S.State.IDLE)}this.onTickEnd()},s.onTickEnd=function onTickEnd(){o.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},s.doTickIdle=function doTickIdle(){var o=this.hls,s=this.levelLastLoaded,m=this.levels,_=this.media,E=o.config,O=o.nextLoadLevel;if(null!==s&&(_||!this.startFragRequested&&E.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&m&&m[O]){var G=m[O],q=this.getMainFwdBufferInfo();if(null!==q){var X=this.getLevelDetails();if(X&&this._streamEnded(q,X)){var J={};return this.altAudio&&(J.type="video"),this.hls.trigger(A.Events.BUFFER_EOS,J),void(this.state=S.State.ENDED)}this.level=o.nextLoadLevel=O;var ae=G.details;if(!ae||this.state===S.State.WAITING_LEVEL||ae.live&&this.levelLastLoaded!==O)return this.level=O,void(this.state=S.State.WAITING_LEVEL);if(!(q.len>=this.getMaxBufferLength(G.maxBitrate))){this.backtrackFragment&&this.backtrackFragment.start>q.end&&(this.backtrackFragment=null);var pe=this.backtrackFragment?this.backtrackFragment.start:q.end,me=this.getNextFragment(pe,ae);if(this.couldBacktrack&&!this.fragPrevious&&me&&"initSegment"!==me.sn&&this.fragmentTracker.getState(me)!==H.FragmentState.OK){var _e,Se=(null!=(_e=this.backtrackFragment)?_e:me).sn-ae.startSN,Ee=ae.fragments[Se-1];Ee&&me.cc===Ee.cc&&(me=Ee,this.fragmentTracker.removeFragment(Ee))}else this.backtrackFragment&&q.len&&(this.backtrackFragment=null);if(me&&this.fragmentTracker.getState(me)===H.FragmentState.OK&&this.nextLoadPosition>pe){var De=this.audioOnly&&!this.altAudio?z.ElementaryStreamTypes.AUDIO:z.ElementaryStreamTypes.VIDEO,$e=(De===z.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;$e&&this.afterBufferFlushed($e,De,K.PlaylistLevelType.MAIN),me=this.getNextFragment(this.nextLoadPosition,ae)}me&&(!me.initSegment||me.initSegment.data||this.bitrateTest||(me=me.initSegment),this.loadFragment(me,ae,pe))}}}},s.loadFragment=function loadFragment(s,m,_){var S,E=this.fragmentTracker.getState(s);this.fragCurrent=s,E===H.FragmentState.NOT_LOADED?"initSegment"===s.sn?this._loadInitSegment(s,m):this.bitrateTest?(this.log("Fragment "+s.sn+" of level "+s.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(s,m)):(this.startFragRequested=!0,o.prototype.loadFragment.call(this,s,m,_)):E===H.FragmentState.APPENDING?this.reduceMaxBufferLength(s.duration)&&this.fragmentTracker.removeFragment(s):0===(null===(S=this.media)||void 0===S?void 0:S.buffered.length)&&this.fragmentTracker.removeAllFragments()},s.getAppendedFrag=function getAppendedFrag(o){var s=this.fragmentTracker.getAppendedFrag(o,K.PlaylistLevelType.MAIN);return s&&"fragment"in s?s.fragment:s},s.getBufferedFrag=function getBufferedFrag(o){return this.fragmentTracker.getBufferedFrag(o,K.PlaylistLevelType.MAIN)},s.followingBufferedFrag=function followingBufferedFrag(o){return o?this.getBufferedFrag(o.end+.5):null},s.immediateLevelSwitch=function immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},s.nextLevelSwitch=function nextLevelSwitch(){var o=this.levels,s=this.media;if(null!=s&&s.readyState){var m,_=this.getAppendedFrag(s.currentTime);if(_&&_.start>1&&this.flushMainBuffer(0,_.start-1),!s.paused&&o){var S=o[this.hls.nextLoadLevel],E=this.fragLastKbps;m=E&&this.fragCurrent?this.fragCurrent.duration*S.maxBitrate/(1e3*E)+1:0}else m=0;var A=this.getBufferedFrag(s.currentTime+m);if(A){var O=this.followingBufferedFrag(A);if(O){this.abortCurrentFrag();var H=O.maxStartPTS?O.maxStartPTS:O.start,K=O.duration,z=Math.max(A.end,H+Math.min(Math.max(K-this.config.maxFragLookUpTolerance,.5*K),.75*K));this.flushMainBuffer(z,Number.POSITIVE_INFINITY)}}}},s.abortCurrentFrag=function abortCurrentFrag(){var o=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,o&&o.abortRequests(),this.state){case S.State.KEY_LOADING:case S.State.FRAG_LOADING:case S.State.FRAG_LOADING_WAITING_RETRY:case S.State.PARSING:case S.State.PARSED:this.state=S.State.IDLE}this.nextLoadPosition=this.getLoadPosition()},s.flushMainBuffer=function flushMainBuffer(s,m){o.prototype.flushMainBuffer.call(this,s,m,this.altAudio?"video":null)},s.onMediaAttached=function onMediaAttached(s,m){o.prototype.onMediaAttached.call(this,s,m);var _=m.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),_.addEventListener("playing",this.onvplaying),_.addEventListener("seeked",this.onvseeked),this.gapController=new X.default(this.config,_,this.fragmentTracker,this.hls)},s.onMediaDetaching=function onMediaDetaching(){var s=this.media;s&&this.onvplaying&&this.onvseeked&&(s.removeEventListener("playing",this.onvplaying),s.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),o.prototype.onMediaDetaching.call(this)},s.onMediaPlaying=function onMediaPlaying(){this.tick()},s.onMediaSeeked=function onMediaSeeked(){var o=this.media,s=o?o.currentTime:null;(0,_.isFiniteNumber)(s)&&this.log("Media seeked to "+s.toFixed(3)),this.tick()},s.onManifestLoading=function onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(A.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},s.onManifestParsed=function onManifestParsed(o,s){var m,_=!1,S=!1;s.levels.forEach((function(o){(m=o.audioCodec)&&(-1!==m.indexOf("mp4a.40.2")&&(_=!0),-1!==m.indexOf("mp4a.40.5")&&(S=!0))})),this.audioCodecSwitch=_&&S&&!(0,E.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=s.levels,this.startFragRequested=!1},s.onLevelLoading=function onLevelLoading(o,s){var m=this.levels;if(m&&this.state===S.State.IDLE){var _=m[s.level];(!_.details||_.details.live&&this.levelLastLoaded!==s.level||this.waitForCdnTuneIn(_.details))&&(this.state=S.State.WAITING_LEVEL)}},s.onLevelLoaded=function onLevelLoaded(o,s){var m,_=this.levels,E=s.level,O=s.details,H=O.totalduration;if(_){this.log("Level "+E+" loaded ["+O.startSN+","+O.endSN+"], cc ["+O.startCC+", "+O.endCC+"] duration:"+H);var K=this.fragCurrent;!K||this.state!==S.State.FRAG_LOADING&&this.state!==S.State.FRAG_LOADING_WAITING_RETRY||K.level!==s.level&&K.loader&&(this.state=S.State.IDLE,this.backtrackFragment=null,K.abortRequests());var z=_[E],G=0;if(O.live||null!==(m=z.details)&&void 0!==m&&m.live){if(O.fragments[0]||(O.deltaUpdateFailed=!0),O.deltaUpdateFailed)return;G=this.alignPlaylists(O,z.details)}if(z.details=O,this.levelLastLoaded=E,this.hls.trigger(A.Events.LEVEL_UPDATED,{details:O,level:E}),this.state===S.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(O))return;this.state=S.State.IDLE}this.startFragRequested?O.live&&this.synchronizeToLiveEdge(O):this.setStartPosition(O,G),this.tick()}else this.warn("Levels were reset while loading level "+E)},s._handleFragmentLoadProgress=function _handleFragmentLoadProgress(o){var s,m=o.frag,_=o.part,S=o.payload,E=this.levels;if(E){var A=E[m.level],O=A.details;if(O){var H=A.videoCodec,z=O.PTSKnown||!O.live,X=null===(s=m.initSegment)||void 0===s?void 0:s.data,J=this._getAudioCodec(A),ae=this.transmuxer=this.transmuxer||new G.default(this.hls,K.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),pe=_?_.index:-1,me=-1!==pe,_e=new q.ChunkMetadata(m.level,m.sn,m.stats.chunkCount,S.byteLength,pe,me),Se=this.initPTS[m.cc];ae.push(S,X,J,H,m,_,O.totalduration,z,_e,Se)}else this.warn("Dropping fragment "+m.sn+" of level "+m.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+m.sn+" of level "+m.level+" will not be buffered")},s.onAudioTrackSwitching=function onAudioTrackSwitching(o,s){var m=this.altAudio,_=!!s.url,S=s.id;if(!_){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var E=this.fragCurrent;E&&(this.log("Switching to main audio track, cancel main fragment load"),E.abortRequests()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var O=this.hls;m&&O.trigger(A.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),O.trigger(A.Events.AUDIO_TRACK_SWITCHED,{id:S})}},s.onAudioTrackSwitched=function onAudioTrackSwitched(o,s){var m=s.id,_=!!this.hls.audioTracks[m].url;if(_){var S=this.videoBuffer;S&&this.mediaBuffer!==S&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=S)}this.altAudio=_,this.tick()},s.onBufferCreated=function onBufferCreated(o,s){var m,_,S=s.tracks,E=!1;for(var A in S){var O=S[A];if("main"===O.id){if(_=A,m=O,"video"===A){var H=S[A];H&&(this.videoBuffer=H.buffer)}}else E=!0}E&&m?(this.log("Alternate track found, use "+_+".buffered to schedule main fragment loading"),this.mediaBuffer=m.buffer):this.mediaBuffer=this.media},s.onFragBuffered=function onFragBuffered(o,s){var m=s.frag,_=s.part;if(!m||m.type===K.PlaylistLevelType.MAIN){if(this.fragContextChanged(m))return this.warn("Fragment "+m.sn+(_?" p: "+_.index:"")+" of level "+m.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===S.State.PARSED&&(this.state=S.State.IDLE));var E=_?_.stats:m.stats;this.fragLastKbps=Math.round(8*E.total/(E.buffering.end-E.loading.first)),"initSegment"!==m.sn&&(this.fragPrevious=m),this.fragBufferedComplete(m,_)}},s.onError=function onError(o,s){if(s.type!==J.ErrorTypes.KEY_SYSTEM_ERROR)switch(s.details){case J.ErrorDetails.FRAG_LOAD_ERROR:case J.ErrorDetails.FRAG_LOAD_TIMEOUT:case J.ErrorDetails.FRAG_PARSING_ERROR:case J.ErrorDetails.KEY_LOAD_ERROR:case J.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(K.PlaylistLevelType.MAIN,s);break;case J.ErrorDetails.LEVEL_LOAD_ERROR:case J.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==S.State.ERROR&&(s.fatal?(this.warn(""+s.details),this.state=S.State.ERROR):s.levelRetry||this.state!==S.State.WAITING_LEVEL||(this.state=S.State.IDLE));break;case J.ErrorDetails.BUFFER_FULL_ERROR:if("main"===s.parent&&(this.state===S.State.PARSING||this.state===S.State.PARSED)){var m=!0,_=this.getFwdBufferInfo(this.media,K.PlaylistLevelType.MAIN);_&&_.len>.5&&(m=!this.reduceMaxBufferLength(_.len)),m&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(K.PlaylistLevelType.MAIN,s)},s.checkBuffer=function checkBuffer(){var o=this.media,s=this.gapController;if(o&&s&&o.readyState){if(this.loadedmetadata||!O.BufferHelper.getBuffered(o).length){var m=this.state!==S.State.IDLE?this.fragCurrent:null;s.poll(this.lastCurrentTime,m)}this.lastCurrentTime=o.currentTime}},s.onFragLoadEmergencyAborted=function onFragLoadEmergencyAborted(){this.state=S.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},s.onBufferFlushed=function onBufferFlushed(o,s){var m=s.type;if(m!==z.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var _=(m===z.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(_,m,K.PlaylistLevelType.MAIN)}},s.onLevelsUpdated=function onLevelsUpdated(o,s){this.levels=s.levels},s.swapAudioCodec=function swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap},s.seekToStartPos=function seekToStartPos(){var o=this.media;if(o){var s=o.currentTime,m=this.startPosition;if(m>=0&&s<m){if(o.seeking)return void this.log("could not seek to "+m+", already seeking at "+s);var _=O.BufferHelper.getBuffered(o),S=(_.length?_.start(0):0)-m;S>0&&(S<this.config.maxBufferHole||S<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+S+" to match buffer start"),m+=S,this.startPosition=m),this.log("seek to target start position "+m+" from current time "+s),o.currentTime=m}}},s._getAudioCodec=function _getAudioCodec(o){var s=this.config.defaultAudioCodec||o.audioCodec;return this.audioCodecSwap&&s&&(this.log("Swapping audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),s},s._loadBitrateTestFrag=function _loadBitrateTestFrag(o,s){var m=this;o.bitrateTest=!0,this._doFragLoad(o,s).then((function(s){var _=m.hls;if(s&&!m.fragContextChanged(o)){m.fragLoadError=0,m.state=S.State.IDLE,m.startFragRequested=!1,m.bitrateTest=!1;var E=o.stats;E.parsing.start=E.parsing.end=E.buffering.start=E.buffering.end=self.performance.now(),_.trigger(A.Events.FRAG_LOADED,s),o.bitrateTest=!1}}))},s._handleTransmuxComplete=function _handleTransmuxComplete(o){var s,m="main",E=this.hls,O=o.remuxResult,H=o.chunkMeta,K=this.getCurrentContext(H);if(!K)return this.warn("The loading context changed while buffering fragment "+H.sn+" of level "+H.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(H.level);var G=K.frag,q=K.part,X=K.level,J=O.video,ae=O.text,pe=O.id3,me=O.initSegment,_e=X.details,Se=this.altAudio?void 0:O.audio;if(!this.fragContextChanged(G)){if(this.state=S.State.PARSING,me){me.tracks&&(this._bufferInitSegment(X,me.tracks,G,H),E.trigger(A.Events.FRAG_PARSING_INIT_SEGMENT,{frag:G,id:m,tracks:me.tracks}));var Ee=me.initPTS,De=me.timescale;(0,_.isFiniteNumber)(Ee)&&(this.initPTS[G.cc]=Ee,E.trigger(A.Events.INIT_PTS_FOUND,{frag:G,id:m,initPTS:Ee,timescale:De}))}if(J&&!1!==O.independent){if(_e){var $e=J.startPTS,He=J.endPTS,et=J.startDTS,rt=J.endDTS;if(q)q.elementaryStreams[J.type]={startPTS:$e,endPTS:He,startDTS:et,endDTS:rt};else if(J.firstKeyFrame&&J.independent&&1===H.id&&(this.couldBacktrack=!0),J.dropped&&J.independent){var it=this.getMainFwdBufferInfo();if((it?it.end:this.getLoadPosition())+this.config.maxBufferHole<(J.firstKeyFramePTS?J.firstKeyFramePTS:$e)-this.config.maxBufferHole)return void this.backtrack(G);G.setElementaryStreamInfo(J.type,G.start,He,G.start,rt,!0)}G.setElementaryStreamInfo(J.type,$e,He,et,rt),this.backtrackFragment&&(this.backtrackFragment=G),this.bufferFragmentData(J,G,q,H)}}else if(!1===O.independent)return void this.backtrack(G);if(Se){var at=Se.startPTS,ot=Se.endPTS,st=Se.startDTS,ut=Se.endDTS;q&&(q.elementaryStreams[z.ElementaryStreamTypes.AUDIO]={startPTS:at,endPTS:ot,startDTS:st,endDTS:ut}),G.setElementaryStreamInfo(z.ElementaryStreamTypes.AUDIO,at,ot,st,ut),this.bufferFragmentData(Se,G,q,H)}if(_e&&null!=pe&&null!==(s=pe.samples)&&void 0!==s&&s.length){var ct={id:m,frag:G,details:_e,samples:pe.samples};E.trigger(A.Events.FRAG_PARSING_METADATA,ct)}if(_e&&ae){var dt={id:m,frag:G,details:_e,samples:ae.samples};E.trigger(A.Events.FRAG_PARSING_USERDATA,dt)}}},s._bufferInitSegment=function _bufferInitSegment(o,s,m,_){var E=this;if(this.state===S.State.PARSING){this.audioOnly=!!s.audio&&!s.video,this.altAudio&&!this.audioOnly&&delete s.audio;var O=s.audio,H=s.video,K=s.audiovideo;if(O){var z=o.audioCodec,G=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(z&&(z=-1!==z.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==O.metadata.channelCount&&-1===G.indexOf("firefox")&&(z="mp4a.40.5")),-1!==G.indexOf("android")&&"audio/mpeg"!==O.container&&(z="mp4a.40.2",this.log("Android: force audio codec to "+z)),o.audioCodec&&o.audioCodec!==z&&this.log('Swapping manifest audio codec "'+o.audioCodec+'" for "'+z+'"'),O.levelCodec=z,O.id="main",this.log("Init audio buffer, container:"+O.container+", codecs[selected/level/parsed]=["+(z||"")+"/"+(o.audioCodec||"")+"/"+O.codec+"]")}H&&(H.levelCodec=o.videoCodec,H.id="main",this.log("Init video buffer, container:"+H.container+", codecs[level/parsed]=["+(o.videoCodec||"")+"/"+H.codec+"]")),K&&this.log("Init audiovideo buffer, container:"+K.container+", codecs[level/parsed]=["+(o.attrs.CODECS||"")+"/"+K.codec+"]"),this.hls.trigger(A.Events.BUFFER_CODECS,s),Object.keys(s).forEach((function(o){var S=s[o].initSegment;null!=S&&S.byteLength&&E.hls.trigger(A.Events.BUFFER_APPENDING,{type:o,data:S,frag:m,part:null,chunkMeta:_,parent:m.type})})),this.tick()}},s.getMainFwdBufferInfo=function getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,K.PlaylistLevelType.MAIN)},s.backtrack=function backtrack(o){this.couldBacktrack=!0,this.backtrackFragment=o,this.resetTransmuxer(),this.flushBufferGap(o),this.fragmentTracker.removeFragment(o),this.fragPrevious=null,this.nextLoadPosition=o.start,this.state=S.State.IDLE},s.checkFragmentChanged=function checkFragmentChanged(){var o=this.media,s=null;if(o&&o.readyState>1&&!1===o.seeking){var m=o.currentTime;if(O.BufferHelper.isBuffered(o,m)?s=this.getAppendedFrag(m):O.BufferHelper.isBuffered(o,m+.1)&&(s=this.getAppendedFrag(m+.1)),s){this.backtrackFragment=null;var _=this.fragPlaying,S=s.level;_&&s.sn===_.sn&&_.level===S&&s.urlId===_.urlId||(this.fragPlaying=s,this.hls.trigger(A.Events.FRAG_CHANGED,{frag:s}),_&&_.level===S||this.hls.trigger(A.Events.LEVEL_SWITCHED,{level:S}))}}},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(StreamController,[{key:"nextLevel",get:function get(){var o=this.nextBufferedFrag;return o?o.level:-1}},{key:"currentFrag",get:function get(){var o=this.media;return o?this.fragPlaying||this.getAppendedFrag(o.currentTime):null}},{key:"currentProgramDateTime",get:function get(){var o=this.media;if(o){var s=o.currentTime,m=this.currentFrag;if(m&&(0,_.isFiniteNumber)(s)&&(0,_.isFiniteNumber)(m.programDateTime)){var S=m.programDateTime+1e3*(s-m.start);return new Date(S)}}return null}},{key:"currentLevel",get:function get(){var o=this.currentFrag;return o?o.level:-1}},{key:"nextBufferedFrag",get:function get(){var o=this.currentFrag;return o?this.followingBufferedFrag(o):null}},{key:"forceStartLoad",get:function get(){return this._forceStartLoad}}]),StreamController}(S.default)},"./src/controller/subtitle-stream-controller.ts":
/*!******************************************************!*\
    !*** ./src/controller/subtitle-stream-controller.ts ***!
    \******************************************************/function srcControllerSubtitleStreamControllerTs(o,s,m){m.r(s),m.d(s,{SubtitleStreamController:function SubtitleStreamController(){return q}});var _=m(/*! ../events */"./src/events.ts"),S=m(/*! ../utils/buffer-helper */"./src/utils/buffer-helper.ts"),E=m(/*! ./fragment-finders */"./src/controller/fragment-finders.ts"),A=m(/*! ../utils/discontinuities */"./src/utils/discontinuities.ts"),O=m(/*! ./level-helper */"./src/controller/level-helper.ts"),H=m(/*! ./fragment-tracker */"./src/controller/fragment-tracker.ts"),K=m(/*! ./base-stream-controller */"./src/controller/base-stream-controller.ts"),z=m(/*! ../types/loader */"./src/types/loader.ts"),G=m(/*! ../types/level */"./src/types/level.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var q=function(o){function SubtitleStreamController(s,m,_){var S;return(S=o.call(this,s,m,_,"[subtitle-stream-controller]")||this).levels=[],S.currentTrackId=-1,S.tracksBuffered=[],S.mainDetails=null,S._registerListeners(),S}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(SubtitleStreamController,o);var s=SubtitleStreamController.prototype;return s.onHandlerDestroying=function onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function _registerListeners(){var o=this.hls;o.on(_.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(_.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(_.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(_.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(_.Events.ERROR,this.onError,this),o.on(_.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.on(_.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),o.on(_.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.on(_.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),o.on(_.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.on(_.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function _unregisterListeners(){var o=this.hls;o.off(_.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(_.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(_.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(_.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(_.Events.ERROR,this.onError,this),o.off(_.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.off(_.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),o.off(_.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.off(_.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),o.off(_.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),o.off(_.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.startLoad=function startLoad(o){this.stopLoad(),this.state=K.State.IDLE,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=o,this.tick()},s.onManifestLoading=function onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},s.onLevelLoaded=function onLevelLoaded(o,s){this.mainDetails=s.details},s.onSubtitleFragProcessed=function onSubtitleFragProcessed(o,s){var m=s.frag,_=s.success;if(this.fragPrevious=m,this.state=K.State.IDLE,_){var S=this.tracksBuffered[this.currentTrackId];if(S){for(var E,A=m.start,O=0;O<S.length;O++)if(A>=S[O].start&&A<=S[O].end){E=S[O];break}var H=m.start+m.duration;E?E.end=H:(E={start:A,end:H},S.push(E)),this.fragmentTracker.fragBuffered(m)}}},s.onBufferFlushing=function onBufferFlushing(o,s){var m=s.startOffset,_=s.endOffset;if(0===m&&_!==Number.POSITIVE_INFINITY){var S=this.currentTrackId,E=this.levels;if(!E.length||!E[S]||!E[S].details)return;var A=_-E[S].details.targetduration;if(A<=0)return;s.endOffsetSubtitles=Math.max(0,A),this.tracksBuffered.forEach((function(o){for(var s=0;s<o.length;)if(o[s].end<=A)o.shift();else{if(!(o[s].start<A))break;o[s].start=A,s++}})),this.fragmentTracker.removeFragmentsInRange(m,A,z.PlaylistLevelType.SUBTITLE)}},s.onFragBuffered=function onFragBuffered(o,s){var m;this.loadedmetadata||s.frag.type!==z.PlaylistLevelType.MAIN||null!==(m=this.media)&&void 0!==m&&m.buffered.length&&(this.loadedmetadata=!0)},s.onError=function onError(o,s){var m=s.frag;m&&m.type===z.PlaylistLevelType.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state=K.State.IDLE)},s.onSubtitleTracksUpdated=function onSubtitleTracksUpdated(o,s){var m=this,_=s.subtitleTracks;this.tracksBuffered=[],this.levels=_.map((function(o){return new G.Level(o)})),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach((function(o){m.tracksBuffered[o.id]=[]})),this.mediaBuffer=null},s.onSubtitleTrackSwitch=function onSubtitleTrackSwitch(o,s){if(this.currentTrackId=s.id,this.levels.length&&-1!==this.currentTrackId){var m=this.levels[this.currentTrackId];null!=m&&m.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,m&&this.setInterval(500)}else this.clearInterval()},s.onSubtitleTrackLoaded=function onSubtitleTrackLoaded(o,s){var m,_=s.details,S=s.id,H=this.currentTrackId,z=this.levels;if(z.length){var G=z[H];if(!(S>=z.length||S!==H)&&G){this.mediaBuffer=this.mediaBufferTimeRanges;var q=0;if(_.live||null!==(m=G.details)&&void 0!==m&&m.live){var X=this.mainDetails;if(_.deltaUpdateFailed||!X)return;var J=X.fragments[0];G.details?0===(q=this.alignPlaylists(_,G.details))&&J&&(q=J.start,(0,O.addSliding)(_,q)):_.hasProgramDateTime&&X.hasProgramDateTime?((0,A.alignMediaPlaylistByPDT)(_,X),q=_.fragments[0].start):J&&(q=J.start,(0,O.addSliding)(_,q))}if(G.details=_,this.levelLastLoaded=S,this.startFragRequested||!this.mainDetails&&_.live||this.setStartPosition(G.details,q),this.tick(),_.live&&!this.fragCurrent&&this.media&&this.state===K.State.IDLE)(0,E.findFragmentByPTS)(null,_.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),G.details=void 0)}}},s._handleFragmentLoadComplete=function _handleFragmentLoadComplete(o){var s=this,m=o.frag,S=o.payload,E=m.decryptdata,A=this.hls;if(!this.fragContextChanged(m)&&S&&S.byteLength>0&&E&&E.key&&E.iv&&"AES-128"===E.method){var O=performance.now();this.decrypter.decrypt(new Uint8Array(S),E.key.buffer,E.iv.buffer).then((function(o){var s=performance.now();A.trigger(_.Events.FRAG_DECRYPTED,{frag:m,payload:o,stats:{tstart:O,tdecrypt:s}})})).catch((function(o){s.warn(o.name+": "+o.message),s.state=K.State.IDLE}))}},s.doTick=function doTick(){if(this.media){if(this.state===K.State.IDLE){var o=this.currentTrackId,s=this.levels;if(!s.length||!s[o]||!s[o].details)return;var m=s[o].details,_=m.targetduration,A=this.config,O=this.getLoadPosition(),G=S.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],O-_,A.maxBufferHole),q=G.end,X=G.len,J=this.getFwdBufferInfo(this.media,z.PlaylistLevelType.MAIN);if(X>this.getMaxBufferLength(null==J?void 0:J.len)+_)return;console.assert(m,"Subtitle track details are defined on idle subtitle stream controller tick");var ae=m.fragments,pe=ae.length,me=m.edge,_e=null,Se=this.fragPrevious;if(q<me){var Ee=A.maxFragLookUpTolerance;!(_e=(0,E.findFragmentByPTS)(Se,ae,Math.max(ae[0].start,q),Ee))&&Se&&Se.start<ae[0].start&&(_e=ae[0])}else _e=ae[pe-1];if(!_e)return;_e=this.mapToInitFragWhenRequired(_e),this.fragmentTracker.getState(_e)===H.FragmentState.NOT_LOADED&&this.loadFragment(_e,m,q)}}else this.state=K.State.IDLE},s.getMaxBufferLength=function getMaxBufferLength(s){var m=o.prototype.getMaxBufferLength.call(this);return s?Math.max(m,s):m},s.loadFragment=function loadFragment(s,m,_){this.fragCurrent=s,"initSegment"===s.sn?this._loadInitSegment(s,m):(this.startFragRequested=!0,o.prototype.loadFragment.call(this,s,m,_))},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(SubtitleStreamController,[{key:"mediaBufferTimeRanges",get:function get(){return new X(this.tracksBuffered[this.currentTrackId]||[])}}]),SubtitleStreamController}(K.default),X=function BufferableInstance(o){this.buffered=void 0;var s=function getRange(s,m,_){if((m>>>=0)>_-1)throw new DOMException("Failed to execute '"+s+"' on 'TimeRanges': The index provided ("+m+") is greater than the maximum bound ("+_+")");return o[m][s]};this.buffered={get length(){return o.length},end:function end(m){return s("end",m,o.length)},start:function start(m){return s("start",m,o.length)}}}},"./src/controller/subtitle-track-controller.ts":
/*!*****************************************************!*\
    !*** ./src/controller/subtitle-track-controller.ts ***!
    \*****************************************************/function srcControllerSubtitleTrackControllerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return H}});var _=m(/*! ../events */"./src/events.ts"),S=m(/*! ../utils/texttrack-utils */"./src/utils/texttrack-utils.ts"),E=m(/*! ./base-playlist-controller */"./src/controller/base-playlist-controller.ts"),A=m(/*! ../types/loader */"./src/types/loader.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var O=function(o){function SubtitleTrackController(s){var m;return(m=o.call(this,s,"[subtitle-track-controller]")||this).media=null,m.tracks=[],m.groupId=null,m.tracksInGroup=[],m.trackId=-1,m.selectDefaultTrack=!0,m.queuedDefaultTrack=-1,m.trackChangeListener=function(){return m.onTextTracksChanged()},m.asyncPollTrackChange=function(){return m.pollTrackChange(0)},m.useTextTrackPolling=!1,m.subtitlePollingInterval=-1,m._subtitleDisplay=!0,m.registerListeners(),m}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(SubtitleTrackController,o);var s=SubtitleTrackController.prototype;return s.destroy=function destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,o.prototype.destroy.call(this)},s.registerListeners=function registerListeners(){var o=this.hls;o.on(_.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(_.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(_.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(_.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.on(_.Events.LEVEL_LOADING,this.onLevelLoading,this),o.on(_.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.on(_.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.on(_.Events.ERROR,this.onError,this)},s.unregisterListeners=function unregisterListeners(){var o=this.hls;o.off(_.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(_.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(_.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(_.Events.MANIFEST_PARSED,this.onManifestParsed,this),o.off(_.Events.LEVEL_LOADING,this.onLevelLoading,this),o.off(_.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),o.off(_.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),o.off(_.Events.ERROR,this.onError,this)},s.onMediaAttached=function onMediaAttached(o,s){this.media=s.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},s.pollTrackChange=function pollTrackChange(o){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,o)},s.onMediaDetaching=function onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),filterSubtitleTracks(this.media.textTracks).forEach((function(o){(0,S.clearCurrentCues)(o)})),this.subtitleTrack=-1,this.media=null)},s.onManifestLoading=function onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},s.onManifestParsed=function onManifestParsed(o,s){this.tracks=s.subtitleTracks},s.onSubtitleTrackLoaded=function onSubtitleTrackLoaded(o,s){var m=s.id,_=s.details,S=this.trackId,E=this.tracksInGroup[S];if(E){var A=E.details;E.details=s.details,this.log("subtitle track "+m+" loaded ["+_.startSN+"-"+_.endSN+"]"),m===this.trackId&&(this.retryCount=0,this.playlistLoaded(m,s,A))}else this.warn("Invalid subtitle track id "+m)},s.onLevelLoading=function onLevelLoading(o,s){this.switchLevel(s.level)},s.onLevelSwitching=function onLevelSwitching(o,s){this.switchLevel(s.level)},s.switchLevel=function switchLevel(o){var s=this.hls.levels[o];if(null!=s&&s.textGroupIds){var m=s.textGroupIds[s.urlId];if(this.groupId!==m){var S=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,E=this.tracks.filter((function(o){return!m||o.groupId===m}));this.tracksInGroup=E;var A=this.findTrackId(null==S?void 0:S.name)||this.findTrackId();this.groupId=m;var O={subtitleTracks:E};this.log("Updating subtitle tracks, "+E.length+' track(s) found in "'+m+'" group-id'),this.hls.trigger(_.Events.SUBTITLE_TRACKS_UPDATED,O),-1!==A&&this.setSubtitleTrack(A,S)}}},s.findTrackId=function findTrackId(o){for(var s=this.tracksInGroup,m=0;m<s.length;m++){var _=s[m];if((!this.selectDefaultTrack||_.default)&&(!o||o===_.name))return _.id}return-1},s.onError=function onError(s,m){o.prototype.onError.call(this,s,m),!m.fatal&&m.context&&m.context.type===A.PlaylistContextType.SUBTITLE_TRACK&&m.context.id===this.trackId&&m.context.groupId===this.groupId&&this.retryLoadingOrFail(m)},s.loadPlaylist=function loadPlaylist(s){o.prototype.loadPlaylist.call(this);var m=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(m)){var S=m.id,E=m.groupId,A=m.url;if(s)try{A=s.addDirectives(A)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("Loading subtitle playlist for id "+S),this.hls.trigger(_.Events.SUBTITLE_TRACK_LOADING,{url:A,id:S,groupId:E,deliveryDirectives:s||null})}},s.toggleTrackModes=function toggleTrackModes(o){var s=this,m=this.media,_=this.trackId;if(m){var S=filterSubtitleTracks(m.textTracks),E=S.filter((function(o){return o.groupId===s.groupId}));if(-1===o)[].slice.call(S).forEach((function(o){o.mode="disabled"}));else{var A=E[_];A&&(A.mode="disabled")}var O=E[o];O&&(O.mode=this.subtitleDisplay?"showing":"hidden")}},s.setSubtitleTrack=function setSubtitleTrack(o,s){var m,S=this.tracksInGroup;if(this.media){if(this.trackId!==o&&this.toggleTrackModes(o),!(this.trackId===o&&(-1===o||null!==(m=S[o])&&void 0!==m&&m.details)||o<-1||o>=S.length)){this.clearTimer();var E=S[o];if(this.log("Switching to subtitle track "+o),this.trackId=o,E){var A=E.id,O=E.groupId,H=void 0===O?"":O,K=E.name,z=E.type,G=E.url;this.hls.trigger(_.Events.SUBTITLE_TRACK_SWITCH,{id:A,groupId:H,name:K,type:z,url:G});var q=this.switchParams(E.url,null==s?void 0:s.details);this.loadPlaylist(q)}else this.hls.trigger(_.Events.SUBTITLE_TRACK_SWITCH,{id:o})}}else this.queuedDefaultTrack=o},s.onTextTracksChanged=function onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var o=-1,s=filterSubtitleTracks(this.media.textTracks),m=0;m<s.length;m++)if("hidden"===s[m].mode)o=m;else if("showing"===s[m].mode){o=m;break}this.subtitleTrack!==o&&(this.subtitleTrack=o)}},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(SubtitleTrackController,[{key:"subtitleDisplay",get:function get(){return this._subtitleDisplay},set:function set(o){this._subtitleDisplay=o,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function get(){return this.tracksInGroup}},{key:"subtitleTrack",get:function get(){return this.trackId},set:function set(o){this.selectDefaultTrack=!1;var s=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(o,s)}}]),SubtitleTrackController}(E.default);function filterSubtitleTracks(o){for(var s=[],m=0;m<o.length;m++){var _=o[m];"subtitles"===_.kind&&_.label&&s.push(o[m])}return s}var H=O},"./src/controller/timeline-controller.ts":
/*!***********************************************!*\
    !*** ./src/controller/timeline-controller.ts ***!
    \***********************************************/function srcControllerTimelineControllerTs(o,s,m){m.r(s),m.d(s,{TimelineController:function TimelineController(){return X}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../utils/cea-608-parser */"./src/utils/cea-608-parser.ts"),A=m(/*! ../utils/output-filter */"./src/utils/output-filter.ts"),O=m(/*! ../utils/webvtt-parser */"./src/utils/webvtt-parser.ts"),H=m(/*! ../utils/texttrack-utils */"./src/utils/texttrack-utils.ts"),K=m(/*! ../utils/imsc1-ttml-parser */"./src/utils/imsc1-ttml-parser.ts"),z=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),G=m(/*! ../types/loader */"./src/types/loader.ts"),q=m(/*! ../utils/logger */"./src/utils/logger.ts"),X=function(){function TimelineController(o){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=o,this.config=o.config,this.Cues=o.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var s=new A.default(this,"textTrack1"),m=new A.default(this,"textTrack2"),_=new A.default(this,"textTrack3"),O=new A.default(this,"textTrack4");this.cea608Parser1=new E.default(1,s,m),this.cea608Parser2=new E.default(3,_,O)}o.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.on(S.Events.FRAG_LOADING,this.onFragLoading,this),o.on(S.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(S.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),o.on(S.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),o.on(S.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.on(S.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),o.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var o=TimelineController.prototype;return o.destroy=function destroy(){var o=this.hls;o.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),o.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(S.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),o.off(S.Events.FRAG_LOADING,this.onFragLoading,this),o.off(S.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(S.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),o.off(S.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),o.off(S.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.off(S.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),o.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},o.addCues=function addCues(o,s,m,_,E){for(var A,O,H,K,z=!1,G=E.length;G--;){var q=E[G],X=(A=q[0],O=q[1],H=s,K=m,Math.min(O,K)-Math.max(A,H));if(X>=0&&(q[0]=Math.min(q[0],s),q[1]=Math.max(q[1],m),z=!0,X/(m-s)>.5))return}if(z||E.push([s,m]),this.config.renderTextTracksNatively){var J=this.captionsTracks[o];this.Cues.newCue(J,s,m,_)}else{var ae=this.Cues.newCue(null,s,m,_);this.hls.trigger(S.Events.CUES_PARSED,{type:"captions",cues:ae,track:o})}},o.onInitPtsFound=function onInitPtsFound(o,s){var m=this,_=s.frag,E=s.id,A=s.initPTS,O=s.timescale,H=this.unparsedVttFrags;"main"===E&&(this.initPTS[_.cc]=A,this.timescale[_.cc]=O),H.length&&(this.unparsedVttFrags=[],H.forEach((function(o){m.onFragLoaded(S.Events.FRAG_LOADED,o)})))},o.getExistingTrack=function getExistingTrack(o){var s=this.media;if(s)for(var m=0;m<s.textTracks.length;m++){var _=s.textTracks[m];if(_[o])return _}return null},o.createCaptionsTrack=function createCaptionsTrack(o){this.config.renderTextTracksNatively?this.createNativeTrack(o):this.createNonNativeTrack(o)},o.createNativeTrack=function createNativeTrack(o){if(!this.captionsTracks[o]){var s=this.captionsProperties,m=this.captionsTracks,_=this.media,S=s[o],E=S.label,A=S.languageCode,O=this.getExistingTrack(o);if(O)m[o]=O,(0,H.clearCurrentCues)(m[o]),(0,H.sendAddTrackEvent)(m[o],_);else{var K=this.createTextTrack("captions",E,A);K&&(K[o]=!0,m[o]=K)}}},o.createNonNativeTrack=function createNonNativeTrack(o){if(!this.nonNativeCaptionsTracks[o]){var s=this.captionsProperties[o];if(s){var m={_id:o,label:s.label,kind:"captions",default:!!s.media&&!!s.media.default,closedCaptions:s.media};this.nonNativeCaptionsTracks[o]=m,this.hls.trigger(S.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[m]})}}},o.createTextTrack=function createTextTrack(o,s,m){var _=this.media;if(_)return _.addTextTrack(o,s,m)},o.onMediaAttaching=function onMediaAttaching(o,s){this.media=s.media,this._cleanTracks()},o.onMediaDetaching=function onMediaDetaching(){var o=this.captionsTracks;Object.keys(o).forEach((function(s){(0,H.clearCurrentCues)(o[s]),delete o[s]})),this.nonNativeCaptionsTracks={}},o.onManifestLoading=function onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},o._cleanTracks=function _cleanTracks(){var o=this.media;if(o){var s=o.textTracks;if(s)for(var m=0;m<s.length;m++)(0,H.clearCurrentCues)(s[m])}},o.onSubtitleTracksUpdated=function onSubtitleTracksUpdated(o,s){var m=this;this.textTracks=[];var _=s.subtitleTracks||[],E=_.some((function(o){return o.textCodec===K.IMSC1_CODEC}));if(this.config.enableWebVTT||E&&this.config.enableIMSC1){var A=this.tracks&&_&&this.tracks.length===_.length;if(this.tracks=_||[],this.config.renderTextTracksNatively){var O=this.media?this.media.textTracks:[];this.tracks.forEach((function(o,s){var _;if(s<O.length){for(var S=null,E=0;E<O.length;E++)if(canReuseVttTextTrack(O[E],o)){S=O[E];break}S&&(_=S)}if(_)(0,H.clearCurrentCues)(_);else{var A=m._captionsOrSubtitlesFromCharacteristics(o);(_=m.createTextTrack(A,o.name,o.lang))&&(_.mode="disabled")}_&&(_.groupId=o.groupId,m.textTracks.push(_))}))}else if(!A&&this.tracks&&this.tracks.length){var z=this.tracks.map((function(o){return{label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}}));this.hls.trigger(S.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:z})}}},o._captionsOrSubtitlesFromCharacteristics=function _captionsOrSubtitlesFromCharacteristics(o){var s;if(null!==(s=o.attrs)&&void 0!==s&&s.CHARACTERISTICS){var m=/transcribes-spoken-dialog/gi.test(o.attrs.CHARACTERISTICS),_=/describes-music-and-sound/gi.test(o.attrs.CHARACTERISTICS);if(m&&_)return"captions"}return"subtitles"},o.onManifestLoaded=function onManifestLoaded(o,s){var m=this;this.config.enableCEA708Captions&&s.captions&&s.captions.forEach((function(o){var s=/(?:CC|SERVICE)([1-4])/.exec(o.instreamId);if(s){var _="textTrack"+s[1],S=m.captionsProperties[_];S&&(S.label=o.name,o.lang&&(S.languageCode=o.lang),S.media=o)}}))},o.closedCaptionsForLevel=function closedCaptionsForLevel(o){var s=this.hls.levels[o.level];return null==s?void 0:s.attrs["CLOSED-CAPTIONS"]},o.onFragLoading=function onFragLoading(o,s){var m=this.cea608Parser1,_=this.cea608Parser2,S=this.lastSn,E=this.lastPartIndex;if(this.enabled&&m&&_&&s.frag.type===G.PlaylistLevelType.MAIN){var A,O,H=s.frag.sn,K=null!=(A=null==s||null===(O=s.part)||void 0===O?void 0:O.index)?A:-1;H===S+1||H===S&&K===E+1||(m.reset(),_.reset()),this.lastSn=H,this.lastPartIndex=K}},o.onFragLoaded=function onFragLoaded(o,s){var m=s.frag,E=s.payload,A=this.initPTS,O=this.unparsedVttFrags;if(m.type===G.PlaylistLevelType.SUBTITLE)if(E.byteLength){if(!(0,_.isFiniteNumber)(A[m.cc]))return O.push(s),void(A.length&&this.hls.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:m,error:new Error("Missing initial subtitle PTS")}));var H=m.decryptdata,z="stats"in s;if(null==H||!H.encrypted||z){var q=this.tracks[m.level],X=this.vttCCs;X[m.cc]||(X[m.cc]={start:m.start,prevCC:this.prevCC,new:!0},this.prevCC=m.cc),q&&q.textCodec===K.IMSC1_CODEC?this._parseIMSC1(m,E):this._parseVTTs(m,E,X)}}else this.hls.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:m,error:new Error("Empty subtitle payload")})},o._parseIMSC1=function _parseIMSC1(o,s){var m=this,_=this.hls;(0,K.parseIMSC1)(s,this.initPTS[o.cc],this.timescale[o.cc],(function(s){m._appendCues(s,o.level),_.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:o})}),(function(s){q.logger.log("Failed to parse IMSC1: "+s),_.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:s})}))},o._parseVTTs=function _parseVTTs(o,s,m){var _,E=this,A=this.hls,H=null!==(_=o.initSegment)&&void 0!==_&&_.data?(0,z.appendUint8Array)(o.initSegment.data,new Uint8Array(s)):s;(0,O.parseWebVTT)(H,this.initPTS[o.cc],this.timescale[o.cc],m,o.cc,o.start,(function(s){E._appendCues(s,o.level),A.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:o})}),(function(m){E._fallbackToIMSC1(o,s),q.logger.log("Failed to parse VTT cue: "+m),A.trigger(S.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:m})}))},o._fallbackToIMSC1=function _fallbackToIMSC1(o,s){var m=this,_=this.tracks[o.level];_.textCodec||(0,K.parseIMSC1)(s,this.initPTS[o.cc],this.timescale[o.cc],(function(){_.textCodec=K.IMSC1_CODEC,m._parseIMSC1(o,s)}),(function(){_.textCodec="wvtt"}))},o._appendCues=function _appendCues(o,s){var m=this.hls;if(this.config.renderTextTracksNatively){var _=this.textTracks[s];if(!_||"disabled"===_.mode)return;o.forEach((function(o){return(0,H.addCueToTrack)(_,o)}))}else{var E=this.tracks[s];if(!E)return;var A=E.default?"default":"subtitles"+s;m.trigger(S.Events.CUES_PARSED,{type:"subtitles",cues:o,track:A})}},o.onFragDecrypted=function onFragDecrypted(o,s){var m=s.frag;if(m.type===G.PlaylistLevelType.SUBTITLE){if(!(0,_.isFiniteNumber)(this.initPTS[m.cc]))return void this.unparsedVttFrags.push(s);this.onFragLoaded(S.Events.FRAG_LOADED,s)}},o.onSubtitleTracksCleared=function onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}},o.onFragParsingUserdata=function onFragParsingUserdata(o,s){var m=this.cea608Parser1,_=this.cea608Parser2;if(this.enabled&&m&&_){var S=s.frag,E=s.samples;if(S.type!==G.PlaylistLevelType.MAIN||"NONE"!==this.closedCaptionsForLevel(S))for(var A=0;A<E.length;A++){var O=E[A].bytes;if(O){var H=this.extractCea608Data(O);m.addData(E[A].pts,H[0]),_.addData(E[A].pts,H[1])}}}},o.onBufferFlushing=function onBufferFlushing(o,s){var m=s.startOffset,_=s.endOffset,S=s.endOffsetSubtitles,E=s.type,A=this.media;if(A&&!(A.currentTime<_)){if(!E||"video"===E){var O=this.captionsTracks;Object.keys(O).forEach((function(o){return(0,H.removeCuesInRange)(O[o],m,_)}))}if(this.config.renderTextTracksNatively&&0===m&&void 0!==S){var K=this.textTracks;Object.keys(K).forEach((function(o){return(0,H.removeCuesInRange)(K[o],m,S)}))}}},o.extractCea608Data=function extractCea608Data(o){for(var s=[[],[]],m=31&o[0],_=2,S=0;S<m;S++){var E=o[_++],A=127&o[_++],O=127&o[_++];if(0!==A||0!==O)if(0!=(4&E)){var H=3&E;0!==H&&1!==H||(s[H].push(A),s[H].push(O))}}return s},TimelineController}();function canReuseVttTextTrack(o,s){return o&&o.label===s.name&&!(o.textTrack1||o.textTrack2)}},"./src/crypt/aes-crypto.ts":
/*!*********************************!*\
    !*** ./src/crypt/aes-crypto.ts ***!
    \*********************************/function srcCryptAesCryptoTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _=function(){function AESCrypto(o,s){this.subtle=void 0,this.aesIV=void 0,this.subtle=o,this.aesIV=s}return AESCrypto.prototype.decrypt=function decrypt(o,s){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},s,o)},AESCrypto}()},"./src/crypt/aes-decryptor.ts":
/*!************************************!*\
    !*** ./src/crypt/aes-decryptor.ts ***!
    \************************************/function srcCryptAesDecryptorTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return S},removePadding:function removePadding(){return _removePadding}});var _=m(/*! ../utils/typed-array */"./src/utils/typed-array.ts");function _removePadding(o){var s=o.byteLength,m=s&&new DataView(o.buffer).getUint8(s-1);return m?(0,_.sliceUint8)(o,0,s-m):o}var S=function(){function AESDecryptor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var o=AESDecryptor.prototype;return o.uint8ArrayToUint32Array_=function uint8ArrayToUint32Array_(o){for(var s=new DataView(o),m=new Uint32Array(4),_=0;_<4;_++)m[_]=s.getUint32(4*_);return m},o.initTable=function initTable(){var o=this.sBox,s=this.invSBox,m=this.subMix,_=m[0],S=m[1],E=m[2],A=m[3],O=this.invSubMix,H=O[0],K=O[1],z=O[2],G=O[3],q=new Uint32Array(256),X=0,J=0,ae=0;for(ae=0;ae<256;ae++)q[ae]=ae<128?ae<<1:ae<<1^283;for(ae=0;ae<256;ae++){var pe=J^J<<1^J<<2^J<<3^J<<4;pe=pe>>>8^255&pe^99,o[X]=pe,s[pe]=X;var me=q[X],_e=q[me],Se=q[_e],Ee=257*q[pe]^16843008*pe;_[X]=Ee<<24|Ee>>>8,S[X]=Ee<<16|Ee>>>16,E[X]=Ee<<8|Ee>>>24,A[X]=Ee,Ee=16843009*Se^65537*_e^257*me^16843008*X,H[pe]=Ee<<24|Ee>>>8,K[pe]=Ee<<16|Ee>>>16,z[pe]=Ee<<8|Ee>>>24,G[pe]=Ee,X?(X=me^q[q[q[Se^me]]],J^=q[q[J]]):X=J=1}},o.expandKey=function expandKey(o){for(var s=this.uint8ArrayToUint32Array_(o),m=!0,_=0;_<s.length&&m;)m=s[_]===this.key[_],_++;if(!m){this.key=s;var S=this.keySize=s.length;if(4!==S&&6!==S&&8!==S)throw new Error("Invalid aes key size="+S);var E,A,O,H,K=this.ksRows=4*(S+6+1),z=this.keySchedule=new Uint32Array(K),G=this.invKeySchedule=new Uint32Array(K),q=this.sBox,X=this.rcon,J=this.invSubMix,ae=J[0],pe=J[1],me=J[2],_e=J[3];for(E=0;E<K;E++)E<S?O=z[E]=s[E]:(H=O,E%S==0?(H=q[(H=H<<8|H>>>24)>>>24]<<24|q[H>>>16&255]<<16|q[H>>>8&255]<<8|q[255&H],H^=X[E/S|0]<<24):S>6&&E%S==4&&(H=q[H>>>24]<<24|q[H>>>16&255]<<16|q[H>>>8&255]<<8|q[255&H]),z[E]=O=(z[E-S]^H)>>>0);for(A=0;A<K;A++)E=K-A,H=3&A?z[E]:z[E-4],G[A]=A<4||E<=4?H:ae[q[H>>>24]]^pe[q[H>>>16&255]]^me[q[H>>>8&255]]^_e[q[255&H]],G[A]=G[A]>>>0}},o.networkToHostOrderSwap=function networkToHostOrderSwap(o){return o<<24|(65280&o)<<8|(16711680&o)>>8|o>>>24},o.decrypt=function decrypt(o,s,m){for(var _,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me=this.keySize+6,_e=this.invKeySchedule,Se=this.invSBox,Ee=this.invSubMix,De=Ee[0],$e=Ee[1],He=Ee[2],et=Ee[3],rt=this.uint8ArrayToUint32Array_(m),it=rt[0],at=rt[1],ot=rt[2],st=rt[3],ut=new Int32Array(o),ct=new Int32Array(ut.length),dt=this.networkToHostOrderSwap;s<ut.length;){for(G=dt(ut[s]),q=dt(ut[s+1]),X=dt(ut[s+2]),J=dt(ut[s+3]),O=G^_e[0],H=J^_e[1],K=X^_e[2],z=q^_e[3],ae=4,pe=1;pe<me;pe++)_=De[O>>>24]^$e[H>>16&255]^He[K>>8&255]^et[255&z]^_e[ae],S=De[H>>>24]^$e[K>>16&255]^He[z>>8&255]^et[255&O]^_e[ae+1],E=De[K>>>24]^$e[z>>16&255]^He[O>>8&255]^et[255&H]^_e[ae+2],A=De[z>>>24]^$e[O>>16&255]^He[H>>8&255]^et[255&K]^_e[ae+3],O=_,H=S,K=E,z=A,ae+=4;_=Se[O>>>24]<<24^Se[H>>16&255]<<16^Se[K>>8&255]<<8^Se[255&z]^_e[ae],S=Se[H>>>24]<<24^Se[K>>16&255]<<16^Se[z>>8&255]<<8^Se[255&O]^_e[ae+1],E=Se[K>>>24]<<24^Se[z>>16&255]<<16^Se[O>>8&255]<<8^Se[255&H]^_e[ae+2],A=Se[z>>>24]<<24^Se[O>>16&255]<<16^Se[H>>8&255]<<8^Se[255&K]^_e[ae+3],ct[s]=dt(_^it),ct[s+1]=dt(A^at),ct[s+2]=dt(E^ot),ct[s+3]=dt(S^st),it=G,at=q,ot=X,st=J,s+=4}return ct.buffer},AESDecryptor}()},"./src/crypt/decrypter.ts":
/*!********************************!*\
    !*** ./src/crypt/decrypter.ts ***!
    \********************************/function srcCryptDecrypterTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return K}});var _=m(/*! ./aes-crypto */"./src/crypt/aes-crypto.ts"),S=m(/*! ./fast-aes-key */"./src/crypt/fast-aes-key.ts"),E=m(/*! ./aes-decryptor */"./src/crypt/aes-decryptor.ts"),A=m(/*! ../utils/logger */"./src/utils/logger.ts"),O=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),H=m(/*! ../utils/typed-array */"./src/utils/typed-array.ts"),K=function(){function Decrypter(o,s){var m=(void 0===s?{}:s).removePKCS7Padding,_=void 0===m||m;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=o.enableSoftwareAES,this.removePKCS7Padding=_,_)try{var S=self.crypto;S&&(this.subtle=S.subtle||S.webkitSubtle)}catch(o){}null===this.subtle&&(this.useSoftware=!0)}var o=Decrypter.prototype;return o.destroy=function destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},o.isSync=function isSync(){return this.useSoftware},o.flush=function flush(){var o=this.currentResult,s=this.remainderData;if(!o||s)return this.reset(),null;var m=new Uint8Array(o);return this.reset(),this.removePKCS7Padding?(0,E.removePadding)(m):m},o.reset=function reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},o.decrypt=function decrypt(o,s,m){var _=this;return this.useSoftware?new Promise((function(S,E){_.softwareDecrypt(new Uint8Array(o),s,m);var A=_.flush();A?S(A.buffer):E(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(o),s,m)},o.softwareDecrypt=function softwareDecrypt(o,s,m){var _=this.currentIV,S=this.currentResult,A=this.remainderData;this.logOnce("JS AES decrypt"),A&&(o=(0,O.appendUint8Array)(A,o),this.remainderData=null);var K=this.getValidChunk(o);if(!K.length)return null;_&&(m=_);var z=this.softwareDecrypter;z||(z=this.softwareDecrypter=new E.default),z.expandKey(s);var G=S;return this.currentResult=z.decrypt(K.buffer,0,m),this.currentIV=(0,H.sliceUint8)(K,-16).buffer,G||null},o.webCryptoDecrypt=function webCryptoDecrypt(o,s,m){var E=this,O=this.subtle;return this.key===s&&this.fastAesKey||(this.key=s,this.fastAesKey=new S.default(O,s)),this.fastAesKey.expandKey().then((function(s){return O?(E.logOnce("WebCrypto AES decrypt"),new _.default(O,new Uint8Array(m)).decrypt(o.buffer,s)):Promise.reject(new Error("web crypto not initialized"))})).catch((function(_){return A.logger.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+_.name+": "+_.message),E.onWebCryptoError(o,s,m)}))},o.onWebCryptoError=function onWebCryptoError(o,s,m){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(o,s,m);var _=this.flush();if(_)return _.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},o.getValidChunk=function getValidChunk(o){var s=o,m=o.length-o.length%16;return m!==o.length&&(s=(0,H.sliceUint8)(o,0,m),this.remainderData=(0,H.sliceUint8)(o,m)),s},o.logOnce=function logOnce(o){this.logEnabled&&(A.logger.log("[decrypter]: "+o),this.logEnabled=!1)},Decrypter}()},"./src/crypt/fast-aes-key.ts":
/*!***********************************!*\
    !*** ./src/crypt/fast-aes-key.ts ***!
    \***********************************/function srcCryptFastAesKeyTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _=function(){function FastAESKey(o,s){this.subtle=void 0,this.key=void 0,this.subtle=o,this.key=s}return FastAESKey.prototype.expandKey=function expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},FastAESKey}()},"./src/demux/aacdemuxer.ts":
/*!*********************************!*\
    !*** ./src/demux/aacdemuxer.ts ***!
    \*********************************/function srcDemuxAacdemuxerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return H}});var _=m(/*! ./base-audio-demuxer */"./src/demux/base-audio-demuxer.ts"),S=m(/*! ./adts */"./src/demux/adts.ts"),E=m(/*! ../utils/logger */"./src/utils/logger.ts"),A=m(/*! ../demux/id3 */"./src/demux/id3.ts");function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var O=function(o){function AACDemuxer(s,m){var _;return(_=o.call(this)||this).observer=void 0,_.config=void 0,_.observer=s,_.config=m,_}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(AACDemuxer,o);var s=AACDemuxer.prototype;return s.resetInitSegment=function resetInitSegment(s,m,_,S){o.prototype.resetInitSegment.call(this,s,m,_,S),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:m,duration:S,inputTimeScale:9e4,dropped:0}},AACDemuxer.probe=function probe(o){if(!o)return!1;for(var s=(A.getID3Data(o,0)||[]).length,m=o.length;s<m;s++)if(S.probe(o,s))return E.logger.log("ADTS sync word found !"),!0;return!1},s.canParse=function canParse(o,s){return S.canParse(o,s)},s.appendFrame=function appendFrame(o,s,m){S.initTrackConfig(o,this.observer,s,m,o.manifestCodec);var _=S.appendFrame(o,s,m,this.basePTS,this.frameIndex);if(_&&0===_.missing)return _},AACDemuxer}(_.default),H=O},"./src/demux/adts.ts":
/*!***************************!*\
    !*** ./src/demux/adts.ts ***!
    \***************************/function srcDemuxAdtsTs(o,s,m){m.r(s),m.d(s,{appendFrame:function appendFrame(){return _appendFrame},canGetFrameLength:function canGetFrameLength(){return _canGetFrameLength},canParse:function canParse(){return _canParse},getAudioConfig:function getAudioConfig(){return _getAudioConfig},getFrameDuration:function getFrameDuration(){return _getFrameDuration},getFullFrameLength:function getFullFrameLength(){return _getFullFrameLength},getHeaderLength:function getHeaderLength(){return _getHeaderLength},initTrackConfig:function initTrackConfig(){return _initTrackConfig},isHeader:function isHeader(){return _isHeader},isHeaderPattern:function isHeaderPattern(){return _isHeaderPattern},parseFrameHeader:function parseFrameHeader(){return _parseFrameHeader},probe:function probe(){return _probe}});var _=m(/*! ../utils/logger */"./src/utils/logger.ts"),S=m(/*! ../errors */"./src/errors.ts"),E=m(/*! ../events */"./src/events.ts");function _getAudioConfig(o,s,m,A){var O,H,K,z,G=navigator.userAgent.toLowerCase(),q=A,X=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];O=1+((192&s[m+2])>>>6);var J=(60&s[m+2])>>>2;if(!(J>X.length-1))return K=(1&s[m+2])<<2,K|=(192&s[m+3])>>>6,_.logger.log("manifest codec:"+A+", ADTS type:"+O+", samplingIndex:"+J),/firefox/i.test(G)?J>=6?(O=5,z=new Array(4),H=J-3):(O=2,z=new Array(2),H=J):-1!==G.indexOf("android")?(O=2,z=new Array(2),H=J):(O=5,z=new Array(4),A&&(-1!==A.indexOf("mp4a.40.29")||-1!==A.indexOf("mp4a.40.5"))||!A&&J>=6?H=J-3:((A&&-1!==A.indexOf("mp4a.40.2")&&(J>=6&&1===K||/vivaldi/i.test(G))||!A&&1===K)&&(O=2,z=new Array(2)),H=J)),z[0]=O<<3,z[0]|=(14&J)>>1,z[1]|=(1&J)<<7,z[1]|=K<<3,5===O&&(z[1]|=(14&H)>>1,z[2]=(1&H)<<7,z[2]|=8,z[3]=0),{config:z,samplerate:X[J],channelCount:K,codec:"mp4a.40."+O,manifestCodec:q};o.trigger(E.Events.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+J})}function _isHeaderPattern(o,s){return 255===o[s]&&240==(246&o[s+1])}function _getHeaderLength(o,s){return 1&o[s+1]?7:9}function _getFullFrameLength(o,s){return(3&o[s+3])<<11|o[s+4]<<3|(224&o[s+5])>>>5}function _canGetFrameLength(o,s){return s+5<o.length}function _isHeader(o,s){return s+1<o.length&&_isHeaderPattern(o,s)}function _canParse(o,s){return _canGetFrameLength(o,s)&&_isHeaderPattern(o,s)&&_getFullFrameLength(o,s)<=o.length-s}function _probe(o,s){if(_isHeader(o,s)){var m=_getHeaderLength(o,s);if(s+m>=o.length)return!1;var _=_getFullFrameLength(o,s);if(_<=m)return!1;var S=s+_;return S===o.length||_isHeader(o,S)}return!1}function _initTrackConfig(o,s,m,S,E){if(!o.samplerate){var A=_getAudioConfig(s,m,S,E);if(!A)return;o.config=A.config,o.samplerate=A.samplerate,o.channelCount=A.channelCount,o.codec=A.codec,o.manifestCodec=A.manifestCodec,_.logger.log("parsed codec:"+o.codec+", rate:"+A.samplerate+", channels:"+A.channelCount)}}function _getFrameDuration(o){return 9216e4/o}function _parseFrameHeader(o,s){var m=_getHeaderLength(o,s);if(s+m<=o.length){var _=_getFullFrameLength(o,s)-m;if(_>0)return{headerLength:m,frameLength:_}}}function _appendFrame(o,s,m,_,S){var E,A=_+S*_getFrameDuration(o.samplerate),O=_parseFrameHeader(s,m);if(O){var H=O.frameLength,K=O.headerLength,z=K+H,G=Math.max(0,m+z-s.length);G?(E=new Uint8Array(z-K)).set(s.subarray(m+K,s.length),0):E=s.subarray(m+K,m+z);var q={unit:E,pts:A};return G||o.samples.push(q),{sample:q,length:z,missing:G}}var X=s.length-m;return(E=new Uint8Array(X)).set(s.subarray(m,s.length),0),{sample:{unit:E,pts:A},length:X,missing:-1}}},"./src/demux/base-audio-demuxer.ts":
/*!*****************************************!*\
    !*** ./src/demux/base-audio-demuxer.ts ***!
    \*****************************************/function srcDemuxBaseAudioDemuxerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return G},initPTSFn:function initPTSFn(){return z}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../demux/id3 */"./src/demux/id3.ts"),E=m(/*! ../types/demuxer */"./src/types/demuxer.ts"),A=m(/*! ./dummy-demuxed-track */"./src/demux/dummy-demuxed-track.ts"),O=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),H=m(/*! ../utils/typed-array */"./src/utils/typed-array.ts"),K=function(){function BaseAudioDemuxer(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var o=BaseAudioDemuxer.prototype;return o.resetInitSegment=function resetInitSegment(o,s,m,_){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},o.resetTimeStamp=function resetTimeStamp(o){this.initPTS=o,this.resetContiguity()},o.resetContiguity=function resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},o.canParse=function canParse(o,s){return!1},o.appendFrame=function appendFrame(o,s,m){},o.demux=function demux(o,s){this.cachedData&&(o=(0,O.appendUint8Array)(this.cachedData,o),this.cachedData=null);var m,K=S.getID3Data(o,0),G=K?K.length:0,q=this._audioTrack,X=this._id3Track,J=K?S.getTimeStamp(K):void 0,ae=o.length;for((null===this.basePTS||0===this.frameIndex&&(0,_.isFiniteNumber)(J))&&(this.basePTS=z(J,s,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),K&&K.length>0&&X.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:K,type:E.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});G<ae;){if(this.canParse(o,G)){var pe=this.appendFrame(q,o,G);pe?(this.frameIndex++,this.lastPTS=pe.sample.pts,m=G+=pe.length):G=ae}else S.canParse(o,G)?(K=S.getID3Data(o,G),X.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:K,type:E.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),m=G+=K.length):G++;if(G===ae&&m!==ae){var me=(0,H.sliceUint8)(o,m);this.cachedData?this.cachedData=(0,O.appendUint8Array)(this.cachedData,me):this.cachedData=me}}return{audioTrack:q,videoTrack:(0,A.dummyTrack)(),id3Track:X,textTrack:(0,A.dummyTrack)()}},o.demuxSampleAes=function demuxSampleAes(o,s,m){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},o.flush=function flush(o){var s=this.cachedData;return s&&(this.cachedData=null,this.demux(s,0)),{audioTrack:this._audioTrack,videoTrack:(0,A.dummyTrack)(),id3Track:this._id3Track,textTrack:(0,A.dummyTrack)()}},o.destroy=function destroy(){},BaseAudioDemuxer}(),z=function initPTSFn(o,s,m){return(0,_.isFiniteNumber)(o)?90*o:9e4*s+(m||0)},G=K},"./src/demux/chunk-cache.ts":
/*!**********************************!*\
    !*** ./src/demux/chunk-cache.ts ***!
    \**********************************/function srcDemuxChunkCacheTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _=function(){function ChunkCache(){this.chunks=[],this.dataLength=0}var o=ChunkCache.prototype;return o.push=function push(o){this.chunks.push(o),this.dataLength+=o.length},o.flush=function flush(){var o,s=this.chunks,m=this.dataLength;return s.length?(o=1===s.length?s[0]:function concatUint8Arrays(o,s){for(var m=new Uint8Array(s),_=0,S=0;S<o.length;S++){var E=o[S];m.set(E,_),_+=E.length}return m}(s,m),this.reset(),o):new Uint8Array(0)},o.reset=function reset(){this.chunks.length=0,this.dataLength=0},ChunkCache}()},"./src/demux/dummy-demuxed-track.ts":
/*!******************************************!*\
    !*** ./src/demux/dummy-demuxed-track.ts ***!
    \******************************************/function srcDemuxDummyDemuxedTrackTs(o,s,m){function _dummyTrack(o,s){return void 0===o&&(o=""),void 0===s&&(s=9e4),{type:o,id:-1,pid:-1,inputTimeScale:s,sequenceNumber:-1,samples:[],dropped:0}}m.r(s),m.d(s,{dummyTrack:function dummyTrack(){return _dummyTrack}})},"./src/demux/exp-golomb.ts":
/*!*********************************!*\
    !*** ./src/demux/exp-golomb.ts ***!
    \*********************************/function srcDemuxExpGolombTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return E}});var _=m(/*! ../utils/logger */"./src/utils/logger.ts"),S=function(){function ExpGolomb(o){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=o,this.bytesAvailable=o.byteLength,this.word=0,this.bitsAvailable=0}var o=ExpGolomb.prototype;return o.loadWord=function loadWord(){var o=this.data,s=this.bytesAvailable,m=o.byteLength-s,_=new Uint8Array(4),S=Math.min(4,s);if(0===S)throw new Error("no bytes available");_.set(o.subarray(m,m+S)),this.word=new DataView(_.buffer).getUint32(0),this.bitsAvailable=8*S,this.bytesAvailable-=S},o.skipBits=function skipBits(o){var s;o=Math.min(o,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>o?(this.word<<=o,this.bitsAvailable-=o):(o-=this.bitsAvailable,o-=(s=o>>3)<<3,this.bytesAvailable-=s,this.loadWord(),this.word<<=o,this.bitsAvailable-=o)},o.readBits=function readBits(o){var s=Math.min(this.bitsAvailable,o),m=this.word>>>32-s;if(o>32&&_.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=s,this.bitsAvailable>0)this.word<<=s;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(s=o-s)>0&&this.bitsAvailable?m<<s|this.readBits(s):m},o.skipLZ=function skipLZ(){var o;for(o=0;o<this.bitsAvailable;++o)if(0!=(this.word&2147483648>>>o))return this.word<<=o,this.bitsAvailable-=o,o;return this.loadWord(),o+this.skipLZ()},o.skipUEG=function skipUEG(){this.skipBits(1+this.skipLZ())},o.skipEG=function skipEG(){this.skipBits(1+this.skipLZ())},o.readUEG=function readUEG(){var o=this.skipLZ();return this.readBits(o+1)-1},o.readEG=function readEG(){var o=this.readUEG();return 1&o?1+o>>>1:-1*(o>>>1)},o.readBoolean=function readBoolean(){return 1===this.readBits(1)},o.readUByte=function readUByte(){return this.readBits(8)},o.readUShort=function readUShort(){return this.readBits(16)},o.readUInt=function readUInt(){return this.readBits(32)},o.skipScalingList=function skipScalingList(o){for(var s=8,m=8,_=0;_<o;_++)0!==m&&(m=(s+this.readEG()+256)%256),s=0===m?s:m},o.readSPS=function readSPS(){var o,s,m,_=0,S=0,E=0,A=0,O=this.readUByte.bind(this),H=this.readBits.bind(this),K=this.readUEG.bind(this),z=this.readBoolean.bind(this),G=this.skipBits.bind(this),q=this.skipEG.bind(this),X=this.skipUEG.bind(this),J=this.skipScalingList.bind(this);O();var ae=O();if(H(5),G(3),O(),X(),100===ae||110===ae||122===ae||244===ae||44===ae||83===ae||86===ae||118===ae||128===ae){var pe=K();if(3===pe&&G(1),X(),X(),G(1),z())for(s=3!==pe?8:12,m=0;m<s;m++)z()&&J(m<6?16:64)}X();var me=K();if(0===me)K();else if(1===me)for(G(1),q(),q(),o=K(),m=0;m<o;m++)q();X(),G(1);var _e=K(),Se=K(),Ee=H(1);0===Ee&&G(1),G(1),z()&&(_=K(),S=K(),E=K(),A=K());var De=[1,1];if(z()&&z())switch(O()){case 1:De=[1,1];break;case 2:De=[12,11];break;case 3:De=[10,11];break;case 4:De=[16,11];break;case 5:De=[40,33];break;case 6:De=[24,11];break;case 7:De=[20,11];break;case 8:De=[32,11];break;case 9:De=[80,33];break;case 10:De=[18,11];break;case 11:De=[15,11];break;case 12:De=[64,33];break;case 13:De=[160,99];break;case 14:De=[4,3];break;case 15:De=[3,2];break;case 16:De=[2,1];break;case 255:De=[O()<<8|O(),O()<<8|O()]}return{width:Math.ceil(16*(_e+1)-2*_-2*S),height:(2-Ee)*(Se+1)*16-(Ee?2:4)*(E+A),pixelRatio:De}},o.readSliceType=function readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()},ExpGolomb}(),E=S},"./src/demux/id3.ts":
/*!**************************!*\
    !*** ./src/demux/id3.ts ***!
    \**************************/function srcDemuxId3Ts(o,s,m){m.r(s),m.d(s,{canParse:function canParse(){return H},decodeFrame:function decodeFrame(){return X},getID3Data:function getID3Data(){return A},getID3Frames:function getID3Frames(){return q},getTimeStamp:function getTimeStamp(){return K},isFooter:function isFooter(){return E},isHeader:function isHeader(){return S},isTimeStampFrame:function isTimeStampFrame(){return z},testables:function testables(){return Se},utf8ArrayToStr:function utf8ArrayToStr(){return _e}});var _,S=function isHeader(o,s){return s+10<=o.length&&73===o[s]&&68===o[s+1]&&51===o[s+2]&&o[s+3]<255&&o[s+4]<255&&o[s+6]<128&&o[s+7]<128&&o[s+8]<128&&o[s+9]<128},E=function isFooter(o,s){return s+10<=o.length&&51===o[s]&&68===o[s+1]&&73===o[s+2]&&o[s+3]<255&&o[s+4]<255&&o[s+6]<128&&o[s+7]<128&&o[s+8]<128&&o[s+9]<128},A=function getID3Data(o,s){for(var m=s,_=0;S(o,s);){_+=10,_+=O(o,s+6),E(o,s+10)&&(_+=10),s+=_}if(_>0)return o.subarray(m,m+_)},O=function readSize(o,s){var m=0;return m=(127&o[s])<<21,m|=(127&o[s+1])<<14,m|=(127&o[s+2])<<7,m|=127&o[s+3]},H=function canParse(o,s){return S(o,s)&&O(o,s+6)+10<=o.length-s},K=function getTimeStamp(o){for(var s=q(o),m=0;m<s.length;m++){var _=s[m];if(z(_))return me(_)}},z=function isTimeStampFrame(o){return o&&"PRIV"===o.key&&"com.apple.streaming.transportStreamTimestamp"===o.info},G=function getFrameData(o){var s=String.fromCharCode(o[0],o[1],o[2],o[3]),m=O(o,4);return{type:s,size:m,data:o.subarray(10,10+m)}},q=function getID3Frames(o){for(var s=0,m=[];S(o,s);){for(var _=O(o,s+6),A=(s+=10)+_;s+8<A;){var H=G(o.subarray(s)),K=X(H);K&&m.push(K),s+=H.size+10}E(o,s)&&(s+=10)}return m},X=function decodeFrame(o){return"PRIV"===o.type?J(o):"W"===o.type[0]?pe(o):ae(o)},J=function decodePrivFrame(o){if(!(o.size<2)){var s=_e(o.data,!0),m=new Uint8Array(o.data.subarray(s.length+1));return{key:o.type,info:s,data:m.buffer}}},ae=function decodeTextFrame(o){if(!(o.size<2)){if("TXXX"===o.type){var s=1,m=_e(o.data.subarray(s),!0);s+=m.length+1;var _=_e(o.data.subarray(s));return{key:o.type,info:m,data:_}}var S=_e(o.data.subarray(1));return{key:o.type,data:S}}},pe=function decodeURLFrame(o){if("WXXX"===o.type){if(o.size<2)return;var s=1,m=_e(o.data.subarray(s),!0);s+=m.length+1;var _=_e(o.data.subarray(s));return{key:o.type,info:m,data:_}}var S=_e(o.data);return{key:o.type,data:S}},me=function readTimeStamp(o){if(8===o.data.byteLength){var s=new Uint8Array(o.data),m=1&s[3],_=(s[4]<<23)+(s[5]<<15)+(s[6]<<7)+s[7];return _/=45,m&&(_+=47721858.84),Math.round(_)}},_e=function utf8ArrayToStr(o,s){void 0===s&&(s=!1);var m=getTextDecoder();if(m){var _=m.decode(o);if(s){var S=_.indexOf("\0");return-1!==S?_.substring(0,S):_}return _.replace(/\0/g,"")}for(var E,A,O,H=o.length,K="",z=0;z<H;){if(0===(E=o[z++])&&s)return K;if(0!==E&&3!==E)switch(E>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:K+=String.fromCharCode(E);break;case 12:case 13:A=o[z++],K+=String.fromCharCode((31&E)<<6|63&A);break;case 14:A=o[z++],O=o[z++],K+=String.fromCharCode((15&E)<<12|(63&A)<<6|(63&O)<<0)}}return K},Se={decodeTextFrame:ae};function getTextDecoder(){return _||void 0===self.TextDecoder||(_=new self.TextDecoder("utf-8")),_}},"./src/demux/mp3demuxer.ts":
/*!*********************************!*\
    !*** ./src/demux/mp3demuxer.ts ***!
    \*********************************/function srcDemuxMp3demuxerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return H}});var _=m(/*! ./base-audio-demuxer */"./src/demux/base-audio-demuxer.ts"),S=m(/*! ../demux/id3 */"./src/demux/id3.ts"),E=m(/*! ../utils/logger */"./src/utils/logger.ts"),A=m(/*! ./mpegaudio */"./src/demux/mpegaudio.ts");function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}var O=function(o){function MP3Demuxer(){return o.apply(this,arguments)||this}!function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(MP3Demuxer,o);var s=MP3Demuxer.prototype;return s.resetInitSegment=function resetInitSegment(s,m,_,S){o.prototype.resetInitSegment.call(this,s,m,_,S),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:m,duration:S,inputTimeScale:9e4,dropped:0}},MP3Demuxer.probe=function probe(o){if(!o)return!1;for(var s=(S.getID3Data(o,0)||[]).length,m=o.length;s<m;s++)if(A.probe(o,s))return E.logger.log("MPEG Audio sync word found !"),!0;return!1},s.canParse=function canParse(o,s){return A.canParse(o,s)},s.appendFrame=function appendFrame(o,s,m){if(null!==this.basePTS)return A.appendFrame(o,s,m,this.basePTS,this.frameIndex)},MP3Demuxer}(_.default),H=O},"./src/demux/mp4demuxer.ts":
/*!*********************************!*\
    !*** ./src/demux/mp4demuxer.ts ***!
    \*********************************/function srcDemuxMp4demuxerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return K}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../types/demuxer */"./src/types/demuxer.ts"),E=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),A=m(/*! ./dummy-demuxed-track */"./src/demux/dummy-demuxed-track.ts"),O=/\/emsg[-/]ID3/i,H=function(){function MP4Demuxer(o,s){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=s}var o=MP4Demuxer.prototype;return o.resetTimeStamp=function resetTimeStamp(){},o.resetInitSegment=function resetInitSegment(o,s,m,_){var S=this.videoTrack=(0,A.dummyTrack)("video",1),O=this.audioTrack=(0,A.dummyTrack)("audio",1),H=this.txtTrack=(0,A.dummyTrack)("text",1);if(this.id3Track=(0,A.dummyTrack)("id3",1),this.timeOffset=0,o&&o.byteLength){var K=(0,E.parseInitSegment)(o);if(K.video){var z=K.video,G=z.id,q=z.timescale,X=z.codec;S.id=G,S.timescale=H.timescale=q,S.codec=X}if(K.audio){var J=K.audio,ae=J.id,pe=J.timescale,me=J.codec;O.id=ae,O.timescale=pe,O.codec=me}H.id=E.RemuxerTrackIdConfig.text,S.sampleDuration=0,S.duration=O.duration=_}},o.resetContiguity=function resetContiguity(){},MP4Demuxer.probe=function probe(o){return o=o.length>16384?o.subarray(0,16384):o,(0,E.findBox)(o,["moof"]).length>0},o.demux=function demux(o,s){this.timeOffset=s;var m=o,_=this.videoTrack,S=this.txtTrack;if(this.config.progressive){this.remainderData&&(m=(0,E.appendUint8Array)(this.remainderData,o));var A=(0,E.segmentValidRange)(m);this.remainderData=A.remainder,_.samples=A.valid||new Uint8Array}else _.samples=m;var O=this.extractID3Track(_,s);return S.samples=(0,E.parseSamples)(s,_),{videoTrack:_,audioTrack:this.audioTrack,id3Track:O,textTrack:this.txtTrack}},o.flush=function flush(){var o=this.timeOffset,s=this.videoTrack,m=this.txtTrack;s.samples=this.remainderData||new Uint8Array,this.remainderData=null;var _=this.extractID3Track(s,this.timeOffset);return m.samples=(0,E.parseSamples)(o,s),{videoTrack:s,audioTrack:(0,A.dummyTrack)(),id3Track:_,textTrack:(0,A.dummyTrack)()}},o.extractID3Track=function extractID3Track(o,s){var m=this.id3Track;if(o.samples.length){var A=(0,E.findBox)(o.samples,["emsg"]);A&&A.forEach((function(o){var A=(0,E.parseEmsg)(o);if(O.test(A.schemeIdUri)){var H=(0,_.isFiniteNumber)(A.presentationTime)?A.presentationTime/A.timeScale:s+A.presentationTimeDelta/A.timeScale,K=4294967295===A.eventDuration?Number.POSITIVE_INFINITY:A.eventDuration/A.timeScale;K<=.001&&(K=Number.POSITIVE_INFINITY);var z=A.payload;m.samples.push({data:z,len:z.byteLength,dts:H,pts:H,type:S.MetadataSchema.emsg,duration:K})}}))}return m},o.demuxSampleAes=function demuxSampleAes(o,s,m){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},o.destroy=function destroy(){},MP4Demuxer}(),K=H},"./src/demux/mpegaudio.ts":
/*!********************************!*\
    !*** ./src/demux/mpegaudio.ts ***!
    \********************************/function srcDemuxMpegaudioTs(o,s,m){m.r(s),m.d(s,{appendFrame:function appendFrame(){return _appendFrame2},canParse:function canParse(){return _canParse3},isHeader:function isHeader(){return _isHeader3},isHeaderPattern:function isHeaderPattern(){return _isHeaderPattern2},parseHeader:function parseHeader(){return _parseHeader},probe:function probe(){return _probe2}});var _=null,S=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],E=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],A=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],O=[0,1,1,4];function _appendFrame2(o,s,m,_,S){if(!(m+24>s.length)){var E=_parseHeader(s,m);if(E&&m+E.frameLength<=s.length){var A=_+S*(9e4*E.samplesPerFrame/E.sampleRate),O={unit:s.subarray(m,m+E.frameLength),pts:A,dts:A};return o.config=[],o.channelCount=E.channelCount,o.samplerate=E.sampleRate,o.samples.push(O),{sample:O,length:E.frameLength,missing:0}}}}function _parseHeader(o,s){var m=o[s+1]>>3&3,H=o[s+1]>>1&3,K=o[s+2]>>4&15,z=o[s+2]>>2&3;if(1!==m&&0!==K&&15!==K&&3!==z){var G=o[s+2]>>1&1,q=o[s+3]>>6,X=1e3*S[14*(3===m?3-H:3===H?3:4)+K-1],J=E[3*(3===m?0:2===m?1:2)+z],ae=3===q?1:2,pe=A[m][H],me=O[H],_e=8*pe*me,Se=Math.floor(pe*X/J+G)*me;if(null===_){var Ee=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);_=Ee?parseInt(Ee[1]):0}return!!_&&_<=87&&2===H&&X>=224e3&&0===q&&(o[s+3]=128|o[s+3]),{sampleRate:J,channelCount:ae,frameLength:Se,samplesPerFrame:_e}}}function _isHeaderPattern2(o,s){return 255===o[s]&&224==(224&o[s+1])&&0!=(6&o[s+1])}function _isHeader3(o,s){return s+1<o.length&&_isHeaderPattern2(o,s)}function _canParse3(o,s){return _isHeaderPattern2(o,s)&&4<=o.length-s}function _probe2(o,s){if(s+1<o.length&&_isHeaderPattern2(o,s)){var m=_parseHeader(o,s),_=4;null!=m&&m.frameLength&&(_=m.frameLength);var S=s+_;return S===o.length||_isHeader3(o,S)}return!1}},"./src/demux/sample-aes.ts":
/*!*********************************!*\
    !*** ./src/demux/sample-aes.ts ***!
    \*********************************/function srcDemuxSampleAesTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return A}});var _=m(/*! ../crypt/decrypter */"./src/crypt/decrypter.ts"),S=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),E=function(){function SampleAesDecrypter(o,s,m){this.keyData=void 0,this.decrypter=void 0,this.keyData=m,this.decrypter=new _.default(s,{removePKCS7Padding:!1})}var o=SampleAesDecrypter.prototype;return o.decryptBuffer=function decryptBuffer(o){return this.decrypter.decrypt(o,this.keyData.key.buffer,this.keyData.iv.buffer)},o.decryptAacSample=function decryptAacSample(o,s,m){var _=this,S=o[s].unit;if(!(S.length<=16)){var E=S.subarray(16,S.length-S.length%16),A=E.buffer.slice(E.byteOffset,E.byteOffset+E.length);this.decryptBuffer(A).then((function(E){var A=new Uint8Array(E);S.set(A,16),_.decrypter.isSync()||_.decryptAacSamples(o,s+1,m)}))}},o.decryptAacSamples=function decryptAacSamples(o,s,m){for(;;s++){if(s>=o.length)return void m();if(!(o[s].unit.length<32)&&(this.decryptAacSample(o,s,m),!this.decrypter.isSync()))return}},o.getAvcEncryptedData=function getAvcEncryptedData(o){for(var s=16*Math.floor((o.length-48)/160)+16,m=new Int8Array(s),_=0,S=32;S<o.length-16;S+=160,_+=16)m.set(o.subarray(S,S+16),_);return m},o.getAvcDecryptedUnit=function getAvcDecryptedUnit(o,s){for(var m=new Uint8Array(s),_=0,S=32;S<o.length-16;S+=160,_+=16)o.set(m.subarray(_,_+16),S);return o},o.decryptAvcSample=function decryptAvcSample(o,s,m,_,E){var A=this,O=(0,S.discardEPB)(E.data),H=this.getAvcEncryptedData(O);this.decryptBuffer(H.buffer).then((function(S){E.data=A.getAvcDecryptedUnit(O,S),A.decrypter.isSync()||A.decryptAvcSamples(o,s,m+1,_)}))},o.decryptAvcSamples=function decryptAvcSamples(o,s,m,_){if(o instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;s++,m=0){if(s>=o.length)return void _();for(var S=o[s].units;!(m>=S.length);m++){var E=S[m];if(!(E.data.length<=48||1!==E.type&&5!==E.type||(this.decryptAvcSample(o,s,m,_,E),this.decrypter.isSync())))return}}},SampleAesDecrypter}(),A=E},"./src/demux/transmuxer-interface.ts":
/*!*******************************************!*\
    !*** ./src/demux/transmuxer-interface.ts ***!
    \*******************************************/function srcDemuxTransmuxerInterfaceTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return G}});var _=m(/*! ./webworkify-webpack */"./src/demux/webworkify-webpack.js"),S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../demux/transmuxer */"./src/demux/transmuxer.ts"),A=m(/*! ../utils/logger */"./src/utils/logger.ts"),O=m(/*! ../errors */"./src/errors.ts"),H=m(/*! ../utils/mediasource-helper */"./src/utils/mediasource-helper.ts"),K=m(/*! eventemitter3 */"./node_modules/eventemitter3/index.js"),z=(0,H.getMediaSource)()||{isTypeSupported:function isTypeSupported(){return!1}},G=function(){function TransmuxerInterface(o,s,m,H){var G=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var q=o.config;this.hls=o,this.id=s,this.useWorker=!!q.enableWorker,this.onTransmuxComplete=m,this.onFlush=H;var X=function forwardMessage(o,s){(s=s||{}).frag=G.frag,s.id=G.id,G.hls.trigger(o,s)};this.observer=new K.EventEmitter,this.observer.on(S.Events.FRAG_DECRYPTED,X),this.observer.on(S.Events.ERROR,X);var J={mp4:z.isTypeSupported("video/mp4"),mpeg:z.isTypeSupported("audio/mpeg"),mp3:z.isTypeSupported('audio/mp4; codecs="mp3"')},ae=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker){var pe;A.logger.log("demuxing in webworker");try{pe=this.worker=(0,_.default)(/*! ../demux/transmuxer-worker.ts */"./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),pe.addEventListener("message",this.onwmsg),pe.onerror=function(o){G.useWorker=!1,A.logger.warn("Exception in webworker, fallback to inline"),G.hls.trigger(S.Events.ERROR,{type:O.ErrorTypes.OTHER_ERROR,details:O.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(o.message+"  ("+o.filename+":"+o.lineno+")")})},pe.postMessage({cmd:"init",typeSupported:J,vendor:ae,id:s,config:JSON.stringify(q)})}catch(o){A.logger.warn("Error in worker:",o),A.logger.error("Error while initializing DemuxerWorker, fallback to inline"),pe&&self.URL.revokeObjectURL(pe.objectURL),this.transmuxer=new E.default(this.observer,J,q,ae,s),this.worker=null}}else this.transmuxer=new E.default(this.observer,J,q,ae,s)}var o=TransmuxerInterface.prototype;return o.destroy=function destroy(){var o=this.worker;if(o)o.removeEventListener("message",this.onwmsg),o.terminate(),this.worker=null,this.onwmsg=void 0;else{var s=this.transmuxer;s&&(s.destroy(),this.transmuxer=null)}var m=this.observer;m&&m.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},o.push=function push(o,s,m,_,S,O,H,K,z,G){var q,X,J=this;z.transmuxing.start=self.performance.now();var ae=this.transmuxer,pe=this.worker,me=O?O.start:S.start,_e=S.decryptdata,Se=this.frag,Ee=!(Se&&S.cc===Se.cc),De=!(Se&&z.level===Se.level),$e=Se?z.sn-Se.sn:-1,He=this.part?z.part-this.part.index:-1,et=0===$e&&z.id>1&&z.id===(null==Se?void 0:Se.stats.chunkCount),rt=!De&&(1===$e||0===$e&&(1===He||et&&He<=0)),it=self.performance.now();(De||$e||0===S.stats.parsing.start)&&(S.stats.parsing.start=it),!O||!He&&rt||(O.stats.parsing.start=it);var at=!(Se&&(null===(q=S.initSegment)||void 0===q?void 0:q.url)===(null===(X=Se.initSegment)||void 0===X?void 0:X.url)),ot=new E.TransmuxState(Ee,rt,K,De,me,at);if(!rt||Ee||at){A.logger.log("[transmuxer-interface, "+S.type+"]: Starting new transmux session for sn: "+z.sn+" p: "+z.part+" level: "+z.level+" id: "+z.id+"\n        discontinuity: "+Ee+"\n        trackSwitch: "+De+"\n        contiguous: "+rt+"\n        accurateTimeOffset: "+K+"\n        timeOffset: "+me+"\n        initSegmentChange: "+at);var st=new E.TransmuxConfig(m,_,s,H,G);this.configureTransmuxer(st)}if(this.frag=S,this.part=O,pe)pe.postMessage({cmd:"demux",data:o,decryptdata:_e,chunkMeta:z,state:ot},o instanceof ArrayBuffer?[o]:[]);else if(ae){var ut=ae.push(o,_e,z,ot);(0,E.isPromise)(ut)?(ae.async=!0,ut.then((function(o){J.handleTransmuxComplete(o)})).catch((function(o){J.transmuxerError(o,z,"transmuxer-interface push error")}))):(ae.async=!1,this.handleTransmuxComplete(ut))}},o.flush=function flush(o){var s=this;o.transmuxing.start=self.performance.now();var m=this.transmuxer,_=this.worker;if(_)_.postMessage({cmd:"flush",chunkMeta:o});else if(m){var S=m.flush(o);(0,E.isPromise)(S)||m.async?((0,E.isPromise)(S)||(S=Promise.resolve(S)),S.then((function(m){s.handleFlushResult(m,o)})).catch((function(m){s.transmuxerError(m,o,"transmuxer-interface flush error")}))):this.handleFlushResult(S,o)}},o.transmuxerError=function transmuxerError(o,s,m){this.hls&&this.hls.trigger(S.Events.ERROR,{type:O.ErrorTypes.MEDIA_ERROR,details:O.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:s,fatal:!1,error:o,err:o,reason:m})},o.handleFlushResult=function handleFlushResult(o,s){var m=this;o.forEach((function(o){m.handleTransmuxComplete(o)})),this.onFlush(s)},o.onWorkerMessage=function onWorkerMessage(o){var s=o.data,m=this.hls;switch(s.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(s.data);break;case"flush":this.onFlush(s.data);break;case"workerLog":A.logger[s.data.logType]&&A.logger[s.data.logType](s.data.message);break;default:s.data=s.data||{},s.data.frag=this.frag,s.data.id=this.id,m.trigger(s.event,s.data)}},o.configureTransmuxer=function configureTransmuxer(o){var s=this.worker,m=this.transmuxer;s?s.postMessage({cmd:"configure",config:o}):m&&m.configure(o)},o.handleTransmuxComplete=function handleTransmuxComplete(o){o.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(o)},TransmuxerInterface}()},"./src/demux/transmuxer-worker.ts":
/*!****************************************!*\
    !*** ./src/demux/transmuxer-worker.ts ***!
    \****************************************/function srcDemuxTransmuxerWorkerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return TransmuxerWorker}});var _=m(/*! ../demux/transmuxer */"./src/demux/transmuxer.ts"),S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../utils/logger */"./src/utils/logger.ts"),A=m(/*! eventemitter3 */"./node_modules/eventemitter3/index.js"),O=m(/*! ../errors */"./src/errors.ts");function TransmuxerWorker(o){var s=new A.EventEmitter,m=function forwardMessage(s,m){o.postMessage({event:s,data:m})};s.on(S.Events.FRAG_DECRYPTED,m),s.on(S.Events.ERROR,m);o.addEventListener("message",(function(A){var H=A.data;switch(H.cmd){case"init":var K=JSON.parse(H.config);o.transmuxer=new _.default(s,H.typeSupported,K,H.vendor,H.id),(0,E.enableLogs)(K.debug,H.id),function forwardWorkerLogs(){var o=function _loop(o){E.logger[o]=function func(s){m("workerLog",{logType:o,message:s})}};for(var s in E.logger)o(s)}(),m("init",null);break;case"configure":o.transmuxer.configure(H.config);break;case"demux":var z=o.transmuxer.push(H.data,H.decryptdata,H.chunkMeta,H.state);(0,_.isPromise)(z)?(o.transmuxer.async=!0,z.then((function(s){emitTransmuxComplete(o,s)})).catch((function(o){m(S.Events.ERROR,{type:O.ErrorTypes.MEDIA_ERROR,details:O.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:H.chunkMeta,fatal:!1,error:o,err:o,reason:"transmuxer-worker push error"})}))):(o.transmuxer.async=!1,emitTransmuxComplete(o,z));break;case"flush":var G=H.chunkMeta,q=o.transmuxer.flush(G);(0,_.isPromise)(q)||o.transmuxer.async?((0,_.isPromise)(q)||(q=Promise.resolve(q)),q.then((function(s){handleFlushResult(o,s,G)})).catch((function(o){m(S.Events.ERROR,{type:O.ErrorTypes.MEDIA_ERROR,details:O.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:H.chunkMeta,fatal:!1,error:o,err:o,reason:"transmuxer-worker flush error"})}))):handleFlushResult(o,q,G)}}))}function emitTransmuxComplete(o,s){if(function isEmptyResult(o){return!(o.audio||o.video||o.text||o.id3||o.initSegment)}(s.remuxResult))return!1;var m=[],_=s.remuxResult,S=_.audio,E=_.video;return S&&addToTransferable(m,S),E&&addToTransferable(m,E),o.postMessage({event:"transmuxComplete",data:s},m),!0}function addToTransferable(o,s){s.data1&&o.push(s.data1.buffer),s.data2&&o.push(s.data2.buffer)}function handleFlushResult(o,s,m){s.reduce((function(s,m){return emitTransmuxComplete(o,m)||s}),!1)||o.postMessage({event:"transmuxComplete",data:s[0]}),o.postMessage({event:"flush",data:m})}},"./src/demux/transmuxer.ts":
/*!*********************************!*\
    !*** ./src/demux/transmuxer.ts ***!
    \*********************************/function srcDemuxTransmuxerTs(o,s,m){m.r(s),m.d(s,{TransmuxConfig:function TransmuxConfig(){return me},TransmuxState:function TransmuxState(){return _e},default:function _default(){return ae},isPromise:function isPromise(){return _isPromise}});var _,S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../errors */"./src/errors.ts"),A=m(/*! ../crypt/decrypter */"./src/crypt/decrypter.ts"),O=m(/*! ../demux/aacdemuxer */"./src/demux/aacdemuxer.ts"),H=m(/*! ../demux/mp4demuxer */"./src/demux/mp4demuxer.ts"),K=m(/*! ../demux/tsdemuxer */"./src/demux/tsdemuxer.ts"),z=m(/*! ../demux/mp3demuxer */"./src/demux/mp3demuxer.ts"),G=m(/*! ../remux/mp4-remuxer */"./src/remux/mp4-remuxer.ts"),q=m(/*! ../remux/passthrough-remuxer */"./src/remux/passthrough-remuxer.ts"),X=m(/*! ../utils/logger */"./src/utils/logger.ts");try{_=self.performance.now.bind(self.performance)}catch(o){X.logger.debug("Unable to use Performance API on this environment"),_=self.Date.now}var J=[{demux:H.default,remux:q.default},{demux:K.default,remux:G.default},{demux:O.default,remux:G.default},{demux:z.default,remux:G.default}],ae=function(){function Transmuxer(o,s,m,_,S){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=o,this.typeSupported=s,this.config=m,this.vendor=_,this.id=S}var o=Transmuxer.prototype;return o.configure=function configure(o){this.transmuxConfig=o,this.decrypter&&this.decrypter.reset()},o.push=function push(o,s,m,S){var E=this,A=m.transmuxing;A.executeStart=_();var O=new Uint8Array(o),H=this.currentTransmuxState,K=this.transmuxConfig;S&&(this.currentTransmuxState=S);var z=S||H,G=z.contiguous,q=z.discontinuity,X=z.trackSwitch,J=z.accurateTimeOffset,ae=z.timeOffset,me=z.initSegmentChange,_e=K.audioCodec,Se=K.videoCodec,Ee=K.defaultInitPts,De=K.duration,$e=K.initSegmentData,He=function getEncryptionType(o,s){var m=null;o.byteLength>0&&null!=s&&null!=s.key&&null!==s.iv&&null!=s.method&&(m=s);return m}(O,s);if(He&&"AES-128"===He.method){var et=this.getDecrypter();if(!et.isSync())return this.decryptionPromise=et.webCryptoDecrypt(O,He.key.buffer,He.iv.buffer).then((function(o){var s=E.push(o,null,m);return E.decryptionPromise=null,s})),this.decryptionPromise;var rt=et.softwareDecrypt(O,He.key.buffer,He.iv.buffer);if(m.part>-1&&(rt=et.flush()),!rt)return A.executeEnd=_(),pe(m);O=new Uint8Array(rt)}var it=this.needsProbing(q,X);it&&this.configureTransmuxer(O),(q||X||me||it)&&this.resetInitSegment($e,_e,Se,De,s),(q||me||it)&&this.resetInitialTimestamp(Ee),G||this.resetContiguity();var at=this.transmux(O,He,ae,J,m),ot=this.currentTransmuxState;return ot.contiguous=!0,ot.discontinuity=!1,ot.trackSwitch=!1,A.executeEnd=_(),at},o.flush=function flush(o){var s=this,m=o.transmuxing;m.executeStart=_();var A=this.decrypter,O=this.currentTransmuxState,H=this.decryptionPromise;if(H)return H.then((function(){return s.flush(o)}));var K=[],z=O.timeOffset;if(A){var G=A.flush();G&&K.push(this.push(G,null,o))}var q=this.demuxer,X=this.remuxer;if(!q||!X)return this.observer.emit(S.Events.ERROR,S.Events.ERROR,{type:E.ErrorTypes.MEDIA_ERROR,details:E.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),m.executeEnd=_(),[pe(o)];var J=q.flush(z);return _isPromise(J)?J.then((function(m){return s.flushRemux(K,m,o),K})):(this.flushRemux(K,J,o),K)},o.flushRemux=function flushRemux(o,s,m){var S=s.audioTrack,E=s.videoTrack,A=s.id3Track,O=s.textTrack,H=this.currentTransmuxState,K=H.accurateTimeOffset,z=H.timeOffset;X.logger.log("[transmuxer.ts]: Flushed fragment "+m.sn+(m.part>-1?" p: "+m.part:"")+" of level "+m.level);var G=this.remuxer.remux(S,E,A,O,z,K,!0,this.id);o.push({remuxResult:G,chunkMeta:m}),m.transmuxing.executeEnd=_()},o.resetInitialTimestamp=function resetInitialTimestamp(o){var s=this.demuxer,m=this.remuxer;s&&m&&(s.resetTimeStamp(o),m.resetTimeStamp(o))},o.resetContiguity=function resetContiguity(){var o=this.demuxer,s=this.remuxer;o&&s&&(o.resetContiguity(),s.resetNextTimestamp())},o.resetInitSegment=function resetInitSegment(o,s,m,_,S){var E=this.demuxer,A=this.remuxer;E&&A&&(E.resetInitSegment(o,s,m,_),A.resetInitSegment(o,s,m,S))},o.destroy=function destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},o.transmux=function transmux(o,s,m,_,S){return s&&"SAMPLE-AES"===s.method?this.transmuxSampleAes(o,s,m,_,S):this.transmuxUnencrypted(o,m,_,S)},o.transmuxUnencrypted=function transmuxUnencrypted(o,s,m,_){var S=this.demuxer.demux(o,s,!1,!this.config.progressive),E=S.audioTrack,A=S.videoTrack,O=S.id3Track,H=S.textTrack;return{remuxResult:this.remuxer.remux(E,A,O,H,s,m,!1,this.id),chunkMeta:_}},o.transmuxSampleAes=function transmuxSampleAes(o,s,m,_,S){var E=this;return this.demuxer.demuxSampleAes(o,s,m).then((function(o){return{remuxResult:E.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,m,_,!1,E.id),chunkMeta:S}}))},o.configureTransmuxer=function configureTransmuxer(o){for(var s,m=this.config,_=this.observer,S=this.typeSupported,E=this.vendor,A=0,O=J.length;A<O;A++)if(J[A].demux.probe(o)){s=J[A];break}s||(X.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),s={demux:H.default,remux:q.default});var K=this.demuxer,z=this.remuxer,G=s.remux,ae=s.demux;z&&z instanceof G||(this.remuxer=new G(_,m,S,E)),K&&K instanceof ae||(this.demuxer=new ae(_,m,S),this.probe=ae.probe)},o.needsProbing=function needsProbing(o,s){return!this.demuxer||!this.remuxer||o||s},o.getDecrypter=function getDecrypter(){var o=this.decrypter;return o||(o=this.decrypter=new A.default(this.config)),o},Transmuxer}();var pe=function emptyResult(o){return{remuxResult:{},chunkMeta:o}};function _isPromise(o){return"then"in o&&o.then instanceof Function}var me=function TransmuxConfig(o,s,m,_,S){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=o,this.videoCodec=s,this.initSegmentData=m,this.duration=_,this.defaultInitPts=S},_e=function TransmuxState(o,s,m,_,S,E){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=o,this.contiguous=s,this.accurateTimeOffset=m,this.trackSwitch=_,this.timeOffset=S,this.initSegmentChange=E}},"./src/demux/tsdemuxer.ts":
/*!********************************!*\
    !*** ./src/demux/tsdemuxer.ts ***!
    \********************************/function srcDemuxTsdemuxerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return J}});var _=m(/*! ./adts */"./src/demux/adts.ts"),S=m(/*! ./mpegaudio */"./src/demux/mpegaudio.ts"),E=m(/*! ./exp-golomb */"./src/demux/exp-golomb.ts"),A=m(/*! ./sample-aes */"./src/demux/sample-aes.ts"),O=m(/*! ../events */"./src/events.ts"),H=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),K=m(/*! ../utils/logger */"./src/utils/logger.ts"),z=m(/*! ../errors */"./src/errors.ts"),G=m(/*! ../types/demuxer */"./src/types/demuxer.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}var q=188,X=function(){function TSDemuxer(o,s,m){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=o,this.config=s,this.typeSupported=m}TSDemuxer.probe=function probe(o){var s=TSDemuxer.syncOffset(o);return s>0&&K.logger.warn("MPEG2-TS detected but first sync word found @ offset "+s),-1!==s},TSDemuxer.syncOffset=function syncOffset(o){for(var s=o.length,m=Math.min(940,o.length-q)+1,_=0;_<m;){for(var S=!1,E=_;E<s&&71===o[E];E+=q)if(S||0!==parsePID(o,E)||(S=!0),S&&E+q>m)return _;_++}return-1},TSDemuxer.createTrack=function createTrack(o,s){return{container:"video"===o||"audio"===o?"video/mp2t":void 0,type:o,id:H.RemuxerTrackIdConfig[o],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===o?s:void 0}};var o=TSDemuxer.prototype;return o.resetInitSegment=function resetInitSegment(o,s,m,_){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=TSDemuxer.createTrack("video"),this._audioTrack=TSDemuxer.createTrack("audio",_),this._id3Track=TSDemuxer.createTrack("id3"),this._txtTrack=TSDemuxer.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=s,this.videoCodec=m,this._duration=_},o.resetTimeStamp=function resetTimeStamp(){},o.resetContiguity=function resetContiguity(){var o=this._audioTrack,s=this._avcTrack,m=this._id3Track;o&&(o.pesData=null),s&&(s.pesData=null),m&&(m.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},o.demux=function demux(o,s,m,_){var S;void 0===m&&(m=!1),void 0===_&&(_=!1),m||(this.sampleAes=null);var E=this._avcTrack,A=this._audioTrack,G=this._id3Track,X=this._txtTrack,J=E.pid,ae=E.pesData,pe=A.pid,me=G.pid,_e=A.pesData,Se=G.pesData,Ee=null,De=this.pmtParsed,$e=this._pmtId,He=o.length;if(this.remainderData&&(He=(o=(0,H.appendUint8Array)(this.remainderData,o)).length,this.remainderData=null),He<q&&!_)return this.remainderData=o,{audioTrack:A,videoTrack:E,id3Track:G,textTrack:X};var et=Math.max(0,TSDemuxer.syncOffset(o));(He-=(He-et)%q)<o.byteLength&&!_&&(this.remainderData=new Uint8Array(o.buffer,He,o.buffer.byteLength-He));for(var rt=0,it=et;it<He;it+=q)if(71===o[it]){var at=!!(64&o[it+1]),ot=parsePID(o,it),st=void 0;if((48&o[it+3])>>4>1){if((st=it+5+o[it+4])===it+q)continue}else st=it+4;switch(ot){case J:at&&(ae&&(S=parsePES(ae))&&this.parseAVCPES(E,X,S,!1),ae={data:[],size:0}),ae&&(ae.data.push(o.subarray(st,it+q)),ae.size+=it+q-st);break;case pe:if(at){if(_e&&(S=parsePES(_e)))switch(A.segmentCodec){case"aac":this.parseAACPES(A,S);break;case"mp3":this.parseMPEGPES(A,S)}_e={data:[],size:0}}_e&&(_e.data.push(o.subarray(st,it+q)),_e.size+=it+q-st);break;case me:at&&(Se&&(S=parsePES(Se))&&this.parseID3PES(G,S),Se={data:[],size:0}),Se&&(Se.data.push(o.subarray(st,it+q)),Se.size+=it+q-st);break;case 0:at&&(st+=o[st]+1),$e=this._pmtId=parsePAT(o,st);break;case $e:at&&(st+=o[st]+1);var ut=parsePMT(o,st,this.typeSupported,m);(J=ut.avc)>0&&(E.pid=J),(pe=ut.audio)>0&&(A.pid=pe,A.segmentCodec=ut.segmentCodec),(me=ut.id3)>0&&(G.pid=me),null===Ee||De||(K.logger.warn("MPEG-TS PMT found at "+it+" after unknown PID '"+Ee+"'. Backtracking to sync byte @"+et+" to parse all TS packets."),Ee=null,it=et-188),De=this.pmtParsed=!0;break;case 17:case 8191:break;default:Ee=ot}}else rt++;rt>0&&this.observer.emit(O.Events.ERROR,O.Events.ERROR,{type:z.ErrorTypes.MEDIA_ERROR,details:z.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+rt+" TS packet/s that do not start with 0x47"}),E.pesData=ae,A.pesData=_e,G.pesData=Se;var ct={audioTrack:A,videoTrack:E,id3Track:G,textTrack:X};return _&&this.extractRemainingSamples(ct),ct},o.flush=function flush(){var o,s=this.remainderData;return this.remainderData=null,o=s?this.demux(s,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(o),this.sampleAes?this.decrypt(o,this.sampleAes):o},o.extractRemainingSamples=function extractRemainingSamples(o){var s,m=o.audioTrack,_=o.videoTrack,S=o.id3Track,E=o.textTrack,A=_.pesData,O=m.pesData,H=S.pesData;if(A&&(s=parsePES(A))?(this.parseAVCPES(_,E,s,!0),_.pesData=null):_.pesData=A,O&&(s=parsePES(O))){switch(m.segmentCodec){case"aac":this.parseAACPES(m,s);break;case"mp3":this.parseMPEGPES(m,s)}m.pesData=null}else null!=O&&O.size&&K.logger.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=O;H&&(s=parsePES(H))?(this.parseID3PES(S,s),S.pesData=null):S.pesData=H},o.demuxSampleAes=function demuxSampleAes(o,s,m){var _=this.demux(o,m,!0,!this.config.progressive),S=this.sampleAes=new A.default(this.observer,this.config,s);return this.decrypt(_,S)},o.decrypt=function decrypt(o,s){return new Promise((function(m){var _=o.audioTrack,S=o.videoTrack;_.samples&&"aac"===_.segmentCodec?s.decryptAacSamples(_.samples,0,(function(){S.samples?s.decryptAvcSamples(S.samples,0,0,(function(){m(o)})):m(o)})):S.samples&&s.decryptAvcSamples(S.samples,0,0,(function(){m(o)}))}))},o.destroy=function destroy(){this._duration=0},o.parseAVCPES=function parseAVCPES(o,s,m,_){var S,A=this,O=this.parseAVCNALu(o,m.data),K=this.avcSample,z=!1;m.data=null,K&&O.length&&!o.audFound&&(pushAccessUnit(K,o),K=this.avcSample=createAVCSample(!1,m.pts,m.dts,"")),O.forEach((function(_){switch(_.type){case 1:S=!0,K||(K=A.avcSample=createAVCSample(!0,m.pts,m.dts,"")),K.frame=!0;var O=_.data;if(z&&O.length>4){var G=new E.default(O).readSliceType();2!==G&&4!==G&&7!==G&&9!==G||(K.key=!0)}break;case 5:S=!0,K||(K=A.avcSample=createAVCSample(!0,m.pts,m.dts,"")),K.key=!0,K.frame=!0;break;case 6:S=!0,(0,H.parseSEIMessageFromNALu)(_.data,1,m.pts,s.samples);break;case 7:if(S=!0,z=!0,!o.sps){var q=new E.default(_.data).readSPS();o.width=q.width,o.height=q.height,o.pixelRatio=q.pixelRatio,o.sps=[_.data],o.duration=A._duration;for(var X=_.data.subarray(1,4),J="avc1.",ae=0;ae<3;ae++){var pe=X[ae].toString(16);pe.length<2&&(pe="0"+pe),J+=pe}o.codec=J}break;case 8:S=!0,o.pps||(o.pps=[_.data]);break;case 9:S=!1,o.audFound=!0,K&&pushAccessUnit(K,o),K=A.avcSample=createAVCSample(!1,m.pts,m.dts,"");break;case 12:S=!0;break;default:S=!1,K&&(K.debug+="unknown NAL "+_.type+" ")}K&&S&&K.units.push(_)})),_&&K&&(pushAccessUnit(K,o),this.avcSample=null)},o.getLastNalUnit=function getLastNalUnit(o){var s,m,_=this.avcSample;if(_&&0!==_.units.length||(_=o[o.length-1]),null!==(s=_)&&void 0!==s&&s.units){var S=_.units;m=S[S.length-1]}return m},o.parseAVCNALu=function parseAVCNALu(o,s){var m,_,S=s.byteLength,E=o.naluState||0,A=E,O=[],H=0,K=-1,z=0;for(-1===E&&(K=0,z=31&s[0],E=0,H=1);H<S;)if(m=s[H++],E)if(1!==E)if(m)if(1===m){if(K>=0){var G={data:s.subarray(K,H-E-1),type:z};O.push(G)}else{var q=this.getLastNalUnit(o.samples);if(q&&(A&&H<=4-A&&q.state&&(q.data=q.data.subarray(0,q.data.byteLength-A)),(_=H-E-1)>0)){var X=new Uint8Array(q.data.byteLength+_);X.set(q.data,0),X.set(s.subarray(0,_),q.data.byteLength),q.data=X,q.state=0}}H<S?(K=H,z=31&s[H],E=0):E=-1}else E=0;else E=3;else E=m?0:2;else E=m?0:1;if(K>=0&&E>=0){var J={data:s.subarray(K,S),type:z,state:E};O.push(J)}if(0===O.length){var ae=this.getLastNalUnit(o.samples);if(ae){var pe=new Uint8Array(ae.data.byteLength+s.byteLength);pe.set(ae.data,0),pe.set(s,ae.data.byteLength),ae.data=pe}}return o.naluState=E,O},o.parseAACPES=function parseAACPES(o,s){var m,S,E,A,H,G=0,q=this.aacOverFlow,X=s.data;if(q){this.aacOverFlow=null;var J=q.missing,ae=q.sample.unit.byteLength;if(-1===J){var pe=new Uint8Array(ae+X.byteLength);pe.set(q.sample.unit,0),pe.set(X,ae),X=pe}else{var me=ae-J;q.sample.unit.set(X.subarray(0,J),me),o.samples.push(q.sample),G=q.missing}}for(m=G,S=X.length;m<S-1&&!_.isHeader(X,m);m++);if(m!==G&&(m<S-1?(E="AAC PES did not start with ADTS header,offset:"+m,A=!1):(E="no ADTS header found in AAC PES",A=!0),K.logger.warn("parsing error:"+E),this.observer.emit(O.Events.ERROR,O.Events.ERROR,{type:z.ErrorTypes.MEDIA_ERROR,details:z.ErrorDetails.FRAG_PARSING_ERROR,fatal:A,reason:E}),A))return;if(_.initTrackConfig(o,this.observer,X,m,this.audioCodec),void 0!==s.pts)H=s.pts;else{if(!q)return void K.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var _e=_.getFrameDuration(o.samplerate);H=q.sample.pts+_e}for(var Se,Ee=0;m<S;){if(m+=(Se=_.appendFrame(o,X,m,H,Ee)).length,Se.missing){this.aacOverFlow=Se;break}for(Ee++;m<S-1&&!_.isHeader(X,m);m++);}},o.parseMPEGPES=function parseMPEGPES(o,s){var m=s.data,_=m.length,E=0,A=0,O=s.pts;if(void 0!==O)for(;A<_;)if(S.isHeader(m,A)){var H=S.appendFrame(o,m,A,O,E);if(!H)break;A+=H.length,E++}else A++;else K.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},o.parseID3PES=function parseID3PES(o,s){if(void 0!==s.pts){var m=_extends({},s,{type:this._avcTrack?G.MetadataSchema.emsg:G.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});o.samples.push(m)}else K.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},TSDemuxer}();function createAVCSample(o,s,m,_){return{key:o,frame:!1,pts:s,dts:m,units:[],debug:_,length:0}}function parsePID(o,s){return((31&o[s+1])<<8)+o[s+2]}function parsePAT(o,s){return(31&o[s+10])<<8|o[s+11]}function parsePMT(o,s,m,_){var S={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},E=s+3+((15&o[s+1])<<8|o[s+2])-4;for(s+=12+((15&o[s+10])<<8|o[s+11]);s<E;){var A=parsePID(o,s);switch(o[s]){case 207:if(!_){K.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===S.audio&&(S.audio=A);break;case 21:-1===S.id3&&(S.id3=A);break;case 219:if(!_){K.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===S.avc&&(S.avc=A);break;case 3:case 4:!0!==m.mpeg&&!0!==m.mp3?K.logger.log("MPEG audio found, not supported in this browser"):-1===S.audio&&(S.audio=A,S.segmentCodec="mp3");break;case 36:K.logger.warn("Unsupported HEVC stream type found")}s+=5+((15&o[s+3])<<8|o[s+4])}return S}function parsePES(o){var s,m,_,S,E,A=0,O=o.data;if(!o||0===o.size)return null;for(;O[0].length<19&&O.length>1;){var H=new Uint8Array(O[0].length+O[1].length);H.set(O[0]),H.set(O[1],O[0].length),O[0]=H,O.splice(1,1)}if(1===((s=O[0])[0]<<16)+(s[1]<<8)+s[2]){if((m=(s[4]<<8)+s[5])&&m>o.size-6)return null;var z=s[7];192&z&&(S=536870912*(14&s[9])+4194304*(255&s[10])+16384*(254&s[11])+128*(255&s[12])+(254&s[13])/2,64&z?S-(E=536870912*(14&s[14])+4194304*(255&s[15])+16384*(254&s[16])+128*(255&s[17])+(254&s[18])/2)>54e5&&(K.logger.warn(Math.round((S-E)/9e4)+"s delta between PTS and DTS, align them"),S=E):E=S);var G=(_=s[8])+9;if(o.size<=G)return null;o.size-=G;for(var q=new Uint8Array(o.size),X=0,J=O.length;X<J;X++){var ae=(s=O[X]).byteLength;if(G){if(G>ae){G-=ae;continue}s=s.subarray(G),ae-=G,G=0}q.set(s,A),A+=ae}return m&&(m-=_+3),{data:q,pts:S,dts:E,len:m}}return null}function pushAccessUnit(o,s){if(o.units.length&&o.frame){if(void 0===o.pts){var m=s.samples,_=m.length;if(!_)return void s.dropped++;var S=m[_-1];o.pts=S.pts,o.dts=S.dts}s.samples.push(o)}o.debug.length&&K.logger.log(o.pts+"/"+o.dts+":"+o.debug)}var J=X},"./src/demux/webworkify-webpack.js":
/*!*****************************************!*\
    !*** ./src/demux/webworkify-webpack.js ***!
    \*****************************************/function srcDemuxWebworkifyWebpackJs(o,s,m){m.r(s),m.d(s,{default:function _default(){return __WEBPACK_DEFAULT_EXPORT__}});var _=function webpackBootstrapFunc(){var o=ENTRY_MODULE,s={},m=function __webpack_require__(m){var _=s[m];if(void 0!==_)return _.exports;var S=s[m]={exports:{}};return o[m].call(S.exports,S,S.exports,__webpack_require__),S.exports};m.m=o,m.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return m.d(s,{a:s}),s},m.d=function(o,s){for(var _ in s)m.o(s,_)&&!m.o(o,_)&&Object.defineProperty(o,_,{enumerable:!0,get:s[_]})},m.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},m.r=function(o){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var _=m(ENTRY_MODULE);return _.default||_}.toString().split("ENTRY_MODULE"),S="[\\.|\\-|\\+|\\w|/|@]+",E="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+S+").*?\\)";function quoteRegExp(o){return(o+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function isNumeric(o){return!isNaN(1*o)}function getModuleDependencies(o,s,_){var A={};A[_]=[];var O=s.toString().replace(/^"[^"]+"/,"function"),H=O.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||O.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!H)return A;for(var K,z=H[1],G=new RegExp("(\\\\n|\\W)"+quoteRegExp(z)+E,"g");K=G.exec(O);)"dll-reference"!==K[3]&&A[_].push(K[3]);for(G=new RegExp("\\("+quoteRegExp(z)+'\\("(dll-reference\\s('+S+'))"\\)\\)'+E,"g");K=G.exec(O);)o[K[2]]||(A[_].push(K[1]),o[K[2]]=m(K[1]).m),A[K[2]]=A[K[2]]||[],A[K[2]].push(K[4]);for(var q=Object.keys(A),X=0;X<q.length;X++)for(var J=0;J<A[q[X]].length;J++)isNumeric(A[q[X]][J])&&(A[q[X]][J]=1*A[q[X]][J]);return A}function hasValuesInQueues(o){return Object.keys(o).reduce((function(s,m){return s||o[m].length>0}),!1)}function getWebpackString(o,s,m,S){var E=o[S].map((function(o){return'"'+o+'": '+s[S][o].toString().replace(/^"[^"]+"/,"function")})).join(",");return _[0]+"{"+E+"}"+_[1]+'"'+m+'"'+_[2]}function __WEBPACK_DEFAULT_EXPORT__(o,s){s=s||{};var _={main:m.m},S=s.all?{main:Object.keys(_.main)}:function getRequiredModules(o,s){for(var m={main:[s]},_={main:[]},S={main:{}};hasValuesInQueues(m);)for(var E=Object.keys(m),A=0;A<E.length;A++){var O=E[A],H=m[O].pop();if(S[O]=S[O]||{},!S[O][H]&&o[O][H]){S[O][H]=!0,_[O]=_[O]||[],_[O].push(H);for(var K=getModuleDependencies(o,o[O][H],O),z=Object.keys(K),G=0;G<z.length;G++)m[z[G]]=m[z[G]]||[],m[z[G]]=m[z[G]].concat(K[z[G]])}}return _}(_,o),E="";Object.keys(S).filter((function(o){return"main"!==o})).forEach((function(o){for(var s=0;S[o][s];)s++;S[o].push(s),_[o][s]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",E=E+"var "+o+" = ("+getWebpackString(S,_,s,modules)+")();\n"})),E=E+"new (("+getWebpackString(S,_,o,"main")+")())(self);";var A=new window.Blob([E],{type:"text/javascript"}),O=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(A),H=new window.Worker(O);return H.objectURL=O,H}},"./src/errors.ts":
/*!***********************!*\
    !*** ./src/errors.ts ***!
    \***********************/function srcErrorsTs(o,s,m){var _,S,E,A;m.r(s),m.d(s,{ErrorDetails:function ErrorDetails(){return E},ErrorTypes:function ErrorTypes(){return _}}),(S=_||(_={})).NETWORK_ERROR="networkError",S.MEDIA_ERROR="mediaError",S.KEY_SYSTEM_ERROR="keySystemError",S.MUX_ERROR="muxError",S.OTHER_ERROR="otherError",(A=E||(E={})).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",A.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",A.KEY_SYSTEM_NO_SESSION="keySystemNoSession",A.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",A.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",A.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",A.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",A.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",A.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",A.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",A.MANIFEST_LOAD_ERROR="manifestLoadError",A.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",A.MANIFEST_PARSING_ERROR="manifestParsingError",A.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",A.LEVEL_EMPTY_ERROR="levelEmptyError",A.LEVEL_LOAD_ERROR="levelLoadError",A.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",A.LEVEL_SWITCH_ERROR="levelSwitchError",A.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",A.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",A.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",A.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",A.FRAG_LOAD_ERROR="fragLoadError",A.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",A.FRAG_DECRYPT_ERROR="fragDecryptError",A.FRAG_PARSING_ERROR="fragParsingError",A.REMUX_ALLOC_ERROR="remuxAllocError",A.KEY_LOAD_ERROR="keyLoadError",A.KEY_LOAD_TIMEOUT="keyLoadTimeOut",A.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",A.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",A.BUFFER_APPEND_ERROR="bufferAppendError",A.BUFFER_APPENDING_ERROR="bufferAppendingError",A.BUFFER_STALLED_ERROR="bufferStalledError",A.BUFFER_FULL_ERROR="bufferFullError",A.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",A.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",A.INTERNAL_EXCEPTION="internalException",A.INTERNAL_ABORTED="aborted",A.UNKNOWN="unknown"},"./src/events.ts":
/*!***********************!*\
    !*** ./src/events.ts ***!
    \***********************/function srcEventsTs(o,s,m){var _;m.r(s),m.d(s,{Events:function Events(){return _}}),function(o){o.MEDIA_ATTACHING="hlsMediaAttaching",o.MEDIA_ATTACHED="hlsMediaAttached",o.MEDIA_DETACHING="hlsMediaDetaching",o.MEDIA_DETACHED="hlsMediaDetached",o.BUFFER_RESET="hlsBufferReset",o.BUFFER_CODECS="hlsBufferCodecs",o.BUFFER_CREATED="hlsBufferCreated",o.BUFFER_APPENDING="hlsBufferAppending",o.BUFFER_APPENDED="hlsBufferAppended",o.BUFFER_EOS="hlsBufferEos",o.BUFFER_FLUSHING="hlsBufferFlushing",o.BUFFER_FLUSHED="hlsBufferFlushed",o.MANIFEST_LOADING="hlsManifestLoading",o.MANIFEST_LOADED="hlsManifestLoaded",o.MANIFEST_PARSED="hlsManifestParsed",o.LEVEL_SWITCHING="hlsLevelSwitching",o.LEVEL_SWITCHED="hlsLevelSwitched",o.LEVEL_LOADING="hlsLevelLoading",o.LEVEL_LOADED="hlsLevelLoaded",o.LEVEL_UPDATED="hlsLevelUpdated",o.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",o.LEVELS_UPDATED="hlsLevelsUpdated",o.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",o.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",o.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",o.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",o.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",o.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",o.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",o.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",o.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",o.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",o.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",o.CUES_PARSED="hlsCuesParsed",o.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",o.INIT_PTS_FOUND="hlsInitPtsFound",o.FRAG_LOADING="hlsFragLoading",o.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",o.FRAG_LOADED="hlsFragLoaded",o.FRAG_DECRYPTED="hlsFragDecrypted",o.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",o.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",o.FRAG_PARSING_METADATA="hlsFragParsingMetadata",o.FRAG_PARSED="hlsFragParsed",o.FRAG_BUFFERED="hlsFragBuffered",o.FRAG_CHANGED="hlsFragChanged",o.FPS_DROP="hlsFpsDrop",o.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",o.ERROR="hlsError",o.DESTROYING="hlsDestroying",o.KEY_LOADING="hlsKeyLoading",o.KEY_LOADED="hlsKeyLoaded",o.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",o.BACK_BUFFER_REACHED="hlsBackBufferReached"}(_||(_={}))},"./src/hls.ts":
/*!********************!*\
    !*** ./src/hls.ts ***!
    \********************/function srcHlsTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _e}});var _=m(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),S=m(/*! ./loader/playlist-loader */"./src/loader/playlist-loader.ts"),E=m(/*! ./controller/id3-track-controller */"./src/controller/id3-track-controller.ts"),A=m(/*! ./controller/latency-controller */"./src/controller/latency-controller.ts"),O=m(/*! ./controller/level-controller */"./src/controller/level-controller.ts"),H=m(/*! ./controller/fragment-tracker */"./src/controller/fragment-tracker.ts"),K=m(/*! ./loader/key-loader */"./src/loader/key-loader.ts"),z=m(/*! ./controller/stream-controller */"./src/controller/stream-controller.ts"),G=m(/*! ./is-supported */"./src/is-supported.ts"),q=m(/*! ./utils/logger */"./src/utils/logger.ts"),X=m(/*! ./config */"./src/config.ts"),J=m(/*! eventemitter3 */"./node_modules/eventemitter3/index.js"),ae=m(/*! ./events */"./src/events.ts"),pe=m(/*! ./errors */"./src/errors.ts"),me=m(/*! ./types/level */"./src/types/level.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}var _e=function(){function Hls(o){void 0===o&&(o={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new J.EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var s=this.config=(0,X.mergeConfig)(Hls.DefaultConfig,o);this.userConfig=o,(0,q.enableLogs)(s.debug,"Hls instance"),this._autoLevelCapping=-1,s.progressive&&(0,X.enableStreamingMode)(s);var m=s.abrController,_=s.bufferController,G=s.capLevelController,ae=s.fpsController,pe=this.abrController=new m(this),me=this.bufferController=new _(this),_e=this.capLevelController=new G(this),Se=new ae(this),Ee=new S.default(this),De=new E.default(this),$e=this.levelController=new O.default(this),He=new H.FragmentTracker(this),et=new K.default(this.config),rt=this.streamController=new z.default(this,He,et);_e.setStreamController(rt),Se.setStreamController(rt);var it=[Ee,$e,rt];this.networkControllers=it;var at=[pe,me,_e,Se,De,He];this.audioTrackController=this.createController(s.audioTrackController,it);var ot=s.audioStreamController;ot&&it.push(new ot(this,He,et)),this.subtitleTrackController=this.createController(s.subtitleTrackController,it);var st=s.subtitleStreamController;st&&it.push(new st(this,He,et)),this.createController(s.timelineController,at),et.emeController=this.emeController=this.createController(s.emeController,at),this.cmcdController=this.createController(s.cmcdController,at),this.latencyController=this.createController(A.default,at),this.coreComponents=at}Hls.isSupported=function isSupported(){return(0,G.isSupported)()};var o=Hls.prototype;return o.createController=function createController(o,s){if(o){var m=new o(this);return s&&s.push(m),m}return null},o.on=function on(o,s,m){void 0===m&&(m=this),this._emitter.on(o,s,m)},o.once=function once(o,s,m){void 0===m&&(m=this),this._emitter.once(o,s,m)},o.removeAllListeners=function removeAllListeners(o){this._emitter.removeAllListeners(o)},o.off=function off(o,s,m,_){void 0===m&&(m=this),this._emitter.off(o,s,m,_)},o.listeners=function listeners(o){return this._emitter.listeners(o)},o.emit=function emit(o,s,m){return this._emitter.emit(o,s,m)},o.trigger=function trigger(o,s){if(this.config.debug)return this.emit(o,o,s);try{return this.emit(o,o,s)}catch(s){q.logger.error("An internal error happened while handling event "+o+'. Error message: "'+s.message+'". Here is a stacktrace:',s),this.trigger(ae.Events.ERROR,{type:pe.ErrorTypes.OTHER_ERROR,details:pe.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:o,error:s})}return!1},o.listenerCount=function listenerCount(o){return this._emitter.listenerCount(o)},o.destroy=function destroy(){q.logger.log("destroy"),this.trigger(ae.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((function(o){return o.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(o){return o.destroy()})),this.coreComponents.length=0},o.attachMedia=function attachMedia(o){q.logger.log("attachMedia"),this._media=o,this.trigger(ae.Events.MEDIA_ATTACHING,{media:o})},o.detachMedia=function detachMedia(){q.logger.log("detachMedia"),this.trigger(ae.Events.MEDIA_DETACHING,void 0),this._media=null},o.loadSource=function loadSource(o){this.stopLoad();var s=this.media,m=this.url,S=this.url=_.buildAbsoluteURL(self.location.href,o,{alwaysNormalize:!0});q.logger.log("loadSource:"+S),s&&m&&m!==S&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(s)),this.trigger(ae.Events.MANIFEST_LOADING,{url:o})},o.startLoad=function startLoad(o){void 0===o&&(o=-1),q.logger.log("startLoad("+o+")"),this.networkControllers.forEach((function(s){s.startLoad(o)}))},o.stopLoad=function stopLoad(){q.logger.log("stopLoad"),this.networkControllers.forEach((function(o){o.stopLoad()}))},o.swapAudioCodec=function swapAudioCodec(){q.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},o.recoverMediaError=function recoverMediaError(){q.logger.log("recoverMediaError");var o=this._media;this.detachMedia(),o&&this.attachMedia(o)},o.removeLevel=function removeLevel(o,s){void 0===s&&(s=0),this.levelController.removeLevel(o,s)},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(Hls,[{key:"levels",get:function get(){var o=this.levelController.levels;return o||[]}},{key:"currentLevel",get:function get(){return this.streamController.currentLevel},set:function set(o){q.logger.log("set currentLevel:"+o),this.loadLevel=o,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function get(){return this.streamController.nextLevel},set:function set(o){q.logger.log("set nextLevel:"+o),this.levelController.manualLevel=o,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function get(){return this.levelController.level},set:function set(o){q.logger.log("set loadLevel:"+o),this.levelController.manualLevel=o}},{key:"nextLoadLevel",get:function get(){return this.levelController.nextLoadLevel},set:function set(o){this.levelController.nextLoadLevel=o}},{key:"firstLevel",get:function get(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function set(o){q.logger.log("set firstLevel:"+o),this.levelController.firstLevel=o}},{key:"startLevel",get:function get(){return this.levelController.startLevel},set:function set(o){q.logger.log("set startLevel:"+o),-1!==o&&(o=Math.max(o,this.minAutoLevel)),this.levelController.startLevel=o}},{key:"capLevelToPlayerSize",get:function get(){return this.config.capLevelToPlayerSize},set:function set(o){var s=!!o;s!==this.config.capLevelToPlayerSize&&(s?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=s)}},{key:"autoLevelCapping",get:function get(){return this._autoLevelCapping},set:function set(o){this._autoLevelCapping!==o&&(q.logger.log("set autoLevelCapping:"+o),this._autoLevelCapping=o)}},{key:"bandwidthEstimate",get:function get(){var o=this.abrController.bwEstimator;return o?o.getEstimate():NaN}},{key:"maxHdcpLevel",get:function get(){return this._maxHdcpLevel},set:function set(o){me.HdcpLevels.indexOf(o)>-1&&(this._maxHdcpLevel=o)}},{key:"autoLevelEnabled",get:function get(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function get(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function get(){var o=this.levels,s=this.config.minAutoBitrate;if(!o)return 0;for(var m=o.length,_=0;_<m;_++)if(o[_].maxBitrate>=s)return _;return 0}},{key:"maxAutoLevel",get:function get(){var o,s=this.levels,m=this.autoLevelCapping,_=this.maxHdcpLevel;if(o=-1===m&&s&&s.length?s.length-1:m,_)for(var S=o;S--;){var E=s[S].attrs["HDCP-LEVEL"];if(E&&E<=_)return S}return o}},{key:"nextAutoLevel",get:function get(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function set(o){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,o)}},{key:"playingDate",get:function get(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function get(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function get(){var o=this.audioTrackController;return o?o.audioTracks:[]}},{key:"audioTrack",get:function get(){var o=this.audioTrackController;return o?o.audioTrack:-1},set:function set(o){var s=this.audioTrackController;s&&(s.audioTrack=o)}},{key:"subtitleTracks",get:function get(){var o=this.subtitleTrackController;return o?o.subtitleTracks:[]}},{key:"subtitleTrack",get:function get(){var o=this.subtitleTrackController;return o?o.subtitleTrack:-1},set:function set(o){var s=this.subtitleTrackController;s&&(s.subtitleTrack=o)}},{key:"media",get:function get(){return this._media}},{key:"subtitleDisplay",get:function get(){var o=this.subtitleTrackController;return!!o&&o.subtitleDisplay},set:function set(o){var s=this.subtitleTrackController;s&&(s.subtitleDisplay=o)}},{key:"lowLatencyMode",get:function get(){return this.config.lowLatencyMode},set:function set(o){this.config.lowLatencyMode=o}},{key:"liveSyncPosition",get:function get(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function get(){return this.latencyController.latency}},{key:"maxLatency",get:function get(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function get(){return this.latencyController.targetLatency}},{key:"drift",get:function get(){return this.latencyController.drift}},{key:"forceStartLoad",get:function get(){return this.streamController.forceStartLoad}}],[{key:"version",get:function get(){return"1.3.4"}},{key:"Events",get:function get(){return ae.Events}},{key:"ErrorTypes",get:function get(){return pe.ErrorTypes}},{key:"ErrorDetails",get:function get(){return pe.ErrorDetails}},{key:"DefaultConfig",get:function get(){return Hls.defaultConfig?Hls.defaultConfig:X.hlsDefaultConfig},set:function set(o){Hls.defaultConfig=o}}]),Hls}();_e.defaultConfig=void 0},"./src/is-supported.ts":
/*!*****************************!*\
    !*** ./src/is-supported.ts ***!
    \*****************************/function srcIsSupportedTs(o,s,m){m.r(s),m.d(s,{changeTypeSupported:function changeTypeSupported(){return _changeTypeSupported},isSupported:function isSupported(){return _isSupported}});var _=m(/*! ./utils/mediasource-helper */"./src/utils/mediasource-helper.ts");function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function _isSupported(){var o=(0,_.getMediaSource)();if(!o)return!1;var s=getSourceBuffer(),m=o&&"function"==typeof o.isTypeSupported&&o.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),S=!s||s.prototype&&"function"==typeof s.prototype.appendBuffer&&"function"==typeof s.prototype.remove;return!!m&&!!S}function _changeTypeSupported(){var o,s=getSourceBuffer();return"function"==typeof(null==s||null===(o=s.prototype)||void 0===o?void 0:o.changeType)}},"./src/loader/date-range.ts":
/*!**********************************!*\
    !*** ./src/loader/date-range.ts ***!
    \**********************************/function srcLoaderDateRangeTs(o,s,m){m.r(s),m.d(s,{DateRange:function DateRange(){return H},DateRangeAttribute:function DateRangeAttribute(){return _}});var _,S,E=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),A=m(/*! ../utils/attr-list */"./src/utils/attr-list.ts"),O=m(/*! ../utils/logger */"./src/utils/logger.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}(S=_||(_={})).ID="ID",S.CLASS="CLASS",S.START_DATE="START-DATE",S.DURATION="DURATION",S.END_DATE="END-DATE",S.END_ON_NEXT="END-ON-NEXT",S.PLANNED_DURATION="PLANNED-DURATION",S.SCTE35_OUT="SCTE35-OUT",S.SCTE35_IN="SCTE35-IN";var H=function(){function DateRange(o,s){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,s){var m=s.attr;for(var S in m)if(Object.prototype.hasOwnProperty.call(o,S)&&o[S]!==m[S]){O.logger.warn('DATERANGE tag attribute: "'+S+'" does not match for tags with ID: "'+o.ID+'"'),this._badValueForSameId=S;break}o=_extends(new A.AttrList({}),m,o)}if(this.attr=o,this._startDate=new Date(o[_.START_DATE]),_.END_DATE in this.attr){var H=new Date(this.attr[_.END_DATE]);(0,E.isFiniteNumber)(H.getTime())&&(this._endDate=H)}}return function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(DateRange,[{key:"id",get:function get(){return this.attr.ID}},{key:"class",get:function get(){return this.attr.CLASS}},{key:"startDate",get:function get(){return this._startDate}},{key:"endDate",get:function get(){if(this._endDate)return this._endDate;var o=this.duration;return null!==o?new Date(this._startDate.getTime()+1e3*o):null}},{key:"duration",get:function get(){if(_.DURATION in this.attr){var o=this.attr.decimalFloatingPoint(_.DURATION);if((0,E.isFiniteNumber)(o))return o}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function get(){return _.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(_.PLANNED_DURATION):null}},{key:"endOnNext",get:function get(){return this.attr.bool(_.END_ON_NEXT)}},{key:"isValid",get:function get(){return!!this.id&&!this._badValueForSameId&&(0,E.isFiniteNumber)(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),DateRange}()},"./src/loader/fragment-loader.ts":
/*!***************************************!*\
    !*** ./src/loader/fragment-loader.ts ***!
    \***************************************/function srcLoaderFragmentLoaderTs(o,s,m){m.r(s),m.d(s,{LoadError:function LoadError(){return O},default:function _default(){return A}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../errors */"./src/errors.ts");function _wrapNativeSuper(o){var s="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(o){if(null===o||!function _isNativeFunction(o){return-1!==Function.toString.call(o).indexOf("[native code]")}(o))return o;if("function"!=typeof o)throw new TypeError("Super expression must either be null or a function");if(void 0!==s){if(s.has(o))return s.get(o);s.set(o,Wrapper)}function Wrapper(){return _construct(o,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(o.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,o)},_wrapNativeSuper(o)}function _construct(o,s,m){return _construct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(o){return!1}}()?Reflect.construct.bind():function _construct(o,s,m){var _=[null];_.push.apply(_,s);var S=new(Function.bind.apply(o,_));return m&&_setPrototypeOf(S,m.prototype),S},_construct.apply(null,arguments)}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var E=Math.pow(2,17),A=function(){function FragmentLoader(o){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=o}var o=FragmentLoader.prototype;return o.destroy=function destroy(){this.loader&&(this.loader.destroy(),this.loader=null)},o.abort=function abort(){this.loader&&this.loader.abort()},o.load=function load(o,s){var m=this,_=o.url;if(!_)return Promise.reject(new O({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,networkDetails:null},"Fragment does not have a "+(_?"part list":"url")));this.abort();var A=this.config,H=A.fLoader,K=A.loader;return new Promise((function(_,z){m.loader&&m.loader.destroy();var G=m.loader=o.loader=H?new H(A):new K(A),q=createLoaderContext(o),X={timeout:A.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:A.fragLoadingMaxRetryTimeout,highWaterMark:"initSegment"===o.sn?1/0:E};o.stats=G.stats,G.load(q,X,{onSuccess:function onSuccess(s,S,E,A){m.resetLoader(o,G);var O=s.data;E.resetIV&&o.decryptdata&&(o.decryptdata.iv=new Uint8Array(O.slice(0,16)),O=O.slice(16)),_({frag:o,part:null,payload:O,networkDetails:A})},onError:function onError(s,_,E){m.resetLoader(o,G),z(new O({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,response:s,networkDetails:E}))},onAbort:function onAbort(s,_,E){m.resetLoader(o,G),z(new O({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:o,networkDetails:E}))},onTimeout:function onTimeout(s,_,E){m.resetLoader(o,G),z(new O({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:o,networkDetails:E}))},onProgress:function onProgress(m,_,S,E){s&&s({frag:o,part:null,payload:S,networkDetails:E})}})}))},o.loadPart=function loadPart(o,s,m){var _=this;this.abort();var A=this.config,H=A.fLoader,K=A.loader;return new Promise((function(z,G){_.loader&&_.loader.destroy();var q=_.loader=o.loader=H?new H(A):new K(A),X=createLoaderContext(o,s),J={timeout:A.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:A.fragLoadingMaxRetryTimeout,highWaterMark:E};s.stats=q.stats,q.load(X,J,{onSuccess:function onSuccess(S,E,A,O){_.resetLoader(o,q),_.updateStatsFromPart(o,s);var H={frag:o,part:s,payload:S.data,networkDetails:O};m(H),z(H)},onError:function onError(m,E,A){_.resetLoader(o,q),G(new O({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:o,part:s,response:m,networkDetails:A}))},onAbort:function onAbort(m,E,A){o.stats.aborted=s.stats.aborted,_.resetLoader(o,q),G(new O({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:o,part:s,networkDetails:A}))},onTimeout:function onTimeout(m,E,A){_.resetLoader(o,q),G(new O({type:S.ErrorTypes.NETWORK_ERROR,details:S.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:o,part:s,networkDetails:A}))}})}))},o.updateStatsFromPart=function updateStatsFromPart(o,s){var m=o.stats,_=s.stats,S=_.total;if(m.loaded+=_.loaded,S){var E=Math.round(o.duration/s.duration),A=Math.min(Math.round(m.loaded/S),E),O=(E-A)*Math.round(m.loaded/A);m.total=m.loaded+O}else m.total=Math.max(m.loaded,m.total);var H=m.loading,K=_.loading;H.start?H.first+=K.first-K.start:(H.start=K.start,H.first=K.first),H.end=K.end},o.resetLoader=function resetLoader(o,s){o.loader=null,this.loader===s&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),s.destroy()},FragmentLoader}();function createLoaderContext(o,s){void 0===s&&(s=null);var m=s||o,S={frag:o,part:s,responseType:"arraybuffer",url:m.url,headers:{},rangeStart:0,rangeEnd:0},E=m.byteRangeStartOffset,A=m.byteRangeEndOffset;if((0,_.isFiniteNumber)(E)&&(0,_.isFiniteNumber)(A)){var O,H=E,K=A;if("initSegment"===o.sn&&"AES-128"===(null===(O=o.decryptdata)||void 0===O?void 0:O.method)){var z=A-E;z%16&&(K=A+(16-z%16)),0!==E&&(S.resetIV=!0,H=E-16)}S.rangeStart=H,S.rangeEnd=K}return S}var O=function(o){function LoadError(s){for(var m,_=arguments.length,S=new Array(_>1?_-1:0),E=1;E<_;E++)S[E-1]=arguments[E];return(m=o.call.apply(o,[this].concat(S))||this).data=void 0,m.data=s,m}return function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(LoadError,o),LoadError}(_wrapNativeSuper(Error))},"./src/loader/fragment.ts":
/*!********************************!*\
    !*** ./src/loader/fragment.ts ***!
    \********************************/function srcLoaderFragmentTs(o,s,m){m.r(s),m.d(s,{BaseSegment:function BaseSegment(){return H},ElementaryStreamTypes:function ElementaryStreamTypes(){return _},Fragment:function Fragment(){return K},Part:function Part(){return z}});var _,S,E=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),A=m(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),O=m(/*! ./load-stats */"./src/loader/load-stats.ts");function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(S=_||(_={})).AUDIO="audio",S.VIDEO="video",S.AUDIOVIDEO="audiovideo";var H=function(){function BaseSegment(o){var s;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((s={})[_.AUDIO]=null,s[_.VIDEO]=null,s[_.AUDIOVIDEO]=null,s),this.baseurl=o}return BaseSegment.prototype.setByteRange=function setByteRange(o,s){var m=o.split("@",2),_=[];1===m.length?_[0]=s?s.byteRangeEndOffset:0:_[0]=parseInt(m[1]),_[1]=parseInt(m[0])+_[0],this._byteRange=_},_createClass(BaseSegment,[{key:"byteRange",get:function get(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function get(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function get(){return this.byteRange[1]}},{key:"url",get:function get(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,A.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function set(o){this._url=o}}]),BaseSegment}(),K=function(o){function Fragment(s,m){var _;return(_=o.call(this,m)||this)._decryptdata=null,_.rawProgramDateTime=null,_.programDateTime=null,_.tagList=[],_.duration=0,_.sn=0,_.levelkeys=void 0,_.type=void 0,_.loader=null,_.keyLoader=null,_.level=-1,_.cc=0,_.startPTS=void 0,_.endPTS=void 0,_.appendedPTS=void 0,_.startDTS=void 0,_.endDTS=void 0,_.start=0,_.deltaPTS=void 0,_.maxStartPTS=void 0,_.minEndPTS=void 0,_.stats=new O.LoadStats,_.urlId=0,_.data=void 0,_.bitrateTest=!1,_.title=null,_.initSegment=null,_.endList=void 0,_.type=s,_}_inheritsLoose(Fragment,o);var s=Fragment.prototype;return s.setKeyFormat=function setKeyFormat(o){if(this.levelkeys){var s=this.levelkeys[o];s&&!this._decryptdata&&(this._decryptdata=s.getDecryptData(this.sn))}},s.abortRequests=function abortRequests(){var o,s;null===(o=this.loader)||void 0===o||o.abort(),null===(s=this.keyLoader)||void 0===s||s.abort()},s.setElementaryStreamInfo=function setElementaryStreamInfo(o,s,m,_,S,E){void 0===E&&(E=!1);var A=this.elementaryStreams,O=A[o];O?(O.startPTS=Math.min(O.startPTS,s),O.endPTS=Math.max(O.endPTS,m),O.startDTS=Math.min(O.startDTS,_),O.endDTS=Math.max(O.endDTS,S)):A[o]={startPTS:s,endPTS:m,startDTS:_,endDTS:S,partial:E}},s.clearElementaryStreamInfo=function clearElementaryStreamInfo(){var o=this.elementaryStreams;o[_.AUDIO]=null,o[_.VIDEO]=null,o[_.AUDIOVIDEO]=null},_createClass(Fragment,[{key:"decryptdata",get:function get(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var o=this.levelkeys.identity;if(o)this._decryptdata=o.getDecryptData(this.sn);else{var s=Object.keys(this.levelkeys);if(1===s.length)return this._decryptdata=this.levelkeys[s[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function get(){return this.start+this.duration}},{key:"endProgramDateTime",get:function get(){if(null===this.programDateTime)return null;if(!(0,E.isFiniteNumber)(this.programDateTime))return null;var o=(0,E.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*o}},{key:"encrypted",get:function get(){var o;if(null!==(o=this._decryptdata)&&void 0!==o&&o.encrypted)return!0;if(this.levelkeys){var s=Object.keys(this.levelkeys),m=s.length;if(m>1||1===m&&this.levelkeys[s[0]].encrypted)return!0}return!1}}]),Fragment}(H),z=function(o){function Part(s,m,_,S,E){var A;(A=o.call(this,_)||this).fragOffset=0,A.duration=0,A.gap=!1,A.independent=!1,A.relurl=void 0,A.fragment=void 0,A.index=void 0,A.stats=new O.LoadStats,A.duration=s.decimalFloatingPoint("DURATION"),A.gap=s.bool("GAP"),A.independent=s.bool("INDEPENDENT"),A.relurl=s.enumeratedString("URI"),A.fragment=m,A.index=S;var H=s.enumeratedString("BYTERANGE");return H&&A.setByteRange(H,E),E&&(A.fragOffset=E.fragOffset+E.duration),A}return _inheritsLoose(Part,o),_createClass(Part,[{key:"start",get:function get(){return this.fragment.start+this.fragOffset}},{key:"end",get:function get(){return this.start+this.duration}},{key:"loaded",get:function get(){var o=this.elementaryStreams;return!!(o.audio||o.video||o.audiovideo)}}]),Part}(H)},"./src/loader/key-loader.ts":
/*!**********************************!*\
    !*** ./src/loader/key-loader.ts ***!
    \**********************************/function srcLoaderKeyLoaderTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return E}});var _=m(/*! ../errors */"./src/errors.ts"),S=m(/*! ./fragment-loader */"./src/loader/fragment-loader.ts"),E=function(){function KeyLoader(o){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=o}var o=KeyLoader.prototype;return o.abort=function abort(){for(var o in this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[o].loader;s&&s.abort()}},o.detach=function detach(){for(var o in this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[o];(s.mediaKeySessionContext||s.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[o]}},o.destroy=function destroy(){for(var o in this.detach(),this.keyUriToKeyInfo){var s=this.keyUriToKeyInfo[o].loader;s&&s.destroy()}this.keyUriToKeyInfo={}},o.createKeyLoadError=function createKeyLoadError(o,s,m,E){return void 0===s&&(s=_.ErrorDetails.KEY_LOAD_ERROR),new S.LoadError({type:_.ErrorTypes.NETWORK_ERROR,details:s,fatal:!1,frag:o,networkDetails:m})},o.loadClear=function loadClear(o,s){var m=this;if(this.emeController&&this.config.emeEnabled)for(var _=o.sn,S=o.cc,E=function _loop(o){var E=s[o];if(S<=E.cc&&("initSegment"===_||_<E.sn))return m.emeController.selectKeySystemFormat(E).then((function(o){E.setKeyFormat(o)})),"break"},A=0;A<s.length;A++){if("break"===E(A))break}},o.load=function load(o){var s=this;return!o.decryptdata&&o.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(o).then((function(m){return s.loadInternal(o,m)})):this.loadInternal(o)},o.loadInternal=function loadInternal(o,s){var m,S;s&&o.setKeyFormat(s);var E=o.decryptdata;if(!E){var A=s?"Expected frag.decryptdata to be defined after setting format "+s:"Missing decryption data on fragment in onKeyLoading";return Promise.reject(this.createKeyLoadError(o,_.ErrorDetails.KEY_LOAD_ERROR,null,A))}var O=E.uri;if(!O)return Promise.reject(this.createKeyLoadError(o,_.ErrorDetails.KEY_LOAD_ERROR,null,'Invalid key URI: "'+O+'"'));var H,K=this.keyUriToKeyInfo[O];if(null!==(m=K)&&void 0!==m&&m.decryptdata.key)return E.key=K.decryptdata.key,Promise.resolve({frag:o,keyInfo:K});if(null!==(S=K)&&void 0!==S&&S.keyLoadPromise)switch(null===(H=K.mediaKeySessionContext)||void 0===H?void 0:H.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return K.keyLoadPromise.then((function(s){return E.key=s.keyInfo.decryptdata.key,{frag:o,keyInfo:K}}))}switch(K=this.keyUriToKeyInfo[O]={decryptdata:E,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},E.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===E.keyFormat?this.loadKeyHTTP(K,o):this.loadKeyEME(K,o);case"AES-128":return this.loadKeyHTTP(K,o);default:return Promise.reject(this.createKeyLoadError(o,_.ErrorDetails.KEY_LOAD_ERROR,null,'Key supplied with unsupported METHOD: "'+E.method+'"'))}},o.loadKeyEME=function loadKeyEME(o,s){var m={frag:s,keyInfo:o};if(this.emeController&&this.config.emeEnabled){var _=this.emeController.loadKey(m);if(_)return(o.keyLoadPromise=_.then((function(s){return o.mediaKeySessionContext=s,m}))).catch((function(s){throw o.keyLoadPromise=null,s}))}return Promise.resolve(m)},o.loadKeyHTTP=function loadKeyHTTP(o,s){var m=this,S=this.config,E=new(0,S.loader)(S);return s.keyLoader=o.loader=E,o.keyLoadPromise=new Promise((function(A,O){var H={keyInfo:o,frag:s,responseType:"arraybuffer",url:o.decryptdata.uri},K={timeout:S.fragLoadingTimeOut,maxRetry:0,retryDelay:S.fragLoadingRetryDelay,maxRetryDelay:S.fragLoadingMaxRetryTimeout,highWaterMark:0},z={onSuccess:function onSuccess(o,s,S,E){var H=S.frag,K=S.keyInfo,z=S.url;if(!H.decryptdata||K!==m.keyUriToKeyInfo[z])return O(m.createKeyLoadError(H,_.ErrorDetails.KEY_LOAD_ERROR,E,"after key load, decryptdata unset or changed"));K.decryptdata.key=H.decryptdata.key=new Uint8Array(o.data),H.keyLoader=null,K.loader=null,A({frag:H,keyInfo:K})},onError:function onError(o,S,E){m.resetLoader(S),O(m.createKeyLoadError(s,_.ErrorDetails.KEY_LOAD_ERROR,E))},onTimeout:function onTimeout(o,S,E){m.resetLoader(S),O(m.createKeyLoadError(s,_.ErrorDetails.KEY_LOAD_TIMEOUT,E))},onAbort:function onAbort(o,S,E){m.resetLoader(S),O(m.createKeyLoadError(s,_.ErrorDetails.INTERNAL_ABORTED,E))}};E.load(H,K,z)}))},o.resetLoader=function resetLoader(o){var s=o.frag,m=o.keyInfo,_=o.url,S=m.loader;s.keyLoader===S&&(s.keyLoader=null,m.loader=null),delete this.keyUriToKeyInfo[_],S&&S.destroy()},KeyLoader}()},"./src/loader/level-details.ts":
/*!*************************************!*\
    !*** ./src/loader/level-details.ts ***!
    \*************************************/function srcLoaderLevelDetailsTs(o,s,m){m.r(s),m.d(s,{LevelDetails:function LevelDetails(){return S}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts");function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}var S=function(){function LevelDetails(o){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=o}return LevelDetails.prototype.reloaded=function reloaded(o){if(!o)return this.advanced=!0,void(this.updated=!0);var s=this.lastPartSn-o.lastPartSn,m=this.lastPartIndex-o.lastPartIndex;this.updated=this.endSN!==o.endSN||!!m||!!s,this.advanced=this.endSN>o.endSN||s>0||0===s&&m>0,this.updated||this.advanced?this.misses=Math.floor(.6*o.misses):this.misses=o.misses+1,this.availabilityDelay=o.availabilityDelay},function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(LevelDetails,[{key:"hasProgramDateTime",get:function get(){return!!this.fragments.length&&(0,_.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function get(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function get(){var o=this.driftEndTime-this.driftStartTime;return o>0?1e3*(this.driftEnd-this.driftStart)/o:1}},{key:"edge",get:function get(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function get(){var o;return null!==(o=this.partList)&&void 0!==o&&o.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function get(){var o;return null!==(o=this.fragments)&&void 0!==o&&o.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function get(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function get(){var o;return null!==(o=this.partList)&&void 0!==o&&o.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function get(){var o;return null!==(o=this.partList)&&void 0!==o&&o.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),LevelDetails}()},"./src/loader/level-key.ts":
/*!*********************************!*\
    !*** ./src/loader/level-key.ts ***!
    \*********************************/function srcLoaderLevelKeyTs(o,s,m){m.r(s),m.d(s,{LevelKey:function LevelKey(){return K}});var _=m(/*! ../utils/keysystem-util */"./src/utils/keysystem-util.ts"),S=m(/*! ../utils/mediakeys-helper */"./src/utils/mediakeys-helper.ts"),E=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),A=m(/*! ../utils/logger */"./src/utils/logger.ts"),O=m(/*! ../utils/numeric-encoding-utils */"./src/utils/numeric-encoding-utils.ts"),H={},K=function(){function LevelKey(o,s,m,_,S){void 0===_&&(_=[1]),void 0===S&&(S=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=o,this.uri=s,this.keyFormat=m,this.keyFormatVersions=_,this.iv=S,this.encrypted=!!o&&"NONE"!==o,this.isCommonEncryption=this.encrypted&&"AES-128"!==o}LevelKey.clearKeyUriToKeyIdMap=function clearKeyUriToKeyIdMap(){H={}};var o=LevelKey.prototype;return o.isSupported=function isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;switch(this.keyFormat){case"identity":return"SAMPLE-AES"===this.method;case S.KeySystemFormats.FAIRPLAY:case S.KeySystemFormats.WIDEVINE:case S.KeySystemFormats.PLAYREADY:case S.KeySystemFormats.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1},o.getDecryptData=function getDecryptData(o){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof o&&("AES-128"!==this.method||this.iv||A.logger.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),o=0);var s=function createInitializationVector(o){for(var s=new Uint8Array(16),m=12;m<16;m++)s[m]=o>>8*(15-m)&255;return s}(o);return new LevelKey(this.method,this.uri,"identity",this.keyFormatVersions,s)}var m=(0,_.convertDataUriToArrayBytes)(this.uri);if(m)switch(this.keyFormat){case S.KeySystemFormats.WIDEVINE:this.pssh=m,m.length>=22&&(this.keyId=m.subarray(m.length-22,m.length-6));break;case S.KeySystemFormats.PLAYREADY:var K=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=(0,E.mp4pssh)(K,null,m);var z=new Uint16Array(m.buffer,m.byteOffset,m.byteLength/2),G=String.fromCharCode.apply(null,Array.from(z)),q=G.substring(G.indexOf("<"),G.length),X=(new DOMParser).parseFromString(q,"text/xml").getElementsByTagName("KID")[0];if(X){var J=X.childNodes[0]?X.childNodes[0].nodeValue:X.getAttribute("VALUE");if(J){var ae=(0,O.base64Decode)(J).subarray(0,16);(0,_.changeEndianness)(ae),this.keyId=ae}}break;default:var pe=m.subarray(0,16);if(16!==pe.length){var me=new Uint8Array(16);me.set(pe,16-pe.length),pe=me}this.keyId=pe}if(!this.keyId||16!==this.keyId.byteLength){var _e=H[this.uri];if(!_e){var Se=Object.keys(H).length%Number.MAX_SAFE_INTEGER;_e=new Uint8Array(16),new DataView(_e.buffer,12,4).setUint32(0,Se),H[this.uri]=_e}this.keyId=_e}return this},LevelKey}()},"./src/loader/load-stats.ts":
/*!**********************************!*\
    !*** ./src/loader/load-stats.ts ***!
    \**********************************/function srcLoaderLoadStatsTs(o,s,m){m.r(s),m.d(s,{LoadStats:function LoadStats(){return _}});var _=function LoadStats(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":
/*!***********************************!*\
    !*** ./src/loader/m3u8-parser.ts ***!
    \***********************************/function srcLoaderM3u8ParserTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return pe}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! url-toolkit */"./node_modules/url-toolkit/src/url-toolkit.js"),E=m(/*! ./date-range */"./src/loader/date-range.ts"),A=m(/*! ./fragment */"./src/loader/fragment.ts"),O=m(/*! ./level-details */"./src/loader/level-details.ts"),H=m(/*! ./level-key */"./src/loader/level-key.ts"),K=m(/*! ../utils/attr-list */"./src/utils/attr-list.ts"),z=m(/*! ../utils/logger */"./src/utils/logger.ts"),G=m(/*! ../utils/codecs */"./src/utils/codecs.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}var q=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+|#EXT-X-SESSION-KEY:([^\n\r]*)[\r\n]+/g,X=/#EXT-X-MEDIA:(.*)/g,J=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),ae=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),pe=function(){function M3U8Parser(){}return M3U8Parser.findGroup=function findGroup(o,s){for(var m=0;m<o.length;m++){var _=o[m];if(_.id===s)return _}},M3U8Parser.convertAVC1ToAVCOTI=function convertAVC1ToAVCOTI(o){var s=o.split(".");if(s.length>2){var m=s.shift()+".";return m+=parseInt(s.shift()).toString(16),m+=("000"+parseInt(s.shift()).toString(16)).slice(-4)}return o},M3U8Parser.resolve=function resolve(o,s){return(0,S.buildAbsoluteURL)(s,o,{alwaysNormalize:!0})},M3U8Parser.parseMasterPlaylist=function parseMasterPlaylist(o,s){var m,_=[],S=[],E={},A=[],O=!1;for(q.lastIndex=0;null!=(m=q.exec(o));)if(m[1]){var H,G=new K.AttrList(m[1]),X={attrs:G,bitrate:G.decimalInteger("AVERAGE-BANDWIDTH")||G.decimalInteger("BANDWIDTH"),name:G.NAME,url:M3U8Parser.resolve(m[2],s)},J=G.decimalResolution("RESOLUTION");J&&(X.width=J.width,X.height=J.height),setCodecs((G.CODECS||"").split(/[ ,]+/).filter((function(o){return o})),X),X.videoCodec&&-1!==X.videoCodec.indexOf("avc1")&&(X.videoCodec=M3U8Parser.convertAVC1ToAVCOTI(X.videoCodec)),null!==(H=X.unknownCodecs)&&void 0!==H&&H.length||S.push(X),_.push(X)}else if(m[3]){var ae=new K.AttrList(m[3]);ae["DATA-ID"]&&(O=!0,E[ae["DATA-ID"]]=ae)}else if(m[4]){var pe=m[4],me=parseKey(pe,s);me.encrypted&&me.isSupported()?A.push(me):z.logger.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+pe+'"')}return{levels:S.length>0&&S.length<_.length?S:_,sessionData:O?E:null,sessionKeys:A.length?A:null}},M3U8Parser.parseMasterPlaylistMedia=function parseMasterPlaylistMedia(o,s,m,_){var S;void 0===_&&(_=[]);var E=[],A=0;for(X.lastIndex=0;null!==(S=X.exec(o));){var O=new K.AttrList(S[1]);if(O.TYPE===m){var H={attrs:O,bitrate:0,id:A++,groupId:O["GROUP-ID"],instreamId:O["INSTREAM-ID"],name:O.NAME||O.LANGUAGE||"",type:m,default:O.bool("DEFAULT"),autoselect:O.bool("AUTOSELECT"),forced:O.bool("FORCED"),lang:O.LANGUAGE,url:O.URI?M3U8Parser.resolve(O.URI,s):""};if(_.length){var z=M3U8Parser.findGroup(_,H.groupId)||_[0];assignCodec(H,z,"audioCodec"),assignCodec(H,z,"textCodec")}E.push(H)}}return E},M3U8Parser.parseLevelPlaylist=function parseLevelPlaylist(o,s,m,S,H){var G,q,X,pe=new O.LevelDetails(s),me=pe.fragments,_e=null,Se=0,Ee=0,De=0,$e=0,He=null,et=new A.Fragment(S,s),rt=-1,it=!1;for(J.lastIndex=0,pe.m3u8=o;null!==(G=J.exec(o));){it&&(it=!1,(et=new A.Fragment(S,s)).start=De,et.sn=Se,et.cc=$e,et.level=m,_e&&(et.initSegment=_e,et.rawProgramDateTime=_e.rawProgramDateTime,_e.rawProgramDateTime=null));var at=G[1];if(at){et.duration=parseFloat(at);var ot=(" "+G[2]).slice(1);et.title=ot||null,et.tagList.push(ot?["INF",at,ot]:["INF",at])}else if(G[3])(0,_.isFiniteNumber)(et.duration)&&(et.start=De,X&&setFragLevelKeys(et,X,pe),et.sn=Se,et.level=m,et.cc=$e,et.urlId=H,me.push(et),et.relurl=(" "+G[3]).slice(1),assignProgramDateTime(et,He),He=et,De+=et.duration,Se++,Ee=0,it=!0);else if(G[4]){var st=(" "+G[4]).slice(1);He?et.setByteRange(st,He):et.setByteRange(st)}else if(G[5])et.rawProgramDateTime=(" "+G[5]).slice(1),et.tagList.push(["PROGRAM-DATE-TIME",et.rawProgramDateTime]),-1===rt&&(rt=me.length);else{if(!(G=G[0].match(ae))){z.logger.warn("No matches on slow regex match for level playlist!");continue}for(q=1;q<G.length&&void 0===G[q];q++);var ut=(" "+G[q]).slice(1),ct=(" "+G[q+1]).slice(1),dt=G[q+2]?(" "+G[q+2]).slice(1):"";switch(ut){case"PLAYLIST-TYPE":pe.type=ct.toUpperCase();break;case"MEDIA-SEQUENCE":Se=pe.startSN=parseInt(ct);break;case"SKIP":var ht=new K.AttrList(ct),pt=ht.decimalInteger("SKIPPED-SEGMENTS");if((0,_.isFiniteNumber)(pt)){pe.skippedSegments=pt;for(var gt=pt;gt--;)me.unshift(null);Se+=pt}var _t=ht.enumeratedString("RECENTLY-REMOVED-DATERANGES");_t&&(pe.recentlyRemovedDateranges=_t.split("\t"));break;case"TARGETDURATION":pe.targetduration=parseFloat(ct);break;case"VERSION":pe.version=parseInt(ct);break;case"EXTM3U":break;case"ENDLIST":pe.live=!1;break;case"#":(ct||dt)&&et.tagList.push(dt?[ct,dt]:[ct]);break;case"DISCONTINUITY":$e++,et.tagList.push(["DIS"]);break;case"GAP":et.tagList.push([ut]);break;case"BITRATE":et.tagList.push([ut,ct]);break;case"DATERANGE":var bt=new K.AttrList(ct),kt=new E.DateRange(bt,pe.dateRanges[bt.ID]);kt.isValid||pe.skippedSegments?pe.dateRanges[kt.id]=kt:z.logger.warn('Ignoring invalid DATERANGE tag: "'+ct+'"'),et.tagList.push(["EXT-X-DATERANGE",ct]);break;case"DISCONTINUITY-SEQUENCE":$e=parseInt(ct);break;case"KEY":var It=parseKey(ct,s);if(It.isSupported()){if("NONE"===It.method){X=void 0;break}X||(X={}),X[It.keyFormat]&&(X=_extends({},X)),X[It.keyFormat]=It}else z.logger.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+ct+'"');break;case"START":var At=new K.AttrList(ct).decimalFloatingPoint("TIME-OFFSET");(0,_.isFiniteNumber)(At)&&(pe.startTimeOffset=At);break;case"MAP":var Lt=new K.AttrList(ct);if(et.duration){var Rt=new A.Fragment(S,s);setInitSegment(Rt,Lt,m,X),_e=Rt,et.initSegment=_e,_e.rawProgramDateTime&&!et.rawProgramDateTime&&(et.rawProgramDateTime=_e.rawProgramDateTime)}else setInitSegment(et,Lt,m,X),_e=et,it=!0;break;case"SERVER-CONTROL":var Mt=new K.AttrList(ct);pe.canBlockReload=Mt.bool("CAN-BLOCK-RELOAD"),pe.canSkipUntil=Mt.optionalFloat("CAN-SKIP-UNTIL",0),pe.canSkipDateRanges=pe.canSkipUntil>0&&Mt.bool("CAN-SKIP-DATERANGES"),pe.partHoldBack=Mt.optionalFloat("PART-HOLD-BACK",0),pe.holdBack=Mt.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var zt=new K.AttrList(ct);pe.partTarget=zt.decimalFloatingPoint("PART-TARGET");break;case"PART":var qt=pe.partList;qt||(qt=pe.partList=[]);var Jt=Ee>0?qt[qt.length-1]:void 0,tn=Ee++,nn=new A.Part(new K.AttrList(ct),et,s,tn,Jt);qt.push(nn),et.duration+=nn.duration;break;case"PRELOAD-HINT":var rn=new K.AttrList(ct);pe.preloadHint=rn;break;case"RENDITION-REPORT":var sn=new K.AttrList(ct);pe.renditionReports=pe.renditionReports||[],pe.renditionReports.push(sn);break;default:z.logger.warn("line parsed but not handled: "+G)}}}He&&!He.relurl?(me.pop(),De-=He.duration,pe.partList&&(pe.fragmentHint=He)):pe.partList&&(assignProgramDateTime(et,He),et.cc=$e,pe.fragmentHint=et,X&&setFragLevelKeys(et,X,pe));var un=me.length,pn=me[0],vn=me[un-1];if((De+=pe.skippedSegments*pe.targetduration)>0&&un&&vn){pe.averagetargetduration=De/un;var _n=vn.sn;pe.endSN="initSegment"!==_n?_n:0,pe.live||(vn.endList=!0),pn&&(pe.startCC=pn.cc)}else pe.endSN=0,pe.startCC=0;return pe.fragmentHint&&(De+=pe.fragmentHint.duration),pe.totalduration=De,pe.endCC=$e,rt>0&&function backfillProgramDateTimes(o,s){for(var m=o[s],_=s;_--;){var S=o[_];if(!S)return;S.programDateTime=m.programDateTime-1e3*S.duration,m=S}}(me,rt),pe},M3U8Parser}();function parseKey(o,s){var m,_,S=new K.AttrList(o),E=null!=(m=S.enumeratedString("METHOD"))?m:"",A=S.URI,O=S.hexadecimalInteger("IV"),G=S.enumeratedString("KEYFORMATVERSIONS"),q=null!=(_=S.enumeratedString("KEYFORMAT"))?_:"identity";A&&S.IV&&!O&&z.logger.error("Invalid IV: "+S.IV);var X=A?pe.resolve(A,s):"",J=(G||"1").split("/").map(Number).filter(Number.isFinite);return new H.LevelKey(E,X,q,J,O)}function setCodecs(o,s){["video","audio","text"].forEach((function(m){var _=o.filter((function(o){return(0,G.isCodecType)(o,m)}));if(_.length){var S=_.filter((function(o){return 0===o.lastIndexOf("avc1",0)||0===o.lastIndexOf("mp4a",0)}));s[m+"Codec"]=S.length>0?S[0]:_[0],o=o.filter((function(o){return-1===_.indexOf(o)}))}})),s.unknownCodecs=o}function assignCodec(o,s,m){var _=s[m];_&&(o[m]=_)}function assignProgramDateTime(o,s){o.rawProgramDateTime?o.programDateTime=Date.parse(o.rawProgramDateTime):null!=s&&s.programDateTime&&(o.programDateTime=s.endProgramDateTime),(0,_.isFiniteNumber)(o.programDateTime)||(o.programDateTime=null,o.rawProgramDateTime=null)}function setInitSegment(o,s,m,_){o.relurl=s.URI,s.BYTERANGE&&o.setByteRange(s.BYTERANGE),o.level=m,o.sn="initSegment",_&&(o.levelkeys=_),o.initSegment=null}function setFragLevelKeys(o,s,m){o.levelkeys=s;var _=m.encryptedFragments;_.length&&_[_.length-1].levelkeys===s||!Object.keys(s).some((function(o){return s[o].isCommonEncryption}))||_.push(o)}},"./src/loader/playlist-loader.ts":
/*!***************************************!*\
    !*** ./src/loader/playlist-loader.ts ***!
    \***************************************/function srcLoaderPlaylistLoaderTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return G}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../events */"./src/events.ts"),E=m(/*! ../errors */"./src/errors.ts"),A=m(/*! ../utils/logger */"./src/utils/logger.ts"),O=m(/*! ./m3u8-parser */"./src/loader/m3u8-parser.ts"),H=m(/*! ../types/loader */"./src/types/loader.ts"),K=m(/*! ../utils/attr-list */"./src/utils/attr-list.ts");function getResponseUrl(o,s){var m=o.url;return void 0!==m&&0!==m.indexOf("data:")||(m=s.url),m}var z=function(){function PlaylistLoader(o){this.hls=void 0,this.loaders=Object.create(null),this.hls=o,this.registerListeners()}var o=PlaylistLoader.prototype;return o.startLoad=function startLoad(o){},o.stopLoad=function stopLoad(){this.destroyInternalLoaders()},o.registerListeners=function registerListeners(){var o=this.hls;o.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),o.on(S.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),o.on(S.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},o.unregisterListeners=function unregisterListeners(){var o=this.hls;o.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),o.off(S.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),o.off(S.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},o.createInternalLoader=function createInternalLoader(o){var s=this.hls.config,m=s.pLoader,_=s.loader,S=new(m||_)(s);return o.loader=S,this.loaders[o.type]=S,S},o.getInternalLoader=function getInternalLoader(o){return this.loaders[o.type]},o.resetInternalLoader=function resetInternalLoader(o){this.loaders[o]&&delete this.loaders[o]},o.destroyInternalLoaders=function destroyInternalLoaders(){for(var o in this.loaders){var s=this.loaders[o];s&&s.destroy(),this.resetInternalLoader(o)}},o.destroy=function destroy(){this.unregisterListeners(),this.destroyInternalLoaders()},o.onManifestLoading=function onManifestLoading(o,s){var m=s.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:H.PlaylistContextType.MANIFEST,url:m,deliveryDirectives:null})},o.onLevelLoading=function onLevelLoading(o,s){var m=s.id,_=s.level,S=s.url,E=s.deliveryDirectives;this.load({id:m,groupId:null,level:_,responseType:"text",type:H.PlaylistContextType.LEVEL,url:S,deliveryDirectives:E})},o.onAudioTrackLoading=function onAudioTrackLoading(o,s){var m=s.id,_=s.groupId,S=s.url,E=s.deliveryDirectives;this.load({id:m,groupId:_,level:null,responseType:"text",type:H.PlaylistContextType.AUDIO_TRACK,url:S,deliveryDirectives:E})},o.onSubtitleTrackLoading=function onSubtitleTrackLoading(o,s){var m=s.id,_=s.groupId,S=s.url,E=s.deliveryDirectives;this.load({id:m,groupId:_,level:null,responseType:"text",type:H.PlaylistContextType.SUBTITLE_TRACK,url:S,deliveryDirectives:E})},o.load=function load(o){var s,m,_,S,E,O,K=this.hls.config,z=this.getInternalLoader(o);if(z){var G=z.context;if(G&&G.url===o.url)return void A.logger.trace("[playlist-loader]: playlist request ongoing");A.logger.log("[playlist-loader]: aborting previous loader for type: "+o.type),z.abort()}switch(o.type){case H.PlaylistContextType.MANIFEST:m=K.manifestLoadingMaxRetry,_=K.manifestLoadingTimeOut,S=K.manifestLoadingRetryDelay,E=K.manifestLoadingMaxRetryTimeout;break;case H.PlaylistContextType.LEVEL:case H.PlaylistContextType.AUDIO_TRACK:case H.PlaylistContextType.SUBTITLE_TRACK:m=0,_=K.levelLoadingTimeOut;break;default:m=K.levelLoadingMaxRetry,_=K.levelLoadingTimeOut,S=K.levelLoadingRetryDelay,E=K.levelLoadingMaxRetryTimeout}if((z=this.createInternalLoader(o),null!==(s=o.deliveryDirectives)&&void 0!==s&&s.part)&&(o.type===H.PlaylistContextType.LEVEL&&null!==o.level?O=this.hls.levels[o.level].details:o.type===H.PlaylistContextType.AUDIO_TRACK&&null!==o.id?O=this.hls.audioTracks[o.id].details:o.type===H.PlaylistContextType.SUBTITLE_TRACK&&null!==o.id&&(O=this.hls.subtitleTracks[o.id].details),O)){var q=O.partTarget,X=O.targetduration;q&&X&&(_=Math.min(1e3*Math.max(3*q,.8*X),_))}var J={timeout:_,maxRetry:m,retryDelay:S,maxRetryDelay:E,highWaterMark:0},ae={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};z.load(o,J,ae)},o.loadsuccess=function loadsuccess(o,s,m,_){void 0===_&&(_=null),this.resetInternalLoader(m.type);var S=o.data;0===S.indexOf("#EXTM3U")?(s.parsing.start=performance.now(),S.indexOf("#EXTINF:")>0||S.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(o,s,m,_):this.handleMasterPlaylist(o,s,m,_)):this.handleManifestParsingError(o,m,"no EXTM3U delimiter",_)},o.loaderror=function loaderror(o,s,m){void 0===m&&(m=null),this.handleNetworkError(s,m,!1,o)},o.loadtimeout=function loadtimeout(o,s,m){void 0===m&&(m=null),this.handleNetworkError(s,m,!0)},o.handleMasterPlaylist=function handleMasterPlaylist(o,s,m,_){var E=this.hls,H=o.data,z=getResponseUrl(o,m),G=O.default.parseMasterPlaylist(H,z),q=G.levels,X=G.sessionData,J=G.sessionKeys;if(q.length){var ae=q.map((function(o){return{id:o.attrs.AUDIO,audioCodec:o.audioCodec}})),pe=q.map((function(o){return{id:o.attrs.SUBTITLES,textCodec:o.textCodec}})),me=O.default.parseMasterPlaylistMedia(H,z,"AUDIO",ae),_e=O.default.parseMasterPlaylistMedia(H,z,"SUBTITLES",pe),Se=O.default.parseMasterPlaylistMedia(H,z,"CLOSED-CAPTIONS");if(me.length)me.some((function(o){return!o.url}))||!q[0].audioCodec||q[0].attrs.AUDIO||(A.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),me.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new K.AttrList({}),bitrate:0,url:""}));E.trigger(S.Events.MANIFEST_LOADED,{levels:q,audioTracks:me,subtitles:_e,captions:Se,url:z,stats:s,networkDetails:_,sessionData:X,sessionKeys:J})}else this.handleManifestParsingError(o,m,"no level found in manifest",_)},o.handleTrackOrLevelPlaylist=function handleTrackOrLevelPlaylist(o,s,m,A){var z=this.hls,G=m.id,q=m.level,X=m.type,J=getResponseUrl(o,m),ae=(0,_.isFiniteNumber)(G)?G:0,pe=(0,_.isFiniteNumber)(q)?q:ae,me=function mapContextToLevelType(o){switch(o.type){case H.PlaylistContextType.AUDIO_TRACK:return H.PlaylistLevelType.AUDIO;case H.PlaylistContextType.SUBTITLE_TRACK:return H.PlaylistLevelType.SUBTITLE;default:return H.PlaylistLevelType.MAIN}}(m),_e=O.default.parseLevelPlaylist(o.data,J,pe,me,ae);if(_e.fragments.length){if(X===H.PlaylistContextType.MANIFEST){var Se={attrs:new K.AttrList({}),bitrate:0,details:_e,name:"",url:J};z.trigger(S.Events.MANIFEST_LOADED,{levels:[Se],audioTracks:[],url:J,stats:s,networkDetails:A,sessionData:null,sessionKeys:null})}s.parsing.end=performance.now(),m.levelDetails=_e,this.handlePlaylistLoaded(o,s,m,A)}else z.trigger(S.Events.ERROR,{type:E.ErrorTypes.NETWORK_ERROR,details:E.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:J,reason:"no fragments found in level",level:"number"==typeof m.level?m.level:void 0})},o.handleManifestParsingError=function handleManifestParsingError(o,s,m,_){this.hls.trigger(S.Events.ERROR,{type:E.ErrorTypes.NETWORK_ERROR,details:E.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:s.type===H.PlaylistContextType.MANIFEST,url:o.url,reason:m,response:o,context:s,networkDetails:_})},o.handleNetworkError=function handleNetworkError(o,s,m,_){void 0===m&&(m=!1),A.logger.warn("[playlist-loader]: A network "+(m?"timeout":"error")+" occurred while loading "+o.type+" level: "+o.level+" id: "+o.id+' group-id: "'+o.groupId+'"');var O=E.ErrorDetails.UNKNOWN,K=!1,z=this.getInternalLoader(o);switch(o.type){case H.PlaylistContextType.MANIFEST:O=m?E.ErrorDetails.MANIFEST_LOAD_TIMEOUT:E.ErrorDetails.MANIFEST_LOAD_ERROR,K=!0;break;case H.PlaylistContextType.LEVEL:O=m?E.ErrorDetails.LEVEL_LOAD_TIMEOUT:E.ErrorDetails.LEVEL_LOAD_ERROR,K=!1;break;case H.PlaylistContextType.AUDIO_TRACK:O=m?E.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:E.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,K=!1;break;case H.PlaylistContextType.SUBTITLE_TRACK:O=m?E.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:E.ErrorDetails.SUBTITLE_LOAD_ERROR,K=!1}z&&this.resetInternalLoader(o.type);var G={type:E.ErrorTypes.NETWORK_ERROR,details:O,fatal:K,url:o.url,loader:z,context:o,networkDetails:s};_&&(G.response=_),this.hls.trigger(S.Events.ERROR,G)},o.handlePlaylistLoaded=function handlePlaylistLoaded(o,s,m,_){var E=m.type,A=m.level,O=m.id,K=m.groupId,z=m.loader,G=m.levelDetails,q=m.deliveryDirectives;if(null!=G&&G.targetduration){if(z)switch(G.live&&(z.getCacheAge&&(G.ageHeader=z.getCacheAge()||0),z.getCacheAge&&!isNaN(G.ageHeader)||(G.ageHeader=0)),E){case H.PlaylistContextType.MANIFEST:case H.PlaylistContextType.LEVEL:this.hls.trigger(S.Events.LEVEL_LOADED,{details:G,level:A||0,id:O||0,stats:s,networkDetails:_,deliveryDirectives:q});break;case H.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(S.Events.AUDIO_TRACK_LOADED,{details:G,id:O||0,groupId:K||"",stats:s,networkDetails:_,deliveryDirectives:q});break;case H.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(S.Events.SUBTITLE_TRACK_LOADED,{details:G,id:O||0,groupId:K||"",stats:s,networkDetails:_,deliveryDirectives:q})}}else this.handleManifestParsingError(o,m,"invalid target duration",_)},PlaylistLoader}(),G=z},"./src/polyfills/number.ts":
/*!*********************************!*\
    !*** ./src/polyfills/number.ts ***!
    \*********************************/function srcPolyfillsNumberTs(o,s,m){m.r(s),m.d(s,{MAX_SAFE_INTEGER:function MAX_SAFE_INTEGER(){return S},isFiniteNumber:function isFiniteNumber(){return _}});var _=Number.isFinite||function(o){return"number"==typeof o&&isFinite(o)},S=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":
/*!*********************************!*\
    !*** ./src/remux/aac-helper.ts ***!
    \*********************************/function srcRemuxAacHelperTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _=function(){function AAC(){}return AAC.getSilentFrame=function getSilentFrame(o,s){if("mp4a.40.2"===o){if(1===s)return new Uint8Array([0,200,0,128,35,128]);if(2===s)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===s)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===s)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===s)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===s)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===s)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===s)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===s)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},AAC}()},"./src/remux/mp4-generator.ts":
/*!************************************!*\
    !*** ./src/remux/mp4-generator.ts ***!
    \************************************/function srcRemuxMp4GeneratorTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return E}});var _=Math.pow(2,32)-1,S=function(){function MP4(){}return MP4.init=function init(){var o;for(o in MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},MP4.types)MP4.types.hasOwnProperty(o)&&(MP4.types[o]=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)]);var s=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),m=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:s,audio:m};var _=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),S=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=S,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var E=new Uint8Array([105,115,111,109]),A=new Uint8Array([97,118,99,49]),O=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,E,O,E,A),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,_))},MP4.box=function box(o){for(var s=8,m=arguments.length,_=new Array(m>1?m-1:0),S=1;S<m;S++)_[S-1]=arguments[S];for(var E=_.length,A=E;E--;)s+=_[E].byteLength;var O=new Uint8Array(s);for(O[0]=s>>24&255,O[1]=s>>16&255,O[2]=s>>8&255,O[3]=255&s,O.set(o,4),E=0,s=8;E<A;E++)O.set(_[E],s),s+=_[E].byteLength;return O},MP4.hdlr=function hdlr(o){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[o])},MP4.mdat=function mdat(o){return MP4.box(MP4.types.mdat,o)},MP4.mdhd=function mdhd(o,s){s*=o;var m=Math.floor(s/(_+1)),S=Math.floor(s%(_+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,o>>24&255,o>>16&255,o>>8&255,255&o,m>>24,m>>16&255,m>>8&255,255&m,S>>24,S>>16&255,S>>8&255,255&S,85,196,0,0]))},MP4.mdia=function mdia(o){return MP4.box(MP4.types.mdia,MP4.mdhd(o.timescale,o.duration),MP4.hdlr(o.type),MP4.minf(o))},MP4.mfhd=function mfhd(o){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o]))},MP4.minf=function minf(o){return"audio"===o.type?MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(o)):MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(o))},MP4.moof=function moof(o,s,m){return MP4.box(MP4.types.moof,MP4.mfhd(o),MP4.traf(m,s))},MP4.moov=function moov(o){for(var s=o.length,m=[];s--;)m[s]=MP4.trak(o[s]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(o[0].timescale,o[0].duration)].concat(m).concat(MP4.mvex(o)))},MP4.mvex=function mvex(o){for(var s=o.length,m=[];s--;)m[s]=MP4.trex(o[s]);return MP4.box.apply(null,[MP4.types.mvex].concat(m))},MP4.mvhd=function mvhd(o,s){s*=o;var m=Math.floor(s/(_+1)),S=Math.floor(s%(_+1)),E=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,o>>24&255,o>>16&255,o>>8&255,255&o,m>>24,m>>16&255,m>>8&255,255&m,S>>24,S>>16&255,S>>8&255,255&S,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,E)},MP4.sdtp=function sdtp(o){var s,m,_=o.samples||[],S=new Uint8Array(4+_.length);for(s=0;s<_.length;s++)m=_[s].flags,S[s+4]=m.dependsOn<<4|m.isDependedOn<<2|m.hasRedundancy;return MP4.box(MP4.types.sdtp,S)},MP4.stbl=function stbl(o){return MP4.box(MP4.types.stbl,MP4.stsd(o),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))},MP4.avc1=function avc1(o){var s,m,_,S=[],E=[];for(s=0;s<o.sps.length;s++)_=(m=o.sps[s]).byteLength,S.push(_>>>8&255),S.push(255&_),S=S.concat(Array.prototype.slice.call(m));for(s=0;s<o.pps.length;s++)_=(m=o.pps[s]).byteLength,E.push(_>>>8&255),E.push(255&_),E=E.concat(Array.prototype.slice.call(m));var A=MP4.box(MP4.types.avcC,new Uint8Array([1,S[3],S[4],S[5],255,224|o.sps.length].concat(S).concat([o.pps.length]).concat(E))),O=o.width,H=o.height,K=o.pixelRatio[0],z=o.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,O>>8&255,255&O,H>>8&255,255&H,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),A,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([K>>24,K>>16&255,K>>8&255,255&K,z>>24,z>>16&255,z>>8&255,255&z])))},MP4.esds=function esds(o){var s=o.config.length;return new Uint8Array([0,0,0,0,3,23+s,0,1,0,4,15+s,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([s]).concat(o.config).concat([6,1,2]))},MP4.mp4a=function mp4a(o){var s=o.samplerate;return MP4.box(MP4.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,o.channelCount,0,16,0,0,0,0,s>>8&255,255&s,0,0]),MP4.box(MP4.types.esds,MP4.esds(o)))},MP4.mp3=function mp3(o){var s=o.samplerate;return MP4.box(MP4.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,o.channelCount,0,16,0,0,0,0,s>>8&255,255&s,0,0]))},MP4.stsd=function stsd(o){return"audio"===o.type?"mp3"===o.segmentCodec&&"mp3"===o.codec?MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp3(o)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(o)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(o))},MP4.tkhd=function tkhd(o){var s=o.id,m=o.duration*o.timescale,S=o.width,E=o.height,A=Math.floor(m/(_+1)),O=Math.floor(m%(_+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,s>>24&255,s>>16&255,s>>8&255,255&s,0,0,0,0,A>>24,A>>16&255,A>>8&255,255&A,O>>24,O>>16&255,O>>8&255,255&O,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,S>>8&255,255&S,0,0,E>>8&255,255&E,0,0]))},MP4.traf=function traf(o,s){var m=MP4.sdtp(o),S=o.id,E=Math.floor(s/(_+1)),A=Math.floor(s%(_+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,S>>24,S>>16&255,S>>8&255,255&S])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,E>>24,E>>16&255,E>>8&255,255&E,A>>24,A>>16&255,A>>8&255,255&A])),MP4.trun(o,m.length+16+20+8+16+8+8),m)},MP4.trak=function trak(o){return o.duration=o.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(o),MP4.mdia(o))},MP4.trex=function trex(o){var s=o.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},MP4.trun=function trun(o,s){var m,_,S,E,A,O,H=o.samples||[],K=H.length,z=12+16*K,G=new Uint8Array(z);for(s+=8+z,G.set(["video"===o.type?1:0,0,15,1,K>>>24&255,K>>>16&255,K>>>8&255,255&K,s>>>24&255,s>>>16&255,s>>>8&255,255&s],0),m=0;m<K;m++)S=(_=H[m]).duration,E=_.size,A=_.flags,O=_.cts,G.set([S>>>24&255,S>>>16&255,S>>>8&255,255&S,E>>>24&255,E>>>16&255,E>>>8&255,255&E,A.isLeading<<2|A.dependsOn,A.isDependedOn<<6|A.hasRedundancy<<4|A.paddingValue<<1|A.isNonSync,61440&A.degradPrio,15&A.degradPrio,O>>>24&255,O>>>16&255,O>>>8&255,255&O],12+16*m);return MP4.box(MP4.types.trun,G)},MP4.initSegment=function initSegment(o){MP4.types||MP4.init();var s=MP4.moov(o),m=new Uint8Array(MP4.FTYP.byteLength+s.byteLength);return m.set(MP4.FTYP),m.set(s,MP4.FTYP.byteLength),m},MP4}();S.types=void 0,S.HDLR_TYPES=void 0,S.STTS=void 0,S.STSC=void 0,S.STCO=void 0,S.STSZ=void 0,S.VMHD=void 0,S.SMHD=void 0,S.STSD=void 0,S.FTYP=void 0,S.DINF=void 0;var E=S},"./src/remux/mp4-remuxer.ts":
/*!**********************************!*\
    !*** ./src/remux/mp4-remuxer.ts ***!
    \**********************************/function srcRemuxMp4RemuxerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return X},flushTextTrackMetadataCueSamples:function flushTextTrackMetadataCueSamples(){return _flushTextTrackMetadataCueSamples},flushTextTrackUserdataCueSamples:function flushTextTrackUserdataCueSamples(){return _flushTextTrackUserdataCueSamples},normalizePts:function normalizePts(){return _normalizePts}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ./aac-helper */"./src/remux/aac-helper.ts"),E=m(/*! ./mp4-generator */"./src/remux/mp4-generator.ts"),A=m(/*! ../events */"./src/events.ts"),O=m(/*! ../errors */"./src/errors.ts"),H=m(/*! ../utils/logger */"./src/utils/logger.ts"),K=m(/*! ../types/loader */"./src/types/loader.ts"),z=m(/*! ../utils/timescale-conversion */"./src/utils/timescale-conversion.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}var G=null,q=null,X=function(){function MP4Remuxer(o,s,m,_){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=o,this.config=s,this.typeSupported=m,this.ISGenerated=!1,null===G){var S=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);G=S?parseInt(S[1]):0}if(null===q){var E=navigator.userAgent.match(/Safari\/(\d+)/i);q=E?parseInt(E[1]):0}}var o=MP4Remuxer.prototype;return o.destroy=function destroy(){},o.resetTimeStamp=function resetTimeStamp(o){H.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=o},o.resetNextTimestamp=function resetNextTimestamp(){H.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},o.resetInitSegment=function resetInitSegment(){H.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},o.getVideoStartPts=function getVideoStartPts(o){var s=!1,m=o.reduce((function(o,m){var _=m.pts-o;return _<-4294967296?(s=!0,_normalizePts(o,m.pts)):_>0?o:m.pts}),o[0].pts);return s&&H.logger.debug("PTS rollover detected"),m},o.remux=function remux(o,s,m,_,S,E,A,O){var z,G,q,X,J,ae,pe=S,me=S,_e=o.pid>-1,Se=s.pid>-1,Ee=s.samples.length,De=o.samples.length>0,$e=A&&Ee>0||Ee>1;if((!_e||De)&&(!Se||$e)||this.ISGenerated||A){this.ISGenerated||(q=this.generateIS(o,s,S));var He,et=this.isVideoContiguous,rt=-1;if($e&&(rt=function findKeyframeIndex(o){for(var s=0;s<o.length;s++)if(o[s].key)return s;return-1}(s.samples),!et&&this.config.forceKeyFrameOnDiscontinuity))if(ae=!0,rt>0){H.logger.warn("[mp4-remuxer]: Dropped "+rt+" out of "+Ee+" video samples due to a missing keyframe");var it=this.getVideoStartPts(s.samples);s.samples=s.samples.slice(rt),s.dropped+=rt,He=me+=(s.samples[0].pts-it)/s.inputTimeScale}else-1===rt&&(H.logger.warn("[mp4-remuxer]: No keyframe found out of "+Ee+" video samples"),ae=!1);if(this.ISGenerated){if(De&&$e){var at=this.getVideoStartPts(s.samples),ot=(_normalizePts(o.samples[0].pts,at)-at)/s.inputTimeScale;pe+=Math.max(0,ot),me+=Math.max(0,-ot)}if(De){if(o.samplerate||(H.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),q=this.generateIS(o,s,S)),G=this.remuxAudio(o,pe,this.isAudioContiguous,E,Se||$e||O===K.PlaylistLevelType.AUDIO?me:void 0),$e){var st=G?G.endPTS-G.startPTS:0;s.inputTimeScale||(H.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),q=this.generateIS(o,s,S)),z=this.remuxVideo(s,me,et,st)}}else $e&&(z=this.remuxVideo(s,me,et,0));z&&(z.firstKeyFrame=rt,z.independent=-1!==rt,z.firstKeyFramePTS=He)}}return this.ISGenerated&&(m.samples.length&&(J=_flushTextTrackMetadataCueSamples(m,S,this._initPTS,this._initDTS)),_.samples.length&&(X=_flushTextTrackUserdataCueSamples(_,S,this._initPTS))),{audio:G,video:z,initSegment:q,independent:ae,text:X,id3:J}},o.generateIS=function generateIS(o,s,m){var S,A,O,H=o.samples,K=s.samples,z=this.typeSupported,G={},q=!(0,_.isFiniteNumber)(this._initPTS),X="audio/mp4";if(q&&(S=A=1/0),o.config&&H.length){if(o.timescale=o.samplerate,"mp3"===o.segmentCodec)z.mpeg?(X="audio/mpeg",o.codec=""):z.mp3&&(o.codec="mp3");G.audio={id:"audio",container:X,codec:o.codec,initSegment:"mp3"===o.segmentCodec&&z.mpeg?new Uint8Array(0):E.default.initSegment([o]),metadata:{channelCount:o.channelCount}},q&&(O=o.inputTimeScale,S=A=H[0].pts-Math.round(O*m))}if(s.sps&&s.pps&&K.length&&(s.timescale=s.inputTimeScale,G.video={id:"main",container:"video/mp4",codec:s.codec,initSegment:E.default.initSegment([s]),metadata:{width:s.width,height:s.height}},q)){O=s.inputTimeScale;var J=this.getVideoStartPts(K),ae=Math.round(O*m);A=Math.min(A,_normalizePts(K[0].dts,J)-ae),S=Math.min(S,J-ae)}if(Object.keys(G).length)return this.ISGenerated=!0,q&&(this._initPTS=S,this._initDTS=A),{tracks:G,initPTS:S,timescale:O}},o.remuxVideo=function remuxVideo(o,s,m,_){var S,K,X=o.inputTimeScale,ae=o.samples,pe=[],me=ae.length,_e=this._initPTS,Se=this.nextAvcDts,Ee=8,De=this.videoSampleDuration,$e=Number.POSITIVE_INFINITY,He=Number.NEGATIVE_INFINITY,et=!1;m&&null!==Se||(Se=s*X-(ae[0].pts-_normalizePts(ae[0].dts,ae[0].pts)));for(var rt=0;rt<me;rt++){var it=ae[rt];it.pts=_normalizePts(it.pts-_e,Se),it.dts=_normalizePts(it.dts-_e,Se),it.dts<ae[rt>0?rt-1:rt].dts&&(et=!0)}et&&ae.sort((function(o,s){var m=o.dts-s.dts,_=o.pts-s.pts;return m||_})),S=ae[0].dts;var at=(K=ae[ae.length-1].dts)-S,ot=at?Math.round(at/(me-1)):De||o.inputTimeScale/30;if(m){var st=S-Se,ut=st>ot,ct=st<-1;if((ut||ct)&&(ut?H.logger.warn("AVC: "+(0,z.toMsFromMpegTsClock)(st,!0)+" ms ("+st+"dts) hole between fragments detected, filling it"):H.logger.warn("AVC: "+(0,z.toMsFromMpegTsClock)(-st,!0)+" ms ("+st+"dts) overlapping between fragments detected"),!ct||Se>ae[0].pts)){S=Se;var dt=ae[0].pts-st;ae[0].dts=S,ae[0].pts=dt,H.logger.log("Video: First PTS/DTS adjusted: "+(0,z.toMsFromMpegTsClock)(dt,!0)+"/"+(0,z.toMsFromMpegTsClock)(S,!0)+", delta: "+(0,z.toMsFromMpegTsClock)(st,!0)+" ms")}}S=Math.max(0,S);for(var ht=0,pt=0,gt=0;gt<me;gt++){for(var _t=ae[gt],bt=_t.units,kt=bt.length,It=0,At=0;At<kt;At++)It+=bt[At].data.length;pt+=It,ht+=kt,_t.length=It,_t.dts=Math.max(_t.dts,S),$e=Math.min(_t.pts,$e),He=Math.max(_t.pts,He)}K=ae[me-1].dts;var Lt,Rt=pt+4*ht+8;try{Lt=new Uint8Array(Rt)}catch(o){return void this.observer.emit(A.Events.ERROR,A.Events.ERROR,{type:O.ErrorTypes.MUX_ERROR,details:O.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Rt,reason:"fail allocating video mdat "+Rt})}var Mt=new DataView(Lt.buffer);Mt.setUint32(0,Rt),Lt.set(E.default.types.mdat,4);for(var zt=!1,qt=Number.POSITIVE_INFINITY,Jt=Number.POSITIVE_INFINITY,tn=Number.NEGATIVE_INFINITY,nn=Number.NEGATIVE_INFINITY,rn=0;rn<me;rn++){for(var sn=ae[rn],un=sn.units,pn=0,vn=0,_n=un.length;vn<_n;vn++){var Cn=un[vn],wn=Cn.data,xn=Cn.data.byteLength;Mt.setUint32(Ee,xn),Ee+=4,Lt.set(wn,Ee),Ee+=xn,pn+=4+xn}var In=void 0;if(rn<me-1)De=ae[rn+1].dts-sn.dts,In=ae[rn+1].pts-sn.pts;else{var An=this.config,Fn=rn>0?sn.dts-ae[rn-1].dts:ot;if(In=rn>0?sn.pts-ae[rn-1].pts:ot,An.stretchShortVideoTrack&&null!==this.nextAudioPts){var Gn=Math.floor(An.maxBufferHole*X),qn=(_?$e+_*X:this.nextAudioPts)-sn.pts;qn>Gn?((De=qn-Fn)<0?De=Fn:zt=!0,H.logger.log("[mp4-remuxer]: It is approximately "+qn/90+" ms to the next segment; using duration "+De/90+" ms for the last video frame.")):De=Fn}else De=Fn}var ar=Math.round(sn.pts-sn.dts);qt=Math.min(qt,De),tn=Math.max(tn,De),Jt=Math.min(Jt,In),nn=Math.max(nn,In),pe.push(new J(sn.key,De,pn,ar))}if(pe.length)if(G){if(G<70){var vr=pe[0].flags;vr.dependsOn=2,vr.isNonSync=0}}else if(q&&nn-Jt<tn-qt&&ot/tn<.025&&0===pe[0].cts){H.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var _r=S,wr=0,Pr=pe.length;wr<Pr;wr++){var Or=_r+pe[wr].duration,Vr=_r+pe[wr].cts;if(wr<Pr-1){var oi=Or+pe[wr+1].cts;pe[wr].duration=oi-Vr}else pe[wr].duration=wr?pe[wr-1].duration:ot;pe[wr].cts=0,_r=Or}}console.assert(null!==De,"mp4SampleDuration must be computed"),De=zt||!De?ot:De,this.nextAvcDts=Se=K+De,this.videoSampleDuration=De,this.isVideoContiguous=!0;var li={data1:E.default.moof(o.sequenceNumber++,S,_extends({},o,{samples:pe})),data2:Lt,startPTS:$e/X,endPTS:(He+De)/X,startDTS:S/X,endDTS:Se/X,type:"video",hasAudio:!1,hasVideo:!0,nb:pe.length,dropped:o.dropped};return o.samples=[],o.dropped=0,console.assert(Lt.length,"MDAT length must not be zero"),li},o.remuxAudio=function remuxAudio(o,s,m,_,K){var z=o.inputTimeScale,G=z/(o.samplerate?o.samplerate:z),q="aac"===o.segmentCodec?1024:1152,X=q*G,ae=this._initPTS,pe="mp3"===o.segmentCodec&&this.typeSupported.mpeg,me=[],_e=void 0!==K,Se=o.samples,Ee=pe?0:8,De=this.nextAudioPts||-1,$e=s*z;if(this.isAudioContiguous=m=m||Se.length&&De>0&&(_&&Math.abs($e-De)<9e3||Math.abs(_normalizePts(Se[0].pts-ae,$e)-De)<20*X),Se.forEach((function(o){o.pts=_normalizePts(o.pts-ae,$e)})),!m||De<0){if(Se=Se.filter((function(o){return o.pts>=0})),!Se.length)return;De=0===K?0:_&&!_e?Math.max(0,$e):Se[0].pts}if("aac"===o.segmentCodec)for(var He=this.config.maxAudioFramesDrift,et=0,rt=De;et<Se.length;et++){var it=Se[et],at=it.pts,ot=at-rt,st=Math.abs(1e3*ot/z);if(ot<=-He*X&&_e)0===et&&(H.logger.warn("Audio frame @ "+(at/z).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*ot/z)+" ms."),this.nextAudioPts=De=rt=at);else if(ot>=He*X&&st<1e4&&_e){var ut=Math.round(ot/X);(rt=at-ut*X)<0&&(ut--,rt+=X),0===et&&(this.nextAudioPts=De=rt),H.logger.warn("[mp4-remuxer]: Injecting "+ut+" audio frame @ "+(rt/z).toFixed(3)+"s due to "+Math.round(1e3*ot/z)+" ms gap.");for(var ct=0;ct<ut;ct++){var dt=Math.max(rt,0),ht=S.default.getSilentFrame(o.manifestCodec||o.codec,o.channelCount);ht||(H.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),ht=it.unit.subarray()),Se.splice(et,0,{unit:ht,pts:dt}),rt+=X,et++}}it.pts=rt,rt+=X}for(var pt,gt=null,_t=null,bt=0,kt=Se.length;kt--;)bt+=Se[kt].unit.byteLength;for(var It=0,At=Se.length;It<At;It++){var Lt=Se[It],Rt=Lt.unit,Mt=Lt.pts;if(null!==_t){me[It-1].duration=Math.round((Mt-_t)/G)}else{if(m&&"aac"===o.segmentCodec&&(Mt=De),gt=Mt,!(bt>0))return;bt+=Ee;try{pt=new Uint8Array(bt)}catch(o){return void this.observer.emit(A.Events.ERROR,A.Events.ERROR,{type:O.ErrorTypes.MUX_ERROR,details:O.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:bt,reason:"fail allocating audio mdat "+bt})}pe||(new DataView(pt.buffer).setUint32(0,bt),pt.set(E.default.types.mdat,4))}pt.set(Rt,Ee);var zt=Rt.byteLength;Ee+=zt,me.push(new J(!0,q,zt,0)),_t=Mt}var qt=me.length;if(qt){var Jt=me[me.length-1];this.nextAudioPts=De=_t+G*Jt.duration;var tn=pe?new Uint8Array(0):E.default.moof(o.sequenceNumber++,gt/G,_extends({},o,{samples:me}));o.samples=[];var nn=gt/z,rn=De/z,sn={data1:tn,data2:pt,startPTS:nn,endPTS:rn,startDTS:nn,endDTS:rn,type:"audio",hasAudio:!0,hasVideo:!1,nb:qt};return this.isAudioContiguous=!0,console.assert(pt.length,"MDAT length must not be zero"),sn}},o.remuxEmptyAudio=function remuxEmptyAudio(o,s,m,_){var E=o.inputTimeScale,A=E/(o.samplerate?o.samplerate:E),O=this.nextAudioPts,K=(null!==O?O:_.startDTS*E)+this._initDTS,z=_.endDTS*E+this._initDTS,G=1024*A,q=Math.ceil((z-K)/G),X=S.default.getSilentFrame(o.manifestCodec||o.codec,o.channelCount);if(H.logger.warn("[mp4-remuxer]: remux empty Audio"),X){for(var J=[],ae=0;ae<q;ae++){var pe=K+ae*G;J.push({unit:X,pts:pe,dts:pe})}return o.samples=J,this.remuxAudio(o,s,m,!1)}H.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},MP4Remuxer}();function _normalizePts(o,s){var m;if(null===s)return o;for(m=s<o?-8589934592:8589934592;Math.abs(o-s)>4294967296;)o+=m;return o}function _flushTextTrackMetadataCueSamples(o,s,m,_){var S=o.samples.length;if(S){for(var E=o.inputTimeScale,A=0;A<S;A++){var O=o.samples[A];O.pts=_normalizePts(O.pts-m,s*E)/E,O.dts=_normalizePts(O.dts-_,s*E)/E}var H=o.samples;return o.samples=[],{samples:H}}}function _flushTextTrackUserdataCueSamples(o,s,m){var _=o.samples.length;if(_){for(var S=o.inputTimeScale,E=0;E<_;E++){var A=o.samples[E];A.pts=_normalizePts(A.pts-m,s*S)/S}o.samples.sort((function(o,s){return o.pts-s.pts}));var O=o.samples;return o.samples=[],{samples:O}}}var J=function Mp4Sample(o,s,m,_){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=s,this.size=m,this.cts=_,this.flags=new ae(o)},ae=function Mp4SampleFlags(o){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=o?2:1,this.isNonSync=o?0:1}},"./src/remux/passthrough-remuxer.ts":
/*!******************************************!*\
    !*** ./src/remux/passthrough-remuxer.ts ***!
    \******************************************/function srcRemuxPassthroughRemuxerTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return K}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ./mp4-remuxer */"./src/remux/mp4-remuxer.ts"),E=m(/*! ../utils/mp4-tools */"./src/utils/mp4-tools.ts"),A=m(/*! ../loader/fragment */"./src/loader/fragment.ts"),O=m(/*! ../utils/logger */"./src/utils/logger.ts"),H=function(){function PassThroughRemuxer(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var o=PassThroughRemuxer.prototype;return o.destroy=function destroy(){},o.resetTimeStamp=function resetTimeStamp(o){this.initPTS=o,this.lastEndTime=null},o.resetNextTimestamp=function resetNextTimestamp(){this.lastEndTime=null},o.resetInitSegment=function resetInitSegment(o,s,m,_){this.audioCodec=s,this.videoCodec=m,this.generateInitSegment((0,E.patchEncyptionData)(o,_)),this.emitInitSegment=!0},o.generateInitSegment=function generateInitSegment(o){var s=this.audioCodec,m=this.videoCodec;if(!o||!o.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var _=this.initData=(0,E.parseInitSegment)(o);s||(s=getParsedTrackCodec(_.audio,A.ElementaryStreamTypes.AUDIO)),m||(m=getParsedTrackCodec(_.video,A.ElementaryStreamTypes.VIDEO));var S={};_.audio&&_.video?S.audiovideo={container:"video/mp4",codec:s+","+m,initSegment:o,id:"main"}:_.audio?S.audio={container:"audio/mp4",codec:s,initSegment:o,id:"audio"}:_.video?S.video={container:"video/mp4",codec:m,initSegment:o,id:"main"}:O.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=S},o.remux=function remux(o,s,m,A,H){var K,z=this.initPTS,G=this.lastEndTime,q={audio:void 0,video:void 0,text:A,id3:m,initSegment:void 0};(0,_.isFiniteNumber)(G)||(G=this.lastEndTime=H||0);var X=s.samples;if(!X||!X.length)return q;var J={initPTS:void 0,timescale:1},ae=this.initData;if(ae&&ae.length||(this.generateInitSegment(X),ae=this.initData),!ae||!ae.length)return O.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),q;this.emitInitSegment&&(J.tracks=this.initTracks,this.emitInitSegment=!1);var pe=(0,E.getStartDTS)(ae,X);(0,_.isFiniteNumber)(z)||(this.initPTS=J.initPTS=z=pe-H);var me=(0,E.getDuration)(X,ae),_e=o?pe-z:G,Se=_e+me;(0,E.offsetStartDTS)(ae,X,z),me>0?this.lastEndTime=Se:(O.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var Ee=!!ae.audio,De=!!ae.video,$e="";Ee&&($e+="audio"),De&&($e+="video");var He={data1:X,startPTS:_e,startDTS:_e,endPTS:Se,endDTS:Se,type:$e,hasAudio:Ee,hasVideo:De,nb:1,dropped:0};q.audio="audio"===He.type?He:void 0,q.video="audio"!==He.type?He:void 0,q.initSegment=J;var et=null!=(K=this.initPTS)?K:0;return q.id3=(0,S.flushTextTrackMetadataCueSamples)(m,H,et,et),A.samples.length&&(q.text=(0,S.flushTextTrackUserdataCueSamples)(A,H,et)),q},PassThroughRemuxer}();function getParsedTrackCodec(o,s){var m=null==o?void 0:o.codec;return m&&m.length>4?m:"hvc1"===m||"hev1"===m?"hvc1.1.c.L120.90":"av01"===m?"av01.0.04M.08":"avc1"===m||s===A.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}var K=H},"./src/task-loop.ts":
/*!**************************!*\
    !*** ./src/task-loop.ts ***!
    \**************************/function srcTaskLoopTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _=function(){function TaskLoop(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var o=TaskLoop.prototype;return o.destroy=function destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()},o.onHandlerDestroying=function onHandlerDestroying(){this.clearNextTick(),this.clearInterval()},o.onHandlerDestroyed=function onHandlerDestroyed(){},o.hasInterval=function hasInterval(){return!!this._tickInterval},o.hasNextTick=function hasNextTick(){return!!this._tickTimer},o.setInterval=function setInterval(o){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,o),!0)},o.clearInterval=function clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},o.clearNextTick=function clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},o.tick=function tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},o.tickImmediate=function tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},o.doTick=function doTick(){},TaskLoop}()},"./src/types/cmcd.ts":
/*!***************************!*\
    !*** ./src/types/cmcd.ts ***!
    \***************************/function srcTypesCmcdTs(o,s,m){m.r(s),m.d(s,{CMCDObjectType:function CMCDObjectType(){return _},CMCDStreamType:function CMCDStreamType(){return O},CMCDStreamingFormat:function CMCDStreamingFormat(){return E},CMCDVersion:function CMCDVersion(){return K}});var _,S,E,A,O,H,K=1;(S=_||(_={})).MANIFEST="m",S.AUDIO="a",S.VIDEO="v",S.MUXED="av",S.INIT="i",S.CAPTION="c",S.TIMED_TEXT="tt",S.KEY="k",S.OTHER="o",(A=E||(E={})).DASH="d",A.HLS="h",A.SMOOTH="s",A.OTHER="o",(H=O||(O={})).VOD="v",H.LIVE="l"},"./src/types/demuxer.ts":
/*!******************************!*\
    !*** ./src/types/demuxer.ts ***!
    \******************************/function srcTypesDemuxerTs(o,s,m){var _,S;m.r(s),m.d(s,{MetadataSchema:function MetadataSchema(){return _}}),(S=_||(_={})).audioId3="org.id3",S.dateRange="com.apple.quicktime.HLS",S.emsg="https://aomedia.org/emsg/ID3"},"./src/types/level.ts":
/*!****************************!*\
    !*** ./src/types/level.ts ***!
    \****************************/function srcTypesLevelTs(o,s,m){function _defineProperties(o,s){for(var m=0;m<s.length;m++){var _=s[m];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(o,(S=_.key,E=void 0,"symbol"==typeof(E=function _toPrimitive(o,s){if("object"!=typeof o||null===o)return o;var m=o[Symbol.toPrimitive];if(void 0!==m){var _=m.call(o,s||"default");if("object"!=typeof _)return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===s?String:Number)(o)}(S,"string"))?E:String(E)),_)}var S,E}m.r(s),m.d(s,{HdcpLevels:function HdcpLevels(){return E},HlsSkip:function HlsSkip(){return _},HlsUrlParameters:function HlsUrlParameters(){return A},Level:function Level(){return O},getSkipValue:function getSkipValue(){return _getSkipValue}});var _,S,E=["NONE","TYPE-0","TYPE-1","TYPE-2",null];function _getSkipValue(o,s){var m=o.canSkipUntil,S=o.canSkipDateRanges,E=o.endSN;return m&&(void 0!==s?s-E:0)<m?S?_.v2:_.Yes:_.No}(S=_||(_={})).No="",S.Yes="YES",S.v2="v2";var A=function(){function HlsUrlParameters(o,s,m){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=o,this.part=s,this.skip=m}return HlsUrlParameters.prototype.addDirectives=function addDirectives(o){var s=new self.URL(o);return void 0!==this.msn&&s.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&s.searchParams.set("_HLS_part",this.part.toString()),this.skip&&s.searchParams.set("_HLS_skip",this.skip),s.href},HlsUrlParameters}(),O=function(){function Level(o){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[o.url],this.attrs=o.attrs,this.bitrate=o.bitrate,o.details&&(this.details=o.details),this.id=o.id||0,this.name=o.name,this.width=o.width||0,this.height=o.height||0,this.audioCodec=o.audioCodec,this.videoCodec=o.videoCodec,this.unknownCodecs=o.unknownCodecs,this.codecSet=[o.videoCodec,o.audioCodec].filter((function(o){return o})).join(",").replace(/\.[^.,]+/g,"")}return function _createClass(o,s,m){return s&&_defineProperties(o.prototype,s),m&&_defineProperties(o,m),Object.defineProperty(o,"prototype",{writable:!1}),o}(Level,[{key:"maxBitrate",get:function get(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function get(){return this.url[this._urlId]||""}},{key:"urlId",get:function get(){return this._urlId},set:function set(o){var s=o%this.url.length;this._urlId!==s&&(this.details=void 0,this._urlId=s)}}]),Level}()},"./src/types/loader.ts":
/*!*****************************!*\
    !*** ./src/types/loader.ts ***!
    \*****************************/function srcTypesLoaderTs(o,s,m){var _,S,E,A;m.r(s),m.d(s,{PlaylistContextType:function PlaylistContextType(){return _},PlaylistLevelType:function PlaylistLevelType(){return E}}),(S=_||(_={})).MANIFEST="manifest",S.LEVEL="level",S.AUDIO_TRACK="audioTrack",S.SUBTITLE_TRACK="subtitleTrack",(A=E||(E={})).MAIN="main",A.AUDIO="audio",A.SUBTITLE="subtitle"},"./src/types/transmuxer.ts":
/*!*********************************!*\
    !*** ./src/types/transmuxer.ts ***!
    \*********************************/function srcTypesTransmuxerTs(o,s,m){m.r(s),m.d(s,{ChunkMetadata:function ChunkMetadata(){return _}});var _=function ChunkMetadata(o,s,m,_,S,E){void 0===_&&(_=0),void 0===S&&(S=-1),void 0===E&&(E=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=o,this.sn=s,this.id=m,this.size=_,this.part=S,this.partial=E}},"./src/utils/attr-list.ts":
/*!********************************!*\
    !*** ./src/utils/attr-list.ts ***!
    \********************************/function srcUtilsAttrListTs(o,s,m){m.r(s),m.d(s,{AttrList:function AttrList(){return E}});var _=/^(\d+)x(\d+)$/,S=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,E=function(){function AttrList(o){for(var s in"string"==typeof o&&(o=AttrList.parseAttrList(o)),o)o.hasOwnProperty(s)&&(this[s]=o[s])}var o=AttrList.prototype;return o.decimalInteger=function decimalInteger(o){var s=parseInt(this[o],10);return s>Number.MAX_SAFE_INTEGER?1/0:s},o.hexadecimalInteger=function hexadecimalInteger(o){if(this[o]){var s=(this[o]||"0x").slice(2);s=(1&s.length?"0":"")+s;for(var m=new Uint8Array(s.length/2),_=0;_<s.length/2;_++)m[_]=parseInt(s.slice(2*_,2*_+2),16);return m}return null},o.hexadecimalIntegerAsNumber=function hexadecimalIntegerAsNumber(o){var s=parseInt(this[o],16);return s>Number.MAX_SAFE_INTEGER?1/0:s},o.decimalFloatingPoint=function decimalFloatingPoint(o){return parseFloat(this[o])},o.optionalFloat=function optionalFloat(o,s){var m=this[o];return m?parseFloat(m):s},o.enumeratedString=function enumeratedString(o){return this[o]},o.bool=function bool(o){return"YES"===this[o]},o.decimalResolution=function decimalResolution(o){var s=_.exec(this[o]);if(null!==s)return{width:parseInt(s[1],10),height:parseInt(s[2],10)}},AttrList.parseAttrList=function parseAttrList(o){var s,m={};for(S.lastIndex=0;null!==(s=S.exec(o));){var _=s[2];0===_.indexOf('"')&&_.lastIndexOf('"')===_.length-1&&(_=_.slice(1,-1)),m[s[1]]=_}return m},AttrList}()},"./src/utils/binary-search.ts":
/*!************************************!*\
    !*** ./src/utils/binary-search.ts ***!
    \************************************/function srcUtilsBinarySearchTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _={search:function search(o,s){for(var m=0,_=o.length-1,S=null,E=null;m<=_;){var A=s(E=o[S=(m+_)/2|0]);if(A>0)m=S+1;else{if(!(A<0))return E;_=S-1}}return null}}},"./src/utils/buffer-helper.ts":
/*!************************************!*\
    !*** ./src/utils/buffer-helper.ts ***!
    \************************************/function srcUtilsBufferHelperTs(o,s,m){m.r(s),m.d(s,{BufferHelper:function BufferHelper(){return E}});var _=m(/*! ./logger */"./src/utils/logger.ts"),S={length:0,start:function start(){return 0},end:function end(){return 0}},E=function(){function BufferHelper(){}return BufferHelper.isBuffered=function isBuffered(o,s){try{if(o)for(var m=BufferHelper.getBuffered(o),_=0;_<m.length;_++)if(s>=m.start(_)&&s<=m.end(_))return!0}catch(o){}return!1},BufferHelper.bufferInfo=function bufferInfo(o,s,m){try{if(o){var _,S=BufferHelper.getBuffered(o),E=[];for(_=0;_<S.length;_++)E.push({start:S.start(_),end:S.end(_)});return this.bufferedInfo(E,s,m)}}catch(o){}return{len:0,start:s,end:s,nextStart:void 0}},BufferHelper.bufferedInfo=function bufferedInfo(o,s,m){s=Math.max(0,s),o.sort((function(o,s){var m=o.start-s.start;return m||s.end-o.end}));var _=[];if(m)for(var S=0;S<o.length;S++){var E=_.length;if(E){var A=_[E-1].end;o[S].start-A<m?o[S].end>A&&(_[E-1].end=o[S].end):_.push(o[S])}else _.push(o[S])}else _=o;for(var O,H=0,K=s,z=s,G=0;G<_.length;G++){var q=_[G].start,X=_[G].end;if(s+m>=q&&s<X)K=q,H=(z=X)-s;else if(s+m<q){O=q;break}}return{len:H,start:K||0,end:z||0,nextStart:O}},BufferHelper.getBuffered=function getBuffered(o){try{return o.buffered}catch(o){return _.logger.log("failed to get media.buffered",o),S}},BufferHelper}()},"./src/utils/cea-608-parser.ts":
/*!*************************************!*\
    !*** ./src/utils/cea-608-parser.ts ***!
    \*************************************/function srcUtilsCea608ParserTs(o,s,m){m.r(s),m.d(s,{CaptionScreen:function CaptionScreen(){return Se},Row:function Row(){return _e},default:function _default(){return $e}});var _,S=m(/*! ../utils/logger */"./src/utils/logger.ts"),E={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},A=function getCharForByte(o){var s=o;return E.hasOwnProperty(o)&&(s=E[o]),String.fromCharCode(s)},O=15,H=100,K={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},z={17:2,18:4,21:6,22:8,23:10,19:13,20:15},G={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},q={25:2,26:4,29:6,30:8,31:10,27:13,28:15},X=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(o){o[o.ERROR=0]="ERROR",o[o.TEXT=1]="TEXT",o[o.WARNING=2]="WARNING",o[o.INFO=2]="INFO",o[o.DEBUG=3]="DEBUG",o[o.DATA=3]="DATA"}(_||(_={}));var J=function(){function CaptionsLogger(){this.time=null,this.verboseLevel=_.ERROR}return CaptionsLogger.prototype.log=function log(o,s){if(this.verboseLevel>=o){var m="function"==typeof s?s():s;S.logger.log(this.time+" ["+o+"] "+m)}},CaptionsLogger}(),ae=function numArrayToHexArray(o){for(var s=[],m=0;m<o.length;m++)s.push(o[m].toString(16));return s},pe=function(){function PenState(o,s,m,_,S){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=o||"white",this.underline=s||!1,this.italics=m||!1,this.background=_||"black",this.flash=S||!1}var o=PenState.prototype;return o.reset=function reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},o.setStyles=function setStyles(o){for(var s=["foreground","underline","italics","background","flash"],m=0;m<s.length;m++){var _=s[m];o.hasOwnProperty(_)&&(this[_]=o[_])}},o.isDefault=function isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},o.equals=function equals(o){return this.foreground===o.foreground&&this.underline===o.underline&&this.italics===o.italics&&this.background===o.background&&this.flash===o.flash},o.copy=function copy(o){this.foreground=o.foreground,this.underline=o.underline,this.italics=o.italics,this.background=o.background,this.flash=o.flash},o.toString=function toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},PenState}(),me=function(){function StyledUnicodeChar(o,s,m,_,S,E){this.uchar=void 0,this.penState=void 0,this.uchar=o||" ",this.penState=new pe(s,m,_,S,E)}var o=StyledUnicodeChar.prototype;return o.reset=function reset(){this.uchar=" ",this.penState.reset()},o.setChar=function setChar(o,s){this.uchar=o,this.penState.copy(s)},o.setPenState=function setPenState(o){this.penState.copy(o)},o.equals=function equals(o){return this.uchar===o.uchar&&this.penState.equals(o.penState)},o.copy=function copy(o){this.uchar=o.uchar,this.penState.copy(o.penState)},o.isEmpty=function isEmpty(){return" "===this.uchar&&this.penState.isDefault()},StyledUnicodeChar}(),_e=function(){function Row(o){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var s=0;s<H;s++)this.chars.push(new me);this.logger=o,this.pos=0,this.currPenState=new pe}var o=Row.prototype;return o.equals=function equals(o){for(var s=!0,m=0;m<H;m++)if(!this.chars[m].equals(o.chars[m])){s=!1;break}return s},o.copy=function copy(o){for(var s=0;s<H;s++)this.chars[s].copy(o.chars[s])},o.isEmpty=function isEmpty(){for(var o=!0,s=0;s<H;s++)if(!this.chars[s].isEmpty()){o=!1;break}return o},o.setCursor=function setCursor(o){this.pos!==o&&(this.pos=o),this.pos<0?(this.logger.log(_.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>H&&(this.logger.log(_.DEBUG,"Too large cursor position "+this.pos),this.pos=H)},o.moveCursor=function moveCursor(o){var s=this.pos+o;if(o>1)for(var m=this.pos+1;m<s+1;m++)this.chars[m].setPenState(this.currPenState);this.setCursor(s)},o.backSpace=function backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},o.insertChar=function insertChar(o){var s=this;o>=144&&this.backSpace();var m=A(o);this.pos>=H?this.logger.log(_.ERROR,(function(){return"Cannot insert "+o.toString(16)+" ("+m+") at position "+s.pos+". Skipping it!"})):(this.chars[this.pos].setChar(m,this.currPenState),this.moveCursor(1))},o.clearFromPos=function clearFromPos(o){var s;for(s=o;s<H;s++)this.chars[s].reset()},o.clear=function clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},o.clearToEndOfRow=function clearToEndOfRow(){this.clearFromPos(this.pos)},o.getTextString=function getTextString(){for(var o=[],s=!0,m=0;m<H;m++){var _=this.chars[m].uchar;" "!==_&&(s=!1),o.push(_)}return s?"":o.join("")},o.setPenStyles=function setPenStyles(o){this.currPenState.setStyles(o),this.chars[this.pos].setPenState(this.currPenState)},Row}(),Se=function(){function CaptionScreen(o){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var s=0;s<O;s++)this.rows.push(new _e(o));this.logger=o,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var o=CaptionScreen.prototype;return o.reset=function reset(){for(var o=0;o<O;o++)this.rows[o].clear();this.currRow=14},o.equals=function equals(o){for(var s=!0,m=0;m<O;m++)if(!this.rows[m].equals(o.rows[m])){s=!1;break}return s},o.copy=function copy(o){for(var s=0;s<O;s++)this.rows[s].copy(o.rows[s])},o.isEmpty=function isEmpty(){for(var o=!0,s=0;s<O;s++)if(!this.rows[s].isEmpty()){o=!1;break}return o},o.backSpace=function backSpace(){this.rows[this.currRow].backSpace()},o.clearToEndOfRow=function clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()},o.insertChar=function insertChar(o){this.rows[this.currRow].insertChar(o)},o.setPen=function setPen(o){this.rows[this.currRow].setPenStyles(o)},o.moveCursor=function moveCursor(o){this.rows[this.currRow].moveCursor(o)},o.setCursor=function setCursor(o){this.logger.log(_.INFO,"setCursor: "+o),this.rows[this.currRow].setCursor(o)},o.setPAC=function setPAC(o){this.logger.log(_.INFO,(function(){return"pacData = "+JSON.stringify(o)}));var s=o.row-1;if(this.nrRollUpRows&&s<this.nrRollUpRows-1&&(s=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==s){for(var m=0;m<O;m++)this.rows[m].clear();var S=this.currRow+1-this.nrRollUpRows,E=this.lastOutputScreen;if(E){var A=E.rows[S].cueStartTime,H=this.logger.time;if(A&&null!==H&&A<H)for(var K=0;K<this.nrRollUpRows;K++)this.rows[s-this.nrRollUpRows+K+1].copy(E.rows[S+K])}}this.currRow=s;var z=this.rows[this.currRow];if(null!==o.indent){var G=o.indent,q=Math.max(G-1,0);z.setCursor(o.indent),o.color=z.chars[q].penState.foreground}var X={foreground:o.color,underline:o.underline,italics:o.italics,background:"black",flash:!1};this.setPen(X)},o.setBkgData=function setBkgData(o){this.logger.log(_.INFO,(function(){return"bkgData = "+JSON.stringify(o)})),this.backSpace(),this.setPen(o),this.insertChar(32)},o.setRollUpRows=function setRollUpRows(o){this.nrRollUpRows=o},o.rollUp=function rollUp(){var o=this;if(null!==this.nrRollUpRows){this.logger.log(_.TEXT,(function(){return o.getDisplayText()}));var s=this.currRow+1-this.nrRollUpRows,m=this.rows.splice(s,1)[0];m.clear(),this.rows.splice(this.currRow,0,m),this.logger.log(_.INFO,"Rolling up")}else this.logger.log(_.DEBUG,"roll_up but nrRollUpRows not set yet")},o.getDisplayText=function getDisplayText(o){o=o||!1;for(var s=[],m="",_=-1,S=0;S<O;S++){var E=this.rows[S].getTextString();E&&(_=S+1,o?s.push("Row "+_+": '"+E+"'"):s.push(E.trim()))}return s.length>0&&(m=o?"["+s.join(" | ")+"]":s.join("\n")),m},o.getTextAndFormat=function getTextAndFormat(){return this.rows},CaptionScreen}(),Ee=function(){function Cea608Channel(o,s,m){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=o,this.outputFilter=s,this.mode=null,this.verbose=0,this.displayedMemory=new Se(m),this.nonDisplayedMemory=new Se(m),this.lastOutputScreen=new Se(m),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=m}var o=Cea608Channel.prototype;return o.reset=function reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},o.getHandler=function getHandler(){return this.outputFilter},o.setHandler=function setHandler(o){this.outputFilter=o},o.setPAC=function setPAC(o){this.writeScreen.setPAC(o)},o.setBkgData=function setBkgData(o){this.writeScreen.setBkgData(o)},o.setMode=function setMode(o){o!==this.mode&&(this.mode=o,this.logger.log(_.INFO,(function(){return"MODE="+o})),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=o)},o.insertChars=function insertChars(o){for(var s=this,m=0;m<o.length;m++)this.writeScreen.insertChar(o[m]);var S=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(_.INFO,(function(){return S+": "+s.writeScreen.getDisplayText(!0)})),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(_.TEXT,(function(){return"DISPLAYED: "+s.displayedMemory.getDisplayText(!0)})),this.outputDataUpdate())},o.ccRCL=function ccRCL(){this.logger.log(_.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},o.ccBS=function ccBS(){this.logger.log(_.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},o.ccAOF=function ccAOF(){},o.ccAON=function ccAON(){},o.ccDER=function ccDER(){this.logger.log(_.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},o.ccRU=function ccRU(o){this.logger.log(_.INFO,"RU("+o+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(o)},o.ccFON=function ccFON(){this.logger.log(_.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},o.ccRDC=function ccRDC(){this.logger.log(_.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},o.ccTR=function ccTR(){this.logger.log(_.INFO,"TR"),this.setMode("MODE_TEXT")},o.ccRTD=function ccRTD(){this.logger.log(_.INFO,"RTD"),this.setMode("MODE_TEXT")},o.ccEDM=function ccEDM(){this.logger.log(_.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},o.ccCR=function ccCR(){this.logger.log(_.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},o.ccENM=function ccENM(){this.logger.log(_.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},o.ccEOC=function ccEOC(){var o=this;if(this.logger.log(_.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var s=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=s,this.writeScreen=this.nonDisplayedMemory,this.logger.log(_.TEXT,(function(){return"DISP: "+o.displayedMemory.getDisplayText()}))}this.outputDataUpdate(!0)},o.ccTO=function ccTO(o){this.logger.log(_.INFO,"TO("+o+") - Tab Offset"),this.writeScreen.moveCursor(o)},o.ccMIDROW=function ccMIDROW(o){var s={flash:!1};if(s.underline=o%2==1,s.italics=o>=46,s.italics)s.foreground="white";else{var m=Math.floor(o/2)-16;s.foreground=["white","green","blue","cyan","red","yellow","magenta"][m]}this.logger.log(_.INFO,"MIDROW: "+JSON.stringify(s)),this.writeScreen.setPen(s)},o.outputDataUpdate=function outputDataUpdate(o){void 0===o&&(o=!1);var s=this.logger.time;null!==s&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,s,this.lastOutputScreen),o&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:s):this.cueStartTime=s,this.lastOutputScreen.copy(this.displayedMemory))},o.cueSplitAtTime=function cueSplitAtTime(o){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,o,this.displayedMemory),this.cueStartTime=o))},Cea608Channel}(),De=function(){function Cea608Parser(o,s,m){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var _=new J;this.channels=[null,new Ee(o,s,_),new Ee(o+1,m,_)],this.cmdHistory={a:null,b:null},this.logger=_}var o=Cea608Parser.prototype;return o.getHandler=function getHandler(o){return this.channels[o].getHandler()},o.setHandler=function setHandler(o,s){this.channels[o].setHandler(s)},o.addData=function addData(o,s){var m,S,E,A=!1;this.logger.time=o;for(var O=0;O<s.length;O+=2)if(S=127&s[O],E=127&s[O+1],0!==S||0!==E){if(this.logger.log(_.DATA,"["+ae([s[O],s[O+1]])+"] -> ("+ae([S,E])+")"),(m=this.parseCmd(S,E))||(m=this.parseMidrow(S,E)),m||(m=this.parsePAC(S,E)),m||(m=this.parseBackgroundAttributes(S,E)),!m&&(A=this.parseChars(S,E))){var H=this.currentChannel;if(H&&H>0)this.channels[H].insertChars(A);else this.logger.log(_.WARNING,"No channel found yet. TEXT-MODE?")}m||A||this.logger.log(_.WARNING,"Couldn't parse cleaned data "+ae([S,E])+" orig: "+ae([s[O],s[O+1]]))}},o.parseCmd=function parseCmd(o,s){var m=this.cmdHistory;if(!((20===o||28===o||21===o||29===o)&&s>=32&&s<=47)&&!((23===o||31===o)&&s>=33&&s<=35))return!1;if(hasCmdRepeated(o,s,m))return setLastCmd(null,null,m),this.logger.log(_.DEBUG,"Repeated command ("+ae([o,s])+") is dropped"),!0;var S=20===o||21===o||23===o?1:2,E=this.channels[S];return 20===o||21===o||28===o||29===o?32===s?E.ccRCL():33===s?E.ccBS():34===s?E.ccAOF():35===s?E.ccAON():36===s?E.ccDER():37===s?E.ccRU(2):38===s?E.ccRU(3):39===s?E.ccRU(4):40===s?E.ccFON():41===s?E.ccRDC():42===s?E.ccTR():43===s?E.ccRTD():44===s?E.ccEDM():45===s?E.ccCR():46===s?E.ccENM():47===s&&E.ccEOC():E.ccTO(s-32),setLastCmd(o,s,m),this.currentChannel=S,!0},o.parseMidrow=function parseMidrow(o,s){var m=0;if((17===o||25===o)&&s>=32&&s<=47){if((m=17===o?1:2)!==this.currentChannel)return this.logger.log(_.ERROR,"Mismatch channel in midrow parsing"),!1;var S=this.channels[m];return!!S&&(S.ccMIDROW(s),this.logger.log(_.DEBUG,"MIDROW ("+ae([o,s])+")"),!0)}return!1},o.parsePAC=function parsePAC(o,s){var m,_=this.cmdHistory;if(!((o>=17&&o<=23||o>=25&&o<=31)&&s>=64&&s<=127)&&!((16===o||24===o)&&s>=64&&s<=95))return!1;if(hasCmdRepeated(o,s,_))return setLastCmd(null,null,_),!0;var S=o<=23?1:2;m=s>=64&&s<=95?1===S?K[o]:G[o]:1===S?z[o]:q[o];var E=this.channels[S];return!!E&&(E.setPAC(this.interpretPAC(m,s)),setLastCmd(o,s,_),this.currentChannel=S,!0)},o.interpretPAC=function interpretPAC(o,s){var m,_={color:null,italics:!1,indent:null,underline:!1,row:o};return m=s>95?s-96:s-64,_.underline=1==(1&m),m<=13?_.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(m/2)]:m<=15?(_.italics=!0,_.color="white"):_.indent=4*Math.floor((m-16)/2),_},o.parseChars=function parseChars(o,s){var m,S,E=null,O=null;(o>=25?(m=2,O=o-8):(m=1,O=o),O>=17&&O<=19)?(S=17===O?s+80:18===O?s+112:s+144,this.logger.log(_.INFO,"Special char '"+A(S)+"' in channel "+m),E=[S]):o>=32&&o<=127&&(E=0===s?[o]:[o,s]);if(E){var H=ae(E);this.logger.log(_.DEBUG,"Char codes =  "+H.join(",")),setLastCmd(o,s,this.cmdHistory)}return E},o.parseBackgroundAttributes=function parseBackgroundAttributes(o,s){var m;if(!((16===o||24===o)&&s>=32&&s<=47)&&!((23===o||31===o)&&s>=45&&s<=47))return!1;var _={};16===o||24===o?(m=Math.floor((s-32)/2),_.background=X[m],s%2==1&&(_.background=_.background+"_semi")):45===s?_.background="transparent":(_.foreground="black",47===s&&(_.underline=!0));var S=o<=23?1:2;return this.channels[S].setBkgData(_),setLastCmd(o,s,this.cmdHistory),!0},o.reset=function reset(){for(var o=0;o<Object.keys(this.channels).length;o++){var s=this.channels[o];s&&s.reset()}this.cmdHistory={a:null,b:null}},o.cueSplitAtTime=function cueSplitAtTime(o){for(var s=0;s<this.channels.length;s++){var m=this.channels[s];m&&m.cueSplitAtTime(o)}},Cea608Parser}();function setLastCmd(o,s,m){m.a=o,m.b=s}function hasCmdRepeated(o,s,m){return m.a===o&&m.b===s}var $e=De},"./src/utils/codecs.ts":
/*!*****************************!*\
    !*** ./src/utils/codecs.ts ***!
    \*****************************/function srcUtilsCodecsTs(o,s,m){m.r(s),m.d(s,{isCodecSupportedInMp4:function isCodecSupportedInMp4(){return _isCodecSupportedInMp},isCodecType:function isCodecType(){return _isCodecType}});var _={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function _isCodecType(o,s){var m=_[s];return!!m&&!0===m[o.slice(0,4)]}function _isCodecSupportedInMp(o,s){return MediaSource.isTypeSupported((s||"video")+'/mp4;codecs="'+o+'"')}},"./src/utils/cues.ts":
/*!***************************!*\
    !*** ./src/utils/cues.ts ***!
    \***************************/function srcUtilsCuesTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return H}});var _=m(/*! ./vttparser */"./src/utils/vttparser.ts"),S=m(/*! ./webvtt-parser */"./src/utils/webvtt-parser.ts"),E=m(/*! ./texttrack-utils */"./src/utils/texttrack-utils.ts"),A=/\s/,O={newCue:function newCue(o,s,m,O){for(var H,K,z,G,q,X=[],J=self.VTTCue||self.TextTrackCue,ae=0;ae<O.rows.length;ae++)if(z=!0,G=0,q="",!(H=O.rows[ae]).isEmpty()){for(var pe=0;pe<H.chars.length;pe++)A.test(H.chars[pe].uchar)&&z?G++:(q+=H.chars[pe].uchar,z=!1);H.cueStartTime=s,s===m&&(m+=1e-4),G>=16?G--:G++;var me=(0,_.fixLineBreaks)(q.trim()),_e=(0,S.generateCueId)(s,m,me);o&&o.cues&&o.cues.getCueById(_e)||((K=new J(s,m,me)).id=_e,K.line=ae+1,K.align="left",K.position=10+Math.min(80,10*Math.floor(8*G/32)),X.push(K))}return o&&X.length&&(X.sort((function(o,s){return"auto"===o.line||"auto"===s.line?0:o.line>8&&s.line>8?s.line-o.line:o.line-s.line})),X.forEach((function(s){return(0,E.addCueToTrack)(o,s)}))),X}},H=O},"./src/utils/discontinuities.ts":
/*!**************************************!*\
    !*** ./src/utils/discontinuities.ts ***!
    \**************************************/function srcUtilsDiscontinuitiesTs(o,s,m){m.r(s),m.d(s,{adjustSlidingStart:function adjustSlidingStart(){return _adjustSlidingStart},alignMediaPlaylistByPDT:function alignMediaPlaylistByPDT(){return _alignMediaPlaylistByPDT},alignPDT:function alignPDT(){return _alignPDT},alignStream:function alignStream(){return _alignStream},findDiscontinuousReferenceFrag:function findDiscontinuousReferenceFrag(){return _findDiscontinuousReferenceFrag},findFirstFragWithCC:function findFirstFragWithCC(){return _findFirstFragWithCC},shouldAlignOnDiscontinuities:function shouldAlignOnDiscontinuities(){return _shouldAlignOnDiscontinuities}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ./logger */"./src/utils/logger.ts"),E=m(/*! ../controller/level-helper */"./src/controller/level-helper.ts");function _findFirstFragWithCC(o,s){for(var m=null,_=0,S=o.length;_<S;_++){var E=o[_];if(E&&E.cc===s){m=E;break}}return m}function _shouldAlignOnDiscontinuities(o,s,m){return!(!s.details||!(m.endCC>m.startCC||o&&o.cc<m.startCC))}function _findDiscontinuousReferenceFrag(o,s,m){var _=o.fragments,E=s.fragments;if(E.length&&_.length){var A=_findFirstFragWithCC(_,E[0].cc);if(A&&(!A||A.startPTS))return A;S.logger.log("No frag in previous level to align on")}else S.logger.log("No fragments to align")}function adjustFragmentStart(o,s){if(o){var m=o.start+s;o.start=o.startPTS=m,o.endPTS=m+o.duration}}function _adjustSlidingStart(o,s){for(var m=s.fragments,_=0,S=m.length;_<S;_++)adjustFragmentStart(m[_],o);s.fragmentHint&&adjustFragmentStart(s.fragmentHint,o),s.alignedSliding=!0}function _alignStream(o,s,m){s&&(!function alignDiscontinuities(o,s,m){if(_shouldAlignOnDiscontinuities(o,m,s)){var E=_findDiscontinuousReferenceFrag(m.details,s);E&&(0,_.isFiniteNumber)(E.start)&&(S.logger.log("Adjusting PTS using last level due to CC increase within current level "+s.url),_adjustSlidingStart(E.start,s))}}(o,m,s),!m.alignedSliding&&s.details&&_alignPDT(m,s.details),m.alignedSliding||!s.details||m.skippedSegments||(0,E.adjustSliding)(s.details,m))}function _alignPDT(o,s){if(s.fragments.length&&o.hasProgramDateTime&&s.hasProgramDateTime){var m=s.fragments[0].programDateTime,E=o.fragments[0].programDateTime,A=(E-m)/1e3+s.fragments[0].start;A&&(0,_.isFiniteNumber)(A)&&(S.logger.log("Adjusting PTS using programDateTime delta "+(E-m)+"ms, sliding:"+A.toFixed(3)+" "+o.url+" "),_adjustSlidingStart(A,o))}}function _alignMediaPlaylistByPDT(o,s){if(o.hasProgramDateTime&&s.hasProgramDateTime){var m=o.fragments,_=s.fragments;if(m.length&&_.length){var S=_[Math.round(_.length/2)-1],E=_findFirstFragWithCC(m,S.cc)||m[Math.round(m.length/2)-1],A=S.programDateTime,O=E.programDateTime;if(null!==A&&null!==O)_adjustSlidingStart((O-A)/1e3-(E.start-S.start),o)}}}},"./src/utils/ewma-bandwidth-estimator.ts":
/*!***********************************************!*\
    !*** ./src/utils/ewma-bandwidth-estimator.ts ***!
    \***********************************************/function srcUtilsEwmaBandwidthEstimatorTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return S}});var _=m(/*! ../utils/ewma */"./src/utils/ewma.ts"),S=function(){function EwmaBandWidthEstimator(o,s,m){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=m,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new _.default(o),this.fast_=new _.default(s)}var o=EwmaBandWidthEstimator.prototype;return o.update=function update(o,s){var m=this.slow_,S=this.fast_;this.slow_.halfLife!==o&&(this.slow_=new _.default(o,m.getEstimate(),m.getTotalWeight())),this.fast_.halfLife!==s&&(this.fast_=new _.default(s,S.getEstimate(),S.getTotalWeight()))},o.sample=function sample(o,s){var m=(o=Math.max(o,this.minDelayMs_))/1e3,_=8*s/m;this.fast_.sample(m,_),this.slow_.sample(m,_)},o.canEstimate=function canEstimate(){var o=this.fast_;return o&&o.getTotalWeight()>=this.minWeight_},o.getEstimate=function getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},o.destroy=function destroy(){},EwmaBandWidthEstimator}()},"./src/utils/ewma.ts":
/*!***************************!*\
    !*** ./src/utils/ewma.ts ***!
    \***************************/function srcUtilsEwmaTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _=function(){function EWMA(o,s,m){void 0===s&&(s=0),void 0===m&&(m=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=o,this.alpha_=o?Math.exp(Math.log(.5)/o):0,this.estimate_=s,this.totalWeight_=m}var o=EWMA.prototype;return o.sample=function sample(o,s){var m=Math.pow(this.alpha_,o);this.estimate_=s*(1-m)+m*this.estimate_,this.totalWeight_+=o},o.getTotalWeight=function getTotalWeight(){return this.totalWeight_},o.getEstimate=function getEstimate(){if(this.alpha_){var o=1-Math.pow(this.alpha_,this.totalWeight_);if(o)return this.estimate_/o}return this.estimate_},EWMA}()},"./src/utils/fetch-loader.ts":
/*!***********************************!*\
    !*** ./src/utils/fetch-loader.ts ***!
    \***********************************/function srcUtilsFetchLoaderTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return H},fetchSupported:function fetchSupported(){return _fetchSupported}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ../loader/load-stats */"./src/loader/load-stats.ts"),E=m(/*! ../demux/chunk-cache */"./src/demux/chunk-cache.ts");function _wrapNativeSuper(o){var s="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(o){if(null===o||!function _isNativeFunction(o){return-1!==Function.toString.call(o).indexOf("[native code]")}(o))return o;if("function"!=typeof o)throw new TypeError("Super expression must either be null or a function");if(void 0!==s){if(s.has(o))return s.get(o);s.set(o,Wrapper)}function Wrapper(){return _construct(o,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(o.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,o)},_wrapNativeSuper(o)}function _construct(o,s,m){return _construct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(o){return!1}}()?Reflect.construct.bind():function _construct(o,s,m){var _=[null];_.push.apply(_,s);var S=new(Function.bind.apply(o,_));return m&&_setPrototypeOf(S,m.prototype),S},_construct.apply(null,arguments)}function _setPrototypeOf(o,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,s){return o.__proto__=s,o},_setPrototypeOf(o,s)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}function _fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(o){}return!1}var A=function(){function FetchLoader(o){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=o.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new S.LoadStats}var o=FetchLoader.prototype;return o.destroy=function destroy(){this.loader=this.callbacks=null,this.abortInternal()},o.abortInternal=function abortInternal(){var o=this.response;o&&o.ok||(this.stats.aborted=!0,this.controller.abort())},o.abort=function abort(){var o;this.abortInternal(),null!==(o=this.callbacks)&&void 0!==o&&o.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},o.load=function load(o,s,m){var S=this,E=this.stats;if(E.loading.start)throw new Error("Loader can only be used once.");E.loading.start=self.performance.now();var A=function getRequestParameters(o,s){var m={method:"GET",mode:"cors",credentials:"same-origin",signal:s,headers:new self.Headers(_extends({},o.headers))};o.rangeEnd&&m.headers.set("Range","bytes="+o.rangeStart+"-"+String(o.rangeEnd-1));return m}(o,this.controller.signal),H=m.onProgress,K="arraybuffer"===o.responseType,z=K?"byteLength":"length";this.context=o,this.config=s,this.callbacks=m,this.request=this.fetchSetup(o,A),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout((function(){S.abortInternal(),m.onTimeout(E,o,S.response)}),s.timeout),self.fetch(this.request).then((function(m){if(S.response=S.loader=m,!m.ok){var A=m.status,z=m.statusText;throw new O(z||"fetch, bad network response",A,m)}return E.loading.first=Math.max(self.performance.now(),E.loading.start),E.total=parseInt(m.headers.get("Content-Length")||"0"),H&&(0,_.isFiniteNumber)(s.highWaterMark)?S.loadProgressively(m,E,o,s.highWaterMark,H):K?m.arrayBuffer():m.text()})).then((function(A){var O=S.response;self.clearTimeout(S.requestTimeout),E.loading.end=Math.max(self.performance.now(),E.loading.first);var K=A[z];K&&(E.loaded=E.total=K);var G={url:O.url,data:A};H&&!(0,_.isFiniteNumber)(s.highWaterMark)&&H(E,o,A,O),m.onSuccess(G,E,o,O)})).catch((function(s){if(self.clearTimeout(S.requestTimeout),!E.aborted){var _=s&&s.code||0,A=s?s.message:null;m.onError({code:_,text:A},o,s?s.details:null)}}))},o.getCacheAge=function getCacheAge(){var o=null;if(this.response){var s=this.response.headers.get("age");o=s?parseFloat(s):null}return o},o.loadProgressively=function loadProgressively(o,s,m,_,S){void 0===_&&(_=0);var A=new E.default,O=o.body.getReader();return function pump(){return O.read().then((function(E){if(E.done)return A.dataLength&&S(s,m,A.flush(),o),Promise.resolve(new ArrayBuffer(0));var O=E.value,H=O.length;return s.loaded+=H,H<_||A.dataLength?(A.push(O),A.dataLength>=_&&S(s,m,A.flush(),o)):S(s,m,O,o),pump()})).catch((function(){return Promise.reject()}))}()},FetchLoader}();function getRequest(o,s){return new self.Request(o.url,s)}var O=function(o){function FetchError(s,m,_){var S;return(S=o.call(this,s)||this).code=void 0,S.details=void 0,S.code=m,S.details=_,S}return function _inheritsLoose(o,s){o.prototype=Object.create(s.prototype),o.prototype.constructor=o,_setPrototypeOf(o,s)}(FetchError,o),FetchError}(_wrapNativeSuper(Error)),H=A},"./src/utils/hex.ts":
/*!**************************!*\
    !*** ./src/utils/hex.ts ***!
    \**************************/function srcUtilsHexTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _={hexDump:function hexDump(o){for(var s="",m=0;m<o.length;m++){var _=o[m].toString(16);_.length<2&&(_="0"+_),s+=_}return s}}},"./src/utils/imsc1-ttml-parser.ts":
/*!****************************************!*\
    !*** ./src/utils/imsc1-ttml-parser.ts ***!
    \****************************************/function srcUtilsImsc1TtmlParserTs(o,s,m){m.r(s),m.d(s,{IMSC1_CODEC:function IMSC1_CODEC(){return K},parseIMSC1:function parseIMSC1(){return _parseIMSC}});var _=m(/*! ./mp4-tools */"./src/utils/mp4-tools.ts"),S=m(/*! ./vttparser */"./src/utils/vttparser.ts"),E=m(/*! ./vttcue */"./src/utils/vttcue.ts"),A=m(/*! ../demux/id3 */"./src/demux/id3.ts"),O=m(/*! ./timescale-conversion */"./src/utils/timescale-conversion.ts"),H=m(/*! ./webvtt-parser */"./src/utils/webvtt-parser.ts");function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},_extends.apply(this,arguments)}var K="stpp.ttml.im1t",z=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,G=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,q={left:"start",center:"center",right:"end",start:"start",end:"end"};function _parseIMSC(o,s,m,S,K){var z=(0,_.findBox)(new Uint8Array(o),["mdat"]);if(0!==z.length){var G=z.map((function(o){return(0,A.utf8ArrayToStr)(o)})),X=(0,O.toTimescaleFromScale)(s,1,m);try{G.forEach((function(o){return S(function parseTTML(o,s){var m=(new DOMParser).parseFromString(o,"text/xml"),_=m.getElementsByTagName("tt")[0];if(!_)throw new Error("Invalid ttml");var S={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},A=Object.keys(S).reduce((function(o,s){return o[s]=_.getAttribute("ttp:"+s)||S[s],o}),{}),O="preserve"!==_.getAttribute("xml:space"),K=collectionToDictionary(getElementCollection(_,"styling","style")),z=collectionToDictionary(getElementCollection(_,"layout","region")),G=getElementCollection(_,"body","[begin]");return[].map.call(G,(function(o){var m=getTextContent(o,O);if(!m||!o.hasAttribute("begin"))return null;var _=parseTtmlTime(o.getAttribute("begin"),A),S=parseTtmlTime(o.getAttribute("dur"),A),G=parseTtmlTime(o.getAttribute("end"),A);if(null===_)throw timestampParsingError(o);if(null===G){if(null===S)throw timestampParsingError(o);G=_+S}var X=new E.default(_-s,G-s,m);X.id=(0,H.generateCueId)(X.startTime,X.endTime,X.text);var J=function getTtmlStyles(o,s,m){var _="http://www.w3.org/ns/ttml#styling",S=null,E=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],A=null!=o&&o.hasAttribute("style")?o.getAttribute("style"):null;A&&m.hasOwnProperty(A)&&(S=m[A]);return E.reduce((function(m,E){var A=getAttributeNS(s,_,E)||getAttributeNS(o,_,E)||getAttributeNS(S,_,E);return A&&(m[E]=A),m}),{})}(z[o.getAttribute("region")],K[o.getAttribute("style")],K),ae=J.textAlign;if(ae){var pe=q[ae];pe&&(X.lineAlign=pe),X.align=ae}return _extends(X,J),X})).filter((function(o){return null!==o}))}(o,X))}))}catch(o){K(o)}}else K(new Error("Could not parse IMSC1 mdat"))}function getElementCollection(o,s,m){var _=o.getElementsByTagName(s)[0];return _?[].slice.call(_.querySelectorAll(m)):[]}function collectionToDictionary(o){return o.reduce((function(o,s){var m=s.getAttribute("xml:id");return m&&(o[m]=s),o}),{})}function getTextContent(o,s){return[].slice.call(o.childNodes).reduce((function(o,m,_){var S;return"br"===m.nodeName&&_?o+"\n":null!==(S=m.childNodes)&&void 0!==S&&S.length?getTextContent(m,s):s?o+m.textContent.trim().replace(/\s+/g," "):o+m.textContent}),"")}function getAttributeNS(o,s,m){return o&&o.hasAttributeNS(s,m)?o.getAttributeNS(s,m):null}function timestampParsingError(o){return new Error("Could not parse ttml timestamp "+o)}function parseTtmlTime(o,s){if(!o)return null;var m=(0,S.parseTimeStamp)(o);return null===m&&(z.test(o)?m=function parseHoursMinutesSecondsFrames(o,s){var m=z.exec(o),_=(0|m[4])+(0|m[5])/s.subFrameRate;return 3600*(0|m[1])+60*(0|m[2])+(0|m[3])+_/s.frameRate}(o,s):G.test(o)&&(m=function parseTimeUnits(o,s){var m=G.exec(o),_=Number(m[1]);switch(m[2]){case"h":return 3600*_;case"m":return 60*_;case"ms":return 1e3*_;case"f":return _/s.frameRate;case"t":return _/s.tickRate}return _}(o,s))),m}},"./src/utils/keysystem-util.ts":
/*!*************************************!*\
    !*** ./src/utils/keysystem-util.ts ***!
    \*************************************/function srcUtilsKeysystemUtilTs(o,s,m){m.r(s),m.d(s,{changeEndianness:function changeEndianness(){return _changeEndianness},convertDataUriToArrayBytes:function convertDataUriToArrayBytes(){return _convertDataUriToArrayBytes},strToUtf8array:function strToUtf8array(){return _strToUtf8array}});var _=m(/*! ./numeric-encoding-utils */"./src/utils/numeric-encoding-utils.ts");function _changeEndianness(o){var s=function swap(o,s,m){var _=o[s];o[s]=o[m],o[m]=_};s(o,0,3),s(o,1,2),s(o,4,5),s(o,6,7)}function _convertDataUriToArrayBytes(o){var s=o.split(":"),m=null;if("data"===s[0]&&2===s.length){var S=s[1].split(";"),E=S[S.length-1].split(",");if(2===E.length){var A="base64"===E[0],O=E[1];A?(S.splice(-1,1),m=(0,_.base64Decode)(O)):m=function getKeyIdBytes(o){var s=_strToUtf8array(o).subarray(0,16),m=new Uint8Array(16);return m.set(s,16-s.length),m}(O)}}return m}function _strToUtf8array(o){return Uint8Array.from(unescape(encodeURIComponent(o)),(function(o){return o.charCodeAt(0)}))}},"./src/utils/logger.ts":
/*!*****************************!*\
    !*** ./src/utils/logger.ts ***!
    \*****************************/function srcUtilsLoggerTs(o,s,m){m.r(s),m.d(s,{enableLogs:function enableLogs(){return _enableLogs},logger:function logger(){return A}});var _=function noop(){},S={trace:_,debug:_,log:_,warn:_,info:_,error:_},E=S;function exportLoggerFunctions(o){for(var s=arguments.length,m=new Array(s>1?s-1:0),S=1;S<s;S++)m[S-1]=arguments[S];m.forEach((function(s){E[s]=o[s]?o[s].bind(o):function consolePrintFn(o){var s=self.console[o];return s?s.bind(self.console,"["+o+"] >"):_}(s)}))}function _enableLogs(o,s){if(self.console&&!0===o||"object"==typeof o){exportLoggerFunctions(o,"debug","log","info","warn","error");try{E.log('Debug logs enabled for "'+s+'"')}catch(o){E=S}}else E=S}var A=S},"./src/utils/mediakeys-helper.ts":
/*!***************************************!*\
    !*** ./src/utils/mediakeys-helper.ts ***!
    \***************************************/function srcUtilsMediakeysHelperTs(o,s,m){var _,S,E,A,O;function _keySystemFormatToKeySystemDomain(o){switch(o){case E.FAIRPLAY:return _.FAIRPLAY;case E.PLAYREADY:return _.PLAYREADY;case E.WIDEVINE:return _.WIDEVINE;case E.CLEARKEY:return _.CLEARKEY}}function _keySystemIdToKeySystemDomain(o){if(o===O.WIDEVINE)return _.WIDEVINE}function _keySystemDomainToKeySystemFormat(o){switch(o){case _.FAIRPLAY:return E.FAIRPLAY;case _.PLAYREADY:return E.PLAYREADY;case _.WIDEVINE:return E.WIDEVINE;case _.CLEARKEY:return E.CLEARKEY}}function _getKeySystemsForConfig(o){var s=o.drmSystems,m=o.widevineLicenseUrl,S=s?[_.FAIRPLAY,_.WIDEVINE,_.PLAYREADY,_.CLEARKEY].filter((function(o){return!!s[o]})):[];return!S[_.WIDEVINE]&&m&&S.push(_.WIDEVINE),S}m.r(s),m.d(s,{KeySystemFormats:function KeySystemFormats(){return E},KeySystemIds:function KeySystemIds(){return O},KeySystems:function KeySystems(){return _},getKeySystemsForConfig:function getKeySystemsForConfig(){return _getKeySystemsForConfig},getSupportedMediaKeySystemConfigurations:function getSupportedMediaKeySystemConfigurations(){return _getSupportedMediaKeySystemConfigurations},keySystemDomainToKeySystemFormat:function keySystemDomainToKeySystemFormat(){return _keySystemDomainToKeySystemFormat},keySystemFormatToKeySystemDomain:function keySystemFormatToKeySystemDomain(){return _keySystemFormatToKeySystemDomain},keySystemIdToKeySystemDomain:function keySystemIdToKeySystemDomain(){return _keySystemIdToKeySystemDomain},requestMediaKeySystemAccess:function requestMediaKeySystemAccess(){return H}}),(S=_||(_={})).CLEARKEY="org.w3.clearkey",S.FAIRPLAY="com.apple.fps",S.PLAYREADY="com.microsoft.playready",S.WIDEVINE="com.widevine.alpha",(A=E||(E={})).CLEARKEY="org.w3.clearkey",A.FAIRPLAY="com.apple.streamingkeydelivery",A.PLAYREADY="com.microsoft.playready",A.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",(O||(O={})).WIDEVINE="edef8ba979d64acea3c827dcd51d21ed";var H="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function _getSupportedMediaKeySystemConfigurations(o,s,m,S){var E;switch(o){case _.FAIRPLAY:E=["cenc","sinf"];break;case _.WIDEVINE:case _.PLAYREADY:E=["cenc"];break;case _.CLEARKEY:E=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+o)}return function createMediaKeySystemConfigurations(o,s,m,_){var S={initDataTypes:o,persistentState:_.persistentState||"not-allowed",distinctiveIdentifier:_.distinctiveIdentifier||"not-allowed",sessionTypes:_.sessionTypes||[_.sessionType||"temporary"],audioCapabilities:s.map((function(o){return{contentType:'audio/mp4; codecs="'+o+'"',robustness:_.audioRobustness||"",encryptionScheme:_.audioEncryptionScheme||null}})),videoCapabilities:m.map((function(o){return{contentType:'video/mp4; codecs="'+o+'"',robustness:_.videoRobustness||"",encryptionScheme:_.videoEncryptionScheme||null}}))};return[S]}(E,s,m,S)}},"./src/utils/mediasource-helper.ts":
/*!*****************************************!*\
    !*** ./src/utils/mediasource-helper.ts ***!
    \*****************************************/function srcUtilsMediasourceHelperTs(o,s,m){function _getMediaSource(){return self.MediaSource||self.WebKitMediaSource}m.r(s),m.d(s,{getMediaSource:function getMediaSource(){return _getMediaSource}})},"./src/utils/mp4-tools.ts":
/*!********************************!*\
    !*** ./src/utils/mp4-tools.ts ***!
    \********************************/function srcUtilsMp4ToolsTs(o,s,m){m.r(s),m.d(s,{RemuxerTrackIdConfig:function RemuxerTrackIdConfig(){return z},appendUint8Array:function appendUint8Array(){return _appendUint8Array},bin2str:function bin2str(){return _bin2str},computeRawDurationFromSamples:function computeRawDurationFromSamples(){return _computeRawDurationFromSamples},discardEPB:function discardEPB(){return _discardEPB},findBox:function findBox(){return _findBox},getDuration:function getDuration(){return _getDuration},getStartDTS:function getStartDTS(){return _getStartDTS},mp4Box:function mp4Box(){return _mp4Box},mp4pssh:function mp4pssh(){return _mp4pssh},offsetStartDTS:function offsetStartDTS(){return _offsetStartDTS},parseEmsg:function parseEmsg(){return _parseEmsg},parseInitSegment:function parseInitSegment(){return _parseInitSegment},parsePssh:function parsePssh(){return _parsePssh},parseSEIMessageFromNALu:function parseSEIMessageFromNALu(){return _parseSEIMessageFromNALu},parseSamples:function parseSamples(){return _parseSamples},parseSegmentIndex:function parseSegmentIndex(){return _parseSegmentIndex},parseSinf:function parseSinf(){return _parseSinf},patchEncyptionData:function patchEncyptionData(){return _patchEncyptionData},readSint32:function readSint32(){return _readSint},readUint16:function readUint16(){return _readUint},readUint32:function readUint32(){return _readUint2},segmentValidRange:function segmentValidRange(){return _segmentValidRange},writeUint32:function writeUint32(){return _writeUint}});var _=m(/*! ../loader/fragment */"./src/loader/fragment.ts"),S=m(/*! ./typed-array */"./src/utils/typed-array.ts"),E=m(/*! ../demux/id3 */"./src/demux/id3.ts"),A=m(/*! ../utils/logger */"./src/utils/logger.ts"),O=m(/*! ./hex */"./src/utils/hex.ts"),H=Math.pow(2,32)-1,K=[].push,z={video:1,audio:2,id3:3,text:4};function _bin2str(o){return String.fromCharCode.apply(null,o)}function _readUint(o,s){var m=o[s]<<8|o[s+1];return m<0?65536+m:m}function _readUint2(o,s){var m=_readSint(o,s);return m<0?4294967296+m:m}function _readSint(o,s){return o[s]<<24|o[s+1]<<16|o[s+2]<<8|o[s+3]}function _writeUint(o,s,m){o[s]=m>>24,o[s+1]=m>>16&255,o[s+2]=m>>8&255,o[s+3]=255&m}function _findBox(o,s){var m=[];if(!s.length)return m;for(var _=o.byteLength,S=0;S<_;){var E=_readUint2(o,S),A=E>1?S+E:_;if(_bin2str(o.subarray(S+4,S+8))===s[0])if(1===s.length)m.push(o.subarray(S+8,A));else{var O=_findBox(o.subarray(S+8,A),s.slice(1));O.length&&K.apply(m,O)}S=A}return m}function _parseSegmentIndex(o){var s=[],m=o[0],_=8,S=_readUint2(o,_);_+=4;_+=0===m?8:16,_+=2;var E=o.length+0,A=_readUint(o,_);_+=2;for(var O=0;O<A;O++){var H=_,K=_readUint2(o,H);H+=4;var z=2147483647&K;if(1===(2147483648&K)>>>31)return console.warn("SIDX has hierarchical references (not supported)"),null;var G=_readUint2(o,H);H+=4,s.push({referenceSize:z,subsegmentDuration:G,info:{duration:G/S,start:E,end:E+z-1}}),E+=z,_=H+=4}return{earliestPresentationTime:0,timescale:S,version:m,referencesCount:A,references:s}}function _parseInitSegment(o){for(var s=[],m=_findBox(o,["moov","trak"]),S=0;S<m.length;S++){var E=m[S],A=_findBox(E,["tkhd"])[0];if(A){var O=A[0],H=0===O?12:20,K=_readUint2(A,H),z=_findBox(E,["mdia","mdhd"])[0];if(z){var G=_readUint2(z,H=0===(O=z[0])?12:20),q=_findBox(E,["mdia","hdlr"])[0];if(q){var X=_bin2str(q.subarray(8,12)),J={soun:_.ElementaryStreamTypes.AUDIO,vide:_.ElementaryStreamTypes.VIDEO}[X];if(J){var ae=_findBox(E,["mdia","minf","stbl","stsd"])[0],pe=void 0;ae&&(pe=_bin2str(ae.subarray(12,16))),s[K]={timescale:G,type:J},s[J]={timescale:G,id:K,codec:pe}}}}}}return _findBox(o,["moov","mvex","trex"]).forEach((function(o){var m=_readUint2(o,4),_=s[m];_&&(_.default={duration:_readUint2(o,12),flags:_readUint2(o,20)})})),s}function _patchEncyptionData(o,s){if(!o||!s)return o;var m=s.keyId;m&&s.isCommonEncryption&&_findBox(o,["moov","trak"]).forEach((function(o){var s=_findBox(o,["mdia","minf","stbl","stsd"])[0].subarray(8),_=_findBox(s,["enca"]),S=_.length>0;S||(_=_findBox(s,["encv"])),_.forEach((function(o){_findBox(S?o.subarray(28):o.subarray(78),["sinf"]).forEach((function(o){var s=_parseSinf(o);if(s){var _=s.subarray(8,24);_.some((function(o){return 0!==o}))||(A.logger.log("[eme] Patching keyId in 'enc"+(S?"a":"v")+">sinf>>tenc' box: "+O.default.hexDump(_)+" -> "+O.default.hexDump(m)),s.set(m,8))}}))}))}));return o}function _parseSinf(o){var s=_findBox(o,["schm"])[0];if(s){var m=_bin2str(s.subarray(4,8));if("cbcs"===m||"cenc"===m)return _findBox(o,["schi","tenc"])[0]}return A.logger.error("[eme] missing 'schm' box"),null}function _getStartDTS(o,s){return _findBox(s,["moof","traf"]).reduce((function(s,m){var _=_findBox(m,["tfdt"])[0],S=_[0],E=_findBox(m,["tfhd"]).reduce((function(s,m){var E=_readUint2(m,4),A=o[E];if(A){var O=_readUint2(_,4);1===S&&(O*=Math.pow(2,32),O+=_readUint2(_,8));var H=O/(A.timescale||9e4);if(isFinite(H)&&(null===s||H<s))return H}return s}),null);return null!==E&&isFinite(E)&&(null===s||E<s)?E:s}),null)||0}function _getDuration(o,s){for(var m=0,S=0,E=0,A=_findBox(o,["moof","traf"]),O=0;O<A.length;O++){var H=A[O],K=_findBox(H,["tfhd"])[0],z=s[_readUint2(K,4)];if(z){var G=z.default,q=_readUint2(K,0)|(null==G?void 0:G.flags),X=null==G?void 0:G.duration;8&q&&(X=_readUint2(K,2&q?12:8));for(var J=z.timescale||9e4,ae=_findBox(H,["trun"]),pe=0;pe<ae.length;pe++){if(!(m=_computeRawDurationFromSamples(ae[pe]))&&X)m=X*_readUint2(ae[pe],4);z.type===_.ElementaryStreamTypes.VIDEO?S+=m/J:z.type===_.ElementaryStreamTypes.AUDIO&&(E+=m/J)}}}if(0===S&&0===E){for(var me=0,_e=_findBox(o,["sidx"]),Se=0;Se<_e.length;Se++){var Ee=_parseSegmentIndex(_e[Se]);null!=Ee&&Ee.references&&(me+=Ee.references.reduce((function(o,s){return o+s.info.duration||0}),0))}return me}return S||E}function _computeRawDurationFromSamples(o){var s=_readUint2(o,0),m=8;1&s&&(m+=4),4&s&&(m+=4);for(var _=0,S=_readUint2(o,4),E=0;E<S;E++){if(256&s)_+=_readUint2(o,m),m+=4;512&s&&(m+=4),1024&s&&(m+=4),2048&s&&(m+=4)}return _}function _offsetStartDTS(o,s,m){_findBox(s,["moof","traf"]).forEach((function(s){_findBox(s,["tfhd"]).forEach((function(_){var S=_readUint2(_,4),E=o[S];if(E){var A=E.timescale||9e4;_findBox(s,["tfdt"]).forEach((function(o){var s=o[0],_=_readUint2(o,4);if(0===s)_-=m*A,_writeUint(o,4,_=Math.max(_,0));else{_*=Math.pow(2,32),_+=_readUint2(o,8),_-=m*A,_=Math.max(_,0);var S=Math.floor(_/(H+1)),E=Math.floor(_%(H+1));_writeUint(o,4,S),_writeUint(o,8,E)}}))}}))}))}function _segmentValidRange(o){var s={valid:null,remainder:null},m=_findBox(o,["moof"]);if(!m)return s;if(m.length<2)return s.remainder=o,s;var _=m[m.length-1];return s.valid=(0,S.sliceUint8)(o,0,_.byteOffset-8),s.remainder=(0,S.sliceUint8)(o,_.byteOffset-8),s}function _appendUint8Array(o,s){var m=new Uint8Array(o.length+s.length);return m.set(o),m.set(s,o.length),m}function _parseSamples(o,s){var m=[],S=s.samples,E=s.timescale,A=s.id,O=!1;return _findBox(S,["moof"]).map((function(H){var K=H.byteOffset-8;_findBox(H,["traf"]).map((function(H){var z=_findBox(H,["tfdt"]).map((function(o){var s=o[0],m=_readUint2(o,4);return 1===s&&(m*=Math.pow(2,32),m+=_readUint2(o,8)),m/E}))[0];return void 0!==z&&(o=z),_findBox(H,["tfhd"]).map((function(z){var G=_readUint2(z,4),q=16777215&_readUint2(z,0),X=0,J=0!=(16&q),ae=0,pe=0!=(32&q),me=8;G===A&&(0!=(1&q)&&(me+=8),0!=(2&q)&&(me+=4),0!=(8&q)&&(X=_readUint2(z,me),me+=4),J&&(ae=_readUint2(z,me),me+=4),pe&&(me+=4),"video"===s.type&&(O=function isHEVC(o){if(!o)return!1;var s=o.indexOf("."),m=s<0?o:o.substring(0,s);return"hvc1"===m||"hev1"===m||"dvh1"===m||"dvhe"===m}(s.codec)),_findBox(H,["trun"]).map((function(A){var H=A[0],z=16777215&_readUint2(A,0),G=0!=(1&z),q=0,J=0!=(4&z),pe=0!=(256&z),me=0,_e=0!=(512&z),Se=0,Ee=0!=(1024&z),De=0!=(2048&z),$e=0,He=_readUint2(A,4),et=8;G&&(q=_readUint2(A,et),et+=4),J&&(et+=4);for(var rt=q+K,it=0;it<He;it++){if(pe?(me=_readUint2(A,et),et+=4):me=X,_e?(Se=_readUint2(A,et),et+=4):Se=ae,Ee&&(et+=4),De&&($e=0===H?_readUint2(A,et):_readSint(A,et),et+=4),s.type===_.ElementaryStreamTypes.VIDEO)for(var at=0;at<Se;){var ot=_readUint2(S,rt);if(isSEIMessage(O,S[rt+=4]))_parseSEIMessageFromNALu(S.subarray(rt,rt+ot),O?2:1,o+$e/E,m);rt+=ot,at+=ot+4}o+=me/E}})))}))}))})),m}function isSEIMessage(o,s){if(o){var m=s>>1&63;return 39===m||40===m}return 6===(31&s)}function _parseSEIMessageFromNALu(o,s,m,_){var S=_discardEPB(o),A=0;A+=s;for(var O=0,H=0,K=!1,z=0;A<S.length;){O=0;do{if(A>=S.length)break;O+=z=S[A++]}while(255===z);H=0;do{if(A>=S.length)break;H+=z=S[A++]}while(255===z);var G=S.length-A;if(!K&&4===O&&A<S.length){if(K=!0,181===S[A++]){var q=_readUint(S,A);if(A+=2,49===q){var X=_readUint2(S,A);if(A+=4,1195456820===X){var J=S[A++];if(3===J){var ae=S[A++],pe=64&ae,me=pe?2+3*(31&ae):0,_e=new Uint8Array(me);if(pe){_e[0]=ae;for(var Se=1;Se<me;Se++)_e[Se]=S[A++]}_.push({type:J,payloadType:O,pts:m,bytes:_e})}}}}}else if(5===O&&H<G){if(K=!0,H>16){for(var Ee=[],De=0;De<16;De++){var $e=S[A++].toString(16);Ee.push(1==$e.length?"0"+$e:$e),3!==De&&5!==De&&7!==De&&9!==De||Ee.push("-")}for(var He=H-16,et=new Uint8Array(He),rt=0;rt<He;rt++)et[rt]=S[A++];_.push({payloadType:O,pts:m,uuid:Ee.join(""),userData:(0,E.utf8ArrayToStr)(et),userDataBytes:et})}}else if(H<G)A+=H;else if(H>G)break}}function _discardEPB(o){for(var s=o.byteLength,m=[],_=1;_<s-2;)0===o[_]&&0===o[_+1]&&3===o[_+2]?(m.push(_+2),_+=2):_++;if(0===m.length)return o;var S=s-m.length,E=new Uint8Array(S),A=0;for(_=0;_<S;A++,_++)A===m[0]&&(A++,m.shift()),E[_]=o[A];return E}function _parseEmsg(o){var s=o[0],m="",_="",S=0,E=0,A=0,O=0,H=0,K=0;if(0===s){for(;"\0"!==_bin2str(o.subarray(K,K+1));)m+=_bin2str(o.subarray(K,K+1)),K+=1;for(m+=_bin2str(o.subarray(K,K+1)),K+=1;"\0"!==_bin2str(o.subarray(K,K+1));)_+=_bin2str(o.subarray(K,K+1)),K+=1;_+=_bin2str(o.subarray(K,K+1)),K+=1,S=_readUint2(o,12),E=_readUint2(o,16),O=_readUint2(o,20),H=_readUint2(o,24),K=28}else if(1===s){S=_readUint2(o,K+=4);var z=_readUint2(o,K+=4),G=_readUint2(o,K+=4);for(K+=4,A=Math.pow(2,32)*z+G,Number.isSafeInteger(A)||(A=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),O=_readUint2(o,K),H=_readUint2(o,K+=4),K+=4;"\0"!==_bin2str(o.subarray(K,K+1));)m+=_bin2str(o.subarray(K,K+1)),K+=1;for(m+=_bin2str(o.subarray(K,K+1)),K+=1;"\0"!==_bin2str(o.subarray(K,K+1));)_+=_bin2str(o.subarray(K,K+1)),K+=1;_+=_bin2str(o.subarray(K,K+1)),K+=1}return{schemeIdUri:m,value:_,timeScale:S,presentationTime:A,presentationTimeDelta:E,eventDuration:O,id:H,payload:o.subarray(K,o.byteLength)}}function _mp4Box(o){for(var s=arguments.length,m=new Array(s>1?s-1:0),_=1;_<s;_++)m[_-1]=arguments[_];for(var S=m.length,E=8,A=S;A--;)E+=m[A].byteLength;var O=new Uint8Array(E);for(O[0]=E>>24&255,O[1]=E>>16&255,O[2]=E>>8&255,O[3]=255&E,O.set(o,4),A=0,E=8;A<S;A++)O.set(m[A],E),E+=m[A].byteLength;return O}function _mp4pssh(o,s,m){if(16!==o.byteLength)throw new RangeError("Invalid system id");var _,S,E;if(s){_=1,S=new Uint8Array(16*s.length);for(var A=0;A<s.length;A++){var O=s[A];if(16!==O.byteLength)throw new RangeError("Invalid key");S.set(O,16*A)}}else _=0,S=new Uint8Array;_>0?(E=new Uint8Array(4),s.length>0&&new DataView(E.buffer).setUint32(0,s.length,!1)):E=new Uint8Array;var H=new Uint8Array(4);return m&&m.byteLength>0&&new DataView(H.buffer).setUint32(0,m.byteLength,!1),_mp4Box([112,115,115,104],new Uint8Array([_,0,0,0]),o,E,S,H,m||new Uint8Array)}function _parsePssh(o){if(!(o instanceof ArrayBuffer)||o.byteLength<32)return null;var s={version:0,systemId:"",kids:null,data:null},m=new DataView(o),_=m.getUint32(0);if(o.byteLength!==_&&_>44)return null;if(1886614376!==m.getUint32(4))return null;if(s.version=m.getUint32(8)>>>24,s.version>1)return null;s.systemId=O.default.hexDump(new Uint8Array(o,12,16));var S=m.getUint32(28);if(0===s.version){if(_-32<S)return null;s.data=new Uint8Array(o,32,S)}else if(1===s.version){s.kids=[];for(var E=0;E<S;E++)s.kids.push(new Uint8Array(o,32+16*E,16))}return s}},"./src/utils/numeric-encoding-utils.ts":
/*!*********************************************!*\
    !*** ./src/utils/numeric-encoding-utils.ts ***!
    \*********************************************/function srcUtilsNumericEncodingUtilsTs(o,s,m){function _base64ToBase64Url(o){return o.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function _strToBase64Encode(o){return btoa(o)}function _base64DecodeToStr(o){return atob(o)}function _base64Encode(o){return btoa(String.fromCharCode.apply(String,o))}function _base64UrlEncode(o){return _base64ToBase64Url(_base64Encode(o))}function _base64Decode(o){return Uint8Array.from(atob(o),(function(o){return o.charCodeAt(0)}))}m.r(s),m.d(s,{base64Decode:function base64Decode(){return _base64Decode},base64DecodeToStr:function base64DecodeToStr(){return _base64DecodeToStr},base64Encode:function base64Encode(){return _base64Encode},base64ToBase64Url:function base64ToBase64Url(){return _base64ToBase64Url},base64UrlEncode:function base64UrlEncode(){return _base64UrlEncode},strToBase64Encode:function strToBase64Encode(){return _strToBase64Encode}})},"./src/utils/output-filter.ts":
/*!************************************!*\
    !*** ./src/utils/output-filter.ts ***!
    \************************************/function srcUtilsOutputFilterTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _=function(){function OutputFilter(o,s){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=o,this.trackName=s}var o=OutputFilter.prototype;return o.dispatchCue=function dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},o.newCue=function newCue(o,s,m){(null===this.startTime||this.startTime>o)&&(this.startTime=o),this.endTime=s,this.screen=m,this.timelineController.createCaptionsTrack(this.trackName)},o.reset=function reset(){this.cueRanges=[],this.startTime=null},OutputFilter}()},"./src/utils/texttrack-utils.ts":
/*!**************************************!*\
    !*** ./src/utils/texttrack-utils.ts ***!
    \**************************************/function srcUtilsTexttrackUtilsTs(o,s,m){m.r(s),m.d(s,{addCueToTrack:function addCueToTrack(){return _addCueToTrack},clearCurrentCues:function clearCurrentCues(){return _clearCurrentCues},getCuesInRange:function getCuesInRange(){return _getCuesInRange},removeCuesInRange:function removeCuesInRange(){return _removeCuesInRange},sendAddTrackEvent:function sendAddTrackEvent(){return _sendAddTrackEvent}});var _=m(/*! ./logger */"./src/utils/logger.ts");function _sendAddTrackEvent(o,s){var m;try{m=new Event("addtrack")}catch(o){(m=document.createEvent("Event")).initEvent("addtrack",!1,!1)}m.track=o,s.dispatchEvent(m)}function _addCueToTrack(o,s){var m=o.mode;if("disabled"===m&&(o.mode="hidden"),o.cues&&!o.cues.getCueById(s.id))try{if(o.addCue(s),!o.cues.getCueById(s.id))throw new Error("addCue is failed for: "+s)}catch(m){_.logger.debug("[texttrack-utils]: "+m);var S=new self.TextTrackCue(s.startTime,s.endTime,s.text);S.id=s.id,o.addCue(S)}"disabled"===m&&(o.mode=m)}function _clearCurrentCues(o){var s=o.mode;if("disabled"===s&&(o.mode="hidden"),o.cues)for(var m=o.cues.length;m--;)o.removeCue(o.cues[m]);"disabled"===s&&(o.mode=s)}function _removeCuesInRange(o,s,m,_){var S=o.mode;if("disabled"===S&&(o.mode="hidden"),o.cues&&o.cues.length>0)for(var E=_getCuesInRange(o.cues,s,m),A=0;A<E.length;A++)_&&!_(E[A])||o.removeCue(E[A]);"disabled"===S&&(o.mode=S)}function _getCuesInRange(o,s,m){var _=[],S=function getFirstCueIndexAfterTime(o,s){if(s<o[0].startTime)return 0;var m=o.length-1;if(s>o[m].endTime)return-1;for(var _=0,S=m;_<=S;){var E=Math.floor((S+_)/2);if(s<o[E].startTime)S=E-1;else{if(!(s>o[E].startTime&&_<m))return E;_=E+1}}return o[_].startTime-s<s-o[S].startTime?_:S}(o,s);if(S>-1)for(var E=S,A=o.length;E<A;E++){var O=o[E];if(O.startTime>=s&&O.endTime<=m)_.push(O);else if(O.startTime>m)return _}return _}},"./src/utils/time-ranges.ts":
/*!**********************************!*\
    !*** ./src/utils/time-ranges.ts ***!
    \**********************************/function srcUtilsTimeRangesTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _={toString:function toString(o){for(var s="",m=o.length,_=0;_<m;_++)s+="["+o.start(_).toFixed(3)+"-"+o.end(_).toFixed(3)+"]";return s}}},"./src/utils/timescale-conversion.ts":
/*!*******************************************!*\
    !*** ./src/utils/timescale-conversion.ts ***!
    \*******************************************/function srcUtilsTimescaleConversionTs(o,s,m){m.r(s),m.d(s,{toMpegTsClockFromTimescale:function toMpegTsClockFromTimescale(){return _toMpegTsClockFromTimescale},toMsFromMpegTsClock:function toMsFromMpegTsClock(){return _toMsFromMpegTsClock},toTimescaleFromBase:function toTimescaleFromBase(){return _toTimescaleFromBase},toTimescaleFromScale:function toTimescaleFromScale(){return _toTimescaleFromScale}});var _=9e4;function _toTimescaleFromBase(o,s,m,_){void 0===m&&(m=1),void 0===_&&(_=!1);var S=o*s*m;return _?Math.round(S):S}function _toTimescaleFromScale(o,s,m,_){return void 0===m&&(m=1),void 0===_&&(_=!1),_toTimescaleFromBase(o,s,1/m,_)}function _toMsFromMpegTsClock(o,s){return void 0===s&&(s=!1),_toTimescaleFromBase(o,1e3,1/_,s)}function _toMpegTsClockFromTimescale(o,s){return void 0===s&&(s=1),_toTimescaleFromBase(o,_,1/s)}},"./src/utils/typed-array.ts":
/*!**********************************!*\
    !*** ./src/utils/typed-array.ts ***!
    \**********************************/function srcUtilsTypedArrayTs(o,s,m){function _sliceUint(o,s,m){return Uint8Array.prototype.slice?o.slice(s,m):new Uint8Array(Array.prototype.slice.call(o,s,m))}m.r(s),m.d(s,{sliceUint8:function sliceUint8(){return _sliceUint}})},"./src/utils/vttcue.ts":
/*!*****************************!*\
    !*** ./src/utils/vttcue.ts ***!
    \*****************************/function srcUtilsVttcueTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return _}});var _=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;var o=["","lr","rl"],s=["start","middle","end","left","right"];function isAllowedValue(o,s){if("string"!=typeof s)return!1;if(!Array.isArray(o))return!1;var m=s.toLowerCase();return!!~o.indexOf(m)&&m}function findAlignSetting(o){return isAllowedValue(s,o)}function extend(o){for(var s=arguments.length,m=new Array(s>1?s-1:0),_=1;_<s;_++)m[_-1]=arguments[_];for(var S=1;S<arguments.length;S++){var E=arguments[S];for(var A in E)o[A]=E[A]}return o}function VTTCue(s,m,_){var S=this,E={enumerable:!0};S.hasBeenReset=!1;var A="",O=!1,H=s,K=m,z=_,G=null,q="",X=!0,J="auto",ae="start",pe=50,me="middle",_e=50,Se="middle";Object.defineProperty(S,"id",extend({},E,{get:function get(){return A},set:function set(o){A=""+o}})),Object.defineProperty(S,"pauseOnExit",extend({},E,{get:function get(){return O},set:function set(o){O=!!o}})),Object.defineProperty(S,"startTime",extend({},E,{get:function get(){return H},set:function set(o){if("number"!=typeof o)throw new TypeError("Start time must be set to a number.");H=o,this.hasBeenReset=!0}})),Object.defineProperty(S,"endTime",extend({},E,{get:function get(){return K},set:function set(o){if("number"!=typeof o)throw new TypeError("End time must be set to a number.");K=o,this.hasBeenReset=!0}})),Object.defineProperty(S,"text",extend({},E,{get:function get(){return z},set:function set(o){z=""+o,this.hasBeenReset=!0}})),Object.defineProperty(S,"region",extend({},E,{get:function get(){return G},set:function set(o){G=o,this.hasBeenReset=!0}})),Object.defineProperty(S,"vertical",extend({},E,{get:function get(){return q},set:function set(s){var m=function findDirectionSetting(s){return isAllowedValue(o,s)}(s);if(!1===m)throw new SyntaxError("An invalid or illegal string was specified.");q=m,this.hasBeenReset=!0}})),Object.defineProperty(S,"snapToLines",extend({},E,{get:function get(){return X},set:function set(o){X=!!o,this.hasBeenReset=!0}})),Object.defineProperty(S,"line",extend({},E,{get:function get(){return J},set:function set(o){if("number"!=typeof o&&"auto"!==o)throw new SyntaxError("An invalid number or illegal string was specified.");J=o,this.hasBeenReset=!0}})),Object.defineProperty(S,"lineAlign",extend({},E,{get:function get(){return ae},set:function set(o){var s=findAlignSetting(o);if(!s)throw new SyntaxError("An invalid or illegal string was specified.");ae=s,this.hasBeenReset=!0}})),Object.defineProperty(S,"position",extend({},E,{get:function get(){return pe},set:function set(o){if(o<0||o>100)throw new Error("Position must be between 0 and 100.");pe=o,this.hasBeenReset=!0}})),Object.defineProperty(S,"positionAlign",extend({},E,{get:function get(){return me},set:function set(o){var s=findAlignSetting(o);if(!s)throw new SyntaxError("An invalid or illegal string was specified.");me=s,this.hasBeenReset=!0}})),Object.defineProperty(S,"size",extend({},E,{get:function get(){return _e},set:function set(o){if(o<0||o>100)throw new Error("Size must be between 0 and 100.");_e=o,this.hasBeenReset=!0}})),Object.defineProperty(S,"align",extend({},E,{get:function get(){return Se},set:function set(o){var s=findAlignSetting(o);if(!s)throw new SyntaxError("An invalid or illegal string was specified.");Se=s,this.hasBeenReset=!0}})),S.displayState=void 0}return VTTCue.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},VTTCue}()},"./src/utils/vttparser.ts":
/*!********************************!*\
    !*** ./src/utils/vttparser.ts ***!
    \********************************/function srcUtilsVttparserTs(o,s,m){m.r(s),m.d(s,{VTTParser:function VTTParser(){return H},fixLineBreaks:function fixLineBreaks(){return _fixLineBreaks},parseTimeStamp:function parseTimeStamp(){return _parseTimeStamp}});var _=m(/*! ./vttcue */"./src/utils/vttcue.ts"),S=function(){function StringDecoder(){}return StringDecoder.prototype.decode=function decode(o,s){if(!o)return"";if("string"!=typeof o)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(o))},StringDecoder}();function _parseTimeStamp(o){function computeSeconds(o,s,m,_){return 3600*(0|o)+60*(0|s)+(0|m)+parseFloat(_||0)}var s=o.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return s?parseFloat(s[2])>59?computeSeconds(s[2],s[3],0,s[4]):computeSeconds(s[1],s[2],s[3],s[4]):null}var E=function(){function Settings(){this.values=Object.create(null)}var o=Settings.prototype;return o.set=function set(o,s){this.get(o)||""===s||(this.values[o]=s)},o.get=function get(o,s,m){return m?this.has(o)?this.values[o]:s[m]:this.has(o)?this.values[o]:s},o.has=function has(o){return o in this.values},o.alt=function alt(o,s,m){for(var _=0;_<m.length;++_)if(s===m[_]){this.set(o,s);break}},o.integer=function integer(o,s){/^-?\d+$/.test(s)&&this.set(o,parseInt(s,10))},o.percent=function percent(o,s){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(s)){var percent=parseFloat(s);if(percent>=0&&percent<=100)return this.set(o,percent),!0}return!1},Settings}();function parseOptions(o,s,m,_){var S=_?o.split(_):[o];for(var E in S)if("string"==typeof S[E]){var A=S[E].split(m);if(2===A.length)s(A[0],A[1])}}var A=new _.default(0,0,""),O="middle"===A.align?"middle":"center";function parseCue(o,s,m){var _=o;function consumeTimeStamp(){var s=_parseTimeStamp(o);if(null===s)throw new Error("Malformed timestamp: "+_);return o=o.replace(/^[^\sa-zA-Z-]+/,""),s}function skipWhitespace(){o=o.replace(/^\s+/,"")}if(skipWhitespace(),s.startTime=consumeTimeStamp(),skipWhitespace(),"--\x3e"!==o.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+_);o=o.slice(3),skipWhitespace(),s.endTime=consumeTimeStamp(),skipWhitespace(),function consumeCueSettings(o,s){var _=new E;parseOptions(o,(function(o,s){var S;switch(o){case"region":for(var E=m.length-1;E>=0;E--)if(m[E].id===s){_.set(o,m[E].region);break}break;case"vertical":_.alt(o,s,["rl","lr"]);break;case"line":S=s.split(","),_.integer(o,S[0]),_.percent(o,S[0])&&_.set("snapToLines",!1),_.alt(o,S[0],["auto"]),2===S.length&&_.alt("lineAlign",S[1],["start",O,"end"]);break;case"position":S=s.split(","),_.percent(o,S[0]),2===S.length&&_.alt("positionAlign",S[1],["start",O,"end","line-left","line-right","auto"]);break;case"size":_.percent(o,s);break;case"align":_.alt(o,s,["start",O,"end","left","right"])}}),/:/,/\s/),s.region=_.get("region",null),s.vertical=_.get("vertical","");var S=_.get("line","auto");"auto"===S&&-1===A.line&&(S=-1),s.line=S,s.lineAlign=_.get("lineAlign","start"),s.snapToLines=_.get("snapToLines",!0),s.size=_.get("size",100),s.align=_.get("align",O);var H=_.get("position","auto");"auto"===H&&50===A.position&&(H="start"===s.align||"left"===s.align?0:"end"===s.align||"right"===s.align?100:50),s.position=H}(o,s)}function _fixLineBreaks(o){return o.replace(/<br(?: \/)?>/gi,"\n")}var H=function(){function VTTParser(){this.state="INITIAL",this.buffer="",this.decoder=new S,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var o=VTTParser.prototype;return o.parse=function parse(o){var s=this;function collectNextLine(){var o=s.buffer,m=0;for(o=_fixLineBreaks(o);m<o.length&&"\r"!==o[m]&&"\n"!==o[m];)++m;var _=o.slice(0,m);return"\r"===o[m]&&++m,"\n"===o[m]&&++m,s.buffer=o.slice(m),_}o&&(s.buffer+=s.decoder.decode(o,{stream:!0}));try{var m="";if("INITIAL"===s.state){if(!/\r\n|\n/.test(s.buffer))return this;var S=(m=collectNextLine()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!S||!S[0])throw new Error("Malformed WebVTT signature.");s.state="HEADER"}for(var E=!1;s.buffer;){if(!/\r\n|\n/.test(s.buffer))return this;switch(E?E=!1:m=collectNextLine(),s.state){case"HEADER":/:/.test(m)?parseOptions(m,(function(o,s){}),/:/):m||(s.state="ID");continue;case"NOTE":m||(s.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(m)){s.state="NOTE";break}if(!m)continue;if(s.cue=new _.default(0,0,""),s.state="CUE",-1===m.indexOf("--\x3e")){s.cue.id=m;continue}case"CUE":if(!s.cue){s.state="BADCUE";continue}try{parseCue(m,s.cue,s.regionList)}catch(o){s.cue=null,s.state="BADCUE";continue}s.state="CUETEXT";continue;case"CUETEXT":var A=-1!==m.indexOf("--\x3e");if(!m||A&&(E=!0)){s.oncue&&s.cue&&s.oncue(s.cue),s.cue=null,s.state="ID";continue}if(null===s.cue)continue;s.cue.text&&(s.cue.text+="\n"),s.cue.text+=m;continue;case"BADCUE":m||(s.state="ID")}}}catch(o){"CUETEXT"===s.state&&s.cue&&s.oncue&&s.oncue(s.cue),s.cue=null,s.state="INITIAL"===s.state?"BADWEBVTT":"BADCUE"}return this},o.flush=function flush(){var o=this;try{if((o.cue||"HEADER"===o.state)&&(o.buffer+="\n\n",o.parse()),"INITIAL"===o.state||"BADWEBVTT"===o.state)throw new Error("Malformed WebVTT signature.")}catch(s){o.onparsingerror&&o.onparsingerror(s)}return o.onflush&&o.onflush(),this},VTTParser}()},"./src/utils/webvtt-parser.ts":
/*!************************************!*\
    !*** ./src/utils/webvtt-parser.ts ***!
    \************************************/function srcUtilsWebvttParserTs(o,s,m){m.r(s),m.d(s,{generateCueId:function generateCueId(){return _generateCueId},parseWebVTT:function parseWebVTT(){return _parseWebVTT}});var _=m(/*! ./src/polyfills/number */"./src/polyfills/number.ts"),S=m(/*! ./vttparser */"./src/utils/vttparser.ts"),E=m(/*! ../demux/id3 */"./src/demux/id3.ts"),A=m(/*! ./timescale-conversion */"./src/utils/timescale-conversion.ts"),O=m(/*! ../remux/mp4-remuxer */"./src/remux/mp4-remuxer.ts"),H=/\r\n|\n\r|\n|\r/g,K=function startsWith(o,s,m){return void 0===m&&(m=0),o.slice(m,m+s.length)===s},z=function cueString2millis(o){var s=parseInt(o.slice(-3)),m=parseInt(o.slice(-6,-4)),S=parseInt(o.slice(-9,-7)),E=o.length>9?parseInt(o.substring(0,o.indexOf(":"))):0;if(!((0,_.isFiniteNumber)(s)&&(0,_.isFiniteNumber)(m)&&(0,_.isFiniteNumber)(S)&&(0,_.isFiniteNumber)(E)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+o);return s+=1e3*m,s+=6e4*S,s+=36e5*E},G=function hash(o){for(var hash=5381,s=o.length;s;)hash=33*hash^o.charCodeAt(--s);return(hash>>>0).toString()};function _generateCueId(o,s,m){return G(o.toString())+G(s.toString())+G(m)}var q=function calculateOffset(o,s,m){var _=o[s],S=o[_.prevCC];if(!S||!S.new&&_.new)return o.ccOffset=o.presentationOffset=_.start,void(_.new=!1);for(;null!==(E=S)&&void 0!==E&&E.new;){var E;o.ccOffset+=_.start-S.start,_.new=!1,S=o[(_=S).prevCC]}o.presentationOffset=m};function _parseWebVTT(o,s,m,_,G,X,J,ae){var pe,me=new S.VTTParser,_e=(0,E.utf8ArrayToStr)(new Uint8Array(o)).trim().replace(H,"\n").split("\n"),Se=[],Ee=(0,A.toMpegTsClockFromTimescale)(s,m),De="00:00.000",$e=0,He=0,et=!0;me.oncue=function(o){var s=_[G],m=_.ccOffset,S=($e-Ee)/9e4;null!=s&&s.new&&(void 0!==He?m=_.ccOffset=s.start:q(_,G,S)),S&&(m=S-_.presentationOffset);var E=o.endTime-o.startTime,A=(0,O.normalizePts)(9e4*(o.startTime+m-He),9e4*X)/9e4;o.startTime=Math.max(A,0),o.endTime=Math.max(A+E,0);var H=o.text.trim();o.text=decodeURIComponent(encodeURIComponent(H)),o.id||(o.id=_generateCueId(o.startTime,o.endTime,H)),o.endTime>0&&Se.push(o)},me.onparsingerror=function(o){pe=o},me.onflush=function(){pe?ae(pe):J(Se)},_e.forEach((function(o){if(et){if(K(o,"X-TIMESTAMP-MAP=")){et=!1,o.slice(16).split(",").forEach((function(o){K(o,"LOCAL:")?De=o.slice(6):K(o,"MPEGTS:")&&($e=parseInt(o.slice(7)))}));try{He=z(De)/1e3}catch(o){pe=o}return}""===o&&(et=!1)}me.parse(o+"\n")})),me.flush()}},"./src/utils/xhr-loader.ts":
/*!*********************************!*\
    !*** ./src/utils/xhr-loader.ts ***!
    \*********************************/function srcUtilsXhrLoaderTs(o,s,m){m.r(s),m.d(s,{default:function _default(){return O}});var _=m(/*! ../utils/logger */"./src/utils/logger.ts"),S=m(/*! ../loader/load-stats */"./src/loader/load-stats.ts"),E=/^age:\s*[\d.]+\s*$/m,A=function(){function XhrLoader(o){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=o?o.xhrSetup:null,this.stats=new S.LoadStats,this.retryDelay=0}var o=XhrLoader.prototype;return o.destroy=function destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},o.abortInternal=function abortInternal(){var o=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),o&&(o.onreadystatechange=null,o.onprogress=null,4!==o.readyState&&(this.stats.aborted=!0,o.abort()))},o.abort=function abort(){var o;this.abortInternal(),null!==(o=this.callbacks)&&void 0!==o&&o.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},o.load=function load(o,s,m){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=o,this.config=s,this.callbacks=m,this.retryDelay=s.retryDelay,this.loadInternal()},o.loadInternal=function loadInternal(){var o=this.config,s=this.context;if(o){var m=this.loader=new self.XMLHttpRequest,_=this.stats;_.loading.first=0,_.loaded=0;var S=this.xhrSetup;try{if(S)try{S(m,s.url)}catch(o){m.open("GET",s.url,!0),S(m,s.url)}m.readyState||m.open("GET",s.url,!0);var E=this.context.headers;if(E)for(var A in E)m.setRequestHeader(A,E[A])}catch(o){return void this.callbacks.onError({code:m.status,text:o.message},s,m)}s.rangeEnd&&m.setRequestHeader("Range","bytes="+s.rangeStart+"-"+(s.rangeEnd-1)),m.onreadystatechange=this.readystatechange.bind(this),m.onprogress=this.loadprogress.bind(this),m.responseType=s.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.timeout),m.send()}},o.readystatechange=function readystatechange(){var o=this.context,s=this.loader,m=this.stats;if(o&&s){var S=s.readyState,E=this.config;if(!m.aborted&&S>=2)if(self.clearTimeout(this.requestTimeout),0===m.loading.first&&(m.loading.first=Math.max(self.performance.now(),m.loading.start)),4===S){s.onreadystatechange=null,s.onprogress=null;var A=s.status,O="arraybuffer"===s.responseType;if(A>=200&&A<300&&(O&&s.response||null!==s.responseText)){var H,K;if(m.loading.end=Math.max(self.performance.now(),m.loading.first),K=O?(H=s.response).byteLength:(H=s.responseText).length,m.loaded=m.total=K,!this.callbacks)return;var z=this.callbacks.onProgress;if(z&&z(m,o,H,s),!this.callbacks)return;var G={url:s.responseURL,data:H};this.callbacks.onSuccess(G,m,o,s)}else m.retry>=E.maxRetry||A>=400&&A<499?(_.logger.error(A+" while loading "+o.url),this.callbacks.onError({code:A,text:s.statusText},o,s)):(_.logger.warn(A+" while loading "+o.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,E.maxRetryDelay),m.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),E.timeout)}},o.loadtimeout=function loadtimeout(){_.logger.warn("timeout while loading "+this.context.url);var o=this.callbacks;o&&(this.abortInternal(),o.onTimeout(this.stats,this.context,this.loader))},o.loadprogress=function loadprogress(o){var s=this.stats;s.loaded=o.loaded,o.lengthComputable&&(s.total=o.total)},o.getCacheAge=function getCacheAge(){var o=null;if(this.loader&&E.test(this.loader.getAllResponseHeaders())){var s=this.loader.getResponseHeader("age");o=s?parseFloat(s):null}return o},XhrLoader}(),O=A},"./node_modules/eventemitter3/index.js":
/*!*********************************************!*\
    !*** ./node_modules/eventemitter3/index.js ***!
    \*********************************************/function node_modulesEventemitter3IndexJs(o){var s=Object.prototype.hasOwnProperty,m="~";function Events(){}function EE(o,s,m){this.fn=o,this.context=s,this.once=m||!1}function addListener(o,s,_,S,E){if("function"!=typeof _)throw new TypeError("The listener must be a function");var A=new EE(_,S||o,E),O=m?m+s:s;return o._events[O]?o._events[O].fn?o._events[O]=[o._events[O],A]:o._events[O].push(A):(o._events[O]=A,o._eventsCount++),o}function clearEvent(o,s){0==--o._eventsCount?o._events=new Events:delete o._events[s]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(m=!1)),EventEmitter.prototype.eventNames=function eventNames(){var o,_,S=[];if(0===this._eventsCount)return S;for(_ in o=this._events)s.call(o,_)&&S.push(m?_.slice(1):_);return Object.getOwnPropertySymbols?S.concat(Object.getOwnPropertySymbols(o)):S},EventEmitter.prototype.listeners=function listeners(o){var s=m?m+o:o,_=this._events[s];if(!_)return[];if(_.fn)return[_.fn];for(var S=0,E=_.length,A=new Array(E);S<E;S++)A[S]=_[S].fn;return A},EventEmitter.prototype.listenerCount=function listenerCount(o){var s=m?m+o:o,_=this._events[s];return _?_.fn?1:_.length:0},EventEmitter.prototype.emit=function emit(o,s,_,S,E,A){var O=m?m+o:o;if(!this._events[O])return!1;var H,K,z=this._events[O],G=arguments.length;if(z.fn){switch(z.once&&this.removeListener(o,z.fn,void 0,!0),G){case 1:return z.fn.call(z.context),!0;case 2:return z.fn.call(z.context,s),!0;case 3:return z.fn.call(z.context,s,_),!0;case 4:return z.fn.call(z.context,s,_,S),!0;case 5:return z.fn.call(z.context,s,_,S,E),!0;case 6:return z.fn.call(z.context,s,_,S,E,A),!0}for(K=1,H=new Array(G-1);K<G;K++)H[K-1]=arguments[K];z.fn.apply(z.context,H)}else{var q,X=z.length;for(K=0;K<X;K++)switch(z[K].once&&this.removeListener(o,z[K].fn,void 0,!0),G){case 1:z[K].fn.call(z[K].context);break;case 2:z[K].fn.call(z[K].context,s);break;case 3:z[K].fn.call(z[K].context,s,_);break;case 4:z[K].fn.call(z[K].context,s,_,S);break;default:if(!H)for(q=1,H=new Array(G-1);q<G;q++)H[q-1]=arguments[q];z[K].fn.apply(z[K].context,H)}}return!0},EventEmitter.prototype.on=function on(o,s,m){return addListener(this,o,s,m,!1)},EventEmitter.prototype.once=function once(o,s,m){return addListener(this,o,s,m,!0)},EventEmitter.prototype.removeListener=function removeListener(o,s,_,S){var E=m?m+o:o;if(!this._events[E])return this;if(!s)return clearEvent(this,E),this;var A=this._events[E];if(A.fn)A.fn!==s||S&&!A.once||_&&A.context!==_||clearEvent(this,E);else{for(var O=0,H=[],K=A.length;O<K;O++)(A[O].fn!==s||S&&!A[O].once||_&&A[O].context!==_)&&H.push(A[O]);H.length?this._events[E]=1===H.length?H[0]:H:clearEvent(this,E)}return this},EventEmitter.prototype.removeAllListeners=function removeAllListeners(o){var s;return o?(s=m?m+o:o,this._events[s]&&clearEvent(this,s)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=m,EventEmitter.EventEmitter=EventEmitter,o.exports=EventEmitter},"./node_modules/url-toolkit/src/url-toolkit.js":
/*!*****************************************************!*\
    !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!
    \*****************************************************/function node_modulesUrlToolkitSrcUrlToolkitJs(o){!function(s){var m=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,_=/^(?=([^\/?#]*))\1([^]*)$/,S=/(?:\/|^)\.(?=\/)/g,E=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,A={buildAbsoluteURL:function buildAbsoluteURL(o,s,m){if(m=m||{},o=o.trim(),!(s=s.trim())){if(!m.alwaysNormalize)return o;var S=A.parseURL(o);if(!S)throw new Error("Error trying to parse base URL.");return S.path=A.normalizePath(S.path),A.buildURLFromParts(S)}var E=A.parseURL(s);if(!E)throw new Error("Error trying to parse relative URL.");if(E.scheme)return m.alwaysNormalize?(E.path=A.normalizePath(E.path),A.buildURLFromParts(E)):s;var O=A.parseURL(o);if(!O)throw new Error("Error trying to parse base URL.");if(!O.netLoc&&O.path&&"/"!==O.path[0]){var H=_.exec(O.path);O.netLoc=H[1],O.path=H[2]}O.netLoc&&!O.path&&(O.path="/");var K={scheme:O.scheme,netLoc:E.netLoc,path:null,params:E.params,query:E.query,fragment:E.fragment};if(!E.netLoc&&(K.netLoc=O.netLoc,"/"!==E.path[0]))if(E.path){var z=O.path,G=z.substring(0,z.lastIndexOf("/")+1)+E.path;K.path=A.normalizePath(G)}else K.path=O.path,E.params||(K.params=O.params,E.query||(K.query=O.query));return null===K.path&&(K.path=m.alwaysNormalize?A.normalizePath(E.path):E.path),A.buildURLFromParts(K)},parseURL:function parseURL(o){var s=m.exec(o);return s?{scheme:s[1]||"",netLoc:s[2]||"",path:s[3]||"",params:s[4]||"",query:s[5]||"",fragment:s[6]||""}:null},normalizePath:function normalizePath(o){for(o=o.split("").reverse().join("").replace(S,"");o.length!==(o=o.replace(E,"")).length;);return o.split("").reverse().join("")},buildURLFromParts:function buildURLFromParts(o){return o.scheme+o.netLoc+o.path+o.params+o.query+o.fragment}};o.exports=A}()}},s={};function __webpack_require__(m){var _=s[m];if(void 0!==_)return _.exports;var S=s[m]={exports:{}};return o[m].call(S.exports,S,S.exports,__webpack_require__),S.exports}__webpack_require__.m=o,__webpack_require__.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return __webpack_require__.d(s,{a:s}),s},__webpack_require__.d=function(o,s){for(var m in s)__webpack_require__.o(s,m)&&!__webpack_require__.o(o,m)&&Object.defineProperty(o,m,{enumerable:!0,get:s[m]})},__webpack_require__.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},__webpack_require__.r=function(o){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})};var m=__webpack_require__("./src/hls.ts");return m=m.default}()}))}(sV);var uV=getDefaultExportFromCjs$1(sV.exports),lV=new Map([["abort","Abort"],["canplay","CanPlay"],["canplaythrough","CanPlayThrough"],["durationchange","DurationChange"],["emptied","Emptied"],["encrypted","Encrypted"],["ended","Ended"],["error","Error"],["interruptbegin","InterruptBegin"],["interruptend","InterruptEnd"],["loadeddata","LoadedData"],["loadedmetadata","LoadedMetadata"],["loadstart","LoadStart"],["pause","Pause"],["play","Play"],["playing","Playing"],["progress","Progress"],["ratechange","Ratechange"],["seeked","Seeked"],["seeking","Seeking"],["stalled","Stalled"],["suspend","Suspend"],["timeupdate","TimeUpdate"],["volumechange","VolumeChange"],["waiting","Waiting"]]);function forceHTTPS$2(o){return"https:"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.location.protocol)?o.replace("http:","https:"):o}function withPrecision$1(o){return Math.round(1*o)+"px"}var cV=function(){function DependencyRegistry(){_classCallCheck$1(this,DependencyRegistry),this.typeMappings=[],this.dependencyKeys={LogStorage:"LogStorage",API:"API",Store:"Store",Profiling:"Profiling",Logger:"Logger"}}return _createClass$1(DependencyRegistry,[{key:"registerType",value:function registerType(o,s){var m=this.typeMappings.findIndex((function(o){return o.token===s}));-1!==m?this.typeMappings[m]={instance:o,token:s}:this.typeMappings.push({instance:o,token:s})}},{key:"resolveType",value:function resolveType(o){var s=this.typeMappings.find((function(s){return s.token===o}));if(!s)throw new Error("Type registration not found for type ".concat(o));return s.instance}}]),DependencyRegistry}();new cV;var dV=function(){function DebugProxy(){_classCallCheck$1(this,DebugProxy),this._isStarted=!1}return _createClass$1(DebugProxy,[{key:"startProxy",value:function startProxy(o){if(this._isStarted)console.error("Error starting DebugProxy; it is already started");else{o.indexOf(":")<0&&(o+=":8888"),this._isStarted=!0,console.warn("DebugProxy started using proxyAddress=".concat(o));var s="http://".concat(o,"/;"),m=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(_,S,E,A,O){(S=S.toString()).toString().indexOf(o)<0&&(S="".concat(s).concat(S)),m.bind(this)(_,S.toString(),!!E,A,O)};var _=window.fetch;window.fetch=function(m,S){var E=m.toString();return E.toString().indexOf(o)<0&&(E="".concat(s).concat(E)),_(E,S)}}}}]),DebugProxy}();new dV;var hV,pV=function(){function DateTimeService(){_classCallCheck$1(this,DateTimeService)}return _createClass$1(DateTimeService,[{key:"getUTCString",value:function getUTCString(o){return o||(o=new Date),new Date(o).toUTCString()}},{key:"getUTCNow",value:function getUTCNow(){return this.asUTC()}},{key:"asUTC",value:function asUTC(o){return new Date(this.getUTCString(o))}}]),DateTimeService}();!function(o){o[o.ERROR=1]="ERROR",o[o.WARN=2]="WARN",o[o.INFO=3]="INFO",o[o.DEBUG=4]="DEBUG",o[o.PERFORMANCE=5]="PERFORMANCE"}(hV||(hV={}));var fV=function(){function Logger(o){_classCallCheck$1(this,Logger),this.dateTimeService=new pV,this._logLevel=hV.DEBUG,this.logStorage=o}return _createClass$1(Logger,[{key:"LogLevel",get:function get(){return this._logLevel},set:function set(o){this._logLevel=o}},{key:"log",value:function log(o,s){if(o<=this.LogLevel){var m=this.dateTimeService.getUTCNow().toISOString(),_="".concat(m," | [").concat(hV[o],"] ").concat(s);this.logStorage.send(_,o)}}},{key:"error",value:function error(o){this.log(hV.ERROR,o)}},{key:"warn",value:function warn(o){this.log(hV.WARN,o)}},{key:"info",value:function info(o){this.log(hV.INFO,o)}},{key:"debug",value:function debug(o){this.log(hV.DEBUG,o)}},{key:"performance",value:function performance(o){this.log(hV.PERFORMANCE,o)}}]),Logger}(),gV=function(){function ConsoleLogStorage(){_classCallCheck$1(this,ConsoleLogStorage),this.logBatch=[]}return _createClass$1(ConsoleLogStorage,[{key:"send",value:function send(o,s){switch(s){case hV.DEBUG:console.debug(o);break;case hV.ERROR:console.error(o);break;case hV.WARN:console.warn(o);break;case hV.INFO:console.info(o);break;default:console.log(o)}}}]),ConsoleLogStorage}(),__awaiter$5=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},mV=function(){function HLSPlayer(o){var s=this;_classCallCheck$1(this,HLSPlayer),this._hls=null,this._currentTime=0,this._bitrateRange={min:-1,max:-1},this._maxLatency=30,this.logger=new fV(new gV),this._ccEnabled=!1,this.supportedFormats=[".m3u8",".mp4",".mp3",".wav",".ogg",".aac",".flac"],this.shouldRetryOnFailure=!1,this.errorCount=0,this.retryAttempts=2,this.retryWaitTime=1e3,this.timeoutId=null,this._renderCC=function(o){s.logger.info(o)};var m=o.width,_=o.height,S=o.bitrateRange,E=o.videoEl,A=o.shouldRetry,O=o.retryAttempts,H=o.retryWaitTime;E?this._video=E:(this._video=document.createElement("video"),this._video.id="hls-player",this._video.hidden=!0,document.body.appendChild(this._video)),this.shouldRetryOnFailure=null!=A&&A,this.retryAttempts=null!=O?O:2,this.retryWaitTime=null!=H?H:this.retryWaitTime,this._video.style.position="absolute",this._width=m,this._height=_,this.size(m,_),Object.assign(window,{_instanceHLSPlayer:this._video}),this._bitrateRange=S}return _createClass$1(HLSPlayer,[{key:"open",value:function open(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VOD";return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return this.timeoutId&&(clearTimeout(Number(this.timeoutId)),this.timeoutId=null),m.next=3,this._play(o,s);case 3:case"end":return m.stop()}}),_callee,this)})))}},{key:"_play",value:function _play(o,s){return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:return this._playbackConfig={type:s,url:o,startPosition:null},m.next=3,this._videoLoader(forceHTTPS$2(this._playbackConfig.url),this._video);case 3:this.logger.info("".concat(this._playbackConfig.url," '< playWithUrl'"));case 4:case"end":return m.stop()}}),_callee2,this)})))}},{key:"_videoLoader",value:function _videoLoader(o,s){return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){var m=this;return _regeneratorRuntime$1().wrap((function _callee4$(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",new Promise((function(_,S){if(s.hidden=!1,s.oncanplay=function(){s.oncanplay=null,_()},!(o.indexOf(".m3u8")>-1))return s.setAttribute("src",o),void s.load();m._hls||(m._hls=new uV({autoStartLoad:!1,manifestLoadingTimeOut:2e4,manifestLoadingMaxRetry:3,minAutoBitrate:m._bitrateRange.min,backBufferLength:0,maxBufferLength:15,maxBufferSize:3e7}),m._hls.on(uV.Events.MANIFEST_PARSED,(function(o,s){if(m._hls){var _=m._playbackConfig&&"vod"===m._playbackConfig.type&&m._playbackConfig.startPosition||-1;m._hls.startLoad(_);var S=function findLevel(o){return(s.levels||[]).filter((function(s){return s&&s.bitrate<=o})).length-1};m._hls.autoLevelCapping=S(m._bitrateRange.max);var E=S(m._bitrateRange.min);E>-1&&(m._hls.nextLoadLevel=E)}})),m._hls.on(uV.Events.SUBTITLE_TRACKS_UPDATED,(function(){m._hls&&(m._hls.subtitleTrack=0)})),m._hls.on(uV.Events.SUBTITLE_TRACK_LOADED,(function(){m._hls&&(m._hls.subtitleTrack=0)})),s.textTracks.onaddtrack=function(o){return __awaiter$5(m,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){var s,m=this;return _regeneratorRuntime$1().wrap((function _callee3$(_){for(;;)switch(_.prev=_.next){case 0:o.track&&"captions"===o.track.kind&&((s=o.track).mode="showing",s.oncuechange=function(){var o,_=s.activeCues&&_toConsumableArray$1(s.activeCues).map((function(o){return o}))||[];m._renderCC(null===(o=_[0])||void 0===o?void 0:o.text)});case 1:case"end":return _.stop()}}),_callee3)})))}),m.logger.info("hls v, ".concat(uV.version,", ").concat(m._hls.config.enableCEA708Captions)),m._hls.attachMedia(s),m._hls.on(uV.Events.ERROR,(function(o){S(o)})),m._hls.loadSource(o)})));case 1:case"end":return _.stop()}}),_callee4)})))}},{key:"destroy",value:function destroy(){var o;return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(s){for(;;)switch(s.prev=s.next){case 0:this.deregisterEventListeners(),document.body.removeChild(this._video),null===(o=this._hls)||void 0===o||o.destroy();case 3:case"end":return s.stop()}}),_callee5,this)})))}},{key:"_videoUnloader",value:function _videoUnloader(o){return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(s){for(;;)switch(s.prev=s.next){case 0:this._hls&&(this._hls.destroy(),this._hls=null),o.removeAttribute("src"),o.load();case 3:case"end":return s.stop()}}),_callee6,this)})))}},{key:"registerEventListeners",value:function registerEventListeners(o){var s,m=this,_=_createForOfIteratorHelper(lV);try{for(_.s();!(s=_.n()).done;){var S=s.value;this._video.addEventListener(S[0],(function(s){m.handleEvent(s,o)}))}}catch(o){_.e(o)}finally{_.f()}}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(o,s){var m=this.getMappedEventKey(o);m&&this._video.addEventListener(m,s)}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(o,s){this._video.removeEventListener(o,s)}},{key:"deregisterEventListeners",value:function deregisterEventListeners(){var o,s=this,m=_createForOfIteratorHelper(lV);try{for(m.s();!(o=m.n()).done;){var _=o.value;this._video.removeEventListener(_[0],(function(o){s.handleEvent(o)}))}}catch(o){m.e(o)}finally{m.f()}this._video.textTracks.onaddtrack=null}},{key:"handleEvent",value:function handleEvent(o,s){return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee8(){var m,_,S,E,A,O,H=this;return _regeneratorRuntime$1().wrap((function _callee8$(K){for(;;)switch(K.prev=K.next){case 0:if(m=lV.get(o.type),this._hls&&this._hls.media&&(_=Math.round(this._hls.media.currentTime))!==this._currentTime&&(this._currentTime=_),!m){K.next=14;break}S={playbackConfig:this._playbackConfig},K.t0=m,K.next="Playing"===K.t0||"TimeUpdate"===K.t0?7:"Pause"===K.t0||"LoadStart"===K.t0||"Ended"===K.t0||"Error"===K.t0?9:"Abort"===K.t0||"Stalled"===K.t0?10:12;break;case 7:return this.isPlaying||(this.isPlaying=!0),K.abrupt("break",13);case 9:this._video.error&&(S.errorContext={code:"".concat(this._video.error.code),message:this._video.error.message});case 10:return this.isPlaying&&(this.isPlaying=!1),K.abrupt("break",13);case 12:return K.abrupt("break",13);case 13:"Error"===m?S.errorContext&&parseInt(S.errorContext.code)>=2&&(this.shouldRetryOnFailure&&this.errorCount<=this.retryAttempts?(this.errorCount++,this._playbackConfig&&(E=this._playbackConfig.url,A=this._playbackConfig.type||"VOD",O=this.retryWaitTime>1e3?this.retryWaitTime:this.retryWaitTime*this.errorCount,this.timeoutId=setTimeout((function(){return __awaiter$5(H,void 0,void 0,_regeneratorRuntime$1().mark((function _callee7(){return _regeneratorRuntime$1().wrap((function _callee7$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.open(forceHTTPS$2(E),A);case 2:case"end":return o.stop()}}),_callee7,this)})))}),O))):(this.errorCount=0,s&&s({type:m,timestamp:o.timeStamp,metadata:S}))):s&&s({type:m,timestamp:o.timeStamp,metadata:S});case 14:case"end":return K.stop()}}),_callee8,this)})))}},{key:"pause",value:function pause(){return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee9(){var o=this;return _regeneratorRuntime$1().wrap((function _callee9$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s,m){o._video.pause(),o._video.onpause=function(){o._video.onpause=null,o._video.onerror=null,s()},o._video.onerror=function(){o._video.onpause=null,o._video.onerror=null,m()}})));case 1:case"end":return s.stop()}}),_callee9)})))}},{key:"play",value:function play(){return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee10(){return _regeneratorRuntime$1().wrap((function _callee10$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this._video.play();case 2:case"end":return o.stop()}}),_callee10,this)})))}},{key:"close",value:function close(){return __awaiter$5(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee11(){return _regeneratorRuntime$1().wrap((function _callee11$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this._videoUnloader(this._video);case 2:this._video.hidden=!0;case 3:case"end":return o.stop()}}),_callee11,this)})))}},{key:"seek",value:function seek(o){var s=this;return new Promise((function(m,_){s._video.currentTime=Math.max(0,Math.min(o,s.duration-.1)),s._video.onseeked=function(){s._video.onseeked=null,m()},s._video.onerror=function(){s._video.onerror=null,_()}}))}},{key:"size",value:function size(o,s){this._video.style.width=withPrecision$1(o),this._video.style.height=withPrecision$1(s)}},{key:"position",value:function position(o,s){this._video.style.left=withPrecision$1(o),this._video.style.top=withPrecision$1(s)}},{key:"mute",value:function mute(){this._video.muted=!0}},{key:"unmute",value:function unmute(){this._video.muted=!1}},{key:"loop",value:function loop(){var o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._video.loop=o}},{key:"hide",value:function hide(){this._video.hidden=!0}},{key:"show",value:function show(){this._video.hidden=!1}},{key:"getMappedEventKey",value:function getMappedEventKey(o){var s,m=_createForOfIteratorHelper(lV.entries());try{for(m.s();!(s=m.n()).done;){var _=_slicedToArray$1(s.value,2),S=_[0];if(_[1]===o)return S}}catch(o){m.e(o)}finally{m.f()}}},{key:"onPlayerEvent",set:function set(o){try{this.registerEventListeners(o)}catch(o){this.logger.warn("Player encountered an error when registering listeners ".concat(o))}}},{key:"renderCC",set:function set(o){this._renderCC=o}},{key:"width",get:function get(){return this._width}},{key:"height",get:function get(){return this._height}},{key:"bitrateRange",get:function get(){return this._bitrateRange}},{key:"ccEnabled",get:function get(){return this._ccEnabled},set:function set(o){this._ccEnabled=o,this.toggleCC(o)}},{key:"toggleCC",value:function toggleCC(o){this._hls&&(this._hls.subtitleDisplay=o)}},{key:"ccAvailable",get:function get(){var o;return!!this._hls&&(null===(o=this._hls)||void 0===o?void 0:o.subtitleTrack)>-1}},{key:"isPlaying",get:function get(){return!this._video.paused},set:function set(o){o?this._video.pause():this._video.play(),o&&this._playbackConfig&&"live"===this._playbackConfig.type&&this._hls&&this._hls.media&&this._hls.liveSyncPosition&&this._hls.targetLatency&&this._hls.latency-this._hls.targetLatency>this._maxLatency&&(this._hls.media.currentTime=this._hls.liveSyncPosition)}},{key:"currentTime",get:function get(){return this._video.currentTime}},{key:"duration",get:function get(){return this._video.duration}},{key:"videoElement",get:function get(){return this._video},set:function set(o){this._video=o,this.size(this._width,this._height)}},{key:"isFormatSupported",value:function isFormatSupported(o){var s=this.supportedFormats;for(var m in s)if(o.includes(s[m]))return!0;return!1}}]),HLSPlayer}();mV.version=uV.version;var yV=function(){function DependencyRegistry(){_classCallCheck$1(this,DependencyRegistry),this.typeMappings=[],this.dependencyKeys={LogStorage:"LogStorage",API:"API",Store:"Store",Profiling:"Profiling",Logger:"Logger"}}return _createClass$1(DependencyRegistry,[{key:"registerType",value:function registerType(o,s){var m=this.typeMappings.findIndex((function(o){return o.token===s}));-1!==m?this.typeMappings[m]={instance:o,token:s}:this.typeMappings.push({instance:o,token:s})}},{key:"resolveType",value:function resolveType(o){var s=this.typeMappings.find((function(s){return s.token===o}));if(!s)throw new Error("Type registration not found for type ".concat(o));return s.instance}}]),DependencyRegistry}();new yV;var vV=function(){function DebugProxy(){_classCallCheck$1(this,DebugProxy),this._isStarted=!1}return _createClass$1(DebugProxy,[{key:"startProxy",value:function startProxy(o){if(this._isStarted)console.error("Error starting DebugProxy; it is already started");else{o.indexOf(":")<0&&(o+=":8888"),this._isStarted=!0,console.warn("DebugProxy started using proxyAddress=".concat(o));var s="http://".concat(o,"/;"),m=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(_,S,E,A,O){(S=S.toString()).toString().indexOf(o)<0&&(S="".concat(s).concat(S)),m.bind(this)(_,S.toString(),!!E,A,O)};var _=window.fetch;window.fetch=function(m,S){var E=m.toString();return E.toString().indexOf(o)<0&&(E="".concat(s).concat(E)),_(E,S)}}}}]),DebugProxy}();new vV;var _V,bV=function(){function DateTimeService(){_classCallCheck$1(this,DateTimeService)}return _createClass$1(DateTimeService,[{key:"getUTCString",value:function getUTCString(o){return o||(o=new Date),new Date(o).toUTCString()}},{key:"getUTCNow",value:function getUTCNow(){return this.asUTC()}},{key:"asUTC",value:function asUTC(o){return new Date(this.getUTCString(o))}}]),DateTimeService}();!function(o){o[o.ERROR=1]="ERROR",o[o.WARN=2]="WARN",o[o.INFO=3]="INFO",o[o.DEBUG=4]="DEBUG",o[o.PERFORMANCE=5]="PERFORMANCE"}(_V||(_V={}));var SV=function(){function Logger(o){_classCallCheck$1(this,Logger),this.dateTimeService=new bV,this._logLevel=_V.DEBUG,this.logStorage=o}return _createClass$1(Logger,[{key:"LogLevel",get:function get(){return this._logLevel},set:function set(o){this._logLevel=o}},{key:"log",value:function log(o,s){if(o<=this.LogLevel){var m=this.dateTimeService.getUTCNow().toISOString(),_="".concat(m," | [").concat(_V[o],"] ").concat(s);this.logStorage.send(_,o)}}},{key:"error",value:function error(o){this.log(_V.ERROR,o)}},{key:"warn",value:function warn(o){this.log(_V.WARN,o)}},{key:"info",value:function info(o){this.log(_V.INFO,o)}},{key:"debug",value:function debug(o){this.log(_V.DEBUG,o)}},{key:"performance",value:function performance(o){this.log(_V.PERFORMANCE,o)}}]),Logger}(),TV=function(){function ConsoleLogStorage(){_classCallCheck$1(this,ConsoleLogStorage),this.logBatch=[]}return _createClass$1(ConsoleLogStorage,[{key:"send",value:function send(o,s){switch(s){case _V.DEBUG:console.debug(o);break;case _V.ERROR:console.error(o);break;case _V.WARN:console.warn(o);break;case _V.INFO:console.info(o);break;default:console.log(o)}}}]),ConsoleLogStorage}(),kV=new Map([["CanPlay","playbackStarted"],["Ended","playbackCompleted"],["Error","playbackFailed"],["interruptbegin","placementStart"],["interruptend","placementEnd"],["LoadedMetadata","mediaMetadata"],["Ratechange","playbackSpeedChanged"],["Seeked","seeked"],["TimeUpdate","playbackProgressUpdate"],["Waiting","bufferingChanged"],["DurationChange","durationChange"],["bitrateChanged","BitrateChanged"],["playbackStateChanged","playbackStateChanged"],["decoderAvailable","decoderAvailable"],["speedsChanged","speedsChanged"],["vttCueDataListener","vttCueDataListener"],["drmMetadata","drmMetadata"],["enteringLive","enteringLive"],["timedMetadata","timedMetadata"],["adResolved","adResolved"],["reservationStart","reservationStart"],["reservationEnd","reservationEnd"],["placementProgress","placementProgress"],["placementError","placementError"],["playlistIndexed","playlistIndexed"],["bulkTimedMetadata","bulkTimedMetadata"],["tuneProfiling","tuneProfiling"],["audioTracksChanged","audioTracksChanged"],["textTracksChanged","textTracksChanged"],["anomalyReport","anomalyReport"],["metricsData","metricsData"],["id3Metadata","id3Metadata"],["drmMessage","drmMessage"],["contentGap","contentGap"]]),CV=1,wV=4,xV=5,EV=6,IV=7,AV=8,__awaiter$4=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},PV=function(){function AAMPPlayer(o,s){var m=this,_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{min:0,max:0},S=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,E=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,A=arguments.length>5?arguments[5]:void 0,O=arguments.length>6?arguments[6]:void 0;_classCallCheck$1(this,AAMPPlayer),this.supportedFormats=[".mpd",".m3u8",".mp4",".mp3",".wav",".ogg",".aac",".flac"],this.restartPlaybackBind=this.restartPlayback.bind(this),this.currentProgress=-1,this.errorCount=0,this._ccEnabled=!1,this.logger=new SV(new TV),this.retryAttempts=2,this.retryWaitTime=1e3,this.timeoutId=null,this._renderCC=function(o){m.logger.info(o)},this.vttCueBuffer=[],this._width=o,this._height=s,this._x=S,this._y=E,this._bitrateRange=_,this.retryAttempts=null!=A?A:this.retryAttempts,this.retryWaitTime=null!=O?O:this.retryWaitTime,this._player=new AAMPMediaPlayer,this._player.setVideoRect(S,E,o,s),this.init()}return _createClass$1(AAMPPlayer,[{key:"init",value:function init(){Object.assign(window,{_instanceAAMPPlayer:this._player})}},{key:"play",value:function play(){return __awaiter$4(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o=this;return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",new Promise((function(s,m){o._player.addEventListener("playbackProgressUpdate",(function handleSuccess(){o._player.removeEventListener("playbackProgressUpdate",handleSuccess),s()})),o._player.addEventListener("playbackFailed",(function handleFail(s){o._player.removeEventListener("playbackFailed",handleFail),m(s)})),o._player.play()})));case 1:case"end":return s.stop()}}),_callee)})))}},{key:"pause",value:function pause(){var o=this;return new Promise((function(s,m){o._player.addEventListener("playbackStateChanged",(function handleSuccess(m){m.state===EV&&(o._player.removeEventListener("playbackStateChanged",handleSuccess),s())})),o._player.addEventListener("playbackFailed",(function handleFail(s){o._player.removeEventListener("playbackFailed",handleFail),m(s)})),o._player.pause()}))}},{key:"seek",value:function seek(o){var s=this;return new Promise((function(m,_){s._player.addEventListener("seeked",(function handleSuccess(){s._player.removeEventListener("seeked",handleSuccess),m()})),s._player.addEventListener("playbackFailed",(function handleFail(o){s._player.removeEventListener("playbackFailed",handleFail),_(o)}));var S=Math.max(0,Math.min(o,s.duration-.1));s._player.seek(S)}))}},{key:"mute",value:function mute(){this.volume=this._player.getVolume(),this._player.setVolume(0)}},{key:"unmute",value:function unmute(){this._player.setVolume(this.volume)}},{key:"open",value:function open(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VOD";return __awaiter$4(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:return this.timeoutId&&(clearTimeout(Number(this.timeoutId)),this.timeoutId=null),this.metadata={type:s,url:o,startPosition:null,errorContext:{code:"",message:""}},m.next=4,this._selectVideo(o);case 4:case"end":return m.stop()}}),_callee2,this)})))}},{key:"_selectVideo",value:function _selectVideo(o){var s=this;return new Promise((function(m,_){s._player.addEventListener("playbackStarted",(function handleSuccess(){s._player.removeEventListener("playbackStarted",handleSuccess),m()})),s._player.addEventListener("playbackFailed",(function handleFail(o){s._player.removeEventListener("playbackFailed",handleFail),_(o)})),s.isFormatSupported(o)||s.logger.warn("Video may not be supported in AAMP"),s._player.load(o)}))}},{key:"close",value:function close(){var o=this;return new Promise((function(s,m){try{o.clearSubtitles(),o.vttCueBuffer=[],o._player.stop(),s()}catch(o){m(o)}}))}},{key:"registerEventListeners",value:function registerEventListeners(o){var s,m=this,_=_createForOfIteratorHelper(kV);try{var S=function _loop2(){var _=_slicedToArray$1(s.value,2),S=_[0],E=_[1];m._player.addEventListener(E,(function(s){return m.handleEvent(S,s,o)}))};for(_.s();!(s=_.n()).done;)S()}catch(o){_.e(o)}finally{_.f()}}},{key:"deregisterEventListeners",value:function deregisterEventListeners(){var o,s=this,m=_createForOfIteratorHelper(kV);try{var _=function _loop3(){var m=_slicedToArray$1(o.value,2),_=m[0],S=m[1];s._player.removeEventListener(S,(function(o){return s.handleEvent(_,o)}))};for(m.s();!(o=m.n()).done;)_()}catch(o){m.e(o)}finally{m.f()}}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(o,s){var m=kV.get(o);m&&this._player.addEventListener(m,s)}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(o,s){this._player.removeEventListener(o,s)}},{key:"handleEvent",value:function handleEvent(o,s,m){var _=this,S=this.constructEvent(o,s);if("Error"===S.type&&this.logger.error("Player Event: ".concat(JSON.stringify(S.type,null,2),", 'metadata' ").concat(JSON.stringify(S.metadata,null,2))),"decoderAvailable"===S.type&&this.initClosedCaptions(s),"vttCueDataListener"===S.type&&this.webVTTHandler(s),"Pause"===S.type&&this.clearSubtitles(),"TimeUpdate"===S.type)this.currentProgress!==s.positionMiliseconds&&(this.currentProgress=s.positionMiliseconds,this.mediaProgressUpdate(s),m&&m(S));else if("Error"===S.type)if(S.metadata.errorContext.shouldRetry&&this.errorCount<this.retryAttempts){this.errorCount++;var E=this.retryWaitTime>1e3?this.retryWaitTime:this.retryWaitTime*this.errorCount;this.timeoutId=setTimeout((function(){return _.open(S.metadata.url,S.metadata.type)}),E)}else this.errorCount=0,m&&m(S);else m&&m(S)}},{key:"constructEvent",value:function constructEvent(o,s){switch(o){case"playbackStateChanged":if(s.state===AV)return{type:"Playing",timestamp:performance.now(),metadata:this.metadata};if(s.state===EV)return{type:"Pause",timestamp:performance.now(),metadata:this.metadata};if(s.state===IV)return{type:"Seeking",timestamp:performance.now(),metadata:this.metadata};if(s.state===xV)return{type:"Waiting",timestamp:performance.now(),metadata:this.metadata};if(s.state===CV)return{type:"LoadStart",timestamp:performance.now(),metadata:this.metadata};if(s.state===wV)return{type:"LoadedData",timestamp:performance.now(),metadata:this.metadata};case"Error":var m=this.metadata;return m.errorContext={code:"".concat(s.error),message:s.description,shouldRetry:s.shouldRetry},{type:o,timestamp:performance.now(),metadata:m};default:return{type:o,timestamp:performance.now(),metadata:this.metadata}}}},{key:"size",value:function size(o,s){this._height=s,this._width=o,this._player.setVideoRect(this._x,this._y,o,s)}},{key:"position",value:function position(o,s){this._x=o,this._y=s,this._player.setVideoRect(o,s,this._width,this._height)}},{key:"loop",value:function loop(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?this._player.addEventListener("playbackCompleted",this.restartPlaybackBind):this._player.removeEventListener("playbackCompleted",this.restartPlaybackBind)}},{key:"restartPlayback",value:function restartPlayback(){this._player.seek(0)}},{key:"hide",value:function hide(){this._player.setVideoMute(!0)}},{key:"show",value:function show(){this._player.setVideoMute(!1)}},{key:"destroy",value:function destroy(){var o=this;return new Promise((function(s,m){try{o._player.detach(),o._player.stop(),s()}catch(o){m(o)}}))}},{key:"isFormatSupported",value:function isFormatSupported(o){var s=this.supportedFormats;for(var m in s)if(o.includes(s[m]))return!0;return!1}},{key:"onPlayerEvent",set:function set(o){try{this.registerEventListeners(o)}catch(o){this.logger.warn("Player encountered an error when registering listeners ".concat(o))}}},{key:"width",get:function get(){return this._width}},{key:"height",get:function get(){return this._height}},{key:"bitrateRange",get:function get(){return this._bitrateRange}},{key:"duration",get:function get(){return this._player.getDurationSec()}},{key:"currentTime",get:function get(){return this._player.getCurrentPosition()}},{key:"isPlaying",get:function get(){return this._player.getCurrentState()===AV}},{key:"bitrate",get:function get(){return this._player.getCurrentVideoBitrate()}},{key:"ccEnabled",get:function get(){return this._ccEnabled},set:function set(o){this._ccEnabled=o,this.toggleCC(o)}},{key:"ccAvailable",get:function get(){return void 0!==this._player.getAvailableTextTracks()}},{key:"initClosedCaptions",value:function initClosedCaptions(o){XREReceiver.onEvent("onDecoderAvailable",{decoderhandle:o.decoderHandle})}},{key:"toggleCC",value:function toggleCC(o){this._player.setClosedCaptionStatus(o),this._player.setTextTrack(0),XREReceiver.onEvent("onClosedCaptions",{enable:o}),XREReceiver.onEvent("onClosedCaptions",{setTrack:0})}},{key:"webVTTHandler",value:function webVTTHandler(o){var s=o.text.replace(/\n/g,"  \n  ");this.vttCueBuffer.push(new LV(o.start,o.duration,"  ".concat(s.toUpperCase(),"  ")))}},{key:"mediaProgressUpdate",value:function mediaProgressUpdate(o){var s=o.positionMiliseconds;void 0===this.displayTimer&&void 0===this.subtitleTimer&&0!==this.vttCueBuffer.length&&this.isPlaying&&(this.vttCueBuffer=this.vttCueBuffer.filter((function(o){return o.start>s})),0!==this.vttCueBuffer.length&&this.displayCC(this.vttCueBuffer[0],s))}},{key:"displayCC",value:function displayCC(o,s){var m=this,_=o.start-s;_<=0?(this.vttCueBuffer.shift(),this._renderCC(o.text),this.subtitleTimer=setTimeout((function(){m.vttCueBuffer.length>0?m.displayCC(m.vttCueBuffer[0],s+o.duration):(m.displayTimer=void 0,m.subtitleTimer=void 0)}),o.duration)):this.displayTimer=setTimeout((function(){m.displayCC(o,s+_)}),_)}},{key:"renderCC",set:function set(o){this._renderCC=o}},{key:"clearSubtitles",value:function clearSubtitles(){clearTimeout(this.displayTimer),clearTimeout(this.subtitleTimer),this.displayTimer=void 0,this.subtitleTimer=void 0}}],[{key:"isPlayerSupported",get:function get(){return!!window.hasOwnProperty("AAMPMediaPlayer")}}]),AAMPPlayer}(),LV=_createClass$1((function VTTCue(o,s,m){var _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",E=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;_classCallCheck$1(this,VTTCue),this.start=o,this.duration=s,this.text=m,this.line=_,this.align=S,this.size=A,this.position=E})),DV={};!function(o){!function(){var s="undefined"!=typeof window?window:Or,m={};for(var _ in function(o,s,m){
/*
   @license
   Shaka Player
   Copyright 2016 Google LLC
   SPDX-License-Identifier: Apache-2.0
  */
var _;function ba(o){var s=0;return function(){return s<o.length?{done:!1,value:o[s++]}:{done:!0}}}var S="function"==typeof Object.defineProperties?Object.defineProperty:function(o,s,m){return o==Array.prototype||o==Object.prototype||(o[s]=m.value),o};var E=function ea(m){m=["object"==typeof globalThis&&globalThis,m,"object"==typeof o&&o,"object"==typeof self&&self,"object"==typeof s&&s];for(var _=0;_<m.length;++_){var S=m[_];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}(this);function ha(o,s){if(s)e:{var m=E;o=o.split(".");for(var _=0;_<o.length-1;_++){var A=o[_];if(!(A in m))break e;m=m[A]}(s=s(_=m[o=o[o.length-1]]))!=_&&null!=s&&S(m,o,{configurable:!0,writable:!0,value:s})}}function ia(o){return(o={next:o})[Symbol.iterator]=function(){return this},o}function t(o){var s="undefined"!=typeof Symbol&&Symbol.iterator&&o[Symbol.iterator];return s?s.call(o):{next:ba(o)}}function v(o){if(!(o instanceof Array)){o=t(o);for(var s,m=[];!(s=o.next()).done;)m.push(s.value);o=m}return o}ha("Symbol",(function(o){function c(o,s){this.g=o,S(this,"description",{configurable:!0,writable:!0,value:s})}if(o)return o;c.prototype.toString=function(){return this.g};var s="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",m=0;return function b(o){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(s+(o||"")+"_"+m++,o)}})),ha("Symbol.iterator",(function(o){if(o)return o;o=Symbol("Symbol.iterator");for(var s="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),m=0;m<s.length;m++){var _=E[s[m]];"function"==typeof _&&"function"!=typeof _.prototype[o]&&S(_.prototype,o,{configurable:!0,writable:!0,value:function value(){return ia(ba(this))}})}return o}));var A,O="function"==typeof Object.create?Object.create:function(o){function b(){}return b.prototype=o,new b};if("function"==typeof Object.setPrototypeOf)A=Object.setPrototypeOf;else{var H;e:{var K={};try{K.__proto__={a:!0},H=K.a;break e}catch(o){}H=!1}A=H?function(o,s){if(o.__proto__=s,o.__proto__!==s)throw new TypeError(o+" is not extensible");return o}:null}var z=A;function ra(o,s){if(o.prototype=O(s.prototype),o.prototype.constructor=o,z)z(o,s);else for(var m in s)if("prototype"!=m)if(Object.defineProperties){var _=Object.getOwnPropertyDescriptor(s,m);_&&Object.defineProperty(o,m,_)}else o[m]=s[m];o.hi=s.prototype}function sa(){this.o=!1,this.l=null,this.h=void 0,this.g=1,this.j=this.m=0,this.u=this.i=null}function ua(o){if(o.o)throw new TypeError("Generator is already running");o.o=!0}function va(o,s){o.i={gf:s,rf:!0},o.g=o.m||o.j}function C(o,s,m){return o.g=m,{value:s}}function D(o){o.g=0}function wa(o,s,m){o.m=s,null!=m&&(o.j=m)}function ya(o){o.m=0,o.j=2}function Aa(o,s,m){o.g=s,o.m=m||0}function Ba(o,s){return o.m=s||0,s=o.i.gf,o.i=null,s}function Ca(o){o.u=[o.i],o.m=0,o.j=0}function Ea(o,s){var m=o.u.splice(0)[0];(m=o.i=o.i||m)?m.rf?o.g=o.m||o.j:null!=m.B&&o.j<m.B?(o.g=m.B,o.i=null):o.g=o.j:o.g=s}function Fa(o){this.g=new sa,this.h=o}function Ha(o,s,m,_){try{var S=s.call(o.g.l,m);if(!(S instanceof Object))throw new TypeError("Iterator result "+S+" is not an object");if(!S.done)return o.g.o=!1,S;var E=S.value}catch(s){return o.g.l=null,va(o.g,s),Ia(o)}return o.g.l=null,_.call(o.g,E),Ia(o)}function Ia(o){for(;o.g.g;)try{var s=o.h(o.g);if(s)return o.g.o=!1,{value:s.value,done:!1}}catch(s){o.g.h=void 0,va(o.g,s)}if(o.g.o=!1,o.g.i){if(s=o.g.i,o.g.i=null,s.rf)throw s.gf;return{value:s.return,done:!0}}return{value:void 0,done:!0}}function Ja(o){this.next=function(s){return ua(o.g),o.g.l?s=Ha(o,o.g.l.next,s,o.g.s):(o.g.s(s),s=Ia(o)),s},this.throw=function(s){return ua(o.g),o.g.l?s=Ha(o,o.g.l.throw,s,o.g.s):(va(o.g,s),s=Ia(o)),s},this.return=function(s){return function Ga(o,s){ua(o.g);var m=o.g.l;return m?Ha(o,"return"in m?m.return:function(o){return{value:o,done:!0}},s,o.g.return):(o.g.return(s),Ia(o))}(o,s)},this[Symbol.iterator]=function(){return this}}function I(o){return function Ka(o){function b(s){return o.next(s)}function c(s){return o.throw(s)}return new Promise((function(s,m){!function f(o){o.done?s(o.value):Promise.resolve(o.value).then(b,c).then(f,m)}(o.next())}))}(new Ja(new Fa(o)))}function La(){for(var o=Number(this),s=[],m=o;m<arguments.length;m++)s[m-o]=arguments[m];return s}function Ma(o,s){return Object.prototype.hasOwnProperty.call(o,s)}function Na(o,s,m){o instanceof String&&(o=String(o));for(var _=o.length,S=0;S<_;S++){var E=o[S];if(s.call(m,E,S,o))return{pf:S,v:E}}return{pf:-1,v:void 0}}function Oa(o,s,m){if(null==o)throw new TypeError("The 'this' value for String.prototype."+m+" must not be null or undefined");if(s instanceof RegExp)throw new TypeError("First argument to String.prototype."+m+" must not be a regular expression");return o+""}function Pa(o,s){o instanceof String&&(o+="");var m=0,_=!1,S={next:function next(){if(!_&&m<o.length){var S=m++;return{value:s(S,o[S]),done:!1}}return _=!0,{done:!0,value:void 0}}};return S[Symbol.iterator]=function(){return S},S}sa.prototype.s=function(o){this.h=o},sa.prototype.return=function(o){this.i={return:o},this.g=this.j},sa.prototype.B=function(o){this.g=o},ha("Promise",(function(o){function b(o){this.h=0,this.i=void 0,this.g=[],this.o=!1;var s=this.j();try{o(s.resolve,s.reject)}catch(o){s.reject(o)}}function c(){this.g=null}function d(o){return o instanceof b?o:new b((function(s){s(o)}))}if(o)return o;c.prototype.h=function(o){if(null==this.g){this.g=[];var s=this;this.i((function(){s.l()}))}this.g.push(o)};var s=E.setTimeout;c.prototype.i=function(o){s(o,0)},c.prototype.l=function(){for(;this.g&&this.g.length;){var o=this.g;this.g=[];for(var s=0;s<o.length;++s){var m=o[s];o[s]=null;try{m()}catch(o){this.j(o)}}}this.g=null},c.prototype.j=function(o){this.i((function(){throw o}))},b.prototype.j=function(){function g(m){return function(_){s||(s=!0,m.call(o,_))}}var o=this,s=!1;return{resolve:g(this.F),reject:g(this.l)}},b.prototype.F=function(o){if(o===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(o instanceof b)this.H(o);else{e:switch(typeof o){case"object":var s=null!=o;break e;case"function":s=!0;break e;default:s=!1}s?this.C(o):this.m(o)}},b.prototype.C=function(o){var s=void 0;try{s=o.then}catch(o){return void this.l(o)}"function"==typeof s?this.I(s,o):this.m(o)},b.prototype.l=function(o){this.s(2,o)},b.prototype.m=function(o){this.s(1,o)},b.prototype.s=function(o,s){if(0!=this.h)throw Error("Cannot settle("+o+", "+s+"): Promise already settled in state"+this.h);this.h=o,this.i=s,2===this.h&&this.G(),this.u()},b.prototype.G=function(){var o=this;s((function(){if(o.A()){var s=E.console;void 0!==s&&s.error(o.i)}}),1)},b.prototype.A=function(){if(this.o)return!1;var o=E.CustomEvent,s=E.Event,m=E.dispatchEvent;return void 0===m||("function"==typeof o?o=new o("unhandledrejection",{cancelable:!0}):"function"==typeof s?o=new s("unhandledrejection",{cancelable:!0}):(o=E.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,o),o.promise=this,o.reason=this.i,m(o))},b.prototype.u=function(){if(null!=this.g){for(var o=0;o<this.g.length;++o)m.h(this.g[o]);this.g=null}};var m=new c;return b.prototype.H=function(o){var s=this.j();o.jd(s.resolve,s.reject)},b.prototype.I=function(o,s){var m=this.j();try{o.call(s,m.resolve,m.reject)}catch(o){m.reject(o)}},b.prototype.then=function(o,s){function k(o,s){return"function"==typeof o?function(s){try{m(o(s))}catch(o){_(o)}}:s}var m,_,S=new b((function(o,s){m=o,_=s}));return this.jd(k(o,m),k(s,_)),S},b.prototype.catch=function(o){return this.then(void 0,o)},b.prototype.jd=function(o,s){function k(){switch(_.h){case 1:o(_.i);break;case 2:s(_.i);break;default:throw Error("Unexpected state: "+_.h)}}var _=this;null==this.g?m.h(k):this.g.push(k),this.o=!0},b.resolve=d,b.reject=function(o){return new b((function(s,m){m(o)}))},b.race=function(o){return new b((function(s,m){for(var _=t(o),S=_.next();!S.done;S=_.next())d(S.value).jd(s,m)}))},b.all=function(o){var s=t(o),m=s.next();return m.done?d([]):new b((function(o,_){function n(s){return function(m){S[s]=m,0==--E&&o(S)}}var S=[],E=0;do{S.push(void 0),E++,d(m.value).jd(n(S.length-1),_),m=s.next()}while(!m.done)}))},b})),ha("WeakMap",(function(o){function b(o){if(this.g=(m+=Math.random()+1).toString(),o){o=t(o);for(var s;!(s=o.next()).done;)s=s.value,this.set(s[0],s[1])}}function c(){}function d(o){var s=typeof o;return"object"===s&&null!==o||"function"===s}function e(o){if(!Ma(o,s)){var m=new c;S(o,s,{value:m})}}function f(o){var s=Object[o];s&&(Object[o]=function(o){return o instanceof c?o:(Object.isExtensible(o)&&e(o),s(o))})}if(function(){if(!o||!Object.seal)return!1;try{var s=Object.seal({}),m=Object.seal({}),_=new o([[s,2],[m,3]]);return 2==_.get(s)&&3==_.get(m)&&(_.delete(s),_.set(m,4),!_.has(s)&&4==_.get(m))}catch(o){return!1}}())return o;var s="$jscomp_hidden_"+Math.random();f("freeze"),f("preventExtensions"),f("seal");var m=0;return b.prototype.set=function(o,m){if(!d(o))throw Error("Invalid WeakMap key");if(e(o),!Ma(o,s))throw Error("WeakMap key fail: "+o);return o[s][this.g]=m,this},b.prototype.get=function(o){return d(o)&&Ma(o,s)?o[s][this.g]:void 0},b.prototype.has=function(o){return d(o)&&Ma(o,s)&&Ma(o[s],this.g)},b.prototype.delete=function(o){return!!(d(o)&&Ma(o,s)&&Ma(o[s],this.g))&&delete o[s][this.g]},b})),ha("Map",(function(o){function b(){var o={};return o.jb=o.next=o.head=o}function c(o,s){var m=o.g;return ia((function(){if(m){for(;m.head!=o.g;)m=m.jb;for(;m.next!=m.head;)return m=m.next,{done:!1,value:s(m)};m=null}return{done:!0,value:void 0}}))}function d(o,_){var S=_&&typeof _;"object"==S||"function"==S?s.has(_)?S=s.get(_):(S=""+ ++m,s.set(_,S)):S="p_"+_;var E=o.h[S];if(E&&Ma(o.h,S))for(o=0;o<E.length;o++){var A=E[o];if(_!=_&&A.key!=A.key||_===A.key)return{id:S,list:E,index:o,entry:A}}return{id:S,list:E,index:-1,entry:void 0}}function e(o){if(this.h={},this.g=b(),this.size=0,o){o=t(o);for(var s;!(s=o.next()).done;)s=s.value,this.set(s[0],s[1])}}if(function(){if(!o||"function"!=typeof o||!o.prototype.entries||"function"!=typeof Object.seal)return!1;try{var s=Object.seal({x:4}),m=new o(t([[s,"s"]]));if("s"!=m.get(s)||1!=m.size||m.get({x:4})||m.set({x:4},"t")!=m||2!=m.size)return!1;var _=m.entries(),S=_.next();return!S.done&&S.value[0]==s&&"s"==S.value[1]&&!((S=_.next()).done||4!=S.value[0].x||"t"!=S.value[1]||!_.next().done)}catch(o){return!1}}())return o;var s=new WeakMap;e.prototype.set=function(o,s){var m=d(this,o=0===o?0:o);return m.list||(m.list=this.h[m.id]=[]),m.entry?m.entry.value=s:(m.entry={next:this.g,jb:this.g.jb,head:this.g,key:o,value:s},m.list.push(m.entry),this.g.jb.next=m.entry,this.g.jb=m.entry,this.size++),this},e.prototype.delete=function(o){return!(!(o=d(this,o)).entry||!o.list)&&(o.list.splice(o.index,1),o.list.length||delete this.h[o.id],o.entry.jb.next=o.entry.next,o.entry.next.jb=o.entry.jb,o.entry.head=null,this.size--,!0)},e.prototype.clear=function(){this.h={},this.g=this.g.jb=b(),this.size=0},e.prototype.has=function(o){return!!d(this,o).entry},e.prototype.get=function(o){return(o=d(this,o).entry)&&o.value},e.prototype.entries=function(){return c(this,(function(o){return[o.key,o.value]}))},e.prototype.keys=function(){return c(this,(function(o){return o.key}))},e.prototype.values=function(){return c(this,(function(o){return o.value}))},e.prototype.forEach=function(o,s){for(var m,_=this.entries();!(m=_.next()).done;)m=m.value,o.call(s,m[1],m[0],this)},e.prototype[Symbol.iterator]=e.prototype.entries;var m=0;return e})),ha("Set",(function(o){function b(o){if(this.g=new Map,o){o=t(o);for(var s;!(s=o.next()).done;)this.add(s.value)}this.size=this.g.size}return function(){if(!o||"function"!=typeof o||!o.prototype.entries||"function"!=typeof Object.seal)return!1;try{var s=Object.seal({x:4}),m=new o(t([s]));if(!m.has(s)||1!=m.size||m.add(s)!=m||1!=m.size||m.add({x:4})!=m||2!=m.size)return!1;var _=m.entries(),S=_.next();return!S.done&&S.value[0]==s&&S.value[1]==s&&(!(S=_.next()).done&&S.value[0]!=s&&4==S.value[0].x&&S.value[1]==S.value[0]&&_.next().done)}catch(o){return!1}}()?o:(b.prototype.add=function(o){return o=0===o?0:o,this.g.set(o,o),this.size=this.g.size,this},b.prototype.delete=function(o){return o=this.g.delete(o),this.size=this.g.size,o},b.prototype.clear=function(){this.g.clear(),this.size=0},b.prototype.has=function(o){return this.g.has(o)},b.prototype.entries=function(){return this.g.entries()},b.prototype.values=function(){return this.g.values()},b.prototype.keys=b.prototype.values,b.prototype[Symbol.iterator]=b.prototype.values,b.prototype.forEach=function(o,s){var m=this;this.g.forEach((function(_){return o.call(s,_,_,m)}))},b)})),ha("Array.prototype.findIndex",(function(o){return o||function(o,s){return Na(this,o,s).pf}})),ha("Object.is",(function(o){return o||function(o,s){return o===s?0!==o||1/o==1/s:o!=o&&s!=s}})),ha("Array.prototype.includes",(function(o){return o||function(o,s){var m=this;m instanceof String&&(m=String(m));var _=m.length;for(0>(s=s||0)&&(s=Math.max(s+_,0));s<_;s++){var S=m[s];if(S===o||Object.is(S,o))return!0}return!1}})),ha("String.prototype.includes",(function(o){return o||function(o,s){return-1!==Oa(this,o,"includes").indexOf(o,s||0)}})),ha("Array.prototype.find",(function(o){return o||function(o,s){return Na(this,o,s).v}})),ha("String.prototype.startsWith",(function(o){return o||function(o,s){var m=Oa(this,o,"startsWith"),_=m.length,S=o.length;s=Math.max(0,Math.min(0|s,m.length));for(var E=0;E<S&&s<_;)if(m[s++]!=o[E++])return!1;return E>=S}})),ha("Array.prototype.keys",(function(o){return o||function(){return Pa(this,(function(o){return o}))}}));var G="function"==typeof Object.assign?Object.assign:function(o,s){for(var m=1;m<arguments.length;m++){var _=arguments[m];if(_)for(var S in _)Ma(_,S)&&(o[S]=_[S])}return o};ha("Object.assign",(function(o){return o||G})),ha("Array.from",(function(o){return o||function(o,s,m){s=null!=s?s:function(o){return o};var _=[],S="undefined"!=typeof Symbol&&Symbol.iterator&&o[Symbol.iterator];if("function"==typeof S){o=S.call(o);for(var E=0;!(S=o.next()).done;)_.push(s.call(m,S.value,E++))}else for(S=o.length,E=0;E<S;E++)_.push(s.call(m,o[E],E));return _}})),ha("Array.prototype.values",(function(o){return o||function(){return Pa(this,(function(o,s){return s}))}})),ha("Promise.prototype.finally",(function(o){return o||function(o){return this.then((function(s){return Promise.resolve(o()).then((function(){return s}))}),(function(s){return Promise.resolve(o()).then((function(){throw s}))}))}})),ha("Array.prototype.entries",(function(o){return o||function(){return Pa(this,(function(o,s){return[o,s]}))}})),ha("String.prototype.repeat",(function(o){return o||function(o){var s=Oa(this,null,"repeat");if(0>o||1342177279<o)throw new RangeError("Invalid count value");o|=0;for(var m="";o;)1&o&&(m+=s),(o>>>=1)&&(s+=s);return m}})),ha("Number.isNaN",(function(o){return o||function(o){return"number"==typeof o&&isNaN(o)}})),ha("Number.isFinite",(function(o){return o||function(o){return"number"==typeof o&&(!isNaN(o)&&1/0!==o&&-1/0!==o)}})),ha("Object.values",(function(o){return o||function(o){var s,m=[];for(s in o)Ma(o,s)&&m.push(o[s]);return m}})),ha("Math.log2",(function(o){return o||function(o){return Math.log(o)/Math.LN2}})),ha("Number.MAX_SAFE_INTEGER",(function(){return 9007199254740991})),ha("Math.trunc",(function(o){return o||function(o){if(o=Number(o),isNaN(o)||1/0===o||-1/0===o||0===o)return o;var s=Math.floor(Math.abs(o));return 0>o?-s:s}})),ha("Object.entries",(function(o){return o||function(o){var s,m=[];for(s in o)Ma(o,s)&&m.push([s,o[s]]);return m}}));var q=this||self;function L(o,s){o=o.split(".");var m,_=q;o[0]in _||void 0===_.execScript||_.execScript("var "+o[0]);for(;o.length&&(m=o.shift());)o.length||void 0===s?_=_[m]&&_[m]!==Object.prototype[m]?_[m]:_[m]={}:_[m]=s}function Ta(o){this.g=Math.exp(Math.log(.5)/o),this.i=this.h=0}function Ua(o){return o.h/(1-Math.pow(o.g,o.i))}function Wa(){this.h=new Ta(2),this.j=new Ta(5),this.g=0,this.i=128e3,this.l=16e3}function Xa(){}function Ya(){}function $a(){}function ab(o){var s=La.apply(1,arguments);X.has(o)||(X.add(o),$a.apply(Xa,v(s)))}function cb(){}Ta.prototype.sample=function(o,s){var m=Math.pow(this.g,o);s=s*(1-m)+m*this.h,isNaN(s)||(this.h=s,this.i+=o)},Wa.prototype.configure=function(o){this.i=o.minTotalBytes,this.l=o.minBytes,this.h.g=Math.exp(Math.log(.5)/o.fastHalfLife),this.j.g=Math.exp(Math.log(.5)/o.slowHalfLife)},Wa.prototype.sample=function(o,s){if(!(s<this.l)){var m=8e3*s/o;o/=1e3,this.g+=s,this.h.sample(o,m),this.j.sample(o,m)}},Wa.prototype.getBandwidthEstimate=function(o){return this.g<this.i?o:Math.min(Ua(this.h),Ua(this.j))};var X=new Set;function gb(o){if(J.has(o))return J.get(o);var s=MediaSource.isTypeSupported(o);return J.set(o,s),s}o.console&&($a=function $a(){return console.warn.apply(console,v(La.apply(0,arguments)))},Ya=function Ya(){console.error.apply(console,v(La.apply(0,arguments)))});var J=new Map;function ib(){}function jb(){}function kb(){}function lb(o,s){if(!o&&!s)return!0;if(!o||!s||o.byteLength!=s.byteLength)return!1;if(mb(o)==mb(s)&&(o.byteOffset||0)==(s.byteOffset||0))return!0;var m=M(o);s=M(s);for(var _=0;_<o.byteLength;_++)if(m[_]!=s[_])return!1;return!0}function mb(o){return o instanceof ArrayBuffer?o:o.buffer}function nb(o){return o instanceof ArrayBuffer?o:0==o.byteOffset&&o.byteLength==o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer}function M(o,s,m){return ob(o,void 0===s?0:s,m=void 0===m?1/0:m,Uint8Array)}function pb(o,s,m){return ob(o,void 0===s?0:s,m=void 0===m?1/0:m,DataView)}function ob(o,s,m,_){var S=(o.byteOffset||0)+o.byteLength;return s=Math.max(0,Math.min((o.byteOffset||0)+s,S)),new _(mb(o),s,Math.min(s+Math.max(m,0),S)-s)}function qb(){}function rb(o){this.h=new jb,(o=ae[o.toLowerCase()])&&(this.h=o()),this.g=new ib,(o=pe)&&(this.g=o())}ib.prototype.extract=function(){},ib.prototype.decode=function(){return[]},ib.prototype.clear=function(){},jb.prototype.init=function(){},jb.prototype.parse=function(){return[]},L("shaka.util.BufferUtils",kb),kb.toDataView=pb,kb.toUint8=M,kb.toArrayBuffer=nb,kb.equal=lb,qb.prototype.init=function(){},qb.prototype.j=function(){},qb.prototype.i=function(){},L("shaka.media.IClosedCaptionParser",qb),rb.prototype.init=function(o){this.h.init(o)},rb.prototype.j=function(o){for(var s=(o=t(o=this.h.parse(o))).next();!s.done;s=o.next()){var m=M((s=s.value).packet);0<m.length&&this.g.extract(m,s.pts)}return this.g.decode()},rb.prototype.i=function(){this.g.clear()},L("shaka.media.ClosedCaptionParser",rb),rb.findDecoder=function(){return pe},rb.unregisterDecoder=function(){pe=null},rb.registerDecoder=function(o){pe=o},rb.findParser=function(o){return ae[o]},rb.unregisterParser=function(o){delete ae[o]},rb.registerParser=function(o,s){ae[o]=s};var ae={},pe=null;function ub(o,s){return!("number"!=typeof o||"number"!=typeof s||!isNaN(o)||!isNaN(s))||o===s}function vb(o,s){-1<(s=o.indexOf(s))&&o.splice(s,1)}function wb(o,s,m){if(m||(m=ub),o.length!=s.length)return!1;s=s.slice();for(var _={},S=(o=t(o)).next();!S.done;_={Rd:_.Rd},S=o.next()){if(_.Rd=S.value,S=s.findIndex(function(o){return function(s){return m(o.Rd,s)}}(_)),-1==S)return!1;s[S]=s[s.length-1],s.pop()}return 0==s.length}function xb(o,s,m){if(m||(m=ub),o.length!=s.length)return!1;for(var _=0;_<o.length;_++)if(!m(o[_],s[_]))return!1;return!0}function yb(o,s,m){this.startTime=o,this.endTime=s,this.U=m,this.region=new zb,this.position=null,this.G=me,this.size=0,this.textAlign=_e,this.direction=$e,this.writingMode=He,this.H=et,this.m=null,this.aa="",this.s=rt,this.i=Ee,this.A=this.V=this.N=this.backgroundColor=this.j="",this.u=st,this.o=ut,this.Z=this.W=this.l="",this.C=1,this.h=[],this.ga=this.L=this.I="",this.M=!0,this.id="",this.g=[],this.F=this.Y=!1,this.X={bg:32,rows:15}}function Jb(o,s){if(o.startTime!=s.startTime||o.endTime!=s.endTime||o.U!=s.U)return!1;for(var m in o)if("startTime"!=m&&"endTime"!=m&&"payload"!=m)if("nestedCues"==m){if(!xb(o.g,s.g,Jb))return!1}else if("region"==m||"cellResolution"==m){for(var _ in o[m])if(o[m][_]!=s[m][_])return!1}else if(Array.isArray(o[m])){if(!xb(o[m],s[m]))return!1}else if(o[m]!=s[m])return!1;return!0}yb.prototype.clone=function(){var o,s=new yb(0,0,"");for(o in this)s[o]=this[o],s[o]&&s[o].constructor==Array&&(s[o]=s[o].slice());return s},L("shaka.text.Cue",yb),yb.equal=Jb,yb.prototype.clone=yb.prototype.clone;var me="auto";yb.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:me};var _e="center",Se={LEFT:"left",RIGHT:"right",CENTER:_e,START:"start",END:"end"};yb.textAlign=Se;var Ee="after",De={BEFORE:"before",CENTER:"center",AFTER:Ee};yb.displayAlign=De;var $e="ltr";yb.direction={HORIZONTAL_LEFT_TO_RIGHT:$e,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var He="horizontal-tb";yb.writingMode={HORIZONTAL_TOP_TO_BOTTOM:He,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var et=0;yb.lineInterpretation={LINE_NUMBER:et,PERCENTAGE:1};var rt="start",it={CENTER:"center",START:rt,END:"end"};yb.lineAlign=it;var at={white:"white",lime:"lime",cyan:"cyan",red:"red",yellow:"yellow",magenta:"magenta",blue:"blue",black:"black"};yb.defaultTextColor=at;var ot={bg_white:"white",bg_lime:"lime",bg_cyan:"cyan",bg_red:"red",bg_yellow:"yellow",bg_magenta:"magenta",bg_blue:"blue",bg_black:"black"};yb.defaultTextBackgroundColor=ot;var st=400;yb.fontWeight={NORMAL:st,BOLD:700};var ut="normal",ct={NORMAL:ut,ITALIC:"italic",OBLIQUE:"oblique"};function zb(){this.id="",this.o=this.m=this.h=this.g=0,this.height=this.width=100,this.j=this.l=this.i=dt,this.s=ht}yb.fontStyle=ct,yb.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},L("shaka.text.CueRegion",zb);var dt=1;zb.units={PX:0,PERCENTAGE:dt,LINES:2};var ht="";function Sb(){}function Tb(o,s,m){pt[o.toLowerCase().split(";")[0]+"-"+m]={priority:m,Kd:s}}function Vb(o,s){for(var m=o.toLowerCase().split(";")[0],_=t([kt,bt,_t,gt]),S=_.next();!S.done;S=_.next())if(S=pt[m+"-"+S.value]){var E=S.Kd(),A=E.isSupported(o,s);if(E.destroy(),A)return S.Kd}return null}zb.scrollMode={NONE:ht,UP:"up"},Sb.prototype.destroy=function(){},L("shaka.transmuxer.TransmuxerEngine",Sb),Sb.findTransmuxer=Vb,Sb.unregisterTransmuxer=function(o,s){delete pt[o.toLowerCase().split(";")[0]+"-"+s]},Sb.registerTransmuxer=Tb,Sb.prototype.destroy=Sb.prototype.destroy;var pt={},gt=1,_t=2,bt=3,kt=4;Sb.PluginPriority={FALLBACK:gt,PREFERRED_SECONDARY:_t,PREFERRED:bt,APPLICATION:kt};
/*
   @license
   Copyright 2008 The Closure Library Authors
   SPDX-License-Identifier: Apache-2.0
  */
var It=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");
/*
   @license
   Copyright 2006 The Closure Library Authors
   SPDX-License-Identifier: Apache-2.0
  */function bc(o){var s;o instanceof bc?(cc(this,o.Ma),this.Lb=o.Lb,this.Sa=o.Sa,dc(this,o.cc),this.ta=o.ta,ec(this,o.g.clone()),this.xb=o.xb):o&&(s=String(o).match(It))?(cc(this,s[1]||"",!0),this.Lb=fc(s[2]||""),this.Sa=fc(s[3]||"",!0),dc(this,s[4]),this.ta=fc(s[5]||"",!0),ec(this,s[6]||"",!0),this.xb=fc(s[7]||"")):this.g=new gc(null)}function cc(o,s,m){o.Ma=m?fc(s,!0):s,o.Ma&&(o.Ma=o.Ma.replace(/:$/,""))}function dc(o,s){if(s){if(s=Number(s),isNaN(s)||0>s)throw Error("Bad port number "+s);o.cc=s}else o.cc=null}function ec(o,s,m){s instanceof gc?o.g=s:(m||(s=hc(s,Mt)),o.g=new gc(s))}function fc(o,s){return o?s?decodeURI(o):decodeURIComponent(o):""}function hc(o,s,m){return null!=o?(o=encodeURI(o).replace(s,oc),m&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function oc(o){return"%"+((o=o.charCodeAt(0))>>4&15).toString(16)+(15&o).toString(16)}(_=bc.prototype).Ma="",_.Lb="",_.Sa="",_.cc=null,_.ta="",_.xb="",_.toString=function(){var o=[],s=this.Ma;if(s&&o.push(hc(s,At,!0),":"),s=this.Sa){o.push("//");var m=this.Lb;m&&o.push(hc(m,At,!0),"@"),o.push(encodeURIComponent(s).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(s=this.cc)&&o.push(":",String(s))}return(s=this.ta)&&(this.Sa&&"/"!=s.charAt(0)&&o.push("/"),o.push(hc(s,"/"==s.charAt(0)?Rt:Lt,!0))),(s=this.g.toString())&&o.push("?",s),(s=this.xb)&&o.push("#",hc(s,zt)),o.join("")},_.resolve=function(o){var s=this.clone();"data"===s.Ma&&(s=new bc);var m=!!o.Ma;m?cc(s,o.Ma):m=!!o.Lb,m?s.Lb=o.Lb:m=!!o.Sa,m?s.Sa=o.Sa:m=null!=o.cc;var _=o.ta;if(m)dc(s,o.cc);else if(m=!!o.ta){if("/"!=_.charAt(0))if(this.Sa&&!this.ta)_="/"+_;else{var S=s.ta.lastIndexOf("/");-1!=S&&(_=s.ta.substr(0,S+1)+_)}if(".."==_||"."==_)_="";else if(-1!=_.indexOf("./")||-1!=_.indexOf("/.")){S=0==_.lastIndexOf("/",0),_=_.split("/");for(var E=[],A=0;A<_.length;){var O=_[A++];"."==O?S&&A==_.length&&E.push(""):".."==O?((1<E.length||1==E.length&&""!=E[0])&&E.pop(),S&&A==_.length&&E.push("")):(E.push(O),S=!0)}_=E.join("/")}}return m?s.ta=_:m=""!==o.g.toString(),m?ec(s,o.g.clone()):m=!!o.xb,m&&(s.xb=o.xb),s},_.clone=function(){return new bc(this)};var At=/[#\/\?@]/g,Lt=/[#\?:]/g,Rt=/[#\?]/g,Mt=/[#\?@]/g,zt=/#/g;function gc(o){this.g=o||null}function pc(o){if(!o.pa&&(o.pa={},o.Dc=0,o.g))for(var s=o.g.split("&"),m=0;m<s.length;m++){var _=s[m].indexOf("="),S=null;if(0<=_){var E=s[m].substring(0,_);S=s[m].substring(_+1)}else E=s[m];E=decodeURIComponent(E.replace(/\+/g," ")),S=S||"",o.add(E,decodeURIComponent(S.replace(/\+/g," ")))}}function N(o,s,m){var _=La.apply(3,arguments);this.severity=o,this.category=s,this.code=m,this.data=_,this.handled=!1;try{throw Error(this.message||"Shaka Error")}catch(o){this.stack=o.stack}}function rc(o,s){return o.concat(s)}function sc(){}function tc(o){return null!=o}function uc(o,s){if(0==s.length)return o;var m=s.map((function(o){return new bc(o)}));return o.map((function(o){return new bc(o)})).map((function(o){return m.map((function(s){return o.resolve(s)}))})).reduce(rc,[]).map((function(o){return o.toString()}))}function vc(o,s){return{keySystem:o,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:s||[],keyIds:new Set}}function wc(o,s){if(1==s.length)return s[0];if(null!=(o=xc(o,s)))return o;throw new N(2,4,4025,s)}function xc(o,s){for(var m=t(tn[o]),_=m.next();!_.done;_=m.next()){_=_.value;for(var S=t(s),E=S.next();!E.done;E=S.next())if(E=E.value,_.test(E.trim()))return E.trim()}return o==qt?"":null}(_=gc.prototype).pa=null,_.Dc=null,_.add=function(o,s){pc(this),this.g=null;var m=this.pa.hasOwnProperty(o)?this.pa[o]:null;return m||(this.pa[o]=m=[]),m.push(s),this.Dc++,this},_.set=function(o,s){return pc(this),this.g=null,this.pa.hasOwnProperty(o)?this.pa[o]=[s]:this.add(o,s),this},_.toString=function(){if(this.g)return this.g;if(!this.pa)return"";var o,s=[];for(o in this.pa)for(var m=encodeURIComponent(o),_=this.pa[o],S=0;S<_.length;S++){var E=m;""!==_[S]&&(E+="="+encodeURIComponent(_[S])),s.push(E)}return this.g=s.join("&")},_.clone=function(){var o=new gc;if(o.g=this.g,this.pa){var s,m={};for(s in this.pa)m[s]=this.pa[s].concat();o.pa=m,o.Dc=this.Dc}return o},N.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},L("shaka.util.Error",N),N.Severity={RECOVERABLE:1,CRITICAL:2},N.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9,ADS:10},N.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,ATTEMPTS_EXHAUSTED:1010,SEGMENT_MISSING:1011,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,INVALID_MP4_CEA:2010,TEXT_COULD_NOT_GUESS_MIME_TYPE:2011,CANNOT_ADD_EXTERNAL_TEXT_TO_SRC_EQUALS:2012,TEXT_ONLY_WEBVTT_SRC_EQUALS:2013,MISSING_TEXT_PLUGIN:2014,CHAPTERS_TRACK_FAILED:2015,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_SRC_EQUALS:2016,UNSUPPORTED_EXTERNAL_THUMBNAILS_URI:2017,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,CONTENT_TRANSFORMATION_FAILED:3019,MSS_MISSING_DATA_FOR_TRANSMUXING:3020,MSS_TRANSMUXING_CODEC_UNKNOWN:3021,MSS_TRANSMUXING_FAILED:3022,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,RESTRICTIONS_CANNOT_BE_MET:4012,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,NO_VARIANTS:4036,PERIOD_FLATTENING_FAILED:4037,INCONSISTENT_DRM_ACROSS_PERIODS:4038,HLS_VARIABLE_NOT_FOUND:4039,HLS_MSE_ENCRYPTED_MP2T_NOT_SUPPORTED:4040,HLS_MSE_ENCRYPTED_LEGACY_APPLE_MEDIA_KEYS_NOT_SUPPORTED:4041,NO_WEB_CRYPTO_API:4042,HLS_AES_128_INVALID_IV_LENGTH:4043,HLS_AES_128_INVALID_KEY_LENGTH:4044,CANNOT_ADD_EXTERNAL_THUMBNAILS_TO_LIVE_STREAM:4045,MSS_INVALID_XML:4046,MSS_LIVE_CONTENT_NOT_SUPPORTED:4047,STREAMING_ENGINE_STARTUP_INVALID_STATE:5006,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,SERVER_CERTIFICATE_REQUEST_FAILED:6017,MIN_HDCP_VERSION_NOT_MATCH:6018,ERROR_CHECKING_HDCP_VERSION:6019,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,OBJECT_DESTROYED:7003,CONTENT_NOT_LOADED:7004,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013,STORAGE_LIMIT_REACHED:9014,DOWNLOAD_SIZE_CALLBACK_ERROR:9015,MODIFY_OPERATION_NOT_SUPPORTED:9016,INDEXED_DB_INIT_TIMED_OUT:9017,CS_IMA_SDK_MISSING:1e4,CS_AD_MANAGER_NOT_INITIALIZED:10001,SS_IMA_SDK_MISSING:10002,SS_AD_MANAGER_NOT_INITIALIZED:10003,CURRENT_DAI_REQUEST_NOT_FINISHED:10004};var qt="text",Jt={va:"video",qb:"audio",da:qt,wc:"image",rh:"application"},tn={audio:[/^vorbis$/,/^Opus$/,/^opus$/,/^fLaC$/,/^flac$/,/^mp4a/,/^[ae]c-3$/,/^ac-4$/,/^dts[cex]$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av01/,/^dvh/],text:[/^vtt$/,/^wvtt/,/^stpp/]};function Bc(){}function Cc(o,s){var m=o;return s&&!nn.includes(o)&&(m+='; codecs="'+s+'"'),m}function Fc(o,s){return s&&(o+='; codecs="'+s+'"'),o}function Gc(o,s,m){var _=Cc(o,s);return Vb(s=Fc(o,s))?(o=Vb(s))?(m=(o=o()).convertCodecs(m,s),o.destroy()):m=s:m="video/mp2t"!=o&&"audio"==m?_.replace("video","audio"):_,m}function Hc(o){var s=Ic(o);switch(o=s[0],s=s[1].toLowerCase(),!0){case"mp4a"===o&&"69"===s:case"mp4a"===o&&"6b"===s:case"mp4a"===o&&"40.34"===s:return"mp3";case"mp4a"===o&&"66"===s:case"mp4a"===o&&"67"===s:case"mp4a"===o&&"68"===s:case"mp4a"===o&&"40.2"===s:case"mp4a"===o&&"40.02"===s:case"mp4a"===o&&"40.5"===s:case"mp4a"===o&&"40.05"===s:case"mp4a"===o&&"40.29"===s:case"mp4a"===o&&"40.42"===s:return"aac";case"mp4a"===o&&"a5"===s:return"ac-3";case"mp4a"===o&&"a6"===s:return"ec-3";case"mp4a"===o&&"b2"===s:return"dtsx";case"mp4a"===o&&"a9"===s:return"dtsc";case"avc1"===o:case"avc3"===o:return"avc";case"hvc1"===o:case"hev1"===o:return"hevc";case"dvh1"===o:case"dvhe"===o:return"dovi"}return o}function Jc(o){return(o=o.split(/ *; */)).shift(),(o=o.find((function(o){return o.startsWith("codecs=")})))?o.split("=")[1].replace(/^"|"$/g,""):""}function Ic(o){var s=(o=o.split("."))[0];return o.shift(),[s,o.join(".")]}L("shaka.util.MimeUtils",Bc),Bc.getFullTypeWithAllCodecs=Fc,Bc.getFullType=Cc,(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");var nn=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"];function Kc(o){this.i=null,this.j=o,this.u=!1,this.l=this.s=0,this.m=1/0,this.h=this.g=null,this.A="",this.o=new Map}function Lc(o){return!!rn[o]||("application/cea-608"==o||"application/cea-708"==o)&&!!pe}function Pc(o,s,m){if(o.A=s,s=o.o.get(s))for(var _=t(s.keys()),S=_.next();!S.done;S=_.next())(S=s.get(S.value).filter((function(o){return o.endTime<=m})))&&o.j.append(S)}function Qc(o,s,m){s.startTime+=m,s.endTime+=m;for(var _=(s=t(s.g)).next();!_.done;_=s.next())Qc(o,_.value,m)}Kc.prototype.destroy=function(){return this.j=this.i=null,this.o.clear(),Promise.resolve()},Kc.prototype.remove=function(o,s){var m=this;return I((function(_){if(1==_.g)return C(_,Promise.resolve(),2);!m.j||!m.j.remove(o,s)||null==m.g||s<=m.g||o>=m.h||(o<=m.g&&s>=m.h?m.g=m.h=null:o<=m.g&&s<m.h?m.g=s:o>m.g&&s>=m.h&&(m.h=o)),D(_)}))},L("shaka.text.TextEngine",Kc),Kc.prototype.destroy=Kc.prototype.destroy,Kc.findParser=function(o){return rn[o]},Kc.unregisterParser=function(o){delete rn[o]},Kc.registerParser=function(o,s){rn[o]=s};var rn={};function Sc(){}function Tc(o,s){return o=Uc(o),s=Uc(s),o.split("-")[0]==s.split("-")[0]}function Vc(o,s){return o=Uc(o),s=Uc(s),o=o.split("-"),s=s.split("-"),o[0]==s[0]&&1==o.length&&2==s.length}function Wc(o,s){return o=Uc(o),s=Uc(s),o=o.split("-"),s=s.split("-"),2==o.length&&2==s.length&&o[0]==s[0]}function Uc(o){var s=o.split("-x-"),m=s[0].split("-");return o=m[0]||"",m=m[1]||"",s=s[1]?"x-"+s[1]:"",o=o.toLowerCase(),o=sn.get(o)||o,((m=m.toUpperCase())?o+"-"+m:o)+(s?"-"+s:"")}function Yc(o,s){return o=Uc(o),(s=Uc(s))==o?4:Vc(s,o)?3:Wc(s,o)?2:Vc(o,s)?1:0}function Zc(o){var s=o.indexOf("-");return o=(o=0<=s?o.substring(0,s):o).toLowerCase(),sn.get(o)||o}function $c(o){return o.language?Uc(o.language):o.audio&&o.audio.language?Uc(o.audio.language):o.video&&o.video.language?Uc(o.video.language):"und"}function ad(o,s){o=Uc(o);var m=new Set,_=t(s);for(s=_.next();!s.done;s=_.next())m.add(Uc(s.value));for(s=(_=t(m)).next();!s.done;s=_.next())if((s=s.value)==o)return s;for(s=(_=t(m)).next();!s.done;s=_.next())if(Vc(s=s.value,o))return s;for(s=(_=t(m)).next();!s.done;s=_.next())if(Wc(s=s.value,o))return s;for(s=(m=t(m)).next();!s.done;s=m.next())if(Vc(o,s=s.value))return s;return null}L("shaka.util.LanguageUtils",Sc),Sc.findClosestLocale=ad,Sc.getLocaleForVariant=$c,Sc.getLocaleForText=function(o){return Uc(o.language||"und")},Sc.getBase=Zc,Sc.relatedness=Yc,Sc.areSiblings=function(o,s){var m=Zc(o),_=Zc(s);return o!=m&&s!=_&&m==_},Sc.normalize=Uc,Sc.isSiblingOf=Wc,Sc.isParentOf=Vc,Sc.areLanguageCompatible=Tc,Sc.areLocaleCompatible=function(o,s){return(o=Uc(o))==(s=Uc(s))};var sn=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function bd(){this.g={}}function cd(o){this.h=o,this.g=null}function dd(o){this.h=o,this.g=null}function ed(){return!(!o.MediaSource||!MediaSource.isTypeSupported)}function fd(o){return""!=gd().canPlayType(o)}function hd(){return!!navigator.userAgent.match(/Edge?\//)}function id(){return jd("Xbox One")}function kd(){return jd("Tizen")}function ld(){return jd("Web0S")&&jd("Chrome/38.0.2125.122 Safari/537.36")}function md(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!kd()&&!jd("PC=EOS")&&!jd("VirginMedia")&&!jd("SOPOpenBrowser")&&!nd()&&!jd("AFT")}function nd(){return jd("PlayStation 4")}function od(){if(!md())return null;var o=navigator.userAgent.match(/Version\/(\d+)/);return o||(o=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(o[1],10):null}function jd(o){return(navigator.userAgent||"").includes(o)}function gd(){return pn||(un||(un=new dd((function(){pn=null}))),(pn=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(pn=document.createElement("video")),un.S(1),pn)}(_=bd.prototype).push=function(o,s){this.g.hasOwnProperty(o)?this.g[o].push(s):this.g[o]=[s]},_.get=function(o){return(o=this.g[o])?o.slice():null},_.remove=function(o,s){o in this.g&&(this.g[o]=this.g[o].filter((function(o){return o!=s})),0==this.g[o].length&&delete this.g[o])},_.forEach=function(o){for(var s in this.g)o(s,this.g[s])},_.size=function(){return Object.keys(this.g).length},_.keys=function(){return Object.keys(this.g)},cd.prototype.S=function(s){var m=this;this.stop();var _=!0,S=null;return this.g=function(){o.clearTimeout(S),_=!1},S=o.setTimeout((function(){_&&m.h()}),1e3*s),this},cd.prototype.stop=function(){this.g&&(this.g(),this.g=null)},dd.prototype.ic=function(){return this.stop(),this.h(),this},dd.prototype.S=function(o){var s=this;return this.stop(),this.g=new cd((function(){s.h()})).S(o),this},dd.prototype.Ca=function(o){var s=this;return this.stop(),this.g=new cd((function(){s.g.S(o),s.h()})).S(o),this},dd.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},L("shaka.util.Timer",dd),dd.prototype.stop=dd.prototype.stop,dd.prototype.tickEvery=dd.prototype.Ca,dd.prototype.tickAfter=dd.prototype.S,dd.prototype.tickNow=dd.prototype.ic;var un=null,pn=null;function rd(){}function sd(o,s,m,_,S){var E=o.variants;(s.length||m.length)&&(E=function td(o,s,m){for(var _={},S=(s=t(s)).next();!S.done;_={Wd:_.Wd},S=s.next())if(_.Wd=S.value,S=o.filter(function(o){return function(s){return s.video&&s.video.codecs.startsWith(o.Wd)}}(_)),S.length){o=S;break}for(_={},m=t(m),s=m.next();!s.done;_={Qd:_.Qd},s=m.next())if(_.Qd=s.value,s=o.filter(function(o){return function(s){return s.audio&&s.audio.codecs.startsWith(o.Qd)}}(_)),s.length){o=s;break}return o}(E,s,m)),s=function vd(o){for(var s=new bd,m=(o=t(o)).next();!m.done;m=o.next()){var _=yd(m=m.value);s.push(_,m)}return s}(E=ud(E,_)),s=function wd(o){var s=0,m=new Map,_=o.size();return o.forEach((function(o,S){for(var E=(S=t(S)).next();!E.done;E=S.next()){var A=(E=E.value).video;if(A&&A.width&&A.height){A=A.width*A.height*(A.frameRate||1),m.has(A)||m.set(A,new bd);var O=m.get(A);O.push(o,E),O.size()===_&&(s=Math.max(s,A))}}})),s?m.get(s):o}(s);var A=function xd(o,s){for(var m=(s=t(s)).next();!m.done;m=s.next())if((m=m.value)==Cn||m==wn){if(1==(o=Bd(o,m)).size())return o.keys()[0]}else if(m==xn)break;return function Dd(o){var s="",m=1/0;return o.forEach((function(o,_){for(var S=0,E=0,A=(_=t(_)).next();!A.done;A=_.next())S+=A.value.bandwidth||0,++E;(S/=E)<m&&(s=o,m=S)})),s}(o)}(s,S);o.variants=o.variants.filter((function(o){return yd(o)==A}))}function Bd(o,s){var m=0,_=new bd;return o.forEach((function(o,S){for(var E=0,A=0,O=t(S),H=O.next();!H.done;H=O.next())(H=H.value).decodingInfos.length&&(E+=H.decodingInfos[0][s]?1:0,A++);(E/=A)>m?(_.g={},_.push(o,S),m=E):E==m&&_.push(o,S)})),_}function yd(o){var s="";o.video&&(s=Hc(o.video.codecs));var m="";return o.audio&&(m=Hc(o.audio.codecs)),s+"-"+m}function Fd(o,s,m){function d(o,s,m){return o>=s&&o<=m}var _=o.video;return!(_&&_.width&&_.height&&(!d(_.width,s.minWidth,Math.min(s.maxWidth,m.width))||!d(_.height,s.minHeight,Math.min(s.maxHeight,m.height))||!d(_.width*_.height,s.minPixels,s.maxPixels))||o&&o.video&&o.video.frameRate&&!d(o.video.frameRate,s.minFrameRate,s.maxFrameRate)||!d(o.bandwidth,s.minBandwidth,s.maxBandwidth))}function Gd(o,s){return I((function(m){return 1==m.g?C(m,Hd(s,0<s.offlineSessionIds.length),2):(Id(o,s),function Jd(o){o.textStreams=o.textStreams.filter((function(o){return Lc(o=Cc(o.mimeType,o.codecs))}))}(s),C(m,function Kd(o){var s,m,_,S,E,A,O;return I((function(H){switch(H.g){case 1:s=[],m=t(o.imageStreams),_=m.next();case 2:if(_.done){H.B(4);break}if(S=_.value,E=S.mimeType,In.has(E)){H.B(5);break}if(!(A=An.get(E))){In.set(E,!1),H.B(5);break}return C(H,function Wd(o){return new Promise((function(s){var m=new Image;m.src=o,"decode"in m?m.decode().then((function(){s(!0)})).catch((function(){s(!1)})):m.onload=m.onerror=function(){s(2===m.height)}}))}(A),7);case 7:O=H.h,In.set(E,O);case 5:In.get(E)&&s.push(S),_=m.next(),H.B(2);break;case 4:o.imageStreams=s,D(H)}}))}(s),0))}))}function Hd(o,s){return I((function(m){if(1==m.g)return C(m,Ld(o.variants,s,!1,[]),2);o.variants=o.variants.filter((function(o){var s=o.video;if(s){var m=Md(s.codecs);if(s.codecs.includes(",")){var _=s.codecs.split(",");m=Md(m=wc("video",_)),_=Nd(_=wc("audio",_));var S=Gc(s.mimeType,_,"audio");if(!gb(S))return!1;m=[m,_].join()}if(!gb(_=Gc(s.mimeType,m,"video")))return!1;s.codecs=m}if(m=o.audio){if(_=Nd(m.codecs),!gb(S=Gc(m.mimeType,_,"audio")))return!1;m.codecs=_}return id()&&s&&(s.width&&1920<s.width||s.height&&1080<s.height)&&(s.codecs.includes("avc1.")||s.codecs.includes("avc3."))?(Od(o),!1):((s=o.decodingInfos.some((function(o){return o.supported})))||Od(o),s)})),D(m)}))}function Pd(o){var s=[];for(m in o)s.push(m);s.sort();for(var m=[],_=(s=t(s)).next();!_.done;_=s.next()){var S=_.value;_=JSON.stringify(S),(S=o[S])instanceof Object?(S=Pd(S),m.push(_+":"+S)):(S=JSON.stringify(S),m.push(_+":"+S))}return"{"+m.join(",")+"}"}function Qd(o,s){var m,_,S;return I((function(E){switch(E.g){case 1:if(m=Pd(s),wa(E,2),(_=vn)[m]){o.decodingInfos.push(_[m]),E.B(4);break}return C(E,navigator.mediaCapabilities.decodingInfo(s),5);case 5:S=E.h,_[m]=S,o.decodingInfos.push(S);case 4:Aa(E,0);break;case 2:Ba(E),JSON.stringify(s),D(E)}}))}function Ld(o,s,m,_){var S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se;return I((function(Ee){switch(Ee.g){case 1:if(o.some((function(o){return o.decodingInfos.length})))return Ee.return();S={},E=t(_),A=E.next();case 2:if(A.done){Ee.B(4);break}S.Sd=A.value,O=!1,H=t(o),K=H.next();case 5:if(K.done){Ee.B(7);break}z=K.value,G=Sd(z,s,m).filter(function(o){return function(s){return(s.keySystemConfiguration&&s.keySystemConfiguration.keySystem)===o.Sd}}(S)),q=t(G),X=q.next();case 8:if(X.done){Ee.B(10);break}return J=X.value,C(Ee,Qd(z,J),9);case 9:X=q.next(),Ee.B(8);break;case 10:z.decodingInfos.length&&(O=!0),K=H.next(),Ee.B(5);break;case 7:if(O)return Ee.return();S={Sd:S.Sd},A=E.next(),Ee.B(2);break;case 4:ae=t(o),K=ae.next();case 12:if(K.done){Ee.B(0);break}pe=K.value,me=Sd(pe,s,m).filter((function(o){return!(o=o.keySystemConfiguration&&o.keySystemConfiguration.keySystem)||!_.includes(o)})),_e=t(me),X=_e.next();case 15:if(X.done){K=ae.next(),Ee.B(12);break}return Se=X.value,C(Ee,Qd(pe,Se),16);case 16:X=_e.next(),Ee.B(15)}}))}function Sd(o,s,m){var _=o.audio,S=o.video;if(m={type:m?"file":"media-source"},S){var E=S.codecs;if(S.codecs.includes(",")){var A=S.codecs.split(",");E=Md(E=wc("video",A)),A=Nd(A=wc("audio",A)),A=Gc(S.mimeType,A,"audio"),m.audio={contentType:A,channels:2,bitrate:o.bandwidth||1,samplerate:1,spatialRendering:!1}}if(E=Md(E),E=Gc(S.mimeType,E,"video"),m.video={contentType:E,width:S.width||64,height:S.height||64,bitrate:S.bandwidth||o.bandwidth||1,framerate:S.frameRate||1},S.hdr)switch(S.hdr){case"SDR":m.video.transferFunction="srgb";break;case"PQ":m.video.transferFunction="pq";break;case"HLG":m.video.transferFunction="hlg"}}if(_&&(E=Nd(_.codecs),E=Gc(_.mimeType,E,"audio"),m.audio={contentType:E,channels:_.channelsCount||2,bitrate:_.bandwidth||o.bandwidth||1,samplerate:_.audioSamplingRate||1,spatialRendering:_.spatialAudio}),!(A=(o.video?o.video.drmInfos:[]).concat(o.audio?o.audio.drmInfos:[])).length)return[m];o=[],E=new Map;for(var O=(A=t(A)).next();!O.done;O=A.next()){var H=O.value;E.get(H.keySystem)||E.set(H.keySystem,[]),E.get(H.keySystem).push(H)}A=s?"required":"optional",s=s?["persistent-license"]:["temporary"];for(var K=(H=t(E.keys())).next();!K.done;K=H.next()){var z=K.value;K=Object.assign({},m);var G=E.get(z);for(z={keySystem:z,initDataType:"cenc",persistentState:A,distinctiveIdentifier:"optional",sessionTypes:s},O=(G=t(G)).next();!O.done;O=G.next()){if((O=O.value).initData&&O.initData.length){for(var q=new Set,X=t(O.initData),J=X.next();!J.done;J=X.next())q.add(J.value.initDataType);z.initDataType=O.initData[0].initDataType}O.distinctiveIdentifierRequired&&(z.distinctiveIdentifier="required"),O.persistentStateRequired&&(z.persistentState="required"),O.sessionType&&(z.sessionTypes=[O.sessionType]),_&&(""!=O.audioRobustness?z.audio?z.audio.robustness=z.audio.robustness||O.audioRobustness:z.audio={robustness:O.audioRobustness}:z.audio||(z.audio={})),S&&(""!=O.videoRobustness?z.video?z.video.robustness=z.video.robustness||O.videoRobustness:z.video={robustness:O.videoRobustness}:z.video||(z.video={}))}K.keySystemConfiguration=z,o.push(K)}return o}function Nd(o){return"fLaC"===o?"flac":"Opus"===o?"opus":kd()&&"ac-3"==o.toLowerCase()?"ec-3":o}function Md(o){if(o.includes("avc1")){var s=o.split(".");if(3==s.length)return o=s.shift()+".",(o+=parseInt(s.shift(),10).toString(16))+("000"+parseInt(s.shift(),10).toString(16)).slice(-4)}else if("vp9"==o)return"vp09.00.41.08";return o}function Id(o,s){s.variants=s.variants.filter((function(s){var m=s.audio;return s=s.video,!(m&&o&&o.audio&&!Td(m,o.audio)||s&&o&&o.video&&!Td(s,o.video))}))}function Td(o,s){return o.mimeType==s.mimeType&&o.codecs.split(".")[0]==s.codecs.split(".")[0]}function Xd(o){var s=o.audio,m=o.video,_=s?s.mimeType:null,S=m?m.mimeType:null,E=s?s.codecs:null,A=m?m.codecs:null,O=[];A&&O.push(A),E&&O.push(E);var H=[];m&&H.push(m.mimeType),s&&H.push(s.mimeType),H=H[0]||null;var K=[];s&&K.push(s.kind),m&&K.push(m.kind),K=K[0]||null;var z=new Set;if(s)for(var G=t(s.roles),q=G.next();!q.done;q=G.next())z.add(q.value);if(m)for(q=(G=t(m.roles)).next();!q.done;q=G.next())z.add(q.value);return o={id:o.id,active:!1,type:"variant",bandwidth:o.bandwidth,language:o.language,label:null,kind:K,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:H,audioMimeType:_,videoMimeType:S,codecs:O.join(", "),audioCodec:E,videoCodec:A,primary:o.primary,roles:Array.from(z),audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:null},m&&(o.videoId=m.id,o.originalVideoId=m.originalId,o.width=m.width||null,o.height=m.height||null,o.frameRate=m.frameRate||null,o.pixelAspectRatio=m.pixelAspectRatio||null,o.videoBandwidth=m.bandwidth||null,o.hdr=m.hdr||null),s&&(o.audioId=s.id,o.originalAudioId=s.originalId,o.channelsCount=s.channelsCount,o.audioSamplingRate=s.audioSamplingRate,o.audioBandwidth=s.bandwidth||null,o.spatialAudio=s.spatialAudio,o.label=s.label,o.audioRoles=s.roles,o.accessibilityPurpose=s.accessibilityPurpose,o.originalLanguage=s.originalLanguage),o}function Yd(o){return{id:o.id,active:!1,type:qt,bandwidth:0,language:o.language,label:o.label,kind:o.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:o.mimeType,audioMimeType:null,videoMimeType:null,codecs:o.codecs||null,audioCodec:null,videoCodec:null,primary:o.primary,roles:o.roles,audioRoles:null,forced:o.forced,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:o.originalId,originalImageId:null,accessibilityPurpose:o.accessibilityPurpose,originalLanguage:o.originalLanguage}}function Zd(o){var s=o.width||null,m=o.height||null,_=null;o.segmentIndex&&(_=o.segmentIndex.get(0));var S=o.tilesLayout;return _&&(S=_.tilesLayout||S),S&&null!=s&&(s/=Number(S.split("x")[0])),S&&null!=m&&(m/=Number(S.split("x")[1])),{id:o.id,active:!1,type:"image",bandwidth:o.bandwidth||0,language:"",label:null,kind:null,width:s,height:m,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:o.mimeType,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,forced:!1,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:S||null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:o.originalId,accessibilityPurpose:null,originalLanguage:null}}function $d(o){return o.__shaka_id||(o.__shaka_id=_n++),o.__shaka_id}function be(o){var s=ce(o);return s.active="disabled"!=o.mode,s.type="text",s.originalTextId=o.id,"captions"==o.kind&&(s.mimeType="application/cea-608"),"subtitles"==o.kind&&(s.mimeType="text/vtt"),o.kind&&(s.roles=[o.kind]),"forced"==o.kind&&(s.forced=!0),s}function de(o){var s=ce(o);return s.active=o.enabled,s.type="variant",s.originalAudioId=o.id,"main"==o.kind&&(s.primary=!0),o.kind&&(s.roles=[o.kind],s.audioRoles=[o.kind],s.label=o.label),s}function ce(o){var s=o.language;return{id:$d(o),active:!1,type:"",bandwidth:0,language:Uc(s||"und"),label:o.label,kind:o.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,hdr:null,mimeType:null,audioMimeType:null,videoMimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],forced:!1,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,tilesLayout:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null,originalImageId:null,accessibilityPurpose:null,originalLanguage:s}}function ee(o){return o.allowedByApplication&&o.allowedByKeySystem&&0==o.disabledUntilTime}function fe(o){return o.filter((function(o){return ee(o)}))}function ud(o,s){for(var m=o.filter((function(o){return o.audio&&o.audio.channelsCount})),_=new Map,S=(m=t(m)).next();!S.done;S=m.next()){var E=(S=S.value).audio.channelsCount;_.has(E)||_.set(E,[]),_.get(E).push(S)}return 0==(m=Array.from(_.keys())).length?o:(o=m.filter((function(o){return o<=s})),o.length?_.get(Math.max.apply(Math,v(o))):_.get(Math.min.apply(Math,v(m))))}function ge(o,s,m,_){var S=o,E=o.filter((function(o){return o.primary}));E.length&&(S=E);var A=S.length?S[0].language:"";if(S=S.filter((function(o){return o.language==A})),s){var O=ad(Uc(s),o.map((function(o){return o.language})));O&&(S=o.filter((function(o){return Uc(o.language)==O})))}if(S=S.filter((function(o){return o.forced==_})),m){if((o=he(S,m)).length)return o}else if(o=S.filter((function(o){return 0==o.roles.length})),o.length)return o;return o=S.map((function(o){return o.roles})).reduce(rc,[]),o.length?he(S,o[0]):S}function he(o,s){return o.filter((function(o){return o.roles.includes(s)}))}function Od(o){var s=[];return o.audio&&s.push(ie(o.audio)),o.video&&s.push(ie(o.video)),s.join(", ")}function ie(o){return"audio"==o.type?"type=audio codecs="+o.codecs+" bandwidth="+o.bandwidth+" channelsCount="+o.channelsCount+" audioSamplingRate="+o.audioSamplingRate:"video"==o.type?"type=video codecs="+o.codecs+" bandwidth="+o.bandwidth+" frameRate="+o.frameRate+" width="+o.width+" height="+o.height:"unexpected stream type"}L("shaka.util.StreamUtils",rd),rd.meetsRestrictions=Fd;var vn={},_n=0,Cn="smooth",wn="powerEfficient",xn="bandwidth",In=(new Map).set("image/svg+xml",!0).set("image/png",!0).set("image/jpeg",!0).set("image/jpg",!0),An=(new Map).set("image/webp","data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA").set("image/avif","data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=");function je(){var o=this;this.l=null,this.o=!1,this.i=new Wa,this.u=null,navigator.connection&&navigator.connection.addEventListener&&(this.u=function(){if(o.o&&o.g.useNetworkInformation){o.i=new Wa,o.g&&o.i.configure(o.g.advanced);var s=o.chooseVariant();s&&o.l(s,o.g.clearBufferSwitch,o.g.safeMarginSwitch)}},navigator.connection.addEventListener("change",this.u)),this.m=[],this.A=1,this.F=!1,this.h=this.j=this.g=this.s=null,this.C=new dd((function(){if(o.g.restrictToElementSize){var s=o.chooseVariant();s&&o.l(s,o.g.clearBufferSwitch,o.g.safeMarginSwitch)}}))}function le(o){var s=o.g.defaultBandwidthEstimate;return navigator.connection&&navigator.connection.downlink&&o.g.useNetworkInformation&&(s=1e6*navigator.connection.downlink),s}function ke(o,s,m,_){return o&&(s=s.filter((function(s){return Fd(s,o,{width:_,height:m})}))),s.sort((function(o,s){return o.bandwidth-s.bandwidth}))}(_=je.prototype).stop=function(){this.l=null,this.o=!1,this.m=[],this.A=1,this.j=this.s=null,this.h&&(this.h.disconnect(),this.h=null),this.C.stop()},_.release=function(){navigator.connection&&navigator.connection.removeEventListener&&(navigator.connection.removeEventListener("change",this.u),this.u=null),this.C=null},_.init=function(o){this.l=o},_.chooseVariant=function(){var s=1/0,m=1/0;this.g.restrictToScreenSize&&(m=this.g.ignoreDevicePixelRatio?1:o.devicePixelRatio,s=o.screen.height*m,m*=o.screen.width),this.h&&this.g.restrictToElementSize&&(m=this.g.ignoreDevicePixelRatio?1:o.devicePixelRatio,s=this.j.clientHeight*m,m*=this.j.clientWidth),s=ke(this.g.restrictions,this.m,s,m),m=this.i.getBandwidthEstimate(le(this)),this.m.length&&!s.length&&(s=[(s=ke(null,this.m,1/0,1/0))[0]]);for(var _=s[0]||null,S=0;S<s.length;S++){for(var E=s[S],A=isNaN(this.A)?1:Math.abs(this.A),O=A*E.bandwidth/this.g.bandwidthDowngradeTarget,H={bandwidth:1/0},K=S+1;K<s.length;K++)if(E.bandwidth!=s[K].bandwidth){H=s[K];break}A=A*H.bandwidth/this.g.bandwidthUpgradeTarget,m>=O&&m<=A&&_.bandwidth!=E.bandwidth&&(_=E)}return this.s=Date.now(),_},_.enable=function(){this.o=!0},_.disable=function(){this.o=!1},_.segmentDownloaded=function(o,s){if(this.i.sample(o,s),null!=this.s&&this.o)e:{if(this.F){if(Date.now()-this.s<1e3*this.g.switchInterval)break e}else{if(!((o=this.i).g>=o.i))break e;this.F=!0}o=this.chooseVariant(),this.i.getBandwidthEstimate(le(this)),o&&this.l(o,this.g.clearBufferSwitch,this.g.safeMarginSwitch)}},_.getBandwidthEstimate=function(){return this.i.getBandwidthEstimate(le(this))},_.setVariants=function(o){this.m=o},_.playbackRateChanged=function(o){this.A=o},_.setMediaElement=function(s){var m=this;this.j=s,this.h&&(this.h.disconnect(),this.h=null),this.j&&"ResizeObserver"in o&&(this.h=new ResizeObserver((function(){m.C.S(Fn)})),this.h.observe(this.j))},_.configure=function(o){this.g=o,this.i&&this.g&&this.i.configure(this.g.advanced)},L("shaka.abr.SimpleAbrManager",je),je.prototype.configure=je.prototype.configure,je.prototype.setMediaElement=je.prototype.setMediaElement,je.prototype.playbackRateChanged=je.prototype.playbackRateChanged,je.prototype.setVariants=je.prototype.setVariants,je.prototype.getBandwidthEstimate=je.prototype.getBandwidthEstimate,je.prototype.segmentDownloaded=je.prototype.segmentDownloaded,je.prototype.disable=je.prototype.disable,je.prototype.enable=je.prototype.enable,je.prototype.chooseVariant=je.prototype.chooseVariant,je.prototype.init=je.prototype.init,je.prototype.release=je.prototype.release,je.prototype.stop=je.prototype.stop;var Fn=1;function ne(o,s){this.g=o,this.h=s}function oe(o,s){var m=new ne(5,0),_=Gn,S=_.g,E=m.h-S.h;(0<(m.g-S.g||E)?_.i:_.h)(_.g,m,o,s)}function qe(o,s,m,_){$a([m,"has been deprecated and will be removed in",s,". We are currently at version",o,". Additional information:",_].join(" "))}function re(o,s,m,_){Ya([m,"has been deprecated and has been removed in",s,". We are now at version",o,". Additional information:",_].join(""))}ne.prototype.toString=function(){return"v"+this.g+"."+this.h};var Gn=null;function se(o,s){for(this.h=o,this.g=new Set([o]),s=(o=t(s=s||[])).next();!s.done;s=o.next())this.add(s.value)}function te(o,s){var m;if(!(m=!!o.audio!=!!s.audio||!!o.video!=!!s.video||o.language!=s.language)&&(m=o.audio&&s.audio)){m=o.audio;var _=s.audio;m=!((!(!m.channelsCount||!_.channelsCount||2<m.channelsCount||2<_.channelsCount)||m.channelsCount==_.channelsCount)&&ue(m,_)&&ve(m.roles,_.roles))}return!m&&(m=o.video&&s.video)&&(m=!(ue(o=o.video,s=s.video)&&ve(o.roles,s.roles))),!m}function ue(o,s){if(o.mimeType!=s.mimeType)return!1;if(o=o.codecs.split(",").map((function(o){return Ic(o)[0]})),s=s.codecs.split(",").map((function(o){return Ic(o)[0]})),o.length!=s.length)return!1;o.sort(),s.sort();for(var m=0;m<o.length;m++)if(o[m]!=s[m])return!1;return!0}function ve(o,s){if(o=new Set(o),s=new Set(s),o.delete("main"),s.delete("main"),o.size!=s.size)return!1;for(var m=(o=t(o)).next();!m.done;m=o.next())if(!s.has(m.value))return!1;return!0}function we(o){this.g=o,this.h=new xe(o.language,"",o.audio&&o.audio.channelsCount?o.audio.channelsCount:0,"","")}function xe(o,s,m,_,S){this.j=o,this.l=s,this.g=m,this.h=_,this.i=void 0===S?"":S}function Ce(){this.g=ar,this.h=(new Map).set(ar,2).set(qn,1)}function Fe(o,s,m){o.h.set(ar,m).set(qn,s)}L("shaka.config.AutoShowText",{NEVER:0,ALWAYS:1,IF_PREFERRED_TEXT_LANGUAGE:2,IF_SUBTITLES_MAY_BE_NEEDED:3}),se.prototype.add=function(o){return!!te(this.h,o)&&(this.g.add(o),!0)},se.prototype.values=function(){return this.g.values()},we.prototype.create=function(o){var s=this,m=o.filter((function(o){return te(s.g,o)}));return m.length?new se(m[0],m):this.h.create(o)},xe.prototype.create=function(s){var m=[];m=function ye(o,s){s=Uc(s);var m=ad(s,o.map((function(o){return $c(o)})));return m?o.filter((function(o){return m==$c(o)})):[]}(s,this.j);var _=s.filter((function(o){return o.primary}));for(s=function ze(o,s){return o.filter((function(o){return!!o.audio&&(s?o.audio.roles.includes(s):0==o.audio.roles.length)}))}(m=m.length?m:_.length?_:s,this.l),s.length&&(m=s),this.h&&(s=function Ae(s,m){return"AUTO"==m&&(m=o.matchMedia("(color-gamut: p3)").matches?"PQ":"SDR"),s.filter((function(o){return!o.video||!o.video.hdr||o.video.hdr==m}))}(m,this.h),s.length&&(m=s)),this.g&&((s=ud(m,this.g)).length&&(m=s)),this.i&&(s=function Be(o,s){return o.filter((function(o){return!(!o.audio||!o.audio.label)&&o.audio.label.toLowerCase()==s.toLowerCase()}))}(m,this.i),s.length&&(m=s)),s=new se(m[0]),_=(m=t(m)).next();!_.done;_=m.next())_=_.value,te(s.h,_)&&s.add(_);return s};var qn=0,ar=1;function Ge(o,s){var m={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4};this.l=null==o.maxAttempts?m.maxAttempts:o.maxAttempts,this.j=null==o.baseDelay?m.baseDelay:o.baseDelay,this.o=null==o.fuzzFactor?m.fuzzFactor:o.fuzzFactor,this.m=null==o.backoffFactor?m.backoffFactor:o.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==s&&s)&&(this.g=1)}function Ie(o){var s,m;return I((function(_){if(1==_.g){if(o.g>=o.l){if(!o.i)throw new N(2,7,1010);o.g=1,o.h=o.j}return s=o.g,o.g++,0==s?_.return():(m=o.h*(1+(2*Math.random()-1)*o.o),C(_,new Promise((function(o){new dd(o).S(m/1e3)})),2))}o.h*=o.m,D(_)}))}function Je(){var o,s,m=new Promise((function(m,_){o=m,s=_}));return m.resolve=o,m.reject=s,m}function Ke(o,s){this.promise=o,this.i=s,this.g=!1}function Le(o){return new Ke(Promise.reject(o),(function(){return Promise.resolve()}))}function Me(){var o=Promise.reject(new N(2,7,7001));return o.catch((function(){})),new Ke(o,(function(){return Promise.resolve()}))}function Ne(o){return new Ke(Promise.resolve(o),(function(){return Promise.resolve()}))}function Oe(o){return new Ke(o,(function(){return o.catch((function(){}))}))}function Pe(o){return new Ke(Promise.all(o.map((function(o){return o.promise}))),(function(){return Promise.all(o.map((function(o){return o.abort()})))}))}function P(s,m){if(m)if(m instanceof Map)for(var _=t(m.keys()),S=_.next();!S.done;S=_.next())S=S.value,Object.defineProperty(this,S,{value:m.get(S),writable:!0,enumerable:!0});else for(_ in m)Object.defineProperty(this,_,{value:m[_],writable:!0,enumerable:!0});this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=o.performance&&o.performance.now?o.performance.now():Date.now(),this.type=s,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Re(o){var s,m=new P(o.type);for(s in o)Object.defineProperty(m,s,{value:o[s],writable:!0,enumerable:!0});return m}Je.prototype.resolve=function(){},Je.prototype.reject=function(){},Ke.prototype.abort=function(){return this.g=!0,this.i()},Ke.prototype.finally=function(o){return this.promise.then((function(){return o(!0)}),(function(){return o(!1)})),this},Ke.prototype.fa=function(o,s){function c(E){return function(A){if(m.g&&E)_.reject(S);else{var O=E?o:s;O?d=function Qe(o,s,m){try{var _=o(s);return _&&_.promise&&_.abort?(m.resolve(_.promise),function(){return _.abort()}):(m.resolve(_),function(){return Promise.resolve(_).then((function(){}),(function(){}))})}catch(o){return m.reject(o),function(){return Promise.resolve()}}}(O,A,_):(E?_.resolve:_.reject)(A)}}}function d(){return _.reject(S),m.abort()}var m=this,_=new Je,S=new N(2,7,7001);return this.promise.then(c(!0),c(!1)),new Ke(_,(function(){return d()}))},L("shaka.util.AbortableOperation",Ke),Ke.prototype.chain=Ke.prototype.fa,Ke.prototype.finally=Ke.prototype.finally,Ke.all=Pe,Ke.prototype.abort=Ke.prototype.abort,Ke.notAbortable=Oe,Ke.completed=Ne,Ke.aborted=Me,Ke.failed=Le,P.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},P.prototype.stopImmediatePropagation=function(){this.g=!0},P.prototype.stopPropagation=function(){},L("shaka.util.FakeEvent",P);var vr={th:"abrstatuschanged",uh:"adaptation",vh:"buffering",wh:"downloadfailed",xh:"downloadheadersreceived",yh:"drmsessionupdate",Ah:"emsg",Mh:"prft",Error:"error",Bh:"expirationupdated",Ch:"gapjumped",Fh:"loaded",Gh:"loading",Ih:"manifestparsed",Jh:"mediaqualitychanged",Metadata:"metadata",Kh:"onstatechange",Lh:"onstateidle",Nh:"ratechange",Ph:"segmentappended",Qh:"sessiondata",Rh:"stalldetected",Sh:"streaming",Th:"textchanged",Uh:"texttrackvisibility",Vh:"timelineregionadded",Wh:"timelineregionenter",Xh:"timelineregionexit",Yh:"trackschanged",$h:"unloading",bi:"variantchanged"};function Te(){this.Z=new bd,this.xd=this}function Ue(o){var s=new Set;return function b(o){switch(typeof o){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return o;default:if(!o||o.buffer&&o.buffer.constructor==ArrayBuffer)return o;if(s.has(o))return null;var m=o.constructor==Array;if(o.constructor!=Object&&!m)return null;s.add(o);var _,S=m?[]:{};for(_ in o)S[_]=b(o[_]);return m&&(S.length=o.length),S}}(o)}function Ve(o){var s,m={};for(s in o)m[s]=o[s];return m}function We(){this.g=[]}function Xe(o,s){o.g.push(s.finally((function(){vb(o.g,s)})))}function Ye(o,s,m,_){Te.call(this),this.i=!1,this.m=new We,this.g=new Set,this.h=new Set,this.l=o||null,this.j=s||null,this.s=m||null,this.u=_||null,this.o=!1}function Ze(o,s,m,_){m=m||wr;var S=Pr[o];(!S||m>=S.priority)&&(Pr[o]={priority:m,Kd:s,Wg:void 0!==_&&_})}function bf(o,s,m){return{uris:o,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:s,licenseRequestType:null,sessionId:null,drmInfo:null,initData:null,initDataType:null,streamDataCallback:void 0===m?null:m}}function ff(o,s,m,_,S,E,A){o.o&&(m.uris[S]=m.uris[S].replace("http://","https://"));var O=new bc(m.uris[S]),H=O.Ma,K=!1;H||(cc(O,H=(H=location.protocol).slice(0,-1)),m.uris[S]=O.toString()),H=H.toLowerCase();var z=(H=Pr[H])?H.Kd:null;if(!z)return Le(new N(2,1,1e3,O));var G,q=H.Wg,X=null,J=null,ae=!1,pe=!1;return Oe(Ie(_)).fa((function(){if(o.i)return Me();G=Date.now();var _=z(m.uris[S],m,s,(function(m,_,S){X&&X.stop(),J&&J.S(O/1e3),o.l&&s==_r&&(o.l(m,_),K=!0,A.g=S)}),(function(_){o.j&&o.j(_,m,s),pe=!0}));if(!q)return _;var E=m.retryParameters.connectionTimeout;E&&(X=new dd((function(){ae=!0,_.abort()}))).S(E/1e3);var O=m.retryParameters.stallTimeout;return O&&(J=new dd((function(){ae=!0,_.abort()}))),_})).fa((function(_){X&&X.stop(),J&&J.stop(),null==_.timeMs&&(_.timeMs=Date.now()-G);var S={response:_,Hg:K};return!pe&&o.j&&o.j(_.headers,m,s),S}),(function(O){if(X&&X.stop(),J&&J.stop(),o.s){var H=null,K=0;O instanceof N&&(H=O,1001==O.code&&(K=O.data[1])),o.s(m,H,K,ae)}if(o.i)return Me();if(ae&&(O=new N(1,1,1003,m.uris[S],s)),O instanceof N){if(7001==O.code)throw O;if(1010==O.code)throw E;if(1==O.severity)return H=new P("retry",H=(new Map).set("error",O)),o.dispatchEvent(H),S=(S+1)%m.uris.length,ff(o,s,m,_,S,O,A)}throw O}))}function cf(){this.g=0}function df(o,s,m){Ke.call(this,o,s),this.h=m}Te.prototype.addEventListener=function(o,s){this.Z&&this.Z.push(o,s)},Te.prototype.removeEventListener=function(o,s){this.Z&&this.Z.remove(o,s)},Te.prototype.dispatchEvent=function(o){if(!this.Z)return!0;var s=this.Z.get(o.type)||[],m=this.Z.get("All");for(m&&(s=s.concat(m)),m=(s=t(s)).next();!m.done;m=s.next()){m=m.value,o.target=this.xd,o.currentTarget=this.xd;try{m.handleEvent?m.handleEvent(o):m.call(this,o)}catch(o){}if(o.g)break}return o.defaultPrevented},Te.prototype.release=function(){this.Z=null},We.prototype.destroy=function(){for(var o=[],s=t(this.g),m=s.next();!m.done;m=s.next())(m=m.value).promise.catch((function(){})),o.push(m.abort());return this.g=[],Promise.all(o)},ra(Ye,Te),(_=Ye.prototype).Le=function(o){this.o=o},_.Xg=function(o){this.g.add(o)},_.nh=function(o){this.g.delete(o)},_.Zf=function(){this.g.clear()},_.Yg=function(o){this.h.add(o)},_.oh=function(o){this.h.delete(o)},_.$f=function(){this.h.clear()},_.destroy=function(){return this.i=!0,this.g.clear(),this.h.clear(),Te.prototype.release.call(this),this.m.destroy()},_.request=function(o,s,m){var _=this,S=new cf;if(this.i){var E=Promise.reject(new N(2,7,7001));return E.catch((function(){})),new df(E,(function(){return Promise.resolve()}),S)}s.method=s.method||"GET",s.headers=s.headers||{},s.retryParameters=s.retryParameters?Ue(s.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},s.uris=Ue(s.uris),E=function ef(o,s,m,_){function e(o){S=S.fa((function(){return m.body&&(m.body=nb(m.body)),o(s,m,_)}))}var S=Ne(void 0);o.u&&e(o.u);for(var E=(o=t(o.g)).next();!E.done;E=o.next())e(E.value);return S.fa(void 0,(function(o){if(o instanceof N&&7001==o.code)throw o;throw new N(2,1,1006,o)}))}(this,o,s,m);var A=E.fa((function(){return ff(_,o,s,new Ge(s.retryParameters,!1),0,null,S)})),O=A.fa((function(s){return function gf(o,s,m,_){for(var S=Ne(void 0),E={},A=(o=t(o.h)).next();!A.done;E={Ud:E.Ud},A=o.next())E.Ud=A.value,S=S.fa(function(o){return function(){var S=m.response;return S.data&&(S.data=nb(S.data)),o.Ud(s,S,_)}}(E));return S.fa((function(){return m}),(function(o){var s=2;if(o instanceof N){if(7001==o.code)throw o;s=o.severity}throw new N(s,1,1007,o)}))}(_,o,s,m)})),H=Date.now(),K=0;E.promise.then((function(){K=Date.now()-H}),(function(){}));var z=0;A.promise.then((function(){z=Date.now()}),(function(){}));var G=O.fa((function(m){var S=Date.now()-z,E=m.response;return E.timeMs+=K,E.timeMs+=S,m.Hg||!_.l||E.fromCache||"HEAD"==s.method||o!=_r||_.l(E.timeMs,E.data.byteLength),E}),(function(o){throw o&&(o.severity=2),o}));return E=new df(G.promise,(function(){return G.abort()}),S),Xe(this.m,E),E},L("shaka.net.NetworkingEngine",Ye),Ye.prototype.request=Ye.prototype.request,Ye.prototype.destroy=Ye.prototype.destroy,Ye.makeRequest=bf,Ye.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4}},Ye.prototype.clearAllResponseFilters=Ye.prototype.$f,Ye.prototype.unregisterResponseFilter=Ye.prototype.oh,Ye.prototype.registerResponseFilter=Ye.prototype.Yg,Ye.prototype.clearAllRequestFilters=Ye.prototype.Zf,Ye.prototype.unregisterRequestFilter=Ye.prototype.nh,Ye.prototype.registerRequestFilter=Ye.prototype.Xg,Ye.unregisterScheme=function(o){delete Pr[o]},Ye.registerScheme=Ze,Ye.prototype.setForceHTTPS=Ye.prototype.Le,Ye.NumBytesRemainingClass=cf,ra(df,Ke),Ye.PendingRequest=df;var _r=1;Ye.RequestType={MANIFEST:0,SEGMENT:_r,LICENSE:2,APP:3,TIMING:4,SERVER_CERTIFICATE:5,KEY:6},Ye.AdvancedRequestType={INIT_SEGMENT:0,MEDIA_SEGMENT:1,MEDIA_PLAYLIST:2,MASTER_PLAYLIST:3,MPD:4,MSS:5};var wr=3;Ye.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:wr};var Pr={};function jf(o){this.g=!1,this.h=new Je,this.i=o}function kf(o,s){if(o.g){if(s instanceof N&&7003==s.code)throw s;throw new N(2,7,7003,s)}}function lf(){this.g=new bd}function mf(o,s,m,_){this.target=o,this.type=s,this.listener=m,this.g=function nf(o,s){if(null==s)return!1;if("boolean"==typeof s)return s;var m=new Set(["passive","capture"]);return Object.keys(s).filter((function(o){return!m.has(o)})),function of(o){var s=Or;if(null==s){s=!1;try{var m={},_={get:function get(){return s=!0,!1}};Object.defineProperty(m,"passive",_),Object.defineProperty(m,"capture",_),_=function d(){},o.addEventListener("test",_,m),o.removeEventListener("test",_,m)}catch(o){s=!1}Or=s}return s||!1}(o)?s:s.capture||!1}(o,_),this.target.addEventListener(s,m,this.g)}jf.prototype.destroy=function(){var o=this;return this.g?this.h:(this.g=!0,this.i().then((function(){o.h.resolve()}),(function(){o.h.resolve()})))},(_=lf.prototype).release=function(){this.sb(),this.g=null},_.D=function(o,s,m,_){this.g&&(o=new mf(o,s,m,_),this.g.push(s,o))},_.la=function(o,s,m,_){var S=this;this.D(o,s,(function e(_){S.Yc(o,s,e),m(_)}),_)},_.Yc=function(o,s,m){if(this.g)for(var _=this.g.get(s)||[],S=(_=t(_)).next();!S.done;S=_.next())(S=S.value).target!=o||m!=S.listener&&m||(S.Yc(),this.g.remove(s,S))},_.sb=function(){if(this.g){var o,s=this.g,m=[];for(o in s.g)m.push.apply(m,v(s.g[o]));for(m=(s=t(m)).next();!m.done;m=s.next())m.value.Yc();this.g.g={}}},L("shaka.util.EventManager",lf),lf.prototype.removeAll=lf.prototype.sb,lf.prototype.unlisten=lf.prototype.Yc,lf.prototype.listenOnce=lf.prototype.la,lf.prototype.listen=lf.prototype.D,lf.prototype.release=lf.prototype.release,mf.prototype.Yc=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1};var Or=void 0;function qf(o,s){for(var m=[],_=(o=t(o)).next();!_.done;_=o.next())m.push(s(_.value));return m}function sf(o){this.h=o,this.g=void 0}function tf(o){for(var s=new Map,m=t(Object.keys(o)),_=m.next();!_.done;_=m.next())_=_.value,s.set(_,o[_]);return s}function uf(o){var s={};return o.forEach((function(o,m){s[m]=o})),s}function vf(o,s){if(!o&&!s)return!0;if(o&&!s||s&&!o)return!1;if(o.size!=s.size)return!1;for(var m=(o=t(o)).next();!m.done;m=o.next()){var _=t(m.value);if(m=_.next().value,_=_.next().value,!s.has(m))return!1;if((m=s.get(m))!=_||null==m)return!1}return!0}function wf(){}function xf(s){if(!s)return"";if(239==(s=M(s))[0]&&187==s[1]&&191==s[2]&&(s=s.subarray(3)),o.TextDecoder&&!nd())return(s=(new TextDecoder).decode(s)).includes("�")&&Ya('Decoded string contains an "unknown character" codepoint.  That probably means the UTF8 encoding was incorrect!'),s;for(var m="",_=0;_<s.length;++_){var S=65533;if(0==(128&s[_])?S=s[_]:s.length>=_+2&&192==(224&s[_])&&128==(192&s[_+1])?(S=(31&s[_])<<6|63&s[_+1],_+=1):s.length>=_+3&&224==(240&s[_])&&128==(192&s[_+1])&&128==(192&s[_+2])?(S=(15&s[_])<<12|(63&s[_+1])<<6|63&s[_+2],_+=2):s.length>=_+4&&240==(241&s[_])&&128==(192&s[_+1])&&128==(192&s[_+2])&&128==(192&s[_+3])&&(S=(7&s[_])<<18|(63&s[_+1])<<12|(63&s[_+2])<<6|63&s[_+3],_+=3),65535>=S)m+=String.fromCharCode(S);else{var E=1023&(S-=65536);m+=String.fromCharCode(55296+(S>>10)),m+=String.fromCharCode(56320+E)}}return m}function yf(o,s,m){if(!o)return"";if(!m&&0!=o.byteLength%2)throw new N(2,2,2004);m=Math.floor(o.byteLength/2);var _=new Uint16Array(m);o=pb(o);for(var S=0;S<m;S++)_[S]=o.getUint16(2*S,s);return Vr.value()(_)}function Af(o){function b(o){return s.byteLength<=o||32<=s[o]&&126>=s[o]}if(!o)return"";var s=M(o);if(239==s[0]&&187==s[1]&&191==s[2])return xf(s);if(254==s[0]&&255==s[1])return yf(s.subarray(2),!1);if(255==s[0]&&254==s[1])return yf(s.subarray(2),!0);if(0==s[0]&&0==s[2])return yf(o,!1);if(0==s[1]&&0==s[3])return yf(o,!0);if(b(0)&&b(1)&&b(2)&&b(3))return xf(o);throw new N(2,2,2003)}function Bf(s){if(o.TextEncoder&&!nd()){var m=new TextEncoder;return nb(m.encode(s))}s=encodeURIComponent(s),s=unescape(s),m=new Uint8Array(s.length);for(var _=0;_<s.length;_++)m[_]=s[_].charCodeAt(0);return nb(m)}function Cf(o,s){for(var m=new ArrayBuffer(2*o.length),_=new DataView(m),S=0;S<o.length;++S)_.setUint16(2*S,o.charCodeAt(S),s);return m}sf.prototype.value=function(){return null==this.g&&(this.g=this.h()),this.g},L("shaka.util.StringUtils",wf),wf.resetFromCharCode=function(){Vr.g=void 0},wf.toUTF16=Cf,wf.toUTF8=Bf,wf.fromBytesAutoDetect=Af,wf.fromUTF16=yf,wf.fromUTF8=xf;var Vr=new sf((function(){function a(o){try{var s=new Uint8Array(o);return 0<String.fromCharCode.apply(null,s).length}catch(o){return!1}}for(var o={ob:65536};0<o.ob;(o={ob:o.ob}).ob/=2)if(a(o.ob))return function(o){return function(s){for(var m="",_=0;_<s.length;_+=o.ob)m+=String.fromCharCode.apply(null,s.subarray(_,_+o.ob));return m}}(o);return null}));function Df(o,s){this.h=pb(o),this.i=s==oi,this.g=0}function Ff(){return new N(2,3,3e3)}(_=Df.prototype).ja=function(){return this.g<this.h.byteLength},_.ha=function(){return this.g},_.getLength=function(){return this.h.byteLength},_.qa=function(){try{var o=this.h.getUint8(this.g);return this.g+=1,o}catch(o){throw Ff()}},_.Ia=function(){try{var o=this.h.getUint16(this.g,this.i);return this.g+=2,o}catch(o){throw Ff()}},_.K=function(){try{var o=this.h.getUint32(this.g,this.i);return this.g+=4,o}catch(o){throw Ff()}},_.zf=function(){try{var o=this.h.getInt32(this.g,this.i);return this.g+=4,o}catch(o){throw Ff()}},_.dc=function(){try{if(this.i)var o=this.h.getUint32(this.g,!0),s=this.h.getUint32(this.g+4,!0);else s=this.h.getUint32(this.g,!1),o=this.h.getUint32(this.g+4,!1)}catch(o){throw Ff()}if(2097151<s)throw new N(2,3,3001);return this.g+=8,s*Math.pow(2,32)+o},_.kb=function(o){if(this.g+o>this.h.byteLength)throw Ff();var s=M(this.h,this.g,o);return this.g+=o,s},_.skip=function(o){if(this.g+o>this.h.byteLength)throw Ff();this.g+=o},_.eh=function(o){if(this.g<o)throw Ff();this.g-=o},_.seek=function(o){if(0>o||o>this.h.byteLength)throw Ff();this.g=o},_.Tc=function(){for(var o=this.g;this.ja()&&0!=this.h.getUint8(this.g);)this.g+=1;return o=M(this.h,o,this.g-o),this.g+=1,xf(o)},L("shaka.util.DataViewReader",Df),Df.prototype.readTerminatedString=Df.prototype.Tc,Df.prototype.seek=Df.prototype.seek,Df.prototype.rewind=Df.prototype.eh,Df.prototype.skip=Df.prototype.skip,Df.prototype.readBytes=Df.prototype.kb,Df.prototype.readUint64=Df.prototype.dc,Df.prototype.readInt32=Df.prototype.zf,Df.prototype.readUint32=Df.prototype.K,Df.prototype.readUint16=Df.prototype.Ia,Df.prototype.readUint8=Df.prototype.qa,Df.prototype.getLength=Df.prototype.getLength,Df.prototype.getPosition=Df.prototype.ha,Df.prototype.hasMoreData=Df.prototype.ja;var oi=1;function Gf(){this.i=[],this.h=[],this.g=!1}function Lf(o){for(var s=Mf(o);o.reader.ja()&&!o.parser.g;)o.parser.Rc(o.start+s,o.reader,o.partialOkay)}function Nf(o){for(var s=Mf(o),m=o.reader.K(),_=0;_<m&&(o.parser.Rc(o.start+s,o.reader,o.partialOkay),!o.parser.g);_++);}function Of(o){var s=Mf(o);for(o.reader.skip(78);o.reader.ja()&&!o.parser.g;)o.parser.Rc(o.start+s,o.reader,o.partialOkay)}function Pf(o){return function(s){o(s.reader.kb(s.reader.getLength()-s.reader.ha()))}}function Hf(o){for(var s=0,m=(o=t(o)).next();!m.done;m=o.next())s=s<<8|m.value.charCodeAt(0);return s}function Kf(o){return String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o)}function Mf(o){return 8+(o.has64BitSize?8:0)+(null!=o.flags?4:0)}Df.Endianness={BIG_ENDIAN:0,LITTLE_ENDIAN:oi},(_=Gf.prototype).box=function(o,s){return o=Hf(o),this.i[o]=li,this.h[o]=s,this},_.O=function(o,s){return o=Hf(o),this.i[o]=hi,this.h[o]=s,this},_.stop=function(){this.g=!0},_.parse=function(o,s,m){for(o=new Df(o,0),this.g=!1;o.ja()&&!this.g;)this.Rc(0,o,s,m)},_.Rc=function(o,s,m,_){var S=s.ha();if(_&&S+8>s.getLength())this.g=!0;else{var E=s.K(),A=s.K(),O=Kf(A),H=!1;switch(E){case 0:E=s.getLength()-S;break;case 1:if(_&&s.ha()+8>s.getLength())return void(this.g=!0);E=s.dc(),H=!0}var K=this.h[A];if(K){var z=null,G=null;if(this.i[A]==hi){if(_&&s.ha()+4>s.getLength())return void(this.g=!0);z=(G=s.K())>>>24,G&=16777215}A=S+E,m&&A>s.getLength()&&(A=s.getLength()),_&&A>s.getLength()?this.g=!0:(_=A-s.ha(),K({name:O,parser:this,partialOkay:m||!1,version:z,flags:G,reader:s=new Df(s=0<_?s.kb(_):new Uint8Array(0),0),size:E,start:S+o,has64BitSize:H}))}else s.skip(Math.min(S+E-s.ha(),s.getLength()-s.ha()))}},L("shaka.util.Mp4Parser",Gf),Gf.headerSize=Mf,Gf.typeToString=Kf,Gf.allData=Pf,Gf.visualSampleEntry=Of,Gf.sampleDescription=Nf,Gf.children=Lf,Gf.prototype.parseNext=Gf.prototype.Rc,Gf.prototype.parse=Gf.prototype.parse,Gf.prototype.stop=Gf.prototype.stop,Gf.prototype.fullBox=Gf.prototype.O,Gf.prototype.box=Gf.prototype.box;var li=0,hi=1;function Qf(){}function Rf(o){return o=M(o),o=Vr.value()(o),btoa(o)}function Sf(o,s){return s=null==s||s,o=Rf(o).replace(/\+/g,"-").replace(/\//g,"_"),s?o:o.replace(/[=]*$/,"")}function Tf(s){s=o.atob(s.replace(/-/g,"+").replace(/_/g,"/"));for(var m=new Uint8Array(s.length),_=0;_<s.length;++_)m[_]=s.charCodeAt(_);return m}function Uf(s){for(var m=s.length/2,_=new Uint8Array(m),S=0;S<m;S++)_[S]=o.parseInt(s.substr(2*S,2),16);return _}function Vf(o){var s=M(o);o="";for(var m=(s=t(s)).next();!m.done;m=s.next())1==(m=(m=m.value).toString(16)).length&&(m="0"+m),o+=m;return o}function Wf(){for(var o=La.apply(0,arguments),s=0,m=t(o),_=m.next();!_.done;_=m.next())s+=_.value.byteLength;for(s=new Uint8Array(s),m=0,_=(o=t(o)).next();!_.done;_=o.next())_=_.value,s.set(M(_),m),m+=_.byteLength;return s}function Xf(o){var s=this;this.g=[],this.h=[],this.data=[],(new Gf).box("moov",Lf).box("moof",Lf).O("pssh",(function(o){if(!(1<o.version)){var m=M(o.reader.h,-12,o.size);if(s.data.push(m),s.g.push(Vf(o.reader.kb(16))),0<o.version){m=o.reader.K();for(var _=0;_<m;_++){var S=Vf(o.reader.kb(16));s.h.push(S)}}}})).parse(o)}function Yf(o,s,m,_){var S=o.length,E=s.length+16+S;0<_&&(E+=4+16*m.size);var A=new Uint8Array(E),O=pb(A),H=0;if(O.setUint32(H,E),H+=4,O.setUint32(H,1886614376),H+=4,1>_?O.setUint32(H,0):O.setUint32(H,16777216),H+=4,A.set(s,H),H+=s.length,0<_)for(O.setUint32(H,m.size),H+=4,m=(s=t(m)).next();!m.done;m=s.next())m=Uf(m.value),A.set(m,H),H+=m.length;return O.setUint32(H,S),A.set(o,H+4),A}function Zf(o,s){return 1!=(o=$f(o,s)).length?null:o[0]}function ag(o,s,m){return 1!=(o=bg(o,s,m)).length?null:o[0]}function $f(o,s){for(var m=[],_=(o=t(o.childNodes)).next();!_.done;_=o.next())(_=_.value)instanceof Element&&_.tagName==s&&m.push(_);return m}function bg(o,s,m){for(var _=[],S=(o=t(o.childNodes)).next();!S.done;S=o.next())(S=S.value)instanceof Element&&S.localName==m&&S.namespaceURI==s&&_.push(S);return _}function dg(o,s,m){return o.hasAttributeNS(s,m)?o.getAttributeNS(s,m):null}function eg(o,s,m){for(var _=(s=t(s)).next();!_.done;_=s.next())if(_=_.value,o.hasAttributeNS(_,m))return o.getAttributeNS(_,m);return null}function fg(o){return Array.from(o.childNodes).every(gg)?o.textContent.trim():null}function gg(o){return o.nodeType==Node.TEXT_NODE||o.nodeType==Node.CDATA_SECTION_NODE}function hg(o,s,m,_){_=void 0===_?null:_;var S=null;return null!=(o=o.getAttribute(s))&&(S=m(o)),null==S?_:S}function ig(o){return o?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(o)&&(o+="Z"),o=Date.parse(o),isNaN(o)?null:o/1e3):null}function jg(o){return o&&(o=RegExp("^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$").exec(o))?(o=31536e3*Number(o[1]||null)+2592e3*Number(o[2]||null)+86400*Number(o[3]||null)+3600*Number(o[4]||null)+60*Number(o[5]||null)+Number(o[6]||null),isFinite(o)?o:null):null}function kg(o){var s=/([0-9]+)-([0-9]+)/.exec(o);return s?(o=Number(s[1]),isFinite(o)?(s=Number(s[2]),isFinite(s)?{start:o,end:s}:null):null):null}function lg(o){return 0==(o=Number(o))%1?o:null}function mg(o){return 0==(o=Number(o))%1&&0<o?o:null}function ng(o){return 0==(o=Number(o))%1&&0<=o?o:null}function og(o){return o=Number(o),isNaN(o)?null:o}function pg(o){return!!o&&"true"===o.toLowerCase()}function qg(o){var s,m=(s=o.match(/^(\d+)\/(\d+)$/))?Number(s[1])/Number(s[2]):Number(o);return isNaN(m)?null:m}function rg(o,s){var m=new DOMParser,_=gi.value()(o);o=null;try{o=m.parseFromString(_,"text/xml")}catch(o){return null}if(!(m=o.documentElement)||m.getElementsByTagName("parsererror").length||m.tagName!=s)return null;for(s=document.createNodeIterator(o,NodeFilter.SHOW_ALL);o=s.nextNode();)if(o instanceof HTMLElement||o instanceof SVGElement)return null;return m}function tg(o,s){try{return rg(Af(o),s)}catch(o){return null}}L("shaka.util.Uint8ArrayUtils",Qf),Qf.concat=Wf,Qf.toHex=Vf,Qf.fromHex=Uf,Qf.fromBase64=Tf,Qf.toBase64=Sf,Qf.toStandardBase64=Rf;var gi=new sf((function(){if("undefined"!=typeof trustedTypes){var o=trustedTypes.createPolicy("shaka-player#xml",{createHTML:function createHTML(o){return o}});return function(s){return o.createHTML(s)}}return function(o){return o}}));function ug(o,s){var m=this;s=void 0===s?1:s,this.C=o,this.G=new Set,this.m=this.s=null,this.ga=this.Y=!1,this.H=0,this.g=null,this.A=new lf,this.i=new Map,this.u=new Map,this.l=new Je,this.h=null,this.o=function(s){2==s.severity&&m.l.reject(s),o.onError(s)},this.V=new Map,this.Z=new Map,this.W=new dd((function(){return function vg(o){var s=o.V,m=o.Z;m.clear(),s.forEach((function(o,s){return m.set(s,o)})),s=Array.from(m.values()),s.length&&s.every((function(o){return"expired"==o}))&&o.o(new N(2,6,6014)),o.C.Id(uf(m))}(m)})),this.M=!1,this.L=[],this.N=!1,this.aa=new dd((function(){!function wg(o){o.i.forEach((function(s,m){var _=s.we,S=m.expiration;isNaN(S)&&(S=1/0),S!=_&&(o.C.onExpirationUpdated(m.sessionId,S),s.we=S)}))}(m)})).Ca(s),this.l.catch((function(){})),this.j=new jf((function(){return function xg(o){return I((function(s){switch(s.g){case 1:return o.A.release(),o.A=null,o.l.reject(),o.aa.stop(),o.aa=null,o.W.stop(),o.W=null,C(s,yg(o),2);case 2:if(!o.m){s.B(3);break}return wa(s,4),C(s,o.m.setMediaKeys(null),6);case 6:Aa(s,5);break;case 4:Ba(s);case 5:o.m=null;case 3:o.g=null,o.G.clear(),o.s=null,o.u=new Map,o.h=null,o.o=function(){},o.C=null,o.X=!1,o.F=null,D(s)}}))}(m)})),this.X=!1,this.I=this.F=null}function Bg(o,s,m){o.u=new Map;for(var _=(m=t(m)).next();!_.done;_=m.next())o.u.set(_.value,{initData:null,initDataType:null});for(_=(m=t(o.h.persistentSessionsMetadata)).next();!_.done;_=m.next())_=_.value,o.u.set(_.sessionId,{initData:_.initData,initDataType:_.initDataType});return o.M=0<o.u.size,Ag(o,s)}function Ag(s,m){var _,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me;return I((function(_e){if(1==_e.g){if(_=function Eg(s){if(s=tf(s.h.clearKeys),0==s.size)return null;var m=[],_=[];s.forEach((function(o,s){var S=s;22!=S.length&&(S=Sf(Uf(s),!1)),22!=(s=o).length&&(s=Sf(Uf(o),!1)),o={kty:"oct",kid:S,k:s},m.push(o),_.push(o.kid)})),s=JSON.stringify({keys:m});var S=JSON.stringify({kids:_});return S=[{initData:M(Bf(S)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+o.btoa(s),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",sessionType:"",initData:S,keyIds:new Set(_)}}(s))for(S=t(m),E=S.next();!E.done;E=S.next())(A=E.value).video&&(A.video.drmInfos=[_]),A.audio&&(A.audio.drmInfos=[_]);for(O=m.some((function(o){return!!(o.video&&o.video.drmInfos.length||o.audio&&o.audio.drmInfos.length)})),O||(H=tf(s.h.servers),function Fg(o,s){var m=[];for(s.forEach((function(o,s){m.push({keySystem:s,licenseServerUri:o,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,serverCertificateUri:"",initData:[],keyIds:new Set})})),o=t(o),s=o.next();!s.done;s=o.next())(s=s.value).video&&(s.video.drmInfos=m),s.audio&&(s.audio.drmInfos=m)}(m,H)),K=new Set,z=t(m),E=z.next();!E.done;E=z.next())for(G=E.value,q=Gg(G),X=t(q),J=X.next();!J.done;J=X.next())ae=J.value,K.add(ae);for(pe=t(K),J=pe.next();!J.done;J=pe.next())Hg(J.value,tf(s.h.servers),tf(s.h.advanced||{}),s.h.keySystemsMapping);return C(_e,Ld(m,s.M,s.X,s.h.preferredKeySystems),2)}return O||Object.keys(s.h.servers).length?(me=Dg(s,void 0,m),_e.return(O?me:me.catch((function(){})))):(s.Y=!0,_e.return(Promise.resolve()))}))}function Ig(o){var s;return I((function(m){switch(m.g){case 1:if(o.m.mediaKeys)return m.return();if(!o.F){m.B(2);break}return C(m,o.F,3);case 3:return kf(o.j),m.return();case 2:return wa(m,4),o.F=o.m.setMediaKeys(o.s),C(m,o.F,6);case 6:Aa(m,5);break;case 4:s=Ba(m),o.o(new N(2,6,6003,s.message));case 5:kf(o.j),D(m)}}))}function Ng(o){var s,m;return I((function(_){switch(_.g){case 1:if(!o.s||!o.g)return _.return();if(!o.g.serverCertificateUri||o.g.serverCertificate&&o.g.serverCertificate.length){_.B(2);break}return s=bf([o.g.serverCertificateUri],o.h.retryParameters),wa(_,3),C(_,o.C.Hb.request(5,s).promise,5);case 5:m=_.h,o.g.serverCertificate=M(m.data),Aa(_,4);break;case 3:throw new N(2,6,6017,Ba(_));case 4:if(o.j.g)return _.return();case 2:return o.g.serverCertificate&&o.g.serverCertificate.length?(wa(_,6),C(_,o.s.setServerCertificate(o.g.serverCertificate),8)):_.return();case 8:Aa(_,0);break;case 6:throw new N(2,6,6004,Ba(_).message)}}))}function Mg(o){var s,m,_,S;return I((function(E){if(1==E.g)return o.u.size?(o.u.forEach((function(s,m){Pg(o,m,s)})),C(E,o.l,3)):E.B(2);if(2!=E.g){if(0<(o.g&&o.g.keyIds||new Set([])).size&&function Qg(o){for(var s=t(o.g&&o.g.keyIds||new Set([])),m=s.next();!m.done;m=s.next())if("usable"!==o.V.get(m.value))return!1;return!0}(o))return E.return(o.l);o.l=new Je,o.l.catch((function(){}))}for(s=(o.g?o.g.initData:[])||[],m=t(s),_=m.next();!_.done;_=m.next())S=_.value,Kg(o,S.initDataType,S.initData);return s.length||o.l.resolve(),E.return(o.l)}))}function Kg(o,s,m){if(m.length){for(var _=o.i.values(),S=(_=t(_)).next();!S.done;S=_.next())if(lb(m,S.value.initData)&&!jd("Tizen 2"))return;0<o.i.size&&Rg(o)&&(o.l.resolve(),o.l=new Je,o.l.catch((function(){}))),function Sg(o,s,m,_){try{var S=o.s.createSession(_)}catch(s){return void o.o(new N(2,6,6005,s.message))}o.A.D(S,"message",(function(s){o.m&&o.h.delayLicenseRequestUntilPlayed&&o.m.paused&&!o.N?o.L.push(s):Lg(o,s)})),o.A.D(S,"keystatuseschange",(function(s){return ah(o,s)})),o.i.set(S,{initData:m,initDataType:s,loaded:!1,we:1/0,Xa:null,type:_});try{m=o.h.initDataTransform(m,s,o.g)}catch(m){return s=m,m instanceof N||(s=new N(2,6,6016,m)),void o.o(s)}o.h.logLicenseExchange&&Sf(m),S.generateRequest(s,m).catch((function(s){if(!o.j.g){o.i.delete(S);var m=s.errorCode;if(m&&m.systemCode){var _=m.systemCode;0>_&&(_+=Math.pow(2,32)),_="0x"+_.toString(16)}o.o(new N(2,6,6006,s.message,s,_))}}))}(o,s,m,o.g.sessionType)}}function Tg(o){return!!o&&!!o.match(/^com\.(microsoft|chromecast)\.playready/)}function Ug(o){return o=qf(o=o.i.keys(),(function(o){return o.sessionId})),Array.from(o)}function Dg(o,s,m){var _,S,E,A,O,H,K,z,G,q,X,J,ae,pe;return I((function(me){switch(me.g){case 1:if(_=new Map,m.length){S=function Vg(o,s,m){for(var _=t(s),S=_.next();!S.done;S=_.next()){var E=t(Gg(S.value));for(S=E.next();!S.done;S=E.next())S=S.value,m.has(S.keySystem)||m.set(S.keySystem,[]),m.get(S.keySystem).push(S)}if(1==m.size&&m.has(""))throw new N(2,6,6e3);for(_={},o=t(o.h.preferredKeySystems),S=o.next();!S.done;_={Td:_.Td},S=o.next())for(_.Td=S.value,E=t(s),S=E.next();!S.done;S=E.next())if(S=S.value.decodingInfos.find(function(o){return function(s){return s.supported&&null!=s.keySystemAccess&&s.keySystemAccess.keySystem==o.Td}}(_)))return S.keySystemAccess;for(o=t([!0,!1]),S=o.next();!S.done;S=o.next())for(_=S.value,E=t(s),S=E.next();!S.done;S=E.next()){var A=t(S.value.decodingInfos);for(S=A.next();!S.done;S=A.next()){var O=S.value;if(O.supported&&O.keySystemAccess){var H=t(S=m.get(O.keySystemAccess.keySystem));for(S=H.next();!S.done;S=H.next())if(!!S.value.licenseServerUri==_)return O.keySystemAccess}}}return null}(o,m,_),me.B(2);break}return C(me,function Wg(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe;return I((function(me){switch(me.g){case 1:if(1==s.size&&s.has(""))throw new N(2,6,6e3);for(_=t(s.values()),S=_.next();!S.done;S=_.next())0==(E=S.value).audioCapabilities.length&&delete E.audioCapabilities,0==E.videoCapabilities.length&&delete E.videoCapabilities;A=t(o.h.preferredKeySystems),O=A.next();case 2:if(O.done){me.B(4);break}if(H=O.value,!s.has(H)){me.B(3);break}return K=s.get(H),wa(me,6),C(me,navigator.requestMediaKeySystemAccess(H,[K]),8);case 8:return m=me.h,me.return(m);case 6:Ba(me);case 7:kf(o.j);case 3:O=A.next(),me.B(2);break;case 4:z=t([!0,!1]),G=z.next();case 9:if(G.done){me.B(11);break}q=G.value,X=t(s.keys()),O=X.next();case 12:if(O.done){G=z.next(),me.B(9);break}if(J=O.value,ae=s.get(J),pe=ae.drmInfos.some((function(o){return!!o.licenseServerUri})),pe!=q){me.B(13);break}return wa(me,15),C(me,navigator.requestMediaKeySystemAccess(J,[ae]),17);case 17:return m=me.h,me.return(m);case 15:Ba(me);case 16:kf(o.j);case 13:O=X.next(),me.B(12);break;case 11:return me.return(m)}}))}(o,s),3);case 3:S=me.h;case 2:if(!(E=S))throw new N(2,6,6001);for(kf(o.j),wa(me,4),o.G.clear(),A=E.getConfiguration(),O=A.audioCapabilities||[],H=A.videoCapabilities||[],K=t(O),z=K.next();!z.done;z=K.next())G=z.value,o.G.add(G.contentType.toLowerCase());for(q=t(H),z=q.next();!z.done;z=q.next())X=z.value,o.G.add(X.contentType.toLowerCase());if(m.length){var _e=E.keySystem,Se=_.get(E.keySystem),Ee=[],De=[],$e=[],He=[],et=new Set;Xg(Se,Ee,$e,De,He,et);var rt=o.M?"persistent-license":"temporary";for(_e={keySystem:_e,licenseServerUri:Ee[0],distinctiveIdentifierRequired:Se[0].distinctiveIdentifierRequired,persistentStateRequired:Se[0].persistentStateRequired,sessionType:Se[0].sessionType||rt,audioRobustness:Se[0].audioRobustness||"",videoRobustness:Se[0].videoRobustness||"",serverCertificate:$e[0],serverCertificateUri:De[0],initData:He,keyIds:et},Ee=(Se=t(Se)).next();!Ee.done;Ee=Se.next())(Ee=Ee.value).distinctiveIdentifierRequired&&(_e.distinctiveIdentifierRequired=Ee.distinctiveIdentifierRequired),Ee.persistentStateRequired&&(_e.persistentStateRequired=Ee.persistentStateRequired);Se=_e}else Se=E.keySystem,_e=s.get(E.keySystem),Ee=[],De=[],$e=[],He=[],et=new Set,Xg(_e.drmInfos,Ee,$e,De,He,et),Se={keySystem:Se,licenseServerUri:Ee[0],distinctiveIdentifierRequired:"required"==_e.distinctiveIdentifier,persistentStateRequired:"required"==_e.persistentState,sessionType:_e.sessionTypes[0]||"temporary",audioRobustness:(_e.audioCapabilities?_e.audioCapabilities[0].robustness:"")||"",videoRobustness:(_e.videoCapabilities?_e.videoCapabilities[0].robustness:"")||"",serverCertificate:$e[0],serverCertificateUri:De[0],initData:He,keyIds:et};if(o.g=Se,!o.g.licenseServerUri)throw new N(2,6,6012,o.g.keySystem);return C(me,E.createMediaKeys(),6);case 6:if(J=me.h,kf(o.j),o.s=J,""==o.h.minHdcpVersion||!("getStatusForPolicy"in o.s)){me.B(7);break}return wa(me,8),C(me,o.s.getStatusForPolicy({minHdcpVersion:o.h.minHdcpVersion}),10);case 10:if("usable"!=me.h)throw new N(2,6,6018);kf(o.j),Aa(me,7,4);break;case 8:if((ae=Ba(me,4))instanceof N)throw ae;throw new N(2,6,6019,ae.message);case 7:return o.Y=!0,C(me,Ng(o),11);case 11:kf(o.j),Aa(me,0);break;case 4:if(pe=Ba(me),kf(o.j,pe),o.g=null,o.G.clear(),pe instanceof N)throw pe;throw new N(2,6,6002,pe.message)}}))}function Yg(o){Rg(o)&&o.l.resolve()}function Zg(o,s){new dd((function(){s.loaded=!0,Yg(o)})).S(bi)}function Pg(o,s,m){var _,S,E,A,O,H,K;return I((function(z){switch(z.g){case 1:try{_=o.s.createSession("persistent-license")}catch(s){return S=new N(2,6,6005,s.message),o.o(S),z.return(Promise.reject(S))}return o.A.D(_,"message",(function(s){o.m&&o.h.delayLicenseRequestUntilPlayed&&o.m.paused&&!o.N?o.L.push(s):Lg(o,s)})),o.A.D(_,"keystatuseschange",(function(s){return ah(o,s)})),E={initData:m.initData,initDataType:m.initDataType,loaded:!1,we:1/0,Xa:null,type:"persistent-license"},o.i.set(_,E),wa(z,2),C(z,_.load(s),4);case 4:return A=z.h,kf(o.j),A||(o.i.delete(_),O=o.h.persistentSessionOnlinePlayback?1:2,o.o(new N(O,6,6013)),E.loaded=!0),Zg(o,E),Yg(o),z.return(_);case 2:H=Ba(z),kf(o.j,H),o.i.delete(_),K=o.h.persistentSessionOnlinePlayback?1:2,o.o(new N(K,6,6005,H.message)),E.loaded=!0,Yg(o);case 3:return z.return(Promise.resolve())}}))}function Lg(o,s){var m,_,S,E,A,O,H,K,z,G,q,X;I((function(J){switch(J.g){case 1:if(m=s.target,o.h.logLicenseExchange&&Sf(s.message),_=o.i.get(m),S=o.g.licenseServerUri,E=o.h.advanced[o.g.keySystem],"individualization-request"==s.messageType&&E&&E.individualizationServer&&(S=E.individualizationServer),(A=bf([S],o.h.retryParameters)).body=s.message,A.method="POST",A.licenseRequestType=s.messageType,A.sessionId=m.sessionId,A.drmInfo=o.g,_&&(A.initData=_.initData,A.initDataType=_.initDataType),Tg(o.g.keySystem)){var ae=yf(A.body,!0,!0);if(ae.includes("PlayReadyKeyMessage")){for(var pe=t((ae=rg(ae,"PlayReadyKeyMessage")).getElementsByTagName("HttpHeader")),me=pe.next();!me.done;me=pe.next())me=me.value,A.headers[me.getElementsByTagName("name")[0].textContent]=me.getElementsByTagName("value")[0].textContent;A.body=Tf(ae.getElementsByTagName("Challenge")[0].textContent)}else A.headers["Content-Type"]="text/xml; charset=utf-8"}return O=Date.now(),wa(J,2),C(J,o.C.Hb.request(2,A).promise,4);case 4:H=J.h,Aa(J,3);break;case 2:return K=Ba(J),z=new N(2,6,6007,K),o.o(z),_&&_.Xa&&_.Xa.reject(z),J.return();case 3:return o.j.g?J.return():(o.H+=(Date.now()-O)/1e3,o.h.logLicenseExchange&&Sf(H.data),wa(J,5),C(J,m.update(H.data),7));case 7:Aa(J,6);break;case 5:return G=Ba(J),q=new N(2,6,6008,G.message),o.o(q),_&&_.Xa&&_.Xa.reject(q),J.return();case 6:if(o.j.g)return J.return();X=new P("drmsessionupdate"),o.C.onEvent(X),_&&(_.Xa&&_.Xa.resolve(),Zg(o,_)),D(J)}}))}function ah(o,s){s=s.target;var m=o.i.get(s),_=!1;s.keyStatuses.forEach((function(s,S){if("string"==typeof S){var E=S;S=s,s=E}if(Tg(o.g.keySystem)&&16==S.byteLength&&(hd()||nd())){var A=(E=pb(S)).getUint32(0,!0),O=E.getUint16(4,!0),H=E.getUint16(6,!0);E.setUint32(0,A,!1),E.setUint16(4,O,!1),E.setUint16(6,H,!1)}"status-pending"!=s&&(m.loaded=!0),"expired"==s&&(_=!0),S=Vf(S).slice(0,32),o.V.set(S,s)}));var S=s.expiration-Date.now();(0>S||_&&1e3>S)&&m&&!m.Xa&&(o.i.delete(s),s.close().catch((function(){}))),Rg(o)&&(o.l.resolve(),o.W.S(Ui))}function yg(o){var s;return I((function(m){return s=Array.from(o.i.entries()),o.i.clear(),C(m,Promise.all(s.map((function(s){var m=(s=t(s)).next().value,_=s.next().value;return I((function(s){return 1==s.g?(wa(s,2),o.ga||o.u.has(m.sessionId)||"persistent-license"!==_.type||o.h.persistentSessionOnlinePlayback?C(s,function dh(o){var s;return I((function(m){return 1==m.g?(s=new Promise((function(o,s){new dd(s).S(_i)})),wa(m,2),C(m,Promise.race([Promise.all([o.close(),o.closed]),s]),4)):2!=m.g?Aa(m,0):(Ba(m),void D(m))}))}(m),5):C(s,m.remove(),5)):2!=s.g?Aa(s,0):(Ba(s),void D(s))}))}))),0)}))}function fh(o,s){return!o.length||!s.length||o===s||0<gh(o,s).length}function gh(o,s){if(!o.length)return s;if(!s.length)return o;for(var m=[],_=(o=t(o)).next();!_.done;_=o.next()){_=_.value;for(var S={},E=t(s),A=E.next();!A.done;S={La:S.La},A=E.next())if(A=A.value,_.keySystem==A.keySystem){S.La=[],S.La=S.La.concat(_.initData||[]),S.La=S.La.concat(A.initData||[]),S.La=S.La.filter(function(o){return function(s,m){return void 0===s.keyId||m===o.La.findIndex((function(o){return o.keyId===s.keyId}))}}(S)),E=_.keyIds&&A.keyIds?new Set([].concat(v(_.keyIds),v(A.keyIds))):_.keyIds||A.keyIds,m.push({keySystem:_.keySystem,licenseServerUri:_.licenseServerUri||A.licenseServerUri,distinctiveIdentifierRequired:_.distinctiveIdentifierRequired||A.distinctiveIdentifierRequired,persistentStateRequired:_.persistentStateRequired||A.persistentStateRequired,videoRobustness:_.videoRobustness||A.videoRobustness,audioRobustness:_.audioRobustness||A.audioRobustness,serverCertificate:_.serverCertificate||A.serverCertificate,serverCertificateUri:_.serverCertificateUri||A.serverCertificateUri,initData:S.La,keyIds:E});break}}return m}function Gg(o){return(o.video?o.video.drmInfos:[]).concat(o.audio?o.audio.drmInfos:[])}function Rg(o){return function rf(o,s){for(var m=(o=t(o)).next();!m.done;m=o.next())if(!s(m.value))return!1;return!0}(o=o.i.values(),(function(o){return o.loaded}))}function Xg(o,s,m,_,S,E){for(var A={},O=(o=t(o)).next();!O.done;A={ra:A.ra},O=o.next()){if(A.ra=O.value,s.includes(A.ra.licenseServerUri)||s.push(A.ra.licenseServerUri),_.includes(A.ra.serverCertificateUri)||_.push(A.ra.serverCertificateUri),A.ra.serverCertificate&&(m.some(function(o){return function(s){return lb(s,o.ra.serverCertificate)}}(A))||m.push(A.ra.serverCertificate)),A.ra.initData){O={};for(var H=t(A.ra.initData),K=H.next();!K.done;O={bd:O.bd},K=H.next())O.bd=K.value,S.some(function(o){return function(s){var m=o.bd;return!(!s.keyId||s.keyId!=m.keyId)||s.initDataType==m.initDataType&&lb(s.initData,m.initData)}}(O))||S.push(O.bd)}if(A.ra.keyIds)for(H=(O=t(A.ra.keyIds)).next();!H.done;H=O.next())E.add(H.value)}}function Hg(s,m,_,S){var E=s.keySystem;!E||"org.w3.clearkey"==E&&s.licenseServerUri||(m.size&&(m=m.get(E)||"",s.licenseServerUri=m),s.keyIds||(s.keyIds=new Set),(_=_.get(E))&&(s.distinctiveIdentifierRequired||(s.distinctiveIdentifierRequired=_.distinctiveIdentifierRequired),s.persistentStateRequired||(s.persistentStateRequired=_.persistentStateRequired),s.videoRobustness||(s.videoRobustness=_.videoRobustness),s.audioRobustness||(s.audioRobustness=_.audioRobustness),s.serverCertificate||(s.serverCertificate=_.serverCertificate),_.sessionType&&(s.sessionType=_.sessionType),s.serverCertificateUri||(s.serverCertificateUri=_.serverCertificateUri)),S[E]&&(s.keySystem=S[E]),o.cast&&o.cast.__platform__&&"com.microsoft.playready"==E&&(s.keySystem="com.chromecast.playready"))}(_=ug.prototype).destroy=function(){return this.j.destroy()},_.configure=function(o){this.h=o},_.yc=function(o){var s=this;return I((function(m){if(1==m.g)return s.s?(s.m=o,s.A.la(s.m,"play",(function(){for(var o=t(s.L),m=o.next();!m.done;m=o.next())Lg(s,m.value);s.N=!0,s.L=[]})),"webkitCurrentPlaybackTargetIsWireless"in s.m&&s.A.D(s.m,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return yg(s)})),s.I=s.g&&s.g.initData.find((function(o){return 0<o.initData.length}))||null,s.I||"com.apple.fps"!==s.g.keySystem||s.u.size?C(m,Ig(s),2):m.B(2)):(s.A.la(o,"encrypted",(function(){s.o(new N(2,6,6010))})),m.return());Mg(s).catch((function(){})),s.I||s.u.size||s.h.parseInbandPsshEnabled||s.A.D(s.m,"encrypted",(function(o){return function Jg(o,s){return I((function(m){if(1==m.g)return C(m,Ig(o),2);Kg(o,s.initDataType,M(s.initData)),D(m)}))}(s,o)})),D(m)}))},_.be=function(){var o=this,s=this.i.keys();return s=qf(s,(function(s){var m=o.i.get(s);return{sessionId:s.sessionId,sessionType:m.type,initData:m.initData,initDataType:m.initDataType}})),Array.from(s)},_.Ic=function(){for(var o=1/0,s=this.i.keys(),m=(s=t(s)).next();!m.done;m=s.next())m=m.value,isNaN(m.expiration)||(o=Math.min(o,m.expiration));return o},_.qd=function(){return uf(this.Z)};var _i=1,bi=5,Ui=.5,ta=new sf((function(){return nb(new Uint8Array([0]))}));function ih(){}function jh(o,s,m,_){var S,E,A,O;return I((function(H){if(1==H.g)return _&&(S=na[_.toLowerCase()])?H.return(S):(E=lh(o))&&(A=aa[E])?H.return(A):_?H.B(2):C(H,nh(o,s,m),3);if(2!=H.g&&(_=H.h)&&(O=na[_]))return H.return(O);throw new N(2,4,4e3,o)}))}function nh(o,s,m){var _,S,E;return I((function(A){return 1==A.g?((_=bf([o],m)).method="HEAD",C(A,s.request(0,_).promise,2)):(S=A.h,E=S.headers["content-type"],A.return(E?E.toLowerCase().split(";").shift():""))}))}function lh(o){return 1==(o=new bc(o).ta.split("/").pop().split(".")).length?"":o.pop().toLowerCase()}L("shaka.media.ManifestParser",ih),ih.unregisterParserByMime=function(o){delete na[o]},ih.registerParserByMime=function(o,s){na[o]=s},ih.registerParserByExtension=function(o,s){aa[o]=s},ih.AccessibilityPurpose={ai:"visually impaired",Dh:"hard of hearing"};var na={},aa={};function ph(o,s,m,_,S){var E=oa.value(),A=o.subarray(m.start,m.start+m.size),O=pb(A),H=new Uint8Array(m.size+E.byteLength);for(H.set(A,0),(A=pb(H)).setUint32(4,S),H.set(E,m.size),S=O.getUint32(4),A.setUint32(m.size+16,S),rh(H,0,H.byteLength),S=new Uint8Array(o.byteLength+H.byteLength),m=id()?m.start:m.start+m.size,E=o.subarray(m),S.set(o.subarray(0,m)),S.set(H,m),S.set(E,m+H.byteLength),_=(o=t(_)).next();!_.done;_=o.next())rh(S,(_=_.value).start,_.size+H.byteLength);return H=pb(S,s.start),s=Mf(s),o=H.getUint32(s),H.setUint32(s,o+1),S}function rh(o,s,m){0!=(s=(o=pb(o,s)).getUint32(0))&&(1==s?(o.setUint32(8,m>>32),o.setUint32(12,4294967295&m)):o.setUint32(0,m))}var oa=new sf((function(){return new Uint8Array([0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])}));function sh(o,s,m,_,S,E){this.wa=o,this.Ba=s,this.ka=m,this.qe=void 0===_?null:_,this.timescale=void 0===S?null:S,this.g=void 0===E?null:E}function Q(o,s,m,_,S,E,A,O,H,K,z,G,q,X,J){K=void 0===K?[]:K,X=void 0===X?la:X,this.startTime=o,this.l=this.endTime=s,this.F=m,this.Ba=_,this.ka=S,this.h=E,this.timestampOffset=A,this.appendWindowStart=O,this.appendWindowEnd=H,this.i=K,this.tilesLayout=void 0===z?"":z,this.C=void 0===G?null:G,this.g=void 0===q?null:q,this.status=X,this.m=!1,this.s=!0,this.o=!1,this.u=void 0===J?null:J,this.A=null,this.j=0}sh.prototype.Lc=function(){return this.Ba},sh.prototype.Hc=function(){return this.ka},L("shaka.media.InitSegmentReference",sh),sh.prototype.getEndByte=sh.prototype.Hc,sh.prototype.getStartByte=sh.prototype.Lc,(_=Q.prototype).wa=function(){return this.F()},_.getStartTime=function(){return this.startTime},_.lg=function(){return this.endTime},_.Lc=function(){return this.Ba},_.Hc=function(){return this.ka},_.Dg=function(){return this.tilesLayout},_.Cg=function(){return this.C},_.Bb=function(){return this.status},_.Og=function(){this.status=ca},_.pe=function(){this.m=!0},_.Mg=function(){return this.m},_.vf=function(){this.s=!1},_.Lg=function(){return this.s},_.uf=function(){this.o=!0},_.Ig=function(){return this.o},_.If=function(o){this.A=o},_.Ag=function(){return this.A},_.offset=function(o){this.startTime+=o,this.endTime+=o,this.l+=o;for(var s=t(this.i),m=s.next();!m.done;m=s.next())(m=m.value).startTime+=o,m.endTime+=o,m.l+=o},_.Oe=function(o){null==this.g?Ya("Sync attempted without sync time!"):(o=this.g-o-this.startTime,.001<=Math.abs(o)&&this.offset(o))},L("shaka.media.SegmentReference",Q),Q.prototype.syncAgainst=Q.prototype.Oe,Q.prototype.offset=Q.prototype.offset,Q.prototype.getThumbnailSprite=Q.prototype.Ag,Q.prototype.setThumbnailSprite=Q.prototype.If,Q.prototype.hasByterangeOptimization=Q.prototype.Ig,Q.prototype.markAsByterangeOptimization=Q.prototype.uf,Q.prototype.isIndependent=Q.prototype.Lg,Q.prototype.markAsNonIndependent=Q.prototype.vf,Q.prototype.isPreload=Q.prototype.Mg,Q.prototype.markAsPreload=Q.prototype.pe,Q.prototype.markAsUnavailable=Q.prototype.Og,Q.prototype.getStatus=Q.prototype.Bb,Q.prototype.getTileDuration=Q.prototype.Cg,Q.prototype.getTilesLayout=Q.prototype.Dg,Q.prototype.getEndByte=Q.prototype.Hc,Q.prototype.getStartByte=Q.prototype.Lc,Q.prototype.getEndTime=Q.prototype.lg,Q.prototype.getStartTime=Q.prototype.getStartTime,Q.prototype.getUris=Q.prototype.wa;var la=0,ca=1;function wh(o){return!o||1==o.length&&1e-6>o.end(0)-o.start(0)?null:o.length?o.end(o.length-1):null}function xh(o,s){return!(!o||!o.length||1==o.length&&1e-6>o.end(0)-o.start(0)||s>o.end(o.length-1))&&s>=o.start(0)}function yh(o,s){if(!o||!o.length||1==o.length&&1e-6>o.end(0)-o.start(0))return 0;for(var m=0,_=(o=t(zh(o))).next();!_.done;_=o.next()){var S=_.value;_=S.start,(S=S.end)>s&&(m+=S-Math.max(_,s))}return m}function zh(o){if(!o)return[];for(var s=[],m=0;m<o.length;m++)s.push({start:o.start(m),end:o.end(m)});return s}
/*
   @license
   Shaka Player
   Copyright 2022 Google LLC
   SPDX-License-Identifier: Apache-2.0
  */function Bh(){}function Ch(o,s){return s+10<=o.length&&73===o[s]&&68===o[s+1]&&51===o[s+2]&&255>o[s+3]&&255>o[s+4]&&128>o[s+6]&&128>o[s+7]&&128>o[s+8]&&128>o[s+9]}function Dh(o,s){return s+10<=o.length&&51===o[s]&&68===o[s+1]&&73===o[s+2]&&255>o[s+3]&&255>o[s+4]&&128>o[s+6]&&128>o[s+7]&&128>o[s+8]&&128>o[s+9]}function Eh(o,s){var m=(127&o[s])<<21;return m|=(127&o[s+1])<<14,(m|=(127&o[s+2])<<7)|127&o[s+3]}function Fh(o){var s={key:o.type,description:"",data:""};if("TXXX"===o.type){if(2>o.size||3!==o.data[0])return null;var m=o.data.subarray(1).indexOf(0);if(-1===m)return null;var _=xf(M(o.data,1,m));return o=xf(M(o.data,2+m)).replace(/\0*$/,""),s.description=_,s.data=o,s}return"WXXX"===o.type?2>o.size||3!==o.data[0]||-1===(m=o.data.subarray(1).indexOf(0))?null:(_=xf(M(o.data,1,m)),o=xf(M(o.data,2+m)).replace(/\0*$/,""),s.description=_,s.data=o,s):"PRIV"===o.type?2>o.size||-1===(_=o.data.indexOf(0))?null:(_=xf(M(o.data,0,_)),s.description=_,"com.apple.streaming.transportStreamTimestamp"==_?(_=o.data.subarray(_.length+1),o=1&_[3],_=(_[4]<<23)+(_[5]<<15)+(_[6]<<7)+_[7],_/=45,o&&(_+=47721858.84),s.data=_):(o=nb(o.data.subarray(_.length+1)),s.data=o),s):"T"===o.type[0]?2>o.size||3!==o.data[0]?null:(o=xf(o.data.subarray(1)).replace(/\0*$/,""),s.data=o,s):"W"===o.type[0]?(o=xf(o.data).replace(/\0*$/,""),s.data=o,s):o.data?(s.data=nb(o.data),s):null}function Gh(o){for(var s=0,m=[];Ch(o,s);){var _=Eh(o,s+6);for(o[s+5]>>6&1&&(s+=10),_=(s+=10)+_;s+10<_;){var S=o.subarray(s),E=Eh(S,4);(E=Fh(S={type:String.fromCharCode(S[0],S[1],S[2],S[3]),size:E,data:S.subarray(10,10+E)}))&&m.push(E),s+=S.size+10}Dh(o,s)&&(s+=10)}return m}function Hh(o,s){for(var m=s=void 0===s?0:s,_=0;Ch(o,s);)o[s+5]>>6&1&&(_+=10),_+=10,_+=Eh(o,s+6),Dh(o,s+10)&&(_+=10),s+=_;return 0<_?o.subarray(m,m+_):new Uint8Array([])}function Ih(o,s){var m=null,_=null,S=null,E=o.K();return 1&s&&(S=o.dc()),2&s&&o.skip(4),8&s&&(m=o.K()),16&s&&(_=o.K()),{trackId:E,ef:m,eg:_,ci:S}}function Jh(o,s){return 1==s?(s=o.K(),o=o.K(),{baseMediaDecodeTime:s*Math.pow(2,32)+o}):{baseMediaDecodeTime:o.K()}}function Kh(o,s){return 1==s?(o.skip(8),o.skip(8)):(o.skip(4),o.skip(4)),s=o.K(),o.skip(4),o=o.Ia(),{timescale:s,language:String.fromCharCode(96+(o>>10))+String.fromCharCode(96+((960&o)>>5))+String.fromCharCode(96+(31&o))}}function Lh(o,s,m){var _=o.K(),S=[],E=null;1&m&&(E=o.K()),4&m&&o.skip(4);for(var A=0;A<_;A++){var O={Ge:null,sampleSize:null,Ld:null};256&m&&(O.Ge=o.K()),512&m&&(O.sampleSize=o.K()),1024&m&&o.skip(4),2048&m&&(O.Ld=0==s?o.K():o.zf()),S.push(O)}return{gi:_,Bf:S,dg:E}}function Mh(o,s){1==s?(o.skip(8),o.skip(8)):(o.skip(4),o.skip(4));var m=o.K();return 1==s?o.skip(8):o.skip(4),o.skip(4),o.skip(8),o.skip(2),o.skip(2),o.skip(2),o.skip(2),o.skip(36),{trackId:m,width:s=o.Ia()+o.Ia()/16,height:o=o.Ia()+o.Ia()/16}}function Oh(o,s){return o.skip(87),{Pa:s+"."+this.g(o.qa())+this.g(o.qa())+this.g(o.qa())}}function Ph(o){return{Pa:Kf(o=o.K())}}function Qh(o){this.j=o,this.i=o.byteLength,this.g=this.h=0}function Rh(o){var s=o.j.byteLength-o.i,m=new Uint8Array(4),_=Math.min(4,o.i);0!==_&&(m.set(o.j.subarray(s,s+_)),o.h=new Df(m,0).K(),o.g=8*_,o.i-=_)}function Sh(o,s){if(o.g<=s){s-=o.g;var m=Math.floor(s/8);s-=8*m,o.g-=m,Rh(o)}o.h<<=s,o.g-=s}function Th(o,s){var m=Math.min(o.g,s),_=o.h>>>32-m;return o.g-=m,0<o.g?o.h<<=m:0<o.i&&Rh(o),0<(m=s-m)?_<<m|Th(o,m):_}function Uh(o){var s;for(s=0;s<o.g;++s)if(0!=(o.h&2147483648>>>s))return o.h<<=s,o.g-=s,s;return Rh(o),s+Uh(o)}function Vh(o){Sh(o,1+Uh(o))}function Wh(o){return Th(o,Uh(o)+1)-1}function Xh(o,s){for(var m=8,_=8,S=0;S<s;S++)0!==_&&(_=(m+(1&(_=Wh(o))?1+_>>>1:-1*(_>>>1))+256)%256),m=0===_?m:_}function Yh(o){return Th(o,8),Wh(o),Wh(o)}function Zh(){this.C=null,this.F=!1,this.s=this.u=this.i=null,this.g=[],this.A=this.m=this.h=null,this.j=[],this.o=null,this.l=[]}function ai(o,s){if(s=void 0!==s&&s,1!=(o[0]<<16|o[1]<<8|o[2]))return null;var m={data:new Uint8Array(0),Vg:o[4]<<8|o[5],pts:null,dts:null};return s&&0!=m.Vg?null:(192&(s=o[7])&&(m.pts=536870912*(14&o[9])+4194304*(255&o[10])+16384*(254&o[11])+128*(255&o[12])+(254&o[13])/2,m.dts=m.pts,64&s&&(m.dts=536870912*(14&o[14])+4194304*(255&o[15])+16384*(254&o[16])+128*(255&o[17])+(254&o[18])/2)),m.data=o.subarray(9+o[8]),m)}function ci(o){return!(0>$h(o))}function $h(o){for(var s=Math.min(1e3,o.length-564),m=0;m<s;){if(71==o[m]&&71==o[m+188]&&71==o[m+376])return m;m++}return-1}Q.Status={sh:la,Zh:ca,Hh:2},L("shaka.util.Id3Utils",Bh),Bh.getID3Data=Hh,Bh.getID3Frames=Gh,L("shaka.util.ExpGolomb",Qh),(_=Zh.prototype).clearData=function(){this.i=null,this.g=[],this.h=null,this.j=[],this.l=[]},_.parse=function(o){if(564>o.length)return this;for(var s=Math.max(0,$h(o)),m=o.length-(o.length+s)%188,_=!1,S=s;S<m;S+=188)if(71==o[S]){var E=!!(64&o[S+1]),A=((31&o[S+1])<<8)+o[S+2];if(1<(48&o[S+3])>>4){var O=S+5+o[S+4];if(O==S+188)continue}else O=S+4;switch(A){case 0:E&&(O+=o[O]+1),this.C=(31&o[O+10])<<8|o[O+11];break;case 17:case 8191:break;case this.C:E&&(O+=o[O]+1),A={audio:-1,video:-1,fe:-1,audioCodec:"",videoCodec:""};var H=O+3+((15&(E=o)[O+1])<<8|E[O+2])-4;for(O+=12+((15&E[O+10])<<8|E[O+11]);O<H;){var K=(31&E[O+1])<<8|E[O+2],z=(15&E[O+3])<<8|E[O+4];switch(E[O]){case 6:if(-1==A.audio&&0<z)for(var G=O+5,q=z;2<q;){switch(E[G]){case 106:A.audio=K,A.audioCodec="ac3";break;case 122:A.audio=K,A.audioCodec="ec3"}var X=E[G+1]+2;G+=X,q-=X}break;case 15:-1==A.audio&&(A.audio=K,A.audioCodec="aac");break;case 21:-1==A.fe&&(A.fe=K);break;case 27:-1==A.video&&(A.video=K,A.videoCodec="avc");break;case 3:case 4:-1==A.audio&&(A.audio=K,A.audioCodec="mp3");break;case 36:-1==A.video&&(A.video=K,A.videoCodec="hvc");break;case 129:-1==A.audio&&(A.audio=K,A.audioCodec="ac3");break;case 132:case 135:-1==A.audio&&(A.audio=K,A.audioCodec="ec3")}O+=z+5}E=A,null==this.u&&(this.u=E.video,this.s=E.videoCodec),null==this.m&&(this.m=E.audio,this.A=E.audioCodec),null==this.o&&(this.o=E.fe),_&&!this.F&&(_=!1,S=s-188),this.F=!0;break;case this.u:(O=ai(E=o.subarray(O,S+188),!0))&&null!=O.pts&&(O=Math.min(O.dts,O.pts)/9e4,null==this.i||this.i>O)&&(this.i=O),this.g.push(E);break;case this.m:(O=ai(E=o.subarray(O,S+188)))&&null!=O.pts&&(O=Math.min(O.dts,O.pts)/9e4,null==this.h||this.h>O)&&(this.h=O),this.j.push(E);break;case this.o:this.l.push(o.subarray(O,S+188));break;default:_=!0}}return this},_.ze=function(o,s){for(var m,_=o.pts?o.pts/9e4:null,S=(o=o.data).byteLength,E=0,A=[],O=-1,H=0,K=!1,z=0;z<S;++z){var G=o[z];if(G){if(2<=E&&1==G&&K){if(2>=z)break;m.data=Wf(m.data,o.subarray(0,z-2)),m.bb=Wf(m.bb,o.subarray(0,z-2));break}if(2<=E&&1==G){if(0<=O&&(E=z-((3<E?3:E)+1),A.push({data:o.subarray(O+1,E+1),bb:o.subarray(O,E+1),type:H,time:_})),z>=S-1)return A;O=++z,H=31&o[z]}E=0}else E++;z>=S-1&&0<=O&&0<=E&&(K?(m.data=Wf(m.data,o),m.bb=Wf(m.bb,o)):(K=!0,m={data:o.subarray(O+1,S),bb:o.subarray(O,S),type:H,time:_},s&&(S=(o=s.data).byteLength,z=-1)))}return m&&A.push(m),A},_.getMetadata=function(){for(var o=[],s=new Uint8Array(0),m=this.l.length-1;0<=m;m--){var _=ai(s=Wf(this.l[m],s));_&&(o.unshift({cueTime:_.pts?_.pts/9e4:null,data:_.data,frames:Gh(_.data),dts:_.dts,pts:_.pts}),s=new Uint8Array(0))}return o},_.Xb=function(){for(var o=[],s=new Uint8Array(0),m=this.j.length-1;0<=m;m--){var _=ai(s=Wf(this.j[m],s));_&&(o.unshift(_),s=new Uint8Array(0))}return o},_.mf=function(){for(var o=[],s=new Uint8Array(0),m=this.g.length-1;0<=m;m--){var _=ai(s=Wf(this.g[m],s),!0);_&&(o.unshift(_),s=new Uint8Array(0))}return o},_.getStartTime=function(){return{audio:this.h,video:this.i}},_.od=function(){return{audio:this.A,video:this.s}},_.ee=function(){for(var o=[],s=new Uint8Array(0),m=this.g.length-1;0<=m;m--){var _=ai(s=Wf(this.g[m],s));_&&("avc"==this.s&&(o=o.concat(this.ze(_))),s=new Uint8Array(0))}return o.reverse()},_.nf=function(){var o={height:null,width:null},s=this.ee();if(!s.length)return o;if(s=s.find((function(o){return 7==o.type})),!s)return o;var m=Th(s=new Qh(s.data),8);if(Th(s,8),Th(s,8),Vh(s),da.includes(m)&&(3===(m=Wh(s))&&Sh(s,1),Vh(s),Vh(s),Sh(s,1),1===Th(s,1))){m=3!==m?8:12;for(var _=0;_<m;_++)1===Th(s,1)&&Xh(s,6>_?16:64)}if(Vh(s),0===(m=Wh(s)))Wh(s);else if(1===m)for(Sh(s,1),Vh(s),Vh(s),m=Wh(s),_=0;_<m;_++)Vh(s);Vh(s),Sh(s,1),m=Wh(s),_=Wh(s);var S=Th(s,1);0===S&&Sh(s,1),Sh(s,1);var E=0,A=0,O=0,H=0;return 1===Th(s,1)&&(E=Wh(s),A=Wh(s),O=Wh(s),H=Wh(s)),o.height=String((2-S)*(_+1)*16-2*O-2*H),o.width=String(16*(m+1)-2*E-2*A),o},L("shaka.util.TsParser",Zh),Zh.syncOffset=$h,Zh.probe=ci,Zh.prototype.getVideoResolution=Zh.prototype.nf,Zh.prototype.getVideoNalus=Zh.prototype.ee,Zh.prototype.getCodecs=Zh.prototype.od,Zh.prototype.getStartTime=Zh.prototype.getStartTime,Zh.prototype.getVideoData=Zh.prototype.mf,Zh.prototype.getAudioData=Zh.prototype.Xb,Zh.prototype.getMetadata=Zh.prototype.getMetadata,Zh.prototype.parseAvcNalus=Zh.prototype.ze,Zh.prototype.parse=Zh.prototype.parse,Zh.prototype.clearData=Zh.prototype.clearData,Zh.Timescale=9e4;var da=[100,110,122,244,44,83,86,118,128,138,139,134];function di(o,s,m){this.g=null,this.i=-1,this.j=o,this.h=s,this.l=m,"undefined"==typeof libDPIModule&&$a("Could not Find LCEVC Library dependencies on this page"),"undefined"==typeof LcevcDil?$a("Could not Find LCEVC Library on this page"):LcevcDil.SupportObject.SupportStatus||$a(LcevcDil.SupportObject.SupportError),"undefined"!=typeof LcevcDil&&"undefined"!=typeof libDPIModule&&this.h instanceof HTMLCanvasElement&&LcevcDil.SupportObject.SupportStatus&&!this.g&&LcevcDil.SupportObject.webGLSupport(this.h)&&(this.h.classList.remove("shaka-hidden"),this.g=new LcevcDil.LcevcDil(this.j,this.h,this.l))}function ei(o,s){var m=pa;switch(s.mimeType){case"video/webm":m=fa;break;case"video/mp4":m=ga}o.g&&(o.i=s.id,o.g.setLevelSwitching(s.id,!0),o.g.setContainerFormat(m))}di.prototype.release=function(){this.g&&(this.g.close(),this.g=null)},L("shaka.lcevc.Dil",di),di.prototype.release=di.prototype.release;var pa=0,fa=1,ga=2;function ii(o,s,m,_){var S=this;this.j=o,this.C=null,this.u=s,this.h={},this.H={},this.W={},this.g=null,this.M=!1,this.Z=m||function(){},this.L=_||null,this.l={},this.A=new lf,this.m={},this.F=null,this.G=new Je,this.N="",this.i=ji(this,this.G),this.o=!1,this.I=new jf((function(){return function ki(o){var s,m,_,S,E,A,O;return I((function(H){if(1==H.g){for(m in s=[],o.l)for(_=o.l[m],S=_[0],o.l[m]=_.slice(0,1),S&&s.push(S.p.catch(sc)),E=t(_.slice(1)),A=E.next();!A.done;A=E.next())A.value.p.reject(new N(2,7,7003,void 0));for(O in o.g&&s.push(o.g.destroy()),o.u&&s.push(o.u.destroy()),o.m)s.push(o.m[O].destroy());return C(H,Promise.all(s),2)}o.A&&(o.A.release(),o.A=null),o.j&&(o.j.removeAttribute("src"),o.j.load(),o.j=null),o.C=null,o.i=null,o.g=null,o.u=null,o.h={},o.m={},o.F=null,o.l={},o.L=null,D(H)}))}(S)})),this.s=!1,this.Y="UNKNOWN",this.V=this.X=!1,this.aa=new Je}function ji(o,s){var m=new MediaSource;return o.A.la(m,"sourceopen",(function(){URL.revokeObjectURL(o.N),s.resolve()})),o.N=ma(m),o.j.src=o.N,m}function mi(o,s,m){var _=Cc(m.mimeType,m.codecs);if(s==qt)ni(o,_,o.s,m.external);else{var S=o.C.forceTransmux;(!gb(_)||!o.s&&nn.includes(_))&&(S=!0);var E=Fc(m.mimeType,m.codecs);S&&(S=Vb(E))&&(_=S(),o.m[s]=_,_=_.convertCodecs(s,E)),E=_+o.C.sourceBufferExtraFeatures,kf(o.I);try{var A=o.i.addSourceBuffer(E)}catch(s){throw new N(2,3,3015,s,"The mediaSource_ status was"+o.i.readyState+"expected 'open'")}o.s&&(A.mode=_a),o.A.D(A,"error",(function(){o.l[s][0].p.reject(new N(2,3,3014,o.j.error?o.j.error.code:0))})),o.A.D(A,"updateend",(function(){return pi(o,s)})),o.h[s]=A,o.H[s]=_,o.W[s]=!!m.drmInfos.length}}function ni(o,s,m,_){o.g||(o.g=new Kc(o.u));var S=o.g;o=_||o.M,"application/cea-608"==s||"application/cea-708"==s?S.i=null:(S.i=(0,rn[s])(),S.i.setSequenceMode?S.i.setSequenceMode(m):$a('Text parsers should have a "setSequenceMode" method!'),S.u=o)}function qi(o){return!o.o&&(!o.i||"ended"==o.i.readyState)}function ri(o,s){return o.o?o=null:s==qt?o=o.g.g:o=!(o=si(o,s))||1==o.length&&1e-6>o.end(0)-o.start(0)?null:1==o.length&&0>o.start(0)?0:o.length?o.start(0):null,o}function ti(o,s){return o.o?null:s==qt?o.g.h:wh(si(o,s))}function si(o,s){try{return o.h[s].buffered}catch(o){return null}}function wi(o,s,m,_,S,E,A,O){var H,K,z,G,q,X,J,ae,pe,me;return A=void 0!==A&&A,O=void 0!==O&&O,I((function(_e){switch(_e.g){case 1:if(s!=(H=Jt).da){_e.B(2);break}if(!o.s){_e.B(3);break}return C(_e,o.aa,4);case 4:K=_e.h,o.g.s=K;case 3:return C(_e,function Nc(o,s,m,_){var S,E,A,O;return I((function(H){return 1==H.g?C(H,Promise.resolve(),2):o.i&&o.j?null==m||null==_?(o.i.parseInit(M(s)),H.return()):(S=o.u?m:o.s,E={periodStart:o.s,segmentStart:m,segmentEnd:_,vttOffset:S},A=o.i.parseMedia(M(s),E),O=A.filter((function(s){return s.startTime>=o.l&&s.startTime<o.m})),o.j.append(O),null==o.g&&(o.g=Math.max(m,o.l)),o.h=Math.min(_,o.m),void D(H)):H.return()}))}(o.g,m,_?_.startTime:null,_?_.endTime:null),5);case 5:return _e.return();case 2:if(z=o.h[s].timestampOffset,G=o.H[s],o.m[s]&&(G=o.m[s].getOrginalMimeType()),_&&(q=function vi(o,s,m,_,S,E){var A=null,O=M(m);if(nn.includes(S))(E=Gh(O)).length&&_&&((s=E.find((function(o){return"com.apple.streaming.transportStreamTimestamp"===o.description})))&&s.data&&(A=Math.round(s.data)/1e3),o.Z([{cueTime:_.startTime,data:O,frames:E,dts:_.startTime,pts:_.startTime}],0,_.endTime));else if(S.includes("/mp4")&&_&&0==_.timestampOffset&&_.h&&_.h.timescale){var H=_.h.timescale;if(!isNaN(H)){var K=0,z=!1;(new Gf).box("moof",Lf).box("traf",Lf).O("tfdt",(function(o){K=Jh(o.reader,o.version).baseMediaDecodeTime/H,z=!0,o.parser.stop()})).parse(m,!0),z&&(A=K)}}else S.includes("/mp4")||S.includes("/webm")||!ci(O)||(null!=(s=(O=(new Zh).parse(O)).getStartTime()[s])&&(A=s),(O=O.getMetadata()).length&&o.Z(O,E,_?_.endTime:null));return A}(o,s,m,_,G,z),null!=q)&&(X=_.startTime-q,(.1<=Math.abs(z-X)||A||O)&&(z=X,o.V&&(xi(o,s,(function(){return yi(o,s)})),xi(o,s,(function(){return zi(o,s,z)})))),J=s==H.va||!(H.va in o.h),o.s&&J&&o.aa.resolve(z)),E&&s==H.va&&(o.g||ni(o,"application/cea-608",o.s,!1),o.F||(ae=G.split(";",1)[0],o.F=new rb(ae)),_?(pe=o.F.j(m)).length&&function Rc(o,s,m,_,S){for(var E=m+" "+_,A=new Map,O=(s=t(s)).next();!O.done;O=s.next()){var H=O.value;O=H.stream,H=H.cue,A.has(O)||A.set(O,new Map),A.get(O).has(E)||A.get(O).set(E,[]),Qc(o,H,S),H.startTime>=o.l&&H.startTime<o.m&&(A.get(O).get(E).push(H),O==o.A&&o.j.append([H]))}for(E=(S=t(A.keys())).next();!E.done;E=S.next())for(E=E.value,o.o.has(E)||o.o.set(E,new Map),O=(s=t(A.get(E).keys())).next();!O.done;O=s.next())O=O.value,H=A.get(E).get(O),o.o.get(E).set(O,H);o.g=null==o.g?Math.max(m,o.l):Math.min(o.g,Math.max(m,o.l)),o.h=Math.max(o.h,Math.min(_,o.m))}(o.g,pe,_.startTime,_.endTime,z):o.F.init(m)),!o.m[s]){_e.B(6);break}return C(_e,o.m[s].transmux(m,S,_,o.i.duration),7);case 7:m=_e.h;case 6:return m=function Ai(o,s,m,_){var S=o.W[_];return o.C.insertFakeEncryptionInInit&&null==m&&S&&(kd()||id())&&"mp4"==o.H[_].split(";")[0].split("/")[1]&&(s=function oh(o){function b(){m=!0}function c(o){_.push(o),Lf(o)}o=M(o);var s,m=!1,_=[],S=[];if((new Gf).box("moov",c).box("trak",c).box("mdia",c).box("minf",c).box("stbl",c).O("stsd",(function(o){s=o,_.push(o),Nf(o)})).O("encv",b).O("enca",b).O("hev1",(function(o){S.push({box:o,Ib:1701733238})})).O("hvc1",(function(o){S.push({box:o,Ib:1701733238})})).O("avc1",(function(o){S.push({box:o,Ib:1701733238})})).O("avc3",(function(o){S.push({box:o,Ib:1701733238})})).O("ac-3",(function(o){S.push({box:o,Ib:1701733217})})).O("ec-3",(function(o){S.push({box:o,Ib:1701733217})})).O("mp4a",(function(o){S.push({box:o,Ib:1701733217})})).parse(o),m)return o;if(0==S.length||!s)throw Vf(o),new N(2,3,3019);S.reverse();for(var E=t(S),A=E.next();!A.done;A=E.next())A=A.value,o=ph(o,s,A.box,_,A.Ib);return o}(s)),s}(o,m,_?_.startTime:null,s),_&&o.s&&s!=H.da&&(A||O)&&(me=_.startTime,xi(o,s,(function(){return yi(o,s)})),xi(o,s,(function(){return zi(o,s,me)}))),C(_e,xi(o,s,(function(){var _=m;if("video"==s&&o.L){var S=o.L;S.g&&S.g.appendBuffer(_,"video",S.i)}o.h[s].appendBuffer(_)})),8);case 8:D(_e)}}))}function Di(o,s){return I((function(m){return s==Jt.da?o.g?C(m,o.g.remove(0,1/0),0):m.return():C(m,xi(o,s,(function(){var m=o.i.duration;0>=m?pi(o,s):o.h[s].remove(0,m)})),0)}))}function Ei(s,m,_,S,E,A,O,H){var K;return I((function(z){return 1==z.g?m==Jt.da?(A||(s.g.s=_),function Oc(o,s,m){o.l=s,o.m=m}(s.g,S,E),z.return()):(K=[],C(z,function Fi(s,m,_,S){var E,A,O,H,K,z,G,q,X;return I((function(J){return 1==J.g?(E=Ic(Jc(s.H[m]))[0],A=s.H[m].split(";")[0],H=Cc(_.mimeType,_.codecs),K=s.C.forceTransmux,(!gb(H)||!s.s&&nn.includes(H))&&(K=!0),z=Fc(_.mimeType,_.codecs),K&&(G=Vb(z))&&(O=G(),H=O.convertCodecs(m,z)),q=Ic(Jc(H))[0],X=H.split(";")[0],E===q&&A===X?J.return(!1):o.SourceBuffer&&SourceBuffer.prototype&&SourceBuffer.prototype.changeType?C(J,function Ki(s,m,_,S){return xi(s,m,(function(){m!==qt&&(o.SourceBuffer&&SourceBuffer.prototype&&SourceBuffer.prototype.changeType&&(s.m[m]&&s.m[m].destroy(),S&&(s.m[m]=S),s.h[m].changeType(_+s.C.sourceBufferExtraFeatures),s.H[m]=_),pi(s,m))}))}(s,m,H,O),3):(O&&O.destroy(),C(J,function Mi(o,s){return Hi(o,(function(){return function Li(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae;return I((function(pe){switch(pe.g){case 1:for(S in o.o=!0,m=o.j.currentTime,ya(pe),o.A.sb(),o.h={},_=[],o.m)_.push(o.m[S].destroy());for(E in o.h){A=o.h[E];try{o.i.removeSourceBuffer(A)}catch(o){}}return C(pe,Promise.all(_),4);case 4:return o.m={},O=o.i.duration,o.G=new Je,o.i=ji(o,o.G),C(pe,o.G,5);case 5:for(o.i.duration=O,H=new Je,K=o.i.sourceBuffers,z=s.size,G=0,o.A.D(K,"addsourcebuffer",(function(){++G===z&&H.resolve()})),q=t(s.keys()),X=q.next();!X.done;X=q.next())J=X.value,ae=s.get(J),mi(o,J,ae);return o.j.currentTime=m,C(pe,H,2);case 2:Ca(pe),o.o=!1,Ea(pe,0)}}))}(o,s)}))}(s,S),3))):J.return(!0)}))}(s,m,O,H),2)):(z.h||K.push(xi(s,m,(function(){return yi(s,m)}))),A||K.push(xi(s,m,(function(){return zi(s,m,_)}))),K.push(xi(s,m,(function(){s.h[m].appendWindowStart=0,s.h[m].appendWindowEnd=E,s.h[m].appendWindowStart=S,pi(s,m)}))),C(z,Promise.all(K),0))}))}function Gi(o,s,m){return I((function(_){return s==Jt.da?_.return():(xi(o,s,(function(){return yi(o,s)})),C(_,xi(o,s,(function(){return zi(o,s,m)})),0))}))}function yi(o,s){var m=o.h[s].appendWindowStart,_=o.h[s].appendWindowEnd;o.h[s].abort(),o.h[s].appendWindowStart=m,o.h[s].appendWindowEnd=_,pi(o,s)}function zi(o,s,m){0>m&&(m+=.001),o.h[s].timestampOffset=m,pi(o,s)}function pi(o,s){if(!o.o){var m=o.l[s][0];m&&(m.p.resolve(),Ii(o,s))}}function xi(o,s,m){return kf(o.I),m={start:m,p:new Je},o.l[s].push(m),1==o.l[s].length&&Ji(o,s),m.p}function Hi(o,s){var m,_,S,E,A;return I((function(O){switch(O.g){case 1:for(S in kf(o.I),m=[],_={},o.h)_.rc=new Je,E={start:function(o){return function(){return o.rc.resolve()}}(_),p:_.rc},o.l[S].push(E),m.push(_.rc),1==o.l[S].length&&E.start(),_={rc:_.rc};return wa(O,2),C(O,Promise.all(m),4);case 4:Aa(O,3);break;case 2:throw Ba(O);case 3:return wa(O,5,6),C(O,s(),6);case 6:for(A in Ca(O),o.h)Ii(o,A);Ea(O,0);break;case 5:throw new N(2,3,3015,Ba(O),o.j.error||"No error in the media element")}}))}function Ii(o,s){o.l[s].shift(),Ji(o,s)}function Ji(o,s){var m=o.l[s][0];if(m)try{m.start()}catch(_){"QuotaExceededError"==_.name?m.p.reject(new N(2,3,3017,s)):m.p.reject(new N(2,3,3015,_,o.j.error||"No error in the media element")),Ii(o,s)}}(_=ii.prototype).destroy=function(){return this.I.destroy()},_.init=function(o,s,m,_){s=void 0!==s&&s,m=void 0===m?"UNKNOWN":m,_=void 0!==_&&_;var S,E,A,O,H=this;return I((function(K){if(1==K.g)return C(K,H.G,2);for(H.s=s,H.Y=m,H.X=_,H.V=!H.s&&"HLS"==H.Y&&!H.X,S=t(o.keys()),E=S.next();!E.done;E=S.next())A=E.value,O=o.get(A),mi(H,A,O),H.l[A]=[];D(K)}))},_.configure=function(o){this.C=o},_.cb=function(){var o={total:this.o?[]:zh(this.j.buffered),audio:this.o?[]:zh(si(this,"audio")),video:this.o?[]:zh(si(this,"video")),text:[]};if(this.g){var s=this.g.g,m=this.g.h;null!=s&&null!=m&&o.text.push({start:s,end:m})}return o},_.remove=function(o,s,m){var _=this;return I((function(S){return o==Jt.da?C(S,_.g.remove(s,m),0):C(S,xi(_,o,(function(){m<=s?pi(_,o):_.h[o].remove(s,m)})),0)}))},_.flush=function(o){var s=this;return I((function(m){return o==Jt.da?m.return():C(m,xi(s,o,(function(){s.j.currentTime-=.001,pi(s,o)})),0)}))},_.endOfStream=function(o){var s=this;return I((function(m){return C(m,Hi(s,(function(){qi(s)||"closed"===s.i.readyState||(o?s.i.endOfStream(o):s.i.endOfStream())})),0)}))},_.Aa=function(o){var s=this;return I((function(m){return C(m,Hi(s,(function(){if(o<s.i.duration)for(var m in s.h){var _={start:function start(){},p:new Je};s.l[m].unshift(_)}s.i.duration=o})),0)}))},_.getDuration=function(){return this.i.duration};var ma=o.URL.createObjectURL,_a="sequence";function R(o,s,m){this.i=o,this.m=s,this.s=this.j=1/0,this.g=1,this.h=this.l=null,this.o=0,this.C=!0,this.F=0,this.u=void 0===m||m,this.G=0,this.A=!1}function Ni(o,s,m){this.l=m,this.j=o,this.s=Oi(o),this.g=o.g.currentTime,this.m=Date.now()/1e3,this.h=!1,this.o=0,this.u=s,this.i=function(){}}function Qi(o){this.g=o}function Oi(o){if(o.g.paused||0==o.g.playbackRate||0==o.g.buffered.length)var s=!1;else e:{s=o.g.currentTime;for(var m=(o=t(zh(o.g.buffered))).next();!m.done;m=o.next())if(!(s<(m=m.value).start-.1||s>m.end-.5)){s=!0;break e}s=!1}return s}function Ri(o,s,m,_,S){var E=this;this.u=S,this.g=o,this.A=s,this.s=m,this.l=new lf,this.j=!1,this.F=o.readyState,this.C=this.i=0,this.h=_,this.o=!1,this.l.D(o,"waiting",(function(){return Si(E)})),this.m=new dd((function(){Si(E)})).Ca(this.s.gapJumpTimerTime)}function Si(o){if(0!=o.g.readyState){if(o.g.seeking){if(!o.j)return}else o.j=!1;if(!o.g.paused||o.g.currentTime==o.i&&(o.g.autoplay||o.g.currentTime!=o.i)){var s;if(o.g.readyState!=o.F&&(o.F=o.g.readyState),!(s=!o.h)){var m=(s=o.h).j,_=Oi(m),S=m.g.currentTime,E=Date.now()/1e3;s.g==S&&s.s==_||(s.m=E,s.g=S,s.s=_,s.h=!1),(_=(S=E-s.m)>=s.u&&_&&!s.h)&&(s.i(s.g,S),s.h=!0,s.g=m.g.currentTime,s.o++,s.l(new P("stalldetected"))),s=!_}s&&(s=o.g.currentTime,_=function Ah(o,s,m){return!o||!o.length||1==o.length&&1e-6>o.end(0)-o.start(0)?null:(o=zh(o).findIndex((function(o,_,S){return o.start>s&&(0==_||S[_-1].end-s<=m)})),0<=o?o:null)}(m=o.g.buffered,s,o.s.gapDetectionThreshold),null==_||0==_&&!o.o||((S=m.start(_))>=o.A.eb()||.001>S-s||(0!=_&&m.end(_-1),o.g.currentTime=S,s==o.i&&(o.i=S),o.C++,o.u(new P("gapjumped")))))}}}function Ti(o,s,m,_){s==HTMLMediaElement.HAVE_NOTHING||o.readyState>=s?_():(s=Sa.value().get(s),m.la(o,s,_))}(_=R.prototype).getDuration=function(){return this.j},_.sg=function(){return this.g},_.Hf=function(o){this.i=o},_.Aa=function(o){this.j=o},_.xg=function(){return this.i},_.Ff=function(o){this.o=o},_.fc=function(o){this.C=o},_.Md=function(o){this.s=o},_.Gf=function(o){this.m=o},_.kg=function(){return this.m},_.yf=function(o,s){if(0!=o.length){var m=o[o.length-1].end+s;this.Fd(o[0].start+s),this.g=o.reduce((function(o,s){return Math.max(o,s.end-s.start)}),this.g),this.h=Math.max(this.h,m),null!=this.i&&this.u&&!this.A&&(this.i=(Date.now()+this.o)/1e3-this.h-this.g)}},_.Qc=function(o){if(0!=o.length){for(var s=o[0].startTime,m=o[0].endTime,_=(Date.now()+this.o)/1e3,S=(o=t(o)).next();!S.done;S=o.next())_<(S=S.value).startTime||(s=Math.min(s,S.startTime),m=Math.max(m,S.endTime),this.g=Math.max(this.g,S.endTime-S.startTime));this.Fd(s),this.h=Math.max(this.h,m),null!=this.i&&this.u&&!this.A&&(this.i=_-this.h-this.g)}},_.Cd=function(){this.A=!0},_.Fd=function(o){this.l=null==this.l?o:Math.min(this.l,o)},_.ue=function(o){this.g=Math.max(this.g,o)},_.offset=function(o){null!=this.l&&(this.l+=o),null!=this.h&&(this.h+=o)},_.T=function(){return 1/0==this.j&&!this.C},_.Fb=function(){return 1/0!=this.j&&!this.C},_.fb=function(){return Math.max(this.F,this.Ab()-this.s)},_.Jf=function(o){this.F=o},_.Ab=function(){return this.T()||this.Fb()?Math.min(Math.max(0,(Date.now()+this.o)/1e3-this.g-this.i)+this.G,this.j):this.h?Math.min(this.h,this.j):this.j},_.Kc=function(o){var s=Math.max(this.l,this.F);return 1/0==this.s?Math.ceil(1e3*s)/1e3:Math.max(s,Math.min(this.Ab()-this.s+o,this.eb()))},_.Yb=function(){return this.Kc(0)},_.eb=function(){return Math.max(0,this.Ab()-(this.T()||this.Fb()?this.m:0))},_.Of=function(){return!(null==this.i||null!=this.h&&this.u)},_.Ef=function(o){this.G=o},L("shaka.media.PresentationTimeline",R),R.prototype.setAvailabilityTimeOffset=R.prototype.Ef,R.prototype.usingPresentationStartTime=R.prototype.Of,R.prototype.getSeekRangeEnd=R.prototype.eb,R.prototype.getSeekRangeStart=R.prototype.Yb,R.prototype.getSafeSeekRangeStart=R.prototype.Kc,R.prototype.getSegmentAvailabilityEnd=R.prototype.Ab,R.prototype.setUserSeekStart=R.prototype.Jf,R.prototype.getSegmentAvailabilityStart=R.prototype.fb,R.prototype.isInProgress=R.prototype.Fb,R.prototype.isLive=R.prototype.T,R.prototype.offset=R.prototype.offset,R.prototype.notifyMaxSegmentDuration=R.prototype.ue,R.prototype.notifyMinSegmentStartTime=R.prototype.Fd,R.prototype.lockStartTime=R.prototype.Cd,R.prototype.notifySegments=R.prototype.Qc,R.prototype.notifyTimeRange=R.prototype.yf,R.prototype.getDelay=R.prototype.kg,R.prototype.setDelay=R.prototype.Gf,R.prototype.setSegmentAvailabilityDuration=R.prototype.Md,R.prototype.setStatic=R.prototype.fc,R.prototype.setClockOffset=R.prototype.Ff,R.prototype.getPresentationStartTime=R.prototype.xg,R.prototype.setDuration=R.prototype.Aa,R.prototype.setPresentationStartTime=R.prototype.Hf,R.prototype.getMaxSegmentDuration=R.prototype.sg,R.prototype.getDuration=R.prototype.getDuration,Ni.prototype.release=function(){this.l=this.j=null,this.i=function(){}},Ri.prototype.release=function(){this.l&&(this.l.release(),this.l=null),null!=this.m&&(this.m.stop(),this.m=null),this.h&&(this.h.release(),this.h=null),this.g=this.A=this.u=null},Ri.prototype.xe=function(){this.o=!0,Si(this)};var Sa=new sf((function(){return new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]])}));function Vi(o,s,m,_){var S=this;this.g=o,this.m=s,this.s=m,this.l=null,this.j=function(){return null==S.l&&(S.l=_()),S.l},this.o=!1,this.h=new lf,this.i=new Wi(o),Ti(this.g,HTMLMediaElement.HAVE_METADATA,this.h,(function(){Xi(S,S.j())}))}function Yi(o){return o.o?o.g.currentTime:o.j()}function Zi(o,s){0<o.g.readyState?$i(o.i,s):Ti(o.g,HTMLMediaElement.HAVE_METADATA,o.h,(function(){Xi(o,o.j())}))}function Xi(o,s){.001>Math.abs(o.g.currentTime-s)?aj(o):(o.h.la(o.g,"seeking",(function(){aj(o)})),$i(o.i,o.g.currentTime&&0!=o.g.currentTime?o.g.currentTime:s))}function aj(o){o.o=!0,o.h.D(o.g,"seeking",(function(){return o.m()})),o.s(o.g.currentTime)}function Wi(o){var s=this;this.h=o,this.m=10,this.l=this.j=this.i=0,this.g=new dd((function(){0>=s.i||s.h.currentTime!=s.j?s.g.stop():(s.h.currentTime=s.l,s.i--)}))}function $i(o,s){o.j=o.h.currentTime,o.l=s,o.i=o.m,o.h.currentTime=s,o.g.Ca(.1)}function bj(o){this.g=o,this.j=!1,this.h=null,this.i=new lf}function cj(o,s,m,_,S,E){var A=this;this.i=o,this.g=s.presentationTimeline,this.A=s.minBufferTime||0,this.l=m,this.u=S,this.s=null,this.o=function dj(o,s,m){if(!s.stallEnabled)return null;var _=s.stallSkip;return s=new Ni(new Qi(o),s.stallThreshold,m),function Pi(o,s){o.i=s}(s,(function(){_?o.currentTime+=_:(o.pause(),o.play())})),s}(o,m,E),this.j=new Ri(o,s.presentationTimeline,m,this.o,E),this.h=new Vi(o,(function(){var o=A.j;o.j=!0,o.o=!1;var s=Yi(A.h);return o=ej(A,s),.001<Math.abs(o-s)&&(s=Date.now()/1e3,!A.s||A.s<s-1)?(A.s=s,Zi(A.h,o),o=void 0):(A.u(),o=void 0),o}),(function(o){var s=A.j;s.g.seeking&&!s.j&&(s.j=!0,s.i=o)}),(function(){var o=_;return null==o?o=1/0>A.g.getDuration()?A.g.Yb():A.g.eb():0>o&&(o=A.g.eb()+o),fj(A,gj(A,o))})),this.m=new dd((function(){if(0!=A.i.readyState&&!A.i.paused){var o=Yi(A.h),s=A.g.Yb(),m=A.g.eb();3>m-s&&(s=m-3),o<s&&(o=ej(A,o),A.i.currentTime=o)}}))}function fj(o,s){var m=o.g.getDuration();return s>=m?m-o.l.durationBackoff:s}function ej(o,s){var m=Math.max(o.A,o.l.rebufferingGoal),_=o.l.safeSeekOffset,S=o.g.Yb(),E=o.g.eb(),A=o.g.getDuration();3>E-S&&(S=E-3);var O=o.g.Kc(m),H=o.g.Kc(_);return m=o.g.Kc(m+_),s>=A?fj(o,s):s>E?E:s<S?xh(o.i.buffered,H)?H:m:s>=O||xh(o.i.buffered,s)?s:m}function gj(o,s){var m=o.g.Yb();return s<m?m:s>(o=o.g.eb())?o:s}function hj(o){this.g=o,this.l=null,this.i=0,this.m=!1}function ij(o,s){for(var m=(o=t(o.g)).next();!m.done;m=o.next())s(m.value)}function kj(o,s,m){return new hj([new Q(o,o+s,(function(){return m}),0,null,null,o,o,o+s)])}function jj(o,s,m){this.i=o,this.g=s,this.h=m}function lj(){hj.call(this,[]),this.h=[]}function mj(o){var s=this;this.g=o,this.j=!1,this.i=this.g.td(),this.h=new dd((function(){s.g.wf(.25*s.i)}))}function nj(o){o.h.stop();var s=o.j?0:o.i;if(0<=s)try{return void(o.g.td()!=s&&o.g.Ne(s))}catch(o){}o.h.Ca(.25),0!=o.g.td()&&o.g.Ne(0)}function oj(o){var s=this;this.h=o,this.g=new Set,this.i=new dd((function(){pj(s,!1)})).Ca(.25)}function pj(o,s){for(var m=t(o.g),_=m.next();!_.done;_=m.next())_.value.j(o.h.currentTime,s)}function qj(o){Te.call(this),this.g=new Map,this.h=o}function uj(o){Te.call(this);var s=this;this.g=new Set,this.i=o,this.h=new dd((function(){for(var o=s.i(),m=t(s.g),_=m.next();!_.done;_=m.next())(_=_.value).endTime<o.start&&(s.g.delete(_),_=new P("regionremove",new Map([["region",_]])),s.dispatchEvent(_))})).Ca(2)}function vj(o,s){Te.call(this);var m=this;this.i=o,this.l=s,this.g=new Map,this.m=[{Nb:null,Mb:xa,Eb:function Eb(o,s){return xj(m,"enter",o,s)}},{Nb:ka,Mb:xa,Eb:function Eb(o,s){return xj(m,"enter",o,s)}},{Nb:Da,Mb:xa,Eb:function Eb(o,s){return xj(m,"enter",o,s)}},{Nb:xa,Mb:ka,Eb:function Eb(o,s){return xj(m,"exit",o,s)}},{Nb:xa,Mb:Da,Eb:function Eb(o,s){return xj(m,"exit",o,s)}},{Nb:ka,Mb:Da,Eb:function Eb(o,s){return xj(m,"skip",o,s)}},{Nb:Da,Mb:ka,Eb:function Eb(o,s){return xj(m,"skip",o,s)}}],this.h=new lf,this.h.D(this.i,"regionremove",(function(o){m.g.delete(o.region)}))}function xj(o,s,m,_){s=new P(s,new Map([["region",m],["seeking",_]])),o.dispatchEvent(s)}Vi.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.m=function(){},this.g=null},Wi.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null},(_=bj.prototype).Xd=function(){var o=this;Ti(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.i,(function(){!function a(){null==o.h||0==o.h?o.j=!0:(o.i.la(o.g,"seeking",(function(){o.j=!0})),o.g.currentTime=Math.max(0,o.g.currentTime+o.h))}()}))},_.release=function(){this.i&&(this.i.release(),this.i=null),this.g=null},_.Yd=function(o){this.h=this.j?this.h:o},_.gd=function(){return(this.j?this.g.currentTime:this.h)||0},_.We=function(){return 0},_.Ve=function(){return 0},_.xf=function(){},(_=cj.prototype).Xd=function(){this.m.Ca(.25)},_.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.m&&(this.m.stop(),this.m=null),this.i=this.h=this.g=this.l=null,this.u=function(){}},_.Yd=function(o){Zi(this.h,o)},_.gd=function(){var o=Yi(this.h);return 0<this.i.readyState&&!this.i.paused?gj(this,o):o},_.We=function(){return this.o?this.o.o:0},_.Ve=function(){return this.j.C},_.xf=function(){this.j.xe()},(_=hj.prototype).Jc=function(){return this.g.length},_.release=function(){this.m||(this.g=[],this.l&&this.l.stop(),this.l=null)},_.Pg=function(){this.m=!0},_.find=function(o){for(var s=this.g.length-1,m=s;0<=m;--m){var _=this.g[m],S=m<s?this.g[m+1].startTime:_.endTime;if(o>=_.startTime&&o<S)return m+this.i}return this.g.length&&o<this.g[0].startTime?this.i:null},_.get=function(o){return 0==this.g.length||0>(o-=this.i)||o>=this.g.length?null:this.g[o]},_.offset=function(o){if(!this.m)for(var s=t(this.g),m=s.next();!m.done;m=s.next())m.value.offset(o)},_.Ed=function(o){if(!this.m&&o.length){var s=Math.round(1e3*o[0].startTime)/1e3;this.g=this.g.filter((function(o){return Math.round(1e3*o.startTime)/1e3<s})),this.g.push.apply(this.g,v(o))}},_.Pc=function(o,s){var m=this;o=o.filter((function(o){return o.endTime>s&&(0==m.g.length||o.endTime>m.g[0].startTime)})),this.Ed(o),this.Ta(s)},_.Ta=function(o){if(!this.m){var s=this.g.length;this.g=this.g.filter((function(s){return s.endTime>o})),this.i+=s-this.g.length}},_.Ub=function(o,s,m){if(m=void 0!==m&&m,!this.m){for(;this.g.length&&this.g[this.g.length-1].startTime>=s;)this.g.pop();for(;this.g.length&&this.g[0].endTime<=o;)this.g.shift(),m||this.i++;0!=this.g.length&&(o=this.g[this.g.length-1],this.g[this.g.length-1]=new Q(o.startTime,s,o.F,o.Ba,o.ka,o.h,o.timestampOffset,o.appendWindowStart,o.appendWindowEnd,o.i,o.tilesLayout,o.C,o.g,o.status,o.u),this.g[this.g.length-1].j=o.j)}},_.Od=function(o,s){var m=this;this.m||(this.l&&this.l.stop(),this.l=new dd((function(){var o=s();o?m.g.push.apply(m.g,v(o)):(m.l.stop(),m.l=null)})),this.l.Ca(o))},hj.prototype[Symbol.iterator]=function(){return this.yb(0)},hj.prototype.yb=function(o){var s=this.find(o);if(null==s)return null;s--;var m=this.get(s+1),_=-1;if(m&&0<m.i.length)for(var S=m.i.length-1;0<=S;--S){var E=m.i[S];if(o>=E.startTime&&o<E.endTime){for(;S&&!E.s;)S--,E=m.i[S];if(!E.s)return Ya("No independent partial segment found!"),null;s++,_=S-1;break}}return new jj(this,s,_)},L("shaka.media.SegmentIndex",hj),hj.forSingleSegment=kj,hj.prototype.getIteratorForTime=hj.prototype.yb,hj.prototype.updateEvery=hj.prototype.Od,hj.prototype.fit=hj.prototype.Ub,hj.prototype.evict=hj.prototype.Ta,hj.prototype.mergeAndEvict=hj.prototype.Pc,hj.prototype.offset=hj.prototype.offset,hj.prototype.get=hj.prototype.get,hj.prototype.find=hj.prototype.find,hj.prototype.markImmutable=hj.prototype.Pg,hj.prototype.release=hj.prototype.release,jj.prototype.cg=function(){return this.g},jj.prototype.current=function(){var o=this.i.get(this.g);return o&&0<o.i.length&&o.wa().length&&this.h>=o.i.length&&(this.g++,this.h=0,o=this.i.get(this.g)),o&&0<o.i.length?o.i[this.h]:o},jj.prototype.next=function(){var o=this.i.get(this.g);return o&&0<o.i.length?(this.h++,o.wa().length&&this.h==o.i.length&&(this.g++,this.h=0)):(this.g++,this.h=0),{value:o=this.current(),done:!o}},L("shaka.media.SegmentIterator",jj),jj.prototype.next=jj.prototype.next,jj.prototype.current=jj.prototype.current,jj.prototype.currentPosition=jj.prototype.cg,ra(lj,hj),(_=lj.prototype).clone=function(){var o=new lj;return o.h=this.h.slice(),o},_.release=function(){for(var o=t(this.h),s=o.next();!s.done;s=o.next())s.value.release();this.h=[]},_.find=function(o){for(var s=0,m=t(this.h),_=m.next();!_.done;_=m.next()){var S=(_=_.value).find(o);if(null!=S)return S+s;s+=_.i+_.g.length}return null},_.get=function(o){for(var s=0,m=t(this.h),_=m.next();!_.done;_=m.next()){var S=(_=_.value).get(o-s);if(S)return S;s+=_.i+_.g.length}return null},_.offset=function(){},_.Ed=function(){},_.Ta=function(){},_.Pc=function(){},_.Ub=function(){},_.Od=function(){},L("shaka.media.MetaSegmentIndex",lj),lj.prototype.updateEvery=lj.prototype.Od,lj.prototype.fit=lj.prototype.Ub,lj.prototype.mergeAndEvict=lj.prototype.Pc,lj.prototype.evict=lj.prototype.Ta,lj.prototype.merge=lj.prototype.Ed,lj.prototype.offset=lj.prototype.offset,lj.prototype.get=lj.prototype.get,lj.prototype.find=lj.prototype.find,lj.prototype.release=lj.prototype.release,mj.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},mj.prototype.set=function(o){this.i=o,nj(this)},mj.prototype.pd=function(){return this.g.pd()},oj.prototype.release=function(){this.i.stop();for(var o=t(this.g),s=o.next();!s.done;s=o.next())s.value.release();this.g.clear()},ra(qj,Te),qj.prototype.release=function(){this.g.clear(),Te.prototype.release.call(this)},qj.prototype.j=function(o){for(var s=t(this.g.values()),m=s.next();!m.done;m=s.next()){e:{for(var _=(m=m.value).Sc,S=_.length-1;0<=S;S--){var E=_[S];if(E.position<=o){_=E.qe;break e}}_=null}if((S=_)&&(S=!((S=m.cf)===_||S&&_&&S.bandwidth==_.bandwidth&&S.audioSamplingRate==_.audioSamplingRate&&S.codecs==_.codecs&&S.contentType==_.contentType&&S.frameRate==_.frameRate&&S.height==_.height&&S.mimeType==_.mimeType&&S.channelsCount==_.channelsCount&&S.pixelAspectRatio==_.pixelAspectRatio&&S.width==_.width)),S)e:{if(S=o,E=_.contentType,(E=this.h()[E])&&0<E.length){var A=E[E.length-1].end;if(S>=E[0].start&&S<A){S=!0;break e}}S=!1}S&&(m.cf=_,JSON.stringify(_),m=new P("qualitychange",new Map([["quality",_],["position",o]])),this.dispatchEvent(m))}},ra(uj,Te),uj.prototype.release=function(){this.g.clear(),this.h.stop(),Te.prototype.release.call(this)},ra(vj,Te),vj.prototype.release=function(){this.i=null,this.g.clear(),this.h.release(),this.h=null,Te.prototype.release.call(this)},vj.prototype.j=function(o,s){if(!this.l||0!=o){this.l=!1;for(var m=t(this.i.g),_=m.next();!_.done;_=m.next()){_=_.value;var S=this.g.get(_),E=o<_.startTime?ka:o>_.endTime?Da:xa;this.g.set(_,E);for(var A=t(this.m),O=A.next();!O.done;O=A.next())(O=O.value).Nb==S&&O.Mb==E&&O.Eb(_,s)}}};var ka=1,xa=2,Da=3;function Aj(o,s,m){this.j=o,this.h=s,this.i=0,this.l=m,this.g=new Map}function Ej(o){if(0!==o.g.size){for(var s=t(o.g.keys()),m=s.next();!m.done;m=s.next())(m=m.value)&&Fj(o,m);o.i=0}}function Fj(o,s){var m=o.g.get(s);o.g.delete(s),m&&m.abort()}function Cj(o){this.i=o,this.g=this.h=null}function Dj(o,s,m){o.g=o.i(s,m,(function(s){return I((function(m){return o.h?C(m,o.h(s),0):m.B(0)}))}))}function Hj(o,s,m,_,S){return o=bf(o,_,S),0==s&&null==m||(o.headers.Range=m?"bytes="+s+"-"+m:"bytes="+s+"-"),o}function Ij(o,s){var m=this;this.g=s,this.m=o,this.i=null,this.u=1,this.o=this.j=null,this.F=0,this.C=!1,this.h=new Map,this.A=!1,this.G=null,this.s=!1,this.l=new jf((function(){return function Jj(o){var s,m,_,S;return I((function(E){if(1==E.g){for(s=[],m=t(o.h.values()),_=m.next();!_.done;_=m.next())Kj(S=_.value),s.push(Lj(S));return C(E,Promise.all(s),2)}o.h.clear(),o.g=null,o.m=null,o.i=null,D(E)}))}(m)}))}function Sj(o,s){var m=o.h.get("video");if(m){var _=m.stream;_&&(s?(s=_.trickModeVideo)&&!m.Kb&&(Tj(o,s,!1,0,!1),m.Kb=_):(_=m.Kb)&&(m.Kb=null,Tj(o,_,!0,0,!1)))}}function Uj(o,s,m,_,S,E){m=void 0!==m&&m,_=void 0===_?0:_,S=void 0!==S&&S,E=void 0!==E&&E,o.j=s,o.A&&(s.video&&Tj(o,s.video,m,_,S,E),s.audio&&Tj(o,s.audio,m,_,S,E))}function Vj(o,s){I((function(m){if(1==m.g)return o.o=s,o.A?s.segmentIndex?m.B(2):C(m,s.createSegmentIndex(),2):m.return();Tj(o,s,!0,0,!1),D(m)}))}function Tj(o,s,m,_,S,E){var A=o.h.get(s.type);A||s.type!=qt?A&&(A.Kb&&(s.trickModeVideo?(A.Kb=s,s=s.trickModeVideo):A.Kb=null),A.stream!=s||S)&&(A.za&&function Gj(o,s){s&&s!==o.h&&(Ej(o),o.h=s)}(A.za,s),s.type==qt&&(S=Cc(s.mimeType,s.codecs),ni(o.g.R,S,o.m.sequenceMode,s.external)),A.stream.closeSegmentIndex&&A.stream.closeSegmentIndex(),A.stream=s,A.ba=null,A.Xe=!!E,m&&(A.Bc?A.Pd=!0:A.ua?(A.vb=!0,A.md=_,A.Pd=!0):(Kj(A),Wj(o,A,!0,_).catch((function(s){o.g&&o.g.onError(s)})))),function Xj(o,s){var m,_;return I((function(S){if(1==S.g)return s.ya?(m=s.stream,_=s.ya,m.segmentIndex?S.B(2):C(S,m.createSegmentIndex(),2)):S.return();if(s.ya!=_||s.stream!=m)return S.return();var E=o.g.sd(),A=ti(o.g.R,s.type),O=s.stream.segmentIndex.find(s.sa?s.sa.endTime:E),H=null==O?null:s.stream.segmentIndex.get(O);O=H&&H.ka?H.ka-H.Ba:null,H&&!O&&(O=(H.endTime-H.getStartTime())*(s.stream.bandwidth||0)/8),O?((H=H.h)&&(O+=(H.ka?H.ka-H.Ba:null)||0),E=8*O/(H=o.g.getBandwidthEstimate())<(A||0)-E-Math.max(o.m.minBufferTime||0,o.i.rebufferingGoal)||s.ya.h.g>O):E=!1,E&&s.ya.abort(),D(S)}))}(o,A).catch((function(s){o.g&&o.g.onError(s)}))):function Oj(o,s){var m,_,S,E,A;I((function(O){switch(O.g){case 1:return m=Jt,o.F++,_=o.F,wa(O,2),C(O,Di(o.g.R,m.da),4);case 4:Aa(O,3);break;case 2:S=Ba(O),o.g&&o.g.onError(S);case 3:E=Cc(s.mimeType,s.codecs),ni(o.g.R,E,o.m.sequenceMode,s.external),(o.g.R.u.isTextVisible()||o.i.alwaysStreamText)&&o.F==_&&(A=Pj(o,s),o.h.set(m.da,A),Qj(o,A,0)),D(O)}}))}(o,s)}function Yj(o,s){s.Bc||s.vb||(s.ua?(s.vb=!0,s.md=0):null==ri(o.g.R,s.type)?null==s.Ya&&Qj(o,s,0):(Kj(s),Wj(o,s,!1,0).catch((function(s){o.g&&o.g.onError(s)}))))}function Pj(o,s){return{stream:s,type:s.type,ba:null,za:Mj(o,s),sa:null,$b:null,me:null,ke:null,je:null,Kb:null,endOfStream:!1,ua:!1,Ya:null,vb:!1,md:0,Pd:!1,Bc:!1,Vc:!0,te:!1,De:!1,Nc:!1,ya:null}}function Mj(o,s){return"video"!==s.type&&"audio"!==s.type?null:0<o.i.segmentPrefetchLimit?new Aj(o.i.segmentPrefetchLimit,s,(function(s,m,_){return Zj(o,s,m,_)})):null}function ak(s,m){var _,S,E,A,O;return I((function(H){switch(H.g){case 1:if(kf(s.l),m.ua||null==m.Ya||m.Bc)return H.return();if(m.Ya=null,!m.vb){H.B(2);break}return C(H,Wj(s,m,m.Pd,m.md),3);case 3:return H.return();case 2:if(m.stream.segmentIndex){H.B(4);break}return _=m.stream,C(H,m.stream.createSegmentIndex(),5);case 5:if(_!=m.stream)return _.closeSegmentIndex&&_.closeSegmentIndex(),m.ua||m.Ya||Qj(s,m,0),H.return();case 4:wa(H,6),S=function bk(s,m){if(dk(m))return function Bi(o,s){var m=ti(o,"video")||0;Pc(o.g,s,m)}(s.g.R,m.stream.originalId||""),null;m.type==qt&&function Ci(o){o.g&&Pc(o.g,"",0)}(s.g.R);var _=s.g.sd(),S=m.sa?m.sa.endTime:_,E=function ui(o,s,m){return o.o?0:s==qt?null==(o=o.g).h||o.h<m?0:o.h-Math.max(m,o.g):yh(o=si(o,s),m)}(s.g.R,m.type,_),A=Math.max(s.m.minBufferTime||0,s.i.rebufferingGoal,s.i.bufferingGoal)*s.u,O=s.m.presentationTimeline.getDuration()-S,H=ti(s.g.R,m.type);if(1e-6>O&&H)return m.endOfStream=!0,"video"==m.type&&(s=s.h.get(qt))&&dk(s)&&(s.endOfStream=!0),null;if(m.endOfStream=!1,E>=A)return s.i.updateIntervalSeconds/2;if(E=function ek(o,s,m,_){if(s.ba)return s.ba.current();if(s.sa||_)return m=s.sa?s.sa.endTime:_,s.te=!0,s.ba=s.stream.segmentIndex.yb(m),s.ba&&s.ba.next().value;o=o.i.inaccurateManifestTolerance,_=Math.max(m-o,0);var S=null;return o&&(s.ba=s.stream.segmentIndex.yb(_),S=s.ba&&s.ba.next().value),S||(s.ba=s.stream.segmentIndex.yb(m),S=s.ba&&s.ba.next().value),S}(s,m,_,H),!E)return s.i.updateIntervalSeconds;for(A=1/0,O=t(O=Array.from(s.h.values())),H=O.next();!H.done;H=O.next())dk(H=H.value)||H.ba&&!H.ba.current()||(A=Math.min(A,H.sa?H.sa.endTime:_));return S>=A+s.m.presentationTimeline.g?s.i.updateIntervalSeconds:(m.za&&m.ba&&function Bj(o,s){if(o.h.segmentIndex){var m=o.h.segmentIndex.yb(Math.max(s.startTime,o.i));if(m)for(;o.g.size<o.j&&null!=s;){var _=!0;s.m&&null!=s.ka&&(_=!1),2==s.Bb()&&(_=!1),_&&!o.g.has(s)&&(Dj(_=new Cj(o.l),s,o.h),o.g.set(s,_)),o.i=s.startTime,s=m.next().value}}}(m.za,E),function fk(s,m,_,S){var E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e;return I((function(Se){switch(Se.g){case 1:if(E=Jt,A=m.stream,O=m.ba,m.ua=!0,wa(Se,2),2==S.Bb())throw new N(1,1,1011);return C(Se,function gk(o,s,m){var _,S,E,A,O,H,K,z,G,q,X,J,ae;return I((function(pe){return _=Jt,S=[],E=Math.max(0,m.appendWindowStart-.1),A=m.appendWindowEnd+.01,O=Ic(s.stream.codecs)[0],H=s.stream.mimeType.split(";")[0],(K=m.timestampOffset)==s.me&&E==s.ke&&A==s.je&&O==s.Bd&&H==s.le||((s.Bd&&O!=s.Bd||s.le&&H!=s.le)&&(s.type===_.va?(z=o.h.get(_.qb))&&(z.$b=null,Lj(z)):s.type===_.qb&&(G=o.h.get(_.va))&&(G.$b=null,Lj(G))),q=function p(){var m,S,z;return I((function(G){if(1==G.g)return m=new Map,o.j.audio&&m.set(_.qb,o.j.audio),o.j.video&&m.set(_.va,o.j.video),wa(G,2),s.ke=E,s.je=A,s.Bd=O,s.le=H,s.me=K,S=o.m.sequenceMode||"HLS"==o.m.type,C(G,Ei(o.g.R,s.type,K,E,A,S,s.stream,m),4);if(2!=G.g)return Aa(G,0);throw z=Ba(G),s.ke=null,s.je=null,s.Bd=null,s.me=null,z}))},S.push(q())),!function th(o,s){return o&&s?o.Lc()==s.Lc()&&o.Hc()==s.Hc()&&xb(o.wa(),s.wa())&&lb(o.g,s.g):o==s}(m.h,s.$b)&&(s.$b=m.h)&&(X=jk(o,s,m.h,void 0,!0),J=function u(){var S,E,A,O,H;return I((function(K){switch(K.g){case 1:return wa(K,2),C(K,X,4);case 4:return S=K.h,kf(o.l),E=null,A=new Map,(new Gf).box("moov",Lf).box("trak",Lf).box("mdia",Lf).O("mdhd",(function(o){E=Kh(o.reader,o.version).timescale})).box("hdlr",(function(o){(o=o.reader).skip(8),o=o.kb(4);var s=String.fromCharCode(o[0]);switch(s+=String.fromCharCode(o[1]),s+=String.fromCharCode(o[2]),s+=String.fromCharCode(o[3])){case"soun":A.set(_.qb,E);break;case"vide":A.set(_.va,E)}E=null})).parse(S),A.has(s.type)?m.h.timescale=A.get(s.type):null!=E&&(m.h.timescale=E),O=s.stream.closedCaptions&&0<s.stream.closedCaptions.size,C(K,o.g.Ye(s.type,S),5);case 5:return C(K,wi(o.g.R,s.type,S,null,s.stream,O),6);case 6:Aa(K,0);break;case 2:throw H=Ba(K),s.$b=null,H}}))},o.g.Sg(m.startTime,m.h),S.push(J())),ae=s.sa?s.sa.j:null,o.m.sequenceMode?(m.j!=ae||s.te)&&(s.te=!1,S.push(Gi(o.g.R,s.type,m.startTime))):o.m.ignoreManifestTimestampsInSegmentsMode&&m.j!=ae&&S.push(Gi(o.g.R,s.type,m.timestampOffset)),C(pe,Promise.all(S),0)}))}(s,m,S),4);case 4:return kf(s.l),s.s?Se.return():(H="video/mp4"==A.mimeType||"audio/mp4"==A.mimeType,K=o.ReadableStream,s.i.lowLatencyMode&&K&&H&&("HLS"!=s.m.type||S.o)?(G=new Uint8Array(0),X=q=!1,J=function u(o){var E,O,H;return I((function(K){return q?K.return():(X=!0,kf(s.l),s.s?K.return():(G=function hk(o,s){var m=new Uint8Array(o.length+s.length);return m.set(o),m.set(s,o.length),m}(G,o),E=!1,O=0,(new Gf).box("mdat",(function(o){O=o.size+o.start,E=!0})).parse(G,!1,!0),E?(H=G.subarray(0,O),G=G.subarray(O),C(K,ik(s,m,_,A,S,H),0)):K.B(0)))}))},C(Se,jk(s,m,S,J),11)):C(Se,jk(s,m,S),7));case 7:if(z=Se.h,kf(s.l),s.s)return Se.return();if(!S.u){Se.B(8);break}return C(Se,function kk(s,m,_){var S,E,A,O;return I((function(H){if(1==H.g)return(S=m.u).cryptoKey?H.B(2):C(H,S.fetchKey(),3);if(!(E=S.iv))for(E=M(new ArrayBuffer(16)),A=S.firstMediaSequenceNumber+_.g,O=E.byteLength-1;0<=O;O--)E[O]=255&A,A>>=8;return H.return(o.crypto.subtle.decrypt({name:"AES-CBC",iv:E},S.cryptoKey,s))}))}(z,S,O),9);case 9:z=Se.h;case 8:return kf(s.l),m.vb?(m.ua=!1,Qj(s,m,0),Se.return()):C(Se,ik(s,m,_,A,S,z),6);case 11:if(ae=Se.h,X){Se.B(6);break}return q=!0,kf(s.l),s.s?Se.return():m.vb?(m.ua=!1,Qj(s,m,0),Se.return()):C(Se,ik(s,m,_,A,S,ae),6);case 6:if(kf(s.l),s.s)return Se.return();m.sa=S,O.next(),m.ua=!1,m.De=!1,pe=s.g.R.cb(),me=pe[m.type],JSON.stringify(me),m.vb||s.g.xe(S.startTime,S.endTime,m.type),Qj(s,m,0),Aa(Se,0);break;case 2:if(_e=Ba(Se),kf(s.l,_e),s.s)return Se.return();if(m.ua=!1,7001==_e.code)m.ua=!1,Kj(m),Qj(s,m,0),Se.B(0);else if(m.type==E.da&&s.i.ignoreTextStreamFailures)s.h.delete(E.da),Se.B(0);else{if(3017!=_e.code)return m.Nc=!0,_e.severity=2,C(Se,ck(s,m,_e),0);(function lk(o,s,m){if(!Array.from(o.h.values()).some((function(o){return o!=s&&o.De}))){var _=Math.round(100*o.u);if(20<_)o.u-=.2;else{if(!(4<_))return s.Nc=!0,o.s=!0,void o.g.onError(m);o.u-=.04}s.De=!0}Qj(o,s,4)})(s,m,_e),Se.B(0)}}}))}(s,m,_,E).catch((function(){})),null)}(s,m),null!=S&&(Qj(s,m,S),m.Nc=!1),Aa(H,7);break;case 6:return E=Ba(H),C(H,ck(s,m,E),8);case 8:return H.return();case 7:if(A=Array.from(s.h.values()),!s.A||!A.every((function(o){return o.endOfStream}))){H.B(0);break}return C(H,s.g.R.endOfStream(),10);case 10:kf(s.l),0!=(O=s.g.R.getDuration())&&O<s.m.presentationTimeline.getDuration()&&s.m.presentationTimeline.Aa(O),D(H)}}))}function ik(o,s,m,_,S,E){var A,O,H,K,z,G;return I((function(q){switch(q.g){case 1:return A=_.closedCaptions&&0<_.closedCaptions.size,H=null!=_.emsgSchemeIdUris&&0<_.emsgSchemeIdUris.length||o.i.dispatchAllEmsgBoxes,K=o.i.parsePrftBox&&!o.C,(H||K)&&(O=new Gf),H&&O.O("emsg",(function(s){var m=_.emsgSchemeIdUris;if(0===s.version)var E=s.reader.Tc(),A=s.reader.Tc(),O=s.reader.K(),H=s.reader.K(),K=s.reader.K(),z=s.reader.K(),G=S.startTime+H/O;else O=s.reader.K(),H=(G=s.reader.dc()/O+S.timestampOffset)-S.startTime,K=s.reader.K(),z=s.reader.K(),E=s.reader.Tc(),A=s.reader.Tc();s=s.reader.kb(s.reader.getLength()-s.reader.ha()),(m&&m.includes(E)||o.i.dispatchAllEmsgBoxes)&&("urn:mpeg:dash:event:2012"==E?o.g.Tg():((m=new P("emsg",m=(new Map).set("detail",{startTime:G,endTime:G+K/O,schemeIdUri:E,value:A,timescale:O,presentationTimeDelta:H,eventDuration:K,id:z,messageData:s}))).cancelable=!0,o.g.onEvent(m),m.defaultPrevented||"https://aomedia.org/emsg/ID3"!=E&&"https://developer.apple.com/streaming/emsg-id3"!=E||(E=Gh(s)).length&&S&&o.g.Ug([{cueTime:S.startTime,data:s,frames:E,dts:S.startTime,pts:S.startTime}],0,S.endTime)))})),K&&O.O("prft",(function(s){if(!o.C&&S.h.timescale){var m=s.reader,_=s.version;m.K(),s=1e3*(s=m.K())+m.K()/Math.pow(2,32)*1e3,0===_?m=m.K():(_=m.K(),m=m.K(),m=_*Math.pow(2,32)+m),s=new Date(new Date(Date.UTC(1900,0,1,0,0,0)).getTime()+s).getTime(),m=new P("prft",m=(new Map).set("detail",{wallClockTime:s,programStartDate:new Date(s-m/S.h.timescale*1e3)})),o.g.onEvent(m),o.C=!0}})),(H||K)&&O.parse(E),C(q,function mk(o,s,m){var _,S,E;return I((function(A){if(1==A.g)return _=Math.max(o.i.bufferBehind,o.m.presentationTimeline.g),null==(S=ri(o.g.R,s.type))||.01>=(E=m-S-_)?A.return():C(A,o.g.R.remove(s.type,S,S+E),2);kf(o.l),D(A)}))}(o,s,m),2);case 2:return kf(o.l),z=s.Vc,s.Vc=!1,G=s.Xe,s.Xe=!1,C(q,o.g.Ye(s.type,E),3);case 3:return C(q,wi(o.g.R,s.type,E,S,_,A,z,G),4);case 4:kf(o.l),D(q)}}))}function dk(o){return o&&o.type==qt&&("application/cea-608"==o.stream.mimeType||"application/cea-708"==o.stream.mimeType)}function jk(o,s,m,_,S){var E,A,O;return I((function(H){if(1==H.g){if(m instanceof sh&&(E=m.g))return H.return(E);if(A=null,s.za&&m instanceof Q){var K=s.za;if(K.g.has(m)){var z=K.g.get(m);_&&(z.h=_),K.g.delete(m),A=z.g}else A=null}return A||(A=Zj(o,m,s.stream,_,S)),s.ya=A,C(H,A.promise,2)}return O=H.h,s.ya=null,H.return(O.data)}))}function Zj(o,s,m,_,S){S=S?0:1;var E=s instanceof Q?s:void 0;return s=Hj(s.wa(),s.Ba,s.ka,o.i.retryParameters,_),o.g.Hb.request(_r,s,{type:S,stream:m,segment:E})}function Wj(o,s,m,_){var S,E;return I((function(A){return 1==A.g?(s.vb=!1,s.Pd=!1,s.md=0,s.Bc=!0,s.sa=null,s.$b=null,s.ba=null,s.za&&Ej(s.za),_?(S=o.g.sd(),E=o.g.R.getDuration(),C(A,o.g.R.remove(s.type,S+_,E),3)):C(A,Di(o.g.R,s.type),4)):3!=A.g?(kf(o.l),m?C(A,o.g.R.flush(s.type),3):A.B(3)):(kf(o.l),s.Bc=!1,s.endOfStream=!1,s.ua||s.Ya||Qj(o,s,0),void D(A))}))}function Qj(o,s,m){var _=s.type;(_!=qt||o.h.has(_))&&(s.Ya=new cd((function(){var m;return I((function(_){return 1==_.g?(wa(_,2),C(_,ak(o,s),4)):2!=_.g?Aa(_,0):(m=Ba(_),o.g&&o.g.onError(m),void D(_))}))})).S(m))}function Kj(o){null!=o.Ya&&(o.Ya.stop(),o.Ya=null)}function Lj(o){return I((function(s){return o.ya?C(s,o.ya.abort(),0):s.B(0)}))}function ck(o,s,m){var _;return I((function(S){if(1==S.g)return C(S,Ie(o.G),2);kf(o.l),_=0===o.i.maxDisabledTime&&1011==m.code?1:o.i.maxDisabledTime,1===m.category&&0<_&&(m.handled=o.g.$d(s.stream,_),m.handled&&(m.severity=1)),o.g.onError(m),m.handled||o.i.failureCallback(m),D(S)}))}function nk(o,s){var m=ok(),_=this;this.j=s,this.i=o,this.l=m,this.o=null,this.m=[],this.h=this.g=null,this.u=Promise.resolve().then((function(){return function pk(o){return I((function(s){if(o.s.g)s=s.B(0);else{if(0==o.m.length||o.g&&!o.g.Db)var m=!1;else{o.g&&(o.g.Wa.Jb(),o.g=null);var _=(m=o.m.shift()).create(o.l);_?(m.Wa.bc(),o.g={node:_.node,U:_.U,Db:_.Db,Wa:m.Wa}):m.Wa.Jd(),m=!0}m?m=Promise.resolve():o.g?m=function tk(o){var s,m;return I((function(_){switch(_.g){case 1:return o.i=o.j.ug(o.i,o.l,o.g.node,o.g.U),wa(_,2),o.h=o.j.fg(o.i,o.l,o.g.U),C(_,o.h.promise,4);case 4:o.h=null,o.i==o.g.node&&(o.g.Wa.Hd(),o.g=null),Aa(_,0);break;case 2:return 7001==(s=Ba(_)).code?o.g.Wa.Jb():o.g.Wa.onError(s),o.g=null,o.h=null,m=o,C(_,o.j.handleError(o.l,s),5);case 5:m.i=_.h,D(_)}}))}(o):(o.j.Rg(o.i),o.o=new Je,m=o.o),s=C(s,m,1)}return s}))}(_)})),this.s=new jf((function(){return function qk(o){var s,m;return I((function(_){if(1==_.g)return o.h&&o.h.abort(),rk(o),C(_,o.u,2);for(o.g&&o.g.Wa.Jb(),s=t(o.m),m=s.next();!m.done;m=s.next())m.value.Wa.Jb();o.g=null,o.m=[],o.j=null,D(_)}))}(_)}))}function sk(o,s){var m={bc:function bc(){},Hd:function Hd(){},Jb:function Jb(){},onError:function onError(){},Jd:function Jd(){},fi:function fi(){}};return o.m.push({create:s,Wa:m}),o.h&&o.h.abort(),rk(o),m}function rk(o){o.o&&(o.o.resolve(),o.o=null)}function uk(o){if(o.F)return"\n";if(o.g.length)return o.g.map(uk).join("");var s=[],m=700<=o.u,_="italic"==o.o,S=o.h.includes("underline");return m&&s.push(["b"]),_&&s.push(["i"]),S&&s.push(["u"]),m="",(_=vk(o.j))&&(m+="."+_),(_=vk(o.backgroundColor))&&(m+=".bg_"+_),m&&s.push(["c",m]),s.reduceRight((function(o,s){var m=t(s);return"<"+(s=m.next().value)+(void 0===(m=m.next().value)?"":m)+">"+o+"</"+s+">"}),o.U)}function vk(o){switch(o.toLowerCase()){case"white":case"#fff":case"#ffffff":return"white";case"lime":case"#0f0":case"#00ff00":return"lime";case"cyan":case"#0ff":case"#00ffff":return"cyan";case"red":case"#f00":case"#ff0000":return"red";case"yellow":case"#ff0":case"#ffff00":return"yellow";case"magenta":case"#f0f":return"magenta";case"blue":case"#00f":case"#0000ff":return"blue";case"black":case"#000":case"#000000":return"black"}return null}function wk(o,s){for(var m=(o=t(o)).next();!m.done;m=o.next())if((m=m.value).Y)wk(m.g,s);else{var _=m.clone();_.g=[],_.U=uk(m),s.push(_)}return s}function xk(o){this.g=null;for(var s=t(Array.from(o.textTracks)),m=s.next();!m.done;m=s.next())(m=m.value).mode="disabled","Shaka Player TextTrack"==m.label&&(this.g=m);this.g||(this.g=o.addTextTrack("subtitles","Shaka Player TextTrack"),console.log(this.g)),this.g.mode="hidden"}function zk(o){if(o.startTime>=o.endTime)return null;var s=new VTTCue(o.startTime,o.endTime,o.U);s.lineAlign=o.s,s.positionAlign=o.G,o.size&&(s.size=o.size);try{s.align=o.textAlign}catch(o){}return"center"==o.textAlign&&"center"!=s.align&&(s.align="middle"),"vertical-lr"==o.writingMode?s.vertical="lr":"vertical-rl"==o.writingMode&&(s.vertical="rl"),1==o.H&&(s.snapToLines=!1),null!=o.m&&(s.line=o.m),null!=o.position&&(s.position=o.position),s}function yk(o,s){var m=o.mode;o.mode="showing"==m?"showing":"hidden";for(var _=t(Array.from(o.cues)),S=_.next();!S.done;S=_.next())(S=S.value)&&s(S)&&o.removeCue(S);o.mode=m}function Ak(){}function Bk(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function Ck(s,m){var _=this;this.j=!1,this.i=[],this.A=s,this.m=m,this.g=document.createElement("div"),this.g.classList.add("shaka-text-container"),this.g.style.textAlign="center",this.g.style.display="flex",this.g.style.flexDirection="column",this.g.style.alignItems="center",this.g.style.justifyContent="flex-end",this.m.appendChild(this.g),this.u=new dd((function(){Dk(_)})).Ca(.25),this.h=new Map,this.s=new lf,this.s.D(document,"fullscreenchange",(function(){Dk(_,!0)})),this.l=null,"ResizeObserver"in o&&(this.l=new ResizeObserver((function(){Dk(_,!0)})),this.l.observe(this.g)),this.o=new Map}function Ek(o,s){for(;null!=s;){if(s==o.g)return!0;s=s.parentElement}return!1}function Fk(o,s,m,_,S){for(var E=!1,A=[],O=[],H=(s=t(s)).next();!H.done;H=s.next()){H=H.value,S.push(H);var K=o.h.get(H),z=H.startTime<=_&&H.endTime>_,G=K?K.Pf:null;K&&(A.push(K.Zd),K.Uc&&A.push(K.Uc),z||(E=!0,o.h.delete(H),K=null)),z&&(O.push(H),K?Ek(o,G)||(E=!0):(Gk(o,H,S),G=(K=o.h.get(H)).Pf,E=!0)),0<H.g.length&&G&&Fk(o,H.g,G,_,S),S.pop()}if(E){for(S=(_=t(A)).next();!S.done;S=_.next())(S=S.value).parentElement&&S.parentElement.removeChild(S);for(O.sort((function(o,s){return o.startTime!=s.startTime?o.startTime-s.startTime:o.endTime-s.endTime})),H=(O=t(O)).next();!H.done;H=O.next())(_=o.h.get(H.value)).Uc?(m.appendChild(_.Uc),_.Uc.appendChild(_.Zd)):m.appendChild(_.Zd)}}function Dk(o,s){if(o.g){var m=o.A.currentTime;if(!o.j||void 0!==s&&s){for(var _=(s=t(o.o.values())).next();!_.done;_=s.next())Bk(_.value);Bk(o.g),o.h.clear(),o.o.clear()}if(o.j){s=new Map;for(var S=(_=t(o.h.keys())).next();!S.done;S=_.next())S=S.value,s.set(S,o.h.get(S));Fk(o,o.i,o.g,m,[])}}}function Gk(o,s,m){var _=1<m.length,S=_?"span":"div";s.F&&(S="br"),_=!_&&0<s.g.length;var E=document.createElement(S);if("br"!=S&&function Hk(o,s,m,_,S){var E=s.style,A=0==m.g.length,O=1<_.length;E.whiteSpace="pre-wrap";var H=m.U.replace(/\s+$/g,(function(o){return" ".repeat(o.length)}));if(E.webkitTextStrokeColor=m.L,E.webkitTextStrokeWidth=m.ga,E.color=m.j,E.direction=m.direction,E.opacity=m.C,E.paddingLeft=Ik(m.Z,m,o.m),E.paddingRight=Ik(m.Z,m,o.m),E.textShadow=m.I,m.N)E.backgroundImage="url('"+m.N+"')",E.backgroundRepeat="no-repeat",E.backgroundSize="contain",E.backgroundPosition="center",E.width="100%",E.height="100%";else{if(m.g.length)var K=s;else K=document.createElement("span"),s.appendChild(K);m.V&&(K.style.border=m.V),S||((s=function Jk(o,s){for(var m=o.length-1;0<=m;m--){var _=s(o[m]);if(_||0===_)return _}return null}(_,(function(o){return o.backgroundColor})))?K.style.backgroundColor=s:H&&(K.style.backgroundColor="rgba(0, 0, 0, 0.8)")),H&&(K.textContent=H)}O&&!_[_.length-1].Y?E.display="inline":(E.display="flex",E.flexDirection="column",E.alignItems="center",E.justifyContent="before"==m.i?"flex-start":"center"==m.i?"center":"flex-end"),A||(E.margin="0"),E.fontFamily=m.l,E.fontWeight=m.u.toString(),E.fontStyle=m.o,E.letterSpacing=m.W,E.fontSize=Ik(m.A,m,o.m),null!=m.m&&1==m.H&&(E.position="absolute",m.writingMode==He?(E.width="100%",m.s==rt?E.top=m.m+"%":"end"==m.s&&(E.bottom=100-m.m+"%")):"vertical-lr"==m.writingMode?(E.height="100%",m.s==rt?E.left=m.m+"%":"end"==m.s&&(E.right=100-m.m+"%")):(E.height="100%",m.s==rt?E.right=m.m+"%":"end"==m.s&&(E.left=100-m.m+"%"))),E.lineHeight=m.aa,null!=m.position&&(m.writingMode==He?E.paddingLeft=m.position:E.paddingTop=m.position),"line-left"==m.G?E.cssFloat="left":"line-right"==m.G&&(E.cssFloat="right"),E.textAlign=m.textAlign,E.textDecoration=m.h.join(" "),E.writingMode=m.writingMode,"writingMode"in document.documentElement.style&&E.writingMode==m.writingMode||(E.webkitWritingMode=m.writingMode),m.size&&(m.writingMode==He?E.width=m.size+"%":E.height=m.size+"%")}(o,E,s,m,_),m=null,s.region&&s.region.id)if(S=(m=s.region).id+"_"+m.width+"x"+m.height+(m.i==dt?"%":"px")+"-"+m.g+"x"+m.h+(m.j==dt?"%":"px"),o.o.has(S))m=o.o.get(S);else{var A=document.createElement("span"),O=m.i==dt?"%":"px",H=m.l==dt?"%":"px",K=m.j==dt?"%":"px";A.id="shaka-text-region---"+S,A.classList.add("shaka-text-region"),A.style.height=m.height+O,A.style.width=m.width+H,A.style.position="absolute",A.style.top=m.h+K,A.style.left=m.g+K,A.style.display="flex",A.style.flexDirection="column",A.style.alignItems="center",A.style.justifyContent="before"==s.i?"flex-start":"center"==s.i?"center":"flex-end",o.o.set(S,A),m=A}S=E,_&&((S=document.createElement("span")).classList.add("shaka-text-wrapper"),S.style.backgroundColor=s.backgroundColor,S.style.lineHeight="normal",E.appendChild(S)),o.h.set(s,{Zd:E,Pf:S,Uc:m})}function Ik(o,s,m){var _=(_=new RegExp(/(\d*\.?\d+)([a-z]+|%+)/).exec(o))?{value:Number(_[1]),unit:_[2]}:null;if(!_)return o;var S=_.value;switch(_.unit){case"%":return S/100*m.clientHeight/s.X.rows+"px";case"c":return m.clientHeight*S/s.X.rows+"px";default:return o}}function Lk(o,s){this.h=o,this.g=s,this.j="",this.o=void 0,this.i=!1,this.m=!0,this.l=!1}function Nk(s){return s.j||(s.j=s.g.sessionId||o.crypto.randomUUID()),{v:1,sf:s.o,sid:s.j,cid:s.g.contentId,mtp:s.h.getBandwidthEstimate()/1e3}}function Sk(o,s,m){m=void 0===m?{}:m;var _=void 0===_?o.g.useHeaders:_;if(o.g.enabled){Object.assign(m,Nk(o)),m.pr=o.h.rd();var S=m.ot===Va||m.ot===za;if(o.l&&S&&(m.bs=!0,m.su=!0,o.l=!1),null==m.su&&(m.su=o.m),_)o=function Uk(o){for(var s=Object.keys(o),m={},_=["Object","Request","Session","Status"],S=[{},{},{},{}],E={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},A=(s=t(s)).next();!A.done;A=s.next())A=A.value,S[null!=E[A]?E[A]:1][A]=o[A];for(o=0;o<S.length;o++)(E=Qk(S[o]))&&(m["CMCD-"+_[o]]=E);return m}(m),Object.keys(o).length&&Object.assign(s.headers,o);else{var E=Qk(m);E&&(s.uris=s.uris.map((function(o){return Rk(o,E)})))}}}function Qk(o){function b(o){return 100*c(o/100)}function c(o){return Math.round(o)}function d(o){return!Number.isNaN(o)&&null!=o&&""!==o&&!1!==o}for(var s=[],m={br:c,d:c,bl:b,dl:b,mtp:b,nor:function nor(o){return encodeURIComponent(o)},rtp:b,tb:c},_=Object.keys(o||{}).sort(),S=(_=t(_)).next();!S.done;S=_.next()){var E=o[S=S.value];if(d(E)&&("v"!==S||1!==E)&&("pr"!=S||1!==E)){var A=m[S];A&&(E=A(E));var O;O="string"===(A=typeof E)&&"ot"!==S&&"sf"!==S&&"st"!==S?S+"="+JSON.stringify(E):"boolean"===A?S:"symbol"===A?S+"="+E.description:S+"="+E,s.push(O)}}return s.join(",")}function Rk(o,s){return!s||o.includes("offline:")?o:((o=new bc(o)).g.set("CMCD",s),o.toString())}Cj.prototype.abort=function(){this.g&&this.g.abort()},(_=Ij.prototype).destroy=function(){return this.l.destroy()},_.configure=function(o){this.i=o,this.G=new Ge({maxAttempts:Math.max(o.retryParameters.maxAttempts,2),baseDelay:o.retryParameters.baseDelay,backoffFactor:o.retryParameters.backoffFactor,fuzzFactor:o.retryParameters.fuzzFactor,timeout:0,stallTimeout:0,connectionTimeout:0},!0);for(var s=t(this.h.keys()),m=s.next();!m.done;m=s.next())if((m=this.h.get(m.value)).za){var _=m.za,S=o.segmentPrefetchLimit;_.j=S;for(var E=Array.from(_.g.keys());E.length>S;){var A=E.pop();A&&Fj(_,A)}0<o.segmentPrefetchLimit||(m.za=null)}else 0<o.segmentPrefetchLimit&&(m.za=Mj(this,m.stream))},_.start=function(){var o=this;return I((function(s){if(1==s.g)return C(s,function Nj(o){var s,m,_,S,E,A,O,H;return I((function(K){if(1==K.g){if(s=Jt,!o.j)throw new N(2,5,5006);return m=new Map,_=new Set,o.j.audio&&(m.set(s.qb,o.j.audio),_.add(o.j.audio)),o.j.video&&(m.set(s.va,o.j.video),_.add(o.j.video)),o.o&&(m.set(s.da,o.o),_.add(o.o)),C(K,o.g.R.init(m,o.m.sequenceMode,o.m.type,o.m.ignoreManifestTimestampsInSegmentsMode),2)}for(kf(o.l),o.updateDuration(),S=t(m.keys()),E=S.next();!E.done;E=S.next())A=E.value,O=m.get(A),o.h.has(A)||(H=Pj(o,O),o.h.set(A,H),Qj(o,H,0));D(K)}))}(o),2);kf(o.l),o.A=!0,D(s)}))},_.Vc=function(){if(this.g)for(var o=this.g.sd(),s=t(this.h.keys()),m=s.next();!m.done;m=s.next()){var _=m.value,S=null;(m=this.h.get(_)).ba&&(S=m.ba.current()),(!S||S.startTime>o||S.endTime<o)&&(m.ba=null),(S=this.g.R).o?S=!1:_==qt?S=null!=(S=S.g).g&&null!=S.h&&(o>=S.g&&o<S.h):S=xh(S=si(S,_),o),S||((null!=ti(this.g.R,_)||m.ua)&&Yj(this,m),m.ya&&(m.ya.abort(),m.ya=null),_===qt&&((_=this.g.R).F&&_.F.i()),m.Vc=!0)}},_.updateDuration=function(){var o=this.m.presentationTimeline.getDuration();1/0>o?this.g.R.Aa(o):this.g.R.Aa(Math.pow(2,32))},nk.prototype.destroy=function(){return this.s.destroy()},(_=xk.prototype).remove=function(o,s){return!!this.g&&(yk(this.g,(function(m){return m.startTime<s&&m.endTime>o})),!0)},_.append=function(o){var s=wk(o,[]),m=[];o=this.g.cues?Array.from(this.g.cues):[];for(var _={},S=(s=t(s)).next();!S.done;_={Ob:_.Ob},S=s.next())_.Ob=S.value,o.some(function(o){return function(s){return s.startTime==o.Ob.startTime&&s.endTime==o.Ob.endTime&&s.text==o.Ob.U}}(_))||(S=zk(_.Ob))&&m.push(S);for(o=m.slice().sort((function(o,s){return o.startTime!=s.startTime?o.startTime-s.startTime:o.endTime!=s.endTime?o.endTime-s.startTime:"line"in VTTCue.prototype?m.indexOf(s)-m.indexOf(o):m.indexOf(o)-m.indexOf(s)})),_=(o=t(o)).next();!_.done;_=o.next())this.g.addCue(_.value)},_.destroy=function(){return this.g&&(yk(this.g,(function(){return!0})),this.g.mode="disabled"),this.g=null,Promise.resolve()},_.isTextVisible=function(){return"showing"==this.g.mode},_.setTextVisibility=function(o){this.g.mode=o?"showing":"hidden"},L("shaka.text.SimpleTextDisplayer",xk),xk.prototype.setTextVisibility=xk.prototype.setTextVisibility,xk.prototype.isTextVisible=xk.prototype.isTextVisible,xk.prototype.destroy=xk.prototype.destroy,xk.prototype.append=xk.prototype.append,xk.prototype.remove=xk.prototype.remove,L("shaka.util.Dom",Ak),Ak.removeAllChildren=Bk,(_=Ck.prototype).append=function(o){for(var s=[].concat(v(this.i)),m={},_=(o=t(o)).next();!_.done;m={ad:m.ad},_=o.next())m.ad=_.value,s.some(function(o){return function(s){return Jb(s,o.ad)}}(m))||this.i.push(m.ad);Dk(this)},_.destroy=function(){this.m.removeChild(this.g),this.g=null,this.j=!1,this.i=[],this.u&&this.u.stop(),this.h.clear(),this.s&&(this.s.release(),this.s=null),this.l&&(this.l.disconnect(),this.l=null)},_.remove=function(o,s){if(!this.g)return!1;var m=this.i.length;return this.i=this.i.filter((function(m){return m.startTime<o||m.endTime>=s})),Dk(this,m>this.i.length),!0},_.isTextVisible=function(){return this.j},_.setTextVisibility=function(o){this.j=o},L("shaka.text.UITextDisplayer",Ck),Ck.prototype.setTextVisibility=Ck.prototype.setTextVisibility,Ck.prototype.isTextVisible=Ck.prototype.isTextVisible,Ck.prototype.remove=Ck.prototype.remove,Ck.prototype.destroy=Ck.prototype.destroy,Ck.prototype.append=Ck.prototype.append,L("shaka.text.WebVttGenerator",(function(){})),Lk.prototype.configure=function(o){this.g=o};var Ra="m",ja="a",Va="v",za="av",qa="i",Qa="c",Za="tt";function bl(){}function cl(o,s,m,_,S){var E,A=S in _,O=!0;for(E in s){var H=S+"."+E,K=A?_[S]:m[E];A||E in m?void 0===s[E]?void 0===K||A?delete o[E]:o[E]=Ue(K):K.constructor==Object&&s[E]&&s[E].constructor==Object?(o[E]||(o[E]=Ue(K)),H=cl(o[E],s[E],K,_,H),O=O&&H):typeof s[E]!=typeof K||null==s[E]||"function"!=typeof s[E]&&s[E].constructor!=K.constructor?(Ya("Invalid config, wrong type for "+H),O=!1):("function"==typeof m[E]&&m[E].length!=s[E].length&&$a("Unexpected number of arguments for "+H),o[E]=s[E]):(Ya("Invalid config, unrecognized key "+H),O=!1)}return O}function dl(o,s){for(var m={},_=m,S=0,E=0;!(0>(S=o.indexOf(".",S)));)0!=S&&"\\"==o[S-1]||(_[E=o.substring(E,S).replace(/\\\./g,".")]={},_=_[E],E=S+1),S+=1;return _[o.substring(E).replace(/\\\./g,".")]=s,m}function el(o,s){return o&&s}function fl(){}function gl(o){return new bc(o=Af(o)).Sa}function hl(o,s,m){function d(o){pb(S).setUint32(E,o.byteLength,!0),E+=4,S.set(M(o),E),E+=o.byteLength}if(!m||!m.byteLength)throw new N(2,6,6015);var _;_="string"==typeof s?Cf(s,!0):s,o=Cf(o=Af(o),!0);var S=new Uint8Array(12+o.byteLength+_.byteLength+m.byteLength),E=0;return d(o),d(_),d(m),S}function il(o,s,m){return"skd"!==s?o:(s=m.serverCertificate,hl(o,m=Af(o).split("skd://").pop(),s))}function jl(o,s){2===o&&(s.headers["Content-Type"]="application/octet-stream")}function kl(){}function ll(){var o=1/0;navigator.connection&&navigator.connection.saveData&&(o=360);var s={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,persistentSessionOnlinePlayback:!1,persistentSessionsMetadata:[],initDataTransform:function initDataTransform(o,s,m){return"com.apple.fps.1_0"==m.keySystem&&"skd"==s&&(s=m.serverCertificate,o=hl(o,m=gl(o),s)),o},logLicenseExchange:!1,updateExpirationTime:1,preferredKeySystems:[],keySystemsMapping:{},parseInbandPsshEnabled:id(),minHdcpVersion:""},m={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,disableThumbnails:!1,defaultPresentationDelay:0,segmentRelativeVttTiming:!1,raiseFatalErrorOnManifestUpdateRequestFailure:!1,dash:{clockSyncUri:"",ignoreDrmInfo:!1,disableXlinkProcessing:!1,xlinkFailGracefully:!1,ignoreMinBufferTime:!1,autoCorrectDrift:!0,initialSegmentLimit:1e3,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1,ignoreMaxSegmentDuration:!1,keySystemsByURI:{"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},manifestPreprocessor:function manifestPreprocessor(o){return el([o],o)},sequenceMode:!1},hls:{ignoreTextStreamFailures:!1,ignoreImageStreamFailures:!1,defaultAudioCodec:"mp4a.40.2",defaultVideoCodec:"avc1.42E01E",ignoreManifestProgramDateTime:!1,mediaPlaylistFullMimeType:'video/mp2t; codecs="avc1.42E01E, mp4a.40.2"',useSafariBehaviorForLive:!0,liveSegmentsDelay:3,sequenceMode:!(jd("Tizen 3")||jd("Tizen 2")||ld()||nd()),ignoreManifestTimestampsInSegmentsMode:!1},mss:{manifestPreprocessor:function manifestPreprocessor(o){return el([o],o)},sequenceMode:!1,keySystemsBySystemId:{"9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","79f0049a-4098-8642-ab92-e65be0885f95":"com.microsoft.playready"}}},_={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:3e4,stallTimeout:5e3,connectionTimeout:1e4},failureCallback:function failureCallback(o){return el([o])},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,gapDetectionThreshold:.5,gapJumpTimerTime:.25,durationBackoff:1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0,inaccurateManifestTolerance:2,lowLatencyMode:!1,autoLowLatencyMode:!1,forceHTTPS:!1,preferNativeHls:!1,updateIntervalSeconds:1,dispatchAllEmsgBoxes:!1,observeQualityChanges:!1,maxDisabledTime:30,parsePrftBox:!1,segmentPrefetchLimit:0,liveSync:!1,liveSyncMaxLatency:1,liveSyncPlaybackRate:1.1};(jd("Web0S")||kd()||jd("CrKey"))&&(_.stallSkip=0);var S={trackSelectionCallback:function trackSelectionCallback(o){return I((function(s){return s.return(o)}))},downloadSizeCallback:function downloadSizeCallback(o){var s;return I((function(m){return 1==m.g?navigator.storage&&navigator.storage.estimate?C(m,navigator.storage.estimate(),3):m.return(!0):(s=m.h,m.return(s.usage+o<.95*s.quota))}))},progressCallback:function progressCallback(o,s){return el([o,s])},usePersistentLicense:!0,numberOfParallelDownloads:5},E={drm:s,manifest:m,streaming:_,mediaSource:{sourceBufferExtraFeatures:"",forceTransmux:!1,insertFakeEncryptionInInit:!0},offline:S,abrFactory:function abrFactory(){return new je},abr:{enabled:!0,useNetworkInformation:!0,defaultBandwidthEstimate:1e6,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:o,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},advanced:{minTotalBytes:128e3,minBytes:16e3,fastHalfLife:2,slowHalfLife:5},restrictToElementSize:!1,restrictToScreenSize:!1,ignoreDevicePixelRatio:!1,clearBufferSwitch:!1,safeMarginSwitch:0},autoShowText:3,preferredAudioLanguage:"",preferredAudioLabel:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,preferredVideoHdrLevel:"AUTO",preferredVideoCodecs:[],preferredAudioCodecs:[],preferForcedSubs:!1,preferredDecodingAttributes:[],restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function textDisplayFactory(){return null},cmcd:{enabled:!1,sessionId:"",contentId:"",useHeaders:!1},lcevc:{enabled:!1,dynamicPerformanceScaling:!0,logLevel:0,drawLogo:!1},ads:{customPlayheadTracker:!1}};return S.trackSelectionCallback=function(o){return I((function(s){return s.return(function ml(o,s){var m=o.filter((function(o){return"variant"==o.type})),_=[],S=ad(s,m.map((function(o){return o.language})));S&&(_=m.filter((function(o){return Uc(o.language)==S}))),0==_.length&&(_=m.filter((function(o){return o.primary}))),0==_.length&&(m.map((function(o){return o.language})),_=m);var E=_.filter((function(o){return o.height&&480>=o.height}));for(E.length&&(E.sort((function(o,s){return s.height-o.height})),_=E.filter((function(o){return o.height==E[0].height}))),s=[],_.length&&(m=Math.floor(_.length/2),_.sort((function(o,s){return o.bandwidth-s.bandwidth})),s.push(_[m])),o=t(o),_=o.next();!_.done;_=o.next())(_=_.value).type!=qt&&"image"!=_.type||s.push(_);return s}(o,E.preferredAudioLanguage))}))},E}function nl(o,s,m){var _={".drm.keySystemsMapping":"",".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",sessionType:"",serverCertificate:new Uint8Array(0),serverCertificateUri:"",individualizationServer:""}};return cl(o,s,m||ll(),_,"")}function ol(){this.g=null,this.h=[]}function pl(o,s){if(null==o.g)o.g={timestamp:Date.now()/1e3,state:s,duration:0};else{var m=Date.now()/1e3;o.g.duration=m-o.g.timestamp,o.g.state!=s&&(o.h.push(o.g),o.g={timestamp:m,state:s,duration:0})}}function ql(o,s){var m=0;o.g&&o.g.state==s&&(m+=o.g.duration);for(var _=(o=t(o.h)).next();!_.done;_=o.next())m+=(_=_.value).state==s?_.duration:0;return m}function sl(){this.i=this.h=null,this.g=[]}function tl(o,s,m){o.i!=s&&(o.i=s,o.g.push({timestamp:Date.now()/1e3,id:s.id,type:"text",fromAdaptation:m,bandwidth:null}))}function ul(){this.u=this.A=this.G=this.C=this.s=this.j=this.F=this.m=this.i=this.M=this.N=this.H=this.I=this.L=this.l=this.o=NaN,this.g=new ol,this.h=new sl}function T(s,m){Te.call(this);var _=this;this.l=oo,this.nd=this.h=null,this.Y=!1,this.yd=new lf,this.xc=new lf,this.o=new lf,this.jc=this.i=this.zd=this.I=this.j=this.ga=this.L=this.Nf=this.V=this.Na=this.M=this.ud=this.H=this.Rb=this.A=this.G=this.m=this.F=null,this.Fc=!1,this.oe=this.s=null,this.Be=1e9,this.g=wl(this),this.Ae={width:1/0,height:1/0},this.u=null,this.Za=new xe(this.g.preferredAudioLanguage,this.g.preferredVariantRole,this.g.preferredAudioChannelCount,this.g.preferredVideoHdrLevel),this.Pb=this.g.preferredTextLanguage,this.Ec=this.g.preferredTextRole,this.Ac=this.g.preferForcedSubs,this.zc=[],this.Gc=null,m&&m(this),this.V=function xl(o){return new Lk({getBandwidthEstimate:function getBandwidthEstimate(){return o.s?o.s.getBandwidthEstimate():NaN},cb:function cb(){return o.cb()},getCurrentTime:function getCurrentTime(){return o.h?o.h.currentTime:0},rd:function rd(){return o.rd()},zb:function zb(){return o.zb()},Cb:function Cb(){return o.Cb()},T:function T(){return o.T()}},o.g.cmcd)}(this),this.F=function yl(o){return new Ye((function(s,m){o.s&&o.s.segmentDownloaded(s,m)}),(function(s,m,_){s=(new Map).set("headers",s).set("request",m).set("requestType",_),o.dispatchEvent(Ll("downloadheadersreceived",s))}),(function(s,m,_,S){s=(new Map).set("request",s).set("error",m).set("httpResponseCode",_).set("aborted",S),o.dispatchEvent(Ll("downloadfailed",s))}),(function(s,m,_){var S=o.V;if(_=void 0===_?{}:_,S.g.enabled)if("HEAD"===m.method)Sk(S,m);else switch(s){case 0:try{if(S.g.enabled){if(_.type){e:{switch(_.type){case 4:var E="d";break e;case 3:case 2:E="h";break e;case 5:E="s";break e}E=void 0}S.o=E}Sk(S,m,{ot:Ra,su:!S.i})}}catch(o){ab("CMCD_MANIFEST_ERROR","Could not generate manifest CMCD data.",o)}break;case _r:s=_;try{if(S.g.enabled){var A=s.segment;E=0,A&&(E=A.endTime-A.startTime);var O={d:1e3*E,st:S.h.T()?"l":"v"};O.ot=function Vk(o){if(0===o.type)return qa;if(o=o.stream){var s=o.type;if("video"==s)return o.codecs&&o.codecs.includes(",")?za:Va;if("audio"==s)return ja;if("text"==s)return"application/mp4"===o.mimeType?Za:Qa}}(s);var H=O.ot===Va||O.ot===ja||O.ot===za||O.ot===Za,K=s.stream;K&&(H&&(O.bl=function $k(o,s){if(!(s=o.h.cb()[s]).length)return NaN;var m=o.h.getCurrentTime();return(o=s.find((function(o){return o.start<=m&&o.end>=m})))?1e3*(o.end-m):NaN}(S,K.type)),K.bandwidth&&(O.br=K.bandwidth/1e3)),H&&O.ot!==Za&&(O.tb=function al(o,s){var m=o.h.Cb();if(!m.length)return NaN;o=m[0];for(var _=(m=t(m)).next();!_.done;_=m.next())"variant"===(_=_.value).type&&_.bandwidth>o.bandwidth&&(o=_);switch(s){case Va:return o.videoBandwidth||NaN;case ja:return o.audioBandwidth||NaN;default:return o.bandwidth}}(S,O.ot)/1e3),Sk(S,m,O)}}catch(o){ab("CMCD_SEGMENT_ERROR","Could not generate segment CMCD data.",o)}break;case 2:case 5:case 6:Sk(S,m,{ot:"k"});break;case 4:Sk(S,m,{ot:"o"})}}))}(this),this.F.Le(this.g.streaming.forceHTTPS),this.C=null,To&&(this.C=To()),this.yd.D(o,"online",(function(){Al(_),_.Ee()})),this.N={name:"detach"},this.W={name:"attach"},this.aa={name:"unload"},this.Fe={name:"manifest-parser"},this.ye={name:"manifest"},this.Qb={name:"media-source"},this.se={name:"drm-engine"},this.X={name:"load"},this.Pe={name:"src-equals-drm-engine"},this.Sb={name:"src-equals"};var S=new Map;S.set(this.W,(function(o,s){return Oe(function Bl(o,s,m){return null==s.mediaElement&&(s.mediaElement=m.mediaElement,o.xc.D(s.mediaElement,"error",(function(){var s=Ul(o);s&&Vl(o,s)}))),o.h=s.mediaElement,Promise.resolve()}(_,o,s))})),S.set(this.N,(function(o){return o.mediaElement&&(_.xc.sb(),o.mediaElement=null),_.C&&_.C.release(),_.h=null,Oe(o=Promise.resolve())})),S.set(this.aa,(function(o){return Oe(Cl(_,o))})),S.set(this.Qb,(function(o){return o=function Dl(o,s){var m,_,S,E,A;return I((function(O){if(1==O.g)return m=o.g.textDisplayFactory,_=m(),o.ve=m,S=function Xl(o,s,m,_){return new ii(o,s,m,_)}(s.mediaElement,_,(function(s,m,_){Yl(o,s,m,_)}),o.L),S.configure(o.g.mediaSource),E=o.g.manifest,A=E.segmentRelativeVttTiming,S.M=A,C(O,S.G,2);o.G=S,D(O)}))}(_,o),Oe(o)})),S.set(this.Fe,(function(o,s){return o=function El(o,s,m){var _,S,E,A;return I((function(O){if(1==O.g)return s.mimeType=m.mimeType,s.uri=m.uri,_=s.uri,S=o.F,o.jc=_,E=o,C(O,jh(_,S,o.g.manifest.retryParameters,s.mimeType),2);E.zd=O.h,o.I=o.zd(),A=Ue(o.g.manifest),m.mediaElement&&"AUDIO"===m.mediaElement.nodeName&&(A.disableVideo=!0),o.I.configure(A),D(O)}))}(_,o,s),Oe(o)})),S.set(this.ye,(function(o){return function Fl(o,s){var m=s.uri;s=o.F,o.Na=new uj((function(){return o.ec()})),o.Na.addEventListener("regionadd",(function(s){s=s.region,Zl(o,"timelineregionadded",s),o.C&&o.C.onDashTimedMetadata(s)})),o.ga=null,o.g.streaming.observeQualityChanges&&(o.ga=new qj((function(){return o.cb()})),o.ga.addEventListener("qualitychange",(function(s){var m=s.quality;s=s.position,m=(new Map).set("mediaQuality",{bandwidth:m.bandwidth,audioSamplingRate:m.audioSamplingRate,codecs:m.codecs,contentType:m.contentType,frameRate:m.frameRate,height:m.height,mimeType:m.mimeType,channelsCount:m.channelsCount,pixelAspectRatio:m.pixelAspectRatio,width:m.width}).set("position",s),o.dispatchEvent(Ll("mediaqualitychanged",m))})));var _={networkingEngine:s,filter:function filter(s){return $l(o,s)},makeTextStreamsForClosedCaptions:function makeTextStreamsForClosedCaptions(s){return function am(o,s){for(var m=new Set,_=t(s.textStreams),S=_.next();!S.done;S=_.next())"application/cea-608"!=(S=S.value).mimeType&&"application/cea-708"!=S.mimeType||m.add(S.originalId);for(_=t(s.variants),S=_.next();!S.done;S=_.next())if((S=S.value.video)&&S.closedCaptions)for(var E=t(S.closedCaptions.keys()),A=E.next();!A.done;A=E.next())if(A=A.value,!m.has(A)){var O=A.startsWith("CC")?"application/cea-608":"application/cea-708",H=new lj,K=S.closedCaptions.get(A);O={id:o.Be++,originalId:A,createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},segmentIndex:H,mimeType:O,codecs:"",kind:"caption",encrypted:!1,drmInfos:[],keyIds:new Set,language:K,originalLanguage:K,label:null,type:qt,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:S.roles,forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1},s.textStreams.push(O),m.add(A)}}(o,s)},onTimelineRegionAdded:function onTimelineRegionAdded(s){var m=o.Na;e:{for(var _=t(m.g),S=_.next();!S.done;S=_.next())if((S=S.value).schemeIdUri==s.schemeIdUri&&S.id==s.id&&S.startTime==s.startTime&&S.endTime==s.endTime){_=S;break e}_=null}null==_&&(m.g.add(s),s=new P("regionadd",new Map([["region",s]])),m.dispatchEvent(s))},onEvent:function onEvent(s){return o.dispatchEvent(s)},onError:function onError(s){return Vl(o,s)},isLowLatencyMode:function isLowLatencyMode(){return o.g.streaming.lowLatencyMode},isAutoLowLatencyMode:function isAutoLowLatencyMode(){return o.g.streaming.autoLowLatencyMode},enableLowLatencyMode:function enableLowLatencyMode(){o.configure("streaming.lowLatencyMode",!0)},updateDuration:function updateDuration(){o.j&&o.j.updateDuration()},newDrmInfo:function newDrmInfo(s){var m=o.m?o.m.g:null;m&&o.m.s&&bm(o,m.keySystem,s)}},S=Date.now()/1e3;return new Ke(function(){var s,E,A,O;return I((function(H){if(1==H.g)return s=o,C(H,o.I.start(m,_),2);if(s.i=H.h,E=Ll("manifestparsed"),o.dispatchEvent(E),0==o.i.variants.length)throw new N(2,4,4036);!function cm(o){function b(o){return o.video&&o.audio||o.video&&o.video.codecs.includes(",")}o.variants.some(b)&&(o.variants=o.variants.filter(b))}(o.i),A=Date.now()/1e3,O=A-S,o.u.F=O,D(H)}))}(),(function(){return o.I.stop()}))}(_,o)})),S.set(this.se,(function(o){return o=function Gl(o,s){var m,_;return I((function(S){return 1==S.g?(m=Date.now()/1e3,_=!0,o.m=dm(o,{Hb:o.F,onError:function onError(s){Vl(o,s)},Id:function Id(s){em(o,s)},onExpirationUpdated:function onExpirationUpdated(s,m){fm(o,s,m)},onEvent:function onEvent(s){o.dispatchEvent(s),"drmsessionupdate"==s.type&&_&&(_=!1,o.u.j=Date.now()/1e3-m,o.L&&((s=o.L).g&&s.h.classList.add("shaka-hidden")))}}),o.m.configure(o.g.drm),C(S,Bg(o.m,o.i.variants,o.i.offlineSessionIds),2)):3!=S.g?C(S,o.m.yc(s.mediaElement),3):C(S,$l(o,o.i),0)}))}(_,o),Oe(o)})),S.set(this.X,(function(o,s){return Oe(function Hl(o,s,m){var _,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee;return I((function(De){switch(De.g){case 1:for(s.startTime=m.startTime,null!=o.Gc&&(s.startTime=o.Gc,o.Gc=null),_=s.mediaElement,S=s.uri,o.jc=S,o.H=new mj({td:function td(){return _.playbackRate},pd:function pd(){return _.defaultPlaybackRate},Ne:function Ne(o){_.playbackRate=o},wf:function wf(o){_.currentTime+=o}}),E=function f(){return gm(o)},A=function g(){return hm(o)},o.o.D(_,"playing",E),o.o.D(_,"pause",E),o.o.D(_,"ended",E),o.o.D(_,"ratechange",A),function Ol(o,s){if(s.lcevc.enabled){var m=o.Cb();m&&m[0]&&m[0].videoMimeType==Co.ts&&(hd()||navigator.userAgent.match(/Edge\//))&&(s.mediaSource.forceTransmux||$a("LCEVC Warning: For MPEG-2 TS decoding the config.mediaSource.forceTransmux must be enabled.")),Nl(o),null==o.L&&(o.L=new di(o.h,o.Nf,s.lcevc),o.G&&(o.G.L=o.L))}else Nl(o)}(o,o.g),O=o.g.abrFactory,o.s&&o.oe==O||(o.oe=O,o.s=O(),"function"!=typeof o.s.setMediaElement&&(oe("AbrManager","Please use an AbrManager with setMediaElement function."),o.s.setMediaElement=function(){}),o.s.configure(o.g.abr)),o.Za=new xe(o.g.preferredAudioLanguage,o.g.preferredVariantRole,o.g.preferredAudioChannelCount,o.g.preferredVideoHdrLevel,o.g.preferredAudioLabel),o.Pb=o.g.preferredTextLanguage,o.Ec=o.g.preferredTextRole,o.Ac=o.g.preferForcedSubs,im(o.i.presentationTimeline,o.g.playRangeStart,o.g.playRangeEnd),o.s.init((function(s,m,_){o.j&&s!=o.j.j&&jm(o,s,!0,void 0!==m&&m,void 0===_?0:_)})),o.s.setMediaElement(_),sd(o.i,o.g.preferredVideoCodecs,o.g.preferredAudioCodecs,o.g.preferredAudioChannelCount,o.g.preferredDecodingAttributes),o.j=function km(o){return new Ij(o.i,{sd:function sd(){return o.A?o.A.gd():0},getBandwidthEstimate:function getBandwidthEstimate(){return o.s.getBandwidthEstimate()},R:o.G,Hb:o.F,onError:function onError(s){return Vl(o,s)},onEvent:function onEvent(s){return o.dispatchEvent(s)},Tg:function Tg(){o.I&&o.I.update&&o.I.update()},xe:function xe(s,m,_){o.A&&o.A.xf(),Fm(o),s=(new Map).set("start",s).set("end",m).set("contentType",_),o.dispatchEvent(Ll("segmentappended",s))},Sg:function Sg(s,m){(m=m.qe)&&o.ga&&function sj(o,s,m){var _=function rj(o,s){var m=o.g.get(s);return m||(m={Sc:[],cf:null,contentType:s},o.g.set(s,m)),m}(o,s.contentType);!function tj(o,s){if((o=o.h()[s.contentType])&&0<o.length){var m=o[0].start,_=o[o.length-1].end,S=s.Sc;s.Sc=S.filter((function(o,s){return!(o.position<=m&&s+1<S.length&&S[s+1].position<=m||o.position>=_)}))}else s.Sc=[]}(o,_),o={qe:s,position:m},s=(_=_.Sc).findIndex((function(o){return o.position>=m})),0<=s?_.splice(s,_[s].position==m?1:0,o):_.push(o)}(o.ga,m,s)},Ye:function Ye(s,m){var _=o.m;if(_.h.parseInbandPsshEnabled&&!_.I&&["audio","video"].includes(s)){var S=0,E=t((m=new Xf(M(m))).data);for(s=E.next();!s.done;s=E.next())S+=s.value.length;if(0==S)_=Promise.resolve();else{for(S=new Uint8Array(S),E=0,s=(m=t(m.data)).next();!s.done;s=m.next())s=s.value,S.set(s,E),E+=s.length;Kg(_,"cenc",S),_=_.l}}else _=Promise.resolve();return _},Ug:function Ug(s,m,_){Yl(o,s,m,_)},$d:function $d(s,m){return o.$d(s,m)}})}(o),o.j.configure(o.g.streaming),o.l=lo,_.textTracks&&o.o.D(_.textTracks,"addtrack",(function(s){if(s.track&&"chapters"===(s=s.track).kind)mm(o,s)})),o.dispatchEvent(Ll("streaming")),H=null,(K=o.j.j)||(H=nm(o)?o.s.chooseVariant():null),z=[],q=t([(G=K||H).video,G.audio]),X=q.next();!X.done;X=q.next())(J=X.value)&&!J.segmentIndex&&z.push(J.createSegmentIndex());if(!(0<z.length)){De.B(2);break}return C(De,Promise.all(z),2);case 2:if(im(o.i.presentationTimeline,o.g.playRangeStart,o.g.playRangeEnd),o.A=function om(o,s){return new cj(o.h,o.i,o.g.streaming,s,(function(){o.Rb&&pj(o.Rb,!0),o.j&&o.j.Vc(),o.M&&Fm(o)}),(function(s){return o.dispatchEvent(s)}))}(o,s.startTime),o.Rb=function pm(o,s){s=new vj(o.Na,o.T()||0<s),s.addEventListener("enter",(function(s){Zl(o,"timelineregionenter",s.region)})),s.addEventListener("exit",(function(s){Zl(o,"timelineregionexit",s.region)})),s.addEventListener("skip",(function(s){var m=s.region;s.seeking||(Zl(o,"timelineregionenter",m),Zl(o,"timelineregionexit",m))}));var m=new oj(o.h);return m.g.add(s),o.ga&&m.g.add(o.ga),m}(o,s.Nd),ae=Math.max(o.i.minBufferTime,o.g.streaming.rebufferingGoal),qm(o,ae),K){De.B(4);break}if(jm(o,H,!0,!1,0),!o.g.streaming.startAtSegmentBoundary){De.B(4);break}return pe=o.A.gd(),C(De,function rm(o,s){var m,_,S,E,A;return I((function(O){return 1==O.g?(m=o.audio,_=o.video,S=function e(o,s){var m,_,S;return I((function(E){return 1==E.g?o?C(E,o.createSegmentIndex(),2):E.return(null):(_=(m=o.segmentIndex.yb(s))?m.next().value:null)?(S=_.startTime,E.return(S)):E.return(null)}))},C(O,S(m,s),2)):3!=O.g?(E=O.h,C(O,S(_,s),3)):null!=(A=O.h)&&null!=E?O.return(Math.max(A,E)):null!=A?O.return(A):null!=E?O.return(E):O.return(s)}))}(H,pe),6);case 6:me=De.h,o.A.Yd(me);case 4:return o.A.Xd(),_e=o.Zb().find((function(o){return o.active})),_e||((Se=ge(o.i.textStreams,o.Pb,o.Ec,o.Ac)[0]||null)&&tl(o.u.h,Se,!0),H&&(Se?(H.audio&&function sm(o,s,m){if(0==o.g.autoShowText)return!1;if(1==o.g.autoShowText)return!0;var _=Uc(o.g.preferredTextLanguage);return m=Uc(m.language),2==o.g.autoShowText?Tc(m,_):3==o.g.autoShowText?(o=Uc(s.language),Tc(m,_)&&!Tc(o,m)):($a("Invalid autoShowText setting!"),!1)}(o,H.audio,Se)&&(o.Y=!0),o.Y&&o.G.u.setTextVisibility(!0),tm(o)):o.Y=!1),Se&&(o.g.streaming.alwaysStreamText||o.ie())&&Vj(o.j,Se)),C(De,o.j.start(),7);case 7:o.g.abr.enabled&&(o.s.enable(),um(o)),Id(o.j?o.j.j:null,o.i),vm(o.i),wm(o),nm(o),o.i.variants.some((function(o){return o.primary})),o.T()&&(o.g.streaming.liveSync||o.i.serviceDescription)&&(Ee=function B(){return xm(o)},o.o.D(_,"timeupdate",Ee)),o.Fc=!0,o.o.la(_,"loadedmetadata",(function(){o.u.m=Date.now()/1e3-m.Nd})),D(De)}}))}(_,o,s))})),S.set(this.Pe,(function(o,s){return o=function Il(o,s,m){var _,S,E,A,O,H,K;return I((function(z){return 1==z.g?(_=Jt,S=Date.now()/1e3,E=!0,o.m=dm(o,{Hb:o.F,onError:function onError(s){Vl(o,s)},Id:function Id(s){em(o,s)},onExpirationUpdated:function onExpirationUpdated(s,m){fm(o,s,m)},onEvent:function onEvent(s){o.dispatchEvent(s),"drmsessionupdate"==s.type&&E&&(E=!1,o.u.j=Date.now()/1e3-S)}}),o.m.configure(o.g.drm),A=m.uri||"",O=lh(A),"application/x-mpegurl"==(H=Co[O])&&md()&&(H="application/vnd.apple.mpegurl"),H||(H="video/mp4"),K={id:0,language:"und",disabledUntilTime:0,primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},segmentIndex:null,mimeType:m.mimeType?m.mimeType.split(";")[0]:H,codecs:m.mimeType?Jc(m.mimeType):"",encrypted:!0,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:_.va,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1},bandwidth:100,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},o.m.X=!0,C(z,Bg(o.m,[K],[]),2)):C(z,o.m.yc(s.mediaElement),0)}))}(_,o,s),Oe(o)})),S.set(this.Sb,(function(o,s){return function Jl(o,s,m){function d(){return gm(o)}s.uri=m.uri,s.startTime=m.startTime,o.jc=s.uri;var _=s.mediaElement;o.A=new bj(_);var S=!1;o.zc.push((function(){S=!0})),null!=s.startTime&&o.A.Yd(s.startTime),o.H=new mj({td:function td(){return _.playbackRate},pd:function pd(){return _.defaultPlaybackRate},Ne:function Ne(o){_.playbackRate=o},wf:function wf(o){_.currentTime+=o}}),qm(o,o.g.streaming.rebufferingGoal),o.o.D(_,"playing",d),o.o.D(_,"pause",d),o.o.D(_,"ended",d),o.o.D(_,"ratechange",(function(){return hm(o)})),"none"!=_.preload&&o.o.la(_,"loadedmetadata",(function(){o.u.m=Date.now()/1e3-m.Nd})),_.audioTracks&&(o.o.D(_.audioTracks,"addtrack",(function(){return wm(o)})),o.o.D(_.audioTracks,"removetrack",(function(){return wm(o)})),o.o.D(_.audioTracks,"change",(function(){return wm(o)}))),_.textTracks&&(o.o.D(_.textTracks,"addtrack",(function(s){if(s.track)switch(s=s.track,s.kind){case"metadata":!function ym(o,s){if("metadata"==s.kind){s.mode="hidden",o.o.D(s,"cuechange",(function(){if(s.activeCues)for(var m=t(s.activeCues),_=m.next();!_.done;_=m.next())_=_.value,Dm(o,_.startTime,_.endTime,_.type,_.value),o.C&&o.C.onCueMetadataChange(_.value)}));var m=new dd((function(){for(var s=function Em(o){return Array.from(o.h.textTracks).filter((function(o){return"metadata"==o.kind}))}(o),m=(s=t(s)).next();!m.done;m=s.next())m.value.mode="hidden"})).ic().S(.5);o.zc.push((function(){m.stop()}))}}(o,s);break;case"chapters":mm(o,s);break;default:wm(o)}})),o.o.D(_.textTracks,"removetrack",(function(){return wm(o)})),o.o.D(_.textTracks,"change",(function(){return wm(o)})));var E=lh(s.uri);_.src=function Mk(o,s,m){try{if(!o.g.enabled)return s;var _=Nk(o);e:{switch(m){case"video/webm":case"video/mp4":var S=za;break e;case"application/x-mpegurl":S=Ra;break e}S=void 0}return _.ot=S,_.su=!0,Rk(s,Qk(_))}catch(o){return ab("CMCD_SRC_ERROR","Could not generate src CMCD data.",o),s}}(o.V,s.uri,Co[E]),(kd()||jd("Web0S"))&&_.load(),o.l=ho,o.dispatchEvent(Ll("streaming"));var A=new Je;return Ti(_,HTMLMediaElement.HAVE_METADATA,o.o,(function(){o.A.Xd(),A.resolve()})),Ti(_,HTMLMediaElement.HAVE_CURRENT_DATA,o.o,(function(){var s;return I((function(m){return 1==m.g?(function Am(o){var s=o.g.preferredAudioLanguage;if(""!=s){o.Ie(s);var m=o.g.preferredVariantRole;""!=m&&o.Ie(s,m)}}(o),(s=Bm(o)).find((function(o){return"disabled"!=o.mode}))?(0<s.length&&(o.Y=!0),m.B(2)):C(m,new Promise((function(s){o.o.la(_.textTracks,"change",s),new dd(s).S(1)})),2)):S?m.return():(function Cm(o){var s=o.g.preferredTextLanguage,m=o.g.preferForcedSubs;if(""!=s){o.Je(s,"",m);var _=o.g.preferredTextRole;""!=_&&o.Je(s,_,m)}}(o),void D(m))}))})),_.error?A.reject(Ul(o)):"none"==_.preload&&($a('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),A.resolve()),o.o.la(_,"error",(function(){A.reject(Ul(o))})),new Ke(A,(function(){return A.reject(new N(2,7,7001)),Promise.resolve()})).fa((function(){o.T()&&o.g.streaming.liveSync&&o.o.D(_,"timeupdate",(function(){return xm(o)})),o.Fc=!0}))}(_,o,s)})),this.Oa=new nk(this.N,{ug:function ug(o,s,m,S){var E=null;return o==_.N&&(E=m==_.N?_.N:_.W),o==_.W&&(E=m==_.N||s.mediaElement!=S.mediaElement?_.N:m==_.W?_.W:m==_.Qb||m==_.X?_.Qb:m==_.Sb?_.Pe:null),o==_.Qb&&(E=m==_.X&&s.mediaElement==S.mediaElement?_.Fe:_.aa),o==_.Fe&&(E=Kl(_.X,_.ye,_.aa,m,s,S)),o==_.ye&&(E=Kl(_.X,_.se,_.aa,m,s,S)),o==_.se&&(E=Kl(_.X,_.X,_.aa,m,s,S)),o==_.Pe&&(E=m==_.Sb&&s.mediaElement==S.mediaElement?_.Sb:_.aa),o!=_.X&&o!=_.Sb||(E=_.aa),o==_.aa&&(E=S.mediaElement&&s.mediaElement==S.mediaElement?_.W:_.N),E},fg:function fg(o,s,m){return _.dispatchEvent(Ll("onstatechange",(new Map).set("state",o.name))),S.get(o)(s,m)},handleError:function handleError(o){return I((function(s){return 1==s.g?C(s,Cl(_,o),2):s.return(o.mediaElement?_.W:_.N)}))},Rg:function Rg(o){_.dispatchEvent(Ll("onstateidle",(new Map).set("state",o.name)))}}),this.wd=new dd((function(){return function Ml(o){function b(o){var s="";return o.video&&(s+="video:"+o.video.id),o.audio&&(s=s+(s?"&":"")+"audio:"+o.audio.id),s}for(var s=Date.now()/1e3,m=!1,_=t(o.i.variants),S=_.next();!S.done;S=_.next())0<(S=S.value).disabledUntilTime&&S.disabledUntilTime<=s&&(S.disabledUntilTime=0,m=!0,b(S));o.i.variants.every((function(o){return 0===o.disabledUntilTime}))&&o.wd.stop(),m&&Im(o,!0,void 0,!1,!1)}(_)})),s&&this.yc(s,!0)}function Nl(o){null!=o.L&&(o.L.release(),o.L=null)}function Ll(o,s){return new P(o,s)}function Cl(o,s){var m,_,S,E,A,O,H,K,z;return I((function(G){switch(G.g){case 1:return o.l!=ro&&(o.l=oo),m=o.zc.map((function(o){return o()})),o.zc=[],C(G,Promise.all(m),2);case 2:if(o.dispatchEvent(Ll("unloading")),s.mimeType=null,s.startTime=null,s.uri=null,o.Na&&(o.Na.release(),o.Na=null),s.mediaElement&&o.o.sb(),o.wd.stop(),o.Rb&&(o.Rb.release(),o.Rb=null),o.ud&&(o.ud.stop(),o.ud=null),!o.I){G.B(3);break}return C(G,o.I.stop(),4);case 4:o.I=null,o.zd=null;case 3:if(!o.s){G.B(5);break}return C(G,o.s.stop(),5);case 5:if(!o.j){G.B(7);break}return C(G,o.j.destroy(),8);case 8:o.j=null;case 7:if(o.H&&(o.H.release(),o.H=null),o.A&&(o.A.release(),o.A=null),!o.G){G.B(9);break}return C(G,o.G.destroy(),10);case 10:o.G=null;case 9:if(o.C&&o.C.onAssetUnload(),!s.mediaElement||!s.mediaElement.src){G.B(11);break}return C(G,new Promise((function(o){return new dd(o).S(.1)})),12);case 12:for(s.mediaElement.removeAttribute("src"),s.mediaElement.load();s.mediaElement.lastChild;)s.mediaElement.removeChild(s.mediaElement.firstChild);case 11:if(!o.m){G.B(13);break}return C(G,o.m.destroy(),14);case 14:o.m=null;case 13:if(o.jc=null,o.M=null,o.i){for(_=t(o.i.variants),S=_.next();!S.done;S=_.next())for(E=S.value,A=t([E.audio,E.video]),O=A.next();!O.done;O=A.next())(H=O.value)&&H.segmentIndex&&H.segmentIndex.release();for(K=t(o.i.textStreams),O=K.next();!O.done;O=K.next())(z=O.value).segmentIndex&&z.segmentIndex.release()}o.i=null,o.u=new ul,o.ve=null,Wl(o),D(G)}}))}function Yl(o,s,m,_){for(var S=(s=t(s)).next();!S.done;S=s.next())if((S=S.value).data&&S.cueTime&&S.frames){var E=S.cueTime+m,A=_;A&&E>A&&(A=E);for(var O=t(S.frames),H=O.next();!H.done;H=O.next())Dm(o,E,A,"org.id3",H.value);o.C&&o.C.onHlsTimedMetadata(S,E)}}function Dm(o,s,m,_,S){s=(new Map).set("startTime",s).set("endTime",m).set("metadataType",_).set("payload",S),o.dispatchEvent(Ll("metadata",s))}function mm(o,s){if(s&&"chapters"==s.kind){s.mode="hidden";var m=new dd((function(){s.mode="hidden"})).ic().S(.5);o.zc.push((function(){m.stop()}))}}function dm(o,s){return new ug(s,o.g.drm.updateExpirationTime)}function qm(o,s){o.M=new Ce,o.M.g=qn,Fe(o.M,s,Math.min(.5,s/2)),Wl(o),o.ud=new dd((function(){Fm(o)})).Ca(.25)}function Fm(o){switch(o.l){case ho:if(o.h.ended)var s=!0;else{var m=wh(o.h.buffered);s=null!=m&&m>=o.h.duration-1}break;case lo:e:if(o.h.ended||qi(o.G))s=!0;else{if(o.i.presentationTimeline.T()){m=o.i.presentationTimeline.Ab();var _=wh(o.h.buffered);if(null!=_&&_>=m){s=!0;break e}}s=!1}break;default:s=!1}_=yh(o.h.buffered,o.h.currentTime);var S=s,E=(m=o.M).h.get(m.g);s=m.g,_=S||_>=E?ar:qn,m.g=_,s!=_&&Wl(o)}function Gm(o){if(o.I){var s=Ue(o.g.manifest);o.h&&"AUDIO"===o.h.nodeName&&(s.disableVideo=!0),o.I.configure(s)}if(o.m&&o.m.configure(o.g.drm),o.j){o.j.configure(o.g.streaming);try{Hm(o,o.i)}catch(s){Vl(o,s)}o.s&&nm(o),!(s=o.j.j)||s.allowedByApplication&&s.allowedByKeySystem||Im(o)}if(o.F&&o.F.Le(o.g.streaming.forceHTTPS),o.G&&(o.G.configure(o.g.mediaSource),o.G.M=o.g.manifest.segmentRelativeVttTiming,s=o.g.textDisplayFactory,o.ve!=s)){var m=s(),_=o.G,S=_.u;_.u=m,S&&(m.setTextVisibility(S.isTextVisible()),S.destroy()),_.g&&(_.g.j=m),o.ve=s,o.j&&((m=(s=o.j).h.get(qt))&&Tj(s,m.stream,!0,0,!0))}o.s&&(o.s.configure(o.g.abr),o.g.abr.enabled?o.s.enable():o.s.disable(),um(o)),o.M&&(s=o.g.streaming.rebufferingGoal,o.i&&(s=Math.max(s,o.i.minBufferTime)),Fe(o.M,s,Math.min(.5,s/2))),o.i&&im(o.i.presentationTimeline,o.g.playRangeStart,o.g.playRangeEnd),o.C&&o.C.configure(o.g.ads),o.V&&o.V.configure(o.g.cmcd)}function Bm(o){return Array.from(o.h.textTracks).filter((function(o){return"metadata"!=o.kind&&"chapters"!=o.kind&&"Shaka Player TextTrack"!=o.label}))}function Nm(o){return Array.from(o.h.textTracks).filter((function(o){return"chapters"==o.kind}))}function Om(o,s){var m,_;return I((function(S){switch(S.g){case 1:return m=lh(s),(_=Eo[m])?S.return(_):(wa(S,2),C(S,nh(s,o.F,o.g.streaming.retryParameters),4));case 4:_=S.h,Aa(S,3);break;case 2:Ba(S);case 3:if(_)return S.return(_);throw new N(1,2,2011,m)}}))}function Pm(o,s,m,_,S,E,A){var O,H,K,z;return I((function(G){if(1==G.g)return"text/vtt"!=S||A.length?C(G,Qm(o,s,o.F,o.g.streaming.retryParameters),3):G.B(2);2!=G.g&&(O=G.h,H=Rm(o,O,S,A),K=new Blob([H],{type:"text/vtt"}),s=ma(K),S="text/vtt"),z=document.createElement("track");var q=o.V,X=s;try{if(q.g.enabled){var J=Nk(q);J.ot=Qa,J.su=!0;var ae=Rk(X,Qk(J))}else ae=X}catch(o){ab("CMCD_TEXT_TRACK_ERROR","Could not generate text track CMCD data.",o),ae=X}return z.src=ae,z.label=E,z.kind=_,z.srclang=m,o.h.getAttribute("crossorigin")||o.h.setAttribute("crossorigin","anonymous"),o.h.appendChild(z),G.return(z)}))}function Qm(o,s,m,_){var S,E,A;return I((function(O){if(1==O.g){S=_r,(E=bf([s],_)).method="GET";var H=o.V;try{H.g.enabled&&Sk(H,E,{ot:Qa,su:!0})}catch(o){ab("CMCD_TEXT_ERROR","Could not generate text CMCD data.",o)}return C(O,m.request(S,E).promise,2)}return A=O.h,O.return(A.data)}))}function Rm(o,s,m,_){var S=rn[m];if(S)return m=S(),o={periodStart:0,segmentStart:0,segmentEnd:o.h.duration,vttOffset:0},s=M(s),function Kk(o,s){function c(o){for(var m=o,_=t(s),S=_.next();!S.done;S=_.next())(S=S.value).end&&S.start<o&&(m+=S.end-S.start);return(10>(o=Math.floor(m/3600))?"0":"")+o+":"+(10>(_=Math.floor(m/60%60))?"0":"")+_+":"+(10>(S=Math.floor(m%60))?"0":"")+S+"."+(100>(m=Math.floor(1e3*m%1e3))?10>m?"00":"0":"")+m}var m=wk(o,[]);o="WEBVTT\n\n";for(var _=(m=t(m)).next();!_.done;_=m.next())o+=c((_=_.value).startTime)+" --\x3e "+c(_.endTime)+function(o){var s=[];switch(o.textAlign){case"left":s.push("align:left");break;case"right":s.push("align:right");break;case _e:s.push("align:middle");break;case"start":s.push("align:start");break;case"end":s.push("align:end")}switch(o.writingMode){case"vertical-lr":s.push("vertical:lr");break;case"vertical-rl":s.push("vertical:rl")}return s.length?" "+s.join(" "):""}(_)+"\n",o+=_.U+"\n\n";return o}(s=m.parseMedia(s,o),_);throw new N(2,2,2014,m)}function wl(o){var s=ll();return s.streaming.failureCallback=function(s){if(o.T()){var m=null;1001==s.code||1002==s.code?m=1:1003==s.code&&(m=.1),null!=m&&(s.severity=1,o.Ee(m))}},s.textDisplayFactory=function(){return o.nd?new Ck(o.h,o.nd):new xk(o.h)},s}function $l(o,s){return I((function(m){if(1==m.g)return C(m,function Tm(o,s){return I((function(m){if(1==m.g)return C(m,Gd(o.j?o.j.j:null,s),2);vm(s),D(m)}))}(o,s),2);Hm(o,s),D(m)}))}function Hm(o,s){if(o.l!=ro){for(var m=o.g.restrictions,_=o.Ae,S=!1,E=t(s.variants),A=E.next();!A.done;A=E.next()){var O=(A=A.value).allowedByApplication;A.allowedByApplication=Fd(A,m,_),O!=A.allowedByApplication&&(S=!0)}if(S&&o.j&&wm(o),(m=o.m?o.m.g:null)&&o.m.s)for(S=(_=t(s.variants)).next();!S.done;S=_.next())S=S.value,bm(o,m.keySystem,S.video),bm(o,m.keySystem,S.audio);Um(o,s)}}function bm(o,s,m){if(m)for(var _=(m=t(m.drmInfos)).next();!_.done;_=m.next())if((_=_.value).keySystem==s)for(var S=(_=t(_.initData||[])).next();!S.done;S=_.next())S=S.value,Kg(o.m,S.initDataType,S.initData)}function Wl(o){var s=o.ge();if(o.u&&o.M&&o.A){var m=o.H;m.j=s,nj(m),o.V&&(m=o.V,s||m.i||(m.i=!0),m.i&&s&&(m.l=!0),m.m=s),gm(o)}s=(new Map).set("buffering",s),o.dispatchEvent(Ll("buffering",s))}function hm(o){var s=o.h.playbackRate;0!=s&&(o.H&&o.H.set(s),s=Ll("ratechange"),o.dispatchEvent(s))}function gm(o){if(o.u&&o.M){var s=o.u.g;o.M.g==qn?pl(s,"buffering"):o.h.paused?pl(s,"paused"):o.h.ended?pl(s,"ended"):pl(s,"playing")}}function xm(o){if(o.T()){var s=o.ec();if(Number.isFinite(s.end)&&!(o.h.currentTime<s.start)){if(o.g.streaming.liveSync)var m=o.g.streaming.liveSyncMaxLatency,_=o.g.streaming.liveSyncPlaybackRate;else o.i&&o.i.serviceDescription&&(m=o.i.serviceDescription.maxLatency||o.g.streaming.liveSyncMaxLatency,_=o.i.serviceDescription.maxPlaybackRate||o.g.streaming.liveSyncPlaybackRate);var S=o.h.playbackRate,E=s.end-o.h.currentTime,A=0;if(o.l==ho){var O=o.h.buffered;0<O.length&&(A=O.end(O.length-1),A=Math.max(_,A-s.end))}m&&_&&E-A>m?S!=_&&o.Mf(_):1!==S&&0!==S&&o.Ze()}}}function nm(o){try{Um(o,o.i)}catch(s){return Vl(o,s),!1}var s=fe(o.i.variants);return s=o.Za.create(s),o.s.setVariants(Array.from(s.values())),!0}function Im(o,s,m,_,S){var E;s=void 0===s||s,m=void 0===m?0:m,_=void 0!==_&&_,S=void 0===S||S,(E=nm(o)?o.s.chooseVariant():null)&&jm(o,E,S,s,m,_)}function jm(o,s,m,_,S,E){E=void 0!==E&&E;var A=o.j.j;if(s==A)_&&Uj(o.j,s,_,S,!0);else{var O=o.u.h;O.h!=s&&(O.h=s,O.g.push({timestamp:Date.now()/1e3,id:s.id,type:"variant",fromAdaptation:m,bandwidth:s.bandwidth})),Uj(o.j,s,_,S,E,m),_=null,A&&(_=Xd(A)),s=Xd(s),m?(m=(new Map).set("oldTrack",_).set("newTrack",s),o.L&&ei(o.L,s),Vm(o,m=Ll("adaptation",m))):Wm(o,_,s)}}function Km(o,s){var m=Array.from(o.h.audioTracks).find((function(o){return o.enabled}));s.enabled=!0,s.id!==m.id&&(m.enabled=!1),Wm(o,m=de(m),s=de(s))}function wm(o){Vm(o,Ll("trackschanged"))}function Wm(o,s,m){s=(new Map).set("oldTrack",s).set("newTrack",m),o.L&&ei(o.L,m),Vm(o,m=Ll("variantchanged",s))}function Jm(o){Vm(o,Ll("textchanged"))}function tm(o){Vm(o,Ll("texttrackvisibility"))}function um(o){o.g.abr.enabled||Al(o),Vm(o,Ll("abrstatuschanged",(new Map).set("newStatus",o.g.abr.enabled)))}function Al(o,s){if(s=void 0===s||s,o.l==lo){o.wd.stop();for(var m=t(o.i.variants),_=m.next();!_.done;_=m.next())_.value.disabledUntilTime=0;s&&nm(o)}}function Vl(o,s){if(o.l!=ro){2===s.severity&&Al(o,!1);var m=Ll("error",(new Map).set("detail",s));o.dispatchEvent(m),m.defaultPrevented&&(s.handled=!0)}}function Zl(o,s,m){m=(new Map).set("detail",{schemeIdUri:m.schemeIdUri,value:m.value,startTime:m.startTime,endTime:m.endTime,id:m.id,eventElement:m.eventElement}),o.dispatchEvent(Ll(s,m))}function Ul(o){if(!o.h.error)return null;var s=o.h.error.code;if(1==s)return null;var m=o.h.error.msExtendedCode;return m&&(0>m&&(m+=Math.pow(2,32)),m=m.toString(16)),new N(2,3,3016,s,m,o.h.error.message)}function em(o,s){if(o.j){var m=Object.keys(s),_=1==m.length&&"00"==m[0],S=!1;if(m.length)for(var E=(m=t(o.i.variants)).next();!E.done;E=m.next()){var A=[];(E=E.value).audio&&A.push(E.audio),E.video&&A.push(E.video);for(var O=(A=t(A)).next();!O.done;O=A.next()){var H=O.value;if(O=E.allowedByKeySystem,H.keyIds.size){E.allowedByKeySystem=!0;for(var K=(H=t(H.keyIds)).next();!K.done;K=H.next())K=K.value,K=s[_?"00":K],E.allowedByKeySystem=E.allowedByKeySystem&&!!K&&!_o.includes(K)}O!=E.allowedByKeySystem&&(S=!0)}}S&&!nm(o)||((s=o.j.j)&&!s.allowedByKeySystem&&Im(o),S&&wm(o))}}function fm(o,s,m){o.I&&o.I.onExpirationUpdated&&o.I.onExpirationUpdated(s,m),s=Ll("expirationupdated"),o.dispatchEvent(s)}function im(o,s,m){0<s&&(o.T()||o.Jf(s)),m<(s=o.getDuration())&&(o.T()||o.Aa(m))}function Um(o,s){o=o.m?o.m.qd():{};var m=Object.keys(o);m=m.length&&"00"==m[0];for(var _=!1,S=!1,E=new Set,A=new Set,O=(s=t(s.variants)).next();!O.done;O=s.next()){var H=[];(O=O.value).audio&&H.push(O.audio),O.video&&H.push(O.video);for(var K=(H=t(H)).next();!K.done;K=H.next())if((K=K.value).keyIds.size)for(var z=(K=t(K.keyIds)).next();!z.done;z=K.next()){z=z.value;var G=o[m?"00":z];G?_o.includes(G)&&A.add(G):E.add(z)}O.allowedByApplication?O.allowedByKeySystem&&(_=!0):S=!0}if(!_)throw new N(2,4,4012,o={hasAppRestrictions:S,missingKeys:Array.from(E),restrictedKeyStatuses:Array.from(A)})}function vm(o){if(!o.variants.some(ee))throw new N(2,4,4032)}function Vm(o,s){I((function(m){if(1==m.g)return C(m,Promise.resolve(),2);o.l!=ro&&o.dispatchEvent(s),D(m)}))}function Mm(o){for(var s=new Set,m=(o=t(o)).next();!m.done;m=o.next())(m=m.value).language?s.add(Uc(m.language)):s.add("und");return s}function Lm(o){for(var s=new Map,m=new Map,_=(o=t(o)).next();!_.done;_=o.next()){var S="und",E=[];(_=_.value).language&&(S=Uc(_.language)),(E="variant"==_.type?_.audioRoles:_.roles)&&E.length||(E=[""]),s.has(S)||s.set(S,new Set);for(var A=(E=t(E)).next();!A.done;A=E.next())A=A.value,s.get(S).add(A),_.label&&(m.has(S)||m.set(S,new Map),m.get(S).set(A,_.label))}var O=[];return s.forEach((function(o,s){for(var _=(o=t(o)).next();!_.done;_=o.next()){_=_.value;var S=null;m.has(s)&&m.get(s).has(_)&&(S=m.get(s).get(_)),O.push({language:s,role:_,label:S})}})),O}function Rl(){return new N(2,7,7e3)}function Kl(o,s,m,_,S,E){return _==o&&S.mediaElement==E.mediaElement&&S.uri==E.uri&&S.mimeType==E.mimeType?s:m}function ok(){return{mediaElement:null,mimeType:null,startTime:null,Nd:NaN,uri:null}}function Sl(o){return new Promise((function(s,m){o.Jb=function(){return m(Rl())},o.Hd=function(){return s()},o.onError=function(o){return m(o)},o.Jd=function(){return m(Rl())}}))}L("shaka.util.CmcdManager.StreamingFormat",{DASH:"d",HLS:"h",Oh:"s",OTHER:"o"}),L("shaka.util.ConfigUtils",bl),bl.convertToConfigObject=dl,bl.mergeConfigObjects=cl,L("shaka.util.FairPlayUtils",fl),fl.commonFairPlayResponse=function(o,s){if(2===o){try{var m=xf(s.data)}catch(o){return}o=!1,"<ckc>"===(m=m.trim()).substr(0,5)&&"</ckc>"===m.substr(-6)&&(m=m.slice(5,-6),o=!0);try{var _=JSON.parse(m);_.ckc&&(m=_.ckc,o=!0),_.CkcMessage&&(m=_.CkcMessage,o=!0),_.License&&(m=_.License,o=!0)}catch(o){}o&&(s.data=nb(Tf(m)))}},fl.expressplayFairPlayRequest=function(o,s){jl(o,s)},fl.conaxFairPlayRequest=function(o,s){jl(o,s)},fl.ezdrmFairPlayRequest=function(o,s){jl(o,s)},fl.verimatrixFairPlayRequest=function(o,s){2===o&&(o=Sf(o=M(s.body)),s.headers["Content-Type"]="application/x-www-form-urlencoded",s.body=Bf("spc="+o))},fl.expressplayInitDataTransform=function(o,s,m){return il(o,s,m)},fl.conaxInitDataTransform=function(s,m,_){if("skd"!==m)return s;m=_.serverCertificate,_=Af(s).split("skd://").pop().split("?").shift(),_=o.atob(_);var S=new ArrayBuffer(2*_.length);S=new Uint16Array(S);for(var E=0,A=_.length;E<A;E++)S[E]=_.charCodeAt(E);return hl(s,S,m)},fl.ezdrmInitDataTransform=function(o,s,m){return"skd"!==s?o:(s=m.serverCertificate,hl(o,m=Af(o).split(";").pop(),s))},fl.verimatrixInitDataTransform=function(o,s,m){return il(o,s,m)},fl.initDataTransform=hl,fl.defaultGetContentId=gl,fl.isFairPlaySupported=function(){var o;return I((function(s){return 1==s.g?(o={initDataTypes:["cenc","sinf","skd"],videoCapabilities:[{contentType:'video/mp4; codecs="avc1.42E01E"'}]},wa(s,2),C(s,navigator.requestMediaKeySystemAccess("com.apple.fps",[o]),4)):2!=s.g?s.return(!0):(Ba(s),s.return(!1))}))},L("shaka.util.PlayerConfiguration",kl),kl.mergeConfigObjects=nl,kl.createDefault=ll,ra(T,Te),(_=T.prototype).destroy=function(){var o,s=this;return I((function(m){switch(m.g){case 1:return s.l==ro?m.return():(Nl(s),s.l=ro,o=sk(s.Oa,(function(){return{node:s.N,U:ok(),Db:!1}})),C(m,new Promise((function(s){o.bc=function(){},o.Hd=function(){s()},o.Jb=function(){s()},o.onError=function(){s()},o.Jd=function(){s()}})),2));case 2:return C(m,s.Oa.destroy(),3);case 3:if(s.yd&&(s.yd.release(),s.yd=null),s.xc&&(s.xc.release(),s.xc=null),s.o&&(s.o.release(),s.o=null),s.oe=null,s.g=null,s.u=null,s.nd=null,s.V=null,!s.F){m.B(4);break}return C(m,s.F.destroy(),5);case 5:s.F=null;case 4:s.s&&(s.s.release(),s.s=null),Te.prototype.release.call(s),D(m)}}))},_.yc=function(o,s){if(s=void 0===s||s,this.l==ro)return Promise.reject(Rl());var m=ok();m.mediaElement=o,ed()||(s=!1);var _=s?this.Qb:this.W;return(o=sk(this.Oa,(function(){return{node:_,U:m,Db:!1}}))).bc=function(){},Sl(o)},_.Vf=function(o){this.Nf=o},_.detach=function(){var o=this;if(this.l==ro)return Promise.reject(Rl());var s=sk(this.Oa,(function(){return{node:o.N,U:ok(),Db:!1}}));return s.bc=function(){},Sl(s)},_.Se=function(o){var s=this;if(o=void 0===o||o,this.l==ro)return Promise.reject(Rl());this.Fc=!1,ed()||(o=!1),Nl(this);var m=ok(),_=sk(this.Oa,(function(_){var S=_.mediaElement&&o?s.Qb:_.mediaElement?s.W:s.N;return m.mediaElement=_.mediaElement,{node:S,U:m,Db:!1}}));return _.bc=function(){},Sl(_)},_.qh=function(o){this.Gc=o},_.load=function(o,s,m){var _=this;if(this.Gc=null,this.Fc=!1,this.l==ro)return Promise.reject(Rl());this.dispatchEvent(Ll("loading"));var S=ok();S.uri=o,S.Nd=Date.now()/1e3,m&&(S.mimeType=m),void 0!==s&&(S.startTime=s);var E=function Tl(o,s){if(!ed())return!0;var m=s.mimeType,_=s.uri||"";if(m||(m=lh(_),m=Co[m]),m){if(""==(s.mediaElement||gd()).canPlayType(m))return!1;if(!ed()||!(m in na)&&!(lh(_)in aa)||("application/x-mpegurl"===m||"application/vnd.apple.mpegurl"===m)&&o.g.streaming.preferNativeHls)return!0;if(md())return o.g.streaming.useNativeHlsOnSafari}return!1}(this,S)?this.Sb:this.X,A=sk(this.Oa,(function(o){return null==o.mediaElement?null:(S.mediaElement=o.mediaElement,{node:E,U:S,Db:!0})}));return this.u=new ul,A.bc=function(){},new Promise((function(o,s){A.Jd=function(){return s(new N(2,7,7002))},A.Hd=function(){o(),_.dispatchEvent(Ll("loaded"))},A.Jb=function(){return s(Rl())},A.onError=function(o){return s(o)}}))},_.configure=function(o,s){2==arguments.length&&"string"==typeof o&&(o=dl(o,s)),o.streaming&&"forceTransmuxTS"in o.streaming&&(oe("streaming.forceTransmuxTS configuration","Please Use mediaSource.forceTransmux instead."),o.mediaSource.mediaSource=o.streaming.forceTransmuxTS,delete o.streaming.forceTransmuxTS),o.streaming&&"forceTransmux"in o.streaming&&(oe("streaming.forceTransmux configuration","Please Use mediaSource.forceTransmux instead."),o.mediaSource.mediaSource=o.streaming.forceTransmux,delete o.streaming.forceTransmux),o.streaming&&o.streaming.lowLatencyMode&&(null==o.streaming.inaccurateManifestTolerance&&(o.streaming.inaccurateManifestTolerance=0),null==o.streaming.rebufferingGoal&&(o.streaming.rebufferingGoal=.01),null==o.streaming.segmentPrefetchLimit&&(o.streaming.segmentPrefetchLimit=2));var m=nl(this.g,o,wl(this));return Gm(this),m},_.getConfiguration=function(){var o=wl(this);return nl(o,this.g,wl(this)),o},_.ig=function(){if(this.h){var o=this.h.buffered.length;o=o?this.h.buffered.end(o-1):0;var s=this.getConfiguration().streaming.bufferingGoal;if(o>=(s=Math.min(this.h.currentTime+s,this.ec().end)))return 1;if(!(o<=this.h.currentTime)&&o<s)return(o-this.h.currentTime)/(s-this.h.currentTime)}return 0},_.dh=function(){for(var o in this.g)delete this.g[o];nl(this.g,wl(this),wl(this)),Gm(this)},_.og=function(){return this.l},_.rg=function(){return this.i?this.i.type:null},_.tg=function(){return this.h},_.zb=function(){return this.F},_.ce=function(){return this.jc},_.jf=function(){return this.C?this.C:null},_.T=function(){return this.i?this.i.presentationTimeline.T():!(!this.h||!this.h.src)&&1/0==this.h.duration},_.Fb=function(){return!!this.i&&this.i.presentationTimeline.Fb()},_.Jg=function(){if(this.i){var o=this.i.variants;return!!o.length&&!o[0].video}return!(!this.h||!this.h.src)&&(this.h.videoTracks?0==this.h.videoTracks.length:0==this.h.videoHeight)},_.ec=function(){if(!this.Fc)return{start:0,end:0};if(this.i){var o=this.i.presentationTimeline;return{start:o.Yb(),end:o.eb()}}return this.h&&this.h.src&&(o=this.h.seekable).length?{start:o.start(0),end:o.end(o.length-1)}:{start:0,end:0}},_.Gg=function(){this.T()&&(this.h.currentTime=this.ec().end)},_.keySystem=function(){var o=this.drmInfo();return o?o.keySystem:""},_.drmInfo=function(){return this.m?this.m.g:null},_.Ic=function(){return this.m?this.m.Ic():1/0},_.be=function(){return this.m?this.m.be():[]},_.qd=function(){return this.m?this.m.qd():{}},_.ge=function(){return!!this.M&&this.M.g==qn},_.rd=function(){return this.h?this.H?this.H.i:1:0},_.Mf=function(o){0==o?$a("A trick play rate of 0 is unsupported!"):(this.h.paused&&this.h.play(),this.H.set(o),this.l==lo&&(this.s.playbackRateChanged(o),Sj(this.j,1<Math.abs(o))))},_.Ze=function(){var o=this.H.pd();this.l==ho&&this.H.set(o),this.l==lo&&(this.H.set(o),this.s.playbackRateChanged(o),Sj(this.j,!1))},_.Cb=function(){if(this.i){for(var o=this.j?this.j.j:null,s=[],m=0,_=t(this.i.variants),S=_.next();!S.done;S=_.next())if(ee(S=S.value)){var E=Xd(S);E.active=S==o,E.active||1==m||null==o||S.video!=o.video||S.audio!=o.audio||(E.active=!0),E.active&&m++,s.push(E)}return s}return this.h&&this.h.audioTracks?Array.from(this.h.audioTracks).map((function(o){return de(o)})):[]},_.Zb=function(){if(this.i){for(var o=this.j?this.j.o:null,s=[],m=t(this.i.textStreams),_=m.next();!_.done;_=m.next()){var S=Yd(_=_.value);S.active=_==o,s.push(S)}return s}return this.h&&this.h.src&&this.h.textTracks?Bm(this).map((function(o){return be(o)})):[]},_.ng=function(){return this.i?this.i.imageStreams.map((function(o){return Zd(o)})):[]},_.Bg=function(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e=this;return I((function(He){return 1==He.g?$e.i?(m=$e.i.imageStreams.find((function(s){return s.id==o})))?m.segmentIndex?He.B(3):C(He,m.createSegmentIndex(),3):He.return(null):He.B(2):2!=He.g?null==(_=m.segmentIndex.find(s))?He.return(null):(S=m.segmentIndex.get(_),E=S.tilesLayout||m.tilesLayout,(A=/(\d+)x(\d+)/.exec(E))?(O=m.width||0,H=m.height||0,K=parseInt(A[1],10),z=parseInt(A[2],10),G=O/K,q=H/z,X=K*z,J=S.l-S.startTime,ae=S.C||J/X,pe=S.startTime,_e=me=0,1<X&&(Se=Math.floor((s-S.startTime)/ae),pe=S.startTime+Se*ae,me=Se%K*G,_e=Math.floor(Se/K)*q),Ee=!1,(De=S.A)&&(Ee=!0,q=De.height,me=De.positionX,_e=De.positionY,G=De.width),He.return({imageHeight:H,imageWidth:O,height:q,positionX:me,positionY:_e,startTime:pe,duration:ae,uris:S.wa(),width:G,sprite:Ee})):He.return(null)):He.return(null)}))},_.Cf=function(o){if(this.i&&this.j){var s=this.i.textStreams.find((function(s){return s.id==o.id}));s&&s!=this.j.o&&(tl(this.u.h,s,!1),Vj(this.j,s),Jm(this),this.Pb=s.language)}else if(this.h&&this.h.src&&this.h.textTracks){for(var m=(s=t(s=Bm(this))).next();!m.done;m=s.next())$d(m=m.value)==o.id?m.mode=this.Y?"showing":"hidden":m.mode="disabled";Jm(this)}},_.Df=function(o,s,m){if(s=void 0!==s&&s,m=void 0===m?0:m,this.i&&this.j){this.g.abr.enabled&&$a("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var _=this.i.variants.find((function(s){return s.id==o.id}));_&&ee(_)&&(jm(this,_,!1,s,m),this.Za=new we(_),nm(this))}else if(this.h&&this.h.audioTracks)for(m=(s=t(s=Array.from(this.h.audioTracks))).next();!m.done;m=s.next())if($d(m=m.value)==o.id){Km(this,m);break}},_.hg=function(){return Lm(this.Cb())},_.zg=function(){return Lm(this.Zb())},_.gg=function(){return Array.from(Mm(this.Cb()))},_.yg=function(){return Array.from(Mm(this.Zb()))},_.Ie=function(o,s,m,_){if(m=void 0===m?0:m,_=void 0===_?0:_,this.i&&this.A){this.Za=new xe(o,s||"",m,"",""),s=function b(o,s){return o.video||s.video?o.video&&s.video?Math.abs((o.video.height||0)-(s.video.height||0))+Math.abs((o.video.width||0)-(s.video.width||0)):1/0:0},o=this.j.j;var S=this.Za.create(this.i.variants);m=null;for(var E=(S=t(S.values())).next();!E.done;E=S.next())E=E.value,(!m||s(m,o)>s(E,o))&&(m=E);m?(s=Xd(m),this.Df(s,!0,_)):Im(this)}else if(this.h&&this.h.audioTracks){for(S=Array.from(this.h.audioTracks),_=Uc(o),m=o=null,E=(S=t(S)).next();!E.done;E=S.next()){var A=de(E=E.value);Uc(A.language)==_&&(o=E,s?A.roles.includes(s)&&(m=E):0==A.roles.length&&(m=E))}m?Km(this,m):o&&Km(this,o)}},_.Je=function(o,s,m){if(m=void 0!==m&&m,this.i&&this.A)this.Pb=o,this.Ec=s||"",this.Ac=m,(o=ge(this.i.textStreams,this.Pb,this.Ec,this.Ac)[0]||null)&&o!=this.j.o&&(tl(this.u.h,o,!1),this.g.streaming.alwaysStreamText||this.ie())&&(Vj(this.j,o),Jm(this));else{var _=Uc(o);(o=this.Zb().find((function(o){return Uc(o.language)==_&&(!s||o.roles.includes(s))&&o.forced==m})))&&this.Cf(o)}},_.gh=function(o,s,m){if(s=void 0===s||s,m=void 0===m?0:m,this.i&&this.A){for(var _=null,S=t(this.i.variants),E=S.next();!E.done;E=S.next())if((E=E.value).audio.label==o){_=E;break}null!=_&&(this.Za=new xe(_.language,"",0,"",o),Im(this,s,m))}else if(this.h&&this.h.audioTracks){for(s=null,_=(m=t(m=Array.from(this.h.audioTracks))).next();!_.done;_=m.next())(_=_.value).label==o&&(s=_);s&&Km(this,s)}},_.ie=function(){var o=this.Y;return this.G?this.G.u.isTextVisible():this.h&&this.h.src&&this.h.textTracks?Bm(this).some((function(o){return"showing"==o.mode})):o},_.kf=function(){return this.h&&this.h.src&&this.h.textTracks?Nm(this).map((function(o){return be(o)})):[]},_.jg=function(o){var s=Uc(o),m=Nm(this).filter((function(o){return Uc(o.language)==s}));if(!m||!m.length)return[];o=[];for(var _=new Set,S=(m=t(m)).next();!S.done;S=m.next())if((S=S.value)&&S.cues)for(var E=(S=t(S.cues)).next();!E.done;E=S.next()){var A=E.value;(E=A.id)&&""!=E||(E=A.startTime+"-"+A.endTime+"-"+A.text),A={id:E,title:A.text,startTime:A.startTime,endTime:A.endTime},_.has(E)||(o.push(A),_.add(E))}return o},_.lh=function(o){if(o=!!o,this.Y!=o){if(this.Y=o,this.l==lo)this.G.u.setTextVisibility(o),this.g.streaming.alwaysStreamText||(o?this.j.o||0<(o=ge(this.i.textStreams,this.Pb,this.Ec,this.Ac)).length&&(Vj(this.j,o[0]),Jm(this)):function Rj(o){var s=o.h.get(qt);s&&(Kj(s),Lj(s).catch((function(){})),o.h.delete(qt)),o.o=null}(this.j));else if(this.h&&this.h.src&&this.h.textTracks)for(var s=Bm(this),m=(s=t(s)).next();!m.done;m=s.next())"disabled"!=(m=m.value).mode&&(m.mode=o?"showing":"hidden");tm(this)}},_.wg=function(){if(!this.T())return null;var o=this.Oa.l,s=0;if(this.A)s=this.A.gd();else if(o){if(null==o.startTime)return new Date;s=o.startTime}return this.i?new Date(1e3*(this.i.presentationTimeline.i+s)):this.h&&this.h.getStartDate?(o=this.h.getStartDate(),isNaN(o.getTime())?null:new Date(o.getTime()+1e3*s)):null},_.lf=function(){if(!this.T())return null;if(this.i)return new Date(1e3*this.i.presentationTimeline.i);if(this.h&&this.h.getStartDate){var o=this.h.getStartDate();return isNaN(o.getTime())?null:o}return null},_.cb=function(){if(this.l==lo)return this.G.cb();var o={total:[],audio:[],video:[],text:[]};return this.l==ho&&(o.total=zh(this.h.buffered)),o},_.getStats=function(){if(this.l!=lo&&this.l!=ho)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,stallsDetected:NaN,gapsJumped:NaN,estimatedBandwidth:NaN,completionPercent:NaN,loadLatency:NaN,manifestTimeSeconds:NaN,drmTimeSeconds:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,liveLatency:NaN,maxSegmentDuration:NaN,switchHistory:[],stateHistory:[]};gm(this);var o=this.h,s=o.currentTime/o.duration;if(!isNaN(s)){var m=this.u;s=Math.round(100*s),m.i=isNaN(m.i)?s:Math.max(m.i,s)}if(this.A&&(this.u.M=this.A.Ve(),this.u.N=this.A.We()),o.getVideoPlaybackQuality){m=o.getVideoPlaybackQuality(),s=this.u;var _=Number(m.totalVideoFrames);s.L=Number(m.droppedVideoFrames),s.I=_,this.u.H=Number(m.corruptedVideoFrames)}this.m?m=(m=this.m).H?m.H:NaN:m=NaN,this.u.s=m,this.l==lo&&((m=this.j.j)&&(this.u.A=(this.H?this.H.i:1)*m.bandwidth),m&&m.video&&(s=this.u,_=m.video.height||NaN,s.o=m.video.width||NaN,s.l=_),this.T()&&(m=this.lf().valueOf()+1e3*this.ec().end,this.u.C=(Date.now()-m)/1e3),this.i&&this.i.presentationTimeline&&(this.u.G=this.i.presentationTimeline.g),m=this.s.getBandwidthEstimate(),this.u.u=m),this.l==ho&&(m=this.u,s=o.videoHeight||NaN,m.o=o.videoWidth||NaN,m.l=s);var S=this.u;o=S.o,m=S.l,s=S.A,_=S.I;for(var E=S.L,A=S.H,O=S.N,H=S.M,K=S.u,z=S.i,G=S.m,q=S.F,X=S.j,J=ql(S.g,"playing"),ae=ql(S.g,"paused"),pe=ql(S.g,"buffering"),me=S.s,_e=S.C,Se=S.G,Ee=function rl(o){function b(o){return{timestamp:o.timestamp,state:o.state,duration:o.duration}}for(var s=[],m=t(o.h),_=m.next();!_.done;_=m.next())s.push(b(_.value));return o.g&&s.push(b(o.g)),s}(S.g),De=[],$e=(S=t(S.h.g)).next();!$e.done;$e=S.next())$e=$e.value,De.push({timestamp:$e.timestamp,id:$e.id,type:$e.type,fromAdaptation:$e.fromAdaptation,bandwidth:$e.bandwidth});return{width:o,height:m,streamBandwidth:s,decodedFrames:_,droppedFrames:E,corruptedFrames:A,stallsDetected:O,gapsJumped:H,estimatedBandwidth:K,completionPercent:z,loadLatency:G,manifestTimeSeconds:q,drmTimeSeconds:X,playTime:J,pauseTime:ae,bufferingTime:pe,licenseTime:me,liveLatency:_e,maxSegmentDuration:Se,stateHistory:Ee,switchHistory:De}},_.Sf=function(o,s,m,_,S,E,A){A=void 0!==A&&A;var O,H,K,z,G,q,X,J,ae,pe,me=this;return I((function(_e){switch(_e.g){case 1:if(me.l!=lo&&me.l!=ho)throw new N(1,7,7004);if(_){_e.B(2);break}return C(_e,Om(me,o),3);case 3:_=_e.h;case 2:if(O=[],me.C)try{O=me.C.getServerSideCuePoints()}catch(o){}if(me.l!=ho){_e.B(4);break}return A&&(m="forced"),C(_e,Pm(me,o,s,m,_,E||"",O),5);case 5:if(H=me.Zb(),K=H.find((function(o){return o.language==s&&o.label==(E||"")&&o.kind==m})))return wm(me),_e.return(K);throw new N(1,2,2012);case 4:if(z=Jt,1/0==(G=me.i.presentationTimeline.getDuration()))throw new N(1,4,4033);if(!O.length){_e.B(6);break}return C(_e,Qm(me,o,me.F,me.g.streaming.retryParameters),7);case 7:q=_e.h,X=Rm(me,q,_,O),J=new Blob([X],{type:"text/vtt"}),o=ma(J),_="text/vtt";case 6:if(ae={id:me.Be++,originalId:null,createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},segmentIndex:kj(0,G,[o]),mimeType:_||"",codecs:S||"",kind:m,encrypted:!1,drmInfos:[],keyIds:new Set,language:s,originalLanguage:s,label:E||null,type:z.da,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!!A,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!0},pe=Cc(ae.mimeType,ae.codecs),!Lc(pe))throw new N(2,2,2014,_);return me.i.textStreams.push(ae),wm(me),_e.return(Yd(ae))}}))},_.Tf=function(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e=this;return I((function(Se){switch(Se.g){case 1:if(_e.l!=lo&&_e.l!=ho)throw new N(1,7,7004);if(_e.l==ho)throw new N(1,2,2016);if(s){Se.B(2);break}return C(Se,Om(_e,o),3);case 3:s=Se.h;case 2:if("text/vtt"!=s)throw new N(1,2,2017,o);if(m=Jt,1/0==(_=_e.i.presentationTimeline.getDuration()))throw new N(1,4,4045);return C(Se,Qm(_e,o,_e.F,_e.g.streaming.retryParameters),4);case 4:if(S=Se.h,!(E=rn[s]))throw new N(2,2,2014,s);for(A=E(),O={periodStart:0,segmentStart:0,segmentEnd:_,vttOffset:0},H=M(S),K=A.parseMedia(H,O),z=[],G={},q=t(K),X=q.next();!X.done;G={nc:G.nc},X=q.next())J=X.value,G.nc=uc([o],[J.U])[0],ae=new Q(J.startTime,J.endTime,function(o){return function(){return[o.nc]}}(G),0,null,null,0,0,1/0),G.nc.includes("#xywh")&&(4===(pe=G.nc.split("#xywh=")[1].split(",")).length&&ae.If({height:parseInt(pe[3],10),positionX:parseInt(pe[0],10),positionY:parseInt(pe[1],10),width:parseInt(pe[2],10)})),z.push(ae);return me={id:_e.Be++,originalId:null,createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},segmentIndex:new hj(z),mimeType:s||"",codecs:"",kind:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"und",originalLanguage:null,label:null,type:m.wc,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,tilesLayout:"1x1",accessibilityPurpose:null,external:!0},_e.i.imageStreams.push(me),wm(_e),Se.return(Zd(me))}}))},_.Rf=function(o,s,m){var _,S,E,A,O=this;return I((function(H){switch(H.g){case 1:if(O.l!=lo&&O.l!=ho)throw new N(1,7,7004);if(m){H.B(2);break}return C(H,Om(O,o),3);case 3:m=H.h;case 2:if(_=[],O.C)try{_=O.C.getServerSideCuePoints()}catch(o){}return C(H,Pm(O,o,s,"chapters",m,"",_),4);case 4:if(S=H.h,E=O.kf(),A=E.find((function(o){return o.language==s})),!A){H.B(5);break}return C(H,new Promise((function(o,s){O.o.la(S,"load",o),O.o.la(S,"error",(function(){s(new N(1,2,2015))}))})),6);case 6:return H.return(A);case 5:throw new N(1,2,2012)}}))},_.Me=function(o,s){this.Ae.width=o,this.Ae.height=s},_.Ee=function(o){if(this.l==lo){var s=this.j;if(o=void 0===o?.1:o,s.l.g)s=!1;else if(s.s)s=!1;else{for(var m=t(s.h.values()),_=m.next();!_.done;_=m.next())!(_=_.value).Nc||_.ua||_.Ya||(_.Nc=!1,Qj(s,_,o));s=!0}}else s=!1;return s},_.pg=function(){return $a("Shaka Player's internal Manifest structure is NOT covered by semantic versioning compatibility guarantees.  It may change at any time!  Please consider filing a feature request for whatever you use getManifest() for."),this.i},_.qg=function(){return this.zd},_.Kf=function(o){this.nd=o},_.$d=function(o,s){if(!this.g.abr.enabled||this.l===ro||!navigator.onLine)return!1;if(this.i.variants.some((function(s){return!(!(s=s[o.type])||s.id===o.id)&&("audio"!=o.type||o.language===s.language)}))){for(var m=t(this.i.variants),_=m.next();!_.done;_=m.next()){var S=(_=_.value)[o.type];S&&S.id===o.id&&(_.disabledUntilTime=Date.now()/1e3+s)}return this.wd.Ca(1),s=this.cb().video.reduce((function(o,s){return o+s.end-s.start}),0),Im(this,!0,s,!0,!1),!0}return!1},L("shaka.Player",T),T.prototype.setVideoContainer=T.prototype.Kf,T.prototype.getManifestParserFactory=T.prototype.qg,T.prototype.getManifest=T.prototype.pg,T.prototype.retryStreaming=T.prototype.Ee,T.prototype.setMaxHardwareResolution=T.prototype.Me,T.prototype.addChaptersTrack=T.prototype.Rf,T.prototype.addThumbnailsTrack=T.prototype.Tf,T.prototype.addTextTrackAsync=T.prototype.Sf,T.prototype.getStats=T.prototype.getStats,T.prototype.getBufferedInfo=T.prototype.cb,T.prototype.getPresentationStartTimeAsDate=T.prototype.lf,T.prototype.getPlayheadTimeAsDate=T.prototype.wg,T.prototype.setTextTrackVisibility=T.prototype.lh,T.prototype.getChapters=T.prototype.jg,T.prototype.getChaptersTracks=T.prototype.kf,T.prototype.isTextTrackVisible=T.prototype.ie,T.prototype.selectVariantsByLabel=T.prototype.gh,T.prototype.selectTextLanguage=T.prototype.Je,T.prototype.selectAudioLanguage=T.prototype.Ie,T.prototype.getTextLanguages=T.prototype.yg,T.prototype.getAudioLanguages=T.prototype.gg,T.prototype.getTextLanguagesAndRoles=T.prototype.zg,T.prototype.getAudioLanguagesAndRoles=T.prototype.hg,T.prototype.selectVariantTrack=T.prototype.Df,T.prototype.selectTextTrack=T.prototype.Cf,T.prototype.getThumbnails=T.prototype.Bg,T.prototype.getImageTracks=T.prototype.ng,T.prototype.getTextTracks=T.prototype.Zb,T.prototype.getVariantTracks=T.prototype.Cb,T.prototype.cancelTrickPlay=T.prototype.Ze,T.prototype.trickPlay=T.prototype.Mf,T.prototype.getPlaybackRate=T.prototype.rd,T.prototype.isBuffering=T.prototype.ge,T.prototype.getKeyStatuses=T.prototype.qd,T.prototype.getActiveSessionsMetadata=T.prototype.be,T.prototype.getExpiration=T.prototype.Ic,T.prototype.drmInfo=T.prototype.drmInfo,T.prototype.keySystem=T.prototype.keySystem,T.prototype.goToLive=T.prototype.Gg,T.prototype.seekRange=T.prototype.ec,T.prototype.isAudioOnly=T.prototype.Jg,T.prototype.isInProgress=T.prototype.Fb,T.prototype.isLive=T.prototype.T,T.prototype.getAdManager=T.prototype.jf,T.prototype.getAssetUri=T.prototype.ce,T.prototype.getNetworkingEngine=T.prototype.zb,T.prototype.getMediaElement=T.prototype.tg,T.prototype.getManifestType=T.prototype.rg,T.prototype.getLoadMode=T.prototype.og,T.prototype.resetConfiguration=T.prototype.dh,T.prototype.getBufferFullness=T.prototype.ig,T.prototype.getConfiguration=T.prototype.getConfiguration,T.prototype.configure=T.prototype.configure,T.prototype.load=T.prototype.load,T.prototype.updateStartTime=T.prototype.qh,T.prototype.unload=T.prototype.Se,T.prototype.detach=T.prototype.detach,T.prototype.attachCanvas=T.prototype.Vf,T.prototype.attach=T.prototype.yc,T.probeSupport=function(o){var s,m,_,S,E;return o=void 0===o||o,I((function(A){if(1==A.g)return s={},o?C(A,function ch(){var o,s,m,_,S,E;return I((function(A){return 1==A.g?(o="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.microsoft.playready.recommendation com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" "),m=[{videoCapabilities:s=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],persistentState:"required",sessionTypes:["persistent-license"]},{initDataTypes:["cenc"],videoCapabilities:s}],_=new Map,S=function g(o){var s,S,E;return I((function(A){switch(A.g){case 1:if(wa(A,2),"org.w3.clearkey"===o&&od())throw Error("Unsupported keySystem");return C(A,navigator.requestMediaKeySystemAccess(o,m),4);case 4:return s=A.h,E=!!(S=s.getConfiguration().sessionTypes)&&S.includes("persistent-license"),jd("Tizen 3")&&(E=!1),_.set(o,{persistentState:E}),C(A,s.createMediaKeys(),5);case 5:Aa(A,0);break;case 2:Ba(A),_.set(o,null),D(A)}}))},E=o.map((function(o){return S(o)})),C(A,Promise.all(E),2)):A.return(uf(_))}))}(),3):A.B(2);2!=A.g&&(s=A.h);var O={};if(ed()){for(var H in na)O[H]=!0;for(var K in aa)O[K]=!0}H={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var z=(K=t(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!z.done;z=K.next())O[z=z.value]=ed()?!!na[z]:fd(z);for(var G in H)O[G]=ed()?!!aa[G]:fd(H[G]);for(m=O,O={},H=(G=t(G='video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",audio/mp4; codecs="dtsc",audio/mp4; codecs="dtse",audio/mp4; codecs="dtsx",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").concat(v(nn)))).next();!H.done;H=G.next())O[H=H.value]=ed()?!!Lc(H)||(gb(H)||!!Vb(H)):fd(H),O[K=H.split(";")[0]]=O[K]||O[H];for(E in _={manifest:m,media:O,drm:s},S=So)_[E]=S[E]();return A.return(_)}))},T.isBrowserSupported=function(){if(o.Promise||$a("A Promise implementation or polyfill is required"),!(o.Promise&&o.Uint8Array&&Array.prototype.forEach)||jd("Trident/"))return!1;var s=od();return!(s&&13>s||!(o.MediaKeys&&o.navigator&&o.navigator.requestMediaKeySystemAccess&&o.MediaKeySystemAccess&&o.MediaKeySystemAccess.prototype.getConfiguration))&&(!!ed()||fd("application/x-mpegurl"))},T.setAdManagerFactory=function(o){To=o},T.registerSupportPlugin=function(o,s){So[o]=s},T.prototype.destroy=T.prototype.destroy;var ro=0,oo=1,lo=2,ho=3;T.LoadMode={DESTROYED:ro,NOT_LOADED:oo,MEDIA_SOURCE:lo,SRC_EQUALS:ho},T.version="v4.4.0";var po=["4","4"];Gn=new function(o){this.g=o,this.i=qe,this.h=re}(new ne(Number(po[0]),Number(po[1])));var _o=["output-restricted","internal-error"],So={},To=null,Co={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mpd:"application/dash+xml",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"},Eo={sbv:"text/x-subviewer",srt:"text/srt",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml",lrc:"application/x-subtitle-lrc",ssa:"text/x-ssa",ass:"text/x-ssa"};function $m(){this.h=[],this.j=this.i=this.g=0}function U(o,s,m){var _=this;this.g=o,this.h=s,this.m=m,this.i=!1,this.l=this.h.getVolume(),this.j=new lf,this.j.D(this.h,google.ima.AdEvent.Type.PAUSED,(function(){_.i=!0})),this.j.D(this.h,google.ima.AdEvent.Type.RESUMED,(function(){_.i=!1}))}function an(s,m,_,S,E){var A=this;this.o=s,this.i=m,this.A=!1,this.s=this.C=null,this.F=NaN,this.m=E,this.j=null,this.h=new lf,google.ima.settings.setLocale(_),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),(s=new google.ima.AdDisplayContainer(this.o,this.i)).initialize(),this.l=new google.ima.AdsLoader(s),this.l.getSettings().setPlayerType("shaka-player"),this.l.getSettings().setPlayerVersion("v4.4.0"),this.g=null,this.u=S||new google.ima.AdsRenderingSettings,this.h.D(this.l,google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(s){!function bn(s,m){if(s.m(new P("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-s.F))),s.C.customPlayheadTracker){var _={currentTime:s.i.currentTime};s.g=m.getAdsManager(_,s.u),s.i.muted?s.g.setVolume(0):s.g.setVolume(s.i.volume),s.h.D(s.i,"timeupdate",(function(){s.i.duration&&(_.currentTime=s.i.currentTime)})),s.h.D(s.i,"volumechange",(function(){s.i.muted?s.g.setVolume(0):s.g.setVolume(s.i.volume)}))}else s.g=m.getAdsManager(s.i,s.u);s.m(new P("ima-ad-manager-loaded",(new Map).set("imaAdManager",s.g)));var S=s.g.getCuePoints();if(S.length){m=[];for(var E=(S=t(S)).next();!E.done;E=S.next())m.push({start:E.value,end:null});s.m(new P("ad-cue-points-changed",(new Map).set("cuepoints",m)))}!function en(o){function b(s,m){s=(new Map).set("originalEvent",s),o.m(new P(m,s))}o.h.D(o.g,google.ima.AdErrorEvent.Type.AD_ERROR,(function(s){cn(o,s)})),o.h.D(o.g,google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,(function(s){gn(o,s)})),o.h.D(o.g,google.ima.AdEvent.Type.STARTED,(function(s){gn(o,s)})),o.h.D(o.g,google.ima.AdEvent.Type.FIRST_QUARTILE,(function(o){b(o,"ad-first-quartile")})),o.h.D(o.g,google.ima.AdEvent.Type.MIDPOINT,(function(o){b(o,"ad-midpoint")})),o.h.D(o.g,google.ima.AdEvent.Type.THIRD_QUARTILE,(function(o){b(o,"ad-third-quartile")})),o.h.D(o.g,google.ima.AdEvent.Type.COMPLETE,(function(o){b(o,"ad-complete")})),o.h.D(o.g,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,(function(s){dn(o,s)})),o.h.D(o.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(s){dn(o,s)})),o.h.D(o.g,google.ima.AdEvent.Type.SKIPPED,(function(o){b(o,"ad-skipped")})),o.h.D(o.g,google.ima.AdEvent.Type.VOLUME_CHANGED,(function(o){b(o,"ad-volume-changed")})),o.h.D(o.g,google.ima.AdEvent.Type.VOLUME_MUTED,(function(o){b(o,"ad-muted")})),o.h.D(o.g,google.ima.AdEvent.Type.PAUSED,(function(s){o.j&&(o.j.i=!0,b(s,"ad-paused"))})),o.h.D(o.g,google.ima.AdEvent.Type.RESUMED,(function(s){o.j&&(o.j.i=!1,b(s,"ad-resumed"))})),o.h.D(o.g,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(function(s){o.j&&b(s,"ad-skip-state-changed")})),o.h.D(o.g,google.ima.AdEvent.Type.CLICK,(function(o){b(o,"ad-clicked")})),o.h.D(o.g,google.ima.AdEvent.Type.AD_PROGRESS,(function(o){b(o,"ad-progress")})),o.h.D(o.g,google.ima.AdEvent.Type.AD_BUFFERING,(function(o){b(o,"ad-buffering")})),o.h.D(o.g,google.ima.AdEvent.Type.IMPRESSION,(function(o){b(o,"ad-impression")})),o.h.D(o.g,google.ima.AdEvent.Type.DURATION_CHANGE,(function(o){b(o,"ad-duration-changed")})),o.h.D(o.g,google.ima.AdEvent.Type.USER_CLOSE,(function(o){b(o,"ad-closed")})),o.h.D(o.g,google.ima.AdEvent.Type.LOADED,(function(o){b(o,"ad-loaded")})),o.h.D(o.g,google.ima.AdEvent.Type.ALL_ADS_COMPLETED,(function(o){b(o,"all-ads-completed")})),o.h.D(o.g,google.ima.AdEvent.Type.LINEAR_CHANGED,(function(o){b(o,"ad-linear-changed")})),o.h.D(o.g,google.ima.AdEvent.Type.AD_METADATA,(function(o){b(o,"ad-metadata")})),o.h.D(o.g,google.ima.AdEvent.Type.LOG,(function(o){b(o,"ad-recoverable-error")})),o.h.D(o.g,google.ima.AdEvent.Type.AD_BREAK_READY,(function(o){b(o,"ad-break-ready")})),o.h.D(o.g,google.ima.AdEvent.Type.INTERACTION,(function(o){b(o,"ad-interaction")}))}(s);try{s.g.init(s.i.offsetWidth,s.i.offsetHeight,fn(s)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL),s.h.D(s.i,"loadeddata",(function(){s.g.resize(s.i.offsetWidth,s.i.offsetHeight,fn(s)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),"ResizeObserver"in o?(s.s=new ResizeObserver((function(){s.g.resize(s.i.offsetWidth,s.i.offsetHeight,fn(s)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),s.s.observe(s.i)):s.h.D(document,"fullscreenchange",(function(){s.g.resize(s.i.offsetWidth,s.i.offsetHeight,fn(s)?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)})),s.A?s.g.start():s.h.la(s.i,"play",(function(){s.A=!0,s.g.start()}))}catch(o){dn(s,null)}}(A,s)})),this.h.D(this.l,google.ima.AdErrorEvent.Type.AD_ERROR,(function(o){cn(A,o)})),this.h.D(this.i,"ended",(function(){A.l.contentComplete()})),this.h.la(this.i,"play",(function(){A.A=!0}))}function cn(o,s){s.getError(),s=(new Map).set("originalEvent",s),o.m(new P("ad-error",s)),dn(o,null),o.m(new P("ad-cue-points-changed",(new Map).set("cuepoints",[])))}function fn(o){return document.fullscreenEnabled?!!document.fullscreenElement:!!(o=o.i).webkitSupportsFullscreen&&o.webkitDisplayingFullscreen}function gn(o,s){var m=s.getAd();m?(o.j=new U(m,o.g,o.i),s=(new Map).set("ad",o.j).set("sdkAdObject",m).set("originalEvent",s),o.m(new P("ad-started",s)),o.j.isLinear()&&(o.o.setAttribute("ad-active","true"),o.i.pause(),o.j.setVolume(o.i.volume),o.i.muted&&o.j.setMuted(!0))):$a("The IMA SDK fired a "+s.type+" event with no associated ad. Unable to play ad!")}function dn(o,s){o.m(new P("ad-stopped",(new Map).set("originalEvent",s))),o.j&&o.j.isLinear()&&(o.o.removeAttribute("ad-active"),o.i.ended||o.i.play())}function V(o,s){this.g=o,this.i=null,this.h=s}function hn(o,s,m,_){var S=this;this.s=o,this.l=s,this.j=null,this.G=NaN,this.i=_,this.F=!1,this.u=this.m=this.o=null,this.A="",this.C=[],this.h=new lf,(o=new google.ima.dai.api.UiSettings).setLocale(m),this.g=new google.ima.dai.api.StreamManager(this.l,this.s,o),this.i(new P("ima-stream-manager-loaded",(new Map).set("imaStreamManager",this.g))),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.LOADED,(function(o){!function jn(o,s){o.i(new P("ads-loaded",(new Map).set("loadTime",Date.now()/1e3-o.G))),s=s.getStreamData().url,o.j.resolve(s),o.j=null,o.F||o.h.D(o.l,"seeked",(function(){var s=o.l.currentTime;if(0!=s){o.g.streamTimeForContentTime(s);var m=o.g.previousCuePointForStreamTime(s);m&&!m.played&&(o.o=s,o.l.currentTime=m.start)}}))}(S,o)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.ERROR,(function(){S.A.length?S.j.resolve(S.A):S.j.reject("IMA Stream request returned an error and there was no backup asset uri provided."),S.j=null})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_STARTED,(function(){})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.STARTED,(function(o){o=o.getAd(),S.m=new V(o,S.l),S.u&&(S.m.i=S.u),S.i(new P("ad-started",(new Map).set("ad",S.m))),S.s.setAttribute("ad-active","true")})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_BREAK_ENDED,(function(){S.s.removeAttribute("ad-active");var o=S.l.currentTime;S.o&&S.o>o&&(S.l.currentTime=S.o,S.o=null)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.AD_PROGRESS,(function(o){S.u=o.getStreamData().adProgressData,S.m&&(S.m.i=S.u)})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.FIRST_QUARTILE,(function(){S.i(new P("ad-first-quartile"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.MIDPOINT,(function(){S.i(new P("ad-midpoint"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.THIRD_QUARTILE,(function(){S.i(new P("ad-third-quartile"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.COMPLETE,(function(){S.i(new P("ad-complete")),S.i(new P("ad-stopped")),S.s.removeAttribute("ad-active"),S.m=null})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.SKIPPED,(function(){S.i(new P("ad-skipped")),S.i(new P("ad-stopped"))})),this.h.D(this.g,google.ima.dai.api.StreamEvent.Type.CUEPOINTS_CHANGED,(function(o){var s=o.getStreamData();o=[];for(var m=(s=t(s.cuepoints)).next();!m.done;m=s.next())m=m.value,o.push({start:m.start,end:m.end});S.C=o,S.i(new P("ad-cue-points-changed",(new Map).set("cuepoints",o)))}))}function W(){Te.call(this),this.g=this.h=null,this.i=new $m,this.l=navigator.language,this.j=null}function kn(o){return JSON.stringify(o,(function(o,s){if("function"!=typeof s){if(s instanceof Event||s instanceof P){var m={};for(_ in s)(o=s[_])&&"object"==typeof o?"detail"==_&&(m[_]=o):_ in Event||(m[_]=o);return m}if(s instanceof Error){var _=new Set(["name","message","stack"]);for(m in s)_.add(m);for(m=(o=t(Object.getOwnPropertyNames(s))).next();!m.done;m=o.next())_.add(m.value);for(o={},m=(_=t(_)).next();!m.done;m=_.next())o[m=m.value]=s[m];s={__type__:"Error",contents:o}}else if(s instanceof TimeRanges){for(_={__type__:"TimeRanges",length:s.length,start:[],end:[]},m=(s=t(zh(s))).next();!m.done;m=s.next())o=(m=m.value).end,_.start.push(m.start),_.end.push(o);s=_}else s=s instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(s)}:"number"==typeof s?isNaN(s)?"NaN":isFinite(s)?s:0>s?"-Infinity":"Infinity":s;return s}}))}function ln(o){return JSON.parse(o,(function(o,s){if("NaN"==s)var m=NaN;else if("-Infinity"==s)m=-1/0;else if("Infinity"==s)m=1/0;else if(s&&"object"==typeof s&&"TimeRanges"==s.__type__)m=function mn(o){return{length:o.length,start:function start(s){return o.start[s]},end:function end(s){return o.end[s]}}}(s);else if(s&&"object"==typeof s&&"Uint8Array"==s.__type__)m=new Uint8Array(s.entries);else if(s&&"object"==typeof s&&"Error"==s.__type__){for(m in o=s.contents,s=Error(o.message),o)s[m]=o[m];m=s}else m=s;return m}))}(_=U.prototype).getDuration=function(){return this.g.getDuration()},_.getMinSuggestedDuration=function(){return this.g.getMinSuggestedDuration()},_.getRemainingTime=function(){return this.h.getRemainingTime()},_.isPaused=function(){return this.i},_.isSkippable=function(){return 0<=this.g.getSkipTimeOffset()},_.getTimeUntilSkippable=function(){var o=this.g.getSkipTimeOffset();return o=this.getRemainingTime()-o,Math.max(o,0)},_.canSkipNow=function(){return this.h.getAdSkippableState()},_.skip=function(){return this.h.skip()},_.pause=function(){return this.h.pause()},_.play=function(){return this.h.resume()},_.getVolume=function(){return this.h.getVolume()},_.setVolume=function(o){return this.h.setVolume(o)},_.isMuted=function(){return 0==this.h.getVolume()},_.isLinear=function(){return this.g.isLinear()},_.resize=function(o,s){var m=!1,_=this.m;document.fullscreenEnabled?m=!!document.fullscreenElement:_.webkitSupportsFullscreen&&(m=_.webkitDisplayingFullscreen),this.h.resize(o,s,m?google.ima.ViewMode.FULLSCREEN:google.ima.ViewMode.NORMAL)},_.setMuted=function(o){o?(this.l=this.getVolume(),this.setVolume(0)):this.setVolume(this.l)},_.getSequenceLength=function(){var o=this.g.getAdPodInfo();return null==o?1:o.getTotalAds()},_.getPositionInSequence=function(){var o=this.g.getAdPodInfo();return null==o?1:o.getAdPosition()},_.getTitle=function(){return this.g.getTitle()},_.getDescription=function(){return this.g.getDescription()},_.getVastMediaBitrate=function(){return this.g.getVastMediaBitrate()},_.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},_.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},_.getAdId=function(){return this.g.getAdId()},_.getCreativeAdId=function(){return this.g.getCreativeAdId()},_.getAdvertiserName=function(){return this.g.getAdvertiserName()},_.getMediaUrl=function(){return this.g.getMediaUrl()},_.getTimeOffset=function(){var o=this.g.getAdPodInfo();return null==o?0:o.getTimeOffset()},_.getPodIndex=function(){var o=this.g.getAdPodInfo();return null==o?0:o.getPodIndex()},_.release=function(){this.h=this.g=null},L("shaka.ads.ClientSideAd",U),U.prototype.release=U.prototype.release,U.prototype.getPodIndex=U.prototype.getPodIndex,U.prototype.getTimeOffset=U.prototype.getTimeOffset,U.prototype.getMediaUrl=U.prototype.getMediaUrl,U.prototype.getAdvertiserName=U.prototype.getAdvertiserName,U.prototype.getCreativeAdId=U.prototype.getCreativeAdId,U.prototype.getAdId=U.prototype.getAdId,U.prototype.getVastMediaWidth=U.prototype.getVastMediaWidth,U.prototype.getVastMediaHeight=U.prototype.getVastMediaHeight,U.prototype.getVastMediaBitrate=U.prototype.getVastMediaBitrate,U.prototype.getDescription=U.prototype.getDescription,U.prototype.getTitle=U.prototype.getTitle,U.prototype.getPositionInSequence=U.prototype.getPositionInSequence,U.prototype.getSequenceLength=U.prototype.getSequenceLength,U.prototype.setMuted=U.prototype.setMuted,U.prototype.resize=U.prototype.resize,U.prototype.isLinear=U.prototype.isLinear,U.prototype.isMuted=U.prototype.isMuted,U.prototype.setVolume=U.prototype.setVolume,U.prototype.getVolume=U.prototype.getVolume,U.prototype.play=U.prototype.play,U.prototype.pause=U.prototype.pause,U.prototype.skip=U.prototype.skip,U.prototype.canSkipNow=U.prototype.canSkipNow,U.prototype.getTimeUntilSkippable=U.prototype.getTimeUntilSkippable,U.prototype.isSkippable=U.prototype.isSkippable,U.prototype.isPaused=U.prototype.isPaused,U.prototype.getRemainingTime=U.prototype.getRemainingTime,U.prototype.getMinSuggestedDuration=U.prototype.getMinSuggestedDuration,U.prototype.getDuration=U.prototype.getDuration,an.prototype.configure=function(o){this.C=o},an.prototype.stop=function(){this.g&&this.g.stop(),this.o&&Bk(this.o)},an.prototype.release=function(){this.stop(),this.s&&this.s.disconnect(),this.h&&this.h.release(),this.g&&this.g.destroy(),this.l.destroy()},(_=V.prototype).getDuration=function(){return this.i?this.i.duration:-1},_.getMinSuggestedDuration=function(){return this.getDuration()},_.getRemainingTime=function(){return this.i?this.i.duration-this.i.currentTime:-1},_.isPaused=function(){return this.h.paused},_.isSkippable=function(){return this.g.isSkippable()},_.getTimeUntilSkippable=function(){var o=this.g.getSkipTimeOffset();return o=this.getRemainingTime()-o,Math.max(o,0)},_.canSkipNow=function(){return 0==this.getTimeUntilSkippable()},_.skip=function(){this.h.currentTime+=this.getRemainingTime()},_.pause=function(){return this.h.pause()},_.play=function(){return this.h.play()},_.getVolume=function(){return this.h.volume},_.setVolume=function(o){this.h.volume=o},_.isMuted=function(){return this.h.muted},_.isLinear=function(){return!0},_.resize=function(){},_.setMuted=function(o){this.h.muted=o},_.getSequenceLength=function(){var o=this.g.getAdPodInfo();return null==o?1:o.getTotalAds()},_.getPositionInSequence=function(){var o=this.g.getAdPodInfo();return null==o?1:o.getAdPosition()},_.getTitle=function(){return this.g.getTitle()},_.getDescription=function(){return this.g.getDescription()},_.getVastMediaBitrate=function(){return 0},_.getVastMediaHeight=function(){return this.g.getVastMediaHeight()},_.getVastMediaWidth=function(){return this.g.getVastMediaWidth()},_.getAdId=function(){return this.g.getAdId()},_.getCreativeAdId=function(){return this.g.getCreativeAdId()},_.getAdvertiserName=function(){return this.g.getAdvertiserName()},_.getMediaUrl=function(){return null},_.getTimeOffset=function(){var o=this.g.getAdPodInfo();return null==o?0:o.getTimeOffset()},_.getPodIndex=function(){var o=this.g.getAdPodInfo();return null==o?0:o.getPodIndex()},_.release=function(){this.h=this.i=this.g=null},L("shaka.ads.ServerSideAd",V),V.prototype.release=V.prototype.release,V.prototype.getPodIndex=V.prototype.getPodIndex,V.prototype.getTimeOffset=V.prototype.getTimeOffset,V.prototype.getMediaUrl=V.prototype.getMediaUrl,V.prototype.getAdvertiserName=V.prototype.getAdvertiserName,V.prototype.getCreativeAdId=V.prototype.getCreativeAdId,V.prototype.getAdId=V.prototype.getAdId,V.prototype.getVastMediaWidth=V.prototype.getVastMediaWidth,V.prototype.getVastMediaHeight=V.prototype.getVastMediaHeight,V.prototype.getVastMediaBitrate=V.prototype.getVastMediaBitrate,V.prototype.getDescription=V.prototype.getDescription,V.prototype.getTitle=V.prototype.getTitle,V.prototype.getPositionInSequence=V.prototype.getPositionInSequence,V.prototype.getSequenceLength=V.prototype.getSequenceLength,V.prototype.setMuted=V.prototype.setMuted,V.prototype.resize=V.prototype.resize,V.prototype.isLinear=V.prototype.isLinear,V.prototype.isMuted=V.prototype.isMuted,V.prototype.setVolume=V.prototype.setVolume,V.prototype.getVolume=V.prototype.getVolume,V.prototype.play=V.prototype.play,V.prototype.pause=V.prototype.pause,V.prototype.skip=V.prototype.skip,V.prototype.canSkipNow=V.prototype.canSkipNow,V.prototype.getTimeUntilSkippable=V.prototype.getTimeUntilSkippable,V.prototype.isSkippable=V.prototype.isSkippable,V.prototype.isPaused=V.prototype.isPaused,V.prototype.getRemainingTime=V.prototype.getRemainingTime,V.prototype.getMinSuggestedDuration=V.prototype.getMinSuggestedDuration,V.prototype.getDuration=V.prototype.getDuration,hn.prototype.configure=function(){},hn.prototype.stop=function(){this.A="",this.o=null,this.C=[]},hn.prototype.release=function(){this.stop(),this.h&&this.h.release()},hn.prototype.onCueMetadataChange=function(o){if(o.key&&o.data){var s={};s[o.key]=o.data,this.g.onTimedMetadata(s)}},ra(W,Te),(_=W.prototype).setLocale=function(o){this.l=o},_.configure=function(o){this.j=o,this.h&&this.h.configure(this.j),this.g&&this.g.configure(this.j)},_.initClientSide=function(s,m,_){var S=this;if(!o.google||!google.ima||!google.ima.AdsLoader)throw new N(2,10,1e4);this.h&&this.h.release(),this.h=new an(s,m,this.l,_,(function(o){if(o&&o.type)switch(o.type){case"ads-loaded":S.i.h.push(o.loadTime);break;case"ad-started":S.i.g++;break;case"ad-complete":S.i.i++;break;case"ad-skipped":S.i.j++}S.dispatchEvent(o)})),this.h.configure(this.j)},_.release=function(){this.h&&(this.h.release(),this.h=null),this.g&&(this.g.release(),this.g=null),Te.prototype.release.call(this)},_.onAssetUnload=function(){this.h&&this.h.stop(),this.g&&this.g.stop(),this.dispatchEvent(new P("ad-stopped")),this.i=new $m},_.requestClientSideAds=function(o){if(!this.h)throw new N(1,10,10001);var s=this.h;s.g&&s.g.destroy(),s.l&&s.l.contentComplete(),s.F=Date.now()/1e3,s.l.requestAds(o)},_.updateClientSideAdsRenderingSettings=function(o){if(!this.h)throw new N(1,10,10001);var s=this.h;s.u=o,s.g&&s.g.updateAdsRenderingSettings(s.u)},_.initServerSide=function(s,m){var _=this;if(!o.google||!google.ima||!google.ima.dai)throw new N(2,10,10002);this.g&&this.g.release(),this.g=new hn(s,m,this.l,(function(o){if(o&&o.type)switch(o.type){case"ads-loaded":_.i.h.push(o.loadTime);break;case"ad-started":_.i.g++;break;case"ad-complete":_.i.i++;break;case"ad-skipped":_.i.j++}_.dispatchEvent(o)})),this.g.configure(this.j)},_.requestServerSideStream=function(o,s){if(s=void 0===s?"":s,!this.g)throw new N(1,10,10003);o.adTagParameters||(o.adTagParameters={});var m=o.adTagParameters;return(m.mpt||m.mpv)&&$a('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),o.adTagParameters.mpt="shaka-player",o.adTagParameters.mpv="v4.4.0",(m=this.g).j?o=Promise.reject(new N(1,10,10004)):(o instanceof google.ima.dai.api.LiveStreamRequest&&(m.F=!0),m.j=new Je,m.g.requestStream(o),m.A=s||"",m.G=Date.now()/1e3,o=m.j),o},_.replaceServerSideAdTagParameters=function(o){if(!this.g)throw new N(1,10,10003);(o.mpt||o.mpv)&&$a('You have attempted to set "mpt" and/or "mpv" parameters of the ad tag. Please note that those parameters are used for Shaka adoption tracking and will be overriden.'),o.mpt="Shaka Player",o.mpv="v4.4.0",this.g.g.replaceAdTagParameters(o)},_.getServerSideCuePoints=function(){if(!this.g)throw new N(1,10,10003);return this.g.C},_.getStats=function(){var o=this.i;return{loadTimes:o.h,started:o.g,playedCompletely:o.i,skipped:o.j}},_.onDashTimedMetadata=function(o){if(this.g&&"urn:google:dai:2018"==o.schemeIdUri){var s=o.schemeIdUri,m=o.eventElement?o.eventElement.getAttribute("messageData"):null;this.g.g.processMetadata(s,m,o.startTime)}},_.onHlsTimedMetadata=function(o,s){this.g&&this.g.g.processMetadata("ID3",o.data,s)},_.onCueMetadataChange=function(o){this.g&&this.g.onCueMetadataChange(o)},L("shaka.ads.AdManager",W),W.prototype.onCueMetadataChange=W.prototype.onCueMetadataChange,W.prototype.onHlsTimedMetadata=W.prototype.onHlsTimedMetadata,W.prototype.onDashTimedMetadata=W.prototype.onDashTimedMetadata,W.prototype.getStats=W.prototype.getStats,W.prototype.getServerSideCuePoints=W.prototype.getServerSideCuePoints,W.prototype.replaceServerSideAdTagParameters=W.prototype.replaceServerSideAdTagParameters,W.prototype.requestServerSideStream=W.prototype.requestServerSideStream,W.prototype.initServerSide=W.prototype.initServerSide,W.prototype.updateClientSideAdsRenderingSettings=W.prototype.updateClientSideAdsRenderingSettings,W.prototype.requestClientSideAds=W.prototype.requestClientSideAds,W.prototype.onAssetUnload=W.prototype.onAssetUnload,W.prototype.release=W.prototype.release,W.prototype.initClientSide=W.prototype.initClientSide,W.prototype.configure=W.prototype.configure,W.prototype.setLocale=W.prototype.setLocale,W.ADS_LOADED="ads-loaded",W.AD_STARTED="ad-started",W.AD_FIRST_QUARTILE="ad-first-quartile",W.AD_MIDPOINT="ad-midpoint",W.AD_THIRD_QUARTILE="ad-third-quartile",W.AD_COMPLETE="ad-complete",W.AD_STOPPED="ad-stopped",W.AD_SKIPPED="ad-skipped",W.AD_VOLUME_CHANGED="ad-volume-changed",W.AD_MUTED="ad-muted",W.AD_PAUSED="ad-paused",W.AD_RESUMED="ad-resumed",W.AD_SKIP_STATE_CHANGED="ad-skip-state-changed",W.CUEPOINTS_CHANGED="ad-cue-points-changed",W.IMA_AD_MANAGER_LOADED="ima-ad-manager-loaded",W.IMA_STREAM_MANAGER_LOADED="ima-stream-manager-loaded",W.AD_CLICKED="ad-clicked",W.AD_PROGRESS="ad-progress",W.AD_BUFFERING="ad-buffering",W.AD_IMPRESSION="ad-impression",W.AD_DURATION_CHANGED="ad-duration-changed",W.AD_CLOSED="ad-closed",W.AD_LOADED="ad-loaded",W.ALL_ADS_COMPLETED="all-ads-completed",W.AD_LINEAR_CHANGED="ad-linear-changed",W.AD_METADATA="ad-metadata",W.AD_RECOVERABLE_ERROR="ad-recoverable-error",W.AD_ERROR="ad-error",W.AD_BREAK_READY="ad-break-ready",W.AD_INTERACTION="ad-interaction",To=function zl(){return new W};var Io="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Lo="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Do=["loop","playbackRate"],Oo=["pause","play"],Fo={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferFullness:1,getBufferedInfo:2,getExpiration:2,getKeyStatuses:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getImageTracks:2,getThumbnails:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,getLoadMode:10,getManifestType:10},No={getConfiguration:4,getStats:5,getTextTracks:2,getVariantTracks:2},Bo={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},Vo=[["getConfiguration","configure"]],Ho=[["isTextTrackVisible","setTextTrackVisibility"]],Go="addChaptersTrack addTextTrackAsync addThumbnailsTrack cancelTrickPlay configure getChapters getChaptersTracks resetConfiguration retryStreaming selectAudioLanguage selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay updateStartTime goToLive".split(" "),qo=["attach","attachCanvas","detach","load","unload"];function yn(o,s,m,_,S,E,A){var O=this;this.G=o,this.M=A,this.j=new dd(s),this.N=m,this.u=!1,this.s=_,this.F=S,this.I=E,this.h=this.m=!1,this.L="",this.o=null,this.A=function(){return zn(O)},this.C=function(o,s){switch((o=ln(s)).type){case"event":var m=o.targetName,_=Re(o.event);O.s(m,_);break;case"update":for(_ in m=o.update)for(var S in o=O.g[_]||{},m[_])o[S]=m[_][S];O.u&&(O.N(),O.u=!1);break;case"asyncComplete":if(_=o.id,S=o.error,o=O.i[_],delete O.i[_],o)if(S){for(m in _=new N(S.severity,S.category,S.code),S)_[m]=S[m];o.reject(_)}else o.resolve()}},this.g={video:{},player:{}},this.H=0,this.i={},this.l=null,Os.add(this)}function Kn(o,s,m){_s=m,m.addUpdateListener(o.A),m.addMessageListener("urn:x-cast:com.google.shaka.v2",o.C),zn(o),Jn(o,{type:"init",initState:s,appData:o.o}),o.l.resolve()}function Ln(o,s){var m=8003;switch(s.code){case"cancel":m=8004;break;case"timeout":m=8005;break;case"receiver_unavailable":m=8006}o.l.reject(new N(2,8,m,s))}function En(o,s){var m=o.I();o.l=new Je,o.u=!0,Kn(o,m,s)}function Dn(o){var s=_s;s.removeUpdateListener(o.A),s.removeMessageListener("urn:x-cast:com.google.shaka.v2",o.C)}function zn(o){var s=!!_s&&"connected"==_s.status;if(o.h&&!s){for(var m in o.F(),o.g)o.g[m]={};Bn(o)}o.h=s,o.L=s?_s.receiver.friendlyName:"",o.j.ic()}function Bn(o){for(var s in o.i){var m=o.i[s];delete o.i[s],m.reject(new N(1,7,7e3))}}function Jn(o,s){s=kn(s);var m=_s;try{m.sendMessage("urn:x-cast:com.google.shaka.v2",s,(function(){}),cb)}catch(_){throw s=new N(2,8,8005,_),m=new P("error",(new Map).set("detail",s)),o.s("player",m),o.Vb(),s}}(_=yn.prototype).destroy=function(){return Os.delete(this),Bn(this),_s&&Dn(this),this.j&&(this.j.stop(),this.j=null),this.F=this.s=null,this.h=this.m=!1,this.C=this.A=this.l=this.i=this.g=this.o=null,Promise.resolve()},_.xa=function(){return this.h},_.Ce=function(){return this.L},_.init=function(){if(this.G.length)if(o.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.j.ic();var s=new chrome.cast.SessionRequest(this.G,[],null,this.M,null);s=new chrome.cast.ApiConfig(s,(function(o){for(var s=t(Os),m=s.next();!m.done;m=s.next())En(m.value,o)}),(function(o){for(var s=t(Os),m=s.next();!m.done;m=s.next())m=m.value,as="available"==o,m.j.ic()}),"origin_scoped"),chrome.cast.initialize(s,(function(){}),(function(){})),as&&this.j.S(Qo),(s=_s)&&s.status!=chrome.cast.SessionStatus.STOPPED?En(this,s):_s=null}else o.__onGCastApiAvailable!==Hn&&(ws=o.__onGCastApiAvailable||null,o.__onGCastApiAvailable=Hn)},_.Ke=function(o){this.o=o,this.h&&Jn(this,{type:"appData",appData:this.o})},_.cast=function(o){var s=this;return I((function(m){if(!s.m)throw new N(1,8,8e3);if(!as)throw new N(1,8,8001);if(s.h)throw new N(1,8,8002);return s.l=new Je,chrome.cast.requestSession((function(m){return Kn(s,o,m)}),(function(o){return Ln(s,o)})),C(m,s.l,0)}))},_.Vb=function(){if(this.h){if(Bn(this),_s){Dn(this);try{_s.stop((function(){}),(function(){}))}catch(o){}_s=null}zn(this)}},_.get=function(o,s){var m=this;if("video"==o){if(Oo.includes(s))return function(){return m.Af.apply(m,[o,s].concat(v(La.apply(0,arguments))))}}else if("player"==o){if(Bo[s]&&!this.get("player","isLive")())return function(){};if(Go.includes(s))return function(){return m.Af.apply(m,[o,s].concat(v(La.apply(0,arguments))))};if(qo.includes(s))return function(){return m.$g.apply(m,[o,s].concat(v(La.apply(0,arguments))))};if(Fo[s]||No[s])return function(){return m.g[o][s]}}return this.g[o][s]},_.set=function(o,s,m){this.g[o][s]=m,Jn(this,{type:"set",targetName:o,property:s,value:m})},_.Af=function(o,s){Jn(this,{type:"call",targetName:o,methodName:s,args:La.apply(2,arguments)})},_.$g=function(o,s){var m=La.apply(2,arguments),_=new Je,S=this.H.toString();this.H++,this.i[S]=_;try{Jn(this,{type:"asyncCall",targetName:o,methodName:s,args:m,id:S})}catch(o){_.reject(o)}return _};var Qo=.02,as=!1,_s=null,ws=null,Os=new Set;function Hn(s){if(ws?o.__onGCastApiAvailable=ws:delete o.__onGCastApiAvailable,ws=null,s)for(var m=t(Os),_=m.next();!_.done;_=m.next())_.value.init();"function"==typeof o.__onGCastApiAvailable&&o.__onGCastApiAvailable(s)}function Nn(o,s,m,_){_=void 0!==_&&_,Te.call(this);var S=this;this.i=o,this.h=s,this.m=this.o=this.j=this.s=this.l=null,this.C=m,this.A=_,this.u=new Map,this.g=new yn(m,(function(){return On(S)}),(function(){return Pn(S)}),(function(o,s){return Qn(S,o,s)}),(function(){return Rn(S)}),(function(){return Sn(S)}),_),function Tn(o){o.g.init(),o.m=new lf;for(var s=t(Io),m=s.next();!m.done;m=s.next())o.m.D(o.i,m.value,(function(s){o.g.xa()||(s=Re(s),o.j.dispatchEvent(s))}));for(var _ in vr)o.m.D(o.h,vr[_],(function(s){o.g.xa()||o.o.dispatchEvent(s)}));for(var S in o.l={},s={},o.i)s.oc=S,Object.defineProperty(o.l,s.oc,{configurable:!1,enumerable:!0,get:function(s){return function(){return Un(o,s.oc)}}(s),set:function(s){return function(m){var _=s.oc;o.g.xa()?o.g.set("video",_,m):o.i[_]=m}}(s)}),s={oc:s.oc};o.s={},Vn(o,(function(s){Object.defineProperty(o.s,s,{configurable:!1,enumerable:!0,get:function get(){return function Wn(o,s){if(o.u.has(s)&&(s=o.u.get(s)),"addEventListener"==s)return function(s,m,_){return o.o.addEventListener(s,m,_)};if("removeEventListener"==s)return function(s,m,_){return o.o.removeEventListener(s,m,_)};if("getMediaElement"==s)return function(){return o.l};if("getSharedConfiguration"==s)return o.g.get("player","getConfiguration");if("getNetworkingEngine"==s)return function(){return o.h.zb()};if("getDrmEngine"==s)return function(){return o.h.m};if("getAdManager"==s)return function(){return o.h.jf()};if("setVideoContainer"==s)return function(s){return o.h.Kf(s)};if(o.g.xa()){if("getManifest"==s||"drmInfo"==s)return function(){return $a(s+"() does not work while casting!"),null};if("attach"==s||"detach"==s)return function(){return $a(s+"() does not work while casting!"),Promise.resolve()}}return o.g.xa()&&0==Object.keys(o.g.g.video).length&&(Fo[s]||No[s])||!o.g.xa()?o.h[s].bind(o.h):o.g.get("player",s)}(o,s)}})})),function Xn(o){var s=new Map;Vn(o,(function(m,_){s.has(_)?(_=s.get(_),m.length<_.length?o.u.set(m,_):o.u.set(_,m)):s.set(_,m)}))}(o),o.j=new Te,o.j.xd=o.l,o.o=new Te,o.o.xd=o.s}(this)}function Vn(o,s){function c(o){return"constructor"!=o&&"function"==typeof _[o]&&!S.has(o)}var m,_=o.h,S=new Set;for(m in _)c(m)&&(S.add(m),s(m,_[m]));for(o=Object.getPrototypeOf(_),m=Object.getPrototypeOf({});o&&o!=m;){for(var E=t(Object.getOwnPropertyNames(o)),A=E.next();!A.done;A=E.next())c(A=A.value)&&(S.add(A),s(A,_[A]));o=Object.getPrototypeOf(o)}}function Sn(o){var s={video:{},player:{},playerAfterLoad:{},manifest:o.h.ce(),startTime:null};o.i.pause();for(var m=t(Do),_=m.next();!_.done;_=m.next())_=_.value,s.video[_]=o.i[_];for(o.i.ended||(s.startTime=o.i.currentTime),_=(m=t(Vo)).next();!_.done;_=m.next()){var S=_.value;_=S[1],S=o.h[S[0]](),s.player[_]=S}for(_=(m=t(Ho)).next();!_.done;_=m.next())_=(S=_.value)[1],S=o.h[S[0]](),s.playerAfterLoad[_]=S;return s}function On(o){var s=new P("caststatuschanged");o.dispatchEvent(s)}function Pn(o){var s=new P(o.l.paused?"pause":"play");o.j.dispatchEvent(s)}function Rn(o){for(var s=t(Vo),m=s.next();!m.done;m=s.next()){var _=m.value;m=_[1],_=o.g.get("player",_[0])(),o.h[m](_)}var S=o.g.get("player","getAssetUri")();m=o.g.get("video","ended"),s=Promise.resolve();var E=o.i.autoplay;_=null,m||(_=o.g.get("video","currentTime")),S&&(o.i.autoplay=!1,s=o.h.load(S,_));var A={};for(_=(m=t(Do)).next();!_.done;_=m.next())_=_.value,A[_]=o.g.get("video",_);s.then((function(){if(o.i){for(var s=t(Do),m=s.next();!m.done;m=s.next())m=m.value,o.i[m]=A[m];for(m=(s=t(Ho)).next();!m.done;m=s.next()){var _=m.value;m=_[1],_=o.g.get("player",_[0])(),o.h[m](_)}o.i.autoplay=E,S&&o.i.play()}}),(function(s){s=new P("error",s=(new Map).set("detail",s)),o.h.dispatchEvent(s)}))}function Un(o,s){if("addEventListener"==s)return function(s,m,_){return o.j.addEventListener(s,m,_)};if("removeEventListener"==s)return function(s,m,_){return o.j.removeEventListener(s,m,_)};if(o.g.xa()&&0==Object.keys(o.g.g.video).length){var m=o.i[s];if("function"!=typeof m)return m}return o.g.xa()?o.g.get("video",s):("function"==typeof(s=o.i[s])&&(s=s.bind(o.i)),s)}function Qn(o,s,m){o.g.xa()&&("video"==s?o.j.dispatchEvent(m):"player"==s&&o.o.dispatchEvent(m))}function Yn(o,s,m,_){Te.call(this);var S=this;this.g=o,this.h=s,this.j=new lf,this.H={video:o,player:s},this.C=m||function(){},this.I=_||function(o){return o},this.i=null,this.F=!1,this.o=!0,this.m=0,this.A=!1,this.u=!0,this.s=this.l=null,this.G=new dd((function(){Zn(S)})),function $n(o){var s=cast.receiver.CastReceiverManager.getInstance();s.onSenderConnected=function(){return ao(o)},s.onSenderDisconnected=function(){return ao(o)},s.onSystemVolumeChanged=function(){var s=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();s&&bo(o,{type:"update",update:{video:{volume:s.level,muted:s.muted}}},o.l),bo(o,{type:"event",targetName:"video",event:{type:"volumechange"}},o.l)},o.s=s.getCastMessageBus("urn:x-cast:com.google.cast.media"),o.s.onMessage=function(s){return function co(o,s){var m=ln(s.data);switch(m.type){case"PLAY":o.g.play(),jo(o);break;case"PAUSE":o.g.pause(),jo(o);break;case"SEEK":s=m.currentTime;var _=m.resumeState;null!=s&&(o.g.currentTime=Number(s)),_&&"PLAYBACK_START"==_?(o.g.play(),jo(o)):_&&"PLAYBACK_PAUSE"==_&&(o.g.pause(),jo(o));break;case"STOP":o.h.Se().then((function(){o.h&&jo(o)}));break;case"GET_STATUS":mo(o,Number(m.requestId));break;case"VOLUME":s=(_=m.volume).level,_=_.muted;var S=o.g.volume,E=o.g.muted;null!=s&&(o.g.volume=Number(s)),null!=_&&(o.g.muted=_),S==o.g.volume&&E==o.g.muted||jo(o);break;case"LOAD":o.m=0,o.A=!1,o.u=!1,s=m.media,_=m.currentTime,S=o.I(s.contentId),E=m.autoplay||!0,o.C(s.customData),E&&(o.g.autoplay=!0),o.h.load(S,_).then((function(){o.h&&mo(o)})).catch((function(s){var _="LOAD_FAILED";7==s.category&&7e3==s.code&&(_="LOAD_CANCELLED"),bo(o,{requestId:Number(m.requestId),type:_},o.s)}));break;default:bo(o,{requestId:Number(m.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},o.s)}}(o,s)},o.l=s.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),o.l.onMessage=function(s){return function eo(o,s){var m=ln(s.data);switch(m.type){case"init":o.m=0,o.A=!1,o.u=!0,function ko(o,s,m){var _,S,E,A,O,H,K,z,G,q;I((function(X){switch(X.g){case 1:for(_ in s.player)S=s.player[_],o.h[_](S);return o.C(m),E=o.g.autoplay,s.manifest?(o.g.autoplay=!1,wa(X,5),C(X,o.h.load(s.manifest,s.startTime),7)):C(X,Promise.resolve(),3);case 7:Aa(X,3);break;case 5:return A=Ba(X),O=(new Map).set("detail",A),H=new P("error",O),o.h&&o.h.dispatchEvent(H),X.return();case 3:if(!o.h)return X.return();for(K in s.video)z=s.video[K],o.g[K]=z;for(G in s.playerAfterLoad)q=s.playerAfterLoad[G],o.h[G](q);o.g.autoplay=E,s.manifest&&(o.g.play(),jo(o)),D(X)}}))}(o,m.initState,m.appData),Zn(o);break;case"appData":o.C(m.appData);break;case"set":var _=m.targetName,S=m.property;if(m=m.value,"video"==_){if(s=cast.receiver.CastReceiverManager.getInstance(),"volume"==S){s.setSystemVolumeLevel(m);break}if("muted"==S){s.setSystemVolumeMuted(m);break}}o.H[_][S]=m;break;case"call":(_=o.H[m.targetName])[m.methodName].apply(_,m.args);break;case"asyncCall":_=m.targetName,S=m.methodName,"player"==_&&"load"==S&&(o.m=0,o.A=!1);var E=m.id,A=s.senderId;m=(s=o.H[_])[S].apply(s,m.args),"player"==_&&"load"==S&&(m=m.then((function(){o.u=!0}))),m.then((function(){return no(o,A,E,null)}),(function(s){return no(o,A,E,s)}))}}(o,s)},s.start();for(var m=(s=t(Io)).next();!m.done;m=s.next())o.j.D(o.g,m.value,(function(s){return fo(o,"video",s)}));for(var _ in vr)o.j.D(o.h,vr[_],(function(s){return fo(o,"player",s)}));cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?o.h.Me(3840,2160):o.h.Me(1920,1080),o.j.D(o.g,"loadeddata",(function(){o.A=!0})),o.j.D(o.h,"loading",(function(){o.o=!1,go(o)})),o.j.D(o.g,"playing",(function(){o.o=!1,go(o)})),o.j.D(o.g,"pause",(function(){go(o)})),o.j.D(o.h,"unloading",(function(){o.o=!0,go(o)})),o.j.D(o.g,"ended",(function(){new dd((function(){o.g&&o.g.ended&&(o.o=!0,go(o))})).S(Bs)}))}(this)}function ao(o){o.m=0,o.u=!0,o.F=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,go(o)}function go(o){var s;I((function(m){return 1==m.g?C(m,Promise.resolve(),2):o.h?(s=new P("caststatuschanged"),o.dispatchEvent(s),io(o)||jo(o),void D(m)):m.return()}))}function fo(o,s,m){o.h&&(Zn(o),bo(o,{type:"event",targetName:s,event:m},o.l))}function Zn(o){o.G.S(Us);for(var s={video:{},player:{}},m=t(Lo),_=m.next();!_.done;_=m.next())_=_.value,s.video[_]=o.g[_];if(o.h.T())for(var S in Bo)0==o.m%Bo[S]&&(s.player[S]=o.h[S]());for(var E in Fo)0==o.m%Fo[E]&&(s.player[E]=o.h[E]());for(var A in(m=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(s.video.volume=m.level,s.video.muted=m.muted),bo(o,{type:"update",update:s},o.l),No)0==o.m%No[A]&&((s={player:{}}).player[A]=o.h[A](),bo(o,{type:"update",update:s},o.l));o.A&&(o.m+=1),io(o)}function io(o){return!(!o.u||!o.g.duration&&!o.h.T())&&(mo(o),o.u=!1,!0)}function mo(o,s){var m={contentId:o.h.ce(),streamType:o.h.T()?"LIVE":"BUFFERED",contentType:""};o.h.T()||(m.duration=o.g.duration),o.i&&(m.metadata=o.i),jo(o,void 0===s?0:s,m)}function no(o,s,m,_){o.h&&bo(o,{type:"asyncComplete",id:m,error:_},o.l,s)}function bo(o,s,m,_){o.F&&(o=kn(s),_?m.getCastChannel(_).send(o):m.broadcast(o))}function jo(o,s,m){m=void 0===m?null:m;var _={mediaSessionId:0,playbackRate:o.g.playbackRate,playerState:o.o?Hs:o.h.ge()?Zs:o.g.paused?pu:Ys,currentTime:o.g.currentTime,supportedMediaCommands:63,volume:{level:o.g.volume,muted:o.g.muted}};m&&(_.media=m),bo(o,{requestId:void 0===s?0:s,type:"MEDIA_STATUS",status:[_]},o.s)}ra(Nn,Te),(_=Nn.prototype).destroy=function(o){return o&&this.g.Vb(),this.m&&(this.m.release(),this.m=null),o=[],this.h&&(o.push(this.h.destroy()),this.h=null),this.g&&(o.push(this.g.destroy()),this.g=null),this.s=this.l=this.i=null,Te.prototype.release.call(this),Promise.all(o)},_.Fg=function(){return this.l},_.vg=function(){return this.s},_.Xf=function(){return this.g.m&&as},_.xa=function(){return this.g.xa()},_.Ce=function(){return this.g.Ce()},_.cast=function(){var o,s=this;return I((function(m){return 1==m.g?(o=Sn(s),C(m,s.g.cast(o),2)):s.h?C(m,s.h.Se(),0):m.return()}))},_.Ke=function(o){this.g.Ke(o)},_.mh=function(){!function Mn(o){if(o.h){var s=o.I();chrome.cast.requestSession((function(m){return Kn(o,s,m)}),(function(s){return Ln(o,s)}))}}(this.g)},_.Vb=function(){this.g.Vb()},_.Yf=function(o,s){s=void 0!==s&&s;var m=this;return I((function(_){if(1==_.g)return o==m.C&&s==m.A?_.return():(m.C=o,m.A=s,m.g.Vb(),C(_,m.g.destroy(),2));m.g=null,m.g=new yn(o,(function(){return On(m)}),(function(){return Pn(m)}),(function(o,s){return Qn(m,o,s)}),(function(){return Rn(m)}),(function(){return Sn(m)}),s),m.g.init(),D(_)}))},L("shaka.cast.CastProxy",Nn),Nn.prototype.changeReceiverId=Nn.prototype.Yf,Nn.prototype.forceDisconnect=Nn.prototype.Vb,Nn.prototype.suggestDisconnect=Nn.prototype.mh,Nn.prototype.setAppData=Nn.prototype.Ke,Nn.prototype.cast=Nn.prototype.cast,Nn.prototype.receiverName=Nn.prototype.Ce,Nn.prototype.isCasting=Nn.prototype.xa,Nn.prototype.canCast=Nn.prototype.Xf,Nn.prototype.getPlayer=Nn.prototype.vg,Nn.prototype.getVideo=Nn.prototype.Fg,Nn.prototype.destroy=Nn.prototype.destroy,ra(Yn,Te),(_=Yn.prototype).isConnected=function(){return this.F},_.Kg=function(){return this.o},_.jh=function(o){this.i=o},_.ag=function(){this.i=null},_.kh=function(o){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.title=o},_.ih=function(o){this.i||(this.i={metadataType:cast.receiver.media.MetadataType.GENERIC}),this.i.images=[{url:o}]},_.hh=function(o){this.i||(this.i={}),this.i.artist=o,this.i.metadataType=cast.receiver.media.MetadataType.MUSIC_TRACK},_.destroy=function(){var o,s=this;return I((function(m){if(1==m.g)return s.j&&(s.j.release(),s.j=null),o=[],s.h&&(o.push(s.h.destroy()),s.h=null),s.G&&(s.G.stop(),s.G=null),s.g=null,s.H=null,s.C=null,s.F=!1,s.o=!0,s.l=null,s.s=null,Te.prototype.release.call(s),C(m,Promise.all(o),2);cast.receiver.CastReceiverManager.getInstance().stop(),D(m)}))},L("shaka.cast.CastReceiver",Yn),Yn.prototype.destroy=Yn.prototype.destroy,Yn.prototype.setContentArtist=Yn.prototype.hh,Yn.prototype.setContentImage=Yn.prototype.ih,Yn.prototype.setContentTitle=Yn.prototype.kh,Yn.prototype.clearContentMetadata=Yn.prototype.ag,Yn.prototype.setContentMetadata=Yn.prototype.jh,Yn.prototype.isIdle=Yn.prototype.Kg,Yn.prototype.isConnected=Yn.prototype.isConnected;var Us=.5,Bs=5,Hs="IDLE",Ys="PLAYING",Zs="BUFFERING",pu="PAUSED";function so(o,s,m,_,S){if(_>=S)return null;for(var E=-1,A=-1,O=0;O<m.length;O++)if(m[O].some((function(o){return null!=o&&""!=o.g.trim()}))){E=O;break}for(O=m.length-1;0<=O;O--)if(m[O].some((function(o){return null!=o&&""!=o.g.trim()}))){A=O;break}if(-1===E||-1===A)return null;for(var H=O=!1,K="white",z="black",G=to(_,S,O,H,K,z);E<=A;E++){for(var q=m[E],X=-1,J=-1,ae=0;ae<q.length;ae++)if(null!=q[ae]&&""!==q[ae].g.trim()){X=ae;break}for(ae=q.length-1;0<=ae;ae--)if(null!=q[ae]&&""!==q[ae].g.trim()){J=ae;break}if(-1===X||-1===J)q=uo(_,S),o.g.push(q);else{for(;X<=J;X++)if(ae=q[X]){var pe=ae.l,me=ae.i,_e=ae.j,Se=ae.h;pe==O&&me==H&&_e==K&&Se==z||(G.U&&o.g.push(G),G=to(_,S,pe,me,_e,Se),O=pe,H=me,K=_e,z=Se),G.U+=ae.g}else G.U+=" ";G.U&&o.g.push(G),E!==A&&(G=uo(_,S),o.g.push(G)),G=to(_,S,O,H,K,z)}}return o.g.length?{cue:o,stream:s}:null}function to(o,s,m,_,S,E){return o=new yb(o,s,""),m&&o.h.push("underline"),_&&(o.o="italic"),o.j=S,o.backgroundColor=E,o}function uo(o,s){return(o=new yb(o,s,"")).F=!0,o}function vo(o,s,m,_,S){this.g=o,this.l=s,this.i=m,this.h=_,this.j=S}function wo(o,s){this.i=[],this.g=1,this.h=0,this.u=o,this.s=s,this.j=this.m=!1,this.l="white",this.o="black",xo(this)}function yo(o,s,m){var _="CC"+(o.u<<1|o.s+1),S=new yb(s,m,"");return S.H=1,S.m=o.g/16*100,so(S,_,o.i,s,m)}function xo(o){zo(o,0,15),o.g=1}function Ao(o,s,m){if(!(32>m||127<m)){var _="";switch(s){case _u:_=Ql.has(m)?Ql.get(m):String.fromCharCode(m);break;case vl:_=nc.get(m);break;case _l:o.i[o.g].pop(),_=ic.get(m);break;case Pl:o.i[o.g].pop(),_=ac.get(m)}_&&o.i[o.g].push(new vo(_,o.m,o.j,o.o,o.l))}}function Jo(o,s,m,_){if(!(0>m||0>s))if(s>=m)for(--_;0<=_;_--)o.i[s+_]=o.i[m+_].map((function(o){return o}));else for(var S=0;S<_;S++)o.i[s+S]=o.i[m+S].map((function(o){return o}))}function zo(o,s,m){for(var _=0;_<=m;_++)o.i[s+_]=[]}var _u=0,vl=1,_l=2,Pl=3,Ql=new Map([[39,"’"],[42,"á"],[92,"é"],[92,"é"],[94,"í"],[95,"ó"],[96,"ú"],[123,"ç"],[124,"÷"],[125,"Ñ"],[126,"ñ"],[127,"█"]]),nc=new Map([[48,"®"],[49,"°"],[50,"½"],[51,"¿"],[52,"™"],[53,"¢"],[54,"£"],[55,"♪"],[56,"à"],[57,"⠀"],[58,"è"],[59,"â"],[60,"ê"],[61,"î"],[62,"ô"],[63,"û"]]),ic=new Map([[32,"Á"],[33,"É"],[34,"Ó"],[35,"Ú"],[36,"Ü"],[37,"ü"],[38,"‘"],[39,"¡"],[40,"*"],[41,"'"],[42,"─"],[43,"©"],[44,"℠"],[45,"·"],[46,"“"],[47,"”"],[48,"À"],[49,"Â"],[50,"Ç"],[51,"È"],[52,"Ê"],[53,"Ë"],[54,"ë"],[55,"Î"],[56,"Ï"],[57,"ï"],[58,"Ô"],[59,"Ù"],[60,"ù"],[61,"Û"],[62,"«"],[63,"»"]]),ac=new Map([[32,"Ã"],[33,"ã"],[34,"Í"],[35,"Ì"],[36,"ì"],[37,"Ò"],[38,"ò"],[39,"Õ"],[40,"õ"],[41,"{"],[42,"}"],[43,"\\"],[44,"^"],[45,"_"],[46,"|"],[47,"~"],[48,"Ä"],[49,"ä"],[50,"Ö"],[51,"ö"],[52,"ß"],[53,"¥"],[54,"¤"],[55,"│"],[56,"Å"],[57,"å"],[58,"Ø"],[59,"ø"],[60,"┌"],[61,"┐"],[62,"└"],[63,"┘"]]);function Ko(o,s){this.h=lc,this.o=new wo(o,s),this.i=new wo(o,s),this.g=this.j=new wo(o,s),this.l=0,this.m=null}function Mo(o,s,m){o.g=o.i;var _=o.g,S=null;return o.h!==yc&&o.h!==_c&&(S=yo(_,o.l,m),(m=o.i).g=0<m.h?m.h:0,zo(m,0,15),(m=o.j).g=0<m.h?m.h:0,zo(m,0,15),_.g=15),o.h=yc,_.h=s,S}function Po(o){o.h=mc,o.g=o.j,o.g.h=0}function Ro(o){ab("Cea608DataChannel","CEA-608 text mode entered, but is unsupported"),o.g=o.o,o.h=_c}var lc=0,mc=1,yc=3,_c=4,kc="black green blue cyan red yellow magenta black".split(" "),Ec="white green blue cyan red yellow magenta white_italics".split(" ");function Uo(){this.l=!1,this.A=this.F=0,this.C=Mc,this.i=[],this.g=this.h=this.j=0,this.u=this.o=!1,this.s="white",this.m="black",Wo(this)}function Wo(o){o.i=[];for(var s=0;16>s;s++)o.i.push(Xo())}function Xo(){for(var o=[],s=0;42>s;s++)o.push(null);return o}function Yo(o,s){Zo(o)&&(o.i[o.h][o.g]=new vo(s,o.u,o.o,o.m,o.s),o.g++)}function Zo(o){var s=o.g<o.A&&0<=o.g;return o.h<o.F&&0<=o.h&&s}function $o(o,s,m){var _=new yb(o.j,s,"");return _.textAlign=o.C===Ac?"left":o.C===Dc?"right":_e,(m=so(_,"svc"+m,o.i,o.j,s))&&(o.j=s),m}Uo.prototype.isVisible=function(){return this.l};var Ac=0,Dc=1,Mc=2;function cp(){this.i=[],this.h=null,this.g=0}function dp(o,s){3===s.type?(o.g=2*(63&s.value)-1,o.h=[]):o.h&&(0<o.g&&(o.h.push(s),o.g--),0===o.g&&(o.i.push(new ep(o.h)),o.h=null,o.g=0))}function ep(o){this.g=0,this.h=o}function fp(o){if(!o.ja())throw new N(2,2,3e3);return o.h[o.g++]}function gp(o){this.i=o,this.h=[null,null,null,null,null,null,null,null],this.g=null}function hp(o,s,m,_){if(128<=m&&135>=m)_=7&m,o.h[_]&&(o.g=o.h[_]);else{if(136===m){m=fp(s).value,s=null;for(var S=(m=t(ip(o,m))).next();!S.done;S=m.next())(S=o.h[S.value]).isVisible()&&(s=$o(S,_,o.i)),Wo(S);return s}if(137===m)for(m=(s=t(ip(o,s=fp(s).value))).next();!m.done;m=s.next())(m=o.h[m.value]).isVisible()||(m.j=_),m.l=!0;else{if(138===m){for(m=fp(s).value,s=null,S=(m=t(ip(o,m))).next();!S.done;S=m.next())(S=o.h[S.value]).isVisible()&&(s=$o(S,_,o.i)),S.l=!1;return s}if(139===m){for(m=fp(s).value,s=null,S=(m=t(ip(o,m))).next();!S.done;S=m.next())(S=o.h[S.value]).isVisible()?s=$o(S,_,o.i):S.j=_,S.l=!S.l;return s}if(140===m)return jp(o,s=fp(s).value,_);if(143===m)return _=jp(o,255,_),kp(o),_;if(144===m)s.skip(1),_=fp(s).value,o.g&&(o.g.o=0<(128&_),o.g.u=0<(64&_));else if(145===m)_=fp(s).value,m=fp(s).value,s.skip(1),o.g&&(s=lp((48&m)>>4,(12&m)>>2,3&m),o.g.s=lp((48&_)>>4,(12&_)>>2,3&_),o.g.m=s);else if(146===m)_=fp(s).value,s=fp(s).value,o.g&&((o=o.g).h=15&_,o.g=63&s);else if(151===m)s.skip(1),s.skip(1),_=fp(s).value,s.skip(1),o.g&&(o.g.C=3&_);else if(152<=m&&159>=m){if(m=(15&m)-8,!(S=null!==o.h[m])){var E=new Uo;E.j=_,o.h[m]=E}_=fp(s).value,fp(s),fp(s),E=fp(s).value;var A=fp(s).value;s=fp(s).value,S&&0==(7&s)||((s=o.h[m]).h=0,s.g=0,s.u=!1,s.o=!1,s.s="white",s.m="black"),(s=o.h[m]).l=0<(32&_),s.F=1+(15&E),s.A=1+(63&A),o.g=o.h[m]}}}return null}function ip(o,s){for(var m=[],_=0;8>_;_++)1==(1&s)&&o.h[_]&&m.push(_),s>>=1;return m}function jp(o,s,m){for(var _=null,S=(s=t(ip(o,s))).next();!S.done;S=s.next()){S=S.value;var E=o.h[S];E.isVisible()&&(_=$o(E,m,o.i)),o.h[S]=null}return _}function kp(o){o.g=null,o.h=[null,null,null,null,null,null,null,null]}function lp(o,s,m){var _={0:0,1:0,2:1,3:1};return zc[(o=_[o])<<2|(s=_[s])<<1|(m=_[m])]}ep.prototype.ja=function(){return this.g<this.h.length},ep.prototype.ha=function(){return this.g},ep.prototype.skip=function(o){if(this.g+o>this.h.length)throw new N(2,2,3e3);this.g+=o};var jc=new Map([[32," "],[33," "],[37,"…"],[42,"Š"],[44,"Œ"],[48,"█"],[49,"‘"],[50,"’"],[51,"“"],[52,"”"],[53,"•"],[57,"™"],[58,"š"],[60,"œ"],[61,"℠"],[63,"Ÿ"],[118,"⅛"],[119,"⅜"],[120,"⅝"],[121,"⅞"],[122,"│"],[123,"┐"],[124,"└"],[125,"─"],[126,"┘"],[127,"┌"]]),zc="black blue green cyan red magenta yellow white".split(" ");function op(){this.h=[],this.g=[],this.i=new cp,this.l=0,this.m=new Map([["CC1",new Ko(0,0)],["CC2",new Ko(0,1)],["CC3",new Ko(1,0)],["CC4",new Ko(1,1)]]),this.s=this.o=0,this.j=new Map,this.u=!0,pp(this)}function pp(o){o.o=0,o.s=0;for(var s=t(o.m.values()),m=s.next();!m.done;m=s.next())(m=m.value).h=lc,m.g=m.j,m.m=null,xo(m.i),xo(m.j),xo(m.o);o.u=!0}function qp(o,s){var m=s.type;if(16==(112&s.Ea)){var _=s.Ea>>3&1;0===m?o.o=_:o.s=_}if(m=o.m.get("CC"+(m<<1|(m?o.s:o.o)+1)),255===s.Ea&&255===s.$a||!s.Ea&&!s.$a||!sp(s.Ea)||!sp(s.$a))return 45<=++o.l&&pp(o),null;if(o.l=0,s.Ea&=127,s.$a&=127,!s.Ea&&!s.$a)return null;if(o=null,16==(112&s.Ea))e:{if(_=s.Ea,o=s.$a,m.m===(_<<8|o))m.m=null;else if(m.m=_<<8|o,16==(240&_)&&64==(192&o)){s=[11,11,1,2,3,4,12,13,14,15,5,6,7,8,9,10][(7&_)<<1|o>>5&1];var S=(30&o)>>1;_="white";var E=!1;7>S?_=Ec[S]:7===S&&(E=!0),o=1==(1&o),m.h!==_c&&(S=m.g,m.h===yc&&s!==S.g&&(Jo(S,m=1+s-S.h,1+S.g-S.h,S.h),zo(S,0,m-1),zo(S,s+1,15-s)),S.g=s,S.m=o,S.j=E,S.l=_,S.o="black")}else if(17==(247&_)&&32==(240&o))m.g.m=!1,m.g.j=!1,m.g.l="white",Ao(m.g,_u,32),_=!1,"white_italics"===(s=Ec[(14&o)>>1])&&(s="white",_=!0),m.g.m=1==(1&o),m.g.j=_,m.g.l=s;else if(16==(247&_)&&32==(240&o)||23==(247&_)&&45==(255&o))s="black",0==(7&_)&&(s=kc[(14&o)>>1]),m.g.o=s;else if(17==(247&_)&&48==(240&o))Ao(m.g,vl,o);else if(18==(246&_)&&32==(224&o))Ao(m.g,1&_?Pl:_l,o);else if(20==(246&_)&&32==(240&o)){switch(o=s.pts,_=null,s.$a){case 32:Po(m);break;case 33:(m=m.g).i[m.g].pop();break;case 37:_=Mo(m,2,o);break;case 38:_=Mo(m,3,o);break;case 39:_=Mo(m,4,o);break;case 40:Ao(m.g,_u,32);break;case 41:m.h=2,m.g=m.i,m.g.h=0,m.l=o;break;case 42:xo(m.o),Ro(m);break;case 43:Ro(m);break;case 44:s=m.i,_=null,m.h!==_c&&(_=yo(s,m.l,o)),zo(s,0,15);break;case 45:s=m.g,m.h!==yc?_=null:(_=yo(s,m.l,o),Jo(s,(E=s.g-s.h+1)-1,E,s.h),zo(s,0,E-1),zo(s,s.g,15-s.g),m.l=o);break;case 46:zo(m.j,0,15);break;case 47:s=null,m.h!==_c&&(s=yo(m.i,m.l,o)),_=m.j,m.j=m.i,m.i=_,Po(m),m.l=o,_=s}o=_;break e}o=null}else _=s.$a,Ao(m.g,_u,s.Ea),Ao(m.g,_u,_);return o}function rp(o,s){var m=[];try{for(;s.ja();){var _=fp(s).value,S=(224&_)>>5,E=31&_;if(7===S&&0!=E&&(S=63&fp(s).value),0!=S){o.j.has(S)||o.j.set(S,new gp(S));for(var A=o.j.get(S),O=s.ha();s.ha()-O<E;){var H=fp(S=s),K=H.value,z=H.pts;if(16===K)K=K<<16|fp(S).value;if(0<=K&&31>=K){var G=z;if(A.g){var q=A.g;switch(S=null,K){case 8:!Zo(q)||0>=q.g&&0>=q.h||(0>=q.g?(q.g=q.A-1,q.h--):q.g--,q.i[q.h][q.g]=null);break;case 13:if(q.isVisible()&&(S=$o(q,G,A.i)),q.h+1>=q.F){G=q;for(var X=0,J=1;16>J;J++,X++)G.i[X]=G.i[J];for(J=0;1>J;J++,X++)G.i[X]=Xo()}else q.h++;q.g=0;break;case 14:q.isVisible()&&(S=$o(q,G,A.i)),q.i[q.h]=Xo(),q.g=0;break;case 12:q.isVisible()&&(S=$o(q,G,A.i)),Wo(q),(G=q).h=0,G.g=0}var ae=S}else ae=null}else if(128<=K&&159>=K)ae=hp(A,S,K,z);else{if(4096<=K&&4127>=K)8<=(G=255&K)&&15>=G?S.skip(1):16<=G&&23>=G?S.skip(2):24<=G&&31>=G&&S.skip(3);else if(4224<=K&&4255>=K)128<=(G=255&K)&&135>=G?S.skip(4):136<=G&&143>=G&&S.skip(5);else if(32<=K&&127>=K)S=K,A.g&&Yo(A.g,127===S?"♪":String.fromCharCode(S));else if(160<=K&&255>=K)A.g&&Yo(A.g,String.fromCharCode(K));else if(4128<=K&&4223>=K){if(S=255&K,A.g)if(jc.has(S)){var pe=jc.get(S);Yo(A.g,pe)}else Yo(A.g,"_")}else 4256<=K&&4351>=K&&A.g&&Yo(A.g,160!=(255&K)?"_":"[CC]");ae=null}(S=ae)&&m.push(S)}}}}catch(o){if(!(o instanceof N&&3e3===o.code))throw o;ab("CEA708_INVALID_DATA","Buffer read out of bounds / invalid CEA-708 Data.")}return m}function sp(o){for(var s=0;o;)s^=1&o,o>>=1;return 1===s}function tp(o){for(var s=[],m=o,_=o=0;_<m.length;)2==o&&3==m[_]?(o=0,(m=[].concat(v(m))).splice(_,1),m=new Uint8Array(m)):0==m[_]?o++:o=0,_++;for(o=m,_=0;_<o.length;){for(m=0;255==o[_];)m+=255,_++;m+=o[_++];for(var S=0;255==o[_];)S+=255,_++;S+=o[_++],4==m&&s.push(o.subarray(_,_+S)),_+=S}return s}function up(){this.j=new Map,this.i=this.h=0,this.g=qc}op.prototype.clear=function(){this.l=0,this.h=[],this.g=[];var o=this.i;o.i=[],o.h=[],o.g=0,pp(this);for(var s=(o=t(this.j.values())).next();!s.done;s=o.next())kp(s.value)},op.prototype.extract=function(o,s){if(this.u){for(var m=t(this.m.values()),_=m.next();!_.done;_=m.next())_.value.l=s;this.u=!1}if(181===(o=new Df(o,0)).qa()&&49===o.Ia()&&1195456820===o.K()&&3===o.qa()&&0!=(64&(m=o.qa())))for(m&=31,o.skip(1),_=0;_<m;_++){var S=o.qa(),E=(4&S)>>2,A=o.qa(),O=o.qa();E&&(0===(S&=3)||1===S?this.h.push({pts:s,type:S,Ea:A,$a:O,order:this.h.length}):(this.g.push({pts:s,type:S,value:A,order:this.g.length}),this.g.push({pts:s,type:2,value:O,order:this.g.length})))}},op.prototype.decode=function(){function a(o,s){return o.pts-s.pts||o.order-s.order}var o=[];this.h.sort(a),this.g.sort(a);for(var s=t(this.h),m=s.next();!m.done;m=s.next())(m=qp(this,m.value))&&o.push(m);for(m=(s=t(this.g)).next();!m.done;m=s.next())dp(this.i,m.value);for(m=(s=t(this.i.i)).next();!m.done;m=s.next())m=rp(this,m.value),o.push.apply(o,v(m));return this.i.i=[],this.h=[],this.g=[],o},L("shaka.cea.CeaDecoder",op),pe=function tb(){return new op},up.prototype.init=function(o){function b(o){(o=o.name)in Cd&&(s.g=Cd[o])}var s=this,m=[],_=[];if((new Gf).box("moov",Lf).box("mvex",Lf).O("trex",(function(o){var m=o.reader;m.skip(4),m.skip(4),o=m.K(),m=m.K(),s.h=o,s.i=m})).box("trak",Lf).O("tkhd",(function(o){o=Mh(o.reader,o.version),m.push(o.trackId)})).box("mdia",Lf).O("mdhd",(function(o){o=Kh(o.reader,o.version),_.push(o.timescale)})).box("minf",Lf).box("stbl",Lf).O("stsd",Nf).box("avc1",b).box("avc3",b).box("hev1",b).box("hvc1",b).box("dvh1",b).box("dvhe",b).box("encv",Of).box("sinf",Lf).box("frma",(function(o){(o=Ph(o.reader).Pa)in Cd&&(s.g=Cd[o])})).parse(o,!0),!m.length||!_.length||m.length!=_.length)throw new N(2,2,2010);this.g==qc&&$a("Unable to determine bitstream format for CEA parsing!"),m.forEach((function(o,m){s.j.set(o,_[m])}))},up.prototype.parse=function(o){var s=this;if(this.g==qc)return[];var m=[],_=this.h,S=this.i,E=0,A=[],O=null,H=9e4;return(new Gf).box("moof",(function(o){E=o.start,A=[],Lf(o)})).box("traf",Lf).O("trun",(function(o){o=Lh(o.reader,o.version,o.flags),A.push(o)})).O("tfhd",(function(o){o=Ih(o.reader,o.flags),_=o.ef||s.h,S=o.eg||s.i,o=o.trackId,s.j.has(o)&&(H=s.j.get(o))})).O("tfdt",(function(o){O=Jh(o.reader,o.version).baseMediaDecodeTime})).box("mdat",(function(o){if(null===O)throw $a("Unable to find base media decode time for CEA captions!"),new N(2,2,2010);!function xp(o,s,m,_,S,E,A,O,H){var K=0,z=E,G=O.map((function(o){return o.Bf}));for((G=[].concat.apply([],v(G))).length&&(z=G[0].sampleSize||E),s.skip(A+O[0].dg);s.ja();){A=s.K();var q=s.qa(),X=null;switch(X=!1,O=1,o.g){case Xc:X=6==(X=31&q);break;case _d:O=2,s.skip(1),X=39==(X=q>>1&63)||40==X;break;default:return}if(X)for(q=0,K<G.length&&(q=G[K].Ld||0),q=(m+q)/_,X=(O=t(tp(s.kb(A-O)))).next();!X.done;X=O.next())H.push({packet:X.value,pts:q});else try{s.skip(A-O)}catch(o){break}0==(z-=A+4)&&(m=K<G.length?m+(G[K].Ge||S):m+S,z=++K<G.length&&G[K].sampleSize||E)}}(s,o.reader,O,H,_,S,E-o.start-8,A,m)})).parse(o,!1),m},L("shaka.cea.Mp4CeaParser",up);var qc=0,Xc=1,_d=2,Cd={avc1:Xc,avc3:Xc,hev1:_d,hvc1:_d,dvh1:_d,dvhe:_d};function Ap(){}function Bp(o,s,m){var _=function Cp(o){for(var s=[],m=(o=t(o)).next();!m.done;m=o.next())(m=Kp(m.value))&&s.push(m);return s}(o),S=null;o=[];var E=[],A=new Set(_.map((function(o){return o.keyId})));if(A.delete(null),1<A.size)throw new N(2,4,4010);if(s||(E=_.filter((function(o){return"urn:mpeg:dash:mp4protection:2011"!=o.He||(S=o.init||S,!1)})),E.length&&(o=function Dp(o,s,m,_){for(var S=[],E=(s=t(s)).next();!E.done;E=s.next()){var A=m[(E=E.value).He];if(A){var O;if(O=ag(E.node,"urn:microsoft:playready","pro")){O=Tf(O.textContent);var H=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);O=[{initData:Yf(O,H,new Set,0),initDataType:"cenc",keyId:E.keyId}]}else O=null;if(H=null,"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e"===E.He)if(0==(H=_).size)H=null;else{var K=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]);H=[{initData:Yf(new Uint8Array([]),K,H,1),initDataType:"cenc",keyId:E.keyId}]}O=vc(A,E.init||o||O||H),(A=Rd.get(A))&&(O.licenseServerUri=A(E)),S.push(O)}}return S}(S,E,m,A),0==o.length&&(o=[vc("",S)]))),_.length&&(s||!E.length))for(o=[],m=(s=t(Object.values(m))).next();!m.done;m=s.next())"org.w3.clearkey"!=(m=m.value)&&o.push(vc(m,S));if(A=Array.from(A)[0]||null)for(m=(s=t(o)).next();!m.done;m=s.next())for(_=(m=t(m.value.initData)).next();!_.done;_=m.next())_.value.keyId=A;return{df:A,di:S,drmInfos:o,hf:!0}}function Hp(o){var s=ag(o.node,"https://dashif.org/CPS","Laurl");return s&&s.textContent?s.textContent:(o=ag(o.node,"urn:microsoft:playready","pro"))?(o=function Fp(o){var s=0,m=pb(o),_=m.getUint32(s,!0);if(_!=o.byteLength)return[];e:{for(o=s+6,s=[];o<m.byteLength-1;){_=m.getUint16(o,!0),o+=2;var S=m.getUint16(o,!0);if(o+=2,0!=(1&S)||S+o>m.byteLength){m=[];break e}var E=M(m,o,S);s.push({type:_,value:E}),o+=S}m=s}return m}(o=Tf(o.textContent)).filter((function(o){return o.type===Ad}))[0],o&&(o=rg(o=yf(o.value,!0),"WRMHEADER"))?function Gp(o){for(var s=(o=t(o.getElementsByTagName("DATA"))).next();!s.done;s=o.next())for(var m=(s=t(s.value.childNodes)).next();!m.done;m=s.next())if((m=m.value)instanceof Element&&"LA_URL"==m.tagName)return m.textContent;return""}(o):""):""}function Kp(o){var s=o.getAttribute("schemeIdUri"),m=dg(o,"urn:mpeg:cenc:2013","default_KID"),_=bg(o,"urn:mpeg:cenc:2013","pssh").map(fg);if(!s)return null;if(s=s.toLowerCase(),m&&(m=m.replace(/-/g,"").toLowerCase()).includes(" "))throw new N(2,4,4009);var S=[];try{S=_.map((function(o){return{initDataType:"cenc",initData:Tf(o),keyId:null}}))}catch(o){throw new N(2,4,4007)}return{node:o,He:s,keyId:m,init:0<S.length?S:null}}ae["video/mp4"]=function(){return new up},Ap.prototype.init=function(){},Ap.prototype.parse=function(o){var s=[];if(!ci(o=M(o)))return s;for(var m=(o=t(o=(new Zh).parse(o).ee())).next();!m.done;m=o.next())if(6==(m=m.value).type&&null!=m.time)for(var _=t(tp(m.data)),S=_.next();!S.done;S=_.next())s.push({packet:S.value,pts:m.time});return s},L("shaka.cea.TsCeaParser",Ap),ae["video/mp2t"]=function(){return new Ap};var Ad=1,Rd=(new Map).set("com.widevine.alpha",(function(o){var s=ag(o.node,"https://dashif.org/CPS","Laurl");return s&&s.textContent?s.textContent:(o=ag(o.node,"urn:microsoft","laurl"))&&o.getAttribute("licenseUrl")||""})).set("com.microsoft.playready",Hp).set("com.microsoft.playready.recommendation",Hp).set("com.microsoft.playready.software",Hp).set("com.microsoft.playready.hardware",Hp).set("org.w3.clearkey",(function(o){var s=ag(o.node,"https://dashif.org/CPS","Laurl");return s&&s.textContent?s.textContent:(o=ag(o.node,"http://dashif.org/guidelines/clearKey","Laurl"))&&"EME-1.0"===o.getAttribute("Lic_type")&&o.textContent?o.textContent:""}));function Lp(s,m,_,S,E){var A={RepresentationID:m,Number:_,Bandwidth:S,Time:E};return s.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(s,m,_,S){if("$$"==s)return"$";var E=A[m];if(null==E)return s;switch("RepresentationID"==m&&_&&(_=void 0),"Time"==m&&(E=Math.round(E)),S){case void 0:case"d":case"i":case"u":s=E.toString();break;case"o":s=E.toString(8);break;case"x":s=E.toString(16);break;case"X":s=E.toString(16).toUpperCase();break;default:s=E.toString()}return _=o.parseInt(_,10)||1,Array(Math.max(0,_-s.length)+1).join("0")+s}))}function Mp(o,s){var m=Np(o,s,"timescale"),_=1;m&&(_=mg(m)||1);var S=Np(o,s,"duration");m=mg(S||""),"image"==o.J.contentType&&(m=og(S||"")),m&&(m/=_);var E=Np(o,s,"startNumber");S=Number(Np(o,s,"presentationTimeOffset"))||0;var A=ng(E||"");if(null!=E&&null!=A||(A=1),E=Op(o,s,"SegmentTimeline"),s=null,E){s=_,o=o.$.duration||1/0,E=$f(E,"S");for(var O=[],H=-S,K=0;K<E.length;++K){var z=E[K],G=E[K+1],q=hg(z,"t",ng),X=hg(z,"d",ng);if(z=hg(z,"r",lg),null!=q&&(q-=S),!X)break;if(q=null!=q?q:H,0>(z=z||0))if(G){if(null==(G=hg(G,"t",ng)))break;if(q>=G)break;z=Math.ceil((G-q)/X)-1}else{if(1/0==o)break;if(q/s>=o)break;z=Math.ceil((o*s-q)/X)-1}for(0<O.length&&q!=H&&(O[O.length-1].end=q/s),G=0;G<=z;++G)H=q+X,O.push({start:q/s,end:H/s,Ue:q}),q=H}s=O}return{timescale:_,ma:m,hc:A,lb:S/_||0,Te:S,timeline:s}}function Np(o,s,m){return[s(o.J),s(o.ea),s(o.ia)].filter(tc).map((function(o){return o.getAttribute(m)})).reduce((function(o,s){return o||s}))}function Op(o,s,m){return[s(o.J),s(o.ea),s(o.ia)].filter(tc).map((function(o){return Zf(o,m)})).reduce((function(o,s){return o||s}))}function Qp(o,s,m,_,S,E){if(E=void 0===E?0:E,dg(o,"http://www.w3.org/1999/xlink","href")){var A=function Pp(o,s,m,_,S,E){for(var A=dg(o,"http://www.w3.org/1999/xlink","href"),O=dg(o,"http://www.w3.org/1999/xlink","actuate")||"onRequest",H=t(Array.from(o.attributes)),K=H.next();!K.done;K=H.next())"http://www.w3.org/1999/xlink"==(K=K.value).namespaceURI&&o.removeAttributeNS(K.namespaceURI,K.localName);if(5<=E)return Le(new N(2,4,4028));if("onLoad"!=O)return Le(new N(2,4,4027));var z=uc([_],[A]);return S.request(0,bf(z,s)).fa((function(_){if(!(_=tg(_.data,o.tagName)))return Le(new N(2,4,4001,A));for(;o.childNodes.length;)o.removeChild(o.childNodes[0]);for(;_.childNodes.length;){var O=_.childNodes[0];_.removeChild(O),o.appendChild(O)}for(O=(_=t(Array.from(_.attributes))).next();!O.done;O=_.next())o.setAttributeNode(O.value.cloneNode(!1));return Qp(o,s,m,z[0],S,E+1)}))}(o,s,m,_,S,E);return m&&(A=A.fa(void 0,(function(){return Qp(o,s,m,_,S,E)}))),A}A=[];for(var O=t(Array.from(o.childNodes)),H=O.next();!H.done;H=O.next())(H=H.value)instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==dg(H,"http://www.w3.org/1999/xlink","href")?o.removeChild(H):"SegmentTimeline"!=H.tagName&&A.push(Qp(H,s,m,_,S,E)));return Pe(A).fa((function(){return o}))}function Rp(o,s,m,_,S,E,A){var O,H=(new Gf).O("sidx",(function(o){O=function Sp(o,s,m,_,S,E,A){var O=[];A.reader.skip(4);var H=A.reader.K();if(0==H)throw new N(2,3,3005);if(0==A.version)var K=A.reader.K(),z=A.reader.K();else K=A.reader.dc(),z=A.reader.dc();A.reader.skip(2);var G=A.reader.Ia();for(o=o+A.size+z,z=0;z<G;z++){var q=A.reader.K(),X=(2147483648&q)>>>31;q&=2147483647;var J=A.reader.K();if(A.reader.skip(4),1==X)throw new N(2,3,3006);O.push(new Q(K/H+m,(K+J)/H+m,(function(){return E}),o,o+q-1,s,m,_,S)),K+=J,o+=q}return A.parser.stop(),O}(s,_,S,E,A,m,o)}));if(o&&H.parse(o),O)return O;throw new N(2,3,3004)}function Tp(o){this.h=pb(o),this.g=new Df(this.h,0)}function Up(o){var s=Vp(o);if(7<s.length)throw new N(2,3,3002);for(var m=0,_=(s=t(s)).next();!_.done;_=s.next())m=256*m+_.value;s=Vp(o);e:{for(var S=(_=t(Ud)).next();!S.done;S=_.next())if(lb(s,new Uint8Array(S.value))){_=!0;break e}_=!1}if(_)s=o.h.byteLength-o.g.ha();else{if(8==s.length&&224&s[1])throw new N(2,3,3001);for(S=_=0;S<s.length;S++){var E=s[S];_=0==S?E&(1<<8-s.length)-1:256*_+E}s=_}return s=o.g.ha()+s<=o.h.byteLength?s:o.h.byteLength-o.g.ha(),_=pb(o.h,o.g.ha(),s),o.g.skip(s),new Xp(m,_)}function Vp(o){var s=o.g.ha(),m=o.g.qa();if(0==m)throw new N(2,3,3002);return m=8-Math.floor(Math.log2(m)),o.g.skip(m-1),M(o.h,s,m)}Tp.prototype.ja=function(){return this.g.ja()};var Ud=[[255],[127,255],[63,255,255],[31,255,255,255],[15,255,255,255,255],[7,255,255,255,255,255],[3,255,255,255,255,255,255],[1,255,255,255,255,255,255,255]];function Xp(o,s){this.id=o,this.g=s}function Yp(o){if(8<o.g.byteLength)throw new N(2,3,3002);if(8==o.g.byteLength&&224&o.g.getUint8(0))throw new N(2,3,3001);for(var s=0,m=0;m<o.g.byteLength;m++){s=256*s+o.g.getUint8(m)}return s}function $p(o){var s=new Tp(o.g);if(179!=(o=Up(s)).id)throw new N(2,3,3013);if(o=Yp(o),183!=(s=Up(s)).id)throw new N(2,3,3012);s=new Tp(s.g);for(var m=0;s.ja();){var _=Up(s);if(241==_.id){m=Yp(_);break}}return{ph:o,Zg:m}}function aq(o,s){if(!(s=Op(o,s,"Initialization")))return null;var m=o.J.Da,_=s.getAttribute("sourceURL");_&&(m=uc(o.J.Da,[_])),_=0;var S=null;return(s=hg(s,"range",kg))&&(_=s.start,S=s.end),new sh((function(){return m}),_,S,bq(o))}function cq(o,s){var m=Number(Np(o,dq,"presentationTimeOffset"))||0,_=Np(o,dq,"timescale"),S=1;_&&(S=mg(_)||1);var E=m/S||0,A=aq(o,dq);!function eq(o,s){if(hq(o,s),!fq(o))throw new N(2,4,4002)}(o,A);var O=Ve(o);return{Wb:function Wb(){var o=Op(O,dq,"RepresentationIndex"),m=O.J.Da;return o&&(o=o.getAttribute("sourceURL"))&&(m=uc(O.J.Da,[o])),o=fq(O),gq(O,s,A,m,o.start,o.end,E)}}}function gq(o,s,m,_,S,E,A){var O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De;return I((function($e){if(1==$e.g)return O=o.presentationTimeline,H=!o.rb||!o.$.he,K=o.$.start,z=o.$.duration,G=o.J.mimeType.split("/")[1],X=null,J=[(q=s)(_,S,E,!1),"webm"==G?q(m.wa(),m.Ba,m.ka,!0):null],q=null,C($e,Promise.all(J),2);if(ae=$e.h,pe=ae[0],me=ae[1]||null,null,Se=K-A,Ee=K,De=z?K+z:1/0,"mp4"==G)var He=Rp(pe,S,_,m,Se,Ee,De);else{if(440786851!=Up(He=new Tp(me)).id)throw new N(2,3,3008);var et=Up(He);if(408125543!=et.id)throw new N(2,3,3009);He=et.g.byteOffset,et=new Tp(et.g);for(var rt=null;et.ja();){var it=Up(et);if(357149030==it.id){rt=it;break}}if(!rt)throw new N(2,3,3010);for(rt=new Tp(rt.g),it=1e6,et=null;rt.ja();){var at=Up(rt);if(2807729==at.id)it=Yp(at);else if(17545==at.id)if(4==at.g.byteLength)et=at.g.getFloat32(0);else{if(8!=at.g.byteLength)throw new N(2,3,3003);et=at.g.getFloat64(0)}}if(null==et)throw new N(2,3,3011);if(et*=rt=it/1e9,475249515!=(it=Up(new Tp(pe))).id)throw new N(2,3,3007);He=function Zp(o,s,m,_,S,E,A,O,H){function l(){return S}var K=[];o=new Tp(o.g);for(var z=null,G=null;o.ja();){var q=Up(o);if(187==q.id){var X=$p(q);X&&(q=m*X.ph,X=s+X.Zg,null!=z&&K.push(new Q(z+A,q+A,l,G,X-1,E,A,O,H)),z=q,G=X)}}return null!=z&&K.push(new Q(z+A,_+A,l,G,null,E,A,O,H)),K}(it,He,rt,et,_,m,Se,Ee,De)}return _e=He,O.Qc(_e),X=new hj(_e),H&&X.Ub(Ee,De,!0),$e.return(X)}))}function dq(o){return o.Wc}function fq(o){var s=Op(o,dq,"RepresentationIndex");return o=kg((o=Np(o,dq,"indexRange"))||""),s&&(o=hg(s,"range",kg,o)),o}function hq(o,s){var m=o.J.mimeType.split("/")[1];if(o.J.contentType!=qt&&"mp4"!=m&&"webm"!=m)throw new N(2,4,4006);if("webm"==m&&!s)throw new N(2,4,4005)}function bq(o){var s=o.J;return{bandwidth:o.bandwidth,audioSamplingRate:s.audioSamplingRate,codecs:s.codecs,contentType:s.contentType,frameRate:s.frameRate||null,height:s.height||null,mimeType:s.mimeType,channelsCount:s.Gd,pixelAspectRatio:s.pixelAspectRatio||null,width:s.width||null}}function iq(o,s){var m=aq(o,jq),_=function kq(o){var s=function mq(o){return[o.J.ub,o.ea.ub,o.ia.ub].filter(tc).map((function(o){return $f(o,"SegmentURL")})).reduce((function(o,s){return 0<o.length?o:s})).map((function(s){return s.getAttribute("indexRange")&&!o.qf&&(o.qf=!0),{Qg:s.getAttribute("media"),start:(s=hg(s,"mediaRange",kg,{start:0,end:null})).start,end:s.end}}))}(o);o=Mp(o,jq);var m=o.hc;0==m&&(m=1);var _=0;return o.ma?_=o.ma*(m-1):o.timeline&&0<o.timeline.length&&(_=o.timeline[0].start),{ma:o.ma,startTime:_,hc:m,lb:o.lb,timeline:o.timeline,ac:s}}(o);if(!_.ma&&!_.timeline&&1<_.ac.length)throw new N(2,4,4002);if(!_.ma&&!o.$.duration&&!_.timeline&&1==_.ac.length)throw new N(2,4,4002);if(_.timeline&&0==_.timeline.length)throw new N(2,4,4002);var S=null,E=null;o.ia.id&&o.J.id&&(E=s[o.ia.id+","+o.J.id])&&(S=E.segmentIndex);var A=function lq(o,s,m,_,S){var E=_.ac.length;_.timeline&&_.timeline.length!=_.ac.length&&(E=Math.min(_.timeline.length,_.ac.length));for(var A=o-_.lb,O=s?o+s:1/0,H=[],K=_.startTime,z={},G=0;G<E;z={vc:z.vc,tc:z.tc},G++){z.tc=_.ac[G];var q=void 0;q=null!=_.ma?K+_.ma:_.timeline?_.timeline[G].end:K+s,z.vc=null,H.push(new Q(o+K,o+q,function(o){return function(){return null==o.vc&&(o.vc=uc(m,[o.tc.Qg])),o.vc}}(z),z.tc.start,z.tc.end,S,A,o,O)),K=q}return H}(o.$.start,o.$.duration,o.J.Da,_,m);return s=!S,S?S.Pc(A,o.presentationTimeline.fb()):S=new hj(A),o.presentationTimeline.Qc(A),o.rb&&o.$.he||S.Ub(o.$.start,o.$.duration?o.$.start+o.$.duration:1/0,s),E&&(E.segmentIndex=S),{Wb:function Wb(){return S&&0!=S.Jc()||S.Ed(A),Promise.resolve(S)}}}function jq(o){return o.ub}function nq(o,s,m,_,S,E){var A=function oq(o){var s=Np(o,uq,"initialization");if(!s)return null;var m=o.J.id,_=o.bandwidth||null,S=o.J.Da;return new sh((function(){var o=Lp(s,m,null,_,null);return uc(S,[o])}),0,null,bq(o))}(o),O=function pq(o){var s=Mp(o,uq),m=Np(o,uq,"media");return o=Np(o,uq,"index"),{ma:s.ma,timescale:s.timescale,hc:s.hc,lb:s.lb,Te:s.Te,timeline:s.timeline,re:m,Oc:o}}(o);!function qq(o){var s=o.Oc?1:0;if(s+=o.timeline?1:0,s+=o.ma?1:0,0==s)throw new N(2,4,4002);if(1!=s&&(o.Oc&&(o.timeline=null),o.ma=null),!o.Oc&&!o.re)throw new N(2,4,4002)}(O);var H=Ve(o);if(O.Oc)return hq(o,A),{Wb:function Wb(){var o=Lp(O.Oc,H.J.id,null,H.bandwidth||null,null);return o=uc(H.J.Da,[o]),gq(H,s,A,o,0,null,O.lb)}};if(O.ma)return _||"image"===o.ea.contentType||(o.presentationTimeline.ue(O.ma),o.presentationTimeline.Fd(o.$.start)),{Wb:function Wb(){return function rq(o,s,m,_,S){function f(o){var m=(o-z)*K,S=m+s.lb,E=m+A;return m=E+K,E=new Q(E,Math.min(m,h()),(function(){var s=Lp(q,J,o,X,S*G);return uc(ae,[s])}),0,null,_,pe,A,h()),E.l=m,E}function g(){var o=[Math.max(E.fb(),A),Math.min(E.Ab(),h())].map((function(o){return o-A}));return[Math.ceil(o[0]/K),Math.ceil(o[1]/K)-1].map((function(o){return o+z}))}function h(){var o=null!=O&&S[O]||H;return o?A+o:1/0}var E=o.presentationTimeline,A=o.$.start,O=o.ia.id,H=o.$.duration,K=s.ma,z=s.hc,G=s.timescale,q=s.re,X=o.bandwidth||null,J=o.J.id,ae=o.J.Da,pe=A-s.lb,me=g();o=o.rb?Math.max(me[0],me[1]-m+1):me[0],me=me[1],m=[];for(var _e=o;_e<=me;++_e){var Se=f(_e);m.push(Se)}var Ee=new hj(m);if(m=E.Ab()<h(),_e=E.T(),m||_e){var De=Math.max(o,me+1);Ee.Od(K,(function(){var o=E.fb();Ee.Ta(o);var s=t(g());s.next(),s=s.next().value;for(var m=[];De<=s;){var _=f(De);m.push(_),De++}return o>h()&&!m.length?null:m}))}return Promise.resolve(Ee)}(H,O,S,A,E)}};var K=null;_=_=null,o.ia.id&&o.J.id&&(_=m[_=o.ia.id+","+o.J.id])&&(K=_.segmentIndex);var z=o.$.start,G=o.$.duration?z+o.$.duration:1/0,q=!(o.rb&&o.$.he);return K?(sq(m=K,O,z,G,q),m.Ta(o.presentationTimeline.fb())):K=new tq(O,o.J.id,o.bandwidth,o.J.Da,z,G,A,q),O.timeline&&"image"!==o.ea.contentType&&o.presentationTimeline.yf(O.timeline,z),_&&o.rb&&(_.segmentIndex=K),{Wb:function Wb(){return K instanceof tq&&0==K.Jc()&&sq(K,O,z,G,q),Promise.resolve(K)}}}function uq(o){return o.Xc}function tq(o,s,m,_,S,E,A,O){hj.call(this,[]),this.h=o,this.C=s,this.s=m,this.u=_,this.j=S,this.o=E,this.A=A,O&&vq(this)}function sq(o,s,m,_,S){if(o.h){var E=(m=o.h.timeline)[m.length-1];s=s.timeline.filter((function(o){return o.start>=E.end})),0<s.length&&o.h.timeline.push.apply(o.h.timeline,v(s)),o.o!==_&&(o.o=_)}else o.h=s,o.j=m,o.o=_;S&&vq(o)}function vq(o){if(!o.m){for(var s=o.h.timeline;s.length&&s[s.length-1].start>=o.o;)s.pop();o.Ta(o.j),0!==s.length&&1/0!==o.o&&(s[s.length-1].end=o.o-o.j)}}function xq(){this.j=[],this.g=[],this.i=[],this.l=[],this.h=[],this.m=new Set}function Gq(o){var s,m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He,et;return I((function(rt){switch(rt.g){case 1:if(s=Jt,1==o.length)return rt.return(o[0]);for(m=o.map((function(o){return o.filter((function(o){return o.type==s.qb}))})),_=o.map((function(o){return o.filter((function(o){return o.type==s.va}))})),S=o.map((function(o){return o.filter((function(o){return o.type==s.da}))})),E=o.map((function(o){return o.filter((function(o){return o.type==s.wc}))})),A=t(S),O=A.next();!O.done;O=A.next())O.value.push(Hq(s.da));for(H=t(E),K=H.next();!K.done;K=H.next())K.value.push(Hq(s.wc));return C(rt,Dq([],m,0,Iq,Jq),2);case 2:return z=rt.h,C(rt,Dq([],_,0,Iq,Jq),3);case 3:return G=rt.h,C(rt,Dq([],S,0,Iq,Jq),4);case 4:return q=rt.h,C(rt,Dq([],E,0,Iq,Jq),5);case 5:if(X=rt.h,J=0,G.length&&z.length)for(_e=t(z),Se=_e.next();!Se.done;Se=_e.next())for(Ee=Se.value,De=t(G),$e=De.next();!$e.done;$e=De.next())He=$e.value,et=J++,He.variantIds.push(et),Ee.variantIds.push(et);else for(ae=G.concat(z),pe=t(ae),me=pe.next();!me.done;me=pe.next())me.value.variantIds=[J++];return rt.return(G.concat(z).concat(q).concat(X))}}))}function Dq(o,s,m,_,S){var E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e;return I((function(He){switch(He.g){case 1:for(E=Jt,A=[],O=0;O<s.length;O++)O>=m?A.push(new Set(s[O])):A.push(new Set);H=t(o),K=H.next();case 2:if(K.done){He.B(4);break}return C(He,function Kq(o,s,m,_,S){return I((function(E){return 1==E.g?(Mq(s,o),o.matchedStreams?o.segmentIndex?C(E,Nq(o,m),2):E.B(2):E.return(!1)):(Oq(o,m,_,S),E.return(!0))}))}(K.value,s,m,S,A),5);case 5:if(!He.h)throw new N(2,4,4037);K=H.next(),He.B(2);break;case 4:for(z=t(A),G=z.next();!G.done;G=z.next())for(q=G.value,X=t(q),J=X.next();!J.done;J=X.next())ae=J.value,(pe=Lq(ae,s,_,S,A))&&o.push(pe);for(me=t(A),G=me.next();!G.done;G=me.next())for(_e=G.value,Se={},Ee=t(_e),J=Ee.next();!J.done;Se={pb:Se.pb},J=Ee.next())if(Se.pb=J.value,De=Se.pb.type==E.da&&!Se.pb.language,$e=Se.pb.type==E.wc&&!Se.pb.tilesLayout,!De&&!$e&&o.some(function(o){return function(s){return s.mimeType==o.pb.mimeType&&Hc(s.codecs)==Hc(o.pb.codecs)}}(Se)))throw new N(2,4,4037);return He.return(o)}}))}function Nq(o,s){var m,_,S,E,A,O,H;return I((function(K){if(1==K.g){for(m=[],_=o.matchedStreams,S=t(_),E=S.next();!E.done;E=S.next())A=E.value,m.push(A.createSegmentIndex()),A.trickModeVideo&&!A.trickModeVideo.segmentIndex&&m.push(A.trickModeVideo.createSegmentIndex());return C(K,Promise.all(m),2)}if(o.segmentIndex instanceof lj)for(O=s;O<_.length;O++)(H=_[O]).segmentIndex&&o.segmentIndex.h.push(H.segmentIndex);D(K)}))}function Lq(o,s,m,_,S){var E=m(o);return Mq(s,E),E.createSegmentIndex&&(E.createSegmentIndex=function(){return I((function(o){return E.segmentIndex?o.B(0):(E.segmentIndex=new lj,C(o,Nq(E,0),0))}))}),E.matchedStreams&&E.matchedStreams.length?(Oq(E,0,_,S),E):null}function Oq(o,s,m,_){for(var S=o.matchedStreams,E=0;E<S.length;E++)if(E>=s){var A=S[E];m(o,A);var O=!0;"audio"==o.type&&0==Yc(o.language,A.language)&&(O=!1),O&&_[E].delete(A)}}function Eq(o){var s=Object.assign({},o);return s.originalId=null,s.createSegmentIndex=function(){return Promise.resolve()},s.closeSegmentIndex=function(){if(s.segmentIndex&&(s.segmentIndex.release(),s.segmentIndex=null),s.matchedStreams)for(var o=t(s.matchedStreams),m=o.next();!m.done;m=o.next())(m=m.value).segmentIndex&&(m.segmentIndex.release(),m.segmentIndex=null)},s.segmentIndex=null,s.emsgSchemeIdUris=[],s.keyIds=new Set,s.closedCaptions=null,s.trickModeVideo=null,s}function Iq(o){return(o=Object.assign({},o)).keyIds=new Set,o.segments=[],o.variantIds=[],o.closedCaptions=null,o}function Fq(o,s){o.roles=Array.from(new Set(o.roles.concat(s.roles))),s.emsgSchemeIdUris&&(o.emsgSchemeIdUris=Array.from(new Set(o.emsgSchemeIdUris.concat(s.emsgSchemeIdUris)))),o.keyIds=function(o,s){return new Set([].concat(v(o),v(s)))}(o.keyIds,s.keyIds),null==o.originalId?o.originalId=s.originalId:o.originalId+=","+(s.originalId||"");var m=gh(o.drmInfos,s.drmInfos);if(s.drmInfos.length&&o.drmInfos.length&&!m.length)throw new N(2,4,4038);if(o.drmInfos=m,o.encrypted=o.encrypted||s.encrypted,s.closedCaptions){o.closedCaptions||(o.closedCaptions=new Map);for(var _=(m=t(s.closedCaptions)).next();!_.done;_=m.next()){var S=t(_.value);_=S.next().value,S=S.next().value,o.closedCaptions.set(_,S)}}s.trickModeVideo?(o.trickModeVideo||(o.trickModeVideo=Eq(s.trickModeVideo),o.trickModeVideo.createSegmentIndex=function(){return o.trickModeVideo.segmentIndex=o.segmentIndex.clone(),Promise.resolve()}),Fq(o.trickModeVideo,s.trickModeVideo)):o.trickModeVideo&&Fq(o.trickModeVideo,s)}function Jq(o,s){o.roles=Array.from(new Set(o.roles.concat(s.roles)));var m=s.keyIds;if(m=new Set([].concat(v(o.keyIds),v(m))),o.keyIds=m,o.encrypted=o.encrypted&&s.encrypted,o.segments.push.apply(o.segments,v(s.segments)),s.closedCaptions)for(o.closedCaptions||(o.closedCaptions=new Map),m=(s=t(s.closedCaptions)).next();!m.done;m=s.next()){var _=t(m.value);m=_.next().value,_=_.next().value,o.closedCaptions.set(m,_)}}function Mq(o,s){for(var m=[],_=(o=t(o)).next();!_.done;_=o.next()){for(var S=s,E={audio:Pq,video:Pq,text:Qq,image:Rq}[S.type],A={audio:Sq,video:Tq,text:Uq,image:Vq}[S.type],O=null,H=(_=t(_.value)).next();!H.done;H=_.next())!E(S,H=H.value)||O&&!A(S,O,H)||(O=H);if(!(S=O))return;m.push(S)}s.matchedStreams=m}function Pq(o,s){function c(o){if(!eh.has(o)){var s=Hc(o);eh.set(o,s)}return eh.get(o)}return!(s.mimeType!=o.mimeType||c(s.codecs)!=c(o.codecs)||o.drmInfos&&!fh(o.drmInfos,s.drmInfos))}function Qq(o,s){return!!o.language&&(!s.language||0!=Yc(o.language,s.language)&&s.kind==o.kind)}function Rq(o){return!!o.tilesLayout}function Sq(o,s,m){if(o.id==m.id)return!0;var _=Yc(o.language,s.language),S=Yc(o.language,m.language);return S>_||!(S<_)&&(o.roles.length?(_=s.roles.filter((function(s){return o.roles.includes(s)})),S=m.roles.filter((function(s){return o.roles.includes(s)})),S.length>_.length||!(S.length<_.length)&&m.roles.length<s.roles.length):!(m.roles.length||!s.roles.length)||!(m.roles.length&&!s.roles.length)&&(!(s.primary||!m.primary)||!(s.primary&&!m.primary)&&((_=Xq(o.channelsCount,s.channelsCount,m.channelsCount))==Vd||_!=qd&&((_=Xq(o.audioSamplingRate,s.audioSamplingRate,m.audioSamplingRate))==Vd||_!=qd&&!(!o.bandwidth||$q(o.bandwidth,s.bandwidth,m.bandwidth)!=Vd)))))}function Tq(o,s,m){if(o.id==m.id)return!0;var _=Xq(o.width*o.height,s.width*s.height,m.width*m.height);if(_==Vd)return!0;if(_==qd)return!1;if(o.frameRate){if((_=Xq(o.frameRate,s.frameRate,m.frameRate))==Vd)return!0;if(_==qd)return!1}return!(!o.bandwidth||$q(o.bandwidth,s.bandwidth,m.bandwidth)!=Vd)}function Uq(o,s,m){if(o.id==m.id)return!0;var _=Yc(o.language,s.language),S=Yc(o.language,m.language);if(S>_)return!0;if(S<_)return!1;if(!s.primary&&m.primary)return!0;if(s.primary&&!m.primary)return!1;if(o.roles.length){if(_=s.roles.filter((function(s){return o.roles.includes(s)})),S=m.roles.filter((function(s){return o.roles.includes(s)})),S.length>_.length)return!0;if(S.length<_.length)return!1}else{if(!m.roles.length&&s.roles.length)return!0;if(m.roles.length&&!s.roles.length)return!1}return m.mimeType==o.mimeType&&m.codecs==o.codecs&&(s.mimeType!=o.mimeType||s.codecs!=o.codecs)}function Vq(o,s,m){return o.id==m.id||Xq(o.width*o.height,s.width*s.height,m.width*m.height)==Vd}function Hq(o){return{id:0,originalId:"",primary:!1,type:o,mimeType:"",codecs:"",language:"",originalLanguage:null,label:null,width:null,height:null,encrypted:!1,keyIds:new Set,segments:[],variantIds:[],roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,external:!1}}function Cq(o){return{id:0,originalId:"",createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},segmentIndex:new hj([]),mimeType:"",codecs:"",encrypted:!1,drmInfos:[],keyIds:new Set,language:"",originalLanguage:null,label:null,type:o,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],forced:!1,channelsCount:null,audioSamplingRate:null,spatialAudio:!1,closedCaptions:null,accessibilityPurpose:null,external:!1}}function Xq(o,s,m){if(s==o&&o!=m)return qd;if(m==o&&o!=s)return Vd;if(s>o){if(m<=o||m-o<s-o)return Vd;if(m-o>s-o)return qd}else{if(m>o)return qd;if(o-m<o-s)return Vd;if(o-m>o-s)return qd}return zd}function $q(o,s,m){return s=Math.abs(o-s),(o=Math.abs(o-m))<s?Vd:s<o?qd:zd}ra(tq,hj),(_=tq.prototype).Jc=function(){return this.h?this.h.timeline.length:0},_.release=function(){hj.prototype.release.call(this),this.h=null},_.Ta=function(o){if(this.h){for(var s=0,m=this.h.timeline,_=0;_<m.length&&m[_].end+this.j<=o;_+=1)s+=1;0<s&&(this.h.timeline=m.slice(s),this.g.length>=s&&(this.g=this.g.slice(s)),this.i+=s,0===this.Jc()&&this.release())}},_.find=function(o){if(this.h&&this.h.timeline&&this.h.timeline.length&&o<this.h.timeline[0].start+this.j)return this.i;if(!this.h)return null;var s=this.h.timeline;if(o<this.j||o>this.o)return null;for(var m=s.length-1,_=0;_<s.length;_++){var S=s[_],E=S.start+this.j;if(S=S.end+this.j,_<m&&(S=s[_+1].start+this.j),o>=E&&o<S)return _+this.i}return null},_.get=function(o){var s=this,m=o-this.i;if(0>m||m>=this.Jc()||!this.h)return null;var _=this.g[m];if(!_){_=this.h.timeline[m];var S=o+this.h.hc,E=this.h.Te+_.Ue;_=new Q(this.j+_.start,this.j+_.end,(function(){return function wq(o,s,m,_,S,E){return o=Lp(o,s,m,_||null,S),uc(E,[o]).map((function(o){return o.toString()}))}(s.h.re,s.C,S,s.s,E,s.u)}),0,null,this.A,this.j-this.h.lb,this.j,this.o),this.g[m]=_}return _},(_=xq.prototype).release=function(){for(var o=t(this.g.concat(this.i,this.l,this.h)),s=o.next();!s.done;s=o.next())(s=s.value).segmentIndex&&s.segmentIndex.release();this.g=[],this.i=[],this.l=[],this.h=[],this.j=[]},_.Eg=function(){return this.j},_.de=function(){return this.l.slice()},_.mg=function(){return this.h},_.af=function(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He,et,rt,it,at,ot,st,ut=this;return I((function(ct){switch(ct.g){case 1:if(m=Jt,function yq(o){for(var s=(o=t(o)).next();!s.done;s=o.next()){for(var m=[],_=t((s=s.value).audioStreams),S=_.next();!S.done;S=_.next()){S=S.value;for(var E=!1,A=t(m),O=A.next();!O.done;O=A.next())O=O.value,S.id!=O.id&&S.channelsCount==O.channelsCount&&S.language==O.language&&S.bandwidth==O.bandwidth&&S.label==O.label&&S.codecs==O.codecs&&S.mimeType==O.mimeType&&wb(S.roles,O.roles)&&S.audioSamplingRate==O.audioSamplingRate&&S.primary==O.primary&&(E=!0);E||m.push(S)}s.audioStreams=m}}(o),function zq(o){for(var s=(o=t(o)).next();!s.done;s=o.next()){for(var m=[],_=t((s=s.value).videoStreams),S=_.next();!S.done;S=_.next()){S=S.value;for(var E=!1,A=t(m),O=A.next();!O.done;O=A.next())O=O.value,S.id!=O.id&&S.width==O.width&&S.frameRate==O.frameRate&&S.codecs==O.codecs&&S.mimeType==O.mimeType&&S.label==O.label&&wb(S.roles,O.roles)&&vf(S.closedCaptions,O.closedCaptions)&&S.bandwidth==O.bandwidth&&(E=!0);E||m.push(S)}s.videoStreams=m}}(o),function Aq(o){for(var s=(o=t(o)).next();!s.done;s=o.next()){for(var m=[],_=t((s=s.value).textStreams),S=_.next();!S.done;S=_.next()){S=S.value;for(var E=!1,A=t(m),O=A.next();!O.done;O=A.next())O=O.value,S.id!=O.id&&S.language==O.language&&S.label==O.label&&S.codecs==O.codecs&&S.mimeType==O.mimeType&&S.bandwidth==O.bandwidth&&wb(S.roles,O.roles)&&(E=!0);E||m.push(S)}s.textStreams=m}}(o),function Bq(o){for(var s=(o=t(o)).next();!s.done;s=o.next()){for(var m=[],_=t((s=s.value).imageStreams),S=_.next();!S.done;S=_.next()){S=S.value;for(var E=!1,A=t(m),O=A.next();!O.done;O=A.next())O=O.value,S.id!=O.id&&S.width==O.width&&S.codecs==O.codecs&&S.mimeType==O.mimeType&&(E=!0);E||m.push(S)}s.imageStreams=m}}(o),!s&&1==o.length){_=o[0],ut.g=_.audioStreams,ut.i=_.videoStreams,ut.l=_.textStreams,ut.h=_.imageStreams,ct.B(2);break}for(S=-1,E=0;E<o.length;E++)A=o[E],ut.m.has(A.id)||(ut.m.add(A.id),-1==S&&(S=E));if(-1==S)return ct.return();for(O=o.map((function(o){return o.audioStreams})),H=o.map((function(o){return o.videoStreams})),K=o.map((function(o){return o.textStreams})),z=o.map((function(o){return o.imageStreams})),G=t(K),q=G.next();!q.done;q=G.next())q.value.push(Cq(m.da));for(X=t(z),J=X.next();!J.done;J=X.next())J.value.push(Cq(m.wc));return C(ct,Dq(ut.g,O,S,Eq,Fq),3);case 3:return C(ct,Dq(ut.i,H,S,Eq,Fq),4);case 4:return C(ct,Dq(ut.l,K,S,Eq,Fq),5);case 5:return C(ct,Dq(ut.h,z,S,Eq,Fq),2);case 2:if(ae=0,pe=[],ut.i.length&&ut.g.length)for($e=t(ut.g),He=$e.next();!He.done;He=$e.next())for(et=He.value,rt=t(ut.i),it=rt.next();!it.done;it=rt.next())at=it.value,ot=gh(et.drmInfos,at.drmInfos),et.drmInfos.length&&at.drmInfos.length&&!ot.length||(st=ae++,pe.push({id:st,language:et.language,disabledUntilTime:0,primary:et.primary,audio:et,video:at,bandwidth:(et.bandwidth||0)+(at.bandwidth||0),drmInfos:ot,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]}));else for(me=ut.i.concat(ut.g),_e=t(me),Se=_e.next();!Se.done;Se=_e.next())Ee=Se.value,De=ae++,pe.push({id:De,language:Ee.language,disabledUntilTime:0,primary:Ee.primary,audio:Ee.type==m.qb?Ee:null,video:Ee.type==m.va?Ee:null,bandwidth:Ee.bandwidth||0,drmInfos:Ee.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});ut.j=pe,D(ct)}}))},L("shaka.util.PeriodCombiner",xq),xq.prototype.combinePeriods=xq.prototype.af,xq.prototype.getImageStreams=xq.prototype.mg,xq.prototype.getTextStreams=xq.prototype.de,xq.prototype.getVariants=xq.prototype.Eg;var Vd=1,zd=0,qd=-1,eh=new Map;function br(){var o=this;this.h=this.g=null,this.s=[],this.i=null,this.H=1,this.l={},this.L={},this.j=new xq,this.C=0,this.G=new Ta(5),this.F=new dd((function(){!function cr(o){var s,m;I((function(_){switch(_.g){case 1:return s=0,wa(_,2),C(_,dr(o),4);case 4:s=_.h,Aa(_,3);break;case 2:if(m=Ba(_),o.h){if(o.g.raiseFatalErrorOnManifestUpdateRequestFailure)return o.h.onError(m),_.return();m.severity=1,o.h.onError(m)}case 3:if(!o.h)return _.return();er(o,s),D(_)}}))}(o)})),this.u=new We,this.A=null,this.I=[],this.m=1/0,this.o=!1}function dr(o){var s,m,_,S,E,A,O;return I((function(H){return 1==H.g?(s=bf(o.s,o.g.retryParameters),m=o.h.networkingEngine,_=Date.now(),S=m.request(0,s,{type:4}),Xe(o.u,S),C(H,S.promise,2)):3!=H.g?(E=H.h,o.h?(E.uri&&!o.s.includes(E.uri)&&o.s.unshift(E.uri),C(H,function fr(o,s,m){var _,S,E,A;return I((function(O){if(1==O.g){if(!(_=tg(s,"MPD")))throw new N(2,4,4001,m);return o.g.dash.disableXlinkProcessing?O.return(gr(o,_,m)):(S=o.g.dash.xlinkFailGracefully,E=Qp(_,o.g.retryParameters,S,m,o.h.networkingEngine),Xe(o.u,E),C(O,E.promise,2))}return A=O.h,O.return(gr(o,A,m))}))}(o,E.data,E.uri),3)):H.return(0)):(A=Date.now(),O=(A-_)/1e3,o.G.sample(1,O),H.return(O))}))}function gr(o,s,m){var _,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He,et,rt,it,at,ot,st,ut,ct;return I((function(dt){switch(dt.g){case 1:if((_=o.g.dash.manifestPreprocessor)&&_(s),S=[m],0<(E=$f(s,"Location").map(fg).filter(tc)).length&&(A=uc(S,E),S=o.s=A),O=$f(s,"BaseURL"),H=O.map(fg),K=uc(S,H),z=0,O&&O.length&&(z=hg(O[0],"availabilityTimeOffset",og)||0),G=o.g.dash.ignoreMinBufferTime,q=0,G||(q=hg(s,"minBufferTime",jg)||0),o.C=hg(s,"minimumUpdatePeriod",jg,-1),X=hg(s,"availabilityStartTime",ig),J=hg(s,"timeShiftBufferDepth",jg),ae=o.g.dash.ignoreSuggestedPresentationDelay,pe=null,ae||(pe=hg(s,"suggestedPresentationDelay",jg)),me=o.g.dash.ignoreMaxSegmentDuration,_e=null,me||(_e=hg(s,"maxSegmentDuration",jg)),Se=s.getAttribute("type")||"static",o.i)for(Ee=o.i.presentationTimeline,De=t(Object.values(o.l)),$e=De.next();!$e.done;$e=De.next())(He=$e.value).segmentIndex&&He.segmentIndex.Ta(Ee.fb());else et=o.g.defaultPresentationDelay||1.5*q,Ee=new R(X,null!=pe?pe:et,o.g.dash.autoCorrectDrift);return Ee.fc("static"==Se),Ee.T()&&!isNaN(o.g.availabilityWindowOverride)&&(J=o.g.availabilityWindowOverride),null==J&&(J=1/0),Ee.Md(J),rt=s.getAttribute("profiles")||"",it={rb:"static"!=Se,presentationTimeline:Ee,ia:null,$:null,ea:null,J:null,bandwidth:0,qf:!1,Tb:z,profiles:rt.split(",")},at=function hr(o,s,m,_){var S=hg(_,"mediaPresentationDuration",jg),E=[],A=0;_=$f(_,"Period");for(var O=0;O<_.length;O++){var H=_[O],K=_[O+1],z=hg(H,"start",jg,A),G=H.id,q=hg(H,"duration",jg),X=null;if(K){var J=hg(K,"start",jg);null!=J&&(X=J-z)}else null!=S&&(X=S-z);if(null==X&&(X=q),!(null!==o.A&&null!==G&&null!==z&&z<o.A)||o.I.includes(G)||O+1==_.length){if(null!==z&&(null===o.A||z>o.A)&&(o.A=z),A=jr(o,s,m,{start:z,duration:X,node:H,he:null==X||!K}),E.push(A),s.ia.id&&X&&(o.L[s.ia.id]=X),null==X){A=null;break}A=z+X}}return o.I=E.map((function(o){return o.id})),null!=S?{periods:E,duration:S,ff:!1}:{periods:E,duration:A,ff:!0}}(o,it,K,s),ot=at.duration,st=at.periods,"static"!=Se&&at.ff||Ee.Aa(ot||1/0),o.m&&!o.o&&o.h.isAutoLowLatencyMode()&&(o.h.enableLowLatencyMode(),o.o=o.h.isLowLatencyMode()),o.o?Ee.Ef(o.m):o.m&&$a("Low-latency DASH live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details."),Ee.ue(_e||1),C(dt,o.j.af(st,it.rb),2);case 2:if(o.o&&(q=0),o.o&&o.m&&(o.C=o.m),o.i){o.i.variants=o.j.j,o.i.textStreams=o.j.de(),o.i.imageStreams=o.j.h,o.h.filter(o.i),dt.B(3);break}var ht=Ee,pt=o.j.j,gt=o.j.de(),_t=o.j.h,bt=q||0,kt=o.g.dash.sequenceMode,It=Zf(s,"ServiceDescription");if(It){var At=Zf(It,"Latency");It=Zf(It,"PlaybackRate"),At&&At.getAttribute("max")||It?At={maxLatency:At=At&&At.getAttribute("max")?parseInt(At.getAttribute("max"),10)/1e3:null,maxPlaybackRate:It=It?parseFloat(It.getAttribute("max")):null}:At=null}else At=null;if(o.i={presentationTimeline:ht,variants:pt,textStreams:gt,imageStreams:_t,offlineSessionIds:[],minBufferTime:bt,sequenceMode:kt,ignoreManifestTimestampsInSegmentsMode:!1,type:"DASH",serviceDescription:At},!Ee.Of()){dt.B(4);break}return ut=$f(s,"UTCTiming"),C(dt,function ir(o,s,m){var _,S,E,A,O,H,K,z;return I((function(G){switch(G.g){case 1:_=m.map((function(o){return{scheme:o.getAttribute("schemeIdUri"),value:o.getAttribute("value")}})),S=o.g.dash.clockSyncUri,!_.length&&S&&_.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:S}),E=t(_),A=E.next();case 2:if(A.done){G.B(4);break}switch(O=A.value,wa(G,5),H=O.scheme,K=O.value,H){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return G.B(7);case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return G.B(8);case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return z=Date.parse(K),G.return(isNaN(z)?0:z-Date.now());case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":$a("NTP UTCTiming scheme is not supported");break;default:$a("Unrecognized scheme in UTCTiming element",H)}G.B(9);break;case 7:return C(G,tr(o,s,K,"HEAD"),10);case 10:return G.return(G.h);case 8:return C(G,tr(o,s,K,"GET"),11);case 11:return G.return(G.h);case 9:Aa(G,3);break;case 5:Ba(G);case 3:A=E.next(),G.B(2);break;case 4:return $a("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),G.return(0)}}))}(o,K,ut),5);case 5:if(ct=dt.h,!o.h)return dt.return();Ee.Ff(ct);case 4:Ee.Cd();case 3:o.h.makeTextStreamsForClosedCaptions(o.i),D(dt)}}))}function jr(o,s,m,_){s.ia=kr(_.node,null,m),s.$=_,s.ia.Tb=s.Tb,s.ia.id||(s.ia.id="__shaka_period_"+_.start);var S=$f(_.node,"EventStream");m=s.presentationTimeline.fb();for(var E=(S=t(S)).next();!E.done;E=S.next())lr(o,_.start,_.duration,E.value,m);if(m=$f(_.node,"AdaptationSet").map((function(m){return function mr(o,s,m){function d(o){switch(o){case 1:case 6:case 13:case 14:case 15:return"SDR";case 16:return"PQ";case 18:return"HLG"}}s.ea=kr(m,s.ia,null);var _,S=!1,E=$f(m,"Role"),A=E.map((function(o){return o.getAttribute("value")})).filter(tc),O=void 0,H=s.ea.contentType==qt;H&&(O="subtitle");for(var K=(E=t(E)).next();!K.done;K=E.next()){var z=(K=K.value).getAttribute("schemeIdUri");if(null==z||"urn:mpeg:dash:role:2011"==z)switch(K=K.getAttribute("value"),K){case"main":S=!0;break;case"caption":case"subtitle":O=K}}z=$f(m,"EssentialProperty"),E=null,K=!1;for(var G=(z=t(z)).next();!G.done;G=z.next()){var q=(G=G.value).getAttribute("schemeIdUri");"http://dashif.org/guidelines/trickmode"==q?E=G.getAttribute("value"):"urn:mpeg:mpegB:cicp:TransferCharacteristics"==q?_=d(parseInt(G.getAttribute("value"),10)):"urn:mpeg:mpegB:cicp:ColourPrimaries"!=q&&"urn:mpeg:mpegB:cicp:MatrixCoefficients"!=q&&(K=!0)}for(z=t(z=$f(m,"SupplementalProperty")),G=z.next();!G.done;G=z.next())"urn:mpeg:mpegB:cicp:TransferCharacteristics"==(G=G.value).getAttribute("schemeIdUri")&&(_=d(parseInt(G.getAttribute("value"),10)));z=$f(m,"Accessibility");var X,J=new Map;for(z=t(z),G=z.next();!G.done;G=z.next())if(q=G.value,G=q.getAttribute("schemeIdUri"),q=q.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==G)if(G=1,null!=q)for(var ae=t(q=q.split(";")),pe=ae.next();!pe.done;pe=ae.next()){var me=pe.value,_e=pe=void 0;me.includes("=")?(pe=(me=me.split("="))[0].startsWith("CC")?me[0]:"CC"+me[0],_e=me[1]||"und"):(pe="CC"+G,2==q.length?G+=2:G++,_e=me),J.set(pe,Uc(_e))}else J.set("CC1","und");else if("urn:scte:dash:cc:cea-708:2015"==G)if(G=1,null!=q)for(pe=(q=t(q.split(";"))).next();!pe.done;pe=q.next())me=ae=void 0,(pe=pe.value).includes("=")?(ae="svc"+(pe=pe.split("="))[0],me=pe[1].split(",")[0].split(":").pop()):(ae="svc"+G,G++,me=pe),J.set(ae,Uc(me));else J.set("svc1","und");else"urn:mpeg:dash:role:2011"==G?null!=q&&(A.push(q),"captions"==q&&(O="caption")):"urn:tva:metadata:cs:AudioPurposeCS:2007"==G&&("1"==q?X="visually impaired":"2"==q&&(X="hard of hearing"));if(K)return null;K=$f(m,"ContentProtection");var Se=Bp(K,o.g.dash.ignoreDrmInfo,o.g.dash.keySystemsByURI),Ee=Uc(s.ea.language||"und"),De=m.getAttribute("label");if((K=$f(m,"Label"))&&K.length&&(K=K[0],K.textContent&&(De=K.textContent)),K=$f(m,"Representation"),m=K.map((function(m){return(m=function or(o,s,m,_,S,E,A,O,H,K,z){if(s.J=kr(K,s.ea,null),o.m=Math.min(o.m,s.J.Tb),!function qr(o){var s=o.Wc?1:0;return s+=o.ub?1:0,s+=o.Xc?1:0,0==s?o.contentType==qt||"application"==o.contentType:(1!=s&&(o.Wc&&(o.ub=null),o.Xc=null),!0)}(s.J))return null;var G=s.$.start;s.bandwidth=hg(K,"bandwidth",mg)||0;var q=s.J.contentType,X=q==qt||"application"==q;q="image"==q;try{var J=function u(s,m,_,S){return function rr(o,s,m,_,S){var E,A,O,H,K,z;return I((function(G){return 1==G.g?(E=_r,A=S?0:1,O=Hj(s,m,_,o.g.retryParameters),H=o.h.networkingEngine,K=H.request(E,O,{type:A}),Xe(o.u,K),C(G,K.promise,2)):(z=G.h,G.return(z.data))}))}(o,s,m,_,S)};if(s.J.Wc)var ae=cq(s,J);else if(s.J.ub)ae=iq(s,o.l);else if(s.J.Xc)ae=nq(s,J,o.l,!!o.i,o.g.dash.initialSegmentLimit,o.L);else{var pe=s.J.Da,me=s.$.duration||0;ae={Wb:function Wb(){return Promise.resolve(kj(G,me,pe))}}}}catch(o){if((X||q)&&4002==o.code)return null;throw o}J=$f(K,"ContentProtection"),J=function Ep(o,s,m,_){var S=Bp(o,m,_);if(s.hf)o=1==s.drmInfos.length&&!s.drmInfos[0].keySystem,m=0==S.drmInfos.length,(0==s.drmInfos.length||o&&!m)&&(s.drmInfos=S.drmInfos),s.hf=!1;else if(0<S.drmInfos.length&&(s.drmInfos=s.drmInfos.filter((function(o){return S.drmInfos.some((function(s){return s.keySystem==o.keySystem}))})),0==s.drmInfos.length))throw new N(2,4,4008);return S.df||s.df}(J,m,o.g.dash.ignoreDrmInfo,o.g.dash.keySystemsByURI),J=new Set(J?[J]:[]);var _e=!1;$f(K,"SupplementalProperty").some((function(o){return"tag:dolby.com,2018:dash:EC3_ExtensionType:2018"==o.getAttribute("schemeIdUri")&&"JOC"==o.getAttribute("value")}))&&(_e=!0);var Se,Ee,De=!1;if(X&&(De=O.includes("forced_subtitle")||O.includes("forced-subtitle")),q&&((K=$f(K,"EssentialProperty").find((function(o){return["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"].includes(o.getAttribute("schemeIdUri"))})))&&(Se=K.getAttribute("value")),!Se))return null;K=s.J.codecs,s.profiles.includes("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")&&(K.includes("hvc1.2.4.L153.B0")||K.includes("hev1.2.4.L153.B0"))&&(Ee="PQ"),K=s.J.id?s.ia.id+","+s.J.id:"";var $e=K&&o.l[K]?o.l[K]:{id:o.H++,originalId:s.J.id,createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},closeSegmentIndex:function closeSegmentIndex(){$e.segmentIndex&&($e.segmentIndex.release(),$e.segmentIndex=null)},segmentIndex:null,mimeType:s.J.mimeType,codecs:s.J.codecs,frameRate:s.J.frameRate,pixelAspectRatio:s.J.pixelAspectRatio,bandwidth:s.bandwidth,width:s.J.width,height:s.J.height,kind:_,encrypted:0<m.drmInfos.length,drmInfos:m.drmInfos,keyIds:J,language:S,originalLanguage:s.ea.language,label:E,type:s.ea.contentType,primary:A,trickModeVideo:null,emsgSchemeIdUris:s.J.emsgSchemeIdUris,roles:O,forced:De,channelsCount:s.J.Gd,audioSamplingRate:s.J.audioSamplingRate,spatialAudio:_e,closedCaptions:H,hdr:Ee,tilesLayout:Se,matchedStreams:[],accessibilityPurpose:z,external:!1};return $e.createSegmentIndex=function(){var o;return I((function(s){if(1==s.g)return $e.segmentIndex?s.B(0):(o=$e,C(s,ae.Wb(),3));o.segmentIndex=s.h,D(s)}))},K&&s.rb&&!o.l[K]&&(o.l[K]=$e),$e}(o,s,Se,O,Ee,De,S,A,J,m,X))&&(m.hdr=m.hdr||_),m})).filter((function(o){return!!o})),0==m.length){if(E="image"==s.ea.contentType,o.g.dash.ignoreEmptyAdaptationSet||H||E)return null;throw new N(2,4,4003)}if(!s.ea.contentType||"application"==s.ea.contentType)for(s.ea.contentType=pr(m[0].mimeType,m[0].codecs),H=t(m),z=H.next();!z.done;z=H.next())z.value.type=s.ea.contentType;for(H=t(m),z=H.next();!z.done;z=H.next())for(z=z.value,G=t(Se.drmInfos),q=G.next();!q.done;q=G.next())(q=q.value).keyIds=q.keyIds&&z.keyIds?new Set([].concat(v(q.keyIds),v(z.keyIds))):q.keyIds||z.keyIds;return H=K.map((function(o){return o.getAttribute("id")})).filter(tc),{id:s.ea.id||"__fake__"+o.H++,contentType:s.ea.contentType,language:Ee,ei:S,streams:m,drmInfos:Se.drmInfos,Re:E,bh:H}}(o,s,m)})).filter(tc),s.rb){for(_=[],E=(S=t(m)).next();!E.done;E=S.next())for(var A=(E=t(E.value.bh)).next();!A.done;A=E.next())_.push(A.value);if(_.length!=new Set(_).size)throw new N(2,4,4018)}for(_=m.filter((function(o){return!o.Re})),m=m.filter((function(o){return o.Re})),S=(m=t(m)).next();!S.done;S=m.next()){E=(S=S.value).Re.split(" ");for(var O=(A=t(_)).next();!O.done;O=A.next()){var H=O.value;if(E.includes(H.id)){O={};for(var K=(H=t(H.streams)).next();!K.done;O={fd:O.fd},K=H.next())O.fd=K.value,O.fd.trickModeVideo=S.streams.find(function(o){return function(s){return Hc(o.fd.codecs)==Hc(s.codecs)}}(O))}}}if(S=o.g.disableAudio?[]:nr(_,"audio"),A=o.g.disableVideo?[]:nr(_,"video"),E=o.g.disableText?[]:nr(_,qt),m=o.g.disableThumbnails?[]:nr(_,"image"),!A.length&&!S.length)throw new N(2,4,4004);for(_=[],O=(S=t(S)).next();!O.done;O=S.next())_.push.apply(_,v(O.value.streams));for(S=[],O=(A=t(A)).next();!O.done;O=A.next())S.push.apply(S,v(O.value.streams));for(A=[],O=(E=t(E)).next();!O.done;O=E.next())A.push.apply(A,v(O.value.streams));for(E=[],O=(m=t(m)).next();!O.done;O=m.next())E.push.apply(E,v(O.value.streams));return{id:s.ia.id,audioStreams:_,videoStreams:S,textStreams:A,imageStreams:E}}function nr(o,s){return o.filter((function(o){return o.contentType==s}))}function er(o,s){0>o.C||o.F.S(Math.max(o.C-s,Ua(o.G)))}function kr(o,s,m){s=s||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,pixelAspectRatio:void 0,Gd:null,audioSamplingRate:null,Tb:0},m=m||s.Da;for(var _=$f(o,"BaseURL"),S=_.map(fg),E=o.getAttribute("contentType")||s.contentType,A=o.getAttribute("mimeType")||s.mimeType,O=o.getAttribute("codecs")||s.codecs,H=hg(o,"frameRate",qg)||s.frameRate,K=o.getAttribute("sar")||s.pixelAspectRatio,z=$f(o,"InbandEventStream"),G=s.emsgSchemeIdUris.slice(),q=(z=t(z)).next();!q.done;q=z.next())q=q.value.getAttribute("schemeIdUri"),G.includes(q)||G.push(q);z=function sr(o){for(var s=(o=t(o)).next();!s.done;s=o.next()){var m=s.value;if((s=m.getAttribute("schemeIdUri"))&&(m=m.getAttribute("value")))switch(s){case"urn:mpeg:dash:outputChannelPositionList:2012":return m.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":if(!(s=parseInt(m,10)))continue;return s;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(s=parseInt(m,16)))continue;for(o=0;s;)1&s&&++o,s>>=1;return o;case"urn:mpeg:mpegB:cicp:ChannelConfiguration":if(s=[0,1,2,3,4,5,6,8,2,3,4,7,8,24,8,12,10,12,14,12,14],(m=parseInt(m,10))&&0<m&&m<s.length)return s[m]}}return null}(z=$f(o,"AudioChannelConfiguration"))||s.Gd,q=hg(o,"audioSamplingRate",ng)||s.audioSamplingRate,E||(E=pr(A,O));var X=Zf(o,"SegmentBase"),J=Zf(o,"SegmentTemplate"),ae=X&&hg(X,"availabilityTimeOffset",og)||0,pe=J&&hg(J,"availabilityTimeOffset",og)||0;return _=_&&_.length&&hg(_[0],"availabilityTimeOffset",og)||0,_=s.Tb+_+ae+pe,{Da:uc(m,S),Wc:X||s.Wc,ub:Zf(o,"SegmentList")||s.ub,Xc:J||s.Xc,width:hg(o,"width",ng)||s.width,height:hg(o,"height",ng)||s.height,contentType:E,mimeType:A,codecs:O,frameRate:H,pixelAspectRatio:K,emsgSchemeIdUris:G,id:o.getAttribute("id"),language:o.getAttribute("lang"),Gd:z,audioSamplingRate:q,Tb:_}}function tr(o,s,m,_){var S,E,A,O,H,K;return I((function(z){if(1==z.g)return S=uc(s,[m]),(E=bf(S,o.g.retryParameters)).method=_,A=o.h.networkingEngine.request(4,E),Xe(o.u,A),C(z,A.promise,2);if(O=z.h,"HEAD"==_){if(!O.headers||!O.headers.date)return z.return(0);H=O.headers.date}else H=xf(O.data);return K=Date.parse(H),isNaN(K)?z.return(0):z.return(K-Date.now())}))}function lr(o,s,m,_,S){for(var E=_.getAttribute("schemeIdUri")||"",A=_.getAttribute("value")||"",O=hg(_,"timescale",ng)||1,H=(_=t($f(_,"Event"))).next();!H.done;H=_.next()){var K=hg(H=H.value,"presentationTime",ng)||0,z=hg(H,"duration",ng)||0;z=(K=K/O+s)+z/O,null!=m&&(K=Math.min(K,s+m),z=Math.min(z,s+m)),z<S||(H={schemeIdUri:E,value:A,startTime:K,endTime:z,id:H.getAttribute("id")||"",eventElement:H},o.h.onTimelineRegionAdded(H))}}function pr(o,s){return Lc(s=Cc(o,s))?qt:o.split("/")[0]}function ur(){}(_=br.prototype).configure=function(o){this.g=o},_.start=function(o,s){var m,_=this;return I((function(S){if(1==S.g)return _.o=s.isLowLatencyMode(),_.s=[o],_.h=s,C(S,dr(_),2);if(m=S.h,_.h&&er(_,m),!_.h)throw new N(2,7,7001);return S.return(_.i)}))},_.stop=function(){for(var o=t(Object.values(this.l)),s=o.next();!s.done;s=o.next())(s=s.value).segmentIndex&&s.segmentIndex.release();return this.j&&this.j.release(),this.g=this.h=null,this.s=[],this.i=null,this.l={},this.j=null,null!=this.F&&(this.F.stop(),this.F=null),this.u.destroy()},_.update=function(){var o,s=this;return I((function(m){return 1==m.g?(wa(m,2),C(m,dr(s),4)):2!=m.g?Aa(m,0):(o=Ba(m),s.h&&o?(s.h.onError(o),void D(m)):m.return())}))},_.onExpirationUpdated=function(){},L("shaka.dash.DashParser",br),aa.mpd=function(){return new br},na["application/dash+xml"]=function(){return new br},na["video/vnd.mpeg.dash.mpd"]=function(){return new br},L("shaka.dependencies",ur),ur.has=function(o){return hh.has(o)},ur.add=function(o,s){if(!uh[o])throw Error(o+" is not supported");hh.set(o,(function(){return s}))};var uh={muxjs:"muxjs",ISOBoxer:"ISOBoxer"};ur.Allowed=uh;var hh=new Map([["muxjs",function(){return o.muxjs}],["ISOBoxer",function(){return o.ISOBoxer}]]);function xr(o,s){return o.filter((function(o){return o.name==s}))}function yr(o,s){return o.filter((function(o){return zr(o,"TYPE")==s}))}function Ar(o,s){return(o=xr(o,s)).length?o[0]:null}function Br(o,s,m){return m=void 0===m?0:m,(o=Ar(o,s))?Number(o.value):m}function Cr(o,s){return uc([o],[s])[0]}function Dr(o,s,m,_){this.h=o,this.type=s,this.g=m,this.segments=_||null}function Er(o,s,m,_){this.id=o,this.name=s,this.g=m,this.value=void 0===_?null:_}function Y(o,s,m){return(o=o.getAttribute(s))?o.value:m||null}function zr(o,s){if(!(o=o.getAttribute(s)))throw new N(2,4,4023,s);return o.value}function Fr(o,s,m,_){_=void 0===_?[]:_,this.g=m,this.l=null,this.j=o,this.m=s,this.h=_}function Gr(o,s){this.name=o,this.value=s}function Hr(o){this.h=o||"",this.g=0}function Ir(o){Jr(o,/[ \t]+/gm)}function Jr(o,s){return s.lastIndex=o.g,s=null==(s=s.exec(o.h))?null:{position:s.index,length:s[0].length,results:s},o.g==o.h.length||null==s||s.position!=o.g?null:(o.g+=s.length,s.results)}function Kr(o){return o.g==o.h.length?null:(o=Jr(o,/[^ \t\n]*/gm))?o[0]:null}function Lr(){this.g=0}function Mr(o,s,m){var _=(s=(s=xf(s)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(_[0]))throw new N(2,4,4015);s=0;for(var S=!0,E=t(_),A=E.next();!A.done;A=E.next())if(A=A.value,/^#(?!EXT)/m.test(A)||S)S=!1;else{if(A=Nr(o,A),--o.g,mh.includes(A.name)){s=1;break}"EXT-X-STREAM-INF"==A.name&&(S=!0)}for(E=[],S=!0,A=0;A<_.length;A++){var O=_[A],H=_[A+1];if(/^#(?!EXT)/m.test(O)||S)S=!1;else{if(O=Nr(o,O),vh.includes(O.name)){if(1!=s)throw new N(2,4,4017);var K=_.splice(A,_.length-A);_=m,S=[],A=[],H=[],O=null;for(var z=(K=t(K)).next();!z.done;z=K.next())z=z.value,/^(#EXT)/.test(z)?(z=Nr(o,z),mh.includes(z.name)?E.push(z):"EXT-X-MAP"==z.name?O=z:"EXT-X-PART"==z.name?H.push(z):"EXT-X-PRELOAD-HINT"==z.name?"PART"==Y(z,"TYPE")?H.push(z):"MAP"==Y(z,"TYPE")&&(z.name="EXT-X-MAP",O=z):A.push(z)):/^#(?!EXT)/m.test(z)||(z=z.trim(),O&&A.push(O),S.push(new Fr(_,z,A,H)),A=[],H=[]);return H.length&&(O&&A.push(O),S.push(new Fr("","",A,H))),new Dr(m,s,E,S)}E.push(O),"EXT-X-STREAM-INF"==O.name&&(O.g.push(new Gr("URI",H)),S=!0)}}return new Dr(m,s,E)}function Nr(o,s){o=o.g++;var m=s.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!m)throw new N(2,4,4016,s);s=m[1];var _,S=m[2];if(m=[],S){var E;(E=Jr(S=new Hr(S),/^([^,=]+)(?:,|$)/g))&&(_=E[1]);for(var A=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;E=Jr(S,A);)m.push(new Gr(E[1],E[2]||E[3])),Ir(S)}return new Er(o,s,m,_)}Er.prototype.toString=function(){var o="#"+this.name,s=this.g?this.g.map((function a(o){return o.name+"="+(isNaN(Number(o.value))?'"'+o.value+'"':o.value)})):[];return this.value&&s.unshift(this.value),0<s.length&&(o+=":"+s.join(",")),o},Er.prototype.getAttribute=function(o){var s=this.g.filter((function(s){return s.name==o}));return s.length?s[0]:null},E.Object.defineProperties(Fr.prototype,{i:{configurable:!0,enumerable:!0,get:function get(){return!this.l&&this.j&&this.m&&(this.l=Cr(this.j,this.m),this.m=this.j=null),this.l||""}}});var mh="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST EXT-X-SERVER-CONTROL EXT-X-SKIP EXT-X-PART-INF".split(" "),vh="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE EXT-X-MAP".split(" ");function Qr(){}function Rr(o){try{var s=Sr(o);return Ne({uri:o,originalUri:o,data:s.data,headers:{"content-type":s.contentType}})}catch(o){return Le(o)}}function Sr(s){var m=s.split(":");if(2>m.length||"data"!=m[0])throw new N(2,1,1004,s);if(2>(m=m.slice(1).join(":").split(",")).length)throw new N(2,1,1004,s);var _=m[0];s=o.decodeURIComponent(m.slice(1).join(",")),m=_.split(";"),_=m[0];var S=!1;return 1<m.length&&"base64"==m[m.length-1]&&(S=!0,m.pop()),{data:S?Tf(s):Bf(s),contentType:_}}function Tr(){var o=this;this.g=this.i=null,this.Na=1,this.s=new Map,this.A=new Map,this.G=new Map,this.G.set("video",new Map),this.G.set("audio",new Map),this.G.set(qt,new Map),this.G.set("image",new Map),this.ga=new Set,this.h=new Map,this.j=null,this.N="",this.X=new Lr,this.C=-1,this.L=1/0,this.Za=!1,this.m=new dd((function(){!function Ur(o){var s,m;I((function(_){return 1==_.g?o.i?(wa(_,2),C(_,o.update(),4)):_.return():2!=_.g?(Yr(o)&&(s=o.l,o.m.S(s)),Aa(_,0)):(m=Ba(_),o.i?o.g.raiseFatalErrorOnManifestUpdateRequestFailure?(o.i.onError(m),_.return()):(m.severity=1,o.i.onError(m),o.m.S(.1),void D(_)):_.return())}))}(o)})),this.aa=qh,this.F=null,this.Z=0,this.l=1/0,this.W=this.V=this.H=0,this.I=new We,this.M=new Map,this.u=new Map,this.Y=new Map,this.Oa=this.o=!1}function ds(o,s){return Yr(o)?o.G.get(s.type):s.Dd}function Zr(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He,et,rt,it;return I((function(at){if(1==at.g)return m=s.hd,_=new bc(m),S=new gc,s.kd&&(0<=s.Ga&&S.add("_HLS_msn",String(s.Ga)),0<=s.Ha&&S.add("_HLS_part",String(s.Ha))),s.ld&&S.add("_HLS_skip","YES"),pc(S),S.Dc&&ec(_,S),C(at,Wr(o,_.toString(),!0),2);if(E=at.h,!s.stream.segmentIndex)return at.return();if(1!=(A=Mr(o.X,E.data,E.uri)).type)throw new N(2,4,4017);O=xr(A.g,"EXT-X-DEFINE"),H=es(o,O),K=s.stream,z=ds(o,s),G=fs(A,K.mimeType),q=G.keyIds,X=G.drmInfos,J=function u(o,s){return o.size===s.size&&[].concat(v(o)).every((function(o){return s.has(o)}))},J(K.keyIds,q)||(K.keyIds=q,K.drmInfos=X,o.i.newDrmInfo(K)),ae=gs(o,A,K.type,K.mimeType,z,H),pe=ae.segments,me=ae.bandwidth,K.bandwidth=me,K.segmentIndex.Pc(pe,o.j.fb()),pe.length&&(_e=Br(A.g,"EXT-X-MEDIA-SEQUENCE",0),Ee=(Se=Ar(A.g,"EXT-X-SKIP"))?Number(Y(Se,"SKIPPED-SEGMENTS")):0,De=hs(_e,pe),$e=De.Ga,He=De.Ha,s.Ga=$e+Ee,s.Ha=He,et=z.get(_e),K.segmentIndex.Ta(et)),rt=pe[0],s.Gb=rt.startTime,it=pe[pe.length-1],s.ib=it.endTime,Ar(A.g,"EXT-X-ENDLIST")&&(s.Mc=!0),is(o,A),D(at)}))}function ks(o,s,m){s.Gb+=m,s.ib+=m;for(var _=(s=t(o=ds(o,s))).next();!_.done;_=s.next()){var S=t(_.value);_=S.next().value,S=S.next().value,o.set(_,S+m)}}function cs(o){if(Yr(o)){if(o.aa==ap){for(var s,m=s=1/0,_=t(o.h.values()),S=_.next();!S.done;S=_.next())(S=S.value).stream.segmentIndex&&"text"!=S.stream.type&&(s=Math.min(s,S.ib),m=Math.min(m,S.Gb));s-=m,o.g.hls.useSafariBehaviorForLive&&(s=o.j.m),isNaN(o.g.availabilityWindowOverride)||(s=o.g.availabilityWindowOverride),o.j.Md(s)}}else o.j.Aa(Cs(o));o.j.Cd()}function es(o,s){for(var m=new Map,_=(s=t(s)).next();!_.done;_=s.next()){var S=_.value;_=Y(S,"NAME");var E=Y(S,"VALUE");S=Y(S,"IMPORT"),_&&E&&m.set(_,E),S&&(_=o.s.get(S))&&m.set(S,_)}return m}function ns(o,s){var m=[];return o.g.disableVideo||m.push(o.g.hls.defaultVideoCodec),o.g.disableAudio||m.push(o.g.hls.defaultAudioCodec),As(o=Y(s,"CODECS",m.join(",")).split(/\s*,\s*/))}function As(o){for(var s=new Set,m=[],_=(o=t(o)).next();!_.done;_=o.next()){var S=Ic(_=_.value)[0];s.has(S)||(m.push(_),s.add(S))}return m}function Ds(o,s){var m=zr(s,"GROUP-ID"),_="",S=zr(s,"TYPE").toLowerCase();"subtitles"==S&&(S=qt);var E=S;if(E==qt?_=Y(s,"CODECS")||"":m&&o.u.has(m)&&(_=o.u.get(m)),S=Ks(zr(s,"URI"),o.s),o.h.has(S))return o.h.get(S);var A=Y(s,"LANGUAGE"),O=Y(s,"NAME"),H="YES"==Y(s,"DEFAULT"),K="audio"==E&&(K=Y(s,"CHANNELS"))?parseInt(K.split("/")[0],10):null,z="audio"==E&&(!!(z=Y(s,"CHANNELS"))&&z.includes("/JOC"));return _=Ls(o,S,_,E,A,H,O,K,null,Y(s,"CHARACTERISTICS"),"YES"==Y(s,"FORCED"),s="audio"==E&&(s=Y(s,"SAMPLE-RATE"))?parseInt(s,10):null,z),o.A.has(m)?o.A.get(m).push(_):o.A.set(m,[_]),o.h.has(S)?o.h.get(S):(o.h.set(S,_),_)}function Ls(o,s,m,_,S,E,A,O,H,K,z,G,q){function r(X){var pe,me,_e,Se,Ee,De,$e,He,et,rt,it,at,ot,st;return I((function(ut){if(1==ut.g)return C(ut,Wr(o,ae.hd,!0),2);if(3!=ut.g)return pe=ut.h,X.aborted?ut.return():(me=pe.uri,_e=Mr(o.X,pe.data,me),Se=Yr(o),C(ut,ss(o,_e,s,me,m,_,S,E,A,O,H,K,z,G,q),3));if(Ee=ut.h,X.aborted)return ut.return();if(De=Ee.stream,Yr(o)&&!Se&&us(o),ae.hd=me,ae.Gb=Ee.Gb,ae.ib=Ee.ib,ae.ld=Ee.ld,ae.kd=Ee.kd,ae.Mc=Ee.Mc,ae.Dd=Ee.Dd,ae.Ga=Ee.Ga,ae.Ha=Ee.Ha,ae.ne=!0,J.segmentIndex=De.segmentIndex,J.encrypted=De.encrypted,J.drmInfos=De.drmInfos,J.keyIds=De.keyIds,J.mimeType=De.mimeType,J.bandwidth=De.bandwidth,J.drmInfos.length&&o.i.newDrmInfo(J),_==($e=Jt).va||_==$e.qb)for(He=t(o.h.values()),et=He.next();!et.done;et=He.next())(rt=et.value).ne||rt.type!=_||(rt.stream.mimeType=De.mimeType);_==$e.da&&(it=De.segmentIndex.get(0))&&it.h&&(J.mimeType="application/mp4"),function Ms(o){if(!o.F)return!1;for(var s=[],m=[],_=(o=t(o.F.variants)).next();!_.done;_=o.next())(_=_.value).video&&s.push(_.video),_.audio&&m.push(_.audio);return!(0<s.length&&!s.some((function(o){return o.segmentIndex}))||0<m.length&&!m.some((function(o){return o.segmentIndex})))}(o)&&(o.Za?vs(o,[ae]):(o.Za=!0,at=Array.from(o.h.values()),ot=at.filter((function(o){return o.stream.segmentIndex})),vs(o,ot),cs(o),0<(st=o.l)&&o.m.S(st))),D(ut)}))}var X=Cr(o.N,s),J=Ns(o,m,_,S,E,A,O,H,K,z,G,q),ae={stream:J,type:_,Zc:s,hd:X,Gb:0,ib:0,Dd:new Map,ld:!1,kd:!1,Mc:!1,ae:-1,Ga:-1,Ha:-1,ne:!1},pe=null,me=new AbortController;return J.createSegmentIndex=function(){return pe||(me=new AbortController,pe=new Promise((function(o){o(r(me.signal))})))},J.closeSegmentIndex=function(){pe&&!J.segmentIndex&&me.abort(),J.segmentIndex&&(J.segmentIndex.release(),J.segmentIndex=null),pe=null},ae}function Cs(o){for(var s=1/0,m=(o=t(o.h.values())).next();!m.done;m=o.next())(m=m.value).stream.segmentIndex&&"text"!=m.stream.type&&(s=Math.min(s,m.ib));return s}function $r(o,s){for(var m=[],_=(s=t(s)).next();!_.done;_=s.next())(_=_.value).segmentIndex&&ij(_.segmentIndex,(function(o){m.push(o)}));o.j.Qc(m)}function vs(o,s){if(!Yr(o))for(var m=Cs(o),_=t(s),S=_.next();!S.done;S=_.next())S.value.stream.segmentIndex.Ub(0,m);$r(o,s.map((function(o){return o.stream}))),o.g.hls.ignoreManifestProgramDateTime?function js(o,s){for(var m=-1==o.C,_=t(s),S=_.next();!S.done;S=_.next()){var E=(S=S.value).stream.segmentIndex,A=ds(o,S);if(E=E.g[0]||null)for(var O=(A=t(A)).next();!O.done;O=A.next()){var H=(O=t(O.value)).next().value;if(O.next().value==E.startTime){m&&(o.C=Math.max(o.C,H)),S.ae=H;break}}}if(!(0>o.C))for(S=(s=t(s)).next();!S.done;S=s.next())(_=(m=S.value).stream.segmentIndex)&&(_.g.splice(0,o.C-m.ae),(_=_.g[0]||null)&&(_=-_.startTime,m.stream.segmentIndex.offset(_),ks(o,m,_)))}(o,s):function ls(o,s){if(1/0==o.L)for(var m=(s=t(s)).next();!m.done;m=s.next()){var _=m.value.stream.segmentIndex.g[0]||null;null!=_&&null!=_.g&&(o.L=Math.min(o.L,_.g))}if(1/0!=(s=o.L))for(m=(_=t(o.h.values())).next();!m.done;m=_.next()){var S=(m=m.value).stream.segmentIndex;if(null!=S){var E=S.g[0]||null;if(null==E.g)Ya("Missing EXT-X-PROGRAM-DATE-TIME for stream",m.Zc,"Expect AV sync issues!");else for(ks(o,m,E.g-s-E.startTime),S=(m=t(S)).next();!S.done;S=m.next())S.value.Oe(s)}}}(o,s)}function ss(o,s,m,_,S,E,A,O,H,K,z,G,q,X,J,ae){var pe,me,_e,Se,Ee,De,$e,He,et,rt,it,at,ot,st,ut,ct,dt,ht,pt,gt,_t,bt,kt;return I((function(It){if(1==It.g){if(1!=s.type)throw new N(2,4,4017);pe=xr(s.g,"EXT-X-DEFINE"),me=es(o,pe);var At=Ar(s.g,"EXT-X-PLAYLIST-TYPE"),Lt=Ar(s.g,"EXT-X-ENDLIST");return Lt=At&&"VOD"==At.value||Lt,At=At&&"EVENT"==At.value&&!Lt,At=!Lt&&!At,bs(o,Lt?qh:At?ap:np),Yr(o)&&is(o,s),ae?It.B(2):C(It,function Ps(o,s,m,_,S){var E,A,O,H,K,z,G,q,X,J;return I((function(ae){return 1==ae.g?(E=_r,A=Math.trunc((_.segments.length-1)/2),O=Ks(_.segments[A].i,S),H=new bc(O),K=H.ta.split(".").pop(),z=bh[s],(G=z[K])||(G=_h[K])||(G=Es(s,m))?ae.return(G):((q=bf([O],o.g.retryParameters)).method="HEAD",C(ae,ys(o,q,E,{type:1}),2))):(X=ae.h,(J=X.headers["content-type"])?ae.return(J.split(";")[0]):ae.return(Fs(s)))}))}(o,E,S,s,me),3)}if(2!=It.g&&(ae=It.h),_e=fs(s,ae),Se=_e.drmInfos,Ee=_e.keyIds,De=_e.encrypted,$e=_e.Uf,De&&!Se.length&&!$e)throw new N(2,4,4026);return He=Yr(o)?o.G.get(E):new Map,et=gs(o,s,E,ae,He,me),rt=et.segments,it=et.bandwidth,Yr(o)&&is(o,s),at=rt[0].startTime,ot=rt[rt.length-1],st=ot.endTime,ut=new hj(rt),dt=!!(ct=Ar(s.g,"EXT-X-SERVER-CONTROL"))&&null!=ct.getAttribute("CAN-SKIP-UNTIL"),ht=!!ct&&null!=ct.getAttribute("CAN-BLOCK-RELOAD"),pt=Br(s.g,"EXT-X-MEDIA-SEQUENCE",0),gt=hs(pt,rt),_t=gt.Ga,bt=gt.Ha,(kt=Ns(o,S,E,A,O,H,K,z,G,q,X,J)).segmentIndex=ut,kt.encrypted=De,kt.drmInfos=Se,kt.keyIds=Ee,kt.mimeType=ae,kt.bandwidth=it,It.return({stream:kt,type:E,Zc:m,hd:_,Gb:at,ib:st,ld:dt,kd:ht,Mc:!1,ae:-1,Ga:_t,Ha:bt,Dd:He,ne:!1})}))}function hs(o,s){o=o+s.length-1;var m=-1;if(!s.length)return{Ga:++o,Ha:m};var _=(s=s[s.length-1]).i;return s.i.length?(m=_.length-1,_[_.length-1].m||(o++,m=0),{Ga:o,Ha:m}):(o++,s.o&&(m=0),{Ga:o,Ha:m})}function Ns(o,s,m,_,S,E,A,O,H,K,z,G){var q=Es(m,s)||Fs(m),X=[];if(H)for(var J=(H=t(H.split(","))).next();!J.done;J=H.next())X.push(J.value);return H=m==qt?"subtitle":void 0,X.length||"subtitle"!==H||X.push("subtitle"),{id:o.Na++,originalId:E,createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},segmentIndex:null,mimeType:q,codecs:s,kind:m==qt?"subtitle":void 0,encrypted:!1,drmInfos:[],keyIds:new Set,language:Uc(_||"und"),originalLanguage:_,label:E,type:m,primary:S,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:X,forced:K,channelsCount:A,audioSamplingRate:z,spatialAudio:G,closedCaptions:O,hdr:void 0,tilesLayout:void 0,accessibilityPurpose:null,external:!1}}function fs(o,s){var m=[];if(o.segments)for(var _=(o=t(o.segments)).next();!_.done;_=o.next())_=xr(_.value.g,"EXT-X-KEY"),m.push.apply(m,v(_));_=o=!1;for(var S=[],E=new Set,A=(m=t(m)).next();!A.done;A=m.next()){var O=zr(A=A.value,"METHOD");if("NONE"!=O)if(o=!0,"AES-128"==O)_=!0;else if(O=Y(A,"KEYFORMAT")||"identity",A=(O=kh[O])?O(A,s):null){if(A.keyIds)for(var H=(O=t(A.keyIds)).next();!H.done;H=O.next())E.add(H.value);S.push(A)}}return{drmInfos:S,keyIds:E,encrypted:o,Uf:_}}function Qs(s,m,_){if(!o.crypto||!o.crypto.subtle)throw $a("Web Crypto API is not available to decrypt AES-128. (Web Crypto only exists in secure origins like https)"),new N(2,4,4042);var S=0,E=Y(m,"IV","");if(E){var A=Uf(E.substr(2));if(16!=A.byteLength)throw new N(2,4,4043)}else S=Br(_.g,"EXT-X-MEDIA-SEQUENCE",0);var O=bf([m=Cr(_.h,zr(m,"URI"))],s.g.retryParameters),H={method:"AES-128",iv:A,firstMediaSequenceNumber:S,fetchKey:function fetchKey(){var m,_,S;return I((function(E){if(1==E.g)return C(E,ys(s,O,6),2);if(3!=E.g){if(!(m=E.h).data||16!=m.data.byteLength)throw new N(2,4,4044);return _={name:"AES-CBC"},S=H,C(E,o.crypto.subtle.importKey("raw",m.data,_,!0,["decrypt"]),3)}S.cryptoKey=E.h,H.fetchKey=void 0,D(E)}))}};return H}function is(o,s){var m=1/0,_=s.segments;if(_.length)for(var S=_.length-1;0<=S;){var E=Ar(_[S].g,"EXTINF");if(E){m=Number(E.value.split(",")[0]);break}S--}if(!(_=Ar(s.g,"EXT-X-TARGETDURATION")))throw new N(2,4,4024,"EXT-X-TARGETDURATION");_=Number(_.value),(S=Ar(s.g,"EXT-X-PART-INF"))&&(o.H=Number(zr(S,"PART-TARGET"))),s=Ar(s.g,"EXT-X-SERVER-CONTROL"),o.o&&o.H?(o.l=o.Oa?5*o.H<=m?Math.min(o.H,o.l):Math.min(m,o.l):Math.min(o.H,o.l),o.W=s?Number(zr(s,"PART-HOLD-BACK")):0):(o.l=Math.min(m,o.l),m=s?s.getAttribute("HOLD-BACK"):null,o.V=m?Number(m.value):0),o.Z=Math.max(_,o.Z)}function us(o){var s=o.g.defaultPresentationDelay?o.g.defaultPresentationDelay:o.W?o.W:o.V?o.V:o.Z*o.g.hls.liveSegmentsDelay;o.j.Hf(0),o.j.Gf(s),o.j.fc(!1)}function xs(o,s,m,_){return(m=Ar(m,"EXT-X-MAP"))?(s=[_=Ks(Cr(s,zr(m,"URI")),_),Y(m,"BYTERANGE","")].join("-"),o.Y.has(s)||(m=function Rs(o,s){var m=0,_=null;(s=Y(s,"BYTERANGE"))&&(m=s.split("@"),_=Number(m[0]),m=Number(m[1]),_=m+_-1);return new sh((function(){return[o]}),m,_)}(_,m),o.Y.set(s,m)),o.Y.get(s)):null}function Ss(s,m,_,S,E,A,O,H,K,z,G){var q=S.g,X=Ar(q,"EXTINF"),J=0,ae=0,pe=null;S.h.length&&!s.o&&$a("Low-latency HLS live stream detected, but low-latency streaming mode is not enabled in Shaka Player. Set streaming.lowLatencyMode configuration to true, and see https://bit.ly/3clctcj for details.");var me=null;if(!s.g.hls.ignoreManifestProgramDateTime){var _e=Ar(q,"EXT-X-PROGRAM-DATE-TIME");_e&&_e.value&&(me=ig(_e.value))}var Se=la;if(Ar(q,"EXT-X-GAP")&&(Se=2),!X){if(0==S.h.length)throw new N(2,4,4024,"EXTINF");if(!s.o)return null}var Ee=[];_e=!1;var De=null,$e=!1,He=!1;if(s.o&&S.h.length){J=("video/mp4"==K||"audio/mp4"==K)&&o.ReadableStream,K=me;for(var et={},rt=0;rt<S.h.length;et={qc:et.qc,dd:et.dd},rt++){var it=S.h[rt],at=0==rt?_:Ee[Ee.length-1],ot=0==rt?E:at.endTime,st=Number(Y(it,"DURATION"))||s.H;if(st){var ut=ot+st,ct=0,dt=null;if("EXT-X-PRELOAD-HINT"==it.name?(ct=(ct=Y(it,"BYTERANGE-START"))?Number(ct):0,(at=Y(it,"BYTERANGE-LENGTH"))?dt=ct+Number(at)-1:ct&&(dt=Number.MAX_SAFE_INTEGER)):(ct=(dt=t(Ts(at,ct=Y(it,"BYTERANGE")))).next().value,dt=dt.next().value),et.dd=Y(it,"URI"),et.dd){at=la,"YES"==Y(it,"GAP")&&(at=2,$e=!0),et.qc=null;var ht=function(o){return function(){return null==o.qc&&(o.qc=Cr(O,o.dd)),[o.qc]}}(et);J&&0<=ct&&null!=dt&&(De=ht,_e=!0),ot=new Q(ot,ut,ht,ct,dt,m,0,0,1/0,[],"",null,K,at,G),"EXT-X-PRELOAD-HINT"==it.name&&(ot.pe(),He=!0),"YES"!=Y(it,"INDEPENDENT")&&0<rt&&ot.vf(),Ee.push(ot),K&&(K+=st)}}}}if(X){if(0==(X=Number(X.value.split(",")[0])))return null;J=E+X}else J=Ee[Ee.length-1].endTime;_e&&($e||0!=Ee[0].Ba?(_e=!1,De=null):Ee=[]),(X=Ar(q,"EXT-X-BYTERANGE"))?(ae=(pe=t(Ts(_,X.value))).next().value,pe=pe.next().value):Ee.length&&(ae=Ee[0].Ba,pe=Ee[Ee.length-1].ka),_="",X=null,"image"==H&&(_="1x1",H=Ar(q,"EXT-X-TILES"))&&(_=zr(H,"LAYOUT"),(H=Y(H,"DURATION"))&&(X=Number(H)));var pt=null;return m=new Q(E,J,(function(){return De?De():(null==pt&&(pt=Ks(S.i,A)),pt.length?[pt]:[])}),ae,pe,m,z,0,1/0,Ee,_,X,me,Se,G),_e&&(s.Oa=!0,m.uf(),He&&m.pe()),m}function Ts(o,s){var m=0,_=null;return s&&(m=s.split("@"),s=Number(m[0]),_=(m=m[1]?Number(m[1]):o.ka+1)+s-1),[m,_]}function gs(o,s,m,_,S,E){var A=s.segments,O=void 0,H=Br(s.g,"EXT-X-DISCONTINUITY-SEQUENCE",0),K=Br(s.g,"EXT-X-MEDIA-SEQUENCE",0),z=Ar(s.g,"EXT-X-SKIP"),G=z?Number(Y(z,"SKIPPED-SEGMENTS")):0,q=K+G,X=0;Yr(o)&&S.has(q)&&(X=S.get(q));var J=[],ae=null,pe=X;z=[];for(var me=0;me<A.length;me++){var _e=A[me],Se=0==me?X:ae.endTime;q=K+G+me,Ar(_e.g,"EXT-X-DISCONTINUITY")&&(H++,pe=Se);for(var Ee=t(_e.g),De=Ee.next();!De.done;De=Ee.next())"EXT-X-KEY"==(De=De.value).name&&(O="AES-128"==zr(De,"METHOD")?Qs(o,De,s):void 0);S.set(q,Se),Ee=xs(o,s.h,_e.g,E),!o.o&&o.i.isAutoLowLatencyMode()&&(o.i.enableLowLatencyMode(),o.o=o.i.isLowLatencyMode()),(Se=Ss(o,Ee,ae,_e,Se,E,s.h,m,_,pe,O))&&((ae=Br(_e.g,"EXT-X-BITRATE"))?z.push({bitrate:ae,duration:Se.endTime-Se.startTime}):z.length&&((ae=z.pop()).duration+=Se.endTime-Se.startTime,z.push(ae)),ae=Se,Se.j=H,o.g.hls.ignoreManifestProgramDateTime&&null!=o.C&&q<o.C||J.push(Se))}if(s=void 0,z.length&&(s=z.reduce((function(o,s){return o+s.duration}),0),s=Math.round(z.reduce((function(o,s){return o+s.bitrate*s.duration}),0)/s*1e3)),z=J.some((function(o){return null!=o.g})))for(m={},_=0;_<J.length;m={mc:m.mc,lc:m.lc,$c:m.$c,nb:m.nb,kc:m.kc},_++)if(m.nb=J[_],null==m.nb.g)for(m.lc=0,m.mc=_,S=function(o){return function(){var s=J[o.mc];if(s){if(null!=s.g)return s.g+o.lc;o.lc-=s.endTime-s.startTime,o.mc+=1}return null}}(m),m.kc=0,m.$c=_,E=function(o){return function(){var s=J[o.$c];if(s){if(s!=o.nb&&(o.kc+=s.endTime-s.startTime),null!=s.g)return s.g+o.kc;--o.$c}return null}}(m);null==m.nb.g;)m.nb.g=E(),null==m.nb.g&&(m.nb.g=S());if(z)for(_=(m=t(J)).next();!_.done;_=m.next())for(_=(S=_.value).g,E=(S=t(S.i)).next();!E.done;E=S.next())(E=E.value).g=_,_+=E.endTime-E.startTime;if(o=o.L,z&&1/0!=o)for(_=(z=t(J)).next();!_.done;_=z.next())_.value.Oe(o);return{segments:J,bandwidth:s}}function Ks(o,s){if(!s.size)return o;var m=(o=String(o).replace(/%7B/g,"{").replace(/%7D/g,"}")).match(/{\$\w*}/g);if(m)for(var _=(m=t(m)).next();!_.done;_=m.next()){var S=(_=_.value).slice(2,_.length-1),E=s.get(S);if(!E)throw new N(2,4,4039,S);o=o.replace(_,E)}return o}function Es(o,s){if(o==qt){if("vtt"==s||"wvtt"==s)return"text/vtt";if(s&&""!==s)return"application/mp4"}return"image"!=o||s&&"jpeg"!=s?"audio"==o&&"mp4a.40.34"==s?"audio/mpeg":null:"image/jpeg"}function Fs(o){return o==qt?"text/vtt":bh[o].mp4}function ts(o,s,m,_,S){o&&(o.width=Number(s)||void 0,o.height=Number(m)||void 0,o.frameRate=Number(_)||void 0,o.hdr=S||void 0)}function Wr(o,s,m){return ys(o,bf([s],o.g.retryParameters),0,{type:m?2:3})}function Yr(o){return o.aa!=qh}function bs(o,s){o.aa=s,o.j&&o.j.fc(!Yr(o)),Yr(o)||o.m.stop()}function ys(o,s,m,_){if(!o.I)throw new N(2,7,7001);return s=o.i.networkingEngine.request(m,s,_),Xe(o.I,s),s.promise}L("shaka.net.DataUriPlugin",Qr),Qr.parse=Rr,Ze("data",Rr),(_=Tr.prototype).configure=function(o){this.g=o},_.start=function(o,s){var m,_=this;return I((function(S){return 1==S.g?(_.i=s,_.o=s.isLowLatencyMode(),C(S,Wr(_,o),2)):3!=S.g?(m=S.h,_.N=m.uri,C(S,function Xr(o,s,m){var _,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He,et,rt,it,at,ot,st,ut,ct,dt,ht;return I((function(pt){switch(pt.g){case 1:_=Mr(o.X,s,o.N);for(var gt=t(xr(_.g,"EXT-X-DEFINE")),_t=gt.next();!_t.done;_t=gt.next()){var bt=_t.value;_t=Y(bt,"NAME"),bt=Y(bt,"VALUE"),_t&&bt&&(o.s.has(_t)||o.s.set(_t,bt))}if(S=[],E=[],A=[],1==_.type)return C(pt,function ms(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e;return I((function(Se){if(1==Se.g)return m=o.g.hls.mediaPlaylistFullMimeType,_=m.split(";")[0],S=_.split("/")[0],E=Jc(m),A={type:S,mimeType:_,codecs:E,language:null,height:null,width:null,channelCount:null,sampleRate:null},s.segments.length?(O=s.segments[0],H=new bc(O.i),K=H.ta.split(".").pop(),(z=_h[K])?Se.return({type:"audio",mimeType:z,codecs:"",language:null,height:null,width:null,channelCount:null,sampleRate:null}):(G=[O.i],(q=xs(o,s.h,O.g,new Map))&&(G=q.wa()),X=_r,J=bf(G,o.g.retryParameters),C(Se,ys(o,J,X,{type:q?0:1}),2))):Se.return(A);if(ae=Se.h,(pe=ae.headers["content-type"])&&(pe=pe.split(";")[0].toLowerCase()),"ts"==K||"video/mp2t"==pe){var Ee=M(ae.data),De=(new Zh).parse(Ee),$e=De.od();Ee=[];var He=!1,et=!1;switch($e.audio){case"aac":Ee.push("mp4a.40.2"),He=!0;break;case"mp3":Ee.push("mp4a.40.34"),He=!0;break;case"ac3":Ee.push("ac-3"),He=!0;break;case"ec3":Ee.push("ec-3"),He=!0}switch($e.video){case"avc":Ee.push("avc1.42E01E"),et=!0;break;case"hvc":Ee.push("hvc1.1.6.L93.90"),et=!0}if(Ee.length?($e=He&&!et,De=De.nf(),Ee={type:$e?"audio":"video",mimeType:"video/mp2t",codecs:Ee.join(", "),language:null,height:De.height,width:De.width,channelCount:null,sampleRate:null}):Ee=null,me=Ee)return Se.return(me)}else if(("mp4"==K||"video/mp4"==pe||"audio/mp4"==pe)&&(_e=function zs(o){function b(o){return c(o.name)}function c(o){switch(o=o.toLowerCase()){case"avc1":case"avc3":s.push(o+".42E01E"),_=!0;break;case"hev1":case"hvc1":s.push(o+".1.6.L93.90"),_=!0;break;case"dvh1":case"dvhe":s.push(o+".05.04"),_=!0;break;case"vp09":s.push(o+".00.10.08"),_=!0;break;case"av01":s.push(o+".0.01M.08"),_=!0;break;case"mp4a":s.push("mp4a.40.2"),m=!0;break;case"ac-3":case"ec-3":case"opus":case"flac":s.push(o),m=!0}}var s=[],m=!1,_=!1,S=null,E=null,A=null,O=null,H=null;return(new Gf).box("moov",Lf).box("trak",Lf).O("tkhd",(function(o){o=Mh(o.reader,o.version),E=String(o.height),A=String(o.width)})).box("mdia",Lf).O("mdhd",(function(o){S=Kh(o.reader,o.version).language})).box("minf",Lf).box("stbl",Lf).O("stsd",Nf).box("mp4a",(function(o){var s=o.reader;s.skip(6),s.skip(2),s.skip(8);var m=s.Ia();s.skip(2),s.skip(2),s.skip(2),s=s.Ia()+s.Ia()/65536,O=m,H=s,o.reader.ja()?Lf(o):b(o)})).box("esds",(function(o){o=function Nh(o){var s="mp4a";return o.skip(11),s+="."+this.g(o.qa()),{Pa:s+="."+this.g(o.qa()>>>2&63).replace(/^0/,"")}}(o.reader),s.push(o.Pa),m=!0})).box("ac-3",b).box("ec-3",b).box("opus",b).box("Opus",b).box("fLaC",b).box("avc1",(function(o){o=Oh(o.reader,o.name),s.push(o.Pa),_=!0})).box("avc3",(function(o){o=Oh(o.reader,o.name),s.push(o.Pa),_=!0})).box("hev1",b).box("hvc1",b).box("dvh1",b).box("dvhe",b).box("vp09",b).box("av01",b).box("enca",Of).box("encv",Of).box("sinf",Lf).box("frma",(function(o){c(o=Ph(o.reader).Pa)})).parse(o.data,!0),s.length?(o=m&&!_,{type:o?"audio":"video",mimeType:o?"audio/mp4":"video/mp4",codecs:As(s).join(", "),language:S,height:E,width:A,channelCount:O,sampleRate:H}):null}(ae)))return Se.return(_e);return Se.return(A)}))}(o,_),5);for(O=xr(_.g,"EXT-X-MEDIA"),H=xr(_.g,"EXT-X-STREAM-INF"),K=xr(_.g,"EXT-X-IMAGE-STREAM-INF"),z=xr(_.g,"EXT-X-SESSION-KEY"),_t=(gt=t(H)).next();!_t.done;_t=gt.next()){var kt=_t.value;bt=Y(kt,"AUDIO"),_t=Y(kt,"VIDEO");var It=Y(kt,"SUBTITLES");if(kt=ns(o,kt),It){var At=xc(qt,kt);o.u.set(It,At),vb(kt,At)}bt&&((It=xc("audio",kt))||(It=o.g.hls.defaultAudioCodec),o.u.set(bt,It)),_t&&((bt=xc("video",kt))||(bt=o.g.hls.defaultVideoCodec),o.u.set(_t,bt))}for(G=xr(_.g,"EXT-X-SESSION-DATA"),q=t(G),X=q.next();!X.done;X=q.next())J=X.value,ae=Y(J,"DATA-ID"),pe=Y(J,"URI"),me=Y(J,"LANGUAGE"),_e=Y(J,"VALUE"),Se=(new Map).set("id",ae),pe&&Se.set("uri",Cr(o.N,pe)),me&&Se.set("language",me),_e&&Se.set("value",_e),Ee=new P("sessiondata",Se),o.i&&o.i.onEvent(Ee);for(function os(o,s){s=s.filter((function(o){var s=Y(o,"URI")||"";return"SUBTITLES"!=Y(o,"TYPE")&&""!=s}));for(var m=(s=t(s)).next();!m.done;m=s.next())Ds(o,m.value)}(o,O),_t=(gt=t(gt=yr(O,"CLOSED-CAPTIONS"))).next();!_t.done;_t=gt.next())bt=Uc((bt=Y(_t=_t.value,"LANGUAGE"))||"und"),It=zr(_t,"GROUP-ID"),_t=zr(_t,"INSTREAM-ID"),o.M.get(It)||o.M.set(It,new Map),o.M.get(It).set(_t,bt);return S=function ps(o,s,m){var _=[],S=new Set;if(0<m.length)for(var E=(m=t(m)).next();!E.done;E=m.next()){var A=zr(E=E.value,"METHOD");if("NONE"!=A&&"AES-128"!=A&&(A=Y(E,"KEYFORMAT")||"identity",E=(A=kh[A])?A(E,""):null)){if(E.keyIds)for(var O=(A=t(E.keyIds)).next();!O.done;O=A.next())S.add(O.value);_.push(E)}}return s=s.map((function(s){var m=Y(s,"FRAME-RATE"),E=Number(Y(s,"AVERAGE-BANDWIDTH"))||Number(zr(s,"BANDWIDTH")),A=Y(s,"RESOLUTION"),O=(A=t(A?A.split("x"):[null,null])).next().value,H=A.next().value,K=Y(s,"VIDEO-RANGE");s=function Is(o,s){var m=ns(o,s),_=Y(s,"AUDIO"),S=Y(s,"VIDEO"),E=_||S;E=E&&o.A.has(E)?o.A.get(E):[],_={audio:_?E:[],video:S?E:[]},S=!1;var A=zr(s,"URI"),O=_.audio.find((function(o){return o&&o.Zc==A})),H=xc("video",m),K=xc("audio",m);return K&&!H?E="audio":!E.length&&K&&H?(E="video",m=[[H,K].join()]):_.audio.length&&O?(E="audio",S=!0):E=_.video.length&&!_.audio.length?"audio":"video",S||(o=function Js(o,s,m,_){var S=Ks(zr(s,"URI"),o.s);return o.h.has(S)?o.h.get(S):(s=Y(s,"CLOSED-CAPTIONS"),s="video"==_&&s&&"NONE"!=s?o.M.get(s):null,m=wc(_,m),_=Ls(o,S,m,_,null,!1,null,null,s,null,!1,null,!1),o.h.has(S)?o.h.get(S):(o.h.set(S,_),_))}(o,s,m,E),_[o.stream.type]=[o]),_}(o,s),A=s.audio;for(var z=t(s=s.video),G=z.next();!G.done;G=z.next())ts(G.value.stream,O,H,m,K);for(m=o.g.disableAudio,A.length&&!m||(A=[null]),m=o.g.disableVideo,s.length&&!m||(s=[null]),m=[],O=(A=t(A)).next();!O.done;O=A.next())for(O=O.value,K=(H=t(s)).next();!K.done;K=H.next()){var q=K.value;(K=O?O.stream:null)&&(K.drmInfos=_,K.keyIds=S),(z=q?q.stream:null)&&(z.drmInfos=_,z.keyIds=S),G=O?O.stream.drmInfos:null;var X=q?q.stream.drmInfos:null;q=(q?q.Zc:"")+" - "+(O?O.Zc:""),K&&z&&!fh(G,X)||o.ga.has(q)||(K={id:o.Na++,language:K?K.language:"und",disabledUntilTime:0,primary:!!K&&K.primary||!!z&&z.primary,audio:K,video:z,bandwidth:E,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},m.push(K),o.ga.add(q))}return m})).reduce(rc,[]),s=s.filter((function(o){return null!=o}))}(o,H,z),E=function qs(o,s){var m=yr(s,"SUBTITLES");s=m.map((function(s){if(o.g.disableText)return null;try{return Ds(o,s).stream}catch(s){if(o.g.hls.ignoreTextStreamFailures)return null;throw s}}));for(var _=(m=t(m)).next();!_.done;_=m.next()){var S=zr(_.value,"GROUP-ID");if((_=o.u.get(S))&&(S=o.A.get(S)))for(var E=(S=t(S)).next();!E.done;E=S.next())(E=E.value).stream.codecs=_,E.stream.mimeType=Es(qt,_)||Fs(qt)}return s.filter((function(o){return o}))}(o,O),C(pt,function rs(o,s){var m,_;return I((function(S){return 1==S.g?(m=s.map((function(s){var m,_;return I((function(S){if(1==S.g)return o.g.disableThumbnails?S.return(null):(wa(S,2),C(S,function Gs(o,s){var m,_,S,E,A,O,H,K,z,G;return I((function(q){return 1==q.g?(m=Ks(zr(s,"URI"),o.s),_=Y(s,"CODECS","jpeg")||"",o.h.has(m)?q.return(o.h.get(m)):(S=Y(s,"LANGUAGE"),E=Y(s,"NAME"),A=Y(s,"CHARACTERISTICS"),O=Ls(o,m,_,"image",S,!1,E,null,null,A,!1,null,!1),o.h.has(m)?q.return(o.h.get(m)):(H=Y(s,"RESOLUTION"))?C(q,O.stream.createSegmentIndex(),3):q.B(2))):(2!=q.g&&(K=O.stream.segmentIndex.get(0),z=K.tilesLayout)&&(O.stream.width=Number(H.split("x")[0])*Number(z.split("x")[0]),O.stream.height=Number(H.split("x")[1])*Number(z.split("x")[1])),(G=Y(s,"BANDWIDTH"))&&(O.stream.bandwidth=Number(G)),o.h.set(m,O),q.return(O))}))}(o,s),4));if(2!=S.g)return m=S.h,S.return(m.stream);if(_=Ba(S),o.g.hls.ignoreImageStreamFailures)return S.return(null);throw _}))})),C(S,Promise.all(m),2)):(_=S.h,S.return(_.filter((function(o){return o}))))}))}(o,K),4);case 4:A=pt.h,pt.B(3);break;case 5:return De=pt.h,$e=De.type,He=De.mimeType,et=De.codecs,rt=De.language,it=De.height,at=De.width,ot=De.channelCount,st=De.sampleRate,ut=new Map,C(pt,ss(o,_,m,m,et,$e,rt,!0,"Media Playlist",ot,ut,null,!1,st,!1,He),6);case 6:ct=pt.h,o.h.set(m,ct),"video"==$e&&ts(ct.stream,at,it,null,null),S.push({id:0,language:Uc(rt||"und"),disabledUntilTime:0,primary:!0,audio:"audio"==$e?ct.stream:null,video:"video"==$e?ct.stream:null,bandwidth:ct.stream.bandwidth||0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});case 3:if(!o.i)throw new N(2,7,7001);o.j=new R(null,0),o.j.fc(!0),1==_.type&&(Yr(o)&&(us(o),dt=o.l,o.m.S(dt)),ht=Array.from(o.h.values()),vs(o,ht),cs(o)),o.F={presentationTimeline:o.j,variants:S,textStreams:E,imageStreams:A,offlineSessionIds:[],minBufferTime:0,sequenceMode:o.g.hls.sequenceMode,ignoreManifestTimestampsInSegmentsMode:o.g.hls.ignoreManifestTimestampsInSegmentsMode,type:"HLS",serviceDescription:null},o.i.makeTextStreamsForClosedCaptions(o.F),D(pt)}}))}(_,m.data,o),3)):S.return(_.F)}))},_.stop=function(){this.m&&(this.m.stop(),this.m=null);var o=[];return this.I&&(o.push(this.I.destroy()),this.I=null),this.g=this.i=null,this.ga.clear(),this.F=null,this.h.clear(),this.A.clear(),this.u.clear(),this.s.clear(),Promise.all(o)},_.update=function(){var o,s,m,_,S,E,A,O,H=this;return I((function(K){if(1==K.g){if(!Yr(H))return K.return();for(o=[],s=Array.from(H.h.values()),H.l=1/0,m=s.filter((function(o){return o.stream.segmentIndex})),_=t(m),S=_.next();!S.done;S=_.next())E=S.value,o.push(Zr(H,E));return C(K,Promise.all(o),2)}$r(H,m.map((function(o){return o.stream}))),A=m.some((function(o){return 0==o.Mc})),m.length&&!A&&(bs(H,mp.Qf),O=m.map((function(o){return o.ib})),H.j.Aa(Math.min.apply(Math,v(O))),H.i.updateDuration()),A&&cs(H),D(K)}))},_.onExpirationUpdated=function(){},L("shaka.hls.HlsParser",Tr);var _h={aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},bh={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",tsa:"video/mp2t"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t",tsv:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",webvtt:"text/vtt",ttml:"application/ttml+xml"},image:{jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif"}},kh={"com.apple.streamingkeydelivery":function comAppleStreamingkeydelivery(s,m){if("video/mp2t"==m)throw new N(2,4,4040);if(o.shakaMediaKeysPolyfill)throw new N(2,4,4041);return vc("com.apple.fps",[{initDataType:"sinf",initData:new Uint8Array(0),keyId:null}])},"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function urnUuidEdef8ba979d64aceA3c827dcd51d21ed(o){var s=zr(o,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(s)?(s=vc("com.widevine.alpha",[{initDataType:"cenc",initData:s=M((s=Sr(s=zr(o,"URI"))).data)}]),(o=Y(o,"KEYID"))&&(s.keyIds=new Set([o.toLowerCase().substr(2)])),s):null},"com.microsoft.playready":function comMicrosoftPlayready(o){var s=zr(o,"METHOD");return["SAMPLE-AES","SAMPLE-AES-CTR"].includes(s)?vc("com.microsoft.playready",[{initDataType:"cenc",initData:o=Yf(o=M((o=Sr(o=zr(o,"URI"))).data),s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),new Set,0)}]):null},identity:function identity(o){return o=zr(o,"METHOD"),["SAMPLE-AES","SAMPLE-AES-CTR"].includes(o)?vc("org.w3.clearkey",null):null}},qh="VOD",np="EVENT",ap="LIVE",mp={Qf:qh,zh:np,Eh:ap};function Ws(o){if(o=Xs(o))e:{for(var s=(o=t(o.getElementsByTagName("DATA"))).next();!s.done;s=o.next())if(s=Zf(s.value,"LA_URL")){o=s.textContent;break e}o=""}else o="";return o}function Xs(o){return o=function Vs(o){var s=0,m=pb(o),_=m.getUint32(s,!0);if(_!=o.byteLength)return[];e:{for(o=s+6,s=[];o<m.byteLength-1;){_=m.getUint16(o,!0),o+=2;var S=m.getUint16(o,!0);if(o+=2,0!=(1&S)||S+o>m.byteLength){m=[];break e}var E=M(m,o,S);s.push({type:_,value:E}),o+=S}m=s}return m}(o=Tf(o.textContent)).filter((function(o){return o.type===yp}))[0],o&&(o=rg(o=yf(o.value,!0),"WRMHEADER"))?o:null}aa.m3u8=function(){return new Tr},na["application/x-mpegurl"]=function(){return new Tr},na["application/vnd.apple.mpegurl"]=function(){return new Tr};var yp=1,vp=(new Map).set("com.microsoft.playready",Ws).set("com.microsoft.playready.recommendation",Ws).set("com.microsoft.playready.software",Ws).set("com.microsoft.playready.hardware",Ws);function $s(o){if(!_p){_p=!0;var s=new Uint8Array([105,115,111,109]),m=new Uint8Array([97,118,99,49]),_=new Uint8Array([0,0,0,1]);If=Z("ftyp",s,_,s,m),s=Z("dref",zf),Jf=Z("dinf",s)}this.g=o}function jt(o){var s=Z,m=new Uint8Array([]);switch(o.type){case"video":if(o.stream.codecs.includes("avc1.")||o.stream.codecs.includes("avc3.")){m=o.stream.width||0;var _=o.stream.height||0;if(0<o.na.byteLength)var S=Z("avcC",o.na);else{S=Z;for(var E=7,A=[],O=[],H=0,K=0,z=0,G=0;G<o.Ka.length;G++){var q=lt(o.Ka[G]);switch(31&q[0]){case 7:A.push(q),E+=q.length+2;break;case 8:O.push(q),E+=q.length+2}}for(0<A.length&&(H=A[0][1],z=A[0][2],K=A[0][3]),G=0,(E=new Uint8Array(E))[G++]=1,E[G++]=H,E[G++]=z,E[G++]=K,E[G++]=255,E[G++]=224|A.length,H=0;H<A.length;H++)E[G++]=(65280&A[H].length)>>8,E[G++]=255&A[H].length,E.set(A[H],G),G+=A[H].length;for(E[G++]=O.length,A=0;A<O.length;A++)E[G++]=(65280&O[A].length)>>8,E[G++]=255&O[A].length,E.set(O[A],G),G+=O[A].length;S=S("avcC",E)}m=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(v(ft(m,2)),v(ft(_,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),_="avc1",O=new Uint8Array([]),o.encrypted&&(O=mt(o),_="encv"),m=Z(_,m,S,O)}else(o.stream.codecs.includes("hev1.")||o.stream.codecs.includes("hvc1."))&&(_=o.stream.width||0,S=o.stream.height||0,m=new Uint8Array([]),0<o.na.byteLength&&(m=Z("hvcC",o.na)),_=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].concat(v(ft(_,2)),v(ft(S,2)),[0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17])),S="hvc1",O=new Uint8Array([]),o.encrypted&&(O=mt(o),S="encv"),m=Z(S,_,m,O));break;case"audio":"audio/mpeg"===o.stream.mimeType||o.stream.codecs.includes("mp3")||o.stream.codecs.includes("mp4a.40.34")?o=Z(".mp3",nt(o)):"audio/ac3"===o.stream.mimeType||o.stream.codecs.includes("ac-3")?(m=Z("dac3",o.ca),_="ac-3",S=new Uint8Array([]),o.encrypted&&(S=mt(o),_="enca"),o=Z(_,nt(o),m,S)):"audio/ec3"===o.stream.mimeType||o.stream.codecs.includes("ec-3")?(m=Z("dec3",o.ca),_="ec-3",S=new Uint8Array([]),o.encrypted&&(S=mt(o),_="enca"),o=Z(_,nt(o),m,S)):(0<o.ca.byteLength?m=Z("esds",o.ca):(m=Z,_=o.id+1,S=o.stream.bandwidth||0,O=o.stream.channelsCount||2,H=o.stream.audioSamplingRate||44100,K=wc("audio",o.stream.codecs.split(",")),A=(z={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12})[H],"mp4a.40.5"!==K&&"mp4a.40.29"!==K||(A=z[2*H]),H=parseInt(K.split(".").pop(),10),m=m("esds",_=new Uint8Array([0,0,0,0,3,25].concat(v(ft(_,2)),[0,4,17,64,21,0,6,0],v(ft(S,4)),v(ft(S,4)),[5,2,H<<3|A>>>1,A<<7|O<<3,6,1,2])))),_="mp4a",S=new Uint8Array([]),o.encrypted&&(S=mt(o),_="enca"),o=Z(_,nt(o),m,S)),m=o}return s("stbl",o=Z("stsd",Ef,m),Z("stts",Wp),Z("stsc",Jp),Z("stsz",hf),Z("stco",af))}function nt(o){return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,o.stream.channelsCount||2,0,16,0,0,0,0].concat(v(ft(o.stream.audioSamplingRate||44100,2)),[0,0]))}function mt(o){for(var s=Z,m=o.stream.codecs.substring(0,o.stream.codecs.indexOf(".")),_=0,S=0;S<m.length;S+=1)_|=m.charCodeAt(S)<<8*(m.length-S-1);m=Z("frma",m=new Uint8Array([].concat(v(ft(_,4))))),_=Z("schm",_=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0])),S=Z;for(var E=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),A=(o=t(o.stream.drmInfos)).next();!A.done;A=o.next())if((A=A.value)&&A.keyIds&&A.keyIds.size)for(var O=(A=t(A.keyIds)).next();!O.done;O=A.next())E=lt(O.value);return s("sinf",m,_,S("schi",E=Z("tenc",o=new Uint8Array([0,0,0,0,0,0,1,8]),E)))}function tt(o){for(var s=new Uint8Array([]),m=(o=t(o.g)).next();!m.done;m=o.next()){m=m.value;var _,S=Z,E=new Uint8Array([0,0,0,0].concat(v(ft(m.data?m.data.mb:0,4))));E=Z("mfhd",E);var A=m.data?m.data.Ja:[],O=new Uint8Array(4+A.length);for(_=0;_<A.length;_++){var H=A[_].flags;O[_+4]=H.Ra<<4|H.Va<<2|H.Ua}var K=(A=Z("sdtp",O)).length+92;O=Z,_=Z("tfhd",_=new Uint8Array([0,0,0,58].concat(v(ft(m.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]))),H=m.data?m.data.baseMediaDecodeTime:0;var z=Math.floor(H%(bp+1));H=Z("tfdt",H=new Uint8Array([1,0,0,0].concat(v(ft(Math.floor(H/(bp+1)),4)),v(ft(z,4)))));var G=K,q=12+16*(z=(K=m.data?m.data.Ja:[]).length),X=new Uint8Array(q);for(G+=8+q,X.set(["video"===m.type?1:0,0,15,1].concat(v(ft(z,4)),v(ft(G,4))),0),G=0;G<z;G++){var J=K[G];q=ft(J.duration,4);var ae=ft(J.size,4),pe=J.flags;J=ft(J.ab,4),X.set([].concat(v(q),v(ae),[pe.gb<<2|pe.Ra,pe.Va<<6|pe.Ua<<4|pe.hb,61440&pe.Qa,15&pe.Qa],v(J)),12+16*G)}for(S=S("moof",E,A=O("traf",_,H,K=Z("trun",X),A)),E=m.data?m.data.Ja:[],m=new Uint8Array([]),A=(E=t(E)).next();!A.done;A=E.next())m=Wf(m,A.value.data);s=Wf(s,S,m=Z("mdat",m))}return s}function ft(o,s){var m=[];for(--s;0<=s;s--)m.push(o>>8*s&255);return m}function lt(o){for(var s=new Uint8Array(o.length/2),m=0;m<o.length/2;m+=1)s[m]=parseInt(String(o[2*m]+o[2*m+1]),16);return s}function Z(o){var s=La.apply(1,arguments),m=wp[o];m||(m=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)],wp[o]=m);for(var _=8,S=s.length-1;0<=S;S--)_+=s[S].byteLength;for((S=new Uint8Array(_))[0]=_>>24&255,S[1]=_>>16&255,S[2]=_>>8&255,S[3]=255&_,S.set(m,4),m=0,_=8;m<s.length;m++)S.set(s[m],_),_+=s[m].byteLength;return S}$s.prototype.initSegment=function(){for(var o=new Uint8Array([]),s=t(this.g),m=s.next();!m.done;m=s.next()){var _=o;o=m.value,m=Z;var S=o.stream.width||0,E=o.stream.height||0,A=o.duration*o.timescale,O=Math.floor(A/(bp+1));A=Math.floor(A%(bp+1)),S=Z("tkhd",S=new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(v(ft(o.id+1,4)),[0,0,0,0],v(ft(O,4)),v(ft(A,4)),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0],v(ft(S,2)),[0,0],v(ft(E,2)),[0,0]))),E=Z,A=o.duration*o.timescale,O=Math.floor(A/(bp+1)),A=Math.floor(A%(bp+1));var H=o.stream.language;switch(H=H.charCodeAt(0)-96<<10|H.charCodeAt(1)-96<<5|H.charCodeAt(2)-96,O=Z("mdhd",O=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(v(ft(o.timescale,4)),v(ft(O,4)),v(ft(A,4)),v(ft(H,2)),[0,0]))),A=o,H=new Uint8Array([]),A.type){case"video":H=Ip;break;case"audio":H=zp}A=Z("hdlr",H);e:{switch(o.type){case"video":o=Z("minf",Z("vmhd",pf),Jf,jt(o));break e;case"audio":o=Z("minf",Z("smhd",_f),Jf,jt(o));break e}o=new Uint8Array([])}o=Wf(_,m=m("trak",S,o=E("mdia",O,A,o)))}if(s=Z,S=(m=this.g[0]).duration*m.timescale,_=Math.floor(S/(bp+1)),S=Math.floor(S%(bp+1)),_=Z("mvhd",_=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3].concat(v(ft(m.timescale,4)),v(ft(_,4)),v(ft(S,4)),[0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))),S=(S=Z)("mvex",E=Z("trex",E=new Uint8Array([0,0,0,0].concat(v(ft(m.id+1,4)),[0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1])))),E=new Uint8Array([]),m.encrypted)for(O=(m=t(m.stream.drmInfos)).next();!O.done;O=m.next())if((O=O.value).initData)for(A=(O=t(O.initData)).next();!A.done;A=O.next())E=Wf(E,A.value.initData);return s=s("moov",_,o,S,E),(_=new Uint8Array(If.byteLength+s.byteLength)).set(If),_.set(s,If.byteLength),_};var _p=!1,bp=Math.pow(2,32)-1,wp={},Ip=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),zp=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),Wp=new Uint8Array([0,0,0,0,0,0,0,0]),Jp=new Uint8Array([0,0,0,0,0,0,0,0]),af=new Uint8Array([0,0,0,0,0,0,0,0]),hf=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),pf=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),_f=new Uint8Array([0,0,0,0,0,0,0,0]),Ef=new Uint8Array([0,0,0,0,0,0,0,1]),If=new Uint8Array([]),zf=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Jf=new Uint8Array([]);function vt(){var o=this;this.h=this.g=null,this.l=[],this.j=null,this.s=1,this.i=null,this.A=new Ta(5),this.o=new dd((function(){!function wt(o){var s;I((function(m){switch(m.g){case 1:return wa(m,2),C(m,xt(o),4);case 4:Aa(m,3);break;case 2:s=Ba(m),o.h&&(s.severity=1,o.h.onError(s));case 3:if(!o.h)return m.return();D(m)}}))}(o)})),this.u=new We,this.m=new Map}function xt(o){var s,m,_,S,E,A,O;return I((function(H){if(1==H.g)return s=bf(o.l,o.g.retryParameters),m=o.h.networkingEngine,_=Date.now(),S=m.request(0,s,{type:5}),Xe(o.u,S),C(H,S.promise,2);if(E=H.h,!o.h)return H.return();E.uri&&!o.l.includes(E.uri)&&o.l.unshift(E.uri);var K=E.uri,z=tg(E.data,"SmoothStreamingMedia");if(!z)throw new N(2,4,4046,K);if((K=o.g.mss.manifestPreprocessor)&&K(z),o.i||(o.i=new R(null,0)),K=hg(z,"IsLive",pg,!1))throw new N(2,4,4047);o.i.fc(!K);var G=hg(z,"TimeScale",ng,1e7),q=hg(z,"DVRWindowLength",ng);K&&(0===q||isNaN(q))&&(q=1/0);var X,J=hg(z,"CanSeek",pg,!1);for(0===q&&J&&(q=1/0),J=null,q&&0<q&&(J=q/G),K&&!isNaN(o.g.availabilityWindowOverride)&&(J=o.g.availabilityWindowOverride),null==J&&(J=1/0),o.i.Md(J),q=hg(z,"Duration",ng,1/0),K||o.i.Aa(q/G),K={variants:[],textStreams:[],timescale:G,duration:q/G},J=$f(z,"Protection"),G=o.g.mss.keySystemsBySystemId,q=[],X=(J=t(J)).next();!X.done;X=J.next())q=q.concat($f(X.value,"ProtectionHeader"));if(q.length){for(J=[],X=0;X<q.length;X++){var ae=q[X],pe=ae.getAttribute("SystemID").toLowerCase(),me=G[pe];if(me){var _e=Xs(ae);if(_e)e:{for(var Se=(_e=t(_e.getElementsByTagName("DATA"))).next();!Se.done;Se=_e.next())if(Se=Zf(Se.value,"KID")){_e=Tf(Se.textContent),_e=Vf(_e=new Uint8Array([_e[3],_e[2],_e[1],_e[0],_e[5],_e[4],_e[7],_e[6]].concat(v(_e.slice(8)))));break e}_e=null}else _e=null;pe=vc(me,pe=[{initData:Yf(Se=Tf(ae.textContent),pe=Uf(pe.replace(/-/g,"")),new Set,0),initDataType:"cenc",keyId:_e}]),_e&&pe.keyIds.add(_e),(me=vp.get(me))&&(pe.licenseServerUri=me(ae)),J.push(pe)}}G=J}else G=[];for(X=G,J=[],G=[],q=[],ae=(z=t(z=$f(z,"StreamIndex"))).next();!ae.done;ae=z.next()){me=$f(ae=ae.value,"QualityLevel"),pe=K.timescale,_e=K.duration,Se=$f(ae,"c");for(var Ee=[],De=0,$e=0;$e<Se.length;++$e){var He=Se[$e],et=Se[$e+1],rt=hg(He,"t",ng),it=hg(He,"d",ng);if(He=hg(He,"r",lg),!it)break;if(rt=null!=rt?rt:De,0>(He=He||0))if(et){if(null==(et=hg(et,"t",ng)))break;if(rt>=et)break;He=Math.ceil((et-rt)/it)-1}else{if(1/0==_e)break;if(rt/pe>=_e)break;He=Math.ceil((_e*pe-rt)/it)-1}for(et=0;et<=He;++et)De=rt+it,Ee.push({start:rt/pe,end:De/pe,Ue:rt}),rt=De}for(pe=Ee,_e=(me=t(me)).next();!_e.done;_e=me.next())(_e=yt(o,ae,_e.value,pe,X,K))&&("audio"!=_e.type||o.g.disableAudio?"video"!=_e.type||o.g.disableVideo?_e.type!=qt||o.g.disableText||q.push(_e):G.push(_e):J.push(_e))}for(z=[],X=(J=t(0<J.length?J:[null])).next();!X.done;X=J.next())for(X=X.value,_e=(ae=t(0<G.length?G:[null])).next();!_e.done;_e=ae.next())pe=(me=z).push,_e=_e.value,Se=0,X&&X.bandwidth&&0<X.bandwidth&&(Se+=X.bandwidth),_e&&_e.bandwidth&&0<_e.bandwidth&&(Se+=_e.bandwidth),_e={id:o.s++,language:X?X.language:"und",disabledUntilTime:0,primary:!!X&&X.primary||!!_e&&_e.primary,audio:X,video:_e,bandwidth:Se,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]},pe.call(me,_e);K.variants=z,K.textStreams=q,o.j?(o.j.variants=K.variants,o.j.textStreams=K.textStreams,o.h.filter(o.j)):(o.j={presentationTimeline:o.i,variants:K.variants,textStreams:K.textStreams,imageStreams:[],offlineSessionIds:[],minBufferTime:0,sequenceMode:o.g.mss.sequenceMode,ignoreManifestTimestampsInSegmentsMode:!1,type:"MSS",serviceDescription:null},o.i.Cd()),Promise.resolve(),A=Date.now(),O=(A-_)/1e3,o.A.sample(1,O),D(H)}))}function yt(o,s,m,_,S,E){var A=s.getAttribute("Type");if("audio"!==A&&"video"!==A&&"text"!==A)return $a("Ignoring unrecognized type:",A),null;var O=s.getAttribute("Language"),H=o.s++,K=hg(m,"Bitrate",mg),z=hg(m,"MaxWidth",mg),G=hg(m,"MaxHeight",mg),q=hg(m,"Channels",mg),X=hg(m,"SamplingRate",mg),J=E.duration;_.length&&(J=_[_.length-1].end-_[0].start);var ae=o.i.getDuration();o.i.Aa(Math.min(J,ae));var pe={id:H,originalId:s.getAttribute("Name")||String(H),createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},closeSegmentIndex:function closeSegmentIndex(){return Promise.resolve()},segmentIndex:null,mimeType:"",codecs:"",frameRate:void 0,pixelAspectRatio:void 0,bandwidth:K||0,width:z||void 0,height:G||void 0,kind:"",encrypted:0<S.length,drmInfos:S,keyIds:new Set,language:Uc(O||"und"),originalLanguage:O,label:"",type:"",primary:!1,trickModeVideo:null,emsgSchemeIdUris:[],roles:[],forced:!1,channelsCount:q,audioSamplingRate:X,spatialAudio:!1,closedCaptions:null,hdr:void 0,tilesLayout:void 0,matchedStreams:[],mssPrivateData:{duration:J,timescale:E.timescale,codecPrivateData:null},accessibilityPurpose:null,external:!1};if((S=s.getAttribute("Subtype"))&&((S=_g[S])&&pe.roles.push(S),"main"===S&&(pe.primary=!0)),null!==(S=m.getAttribute("FourCC"))&&""!==S||(S=s.getAttribute("FourCC")),!S)if("audio"===A)S="AAC";else if("video"===A)return $a('FourCC is not defined whereas it is required for a QualityLevel element for a StreamIndex of type "video"'),null;if(!sg.includes(S.toUpperCase()))return $a("Codec not supported:",S),null;switch(m=function Bt(o,s,m,_){if(o=o.getAttribute("CodecPrivateData"))return o;if("audio"!==s)return null;s=_.channelsCount||2,o=_.audioSamplingRate||44100;var S={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12};return _=S[o],"AACH"===m?(m=new Uint8Array(4),o=S[2*o],m[0]=40|_>>1,m[1]=_<<7|s<<3|o>>1,m[2]=o<<7|8,m[3]=0,s=new Uint16Array(2),s[0]=(m[0]<<8)+m[1],s[1]=(m[2]<<8)+m[3],s[0].toString(16)+s[1].toString(16)):(m=new Uint8Array(2),m[0]=16|_>>1,m[1]=_<<7|s<<3,s=new Uint16Array(1),s[0]=(m[0]<<8)+m[1],s[0].toString(16))}(m,A,S,pe),pe.mssPrivateData.codecPrivateData=m,A){case"audio":if(!m)return $a("Quality unsupported without CodecPrivateData",A),null;pe.type="audio",pe.mimeType="mss/audio/mp4",pe.codecs=function Ct(o,s){var m=0;return"AACH"===o&&(m=5),s?0===m&&(m=(248&parseInt(s.substr(0,2),16))>>3):(m=2,"AACH"===o&&(m=5)),"mp4a.40."+m}(S,m);break;case"video":if(!m)return $a("Quality unsupported without CodecPrivateData",A),null;pe.type="video",pe.mimeType="mss/video/mp4",pe.codecs=function Dt(o){var s=/00000001[0-9]7/.exec(o);return s.length&&o?"avc1."+o.substr(o.indexOf(s[0])+10,6):""}(m);break;case"text":pe.type=qt,pe.mimeType="application/mp4",("TTML"===S||"DFXP"===S)&&(pe.codecs="stpp")}return pe.createSegmentIndex=function(){if(pe.segmentIndex)return Promise.resolve();if(o.m.has(pe.id))var m=o.m.get(pe.id);else m=[],"video"==pe.type&&(m=pe.mssPrivateData.codecPrivateData.split("00000001").slice(1)),m=new $s([m={id:pe.id,type:pe.type,encrypted:pe.encrypted,timescale:pe.mssPrivateData.timescale,duration:pe.mssPrivateData.duration,Ka:m,ca:new Uint8Array([]),na:new Uint8Array([]),data:null,stream:pe}]).initSegment(),o.m.set(pe.id,m);return m=function Et(o,s,m,_,S){var E=_.getAttribute("Url").replace("{bitrate}",String(m.bandwidth));_=[];for(var A={},O=(S=t(S)).next();!O.done;A={uc:A.uc},O=S.next())A.uc=O.value,_.push(new Q(A.uc.start,A.uc.end,function(s){return function(){return uc(o.l,[E.replace("{start time}",String(s.uc.Ue))])}}(A),0,null,s,0,0,m.mssPrivateData.duration));return _}(o,new sh((function(){return[]}),0,null,null,void 0,m),pe,s,_),pe.segmentIndex=new hj(m),Promise.resolve()},pe.closeSegmentIndex=function(){pe.segmentIndex&&(pe.segmentIndex.release(),pe.segmentIndex=null)},pe}(_=vt.prototype).configure=function(o){this.g=o},_.start=function(o,s){var m=this;return I((function(_){if(1==_.g)return m.l=[o],m.h=s,C(_,xt(m),2);if(!m.h)throw new N(2,7,7001);return _.return(m.j)}))},_.stop=function(){return this.g=this.h=null,this.l=[],this.j=null,null!=this.o&&(this.o.stop(),this.o=null),this.m.clear(),this.u.destroy()},_.update=function(){var o,s=this;return I((function(m){return 1==m.g?(wa(m,2),C(m,xt(s),4)):2!=m.g?Aa(m,0):(o=Ba(m),s.h&&o?(s.h.onError(o),void D(m)):m.return())}))},_.onExpirationUpdated=function(){},L("shaka.mss.MssParser",vt);var sg="AAC AACL AACH AACP AVC1 H264 TTML DFXP".split(" "),_g={CAPT:"main",SUBT:"alternate",DESC:"main"};function Ft(o,s,m,_,S,E){if(200<=m&&299>=m&&202!=m)return{uri:S||_,originalUri:_,data:s,status:m,headers:o,fromCache:!!o["x-shaka-from-cache"]};S=null;try{S=Af(s)}catch(o){}throw new N(401==m||403==m?2:1,1,1001,_,m,S,o,E)}function Gt(){}function Ht(o,s,m,_,S){var E=new Sm;tf(s.headers).forEach((function(o,s){E.append(s,o)}));var A=new lm,O={$e:!1,Lf:!1};if(o=function Kt(o,s,m,_,S,E,A){var O,H,K,z,G,q,X,J,ae,pe,me,_e,Se;return I((function(Ee){switch(Ee.g){case 1:return O=$g,H=_m,q=G=0,X=Date.now(),wa(Ee,2),C(Ee,O(o,m),4);case 4:if(K=Ee.h,E(Nt(K.headers)),"HEAD"==m.method){Ee.B(5);break}return J=K.clone().body.getReader(),pe=(ae=K.headers.get("Content-Length"))?parseInt(ae,10):0,me=function x(o){function F(){var s,m;return I((function(_){switch(_.g){case 1:return wa(_,2),C(_,J.read(),4);case 4:s=_.h,Aa(_,3);break;case 2:return Ba(_),_.return();case 3:if(s.done){_.B(5);break}if(G+=s.value.byteLength,!A){_.B(5);break}return C(_,A(s.value),5);case 5:(100<(m=Date.now())-X||s.done)&&(S(m-X,G-q,pe-G),q=G,X=m),s.done?o.close():(o.enqueue(s.value),F()),D(_)}}))}F()},new H({start:me}),C(Ee,K.arrayBuffer(),6);case 6:z=Ee.h;case 5:Aa(Ee,3);break;case 2:if(_e=Ba(Ee),_.$e)throw new N(1,1,7001,o,s);if(_.Lf)throw new N(1,1,1003,o,s);throw new N(1,1,1002,o,_e,s);case 3:return Se=Nt(K.headers),Ee.return(Ft(Se,z,K.status,o,K.url,s))}}))}(o,m,{body:s.body||void 0,headers:E,method:s.method,signal:A.signal,credentials:s.allowCrossSiteCredentials?"include":void 0},O,_,S,s.streamDataCallback),o=new Ke(o,(function(){return O.$e=!0,A.abort(),Promise.resolve()})),s=s.retryParameters.timeout){var H=new dd((function(){O.Lf=!0,A.abort()}));H.S(s/1e3),o.finally((function(){H.stop()}))}return o}function Nt(o){var s={};return o.forEach((function(o,m){s[m.trim()]=o})),s}function Ot(){if(!o.ReadableStream)return!1;try{new ReadableStream({})}catch(o){return!1}return!!o.Response&&(!!new Response("").body&&!(!o.fetch||!o.AbortController))}aa.ism=function(){return new vt},na["application/vnd.ms-sstr+xml"]=function(){return new vt},L("shaka.net.HttpFetchPlugin",Gt),Gt.isSupported=Ot,Gt.parse=Ht;var $g=o.fetch,lm=o.AbortController,_m=o.ReadableStream,Sm=o.Headers;function Pt(){}function Qt(o,s,m,_,S){var E=new zm,A=Date.now(),O=0,H=new Promise((function(H,K){E.open(s.method,o,!0),E.responseType="arraybuffer",E.timeout=s.retryParameters.timeout,E.withCredentials=s.allowCrossSiteCredentials,E.onabort=function(){K(new N(1,1,7001,o,m))};var z=!1;for(var G in E.onreadystatechange=function(){if(2==E.readyState&&!z){var o=St(E);S(o),z=!0}},E.onload=function(){var s=St(E),_=E.response;try{var S=Ft(s,_,E.status,o,E.responseURL,m);H(S)}catch(o){K(o)}},E.onerror=function(s){K(new N(1,1,1002,o,s,m))},E.ontimeout=function(){K(new N(1,1,1003,o,m))},E.onprogress=function(o){var s=Date.now();(100<s-A||o.lengthComputable&&o.loaded==o.total)&&(_(s-A,o.loaded-O,o.total-o.loaded),O=o.loaded,A=s)},s.headers)E.setRequestHeader(G.toLowerCase(),s.headers[G]);E.send(s.body)}));return new Ke(H,(function(){return E.abort(),Promise.resolve()}))}function St(o){var s=o.getAllResponseHeaders().trim().split("\r\n");o={};for(var m=(s=t(s)).next();!m.done;m=s.next())o[(m=m.value.split(": "))[0].toLowerCase()]=m.slice(1).join(": ");return o}Ot()&&(Ze("http",Ht,2,!0),Ze("https",Ht,2,!0),Ze("blob",Ht,2,!0)),L("shaka.net.HttpXHRPlugin",Pt),Pt.parse=Qt;var zm=o.XMLHttpRequest;function Tt(o,s,m,_){this.g=o,this.i=s,this.groupId=m,this.h=_}function Ut(o){return o.wa().map((function(o){return"{"+encodeURI(o)+"}"})).join("")+":"+o.Ba+":"+o.ka}function Vt(o,s){return Hj(o.g.wa(),o.g.Ba,o.g.ka,s.streaming.retryParameters)}function Wt(){this.h=this.j=this.i=0,this.g=new Map,this.l=0}function Xt(o,s){o.i+=s;var m=o.l;return o.l++,o.g.set(m,s),m}function Yt(o){var s=this;this.o=o,this.j=new Map,this.i=new jf((function(){return Zt(s).catch((function(){}))})),this.h=[],this.m=function(){},this.l=function(){},this.g=new Wt}function Zt(o){var s=o.h.map((function(o){return o()}));return o.h=[],Promise.all(s)}function au(o,s,m,_,S,E){kf(o.i);var A=(o.j.get(s)||Promise.resolve()).then((function(){var s,A,O,H,K,z,G;return I((function(q){if(1==q.g)return C(q,function bu(o,s){var m,_,S,E;return I((function(A){return 1==A.g?(m=_r,_=o.o.request(m,s),S=function e(){return _.abort()},o.h.push(S),C(A,_.promise,2)):(E=A.h,vb(o.h,S),A.return(E.data))}))}(o,m),2);if(s=q.h,o.i.g)throw new N(2,9,7001);if(S)for(H in A=M(s),(O=new Xf(A)).data)K=Number(H),z=O.data[K],G=O.g[K],o.l(z,G);o.g.close(_,s.byteLength);var X=o.g;return o.m(0==X.i?0:X.j/X.i,o.g.h),q.return(E(s))}))}));o.j.set(s,A)}function du(o,s){var m=this;this.i=o,this.h=o.objectStore(s),this.g=new Je,o.onabort=function(o){o.preventDefault(),m.g.reject()},o.onerror=function(o){o.preventDefault(),m.g.reject()},o.oncomplete=function(){m.g.resolve()}}function eu(o,s){return new Promise((function(m,_){var S=o.h.openCursor();S.onerror=_,S.onsuccess=function(){var o;return I((function(_){if(1==_.g)return null==S.result?(m(),_.return()):(o=S.result,C(_,s(o.key,o.value,o),2));o.continue(),D(_)}))}}))}function fu(o){this.h=o,this.g=[]}function gu(o,s){return hu(o,s,"readwrite")}function hu(o,s,m){var _=new du(m=o.h.transaction([s],m),s);return o.g.push(_),_.promise().then((function(){vb(o.g,_)}),(function(){vb(o.g,_)})),_}function iu(o,s,m){this.h=new fu(o),this.i=s,this.g=m}function ju(o){return Promise.reject(new N(2,9,9011,"Cannot add new value to "+o))}function ku(o,s,m,_){s=(o=gu(o.h,s)).store();for(var S={},E=(m=t(m)).next();!E.done;S={cd:S.cd},E=m.next())S.cd=E.value,s.delete(S.cd).onsuccess=function(o){return function(){return _(o.cd)}}(S);return o.promise()}function lu(o,s,m){var _,S,E,A,O,H,K;return I((function(z){if(1==z.g){for(_=hu(o.h,s,"readonly"),S=_.store(),E={},A=[],O={},H=t(m),K=H.next();!K.done;O={sc:O.sc,pc:O.pc},K=H.next())O.pc=K.value,O.sc=S.get(O.pc),O.sc.onsuccess=function(o){return function(){null==o.sc.result&&A.push(o.pc),E[o.pc]=o.sc.result}}(O);return C(z,_.promise(),2)}if(A.length)throw new N(2,9,9012,"Could not find values for "+A);return z.return(m.map((function(o){return E[o]})))}))}function nu(o){this.g=new fu(o)}function ou(){this.g=new Map}function qu(o){var s=null;if(o.g.forEach((function(o,m){o.getCells().forEach((function(o,_){o.hasFixedKeySpace()||s||(s={path:{Fa:m,oa:_},oa:o})}))})),s)return s;throw new N(2,9,9013,"Could not find a cell that supports add-operations")}function su(o,s,m){if(!(o=o.g.get(s)))throw new N(2,9,9013,"Could not find mechanism with name "+s);if(!(s=o.getCells().get(m)))throw new N(2,9,9013,"Could not find cell with name "+m);return s}function wu(o,s){Xm.set(o,s)}Ze("http",Qt,1,!0),Ze("https",Qt,1,!0),Ze("blob",Qt,1,!0),Wt.prototype.close=function(o,s){if(this.g.has(o)){var m=this.g.get(o);this.g.delete(o),this.j+=m,this.h+=s}},Yt.prototype.destroy=function(){return this.i.destroy()},du.prototype.abort=function(){var o=this;return I((function(s){if(1==s.g){try{o.i.abort()}catch(o){}return wa(s,2),C(s,o.g,4)}if(2!=s.g)return Aa(s,0);Ba(s),D(s)}))},du.prototype.store=function(){return this.h},du.prototype.promise=function(){return this.g},fu.prototype.destroy=function(){return Promise.all(this.g.map((function(o){return o.abort()})))},(_=iu.prototype).destroy=function(){return this.h.destroy()},_.hasFixedKeySpace=function(){return!0},_.addSegments=function(){return ju(this.i)},_.removeSegments=function(o,s){return ku(this,this.i,o,s)},_.getSegments=function(o){var s,m=this;return I((function(_){return 1==_.g?C(_,lu(m,m.i,o),2):(s=_.h,_.return(s.map((function(o){return m.bf(o)}))))}))},_.addManifests=function(){return ju(this.g)},_.updateManifest=function(){return Promise.reject(new N(2,9,9016,"Cannot modify values in "+this.g))},_.updateManifestExpiration=function(o,s){var m=gu(this.h,this.g),_=m.store();return _.get(o).onsuccess=function(m){(m=m.target.result)&&(m.expiration=s,_.put(m,o))},m.promise()},_.removeManifests=function(o,s){return ku(this,this.g,o,s)},_.getManifests=function(o){var s,m=this;return I((function(_){return 1==_.g?C(_,lu(m,m.g,o),2):(s=_.h,_.return(Promise.all(s.map((function(o){return m.Cc(o)})))))}))},_.getAllManifests=function(){var o,s,m=this;return I((function(_){return 1==_.g?(o=hu(m.h,m.g,"readonly"),s=new Map,C(_,eu(o,(function(o,_){var S;return I((function(E){if(1==E.g)return C(E,m.Cc(_),2);S=E.h,s.set(o,S),D(E)}))})),2)):3!=_.g?C(_,o.promise(),3):_.return(s)}))},_.bf=function(o){return o},_.Cc=function(o){return Promise.resolve(o)},_.add=function(o,s){var m,_,S,E,A,O,H,K=this;return I((function(z){if(1==z.g){for(m=gu(K.h,o),_=m.store(),S=[],E={},A=t(s),O=A.next();!O.done;E={ed:E.ed},O=A.next())H=O.value,E.ed=_.add(H),E.ed.onsuccess=function(o){return function(){S.push(o.ed.result)}}(E);return C(z,m.promise(),2)}return z.return(S)}))},nu.prototype.destroy=function(){return this.g.destroy()},nu.prototype.getAll=function(){var o,s,m=this;return I((function(_){return 1==_.g?(o=hu(m.g,"session-ids","readonly"),s=[],C(_,eu(o,(function(o,m){s.push(m)})),2)):3!=_.g?C(_,o.promise(),3):_.return(s)}))},nu.prototype.add=function(o){for(var s=gu(this.g,"session-ids"),m=s.store(),_=(o=t(o)).next();!_.done;_=o.next())m.add(_.value);return s.promise()},nu.prototype.remove=function(o){var s,m=this;return I((function(_){return 1==_.g?C(_,eu(s=gu(m.g,"session-ids"),(function(s,m,_){o.includes(m.sessionId)&&_.delete()})),2):C(_,s.promise(),0)}))},ou.prototype.destroy=function(){for(var o=[],s=t(this.g.values()),m=s.next();!m.done;m=s.next())o.push(m.value.destroy());return this.g.clear(),Promise.all(o)},ou.prototype.init=function(){var o=this;Xm.forEach((function(s,m){(s=s())&&o.g.set(m,s)}));for(var s=[],m=t(this.g.values()),_=m.next();!_.done;_=m.next())s.push(_.value.init());return Promise.all(s)},L("shaka.offline.StorageMuxer",ou),ou.unregister=function(o){Xm.delete(o)},ou.register=wu,ou.prototype.destroy=ou.prototype.destroy;var Xm=new Map;function xu(){iu.apply(this,arguments)}function yu(o,s){!function zu(o){var s=o.streams.filter((function(o){return"audio"==o.contentType}));if(o=o.streams.filter((function(o){return"video"==o.contentType})),!s.every((function(o){return o.variantIds}))||!o.every((function(o){return o.variantIds}))){for(var m=t(s),_=m.next();!_.done;_=m.next())_.value.variantIds=[];for(_=(m=t(o)).next();!_.done;_=m.next())_.value.variantIds=[];if(m=0,o.length&&!s.length){var S=m++,E=t(o);for(_=E.next();!_.done;_=E.next())_.value.variantIds.push(S)}if(!o.length&&s.length)for(S=m++,_=(E=t(s)).next();!_.done;_=E.next())_.value.variantIds.push(S);if(o.length&&s.length)for(_=(s=t(s)).next();!_.done;_=s.next())for(_=_.value,E=(S=t(o)).next();!E.done;E=S.next()){E=E.value;var A=m++;_.variantIds.push(A),E.variantIds.push(A)}}}(o);for(var m=t(o.streams),_=m.next();!_.done;_=m.next());return o.streams.map((function(m){return function Au(o,s,m){var _=o.initSegmentUri?Bu(o.initSegmentUri):null,S=s+o.presentationTimeOffset,E=s+m;return{id:o.id,originalId:null,primary:o.primary,type:o.contentType,mimeType:o.mimeType,codecs:o.codecs,frameRate:o.frameRate,pixelAspectRatio:void 0,hdr:void 0,kind:o.kind,language:o.language,originalLanguage:o.language||null,label:o.label,width:o.width,height:o.height,initSegmentKey:_,encrypted:o.encrypted,keyIds:new Set([o.keyId]),segments:o.segments.map((function(o){var m=Bu(o.uri);return{startTime:s+o.startTime,endTime:s+o.endTime,dataKey:m,initSegmentKey:_,appendWindowStart:s,appendWindowEnd:E,timestampOffset:S,tilesLayout:""}})),variantIds:o.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1}}(m,o.startTime,s)}))}function Bu(o){var s;if((s=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(o))||(s=/^offline:segment\/([0-9]+)$/.exec(o)))return Number(s[1]);throw new N(2,9,9004,"Could not parse uri "+o)}function Cu(){iu.apply(this,arguments)}function Du(o,s,m){return{id:o.id,originalId:o.originalId,primary:o.primary,type:o.contentType,mimeType:o.mimeType,codecs:o.codecs,frameRate:o.frameRate,pixelAspectRatio:o.pixelAspectRatio,hdr:void 0,kind:o.kind,language:o.language,originalLanguage:o.language||null,label:o.label,width:o.width,height:o.height,encrypted:o.encrypted,keyIds:new Set([o.keyId]),segments:o.segments.map((function(_){return{startTime:s+_.startTime,endTime:s+_.endTime,initSegmentKey:o.initSegmentKey,appendWindowStart:s,appendWindowEnd:m,timestampOffset:s-o.presentationTimeOffset,dataKey:_.dataKey,tilesLayout:""}})),variantIds:o.variantIds,roles:[],forced:!1,audioSamplingRate:null,channelsCount:null,spatialAudio:!1,closedCaptions:null,tilesLayout:void 0,external:!1}}function Eu(){iu.apply(this,arguments)}function Fu(){this.m=this.j=this.i=this.h=this.g=this.l=null}function Hu(o,s,m,_){this.g=o,this.i=s,this.h=m,this.l=_,this.j=["offline:",o,"/",s,"/",m,"/",_].join("")}function Iu(o){if(null==(o=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(o)))return null;var s=o[1];if("manifest"!=s&&"segment"!=s)return null;var m=o[2];if(!m)return null;var _=o[3];return _&&null!=s?new Hu(s,m,_,Number(o[4])):null}function Ju(o,s){this.h=o,this.g=s}function Ku(o,s){var m=new R(null,0);m.Aa(s.duration);var _=s.streams.filter((function(o){return"audio"==o.type})),S=s.streams.filter((function(o){return"video"==o.type}));_=function Lu(o,s,m,_){for(var S=new Set,E=t(s),A=E.next();!A.done;A=E.next()){var O=t(A.value.variantIds);for(A=O.next();!A.done;A=O.next())S.add(A.value)}for(E=t(m),A=E.next();!A.done;A=E.next())for(O=t(A.value.variantIds),A=O.next();!A.done;A=O.next())S.add(A.value);for(E=new Map,S=t(S),A=S.next();!A.done;A=S.next())A=A.value,E.set(A,{id:A,language:"",disabledUntilTime:0,primary:!1,audio:null,video:null,bandwidth:0,allowedByApplication:!0,allowedByKeySystem:!0,decodingInfos:[]});for(s=t(s),S=s.next();!S.done;S=s.next())for(S=S.value,A=Mu(o,S,_),O=t(S.variantIds),S=O.next();!S.done;S=O.next())(S=E.get(S.value)).language=A.language,S.primary=S.primary||A.primary,S.audio=A;for(m=t(m),s=m.next();!s.done;s=m.next())for(S=s.value,s=Mu(o,S,_),A=t(S.variantIds),S=A.next();!S.done;S=A.next())(S=E.get(S.value)).primary=S.primary||s.primary,S.video=s;return E}(o,_,S,m),S=s.streams.filter((function(o){return o.type==qt})).map((function(s){return Mu(o,s,m)}));var E=s.streams.filter((function(o){return"image"==o.type})).map((function(s){return Mu(o,s,m)})),A=s.drmInfo?[s.drmInfo]:[];if(s.drmInfo)for(var O=t(_.values()),H=O.next();!H.done;H=O.next())(H=H.value).audio&&H.audio.encrypted&&(H.audio.drmInfos=A),H.video&&H.video.encrypted&&(H.video.drmInfos=A);return{presentationTimeline:m,minBufferTime:2,offlineSessionIds:s.sessionIds,variants:Array.from(_.values()),textStreams:S,imageStreams:E,sequenceMode:s.sequenceMode||!1,ignoreManifestTimestampsInSegmentsMode:!1,type:s.type||"UNKNOWN",serviceDescription:null}}function Mu(o,s,m){var _=s.segments.map((function(s){return function Nu(o,s){var m=new Hu("segment",o.h,o.g,s.dataKey);return new Q(s.startTime,s.endTime,(function(){return[m.toString()]}),0,null,null!=s.initSegmentKey?function Ou(o,s){var m=new Hu("segment",o.h,o.g,s);return new sh((function(){return[m.toString()]}),0,null)}(o,s.initSegmentKey):null,s.timestampOffset,s.appendWindowStart,s.appendWindowEnd,[],s.tilesLayout||"")}(o,s)}));return m.Qc(_),{id:s.id,originalId:s.originalId,createSegmentIndex:function createSegmentIndex(){return Promise.resolve()},segmentIndex:new hj(_),mimeType:s.mimeType,codecs:s.codecs,width:s.width||void 0,height:s.height||void 0,frameRate:s.frameRate,pixelAspectRatio:s.pixelAspectRatio,hdr:s.hdr,kind:s.kind,encrypted:s.encrypted,drmInfos:[],keyIds:s.keyIds,language:s.language,originalLanguage:s.originalLanguage||null,label:s.label,type:s.type,primary:s.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:s.roles,forced:s.forced,channelsCount:s.channelsCount,audioSamplingRate:s.audioSamplingRate,spatialAudio:s.spatialAudio,closedCaptions:s.closedCaptions,tilesLayout:s.tilesLayout,accessibilityPurpose:null,external:s.external}}function Pu(){this.g=null}function Qu(){}function Ru(o){var s=Iu(o);return s&&"manifest"==s.g?o=Ne(o={uri:o,originalUri:o,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}}):o=s&&"segment"==s.g?function Su(o,s){var m=new ou;return Ne(void 0).fa((function(){return m.init()})).fa((function(){return su(m,s.Fa(),s.oa())})).fa((function(o){return o.getSegments([s.key()])})).fa((function(o){return{uri:s,data:o[0].data,headers:{}}})).finally((function(){return m.destroy()}))}(s.key(),s):Le(new N(2,1,9004,o)),o}function Tu(o,s,m){var _,S,E,A,O,H;return I((function(K){switch(K.g){case 1:_=[];for(var z=[],G=t(m),q=G.next();!q.done;q=G.next()){q=q.value;for(var X=!1,J=t(z),ae=J.next();!ae.done;ae=J.next())if(Uu((ae=ae.value).info,q)){ae.sessionIds.push(q.sessionId),X=!0;break}X||z.push({info:q,sessionIds:[q.sessionId]})}S=t(z),E=S.next();case 2:if(E.done){K.B(4);break}return A=E.value,O=function Vu(o,s,m){var _,S;return I((function(E){switch(E.g){case 1:return _=new ug({Hb:s,onError:function onError(){},Id:function Id(){},onExpirationUpdated:function onExpirationUpdated(){},onEvent:function onEvent(){}}),wa(E,2),_.configure(o),C(E,function Cg(o,s,m,_,S,E){var A=new Map;return(S={audioCapabilities:S,videoCapabilities:E,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:s}).drmInfos=[{keySystem:s,licenseServerUri:m,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:_,serverCertificateUri:"",initData:null,keyIds:null}],A.set(s,S),Dg(o,A,[])}(_,m.info.keySystem,m.info.licenseUri,m.info.serverCertificate,m.info.audioCapabilities,m.info.videoCapabilities),4);case 4:Aa(E,3);break;case 2:return Ba(E),C(E,_.destroy(),5);case 5:case 9:return E.return([]);case 3:return wa(E,6),C(E,Ng(_),8);case 8:Aa(E,7);break;case 6:return Ba(E),C(E,_.destroy(),9);case 7:return S=[],C(E,Promise.all(m.sessionIds.map((function(o){return I((function(s){return 1==s.g?(wa(s,2),C(s,function Og(o,s){var m,_,S;return I((function(E){return 1==E.g?C(E,Pg(o,s,{initData:null,initDataType:null}),2):3!=E.g?(m=E.h)?(_=[],(S=o.i.get(m))&&(S.Xa=new Je,_.push(S.Xa)),_.push(m.remove()),C(E,Promise.all(_),3)):E.return():(o.i.delete(m),void D(E))}))}(_,o),4)):2!=s.g?(S.push(o),Aa(s,0)):(Ba(s),void D(s))}))}))),10);case 10:return C(E,_.destroy(),11);case 11:return E.return(S)}}))}(o,s,A),C(K,O,5);case 5:H=K.h,_=_.concat(H),E=S.next(),K.B(2);break;case 4:return K.return(_)}}))}function Uu(o,s){function c(o,s){return o.robustness==s.robustness&&o.contentType==s.contentType}return o.keySystem==s.keySystem&&o.licenseUri==s.licenseUri&&wb(o.audioCapabilities,s.audioCapabilities,c)&&wb(o.videoCapabilities,s.videoCapabilities,c)}function Yu(o,s){var m=Ku(new Ju(o.Fa(),o.oa()),s),_=s.appMetadata||{};return m=Xu(m),{offlineUri:o.toString(),originalManifestUri:s.originalManifestUri,duration:s.duration,size:s.size,expiration:s.expiration,tracks:m,appMetadata:_,isIncomplete:s.isIncomplete||!1}}function Xu(o){for(var s=[],m=fe(o.variants),_=(m=t(m)).next();!_.done;_=m.next())s.push(Xd(_.value));for(m=(o=t(o.textStreams)).next();!m.done;m=o.next())s.push(Yd(m.value));return s}function Zu(){this.g={}}function $u(o,s){var m=s.audio,_=s.video;if(m&&!_&&(o.g[m.id]=m.bandwidth||s.bandwidth),!m&&_&&(o.g[_.id]=_.bandwidth||s.bandwidth),m&&_){var S=m.bandwidth||393216,E=_.bandwidth||s.bandwidth-S;0>=E&&(E=s.bandwidth),o.g[m.id]=S,o.g[_.id]=E}}function av(o,s){o.g[s.id]=s.bandwidth||2048}function bv(o,s){return null==(o=o.g[s])&&(o=0),o}function cv(o){var s=this;if(o&&o.constructor!=T)throw new N(2,9,9008);this.g=this.h=null,o?(this.h=o.g,this.g=o.zb()):(this.h=ll(),this.g=new Ye),this.i=[],this.j=[];var m=!o;this.l=new jf((function(){var o,_,S,E,A;return I((function(O){switch(O.g){case 1:return C(O,Promise.all(s.j.map((function(o){return Zt(o)}))),2);case 2:for(o=function d(){},_=[],S=t(s.i),E=S.next();!E.done;E=S.next())A=E.value,_.push(A.then(o,o));return C(O,Promise.all(_),3);case 3:if(!m){O.B(4);break}return C(O,s.g.destroy(),4);case 4:s.h=null,s.g=null,D(O)}}))}))}function dv(){if(ed())e:{for(var o=t(Xm.values()),s=o.next();!s.done;s=o.next())if(s=(s=s.value)()){s.destroy(),o=!0;break e}o=!1}else o=!1;return o}function nv(o){var s,m,_;return I((function(S){switch(S.g){case 1:return C(S,(s=new ou).init(),2);case 2:return C(S,qu(s),3);case 3:return m=S.h,_=new Hu("manifest",m.path.Fa,m.path.oa,o),C(S,s.destroy(),4);case 4:return C(S,(new cv).remove(_.toString()),0)}}))}function rv(o,s,m,_,S,E){var A,O,H,K,z,G,q,X,J,ae,pe;return I((function(me){switch(me.g){case 1:for(A=!1,wa(me,2),O=!0,H=t(m.streams),K=H.next();!K.done;K=H.next())for(z=K.value,G=t(z.segments),q=G.next();!q.done;q=G.next())X=q.value,null!=(J=X.pendingSegmentRefId?_[X.pendingSegmentRefId]:null)&&(X.dataKey=J,X.pendingSegmentRefId=void 0),null!=(J=X.pendingInitSegmentRefId?_[X.pendingInitSegmentRefId]:null)&&(X.initSegmentKey=J,X.pendingInitSegmentRefId=void 0),X.pendingSegmentRefId&&(O=!1),X.pendingInitSegmentRefId&&(O=!1);return m.size+=S,O&&(m.isIncomplete=!1),C(me,o.updateManifest(s,m),4);case 4:A=!0,E(),Aa(me,0);break;case 2:return ae=Ba(me),C(me,nv(s),5);case 5:if(A){me.B(6);break}return pe=Object.values(_),C(me,o.removeSegments(pe,(function(){})),6);case 6:throw ae}}))}function pv(o){return o.variants.some((function(o){var s=o.audio&&o.audio.encrypted;return o.video&&o.video.encrypted||s}))}function qv(o){return o.variants.some((function(o){return(o.video?o.video.drmInfos:[]).concat(o.audio?o.audio.drmInfos:[]).some((function(o){return o.initData&&o.initData.length}))}))}function zv(o,s){for(var m=[],_=t(o.streams),S=_.next();!S.done;S=_.next())S=S.value,s&&"video"==S.type?m.push({contentType:Cc(S.mimeType,S.codecs),robustness:o.drmInfo.videoRobustness}):s||"audio"!=S.type||m.push({contentType:Cc(S.mimeType,S.codecs),robustness:o.drmInfo.audioRobustness});return m}function xv(o,s,m){return I((function(_){return C(_,function Av(o,s,m,_){var S,E,A;return I((function(O){return 1==O.g?_.drmInfo?(S=function uu(o){var s=Array.from(o.g.keys());if(!s.length)throw new N(2,9,9e3,"No supported storage mechanisms found");return o.g.get(s[0]).getEmeSessionCell()}(m),E=_.sessionIds.map((function(o){return{sessionId:o,keySystem:_.drmInfo.keySystem,licenseUri:_.drmInfo.licenseServerUri,serverCertificate:_.drmInfo.serverCertificate,audioCapabilities:zv(_,!1),videoCapabilities:zv(_,!0)}})),C(O,Tu(s,o,E),2)):O.return():3!=O.g?(A=O.h,C(O,S.remove(A),3)):C(O,S.add(E.filter((function(o){return!A.includes(o.sessionId)}))),0)}))}(o.g,o.h.drm,m,s),0)}))}function yv(o,s,m){function d(){}var _=function Bv(o){for(var s=new Set,m=(o=t(o.streams)).next();!m.done;m=o.next())for(var _=(m=t(m.value.segments)).next();!_.done;_=m.next())null!=(_=_.value).initSegmentKey&&s.add(_.initSegmentKey),s.add(_.dataKey);return Array.from(s)}(m);return Yu(s,m),Promise.all([o.removeSegments(_,d),o.removeManifests([s.key()],d)])}function Fv(o,s,m,_,S,E){var A={id:_.id,originalId:_.originalId,primary:_.primary,type:_.type,mimeType:_.mimeType,codecs:_.codecs,frameRate:_.frameRate,pixelAspectRatio:_.pixelAspectRatio,hdr:_.hdr,kind:_.kind,language:_.language,originalLanguage:_.originalLanguage,label:_.label,width:_.width||null,height:_.height||null,encrypted:_.encrypted,keyIds:_.keyIds,segments:[],variantIds:[],roles:_.roles,forced:_.forced,channelsCount:_.channelsCount,audioSamplingRate:_.audioSamplingRate,spatialAudio:_.spatialAudio,closedCaptions:_.closedCaptions,tilesLayout:_.tilesLayout,external:_.external},O=S.offline.numberOfParallelDownloads,H=0;return function Gv(o,s,m){if(s=o.segmentIndex.find(s),null!=s)for(var _=o.segmentIndex.get(s);_;)m(_),_=o.segmentIndex.get(++s)}(_,m.presentationTimeline.fb(),(function(m){var S=Ut(m),K=void 0;if(!E.has(S)){var z=m.endTime-m.startTime;z=bv(s,_.id)*z,z=Xt(o.g,z),E.set(S,new Tt(m,z,H,!1))}m.h&&(K=Ut(m.h),E.has(K)||(z=.5*bv(s,_.id),z=Xt(o.g,z),E.set(K,new Tt(m.h,z,H,!0)))),A.segments.push({pendingInitSegmentRefId:K,initSegmentKey:K?0:null,startTime:m.startTime,endTime:m.endTime,appendWindowStart:m.appendWindowStart,appendWindowEnd:m.appendWindowEnd,timestampOffset:m.timestampOffset,tilesLayout:m.tilesLayout,pendingSegmentRefId:S,dataKey:0}),H=(H+1)%O})),A}function iv(o){if(o.l.g)throw new N(2,9,7001)}function gv(){if(!dv())throw new N(2,9,9e3)}function vv(o,s){return I((function(m){return 1==m.g?(o.i.push(s),ya(m),C(m,s,4)):2!=m.g?m.return(m.h):(Ca(m),vb(o.i,s),Ea(m,0))}))}function Ev(o){for(var s=new Set,m=t(o.textStreams),_=m.next();!_.done;_=m.next())s.add(_.value);for(_=(m=t(o.imageStreams)).next();!_.done;_=m.next())s.add(_.value);for(m=(o=t(o.variants)).next();!m.done;m=o.next())(m=m.value).audio&&s.add(m.audio),m.video&&s.add(m.video);return s}ra(xu,iu),xu.prototype.updateManifestExpiration=function(o,s){var m,_,S,E=this;return I((function(A){return m=gu(E.h,E.g),_=m.store(),S=new Je,_.get(o).onsuccess=function(m){(m=m.target.result)?(m.expiration=s,_.put(m),S.resolve()):S.reject(new N(2,9,9012,"Could not find values for "+o))},C(A,Promise.all([m.promise(),S]),0)}))},xu.prototype.Cc=function(o){var s,m,_,S,E,A;return I((function(O){if(1==O.g){for(s=[],m=0;m<o.periods.length;++m)_=m==o.periods.length-1?o.duration:o.periods[m+1].startTime,S=_-o.periods[m].startTime,E=yu(o.periods[m],S),s.push(E);return C(O,Gq(s),2)}return A=O.h,O.return({creationTime:0,originalManifestUri:o.originalManifestUri,duration:o.duration,size:o.size,expiration:null==o.expiration?1/0:o.expiration,streams:A,sessionIds:o.sessionIds,drmInfo:o.drmInfo,appMetadata:o.appMetadata,sequenceMode:!1})}))},xu.prototype.bf=function(o){return{data:o.data}},ra(Cu,iu),Cu.prototype.Cc=function(o){var s,m,_,S,E,A;return I((function(O){if(1==O.g){for(s=[],m=0;m<o.periods.length;++m){_=m==o.periods.length-1?o.duration:o.periods[m+1].startTime,S=_-o.periods[m].startTime;for(var H=o.periods[m],K=[],z=t(H.streams),G=z.next();!G.done;G=z.next())0!=(G=G.value).variantIds.length&&K.push(Du(G,H.startTime,H.startTime+S));E=K,s.push(E)}return C(O,Gq(s),2)}return A=O.h,O.return({appMetadata:o.appMetadata,creationTime:0,drmInfo:o.drmInfo,duration:o.duration,expiration:null==o.expiration?1/0:o.expiration,originalManifestUri:o.originalManifestUri,sessionIds:o.sessionIds,size:o.size,streams:A,sequenceMode:!1})}))},ra(Eu,iu),(_=Eu.prototype).hasFixedKeySpace=function(){return!1},_.addSegments=function(o){return this.add(this.i,o)},_.addManifests=function(o){return this.add(this.g,o)},_.updateManifest=function(o,s){return function mu(o,s,m){var _=(o=gu(o.h,o.g)).store();return _.get(s).onsuccess=function(){_.put(m,s)},o.promise()}(this,o,s)},_.Cc=function(o){return null==o.expiration&&(o.expiration=1/0),Promise.resolve(o)},(_=Fu.prototype).init=function(){var s=this,m=new Je,_=!1,S=new dd((function(){_=!0,m.reject(new N(2,9,9017))}));S.S(5);var E=o.indexedDB.open("shaka_offline_db",5);return E.onsuccess=function(){if(!_){var o=E.result;s.l=o;var A=o.objectStoreNames;A=A.contains("manifest")&&A.contains("segment")?new xu(o,"segment","manifest"):null,s.g=A,A=(A=o.objectStoreNames).contains("manifest-v2")&&A.contains("segment-v2")?new Cu(o,"segment-v2","manifest-v2"):null,s.h=A,A=(A=o.objectStoreNames).contains("manifest-v3")&&A.contains("segment-v3")?new Cu(o,"segment-v3","manifest-v3"):null,s.i=A,A=(A=o.objectStoreNames).contains("manifest-v5")&&A.contains("segment-v5")?new Eu(o,"segment-v5","manifest-v5"):null,s.j=A,o=o.objectStoreNames.contains("session-ids")?new nu(o):null,s.m=o,S.stop(),m.resolve()}},E.onupgradeneeded=function(){for(var o=E.result,s=t(["segment-v5","manifest-v5","session-ids"]),m=s.next();!m.done;m=s.next())m=m.value,o.objectStoreNames.contains(m)||o.createObjectStore(m,{autoIncrement:!0})},E.onerror=function(o){_||(m.reject(new N(2,9,9001,E.error)),S.stop(),o.preventDefault())},m},_.destroy=function(){var o=this;return I((function(s){switch(s.g){case 1:if(!o.g){s.B(2);break}return C(s,o.g.destroy(),2);case 2:if(!o.h){s.B(4);break}return C(s,o.h.destroy(),4);case 4:if(!o.i){s.B(6);break}return C(s,o.i.destroy(),6);case 6:if(!o.j){s.B(8);break}return C(s,o.j.destroy(),8);case 8:if(!o.m){s.B(10);break}return C(s,o.m.destroy(),10);case 10:o.l&&o.l.close(),D(s)}}))},_.getCells=function(){var o=new Map;return this.g&&o.set("v1",this.g),this.h&&o.set("v2",this.h),this.i&&o.set("v3",this.i),this.j&&o.set("v5",this.j),o},_.getEmeSessionCell=function(){return this.m},_.erase=function(){var s=this;return I((function(m){switch(m.g){case 1:if(!s.g){m.B(2);break}return C(m,s.g.destroy(),2);case 2:if(!s.h){m.B(4);break}return C(m,s.h.destroy(),4);case 4:if(!s.i){m.B(6);break}return C(m,s.i.destroy(),6);case 6:if(!s.j){m.B(8);break}return C(m,s.j.destroy(),8);case 8:return s.l&&s.l.close(),C(m,function Gu(){var s=new Je,m=o.indexedDB.deleteDatabase("shaka_offline_db");return m.onblocked=function(){},m.onsuccess=function(){s.resolve()},m.onerror=function(o){s.reject(new N(2,9,9001,m.error)),o.preventDefault()},s}(),10);case 10:return s.l=null,s.g=null,s.h=null,s.i=null,s.j=null,C(m,s.init(),0)}}))},wu("idb",(function(){return jd("CrKey")||id()||!o.indexedDB?null:new Fu})),Hu.prototype.Fa=function(){return this.i},Hu.prototype.oa=function(){return this.h},Hu.prototype.key=function(){return this.l},Hu.prototype.toString=function(){return this.j},(_=Pu.prototype).configure=function(){},_.start=function(o,s){var m,_,S,E,A,O,H=this;return I((function(K){switch(K.g){case 1:if(m=Iu(o),H.g=m,null==m||"manifest"!=m.g)throw new N(2,1,9004,o);return _=new ou,ya(K),C(K,_.init(),4);case 4:return C(K,su(_,m.Fa(),m.oa()),5);case 5:return C(K,K.h.getManifests([m.key()]),6);case 6:return S=K.h,E=S[0],A=new Ju(m.Fa(),m.oa()),O=Ku(A,E),s.makeTextStreamsForClosedCaptions(O),K.return(O);case 2:return Ca(K),C(K,_.destroy(),7);case 7:Ea(K,0)}}))},_.stop=function(){return Promise.resolve()},_.update=function(){},_.onExpirationUpdated=function(o,s){var m,_,S,E,A,O,H,K=this;return I((function(z){switch(z.g){case 1:return m=K.g,_=new ou,wa(z,2,3),C(z,_.init(),5);case 5:return C(z,su(_,m.Fa(),m.oa()),6);case 6:return C(z,(S=z.h).getManifests([m.key()]),7);case 7:if(E=z.h,A=E[0],O=A.sessionIds.includes(o),H=null==A.expiration||A.expiration>s,!O||!H){z.B(3);break}return C(z,S.updateManifestExpiration(m.key(),s),3);case 3:return Ca(z),C(z,_.destroy(),10);case 10:Ea(z,0);break;case 2:Ba(z),z.B(3)}}))},na["application/x-offline-manifest"]=function(){return new Pu},L("shaka.offline.OfflineScheme",Qu),Qu.plugin=Ru,Ze("offline",Ru),(_=cv.prototype).destroy=function(){return this.l.destroy()},_.configure=function(o,s){return 2==arguments.length&&"string"==typeof o&&(o=dl(o,s)),nl(this.h,o)},_.getConfiguration=function(){var o=ll();return nl(o,this.h,ll()),o},_.zb=function(){return this.g},_.store=function(o,s,m){var _=this,S=this.getConfiguration(),E=new Yt(this.g);return this.j.push(E),s=function ev(o,s,m,_,S,E){var A,O,H,K,z,G,q,X,J,ae,pe,me,_e;return I((function(Se){switch(Se.g){case 1:return gv(),O=A=null,H=new ou,G=z=K=null,wa(Se,2,3),C(Se,_(),5);case 5:return A=Se.h,C(Se,function hv(o,s,m,_){var S,E,A,O,H;return I((function(K){if(1==K.g)return S=null,E=o.g,A={networkingEngine:E,filter:function filter(){return Promise.resolve()},makeTextStreamsForClosedCaptions:function makeTextStreamsForClosedCaptions(){},onTimelineRegionAdded:function onTimelineRegionAdded(){},onEvent:function onEvent(){},onError:function onError(o){S=o},isLowLatencyMode:function isLowLatencyMode(){return!1},isAutoLowLatencyMode:function isAutoLowLatencyMode(){return!1},enableLowLatencyMode:function enableLowLatencyMode(){},updateDuration:function updateDuration(){},newDrmInfo:function newDrmInfo(){}},m.configure(_.manifest),iv(o),C(K,m.start(s,A),2);if(3!=K.g)return O=K.h,iv(o),H=Ev(O),C(K,Promise.all(qf(H,(function(o){return o.createSegmentIndex()}))),3);if(iv(o),S)throw S;return K.return(O)}))}(o,s,A,S),6);case 6:if(q=Se.h,iv(o),!(!q.presentationTimeline.T()&&!q.presentationTimeline.Fb()))throw new N(2,9,9005,s);return C(Se,function jv(o,s,m,_){var S;return I((function(E){switch(E.g){case 1:return(S=new ug({Hb:o.g,onError:m,Id:function Id(){},onExpirationUpdated:function onExpirationUpdated(){},onEvent:function onEvent(){}})).configure(_.drm),C(E,function zg(o,s,m){return o.ga=!0,o.u=new Map,o.M=m,Ag(o,s)}(S,s.variants,_.offline.usePersistentLicense),2);case 2:return C(E,Ng(S),3);case 3:return C(E,Mg(S),4);case 4:return E.return(S)}}))}(o,q,(function(o){G=G||o}),S),7);case 7:if(O=Se.h,iv(o),G)throw G;return C(Se,function kv(o,s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He,et,rt,it,at,ot,st;return I((function(ut){switch(ut.g){case 1:return m={width:1/0,height:1/0},function Ed(o,s,m){o.variants=o.variants.filter((function(o){return Fd(o,s,m)}))}(o,s.restrictions,m),C(ut,Hd(o,s.offline.usePersistentLicense),2);case 2:for(_=[],S=s.preferredAudioChannelCount,E=s.preferredDecodingAttributes,A=s.preferredVideoCodecs,O=s.preferredAudioCodecs,sd(o,A,O,S,E),H=t(o.variants),K=H.next();!K.done;K=H.next())z=K.value,_.push(Xd(z));for(G=t(o.textStreams),q=G.next();!q.done;q=G.next())X=q.value,_.push(Yd(X));for(J=t(o.imageStreams),ae=J.next();!ae.done;ae=J.next())pe=ae.value,_.push(Zd(pe));return C(ut,s.offline.trackSelectionCallback(_),3);case 3:for(me=ut.h,_e=o.presentationTimeline.getDuration(),Se=0,Ee=t(me),De=Ee.next();!De.done;De=Ee.next())$e=De.value,He=$e.bandwidth*_e/8,Se+=He;return wa(ut,4),C(ut,s.offline.downloadSizeCallback(Se),6);case 6:if(!ut.h)throw new N(2,9,9014);Aa(ut,5);break;case 4:if((et=Ba(ut))instanceof N)throw et;throw new N(2,9,9015);case 5:for(rt=new Set,it=new Set,at=new Set,ot=t(me),De=ot.next();!De.done;De=ot.next())"variant"==(st=De.value).type&&rt.add(st.id),"text"==st.type&&it.add(st.id),"image"==st.type&&at.add(st.id);o.variants=o.variants.filter((function(o){return rt.has(o.id)})),o.textStreams=o.textStreams.filter((function(o){return it.has(o.id)})),o.imageStreams=o.imageStreams.filter((function(o){return at.has(o.id)})),function sv(o){o.variants.map((function(o){return o.video}));var s=new Set(o.variants.map((function(o){return o.audio})));o=o.textStreams;for(var m=t(s),_=m.next();!_.done;_=m.next())for(var S=(_=t(s)).next();!S.done;S=_.next());for(s=t(o),m=s.next();!m.done;m=s.next())for(m=t(o),_=m.next();!_.done;_=m.next());}(o),D(ut)}}))}(q,S),8);case 8:return C(Se,H.init(),9);case 9:return iv(o),C(Se,qu(H),10);case 10:return K=Se.h,iv(o),X=function lv(o,s,m,_,S,E){var A=function Wu(o,s,m){return{offlineUri:null,originalManifestUri:o,duration:s.presentationTimeline.getDuration(),size:0,expiration:1/0,tracks:s=Xu(s),appMetadata:m,isIncomplete:!1}}(m,s,_),O=S.offline.progressCallback;!function $t(o,s,m){o.m=s,o.l=m}(E,(function(o,s){A.size=s,O(A,o)}),(function(s,m){H&&S.offline.usePersistentLicense&&K==m&&Kg(o,"cenc",s)}));var H=pv(s)&&!qv(s),K=null;H&&(K=Ym.get(o.g.keySystem));for(var z=new Zu,G=t(s.textStreams),q=G.next();!q.done;q=G.next())z.g[q.value.id]=52;for(G=t(s.imageStreams),q=G.next();!q.done;q=G.next())av(z,q.value);for(q=t(s.variants),G=q.next();!G.done;G=q.next())$u(z,G.value);return z=function uv(o,s,m,_){for(var S=new Map,E=Ev(m),A=new Map,O=(E=t(E)).next();!O.done;O=E.next()){var H=Fv(o,s,m,O=O.value,_,S);A.set(O.id,H)}for(o=t(m.variants),s=o.next();!s.done;s=o.next())(s=s.value).audio&&A.get(s.audio.id).variantIds.push(s.id),s.video&&A.get(s.video.id).variantIds.push(s.id);return{streams:Array.from(A.values()),Qe:Array.from(S.values())}}(E,z,s,S),E=z.streams,z=z.Qe,q=o.g,G=S.offline.usePersistentLicense,q&&G&&(q.initData=[]),{Ng:{creationTime:Date.now(),originalManifestUri:m,duration:s.presentationTimeline.getDuration(),size:0,expiration:o.Ic(),streams:E,sessionIds:G?Ug(o):[],drmInfo:q,appMetadata:_,isIncomplete:!0,sequenceMode:s.sequenceMode,type:s.type},Qe:z}}(O,q,s,m,S,E),J=X.Ng,ae=X.Qe,C(Se,K.oa.addManifests([J]),11);case 11:if(pe=Se.h,iv(o),z=pe[0],iv(o),G)throw G;return C(Se,function mv(o,s,m,_,S,E,A,O,H){var K,z,G,q,X,J,ae,pe,me,_e;return I((function(Se){switch(Se.g){case 1:if(K={},z=0,G=function n(s,G){var q,X,J,ae,pe,me,_e;return I((function(Se){if(1==Se.g){for(q={},X=t(s),J=X.next();!J.done;q={wb:q.wb},J=X.next())q.wb=J.value,ae=Vt(q.wb,E),pe=q.wb.i,me=q.wb.h,_e=function(s){return function(m){var _,S,E;return I((function(O){if(1==O.g)return C(O,A.addSegments([{data:m}]),2);_=O.h,iv(o),S=s.wb.g,E=Ut(S),K[E]=_[0],z+=m.byteLength,D(O)}))}}(q),au(S,q.wb.groupId,ae,pe,me,_e);return C(Se,function cu(o){return I((function(s){return 1==s.g?C(s,Promise.all(o.j.values()),2):s.return(o.g.h)}))}(S),2)}return G?(iv(o),function ov(o,s,m,_){if(s.expiration=m.Ic(),m=Ug(m),s.sessionIds=_.offline.usePersistentLicense?m:[],pv(o)&&_.offline.usePersistentLicense&&!m.length)throw new N(2,9,9007)}(O,_,H,E),C(Se,A.updateManifest(m,_),0)):Se.B(0)}))},q=!1,wa(Se,2),!pv(O)||!q||qv(O)){Se.B(4);break}return C(Se,G(s.filter((function(o){return o.h})),!0),5);case 5:return iv(o),s=s.filter((function(o){return!o.h})),X=K,J=z,K={},z=0,C(Se,rv(A,m,_,X,J,(function(){return iv(o)})),6);case 6:iv(o);case 4:if(q){Se.B(7);break}return C(Se,G(s,!1),8);case 8:return iv(o),ae=K,pe=z,K={},z=0,C(Se,rv(A,m,_,ae,pe,(function(){return iv(o)})),9);case 9:iv(o);case 7:Aa(Se,0);break;case 2:return me=Ba(Se),_e=Object.values(K),C(Se,A.removeSegments(_e,(function(){})),10);case 10:throw me}}))}(o,ae,z,J,E,S,K.oa,q,O),12);case 12:return iv(o),me=new Hu("manifest",K.path.Fa,K.path.oa,z),Se.return(Yu(me,J));case 3:return Ca(Se),C(Se,H.destroy(),13);case 13:if(!A){Se.B(14);break}return C(Se,A.stop(),14);case 14:if(!O){Se.B(16);break}return C(Se,O.destroy(),16);case 16:Ea(Se,0);break;case 2:if(_e=Ba(Se),null==z){Se.B(18);break}return C(Se,nv(z),18);case 18:throw G||_e}}))}(this,o,s||{},(function(){var s;return I((function(E){return 1==E.g?C(E,jh(o,_.g,S.manifest.retryParameters,m||null),2):(s=E.h,E.return(s()))}))}),S,E),(s=new Ke(s,(function(){return Zt(E)}))).finally((function(){vb(_.j,E)})),function fv(o,s){var m=s.promise;return o.i.push(m),s.finally((function(){vb(o.i,m)}))}(this,s)},_.remove=function(o){return vv(this,function wv(o,s){var m,_,S,E,A,O;return I((function(H){switch(H.g){case 1:if(gv(),null==(m=Iu(s))||"manifest"!=m.g)throw new N(2,9,9004,s);return _=m,S=new ou,ya(H),C(H,S.init(),4);case 4:return C(H,su(S,_.Fa(),_.oa()),5);case 5:return C(H,(E=H.h).getManifests([_.key()]),6);case 6:return A=H.h,O=A[0],C(H,Promise.all([xv(o,O,S),yv(E,_,O)]),2);case 2:return Ca(H),C(H,S.destroy(),8);case 8:Ea(H,0)}}))}(this,o))},_.ah=function(){return vv(this,function Cv(o){var s,m,_,S,E,A,O,H,K,z;return I((function(G){switch(G.g){case 1:return gv(),s=o.g,m=o.h.drm,_=new ou,S=!1,ya(G),C(G,_.init(),4);case 4:E=[],function tu(o,s){o.g.forEach((function(o){s(o.getEmeSessionCell())}))}(_,(function(o){return E.push(o)})),A=t(E),O=A.next();case 5:if(O.done){G.B(2);break}return C(G,(H=O.value).getAll(),8);case 8:return K=G.h,C(G,Tu(m,s,K),9);case 9:return z=G.h,C(G,H.remove(z),10);case 10:z.length!=K.length&&(S=!0),O=A.next(),G.B(5);break;case 2:return Ca(G),C(G,_.destroy(),11);case 11:Ea(G,3);break;case 3:return G.return(!S)}}))}(this))},_.list=function(){return vv(this,function Dv(){var o,s,m;return I((function(_){switch(_.g){case 1:return gv(),o=[],s=new ou,ya(_),C(_,s.init(),4);case 4:return m=Promise.resolve(),function ru(o,s){o.g.forEach((function(o,m){o.getCells().forEach((function(o,_){s({Fa:m,oa:_},o)}))}))}(s,(function(s,_){m=m.then((function(){return I((function(m){if(1==m.g)return C(m,_.getAllManifests(),2);m.h.forEach((function(m,_){m=Yu(new Hu("manifest",s.Fa,s.oa,_),m),o.push(m)})),D(m)}))}))})),C(_,m,2);case 2:return Ca(_),C(_,s.destroy(),6);case 6:Ea(_,3);break;case 3:return _.return(o)}}))}())},L("shaka.offline.Storage",cv),cv.deleteAll=function(){var o;return I((function(s){return 1==s.g?(o=new ou,ya(s),C(s,function vu(o){var s,m;return I((function(_){return 1==_.g?(s=Array.from(o.g.values()),(m=0<s.length)||Xm.forEach((function(o){(o=o())&&s.push(o)})),C(_,Promise.all(s.map((function(o){return o.erase()}))),2)):m?_.B(0):C(_,Promise.all(s.map((function(o){return o.destroy()}))),0)}))}(o),2)):5!=s.g?(Ca(s),C(s,o.destroy(),5)):Ea(s,0)}))},cv.prototype.list=cv.prototype.list,cv.prototype.removeEmeSessions=cv.prototype.ah,cv.prototype.remove=cv.prototype.remove,cv.prototype.store=cv.prototype.store,cv.prototype.getNetworkingEngine=cv.prototype.zb,cv.prototype.getConfiguration=cv.prototype.getConfiguration,cv.prototype.configure=cv.prototype.configure,cv.prototype.destroy=cv.prototype.destroy,cv.support=dv;var Ym=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.recommendation","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.software","9a04f07998404286ab92e65be0885f95").set("com.microsoft.playready.hardware","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");function Hv(){}function Iv(o,s){for(o={priority:s||0,Wf:o},s=0;s<Zm.length;s++)if(Zm[s].priority<o.priority)return void Zm.splice(s,0,o);Zm.push(o)}So.offline=dv,L("shaka.polyfill",Hv),Hv.register=Iv,Hv.installAll=function(){for(var o=t(Zm),s=o.next();!s.done;s=o.next()){s=s.value;try{s.Wf()}catch(o){$a("Error installing polyfill!",o)}}};var Zm=[];function Kv(){this.g=new Lv}function Mv(){o.AbortController||(o.AbortController=Kv,o.AbortSignal=Lv)}function Lv(){Te.call(this),this.h=!1,this.g=void 0,this.onabort=null}function Nv(){}function Ov(){if(!Object.getOwnPropertyDescriptor(Element.prototype,"ariaHidden"))for(var o=t(["ariaHidden","ariaLabel","ariaPressed","ariaSelected"]),s=o.next();!s.done;s=o.next())Pv(s.value)}function Pv(o){var s="aria-"+o.toLowerCase().replace(/^aria/,"");Object.defineProperty(Element.prototype,o,{get:function get(){return this.getAttribute(s)},set:function set(o){null==o||null==o?this.removeAttribute(s):this.setAttribute(s,o)}})}function Qv(){}function Rv(){Sv()}function Tv(){}function Uv(){if(o.Document){var s=Element.prototype;s.requestFullscreen=s.requestFullscreen||s.mozRequestFullScreen||s.msRequestFullscreen||s.webkitRequestFullscreen,(s=Document.prototype).exitFullscreen=s.exitFullscreen||s.mozCancelFullScreen||s.msExitFullscreen||s.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function get(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function get(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",Vv),document.addEventListener("webkitfullscreenerror",Vv),document.addEventListener("mozfullscreenchange",Vv),document.addEventListener("mozfullscreenerror",Vv),document.addEventListener("MSFullscreenChange",Vv),document.addEventListener("MSFullscreenError",Vv)}}function Vv(o){var s=o.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),m=document.createEvent("Event");m.initEvent(s,o.bubbles,o.cancelable),o.target.dispatchEvent(m)}function Wv(){}function Xv(){var o=!0;(md()||jd("PlayStation 5")||nd()||jd("Web0S")||kd()||jd("CrKey")||jd("PC=EOS")||jd("Hisense")||jd("VIDAA"))&&(o=!1),o&&navigator.mediaCapabilities||(navigator.mediaCapabilities||(navigator.mediaCapabilities={}),ay=navigator.mediaCapabilities,navigator.mediaCapabilities.decodingInfo=Zv)}function Zv(s){var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me;return I((function(_e){switch(_e.g){case 1:if(m={supported:!1,powerEfficient:!0,smooth:!0,keySystemAccess:null,configuration:s},!s)return _e.return(m);if(_=s.video,S=s.audio,"media-source"==s.type){if(!ed())return _e.return(m);if(_){if(jd("CrKey"))if(o.cast&&cast.__platform__&&cast.__platform__.canDisplayType){var Se=_.contentType;_.width&&_.height&&(Se+="; width="+_.width+"; height="+_.height),_.framerate&&(Se+="; framerate="+_.framerate),"pq"===_.transferFunction&&(Se+="; eotf=smpte2084"),E=cast.__platform__.canDisplayType(Se)}else E=gb(_.contentType);else kd()?(A=_.contentType,_.width&&_.height&&(A+="; width="+_.width,A+="; height="+_.height),_.framerate&&(A+="; framerate="+_.framerate),_.bitrate&&(A+="; bitrate="+_.bitrate),E=gb(A)):E=gb(_.contentType);if(!E)return _e.return(m)}if(S&&(O=S.contentType,!gb(O)))return _e.return(m)}else{if("file"!=s.type)return _e.return(m);if(_&&(H=_.contentType,!fd(H))||S&&(K=S.contentType,!fd(K)))return _e.return(m)}if(!s.keySystemConfiguration)return m.supported=!0,_e.return(Promise.resolve(m));if(z=s.keySystemConfiguration,G=[],q=[],z.audio&&(X={robustness:z.audio.robustness||"",contentType:s.audio.contentType},G.push(X)),z.video&&(J={robustness:z.video.robustness||"",contentType:s.video.contentType},q.push(J)),ae={initDataTypes:[z.initDataType],distinctiveIdentifier:z.distinctiveIdentifier,persistentState:z.persistentState,sessionTypes:z.sessionTypes},G.length&&(ae.audioCapabilities=G),q.length&&(ae.videoCapabilities=q),pe=(s.video?s.video.contentType:"")+"#"+(s.audio?s.audio.contentType:"")+"#"+s.keySystemConfiguration.keySystem,wa(_e,3),pe in Py){me=Py[pe],_e.B(5);break}return C(_e,navigator.requestMediaKeySystemAccess(z.keySystem,[ae]),6);case 6:me=_e.h,Py[pe]=me;case 5:Aa(_e,4);break;case 3:Ba(_e);case 4:me&&(m.supported=!0,m.keySystemAccess=me);case 2:return _e.return(m)}}))}Kv.prototype.abort=function(o){var s=this.g;s.h||(s.h=!0,s.g=o,void 0===s.g&&(s.g=new DOMException("signal is aborted without reason","AbortError")),o=new P("abort"),s.onabort&&s.onabort(o),s.dispatchEvent(o))},E.Object.defineProperties(Kv.prototype,{signal:{configurable:!0,enumerable:!0,get:function get(){return this.g}}}),Hv.AbortController=Kv,Kv.install=Mv,ra(Lv,Te),E.Object.defineProperties(Lv.prototype,{aborted:{configurable:!0,enumerable:!0,get:function get(){return this.h}},reason:{configurable:!0,enumerable:!0,get:function get(){return this.g}}}),Iv(Mv),Hv.Aria=Nv,Nv.install=Ov,Iv(Ov),Hv.EncryptionScheme=Qv,Qv.install=Rv,Iv(Rv,-2),Hv.Fullscreen=Tv,Tv.install=Uv,Iv(Uv),Hv.MediaCapabilities=Wv,Wv.install=Xv;var ay=null;Wv.originalMcap=ay;var uy,hy,vy,_y,wy,Ay,Py={};function aw(){}function bw(){var s=od();o.MediaSource&&(o.cast&&cast.__platform__&&cast.__platform__.canDisplayType?function cw(){var o=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(s){var m=s.split(/ *; */);return m.shift(),m.some((function(o){return o.startsWith("codecs=")}))?cast.__platform__.canDisplayType(s):o(s)}}():s?12>=s?(dw(),function ew(){var o=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(s,m){return o.call(this,s,m-.001)}}()):15>=s&&dw():hd()?function fw(){var o=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(s){return"mp2t"!=s.split(";")[0].split("/")[1]&&o(s)}}():(jd("Tizen 2")||jd("Tizen 3")||jd("Tizen 4"))&&function gw(){var o=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(s){return"opus"!=Ic(s)[0]&&o(s)}}()),o.MediaSource&&MediaSource.isTypeSupported('video/webm; codecs="vp9"')&&!MediaSource.isTypeSupported('video/webm; codecs="vp09.00.10.08"')&&function hw(){var o=MediaSource.isTypeSupported;jd("Web0S")||(MediaSource.isTypeSupported=function(s){var m=s.split(/ *; */),_=m.findIndex((function(o){return o.startsWith("codecs=")}));if(0>_)return o(s);var S=m[_].replace("codecs=","").replace(/"/g,"").split(/\s*,\s*/),E=S.findIndex((function(o){return o.startsWith("vp09")}));return 0<=E&&(S[E]="vp9",m[_]='codecs="'+S.join(",")+'"',s=m.join("; ")),o(s)})}()}function dw(){var o=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(){var s=o.apply(this,La.apply(0,arguments));return s.abort=function(){},s}}function iw(){}function jw(){screen.orientation&&screen.orientation.unlock||(null!=screen.orientation?function kw(){void 0===screen.orientation.lock&&(screen.orientation.lock=function(){return Promise.resolve()}),void 0===screen.orientation.unlock&&(screen.orientation.unlock=function(){})}():null!=o.orientation&&function lw(){function a(){switch(o.orientation){case-90:s.type="landscape-secondary",s.angle=270;break;case 0:s.type="portrait-primary",s.angle=0;break;case 90:s.type="landscape-primary",s.angle=90;break;case 180:s.type="portrait-secondary",s.angle=180}}var s=new mw;screen.orientation=s,a(),o.addEventListener("orientationchange",(function(){a();var o=new P("change");s.dispatchEvent(o)}))}())}function mw(){Te.call(this),this.type="",this.angle=0}function nw(){}function uw(o,s){try{var m=new vw(o,s);return Promise.resolve(m)}catch(o){return Promise.reject(o)}}function ww(o){var s=this.mediaKeys;return s&&s!=o&&xw(s,null),delete this.mediaKeys,(this.mediaKeys=o)?xw(o,this):Promise.resolve()}function yw(o){if(pb(o=M(o.initData)).getUint32(0,!0)+4!=o.byteLength)throw new RangeError("Malformed FairPlay init data");o=Bf(o=yf(o.subarray(4),!0));var s=new Event("encrypted");s.initDataType="skd",s.initData=nb(o),this.dispatchEvent(s)}function vw(o,s){if(this.keySystem=o,o.startsWith("com.apple.fps"))for(s=(o=t(s)).next();!s.done;s=o.next()){var m=s.value;if("required"==m.persistentState)s=null;else{s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:m.initDataTypes,sessionTypes:["temporary"],label:m.label};var _=!1,S=!1;if(m.audioCapabilities)for(var E=t(m.audioCapabilities),A=E.next();!A.done;A=E.next())(A=A.value).contentType&&(_=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,A.contentType.split(";")[0])&&(s.audioCapabilities.push(A),S=!0));if(m.videoCapabilities)for(A=(m=t(m.videoCapabilities)).next();!A.done;A=m.next())(E=A.value).contentType&&(_=!0,WebKitMediaKeys.isTypeSupported(this.keySystem,E.contentType.split(";")[0])&&(s.videoCapabilities.push(E),S=!0));_||(S=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),s=S?s:null}if(s)return void(this.g=s)}throw(o=Error("Unsupported keySystem")).name="NotSupportedError",o.code=DOMException.NOT_SUPPORTED_ERR,o}function zw(o){this.h=new WebKitMediaKeys(o),this.g=new lf}function xw(o,s){if(o.g.sb(),!s)return Promise.resolve();o.g.D(s,"webkitneedkey",yw);try{return Ti(s,HTMLMediaElement.HAVE_METADATA,o.g,(function(){s.webkitSetMediaKeys(o.h)})),Promise.resolve()}catch(o){return Promise.reject(o)}}function Aw(o){Te.call(this),this.i=null,this.l=o,this.g=this.h=null,this.j=new lf,this.sessionId="",this.expiration=NaN,this.closed=new Je,this.keyStatuses=new Bw}function Cw(o,s){var m=o.keyStatuses;m.size=null==s?0:1,m.g=s,s=new P("keystatuseschange"),o.dispatchEvent(s)}function Bw(){this.size=0,this.g=void 0}function Dw(){}function Ew(){!o.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(navigator.requestMediaKeySystemAccess=Fw,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Gw,o.MediaKeys=Hw,o.MediaKeySystemAccess=Iw,o.shakaMediaKeysPolyfill=!0)}function Fw(){return Promise.reject(Error("The key system specified is not supported."))}function Gw(o){return null==o?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Hw(){throw new TypeError("Illegal constructor.")}function Iw(){throw this.keySystem="",new TypeError("Illegal constructor.")}function Jw(){}function Kw(){if(!(!o.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Ly="webkit";else if(!HTMLMediaElement.prototype.generateKeyRequest)return;navigator.requestMediaKeySystemAccess=Mw,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Nw,o.MediaKeys=Ow,o.MediaKeySystemAccess=Pw,o.shakaMediaKeysPolyfill=!0}}function Qw(o){return Ly?Ly+o.charAt(0).toUpperCase()+o.slice(1):o}function Mw(o,s){try{var m=new Pw(o,s);return Promise.resolve(m)}catch(o){return Promise.reject(o)}}function Nw(o){var s=this.mediaKeys;return s&&s!=o&&Rw(s,null),delete this.mediaKeys,(this.mediaKeys=o)&&Rw(o,this),Promise.resolve()}function Pw(o,s){this.g=this.keySystem=o;var m=!1;"org.w3.clearkey"==o&&(this.g="webkit-org.w3.clearkey",m=!1);var _=!1,S=document.getElementsByTagName("video");S=S.length?S[0]:document.createElement("video");for(var E=(s=t(s)).next();!E.done;E=s.next()){var A={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:(E=E.value).initDataTypes,sessionTypes:["temporary"],label:E.label},O=!1;if(E.audioCapabilities)for(var H=t(E.audioCapabilities),K=H.next();!K.done;K=H.next())(K=K.value).contentType&&(O=!0,S.canPlayType(K.contentType.split(";")[0],this.g)&&(A.audioCapabilities.push(K),_=!0));if(E.videoCapabilities)for(K=(H=t(E.videoCapabilities)).next();!K.done;K=H.next())(K=K.value).contentType&&(O=!0,S.canPlayType(K.contentType,this.g)&&(A.videoCapabilities.push(K),_=!0));if(O||(_=S.canPlayType("video/mp4",this.g)||S.canPlayType("video/webm",this.g)),"required"==E.persistentState&&(m?(A.persistentState="required",A.sessionTypes=["persistent-license"]):_=!1),_)return void(this.h=A)}throw m="Unsupported keySystem","org.w3.clearkey"!=o&&"com.widevine.alpha"!=o||(m="None of the requested configurations were supported."),(o=Error(m)).name="NotSupportedError",o.code=DOMException.NOT_SUPPORTED_ERR,o}function Ow(o){this.l=o,this.h=null,this.g=new lf,this.i=[],this.j=new Map}function Rw(o,s){o.h=s,o.g.sb();var m=Ly;s&&(o.g.D(s,m+"needkey",(function(s){var m=new CustomEvent("encrypted");m.initDataType="cenc",m.initData=nb(s.initData),o.h.dispatchEvent(m)})),o.g.D(s,m+"keymessage",(function(s){var m=Sw(o,s.sessionId);m&&(s=new P("message",s=(new Map).set("messageType",null==m.keyStatuses.Bb()?"licenserequest":"licenserenewal").set("message",s.message)),m.h&&(m.h.resolve(),m.h=null),m.dispatchEvent(s))})),o.g.D(s,m+"keyadded",(function(s){(s=Sw(o,s.sessionId))&&(Tw(s,"usable"),s.g&&s.g.resolve(),s.g=null)})),o.g.D(s,m+"keyerror",(function(s){var m=Sw(o,s.sessionId);m&&m.handleError(s)})))}function Sw(o,s){var m=o.j.get(s);return m||((m=o.i.shift())?(m.sessionId=s,o.j.set(s,m),m):null)}function Uw(o,s,m){Te.call(this),this.j=o,this.m=!1,this.g=this.h=null,this.i=s,this.l=m,this.sessionId="",this.expiration=NaN,this.closed=new Je,this.keyStatuses=new Vw}function Ww(o,s,m){if(o.m)return Promise.reject(Error("The session is already initialized."));o.m=!0;try{if("persistent-license"==o.l)if(m)var _=M(Bf("LOAD_SESSION|"+m));else{var S=Bf("PERSISTENT|");_=Wf(S,s)}else _=M(s)}catch(o){return Promise.reject(o)}o.h=new Je;var E=Qw("generateKeyRequest");try{o.j[E](o.i,_)}catch(s){if("InvalidStateError"!=s.name)return o.h=null,Promise.reject(s);new dd((function(){try{o.j[E](o.i,_)}catch(s){o.h.reject(s),o.h=null}})).S(.01)}return o.h}function Xw(o,s,m){if(o.g)o.g.then((function(){return Xw(o,s,m)})).catch((function(){return Xw(o,s,m)}));else{if(o.g=s,"webkit-org.w3.clearkey"==o.i){var _=xf(m),S=JSON.parse(_);"oct"!=S.keys[0].kty&&(o.g.reject(Error("Response is not a valid JSON Web Key Set.")),o.g=null),_=Tf(S.keys[0].k),S=Tf(S.keys[0].kid)}else _=M(m),S=null;var E=Qw("addKey");try{o.j[E](o.i,_,S,o.sessionId)}catch(s){o.g.reject(s),o.g=null}}}function Tw(o,s){var m=o.keyStatuses;m.size=null==s?0:1,m.g=s,s=new P("keystatuseschange"),o.dispatchEvent(s)}function Vw(){this.size=0,this.g=void 0}Wv.memoizedMediaKeySystemAccessRequests_=Py,Iv(Xv,-1),Hv.MediaSource=aw,aw.install=bw,Iv(bw),Hv.Orientation=iw,iw.install=jw,ra(mw,Te),mw.prototype.lock=function(o){function b(o){return screen.lockOrientation?screen.lockOrientation(o):screen.mozLockOrientation?screen.mozLockOrientation(o):!!screen.msLockOrientation&&screen.msLockOrientation(o)}var s=!1;switch(o){case"natural":s=b("default");break;case"any":s=!0,this.unlock();break;default:s=b(o)}return s?Promise.resolve():((o=Error("screen.orientation.lock() is not available on this device")).name="NotSupportedError",o.code=DOMException.NOT_SUPPORTED_ERR,Promise.reject(o))},mw.prototype.unlock=function(){screen.unlockOrientation?screen.unlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()},Iv(jw),Hv.PatchedMediaKeysApple=nw,nw.uninstall=function(){uy&&(uy=!1,Object.defineProperty(HTMLMediaElement.prototype,"mediaKeys",hy),HTMLMediaElement.prototype.setMediaKeys=vy,o.MediaKeys=_y,o.MediaKeySystemAccess=wy,navigator.requestMediaKeySystemAccess=Ay,hy=Ay=vy=wy=_y=null,o.shakaMediaKeysPolyfill=!1)},nw.install=function(s){o.HTMLVideoElement&&o.WebKitMediaKeys&&(void 0!==s&&s&&(uy=!0,hy=Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"mediaKeys"),vy=HTMLMediaElement.prototype.setMediaKeys,_y=o.MediaKeys,wy=o.MediaKeySystemAccess,Ay=navigator.requestMediaKeySystemAccess),delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=ww,o.MediaKeys=zw,o.MediaKeySystemAccess=vw,navigator.requestMediaKeySystemAccess=uw,o.shakaMediaKeysPolyfill=!0)},vw.prototype.createMediaKeys=function(){var o=new zw(this.keySystem);return Promise.resolve(o)},vw.prototype.getConfiguration=function(){return this.g},zw.prototype.createSession=function(o){if("temporary"!=(o=o||"temporary"))throw new TypeError("Session type "+o+" is unsupported on this platform.");return new Aw(this.h)},zw.prototype.setServerCertificate=function(){return Promise.resolve(!1)},zw.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},ra(Aw,Te),(_=Aw.prototype).generateRequest=function(o,s){var m=this;this.h=new Je;try{var _=this.l.createSession("video/mp4",M(s));this.i=_,this.sessionId=_.sessionId||"",this.j.D(this.i,"webkitkeymessage",(function(o){m.h&&(m.h.resolve(),m.h=null),o=new P("message",o=(new Map).set("messageType",null==m.keyStatuses.Bb()?"license-request":"license-renewal").set("message",nb(o.message))),m.dispatchEvent(o)})),this.j.D(_,"webkitkeyadded",(function(){m.g&&(Cw(m,"usable"),m.g.resolve(),m.g=null)})),this.j.D(_,"webkitkeyerror",(function(){var o=Error("EME PatchedMediaKeysApple key error");if(o.errorCode=m.i.error,null!=m.h)m.h.reject(o),m.h=null;else if(null!=m.g)m.g.reject(o),m.g=null;else switch(m.i.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:Cw(m,"output-not-allowed");break;default:Cw(m,"internal-error")}})),Cw(this,"status-pending")}catch(o){this.h.reject(o)}return this.h},_.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))},_.update=function(o){this.g=new Je;try{this.i.update(M(o))}catch(o){this.g.reject(o)}return this.g},_.close=function(){try{this.i.close(),this.closed.resolve(),this.j.sb()}catch(o){this.closed.reject(o)}return this.closed},_.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},(_=Bw.prototype).Bb=function(){return this.g},_.forEach=function(o){this.g&&o(this.g,ta.value())},_.get=function(o){if(this.has(o))return this.g},_.has=function(o){var s=ta.value();return!(!this.g||!lb(o,s))},_.entries=function(){},_.keys=function(){},_.values=function(){},Hv.PatchedMediaKeysNop=Dw,Dw.install=Ew,Hw.prototype.createSession=function(){},Hw.prototype.setServerCertificate=function(){},Hw.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},Iw.prototype.getConfiguration=function(){},Iw.prototype.createMediaKeys=function(){},Iv(Ew,-10),Hv.PatchedMediaKeysWebkit=Jw,Jw.install=Kw,Pw.prototype.createMediaKeys=function(){var o=new Ow(this.g);return Promise.resolve(o)},Pw.prototype.getConfiguration=function(){return this.h},Ow.prototype.createSession=function(o){if("temporary"!=(o=o||"temporary")&&"persistent-license"!=o)throw new TypeError("Session type "+o+" is unsupported on this platform.");var s=this.h||document.createElement("video");return s.src||(s.src="about:blank"),o=new Uw(s,this.l,o),this.i.push(o),o},Ow.prototype.setServerCertificate=function(){return Promise.resolve(!1)},Ow.prototype.getStatusForPolicy=function(){return Promise.resolve("usable")},ra(Uw,Te),(_=Uw.prototype).handleError=function(o){var s=Error("EME v0.1b key error"),m=o.errorCode;m.systemCode=o.systemCode,s.errorCode=m,!o.sessionId&&this.h?(45==o.systemCode&&(s.message="Unsupported session type."),this.h.reject(s),this.h=null):o.sessionId&&this.g?(this.g.reject(s),this.g=null):(s=o.systemCode,o.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Tw(this,"output-restricted"):Tw(this,1==s?"expired":"internal-error"))},_.generateRequest=function(o,s){return Ww(this,s,null)},_.load=function(o){return"persistent-license"==this.l?Ww(this,null,o):Promise.reject(Error("Not a persistent session."))},_.update=function(o){var s=new Je;return Xw(this,s,o),s},_.close=function(){if("persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var o=Qw("cancelKeyRequest");try{this.j[o](this.i,this.sessionId)}catch(o){}}return this.closed.resolve(),this.closed},_.remove=function(){return"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},(_=Vw.prototype).Bb=function(){return this.g},_.forEach=function(o){this.g&&o(this.g,ta.value())},_.get=function(o){if(this.has(o))return this.g},_.has=function(o){var s=ta.value();return!(!this.g||!lb(o,s))},_.entries=function(){},_.keys=function(){},_.values=function(){};var Ly="";function Yw(){}function Zw(){if(o.HTMLVideoElement){var s=HTMLVideoElement.prototype;s.requestPictureInPicture&&document.exitPictureInPicture||!s.webkitSupportsPresentationMode||(document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,s.requestPictureInPicture=$w,Object.defineProperty(s,"disablePictureInPicture",{get:ax,set:bx,enumerable:!0,configurable:!0}),document.exitPictureInPicture=cx,document.addEventListener("webkitpresentationmodechanged",dx,!0))}}function dx(o){if("picture-in-picture"==(o=o.target).webkitPresentationMode){document.pictureInPictureElement=o;var s=new Event("enterpictureinpicture");o.dispatchEvent(s)}else document.pictureInPictureElement==o&&(document.pictureInPictureElement=null),s=new Event("leavepictureinpicture"),o.dispatchEvent(s)}function $w(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function cx(){var o=document.pictureInPictureElement;return o?(o.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function ax(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function bx(o){o?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function ex(){}function fx(){o.crypto&&("randomUUID"in o.crypto||(o.crypto.randomUUID=gx))}function gx(){var o=URL.createObjectURL(new Blob),s=o.toString();return URL.revokeObjectURL(o),s.substr(s.lastIndexOf("/")+1)}function hx(){}function ix(){navigator.storage&&navigator.storage.estimate||!navigator.webkitTemporaryStorage||!navigator.webkitTemporaryStorage.queryUsageAndQuota||("storage"in navigator||(navigator.storage={}),navigator.storage.estimate=jx)}function jx(){return new Promise((function(o,s){navigator.webkitTemporaryStorage.queryUsageAndQuota((function(s,m){o({usage:s,quota:m})}),s)}))}function kx(){}function lx(){var o=Symbol.prototype;"description"in o||Object.defineProperty(o,"description",{get:mx})}function mx(){var o=/\((.*)\)/.exec(this.toString());return o?o[1]:void 0}function nx(){}function ox(){if(o.HTMLMediaElement){var s=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var o=s.apply(this);return o&&o.catch((function(){})),o}}}function px(){}function qx(){if(o.HTMLVideoElement){var s=HTMLVideoElement.prototype;!s.getVideoPlaybackQuality&&("webkitDroppedFrameCount"in s||ld())&&(s.getVideoPlaybackQuality=rx)}}function rx(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function sx(){}function tx(){if(!o.VTTCue&&o.TextTrackCue){var s=null,m=TextTrackCue.length;if(3==m)s=ux;else if(6==m)s=vx;else{try{var _=!!ux(1,2,"")}catch(o){_=!1}_&&(s=ux)}s&&(o.VTTCue=function(o,m,_){return s(o,m,_)})}}function ux(s,m,_){return new o.TextTrackCue(s,m,_)}function vx(s,m,_){return new o.TextTrackCue(s+"-"+m+"-"+_,s,m,_)}function wx(){}Iv(Kw),Hv.PiPWebkit=Yw,Yw.install=Zw,Iv(Zw),Hv.RandomUUID=ex,ex.install=fx,Iv(fx),Hv.StorageEstimate=hx,hx.install=ix,Iv(ix),Hv.Symbol=kx,kx.install=lx,Iv(lx),Hv.VideoPlayPromise=nx,nx.install=ox,Iv(ox),Hv.VideoPlaybackQuality=px,px.install=qx,Iv(qx),Hv.VTTCue=sx,sx.install=tx,Iv(tx),wx.prototype.parseInit=function(){},wx.prototype.setSequenceMode=function(){},wx.prototype.parseMedia=function(o,s){for(var m=null,_=[],S=(o=t(o=xf(o).split(/\r?\n/))).next();!S.done;S=o.next())if((S=S.value)&&!/^\s+$/.test(S)&&(S=Ry.exec(S))){var E=Oy.exec(S[1]);S=new yb(E=60*parseInt(E[1],10)+parseFloat(E[2].replace(",",".")),s.segmentEnd?s.segmentEnd:E+2,S[2]),m&&(m.endTime=E,_.push(m)),m=S}return m&&_.push(m),_},L("shaka.text.LrcTextParser",wx),wx.prototype.parseMedia=wx.prototype.parseMedia,wx.prototype.setSequenceMode=wx.prototype.setSequenceMode,wx.prototype.parseInit=wx.prototype.parseInit;var Ry=/^\[(\d{1,2}:\d{1,2}(?:[.,]\d{1,3})?)\](.*)/,Oy=/^(\d+):(\d{1,2}(?:[.,]\d{1,3})?)$/;function zx(){}function Gx(o,s,m,_,S,E,A,O,H,K,z){var G=o.parentNode;if(o.nodeType==Node.COMMENT_NODE)return null;if(o.nodeType==Node.TEXT_NODE){if(!z)return null;var q=document.createElement("span");q.textContent=o.textContent}else q=o;for(var X=null,J=t(s_),ae=J.next();!ae.done&&!(X=Ix(q,"backgroundImage",_,"#",ae.value)[0]);ae=J.next());if(J=z,("p"==o.nodeName||X)&&(z=!0),O="default"==(q.getAttribute("xml:space")||(O?"default":"preserve")),ae=Array.from(q.childNodes).every((function(o){return o.nodeType==Node.TEXT_NODE})),o=[],!ae)for(var pe=t(q.childNodes),me=pe.next();!me.done;me=pe.next())(me=Gx(me.value,s,m,_,S,E,A,O,H,q,z))&&o.push(me);_=null!=K,pe=/\S/.test(q.textContent);var Ee=q.hasAttribute("begin")||q.hasAttribute("end")||q.hasAttribute("dur");if(!(Ee||pe||"br"==q.tagName||0!=o.length||_&&!O))return null;for(pe=(me=Jx(q,m)).start,me=me.end;G&&G.nodeType==Node.ELEMENT_NODE&&"tt"!=G.tagName;)pe=(me=Kx(G,m,pe,me)).start,me=me.end,G=G.parentNode;if(null==pe&&(pe=0),pe+=s.periodStart,me=null==me?1/0:me+s.periodStart,pe=Math.max(pe,s.segmentStart),me=Math.min(me,s.segmentEnd),!Ee&&0<o.length)for(pe=1/0,me=0,m=(s=t(o)).next();!m.done;m=s.next())m=m.value,pe=Math.min(pe,m.startTime),me=Math.max(me,m.endTime);if("br"==q.tagName)return(S=new yb(pe,me,"")).F=!0,S;if(s="",ae&&(s=q.textContent,O&&(s=(s=s.trim()).replace(/\s+/g," "))),(s=new yb(pe,me,s)).g=o,z||(s.Y=!0),H&&(s.X=H),H=Ix(q,"region",E,"")[0],q.hasAttribute("region")&&H&&H.getAttribute("xml:id")){var He=H.getAttribute("xml:id");s.region=A.filter((function(o){return o.id==He}))[0]}return A=H,K&&_&&!q.getAttribute("region")&&!q.getAttribute("style")&&(A=Ix(K,"region",E,"")[0]),function Lx(o,s,m,_,S,E,A){E=E||A,"rtl"==Mx(s,m,S,"direction",E)&&(o.direction="rtl"),A=Mx(s,m,S,"writingMode",E),"tb"==A||"tblr"==A?o.writingMode="vertical-lr":"tbrl"==A?o.writingMode="vertical-rl":"rltb"==A||"rl"==A?o.direction="rtl":A&&(o.direction=$e),(A=Mx(s,m,S,"textAlign",!0))?(o.G=i_[A],o.s=r_[A],o.textAlign=Se[A.toUpperCase()]):o.textAlign=_e,(A=Mx(s,m,S,"displayAlign",!0))&&(o.i=De[A.toUpperCase()]);(A=Mx(s,m,S,"color",E))&&(o.j=A);(A=Mx(s,m,S,"backgroundColor",E))&&(o.backgroundColor=A);(A=Mx(s,m,S,"border",E))&&(o.V=A);if(A=Mx(s,m,S,"fontFamily",E))switch(A){case"monospaceSerif":o.l="Courier New,Liberation Mono,Courier,monospace";break;case"proportionalSansSerif":o.l="Arial,Helvetica,Liberation Sans,sans-serif";break;case"sansSerif":o.l="sans-serif";break;case"monospaceSansSerif":o.l="Consolas,monospace";break;case"proportionalSerif":o.l="serif";break;default:o.l=A}(A=Mx(s,m,S,"fontWeight",E))&&"bold"==A&&(o.u=700),A=Mx(s,m,S,"wrapOption",E),o.M=!A||"noWrap"!=A,(A=Mx(s,m,S,"lineHeight",E))&&A.match(tv)&&(o.aa=A),(A=Mx(s,m,S,"fontSize",E))&&(A.match(tv)||A.match(Qy))&&(o.A=A),(A=Mx(s,m,S,"fontStyle",E))&&(o.o=ct[A.toUpperCase()]);if(_){A=_.getAttribute("imageType")||_.getAttribute("imagetype");var O=_.getAttribute("encoding");_=_.textContent.trim(),"PNG"==A&&"Base64"==O&&_&&(o.N="data:image/png;base64,"+_)}(_=Mx(s,m,S,"textOutline",E))&&(_=_.split(" "),_[0].match(tv)?o.L=o.j:(o.L=_[0],_.shift()),_[0]&&_[0].match(tv)?o.ga=_[0]:o.L="");(_=Mx(s,m,S,"letterSpacing",E))&&_.match(tv)&&(o.W=_),(_=Mx(s,m,S,"linePadding",E))&&_.match(tv)&&(o.Z=_),(E=Mx(s,m,S,"opacity",E))&&(o.C=parseFloat(E));(m=Fx(m,S,"textDecoration"))&&Rx(o,m),(s=Sx(s,S,"textDecoration"))&&Rx(o,s)}(s,q,A,X,S,J,0==o.length),s}function Rx(o,s){for(var m=(s=t(s.split(" "))).next();!m.done;m=s.next())switch(m.value){case"underline":o.h.includes("underline")||o.h.push("underline");break;case"noUnderline":o.h.includes("underline")&&vb(o.h,"underline");break;case"lineThrough":o.h.includes("lineThrough")||o.h.push("lineThrough");break;case"noLineThrough":o.h.includes("lineThrough")&&vb(o.h,"lineThrough");break;case"overline":o.h.includes("overline")||o.h.push("overline");break;case"noOverline":o.h.includes("overline")&&vb(o.h,"overline")}}function Mx(o,s,m,_,S){return S=void 0===S||S,(o=Sx(o,m,_))?o:S?Fx(s,m,_):null}function Fx(o,s,m){if(!o)return null;var _=eg(o,o_,m);return _||Tx(o,s,m)}function Sx(o,s,m){var _=eg(o,o_,m);return _||Tx(o,s,m)}function Tx(o,s,m){o=Ix(o,"style",s,"");for(var _=null,S=0;S<o.length;S++){var E=dg(o[S],"urn:ebu:tt:style",m);E||(E=eg(o[S],o_,m)),E||(E=Sx(o[S],s,m)),E&&(_=E)}return _}function Ix(o,s,m,_,S){var E=[];if(!o||1>m.length)return E;var A=o;for(o=null;A&&!(o=S?dg(A,S,s):A.getAttribute(s))&&(A=A.parentNode)instanceof Element;);if(s=o)for(S=(s=t(s.split(" "))).next();!S.done;S=s.next())for(S=S.value,A=(o=t(m)).next();!A.done;A=o.next())if(_+(A=A.value).getAttribute("xml:id")==S){E.push(A);break}return E}function Kx(o,s,m,_){return o=Jx(o,s),null==m?m=o.start:null!=o.start&&(m+=o.start),null==_?_=o.end:null!=o.start&&(_+=o.start),{start:m,end:_}}function Jx(o,s){var m=Ux(o.getAttribute("begin"),s),_=Ux(o.getAttribute("end"),s);return o=Ux(o.getAttribute("dur"),s),null==_&&null!=o&&(_=m+o),{start:m,end:_}}function Ux(o,s){var m=null;if($v.test(o)){o=$v.exec(o),m=Number(o[1]);var _=Number(o[2]),S=Number(o[3]),E=Number(o[4]);m=(S+=(E+=(Number(o[5])||0)/s.h)/s.frameRate)+60*_+3600*m}else if(Yv.test(o))m=Xx(Yv,o);else if(Jv.test(o))m=Xx(Jv,o);else if(e_.test(o))o=e_.exec(o),m=Number(o[1])/s.frameRate;else if(t_.test(o))o=t_.exec(o),m=Number(o[1])/s.g;else if(n_.test(o))m=Xx(n_,o);else if(o)throw new N(2,2,2001,"Could not parse cue time range in TTML");return m}function Xx(o,s){return null==(o=o.exec(s))||""==o[0]?null:(Number(o[4])||0)/1e3+(Number(o[3])||0)+60*(Number(o[2])||0)+3600*(Number(o[1])||0)}function Cx(o,s,m,_){this.frameRate=Number(o)||30,this.h=Number(s)||1,this.g=Number(_),0==this.g&&(this.g=o?this.frameRate*this.h:1),m&&(o=/^(\d+) (\d+)$/g.exec(m))&&(this.frameRate*=Number(o[1])/Number(o[2]))}rn["application/x-subtitle-lrc"]=function(){return new wx},zx.prototype.parseInit=function(){},zx.prototype.setSequenceMode=function(){},zx.prototype.parseMedia=function(o,s){var m=xf(o);if(o=[],""==m)return o;var _=rg(m,"tt");if(!_)throw new N(2,2,2005,"Failed to parse TTML.");if(!(m=_.getElementsByTagName("body")[0]))return[];var S=eg(_,a_,"frameRate"),E=eg(_,a_,"subFrameRate"),A=eg(_,a_,"frameRateMultiplier"),O=eg(_,a_,"tickRate"),H=eg(_,a_,"cellResolution"),K=_.getAttribute("xml:space")||"default",z=eg(_,o_,"extent");if("default"!=K&&"preserve"!=K)throw new N(2,2,2005,"Invalid xml:space value: "+K);K="default"==K,S=new Cx(S,E,A,O),H=H&&(H=/^(\d+) (\d+)$/.exec(H))?{bg:parseInt(H[1],10),rows:parseInt(H[2],10)}:null,E=(E=_.getElementsByTagName("metadata")[0])?function cg(o){return Array.from(o.childNodes).filter((function(o){return o instanceof Element}))}(E):[],A=Array.from(_.getElementsByTagName("style")),O=[];for(var G=t(_=Array.from(_.getElementsByTagName("region"))),q=G.next();!q.done;q=G.next()){var X=q.value;q=new zb;var J=X.getAttribute("xml:id");if(J){q.id=J;var ae,pe,me=null;z&&(me=Xy.exec(z)||_v.exec(z)),J=me?Number(me[1]):null,me=me?Number(me[2]):null,(ae=Fx(X,A,"extent"))&&(null!=(ae=(pe=Xy.exec(ae))||_v.exec(ae))&&(q.width=Number(ae[1]),q.height=Number(ae[2]),pe||(null!=J&&(q.width=100*q.width/J),null!=me&&(q.height=100*q.height/me)),q.l=pe||null!=J?dt:0,q.i=pe||null!=me?dt:0)),(X=Fx(X,A,"origin"))&&(null!=(ae=(pe=Xy.exec(X))||_v.exec(X))&&(q.g=Number(ae[1]),q.h=Number(ae[2]),pe||(null!=me&&(q.h=100*q.h/me),null!=J&&(q.g=100*q.g/J)),q.j=pe||null!=J?dt:0))}else q=null;q&&O.push(q)}if($f(m,"p").length)throw new N(2,2,2001,"<p> can only be inside <div> in TTML");for(G=(z=t($f(m,"div"))).next();!G.done;G=z.next())if($f(G.value,"span").length)throw new N(2,2,2001,"<span> can only be inside <p> in TTML");return(s=Gx(m,s,S,E,A,_,O,K,H,null,!1))&&(s.backgroundColor||(s.backgroundColor="transparent"),o.push(s)),o},L("shaka.text.TtmlTextParser",zx),zx.prototype.parseMedia=zx.prototype.parseMedia,zx.prototype.setSequenceMode=zx.prototype.setSequenceMode,zx.prototype.parseInit=zx.prototype.parseInit;var Xy=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Qy=/^(\d{1,2}(?:\.\d+)?|100)%$/,tv=/^(\d+px|\d+em|\d*\.?\d+c)$/,_v=/^(\d+)px (\d+)px$/,$v=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Yv=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Jv=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,e_=/^(\d*(?:\.\d*)?)f$/,t_=/^(\d*(?:\.\d*)?)t$/,n_=RegExp("^(?:(\\d*(?:\\.\\d*)?)h)?(?:(\\d*(?:\\.\\d*)?)m)?(?:(\\d*(?:\\.\\d*)?)s)?(?:(\\d*(?:\\.\\d*)?)ms)?$"),r_={left:rt,center:"center",right:"end",start:rt,end:"end"},i_={left:"line-left",center:"center",right:"line-right"},a_=["http://www.w3.org/ns/ttml#parameter","http://www.w3.org/2006/10/ttaf1#parameter"],o_=["http://www.w3.org/ns/ttml#styling","http://www.w3.org/2006/10/ttaf1#styling"],s_=["http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt","http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"];function by(){this.g=new zx}function cy(){this.g=!1}function ey(o){for(var s=t(Object.entries(at)),m=s.next();!m.done;m=s.next()){var _=t(m.value);m=_.next().value,_=_.next().value;var S=new yb(0,0,"");S.j=_,o.set("."+m,S)}for(m=(s=t(Object.entries(ot))).next();!m.done;m=s.next())m=(_=t(m.value)).next().value,_=_.next().value,(S=new yb(0,0,"")).backgroundColor=_,o.set("."+m,S)}function fy(o,s,m){0===m.size&&ey(m);e:{var _=o;o=[];for(var S=-1,E="",A=0;A<_.length;A++)if("/"===_[A]&&0<A&&"<"===_[A-1]){var O=_.indexOf(">",A);if(O<=A){o=_;break e}if((O=_.substring(A+1,O))&&"c"===O){var H=o.pop();H?H===O?(E+="/"+O+">",A+=O.length+1):H.startsWith("c.")?(A+=O.length+1,E+="/"+H+">"):E+=_[A]:E+=_[A]}else E+=_[A]}else"<"===_[A]?"c"!=_[S=A+1]&&(S=-1):">"===_[A]&&0<S&&(o.push(_.substr(S,A-S)),S=-1),E+=_[A];o=E}for(_=[],E=-1,S=0;S<o.length;S++)"<"===o[S]?E=S+1:">"===o[S]&&0<E&&((E=o.substr(E,S-E)).match(u_)&&_.push(E),E=-1);for(S=(_=t(_)).next();!S.done;S=_.next())S=S.value,o=o.replace("<"+S+">",'<div time="'+S+'">'),o+="</div>";e:{for(S=o,E=[],A=-1,_="",o=!1,O=0;O<S.length;O++)if("/"===S[O]){if(-1===(H=S.indexOf(">",O))){o=S;break e}if((H=S.substring(O+1,H))&&"v"==H){o=!0;var K=null;if(E.length&&(K=E[E.length-1]),K){if(K===H)_+="/"+H+">";else{if(!K.startsWith("v")){_+=S[O];continue}_+="/"+K+">"}O+=H.length+1}else _+=S[O]}else _+=S[O]}else"<"===S[O]?"v"!=S[A=O+1]&&(A=-1):">"===S[O]&&0<A&&(E.push(S.substr(A,O-A)),A=-1),_+=S[O];for(E=(S=t(E)).next();!E.done;E=S.next())A=(E=E.value).replace(" ",".voice-"),_=(_=_.replace("<"+E+">","<"+A+">")).replace("</"+E+">","</"+A+">"),o||(_+="</"+A+">");o=_}if(S=rg("<span>"+o+"</span>","span")){if(_=[],1==(S=S.childNodes).length&&((E=S[0]).nodeType==Node.TEXT_NODE||E.nodeType==Node.CDATA_SECTION_NODE))return void(s.U=iy(o));for(S=(o=t(S)).next();!S.done;S=o.next())jy(S.value,s,_,m);s.g=_}else s.U=iy(o)}function ky(o,s){return o&&0<o.length?o:s}function jy(o,s,m,_){var S=s.clone();if(o.nodeType===Node.ELEMENT_NODE&&o.nodeName)for(var E=t(o.nodeName.split(/(?=[ .])+/g)),A=E.next();!A.done;A=E.next()){var O=A=A.value;if(O.startsWith(".voice-")){var H=O.split("-").pop();O='v[voice="'+H+'"]',_.has(O)||(O="v[voice="+H+"]")}switch(_.has(O)&&(O=_.get(O))&&(S.backgroundColor=ky(O.backgroundColor,S.backgroundColor),S.j=ky(O.j,S.j),S.l=ky(O.l,S.l),S.A=ky(O.A,S.A),S.u=O.u,S.o=O.o,S.C=O.C,S.I=O.I,S.M=O.M),A){case"br":(A=s.clone()).F=!0,m.push(A);break;case"b":S.u=700;break;case"i":S.o="italic";break;case"u":S.h.push("underline");break;case"font":(A=o.getAttribute("color"))&&(S.j=A);break;case"div":(A=o.getAttribute("time"))&&(A=dy(new Hr(A)))&&(S.startTime=A)}}if(gg(o))for(E=!0,_=t(o.textContent.split("\n")),o=_.next();!o.done;o=_.next())o=o.value,E||((E=s.clone()).F=!0,m.push(E)),0<o.length&&((E=S.clone()).U=iy(o),m.push(E)),E=!1;else for(o=(s=t(o.childNodes)).next();!o.done;o=s.next())jy(o.value,S,m,_)}function gy(o,s,m){var _;(_=/^align:(start|middle|center|end|left|right)$/.exec(s))?(s=_[1],o.textAlign="middle"==s?_e:Se[s.toUpperCase()]):(_=/^vertical:(lr|rl)$/.exec(s))?o.writingMode="lr"==_[1]?"vertical-lr":"vertical-rl":(_=/^size:([\d.]+)%$/.exec(s))?o.size=Number(_[1]):(_=/^position:([\d.]+)%(?:,(line-left|line-right|middle|center|start|end|auto))?$/.exec(s))?(o.position=Number(_[1]),_[2]&&(s=_[2],o.G="line-left"==s||"start"==s?"line-left":"line-right"==s||"end"==s?"line-right":"center"==s||"middle"==s?"center":me)):(_=/^region:(.*)$/.exec(s))?(s=function ly(o,s){return o=o.filter((function(o){return o.id==s})),o.length?o[0]:null}(m,_[1]))&&(o.region=s):(m=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(s))?(o.H=1,o.m=Number(m[1]),m[2]&&(o.s=it[m[2].toUpperCase()])):(m=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(s))&&(o.H=et,o.m=Number(m[1]),m[2]&&(o.s=it[m[2].toUpperCase()]))}function dy(o){if(null==(o=Jr(o,u_)))return null;var s=Number(o[2]),m=Number(o[3]);return 59<s||59<m?null:Number(o[4])/1e3+m+60*s+3600*(Number(o[1])||0)}function iy(o){var s={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&nbsp;":" ","&lrm;":"‎","&rlm;":"‏"},m=/&(?:amp|lt|gt|quot|#(0+)?39|nbsp|lrm|rlm);/g,_=RegExp(m.source);return o&&_.test(o)?o.replace(m,(function(o){return s[o]||"'"})):o||""}rn["application/ttml+xml"]=function(){return new zx},by.prototype.parseInit=function(o){var s=!1;if((new Gf).box("moov",Lf).box("trak",Lf).box("mdia",Lf).box("minf",Lf).box("stbl",Lf).O("stsd",Nf).box("stpp",(function(o){s=!0,o.parser.stop()})).parse(o),!s)throw new N(2,2,2007)},by.prototype.setSequenceMode=function(){},by.prototype.parseMedia=function(o,s){var m=this,_=!1,S=[];if((new Gf).box("mdat",Pf((function(o){_=!0,S=S.concat(m.g.parseMedia(o,s))}))).parse(o,!1),!_)throw new N(2,2,2007);return S},L("shaka.text.Mp4TtmlParser",by),by.prototype.parseMedia=by.prototype.parseMedia,by.prototype.setSequenceMode=by.prototype.setSequenceMode,by.prototype.parseInit=by.prototype.parseInit,rn['application/mp4; codecs="stpp"']=function(){return new by},rn['application/mp4; codecs="stpp.ttml"']=function(){return new by},rn['application/mp4; codecs="stpp.ttml.im1t"']=function(){return new by},rn['application/mp4; codecs="stpp.TTML.im1t"']=function(){return new by},cy.prototype.parseInit=function(){},cy.prototype.setSequenceMode=function(o){this.g=o},cy.prototype.parseMedia=function(o,s){var m=(o=(o=xf(o)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(m[0]))throw new N(2,2,2e3);if(o=s.vttOffset,m[0].includes("X-TIMESTAMP-MAP")&&this.g){var _=m[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),S=m[0].match(/MPEGTS:(\d+)/m);if(_&&S){if(null==(o=dy(new Hr(_[1]))))throw new N(2,2,2e3);for(S=Number(S[1]),_=s.segmentStart-s.periodStart;95443.7176888889<=_;)_-=95443.7176888889,S+=8589934592;o=s.periodStart+S/9e4-o}}for(s=[],_=(S=t(m[0].split("\n"))).next();!_.done;_=S.next())if(_=_.value,/^Region:/.test(_)){_=new Hr(_);var E=new zb;Kr(_),Ir(_);for(var A=Kr(_);A;){var O=E,H=A;(A=/^id=(.*)$/.exec(H))?O.id=A[1]:(A=/^width=(\d{1,2}|100)%$/.exec(H))?O.width=Number(A[1]):(A=/^lines=(\d+)$/.exec(H))?(O.height=Number(A[1]),O.i=2):(A=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(H))?(O.m=Number(A[1]),O.o=Number(A[2])):(A=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(H))?(O.g=Number(A[1]),O.h=Number(A[2])):/^scroll=up$/.exec(H)&&(O.s="up"),Ir(_),A=Kr(_)}s.push(E)}for(ey(S=new Map),_=[],E=(m=t(m.slice(1))).next();!E.done;E=m.next()){if((1!=(E=E.value.split("\n")).length||E[0])&&!/^NOTE($|[ \t])/.test(E[0])&&"STYLE"==E[0]){for(O=[],A=-1,H=1;H<E.length;H++)E[H].includes("::cue")&&(O.push([]),A=O.length-1),-1!=A&&(O[A].push(E[H]),E[H].includes("}")&&(A=-1));for(A=(O=t(O)).next();!A.done;A=O.next()){var K=A.value;A="global",(H=K[0].match(/\((.*)\)/))&&(A=H.pop()),H=K.slice(1,-1),K[0].includes("}")&&(K=/\{(.*?)\}/.exec(K[0]))&&(H=K[1].split(";")),(K=S.get(A))||(K=new yb(0,0,""));for(var z=!1,G=0;G<H.length;G++){var q=/^\s*([^:]+):\s*(.*)/.exec(H[G]);if(q){var X=q[2].trim().replace(";","");switch(q[1].trim()){case"background-color":case"background":z=!0,K.backgroundColor=X;break;case"color":z=!0,K.j=X;break;case"font-family":z=!0,K.l=X;break;case"font-size":z=!0,K.A=X;break;case"font-weight":(700<=parseInt(X,10)||"bold"==X)&&(z=!0,K.u=700);break;case"font-style":switch(X){case"normal":z=!0,K.o=ut;break;case"italic":z=!0,K.o="italic";break;case"oblique":z=!0,K.o="oblique"}break;case"opacity":z=!0,K.C=parseFloat(X);break;case"text-shadow":z=!0,K.I=X;break;case"white-space":z=!0,K.M="noWrap"!=X}}}z&&S.set(A,K)}}if(z=o,1==E.length&&!E[0]||/^NOTE($|[ \t])/.test(E[0])||"STYLE"==E[0]||"REGION"==E[0])E=null;else if(O=null,E[0].includes("--\x3e")||(O=E[0],E.splice(0,1)),H=dy(A=new Hr(E[0])),G=Jr(A,/[ \t]+--\x3e[ \t]+/g),K=dy(A),null==H||null==G||null==K)$a("Failed to parse VTT time code. Cue skipped:",O,E),E=null;else{for(H+=z,K+=z,z=E.slice(1).join("\n").trim(),S.has("global")?((E=S.get("global").clone()).startTime=H,E.endTime=K,E.U=""):E=new yb(H,K,""),fy(z,E,S),Ir(A),H=Kr(A);H;)gy(E,H,s),Ir(A),H=Kr(A);null!=O&&(E.id=O)}E&&_.push(E)}return _},L("shaka.text.VttTextParser",cy),cy.prototype.parseMedia=cy.prototype.parseMedia,cy.prototype.setSequenceMode=cy.prototype.setSequenceMode,cy.prototype.parseInit=cy.prototype.parseInit;var u_=/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g;function my(){this.g=null}function ny(o,s,m){var _,S,E;return(new Gf).box("payl",Pf((function(o){_=xf(o)}))).box("iden",Pf((function(o){S=xf(o)}))).box("sttg",Pf((function(o){E=xf(o)}))).parse(o),_?function oy(o,s,m,_,S){if(_=new yb(_,S,""),fy(o,_,new Map),s&&(_.id=s),m)for(o=new Hr(m),s=Kr(o);s;)gy(_,s,[]),Ir(o),s=Kr(o);return _}(_,S,E,s,m):null}function py(){}function qy(o){if(null==(o=Jr(o,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g)))return null;var s=Number(o[2]),m=Number(o[3]);return 59<s||59<m?null:Number(o[4])/1e3+m+60*s+3600*(Number(o[1])||0)}function ry(){this.g=new cy}function sy(o){var s="WEBVTT\n\n";if(""==o)return s;for(var m=(o=t((o=(o=o.replace(/\r+/g,"")).trim()).split("\n\n"))).next();!m.done;m=o.next())(m=m.value.split(/\n/))[0].match(/\d+/)&&m.shift(),m[0]=m[0].replace(/,/g,"."),s+=m.join("\n").replace(/{b}/g,"<b>").replace(/{\/b}/g,"</b>").replace(/{i}/g,"<i>").replace(/{\/i}/g,"</i>").replace(/{u}/g,"<u>").replace(/{\/u}/g,"</u>")+"\n\n";return s}function ty(){}function yy(o,s){var m=s.Fontname;if(m&&(o.l=m),(m=s.Fontsize)&&(o.A=m+"px"),(m=s.PrimaryColour)&&(m=zy(m))&&(o.j=m),(m=s.BackColour)&&(m=zy(m))&&(o.backgroundColor=m),s.Bold&&(o.u=700),s.Italic&&(o.o="italic"),s.Underline&&o.h.push("underline"),(m=s.Spacing)&&(o.W=m+"px"),m=s.Alignment)switch(parseInt(m,10)){case 1:o.i=Ee,o.textAlign="start";break;case 2:o.i=Ee,o.textAlign=_e;break;case 3:o.i=Ee,o.textAlign="end";break;case 5:o.i="before",o.textAlign="start";break;case 6:o.i="before",o.textAlign=_e;break;case 7:o.i="before",o.textAlign="end";break;case 9:o.i="center",o.textAlign="start";break;case 10:o.i="center",o.textAlign=_e;break;case 11:o.i="center",o.textAlign="end"}(s=s.AlphaLevel)&&(o.C=parseFloat(s))}function zy(o){return 0<=(o=parseInt(o.replace("&H",""),16))?"rgba("+(255&o)+","+(o>>8&255)+","+(o>>16&255)+","+(o>>24&255^255)/255+")":null}function xy(o){return 3600*((o=h_.exec(o))[1]?parseInt(o[1].replace(":",""),10):0)+60*parseInt(o[2],10)+parseFloat(o[3])}rn["text/vtt"]=function(){return new cy},rn['text/vtt; codecs="vtt"']=function(){return new cy},rn['text/vtt; codecs="wvtt"']=function(){return new cy},my.prototype.parseInit=function(o){var s=this,m=!1;if((new Gf).box("moov",Lf).box("trak",Lf).box("mdia",Lf).O("mdhd",(function(o){o=Kh(o.reader,o.version),s.g=o.timescale})).box("minf",Lf).box("stbl",Lf).O("stsd",Nf).box("wvtt",(function(){m=!0})).parse(o),!this.g)throw new N(2,2,2008);if(!m)throw new N(2,2,2008)},my.prototype.setSequenceMode=function(){},my.prototype.parseMedia=function(o,s){if(!o.length)return[];if(!this.g)throw new N(2,2,2008);var m,_=0,S=[],E=[],A=!1,O=!1,H=!1,K=null;if((new Gf).box("moof",Lf).box("traf",Lf).O("tfdt",(function(o){A=!0,_=Jh(o.reader,o.version).baseMediaDecodeTime})).O("tfhd",(function(o){K=Ih(o.reader,o.flags).ef})).O("trun",(function(o){O=!0,S=Lh(o.reader,o.version,o.flags).Bf})).box("mdat",Pf((function(o){H=!0,m=o}))).parse(o,!1),!H&&!A&&!O)throw new N(2,2,2008);o=_;for(var z=new Df(m,0),G=t(S),q=G.next();!q.done;q=G.next()){var X=(q=q.value).Ge||K,J=q.Ld?_+q.Ld:o;o=J+(X||0);var ae=0;do{var pe=z.K();ae+=pe;var me=null;"vttc"==Kf(z.K())?8<pe&&(me=z.kb(pe-8)):z.skip(pe-8),X&&me&&(pe=ny(me,s.periodStart+J/this.g,s.periodStart+o/this.g),E.push(pe))}while(q.sampleSize&&ae<q.sampleSize)}return E.filter(tc)},L("shaka.text.Mp4VttParser",my),my.prototype.parseMedia=my.prototype.parseMedia,my.prototype.setSequenceMode=my.prototype.setSequenceMode,my.prototype.parseInit=my.prototype.parseInit,rn['application/mp4; codecs="wvtt"']=function(){return new my},py.prototype.parseInit=function(){},py.prototype.setSequenceMode=function(){},py.prototype.parseMedia=function(o){var s=xf(o).replace(/\r+/g,"");if(o=[],""==(s=s.trim()))return o;for(var m=(s=t(s.split("\n\n"))).next();!m.done;m=s.next()){var _=new Hr((m=m.value.split("\n"))[0]),S=qy(_),E=Jr(_,/,/g);if(_=qy(_),null==S||null==E||null==_)throw new N(2,2,2001,"Could not parse cue time range in SubViewer");o.push(new yb(S,_,m.slice(1).join("\n").trim()))}return o},L("shaka.text.SbvTextParser",py),py.prototype.parseMedia=py.prototype.parseMedia,py.prototype.setSequenceMode=py.prototype.setSequenceMode,py.prototype.parseInit=py.prototype.parseInit,rn["text/x-subviewer"]=function(){return new py},ry.prototype.parseInit=function(){},ry.prototype.setSequenceMode=function(){},ry.prototype.parseMedia=function(o,s){return o=M(Bf(o=sy(o=xf(o)))),this.g.parseMedia(o,s)},L("shaka.text.SrtTextParser",ry),ry.srt2webvtt=sy,ry.prototype.parseMedia=ry.prototype.parseMedia,ry.prototype.setSequenceMode=ry.prototype.setSequenceMode,ry.prototype.parseInit=ry.prototype.parseInit,rn["text/srt"]=function(){return new ry},ty.prototype.parseInit=function(){},ty.prototype.setSequenceMode=function(){},ty.prototype.parseMedia=function(o){for(var s="",m="",_=(o=t(o=xf(o).split(/\r?\n\s*\r?\n/))).next();!_.done;_=o.next()){var S=l_.exec(_.value);S&&(_=S[1],S=S[2],"V4 Styles"==_||"V4+ Styles"==_?s=S:"Events"==_&&(m=S))}o=[],_=null;for(var E=(s=t(s.split(/\r?\n/))).next();!E.done;E=s.next())if(S=E.value,!/^\s*;/.test(S)&&(E=c_.exec(S)))if(S=E[1].trim(),E=E[2].trim(),"Format"==S)_=E.split(d_);else if("Style"==S){S=E.split(d_),E={};for(var A=0;A<_.length&&A<S.length;A++)E[_[A]]=S[A];o.push(E)}for(_=[],s=null,S={},E=(m=t(m.split(/\r?\n/))).next();!E.done;S={Vd:S.Vd},E=m.next())if(E=E.value,!/^\s*;/.test(E)&&(A=c_.exec(E)))if(E=A[1].trim(),A=A[2].trim(),"Format"==E)s=A.split(d_);else if("Dialogue"==E){A=A.split(d_),E={};for(var O=0;O<s.length&&O<A.length;O++)E[s[O]]=A[O];A=new yb(O=xy(E.Start),xy(E.End),A.slice(s.length-1).join(",").replace(/\\N/g,"\n").replace(/\{[^}]+\}/g,"")),S.Vd=E.Style,(E=o.find(function(o){return function(s){return s.Name==o.Vd}}(S)))&&yy(A,E),_.push(A)}return _},L("shaka.text.SsaTextParser",ty),ty.prototype.parseMedia=ty.prototype.parseMedia,ty.prototype.setSequenceMode=ty.prototype.setSequenceMode,ty.prototype.parseInit=ty.prototype.parseInit;var l_=/^\s*\[([^\]]+)\]\r?\n([\s\S]*)/,c_=/^\s*([^:]+):\s*(.*)/,d_=/\s*,\s*/,h_=/^(\d+:)?(\d{1,2}):(\d{1,2}(?:[.]\d{1,3})?)?$/;function By(o,s){var m=1&o[s+1]?7:9;return s+m<=o.length&&0<(o=((3&o[s+3])<<11|o[s+4]<<3|(224&o[s+5])>>>5)-m)?{vd:m,P:o}:null}function Cy(o,s){var m=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],_=(60&o[s+2])>>>2;if(_>m.length-1)return null;var S=1+((192&o[s+2])>>>6),E=(1&o[s+2])<<2;return E|=(192&o[s+3])>>>6,{sampleRate:m[_],channelCount:E,Pa:"mp4a.40."+S}}function Dy(o,s){if(s+1<o.length&&255===o[s]&&240==(246&o[s+1])){var m=1&o[s+1]?7:9;if(s+m>=o.length)return!1;var _=(3&o[s+3])<<11|o[s+4]<<3|(224&o[s+5])>>>5;return!(_<=m)&&((s+=_)===o.length||s+1<o.length&&255===o[s]&&240==(246&o[s+1]))}return!1}function Ey(o){this.i=o,this.h=0,this.g=new Map}function Fy(o,s){if(s+8>o.length||11!==o[s]||119!==o[s+1])return null;var m=o[s+4]>>6;if(3<=m)return null;var _=63&o[s+4],S=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*_+m];if(s+S>o.length)return null;var E=o[s+6]>>5,A=0;2===E?A+=2:(1&E&&1!==E&&(A+=2),4&E&&(A+=2)),A=(o[s+6]<<8|o[s+7])>>12-A&1;var O=7&o[s+5];return o=new Uint8Array([m<<6|o[s+5]>>3<<1|O>>2,(3&O)<<6|E<<3|A<<2|_>>4,_<<4&224]),{sampleRate:[48e3,44100,32e3][m],channelCount:[2,1,2,3,3,4,4,5][E]+A,ca:o,P:S}}function Gy(o,s){if(11===o[s]&&119===o[s+1]){var m,_,S=0,E=5;for(s+=E;0<E;){_=o[s];var A=Math.min(E,8),O=8-A;m=(_&(m=4278190080>>>24+O<<O))>>O,S=S?S<<A|m:m,s+=1,E-=A}if(16>S)return!0}return!1}function Hy(o){this.i=o,this.h=0,this.g=new Map}function Iy(o,s){if(s+8>o.length||2935!=(o[s]<<8|o[s+1]<<0))return null;var m=new Qh(o.subarray(s+2));Sh(m,2),Sh(m,3);var _=Th(m,11)+1<<1,S=Th(m,2);if(3==S){S=[24e3,22060,16e3][S=Th(m,2)];var E=3}else S=[48e3,44100,32e3][S],E=Th(m,2);var A=Th(m,3),O=Th(m,1);return m=Th(m,5),s+_>o.byteLength?null:(o=Math.floor(_*S/(16*[1,2,3,6][E])),o=new Uint8Array([(8160&o)>>5,(31&o)<<3,S<<6|m<<1|0,0|A<<1|O<<0,0]),{sampleRate:S,channelCount:[2,1,2,3,3,4,4,5][A]+O,ca:o,P:_})}function Jy(o){this.i=o,this.h=0,this.g=new Map}function My(o){for(var s=!1,m=new Uint8Array([]),_=o.find((function(o){return 7==o.type})),S=!1,E=(o=t(o)).next();!E.done;E=o.next()){var A=!1;switch((E=E.value).type){case 1:A=S=!0;var O=E.data;_&&4<O.length&&(2===(O=Yh(new Qh(O)))||4===O||7===O||9===O)&&(s=!0);break;case 5:s=A=S=!0;break;case 6:case 7:case 8:case 12:A=!0;break;case 9:S=A=!0;break;default:A=!1}S&&A&&(A=E.bb.byteLength,(O=new Uint8Array(4))[0]=A>>24&255,O[1]=A>>16&255,O[2]=A>>8&255,O[3]=255&A,m=Wf(m,O,E.bb))}return m.byteLength?{data:m,tf:s}:null}rn["text/x-ssa"]=function(){return new ty},(_=Ey.prototype).destroy=function(){this.g.clear()},_.isSupported=function(o){return"audio/aac"==o.toLowerCase().split(";")[0]&&gb(this.convertCodecs("audio",o))},_.convertCodecs=function(o,s){return"audio/aac"==s.toLowerCase().split(";")[0]?'audio/mp4; codecs="'+(Jc(s)||"mp4a.40.2")+'"':s},_.getOrginalMimeType=function(){return this.i},_.transmux=function(o,s,m,_){for(var S=M(o),E=Hh(S),A=E.length;A<S.length&&!Dy(S,A);A++);if(o=1e3*m.endTime,(E=Gh(E)).length&&m&&(m=E.find((function(o){return"com.apple.streaming.transportStreamTimestamp"===o.description})))&&(o=m.data),!(E=Cy(S,A)))return Promise.reject(new N(2,3,3018));for(s.audioSamplingRate=E.sampleRate,s.channelsCount=E.channelCount,s.codecs=E.Pa,m=[];A<S.length;){var O=By(S,A);if(!O)return Promise.reject(new N(2,3,3018));var H=O.vd+O.P;A+H<=S.length&&m.push({data:S.subarray(A+O.vd,A+H),size:O.P,duration:1024,ab:0,flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:2,hb:0}}),A+=H}return S=E.sampleRate,o=Math.floor(o*S/1e3),o=new $s([_={id:s.id,type:"audio",encrypted:s.encrypted&&0<s.drmInfos.length,timescale:S,duration:_,Ka:[],ca:new Uint8Array([]),na:new Uint8Array([]),data:{mb:this.h,baseMediaDecodeTime:o,Ja:m},stream:s}]),this.g.has(s.id)?_=this.g.get(s.id):(_=o.initSegment(),this.g.set(s.id,_)),s=tt(o),this.h++,s=Wf(_,s),Promise.resolve(s)},L("shaka.transmuxer.AacTransmuxer",Ey),Ey.prototype.transmux=Ey.prototype.transmux,Ey.prototype.getOrginalMimeType=Ey.prototype.getOrginalMimeType,Ey.prototype.convertCodecs=Ey.prototype.convertCodecs,Ey.prototype.isSupported=Ey.prototype.isSupported,Ey.prototype.destroy=Ey.prototype.destroy,Tb("audio/aac",(function(){return new Ey("audio/aac")}),gt),(_=Hy.prototype).destroy=function(){this.g.clear()},_.isSupported=function(o){return"audio/ac3"==o.toLowerCase().split(";")[0]&&gb(this.convertCodecs("audio",o))},_.convertCodecs=function(o,s){return"audio/ac3"==s.toLowerCase().split(";")[0]?'audio/mp4; codecs="ac-3"':s},_.getOrginalMimeType=function(){return this.i},_.transmux=function(o,s,m,_){for(var S=Hh(o=M(o)),E=S.length;E<o.length&&!Gy(o,E);E++);var A=1e3*m.endTime;(S=Gh(S)).length&&m&&(m=S.find((function(o){return"com.apple.streaming.transportStreamTimestamp"===o.description})))&&(A=m.data),m=0,S=new Uint8Array([]);for(var O=[];E<o.length;){var H=Fy(o,E);if(!H)return Promise.reject(new N(2,3,3018));s.audioSamplingRate=H.sampleRate,s.channelsCount=H.channelCount,m=H.sampleRate,S=H.ca,O.push({data:o.subarray(E,E+H.P),size:H.P,duration:1536,ab:0,flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:2,hb:0}}),E+=H.P}return o=Math.floor(A*m/1e3),o=new $s([_={id:s.id,type:"audio",encrypted:s.encrypted&&0<s.drmInfos.length,timescale:m,duration:_,Ka:[],ca:S,na:new Uint8Array([]),data:{mb:this.h,baseMediaDecodeTime:o,Ja:O},stream:s}]),this.g.has(s.id)?_=this.g.get(s.id):(_=o.initSegment(),this.g.set(s.id,_)),s=tt(o),this.h++,s=Wf(_,s),Promise.resolve(s)},L("shaka.transmuxer.Ac3Transmuxer",Hy),Hy.prototype.transmux=Hy.prototype.transmux,Hy.prototype.getOrginalMimeType=Hy.prototype.getOrginalMimeType,Hy.prototype.convertCodecs=Hy.prototype.convertCodecs,Hy.prototype.isSupported=Hy.prototype.isSupported,Hy.prototype.destroy=Hy.prototype.destroy,Tb("audio/ac3",(function(){return new Hy("audio/ac3")}),gt),(_=Jy.prototype).destroy=function(){this.g.clear()},_.isSupported=function(o){return"audio/ec3"==o.toLowerCase().split(";")[0]&&gb(this.convertCodecs("audio",o))},_.convertCodecs=function(o,s){return"audio/ec3"==s.toLowerCase().split(";")[0]?'audio/mp4; codecs="ec-3"':s},_.getOrginalMimeType=function(){return this.i},_.transmux=function(o,s,m,_){for(var S=Hh(o=M(o)),E=S.length;E<o.length&&2935!=(o[E]<<8|o[E+1]<<0);E++);var A=1e3*m.endTime;(S=Gh(S)).length&&m&&(m=S.find((function(o){return"com.apple.streaming.transportStreamTimestamp"===o.description})))&&(A=m.data),m=0,S=new Uint8Array([]);for(var O=[];E<o.length;){var H=Iy(o,E);if(!H)return Promise.reject(new N(2,3,3018));s.audioSamplingRate=H.sampleRate,s.channelsCount=H.channelCount,m=H.sampleRate,S=H.ca,O.push({data:o.subarray(E,E+H.P),size:H.P,duration:1536,ab:0,flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:2,hb:0}}),E+=H.P}return o=Math.floor(A*m/1e3),o=new $s([_={id:s.id,type:"audio",encrypted:s.encrypted&&0<s.drmInfos.length,timescale:m,duration:_,Ka:[],ca:S,na:new Uint8Array([]),data:{mb:this.h,baseMediaDecodeTime:o,Ja:O},stream:s}]),this.g.has(s.id)?_=this.g.get(s.id):(_=o.initSegment(),this.g.set(s.id,_)),s=tt(o),this.h++,s=Wf(_,s),Promise.resolve(s)},L("shaka.transmuxer.Ec3Transmuxer",Jy),Jy.prototype.transmux=Jy.prototype.transmux,Jy.prototype.getOrginalMimeType=Jy.prototype.getOrginalMimeType,Jy.prototype.convertCodecs=Jy.prototype.convertCodecs,Jy.prototype.isSupported=Jy.prototype.isSupported,Jy.prototype.destroy=Jy.prototype.destroy,Tb("audio/ec3",(function(){return new Jy("audio/ec3")}),gt);var p_=[100,110,122,244,44,83,86,118,128,138,139,134];function Ny(o,s){var m=o[s+1]>>3&3,_=o[s+1]>>1&3,S=o[s+2]>>4&15,E=o[s+2]>>2&3;if(1!==m&&0!==S&&15!==S&&3!==E){var A=o[s+3]>>6;S=1e3*f_[14*(3===m?3-_:3===_?3:4)+S-1],E=g_[3*(3===m?0:2===m?1:2)+E],m=m_[m][_];var O=y_[_],H=Math.floor(m*S/E+(o[s+2]>>1&1))*O,K=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);return(K=K?parseInt(K[1],10):0)&&87>=K&&2===_&&224e3<=S&&0===A&&(o[s+3]|=128),{sampleRate:E,channelCount:3===A?1:2,P:H,fh:8*m*O}}return null}function Sy(o,s){return 255===o[s]&&224==(224&o[s+1])&&0!=(6&o[s+1])}var f_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],g_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],m_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],y_=[0,1,1,4];function Ty(o){this.i=o,this.h=0,this.g=new Map}function Uy(o){this.h=o,this.g=null}
/*
   @license
   MSS Transmuxer
   Copyright 2015 Dash Industry Forum
   SPDX-License-Identifier: BSD-3-Clause
  */
function Vy(o){this.h=o,(this.g=hh.get("ISOBoxer")())&&function Wy(o){function b(){this._procFullBox(),1&this.flags&&(this._procField("AlgorithmID","uint",24),this._procField("IV_size","uint",8),this._procFieldArray("KID",16,"uint",8)),this._procField("sample_count","uint",32),this._procEntries("entry",this.sample_count,(function(o){this._procEntryField(o,"InitializationVector","data",8),2&this.flags&&(this._procEntryField(o,"NumberOfEntries","uint",16),this._procSubEntries(o,"clearAndCryptedData",o.NumberOfEntries,(function(o){this._procEntryField(o,"BytesOfClearData","uint",16),this._procEntryField(o,"BytesOfEncryptedData","uint",32)})))}))}o.g.addBoxProcessor("saio",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("entry_count","uint",32),this._procFieldArray("offset",this.entry_count,"uint",1===this.version?64:32)})),o.g.addBoxProcessor("saiz",(function(){this._procFullBox(),1&this.flags&&(this._procField("aux_info_type","uint",32),this._procField("aux_info_type_parameter","uint",32)),this._procField("default_sample_info_size","uint",8),this._procField("sample_count","uint",32),0===this.default_sample_info_size&&this._procFieldArray("sample_info_size",this.sample_count,"uint",8)})),o.g.addBoxProcessor("senc",b),o.g.addBoxProcessor("uuid",(function(){for(var o=!0,s=0;16>s;s++)this.usertype[s]!==v_[s]&&(o=!1);o&&(this._parsing&&(this.type="sepiff"),b.call(this))}))}(this)}function Yy(o,s){for(var m=8,_=0;_<o.boxes.length&&o.boxes[_].type!==s;_++)m+=o.boxes[_].size;return m}(_=Ty.prototype).destroy=function(){this.g.clear()},_.isSupported=function(o){return"audio/mpeg"==o.toLowerCase().split(";")[0]&&gb(this.convertCodecs("audio",o))},_.convertCodecs=function(o,s){return"audio/mpeg"==s.toLowerCase().split(";")[0]?'audio/mp4; codecs="mp3"':s},_.getOrginalMimeType=function(){return this.i},_.transmux=function(o,s,m,_){for(m=Hh(o=M(o)).length;m<o.length;m++){var S=m;if(S+1<o.length&&Sy(o,S)){var E=Ny(o,S),A=4;E&&E.P&&(A=E.P),S=(S+=A)===o.length||S+1<o.length&&Sy(o,S)}else S=!1;if(S)break}var O;for(S=[];m<o.length;){if(!(E=Ny(o,m)))return Promise.reject(new N(2,3,3018));O||(O=E),m+E.P<=o.length&&S.push({data:o.subarray(m,m+E.P),size:E.P,duration:1152,ab:0,flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:2,hb:0}}),m+=E.P}return O?(o=9e4*O.fh/O.sampleRate*this.h,O=new $s([_={id:s.id,type:"audio",encrypted:s.encrypted&&0<s.drmInfos.length,timescale:O.sampleRate,duration:_,Ka:[],ca:new Uint8Array([]),na:new Uint8Array([]),data:{mb:this.h,baseMediaDecodeTime:o,Ja:S},stream:s}]),this.g.has(s.id)?_=this.g.get(s.id):(_=O.initSegment(),this.g.set(s.id,_)),s=tt(O),this.h++,s=Wf(_,s),Promise.resolve(s)):Promise.reject(new N(2,3,3018))},L("shaka.transmuxer.Mp3Transmuxer",Ty),Ty.prototype.transmux=Ty.prototype.transmux,Ty.prototype.getOrginalMimeType=Ty.prototype.getOrginalMimeType,Ty.prototype.convertCodecs=Ty.prototype.convertCodecs,Ty.prototype.isSupported=Ty.prototype.isSupported,Ty.prototype.destroy=Ty.prototype.destroy,Tb("audio/mpeg",(function(){return new Ty("audio/mpeg")}),gt),(_=Uy.prototype).destroy=function(){},_.isSupported=function(o){if("video/mp2t"!=o.toLowerCase().split(";")[0])return!1;var s=Jc(o).split(","),m=xc("audio",s);return s=xc("video",s),!(!m||s||"mp3"!=Hc(m))&&gb(this.convertCodecs("audio",o))},_.convertCodecs=function(o,s){return"video/mp2t"==s.toLowerCase().split(";")[0]?"audio/mpeg":s},_.getOrginalMimeType=function(){return this.h},_.transmux=function(o){this.g?this.g.clearData():this.g=new Zh,o=M(o);var s=this.g.parse(o);if("mp3"!=(o=s.od()).audio||o.video)return Promise.reject(new N(2,3,3018));o=new Uint8Array([]);for(var m=(s=t(s.Xb())).next();!m.done;m=s.next())if(m=m.value.data)for(var _=0;_<m.length;){var S=Ny(m,_);S?(_+S.P<=m.length&&(o=Wf(o,m.subarray(_,_+S.P))),_+=S.P):_++}return Promise.resolve(o)},L("shaka.transmuxer.MpegTsTransmuxer",Uy),Uy.prototype.transmux=Uy.prototype.transmux,Uy.prototype.getOrginalMimeType=Uy.prototype.getOrginalMimeType,Uy.prototype.convertCodecs=Uy.prototype.convertCodecs,Uy.prototype.isSupported=Uy.prototype.isSupported,Uy.prototype.destroy=Uy.prototype.destroy,Tb("video/mp2t",(function(){return new Uy("video/mp2t")}),_t),(_=Vy.prototype).destroy=function(){},_.isSupported=function(o,s){var m=o.startsWith("mss/");return!(!this.g||!m)&&(s?gb(this.convertCodecs(s,o)):(s=this.convertCodecs("audio",o),o=this.convertCodecs("video",o),gb(s)||gb(o)))},_.convertCodecs=function(o,s){return s.replace("mss/","")},_.getOrginalMimeType=function(){return this.h},_.transmux=function(o,s,m){if(!m)return Promise.resolve(M(o));if(!s.mssPrivateData)return Promise.reject(new N(2,3,3020));try{var _,S=this.g.parseBuffer(o),E=S.fetch("tfhd");E.track_ID=s.id+1;var A=S.fetch("tfdt"),O=S.fetch("traf");null===A&&((A=this.g.createFullBox("tfdt",O,E)).version=1,A.flags=0,A.baseMediaDecodeTime=Math.floor(m.startTime*s.mssPrivateData.timescale));var H=S.fetch("trun"),K=S.fetch("tfxd");K&&K._parent.boxes.splice(K._parent.boxes.indexOf(K),1);var z=S.fetch("tfrf");z&&z._parent.boxes.splice(z._parent.boxes.indexOf(z),1);var G=S.fetch("sepiff");if(null!==G){G.type="senc",G.usertype=void 0;var q=S.fetch("saio");if(null===q){(q=this.g.createFullBox("saio",O)).version=0,q.flags=0,q.entry_count=1,q.offset=[0];var X=this.g.createFullBox("saiz",O);if(X.version=0,X.flags=0,X.sample_count=G.sample_count,X.default_sample_info_size=0,X.sample_info_size=[],2&G.flags)for(_=0;_<G.sample_count;_+=1)X.sample_info_size[_]=10+6*G.entry[_].NumberOfEntries;else X.default_sample_info_size=8}}E.flags&=16777214,E.flags|=131072,H.flags|=1;var J=S.fetch("moof");H.data_offset=J.getLength()+8;var ae=S.fetch("saio");null!==ae&&(ae.offset[0]=Yy(J,"traf")+Yy(O,"senc")+16);var pe=M(S.write());return Promise.resolve(pe)}catch(o){return o instanceof N?Promise.reject(o):Promise.reject(new N(2,3,3022))}},L("shaka.transmuxer.MssTransmuxer",Vy),Vy.prototype.transmux=Vy.prototype.transmux,Vy.prototype.getOrginalMimeType=Vy.prototype.getOrginalMimeType,Vy.prototype.convertCodecs=Vy.prototype.convertCodecs,Vy.prototype.isSupported=Vy.prototype.isSupported,Vy.prototype.destroy=Vy.prototype.destroy;var v_=new Uint8Array([162,57,79,82,90,155,79,20,162,68,108,66,124,100,141,244]);function Zy(o){var s=this;this.m=o,this.j=hh.get("muxjs")(),this.h=this.g=null,this.l=[],this.i=!1,this.j&&(this.g=new this.j.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.g.on("data",(function(o){s.l.push(Wf(o.initSegment,o.data))})),this.g.on("done",(function(){var o=Wf.apply(Qf,v(s.l));s.h.resolve(o),s.i=!1})))}function $y(o,s){if(s=s.replace(/mp2t/i,"mp4"),"audio"==o&&(s=s.replace("video","audio")),o=/avc1\.(66|77|100)\.(\d+)/.exec(s)){var m="avc1.",_=o[1],S=Number(o[2]);m=("66"==_?m+"4200":"77"==_?m+"4d00":m+"6400")+(S>>4).toString(16),m+=(15&S).toString(16),s=s.replace(o[0],m)}return s}function az(o){this.j=o,this.g=0,this.h=new Map,this.i=null}Tb("mss/audio/mp4",(function(){return new Vy("mss/audio/mp4")}),gt),Tb("mss/video/mp4",(function(){return new Vy("mss/video/mp4")}),gt),(_=Zy.prototype).destroy=function(){this.g&&this.g.dispose(),this.g=null},_.isSupported=function(o,s){var m="mp2t"==o.toLowerCase().split(";")[0].split("/")[1];return!(!this.j||!m)&&(s?gb($y(s,o)):(s=$y("audio",o),o=$y("video",o),gb(s)||gb(o)))},_.convertCodecs=function(o,s){return"mp2t"==s.toLowerCase().split(";")[0].split("/")[1]?$y(o,s):s},_.getOrginalMimeType=function(){return this.m},_.transmux=function(o){return this.i=!0,this.h=new Je,this.l=[],o=M(o),this.g.push(o),this.g.flush(),this.i&&this.h.reject(new N(2,3,3018)),this.h},L("shaka.transmuxer.MuxjsTransmuxer",Zy),Zy.prototype.transmux=Zy.prototype.transmux,Zy.prototype.getOrginalMimeType=Zy.prototype.getOrginalMimeType,Zy.prototype.convertCodecs=Zy.prototype.convertCodecs,Zy.prototype.isSupported=Zy.prototype.isSupported,Zy.prototype.destroy=Zy.prototype.destroy,Tb("video/mp2t",(function(){return new Zy("video/mp2t")}),gt),(_=az.prototype).destroy=function(){this.h.clear()},_.isSupported=function(o,s){if("video/mp2t"!=o.toLowerCase().split(";")[0])return!1;var m=Jc(o).split(","),_=xc("audio",m);return m=xc("video",m),!(_&&m||_&&(_=Hc(_),!T_.includes(_))||m&&(_=Hc(m),!k_.includes(_)))&&(s?gb(this.convertCodecs(s,o)):(s=this.convertCodecs("audio",o),o=this.convertCodecs("video",o),gb(s)||gb(o)))},_.convertCodecs=function(o,s){return"video/mp2t"==s.toLowerCase().split(";")[0]?(s=Jc(s).replace("mp4a.40.34","mp3"),"audio"==o?'audio/mp4; codecs="'+s+'"':'video/mp4; codecs="'+s+'"'):s},_.getOrginalMimeType=function(){return this.j},_.transmux=function(o,s,m,_){this.i?this.i.clearData():this.i=new Zh,o=M(o);var S=1e3*m.endTime,E=this.i.parse(o);null!=(m=E.getStartTime()).audio&&(S=m.audio),null!=m.video&&(S=m.video),m=[];var A=E.od();try{if(o=null,"avc"===A.video)o=function dz(o,s,m,_){for(var S=[],E=null,A=[],O=s.mf().filter((function(o){return null!=o.pts&&null!=o.dts})),H=0;H<O.length;H++){var K=O[H],z=void 0;if(H+1<O.length&&(z=O[H+1]),z=s.ze(K,z),A=A.concat(z),z=My(z)){null==E&&null!=K.dts&&(E=K.dts);var G=void 0;G=H+1<O.length?(O[H+1].dts||0)-(K.dts||0):(K.dts||0)-(O[H-1].dts||0),S.push({data:z.data,size:z.data.byteLength,duration:G,ab:Math.round((K.pts||0)-(K.dts||0)),flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:z.tf?2:1,hb:z.tf?0:1}})}}if(s=function Ky(o){if(!o.length)return null;var s=o.find((function(o){return 7==o.type}));if(o=o.find((function(o){return 8==o.type})),!s||!o)return null;var m=new Qh(s.data),_=Th(m,8);if(Th(m,8),Th(m,8),Vh(m),p_.includes(_)&&(3===(_=Wh(m))&&Sh(m,1),Vh(m),Vh(m),Sh(m,1),1===Th(m,1))){_=3!==_?8:12;for(var S=0;S<_;S++)1===Th(m,1)&&Xh(m,6>S?16:64)}if(Vh(m),0===(_=Wh(m)))Wh(m);else if(1===_)for(Sh(m,1),Vh(m),Vh(m),_=Wh(m),S=0;S<_;S++)Vh(m);Vh(m),Sh(m,1),_=Wh(m);var E=Wh(m),A=Th(m,1);0===A&&Sh(m,1),Sh(m,1);var O=S=0,H=0,K=0;return 1===Th(m,1)&&(S=Wh(m),O=Wh(m),H=Wh(m),K=Wh(m)),m=(2-A)*(E+1)*16-2*H-2*K,_=16*(_+1)-2*S-2*O,S=[],s=s.bb,S.push(s.byteLength>>>8&255),S.push(255&s.byteLength),S=S.concat.apply(S,v(s)),s=[],o=o.bb,s.push(o.byteLength>>>8&255),s.push(255&o.byteLength),s=s.concat.apply(s,v(o)),{height:m,width:_,na:o=new Uint8Array([1,S[3],S[4],S[5],255,225].concat(S,[1],s))}}(A),!s||null==E)throw new N(2,3,3018);return m.height=s.height,m.width=s.width,{id:m.id,type:"video",encrypted:m.encrypted&&0<m.drmInfos.length,timescale:9e4,duration:_,Ka:[],ca:new Uint8Array([]),na:s.na,data:{mb:o.g,baseMediaDecodeTime:E,Ja:S},stream:m}}(this,E,s,_);o&&(m.push(o),o=null);var O=!(!A.video||!A.audio);switch(A.audio){case"aac":for(var H,K=S,z=[],G=t(E.Xb()),q=G.next();!q.done;q=G.next()){var X=q.value.data;if(X){if(!(H=Cy(X,E=0)))throw new N(2,3,3018);for(s.audioSamplingRate=H.sampleRate,s.channelsCount=H.channelCount,s.codecs=H.Pa;E<X.length;){var J=By(X,E);if(J){var ae=J.vd+J.P;E+ae<=X.length&&z.push({data:X.subarray(E+J.vd,E+ae),size:J.P,duration:1024,ab:0,flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:2,hb:0}}),E+=ae}else E++}}}if(!H)throw new N(2,3,3018);var pe=H.sampleRate,me=Math.floor(K*pe/1e3),_e=s.id;O&&(_e+=128),o={id:_e,type:"audio",encrypted:s.encrypted&&0<s.drmInfos.length,timescale:pe,duration:_,Ka:[],ca:new Uint8Array([]),na:new Uint8Array([]),data:{mb:this.g,baseMediaDecodeTime:me,Ja:z},stream:s};break;case"ac3":var Se=S,Ee=[],De=0;K=new Uint8Array([]);for(var $e=(z=t(E.Xb())).next();!$e.done;$e=z.next()){var He=$e.value.data;for(E=0;E<He.length;){var et=Fy(He,E);et?(s.audioSamplingRate=et.sampleRate,s.channelsCount=et.channelCount,De=et.sampleRate,K=et.ca,Ee.push({data:He.subarray(E,E+et.P),size:et.P,duration:1536,ab:0,flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:2,hb:0}}),E+=et.P):E++}}if(0==De||0==K.byteLength)throw new N(2,3,3018);var rt=Math.floor(Se*De/1e3),it=s.id;O&&(it+=128),o={id:it,type:"audio",encrypted:s.encrypted&&0<s.drmInfos.length,timescale:De,duration:_,Ka:[],ca:K,na:new Uint8Array([]),data:{mb:this.g,baseMediaDecodeTime:rt,Ja:Ee},stream:s};break;case"ec3":for(K=S,z=[],$e=0,Se=new Uint8Array([]),De=(Ee=t(E.Xb())).next();!De.done;De=Ee.next()){var at=De.value.data;for(E=0;E<at.length;){var ot=Iy(at,E);ot?(s.audioSamplingRate=ot.sampleRate,s.channelsCount=ot.channelCount,$e=ot.sampleRate,Se=ot.ca,z.push({data:at.subarray(E,E+ot.P),size:ot.P,duration:1536,ab:0,flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:2,hb:0}}),E+=ot.P):E++}}if(0==$e||0==Se.byteLength)throw new N(2,3,3018);var st=Math.floor(K*$e/1e3),ut=s.id;O&&(ut+=128),o={id:ut,type:"audio",encrypted:s.encrypted&&0<s.drmInfos.length,timescale:$e,duration:_,Ka:[],ca:Se,na:new Uint8Array([]),data:{mb:this.g,baseMediaDecodeTime:st,Ja:z},stream:s};break;case"mp3":K=S,z=[];for(var ct,dt=t(E.Xb()),ht=dt.next();!ht.done;ht=dt.next()){var pt=ht.value.data;if(pt)for(E=0;E<pt.length;){var gt=Ny(pt,E);gt?(ct||(ct=gt),E+gt.P<=pt.length&&z.push({data:pt.subarray(E,E+gt.P),size:gt.P,duration:1152,ab:0,flags:{gb:0,Va:0,Ua:0,Qa:0,Ra:2,hb:0}}),E+=gt.P):E++}}if(!ct)throw new N(2,3,3018);var _t=ct.sampleRate,bt=Math.floor(K*_t/1e3),kt=s.id;O&&(kt+=128),o={id:kt,type:"audio",encrypted:s.encrypted&&0<s.drmInfos.length,timescale:_t,duration:_,Ka:[],ca:new Uint8Array([]),na:new Uint8Array([]),data:{mb:this.g,baseMediaDecodeTime:bt,Ja:z},stream:s}}o&&m.push(o)}catch(o){return Promise.reject(o)}return m.length?(O=new $s(m),this.h.has(s.id)?_=this.h.get(s.id):(_=O.initSegment(),this.h.set(s.id,_)),s=tt(O),this.g++,s=Wf(_,s),Promise.resolve(s)):Promise.reject(new N(2,3,3018))},L("shaka.transmuxer.TsTransmuxer",az),az.prototype.transmux=az.prototype.transmux,az.prototype.getOrginalMimeType=az.prototype.getOrginalMimeType,az.prototype.convertCodecs=az.prototype.convertCodecs,az.prototype.isSupported=az.prototype.isSupported,az.prototype.destroy=az.prototype.destroy;var b_,S_,T_=["aac","ac-3","ec-3","mp3"],k_=["avc"];
/*
   @license
   EME Encryption Scheme Polyfill
   Copyright 2019 Google LLC
   SPDX-License-Identifier: Apache-2.0
  */
function ez(){}function gz(){b_?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(b_=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=hz):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function hz(o,s){var m,_=this;return I((function(S){return 1==S.g?(console.assert(_==navigator,'bad "this" for requestMediaKeySystemAccess'),C(S,b_.call(_,o,s),2)):iz(m=S.h)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=b_,S.return(m)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=jz,S.return(jz.call(_,o,s)))}))}function jz(o,s){var m,_,S,E,A,O,H,K,z,G,q=this;return I((function(X){if(1==X.g){for(console.assert(q==navigator,'bad "this" for requestMediaKeySystemAccess'),m=kz(o),_=[],S=t(s),E=S.next();!E.done;E=S.next())A=E.value,O=lz(A.videoCapabilities,m),H=lz(A.audioCapabilities,m),A.videoCapabilities&&A.videoCapabilities.length&&!O.length||A.audioCapabilities&&A.audioCapabilities.length&&!H.length||((K=Object.assign({},A)).videoCapabilities=O,K.audioCapabilities=H,_.push(K));if(!_.length)throw(z=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",z.code=DOMException.NOT_SUPPORTED_ERR,z;return C(X,b_.call(q,o,_),2)}return G=X.h,X.return(new mz(G,m))}))}function lz(o,s){return o?o.filter((function(o){return!o.encryptionScheme||o.encryptionScheme==s})):o}function nz(){}function pz(){S_?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(S_=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=qz):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function qz(o){var s,m,_,S=this;return I((function(E){switch(E.g){case 1:return console.assert(S==navigator.mediaCapabilities,'bad "this" for decodingInfo'),C(E,S_.call(S,o),2);case 2:if(s=E.h,!o.keySystemConfiguration)return E.return(s);if((m=s.keySystemAccess)&&iz(m))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=S_,E.return(s);if(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=rz,m){E.B(3);break}return _=s,C(E,sz(o),4);case 4:return _.keySystemAccess=E.h,E.return(s);case 3:return E.return(rz.call(S,o))}}))}function rz(o){var s,m,_,S,E,A,O,H,K=this;return I((function(z){switch(z.g){case 1:return console.assert(K==navigator.mediaCapabilities,'bad "this" for decodingInfo'),s=null,o.keySystemConfiguration&&(m=o.keySystemConfiguration,_=m.keySystem,S=m.audio&&m.audio.encryptionScheme,E=m.video&&m.video.encryptionScheme,s=kz(_),A={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:o},S&&S!=s||E&&E!=s)?z.return(A):C(z,S_.call(K,o),2);case 2:if((O=z.h).keySystemAccess){O.keySystemAccess=new mz(O.keySystemAccess,s),z.B(3);break}if(!o.keySystemConfiguration){z.B(3);break}return H=O,C(z,sz(o),5);case 5:H.keySystemAccess=z.h;case 3:return z.return(O)}}))}function sz(o){var s,m;return I((function(_){if(1==_.g){var S=o.keySystemConfiguration,E=[],A=[];return S.audio&&E.push({robustness:S.audio.robustness||"",contentType:o.audio.contentType}),S.video&&A.push({robustness:S.video.robustness||"",contentType:o.video.contentType}),S={initDataTypes:S.initDataType?[S.initDataType]:[],distinctiveIdentifier:S.distinctiveIdentifier,persistentState:S.persistentState,sessionTypes:S.sessionTypes},E.length&&(S.audioCapabilities=E),A.length&&(S.videoCapabilities=A),s=S,C(_,navigator.requestMediaKeySystemAccess(o.keySystemConfiguration.keySystem,[s]),2)}return m=_.h,_.return(m)}))}function mz(o,s){this.h=o,this.g=s,this.keySystem=o.keySystem}function kz(o){return o.startsWith("com.widevine")||o.startsWith("com.microsoft")||o.startsWith("com.chromecast")||o.startsWith("com.adobe")||o.startsWith("org.w3")?"cenc":o.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",o,"Please contribute!"),null)}function iz(o){var s=(o=o.getConfiguration()).audioCapabilities&&o.audioCapabilities[0];return!(!(o=o.videoCapabilities&&o.videoCapabilities[0]||s)||void 0===o.encryptionScheme)}function tz(){}function Sv(){gz(),pz()}Tb("video/mp2t",(function(){return new az("video/mp2t")}),bt),L("EmeEncryptionSchemePolyfill",ez),ez.install=gz,L("McEncryptionSchemePolyfill",nz),nz.install=pz,mz.prototype.getConfiguration=function(){var o=this.h.getConfiguration();if(o.videoCapabilities)for(var s=t(o.videoCapabilities),m=s.next();!m.done;m=s.next())m.value.encryptionScheme=this.g;if(o.audioCapabilities)for(m=(s=t(o.audioCapabilities)).next();!m.done;m=s.next())m.value.encryptionScheme=this.g;return o},mz.prototype.createMediaKeys=function(){return this.h.createMediaKeys()},L("EncryptionSchemePolyfills",tz),tz.install=Sv,void 0!==m&&m.exports&&(m.exports=tz)}.call(m,s,s,void 0),m.shaka)o[_]=m.shaka[_]}()}(DV);var RV=new Map([["abort","Abort"],["canplay","CanPlay"],["canplaythrough","CanPlayThrough"],["durationchange","DurationChange"],["emptied","Emptied"],["encrypted","Encrypted"],["ended","Ended"],["error","Error"],["interruptbegin","InterruptBegin"],["interruptend","InterruptEnd"],["loadeddata","LoadedData"],["loadedmetadata","LoadedMetadata"],["loadstart","LoadStart"],["pause","Pause"],["play","Play"],["playing","Playing"],["progress","Progress"],["ratechange","Ratechange"],["seeked","Seeked"],["seeking","Seeking"],["stalled","Stalled"],["suspend","Suspend"],["timeupdate","TimeUpdate"],["volumechange","VolumeChange"],["waiting","Waiting"]]);function forceHTTPS$1(o){return"https:"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.location.protocol)?o.replace("http:","https:"):o}function withPrecision(o){return Math.round(1*o)+"px"}var OV=function(){function DependencyRegistry(){_classCallCheck$1(this,DependencyRegistry),this.typeMappings=[],this.dependencyKeys={LogStorage:"LogStorage",API:"API",Store:"Store",Profiling:"Profiling",Logger:"Logger"}}return _createClass$1(DependencyRegistry,[{key:"registerType",value:function registerType(o,s){var m=this.typeMappings.findIndex((function(o){return o.token===s}));-1!==m?this.typeMappings[m]={instance:o,token:s}:this.typeMappings.push({instance:o,token:s})}},{key:"resolveType",value:function resolveType(o){var s=this.typeMappings.find((function(s){return s.token===o}));if(!s)throw new Error("Type registration not found for type ".concat(o));return s.instance}}]),DependencyRegistry}();new OV;var MV=function(){function DebugProxy(){_classCallCheck$1(this,DebugProxy),this._isStarted=!1}return _createClass$1(DebugProxy,[{key:"startProxy",value:function startProxy(o){if(this._isStarted)console.error("Error starting DebugProxy; it is already started");else{o.indexOf(":")<0&&(o+=":8888"),this._isStarted=!0,console.warn("DebugProxy started using proxyAddress=".concat(o));var s="http://".concat(o,"/;"),m=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(_,S,E,A,O){(S=S.toString()).toString().indexOf(o)<0&&(S="".concat(s).concat(S)),m.bind(this)(_,S.toString(),!!E,A,O)};var _=window.fetch;window.fetch=function(m,S){var E=m.toString();return E.toString().indexOf(o)<0&&(E="".concat(s).concat(E)),_(E,S)}}}}]),DebugProxy}();new MV;var FV,NV=function(){function DateTimeService(){_classCallCheck$1(this,DateTimeService)}return _createClass$1(DateTimeService,[{key:"getUTCString",value:function getUTCString(o){return o||(o=new Date),new Date(o).toUTCString()}},{key:"getUTCNow",value:function getUTCNow(){return this.asUTC()}},{key:"asUTC",value:function asUTC(o){return new Date(this.getUTCString(o))}}]),DateTimeService}();!function(o){o[o.ERROR=1]="ERROR",o[o.WARN=2]="WARN",o[o.INFO=3]="INFO",o[o.DEBUG=4]="DEBUG",o[o.PERFORMANCE=5]="PERFORMANCE"}(FV||(FV={}));var UV=function(){function Logger(o){_classCallCheck$1(this,Logger),this.dateTimeService=new NV,this._logLevel=FV.DEBUG,this.logStorage=o}return _createClass$1(Logger,[{key:"LogLevel",get:function get(){return this._logLevel},set:function set(o){this._logLevel=o}},{key:"log",value:function log(o,s){if(o<=this.LogLevel){var m=this.dateTimeService.getUTCNow().toISOString(),_="".concat(m," | [").concat(FV[o],"] ").concat(s);this.logStorage.send(_,o)}}},{key:"error",value:function error(o){this.log(FV.ERROR,o)}},{key:"warn",value:function warn(o){this.log(FV.WARN,o)}},{key:"info",value:function info(o){this.log(FV.INFO,o)}},{key:"debug",value:function debug(o){this.log(FV.DEBUG,o)}},{key:"performance",value:function performance(o){this.log(FV.PERFORMANCE,o)}}]),Logger}(),BV=function(){function ConsoleLogStorage(){_classCallCheck$1(this,ConsoleLogStorage),this.logBatch=[]}return _createClass$1(ConsoleLogStorage,[{key:"send",value:function send(o,s){switch(s){case FV.DEBUG:console.debug(o);break;case FV.ERROR:console.error(o);break;case FV.WARN:console.warn(o);break;case FV.INFO:console.info(o);break;default:console.log(o)}}}]),ConsoleLogStorage}(),jV={exports:{}},$V="undefined"!=typeof window?window:void 0!==Or?Or:"undefined"!=typeof self?self:{};
/*! @name mux.js @version 6.3.0 @license Apache-2.0 */
!function(o,s){o.exports=function(o){function _interopDefaultLegacy(o){return o&&"object"==typeof o&&"default"in o?o:{default:o}}var s=_interopDefaultLegacy(o),m=function Stream(){this.init=function(){var o={};this.on=function(s,m){o[s]||(o[s]=[]),o[s]=o[s].concat(m)},this.off=function(s,m){var _;return!!o[s]&&(_=o[s].indexOf(m),o[s]=o[s].slice(),o[s].splice(_,1),_>-1)},this.trigger=function(s){var m,_,S,E;if(m=o[s])if(2===arguments.length)for(S=m.length,_=0;_<S;++_)m[_].call(this,arguments[1]);else{for(E=[],_=arguments.length,_=1;_<arguments.length;++_)E.push(arguments[_]);for(S=m.length,_=0;_<S;++_)m[_].apply(this,E)}},this.dispose=function(){o={}}}};m.prototype.pipe=function(o){return this.on("data",(function(s){o.push(s)})),this.on("done",(function(s){o.flush(s)})),this.on("partialdone",(function(s){o.partialFlush(s)})),this.on("endedtimeline",(function(s){o.endTimeline(s)})),this.on("reset",(function(s){o.reset(s)})),o},m.prototype.push=function(o){this.trigger("data",o)},m.prototype.flush=function(o){this.trigger("done",o)},m.prototype.partialFlush=function(o){this.trigger("partialdone",o)},m.prototype.endTimeline=function(o){this.trigger("endedtimeline",o)},m.prototype.reset=function(o){this.trigger("reset",o)};var _,S,E,A,O,H,K,z=m,G=9e4;O=function audioTsToVideoTs(o,s){return _(A(o,s))},H=function videoTsToAudioTs(o,s){return S(E(o),s)},K=function metadataTsToSeconds(o,s,m){return E(m?o:o-s)};var q,X={ONE_SECOND_IN_TS:G,secondsToVideoTs:_=function secondsToVideoTs(o){return o*G},secondsToAudioTs:S=function secondsToAudioTs(o,s){return o*s},videoTsToSeconds:E=function videoTsToSeconds(o){return o/G},audioTsToSeconds:A=function audioTsToSeconds(o,s){return o/s},audioTsToVideoTs:O,videoTsToAudioTs:H,metadataTsToSeconds:K},J=X.ONE_SECOND_IN_TS,ae=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];q=function AdtsStream(o){var s,m=0;q.prototype.init.call(this),this.skipWarn_=function(o,s){this.trigger("log",{level:"warn",message:"adts skiping bytes "+o+" to "+s+" in frame "+m+" outside syncword"})},this.push=function(_){var S,E,A,O,H,K=0;if(o||(m=0),"audio"===_.type){var z;for(s&&s.length?(A=s,(s=new Uint8Array(A.byteLength+_.data.byteLength)).set(A),s.set(_.data,A.byteLength)):s=_.data;K+7<s.length;)if(255===s[K]&&240==(246&s[K+1])){if("number"==typeof z&&(this.skipWarn_(z,K),z=null),E=2*(1&~s[K+1]),S=(3&s[K+3])<<11|s[K+4]<<3|(224&s[K+5])>>5,H=(O=1024*(1+(3&s[K+6])))*J/ae[(60&s[K+2])>>>2],s.byteLength-K<S)break;this.trigger("data",{pts:_.pts+m*H,dts:_.dts+m*H,sampleCount:O,audioobjecttype:1+(s[K+2]>>>6&3),channelcount:(1&s[K+2])<<2|(192&s[K+3])>>>6,samplerate:ae[(60&s[K+2])>>>2],samplingfrequencyindex:(60&s[K+2])>>>2,samplesize:16,data:s.subarray(K+7+E,K+S)}),m++,K+=S}else"number"!=typeof z&&(z=K),K++;"number"==typeof z&&(this.skipWarn_(z,K),z=null),s=s.subarray(K)}},this.flush=function(){m=0,this.trigger("done")},this.reset=function(){s=void 0,this.trigger("reset")},this.endTimeline=function(){s=void 0,this.trigger("endedtimeline")}},q.prototype=new z;var pe,me=q;pe=function ExpGolomb(o){var s=o.byteLength,m=0,_=0;this.length=function(){return 8*s},this.bitsAvailable=function(){return 8*s+_},this.loadWord=function(){var S=o.byteLength-s,E=new Uint8Array(4),A=Math.min(4,s);if(0===A)throw new Error("no bytes available");E.set(o.subarray(S,S+A)),m=new DataView(E.buffer).getUint32(0),_=8*A,s-=A},this.skipBits=function(o){var S;_>o?(m<<=o,_-=o):(o-=_,o-=8*(S=Math.floor(o/8)),s-=S,this.loadWord(),m<<=o,_-=o)},this.readBits=function(o){var S=Math.min(_,o),E=m>>>32-S;return(_-=S)>0?m<<=S:s>0&&this.loadWord(),(S=o-S)>0?E<<S|this.readBits(S):E},this.skipLeadingZeros=function(){var o;for(o=0;o<_;++o)if(0!=(m&2147483648>>>o))return m<<=o,_-=o,o;return this.loadWord(),o+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var o=this.skipLeadingZeros();return this.readBits(o+1)-1},this.readExpGolomb=function(){var o=this.readUnsignedExpGolomb();return 1&o?1+o>>>1:-1*(o>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var _e,Se,Ee,De=pe;Se=function NalByteStream(){var o,s,m=0;Se.prototype.init.call(this),this.push=function(_){var S;s?((S=new Uint8Array(s.byteLength+_.data.byteLength)).set(s),S.set(_.data,s.byteLength),s=S):s=_.data;for(var E=s.byteLength;m<E-3;m++)if(1===s[m+2]){o=m+5;break}for(;o<E;)switch(s[o]){case 0:if(0!==s[o-1]){o+=2;break}if(0!==s[o-2]){o++;break}m+3!==o-2&&this.trigger("data",s.subarray(m+3,o-2));do{o++}while(1!==s[o]&&o<E);m=o-2,o+=3;break;case 1:if(0!==s[o-1]||0!==s[o-2]){o+=3;break}this.trigger("data",s.subarray(m+3,o-2)),m=o-2,o+=3;break;default:o+=3}s=s.subarray(m),o-=m,m=0},this.reset=function(){s=null,m=0,this.trigger("reset")},this.flush=function(){s&&s.byteLength>3&&this.trigger("data",s.subarray(m+3)),s=null,m=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},Se.prototype=new z,Ee={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},_e=function H264Stream(){var o,s,m,_,S,E,A,O=new Se;_e.prototype.init.call(this),o=this,this.push=function(o){"video"===o.type&&(s=o.trackId,m=o.pts,_=o.dts,O.push(o))},O.on("data",(function(A){var O={trackId:s,pts:m,dts:_,data:A,nalUnitTypeCode:31&A[0]};switch(O.nalUnitTypeCode){case 5:O.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:O.nalUnitType="sei_rbsp",O.escapedRBSP=S(A.subarray(1));break;case 7:O.nalUnitType="seq_parameter_set_rbsp",O.escapedRBSP=S(A.subarray(1)),O.config=E(O.escapedRBSP);break;case 8:O.nalUnitType="pic_parameter_set_rbsp";break;case 9:O.nalUnitType="access_unit_delimiter_rbsp"}o.trigger("data",O)})),O.on("done",(function(){o.trigger("done")})),O.on("partialdone",(function(){o.trigger("partialdone")})),O.on("reset",(function(){o.trigger("reset")})),O.on("endedtimeline",(function(){o.trigger("endedtimeline")})),this.flush=function(){O.flush()},this.partialFlush=function(){O.partialFlush()},this.reset=function(){O.reset()},this.endTimeline=function(){O.endTimeline()},A=function skipScalingList(o,s){var m,_=8,S=8;for(m=0;m<o;m++)0!==S&&(S=(_+s.readExpGolomb()+256)%256),_=0===S?_:S},S=function discardEmulationPreventionBytes(o){for(var s,m,_=o.byteLength,S=[],E=1;E<_-2;)0===o[E]&&0===o[E+1]&&3===o[E+2]?(S.push(E+2),E+=2):E++;if(0===S.length)return o;s=_-S.length,m=new Uint8Array(s);var A=0;for(E=0;E<s;A++,E++)A===S[0]&&(A++,S.shift()),m[E]=o[A];return m},E=function readSequenceParameterSet(o){var s,m,_,S,E,O,H,K,z,G,q,X,J=0,ae=0,pe=0,me=0,_e=[1,1];if(m=(s=new De(o)).readUnsignedByte(),S=s.readUnsignedByte(),_=s.readUnsignedByte(),s.skipUnsignedExpGolomb(),Ee[m]&&(3===(E=s.readUnsignedExpGolomb())&&s.skipBits(1),s.skipUnsignedExpGolomb(),s.skipUnsignedExpGolomb(),s.skipBits(1),s.readBoolean()))for(q=3!==E?8:12,X=0;X<q;X++)s.readBoolean()&&A(X<6?16:64,s);if(s.skipUnsignedExpGolomb(),0===(O=s.readUnsignedExpGolomb()))s.readUnsignedExpGolomb();else if(1===O)for(s.skipBits(1),s.skipExpGolomb(),s.skipExpGolomb(),H=s.readUnsignedExpGolomb(),X=0;X<H;X++)s.skipExpGolomb();if(s.skipUnsignedExpGolomb(),s.skipBits(1),K=s.readUnsignedExpGolomb(),z=s.readUnsignedExpGolomb(),0===(G=s.readBits(1))&&s.skipBits(1),s.skipBits(1),s.readBoolean()&&(J=s.readUnsignedExpGolomb(),ae=s.readUnsignedExpGolomb(),pe=s.readUnsignedExpGolomb(),me=s.readUnsignedExpGolomb()),s.readBoolean()&&s.readBoolean()){switch(s.readUnsignedByte()){case 1:_e=[1,1];break;case 2:_e=[12,11];break;case 3:_e=[10,11];break;case 4:_e=[16,11];break;case 5:_e=[40,33];break;case 6:_e=[24,11];break;case 7:_e=[20,11];break;case 8:_e=[32,11];break;case 9:_e=[80,33];break;case 10:_e=[18,11];break;case 11:_e=[15,11];break;case 12:_e=[64,33];break;case 13:_e=[160,99];break;case 14:_e=[4,3];break;case 15:_e=[3,2];break;case 16:_e=[2,1];break;case 255:_e=[s.readUnsignedByte()<<8|s.readUnsignedByte(),s.readUnsignedByte()<<8|s.readUnsignedByte()]}_e&&(_e[0],_e[1])}return{profileIdc:m,levelIdc:_,profileCompatibility:S,width:16*(K+1)-2*J-2*ae,height:(2-G)*(z+1)*16-2*pe-2*me,sarRatio:_e}}},_e.prototype=new z;var $e,He,et,rt,it,at,ot,st,ut,ct,dt,ht,pt,gt,_t,bt,kt,It,At,Lt,Rt,Mt,zt,qt,Jt,tn,nn,rn,sn,un,pn,vn,_n,Cn,wn,xn,In,An,Fn,Gn,qn={H264Stream:_e,NalByteStream:Se},ar={Adts:me,h264:qn},vr=Math.pow(2,32),_r=function getUint64(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength);return m.getBigUint64?(s=m.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(s):s:m.getUint32(0)*vr+m.getUint32(4)},wr={getUint64:_r,MAX_UINT32:vr},Pr=wr.MAX_UINT32;(function(){var o;if(Mt={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(o in Mt)Mt.hasOwnProperty(o)&&(Mt[o]=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)]);zt=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),Jt=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),qt=new Uint8Array([0,0,0,1]),tn=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),nn=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),rn={video:tn,audio:nn},pn=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),un=new Uint8Array([0,0,0,0,0,0,0,0]),vn=new Uint8Array([0,0,0,0,0,0,0,0]),_n=vn,Cn=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),wn=vn,sn=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),$e=function box(o){var s,m,_=[],S=0;for(s=1;s<arguments.length;s++)_.push(arguments[s]);for(s=_.length;s--;)S+=_[s].byteLength;for(m=new Uint8Array(S+8),new DataView(m.buffer,m.byteOffset,m.byteLength).setUint32(0,m.byteLength),m.set(o,4),s=0,S=8;s<_.length;s++)m.set(_[s],S),S+=_[s].byteLength;return m},He=function dinf(){return $e(Mt.dinf,$e(Mt.dref,pn))},et=function esds(o){return $e(Mt.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,o.audioobjecttype<<3|o.samplingfrequencyindex>>>1,o.samplingfrequencyindex<<7|o.channelcount<<3,6,1,2]))},_t=function hdlr(o){return $e(Mt.hdlr,rn[o])},gt=function mdhd(o){var s=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,o.duration>>>24&255,o.duration>>>16&255,o.duration>>>8&255,255&o.duration,85,196,0,0]);return o.samplerate&&(s[12]=o.samplerate>>>24&255,s[13]=o.samplerate>>>16&255,s[14]=o.samplerate>>>8&255,s[15]=255&o.samplerate),$e(Mt.mdhd,s)},pt=function mdia(o){return $e(Mt.mdia,gt(o),_t(o.type),at(o))},it=function mfhd(o){return $e(Mt.mfhd,new Uint8Array([0,0,0,0,(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o]))},at=function minf(o){return $e(Mt.minf,"video"===o.type?$e(Mt.vmhd,sn):$e(Mt.smhd,un),He(),kt(o))},ot=function moof(o,s){for(var m=[],_=s.length;_--;)m[_]=At(s[_]);return $e.apply(null,[Mt.moof,it(o)].concat(m))},st=function moov(o){for(var s=o.length,m=[];s--;)m[s]=dt(o[s]);return $e.apply(null,[Mt.moov,ct(4294967295)].concat(m).concat(ut(o)))},ut=function mvex(o){for(var s=o.length,m=[];s--;)m[s]=Lt(o[s]);return $e.apply(null,[Mt.mvex].concat(m))},ct=function mvhd(o){var s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return $e(Mt.mvhd,s)},bt=function sdtp(o){var s,m,_=o.samples||[],S=new Uint8Array(4+_.length);for(m=0;m<_.length;m++)s=_[m].flags,S[m+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return $e(Mt.sdtp,S)},kt=function stbl(o){return $e(Mt.stbl,It(o),$e(Mt.stts,wn),$e(Mt.stsc,_n),$e(Mt.stsz,Cn),$e(Mt.stco,vn))},It=function stsd(o){return $e(Mt.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===o.type?Fn(o):Gn(o))},Fn=function videoSample(o){var s,m,_=o.sps||[],S=o.pps||[],E=[],A=[];for(s=0;s<_.length;s++)E.push((65280&_[s].byteLength)>>>8),E.push(255&_[s].byteLength),E=E.concat(Array.prototype.slice.call(_[s]));for(s=0;s<S.length;s++)A.push((65280&S[s].byteLength)>>>8),A.push(255&S[s].byteLength),A=A.concat(Array.prototype.slice.call(S[s]));if(m=[Mt.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&o.width)>>8,255&o.width,(65280&o.height)>>8,255&o.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),$e(Mt.avcC,new Uint8Array([1,o.profileIdc,o.profileCompatibility,o.levelIdc,255].concat([_.length],E,[S.length],A))),$e(Mt.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],o.sarRatio){var O=o.sarRatio[0],H=o.sarRatio[1];m.push($e(Mt.pasp,new Uint8Array([(4278190080&O)>>24,(16711680&O)>>16,(65280&O)>>8,255&O,(4278190080&H)>>24,(16711680&H)>>16,(65280&H)>>8,255&H])))}return $e.apply(null,m)},Gn=function audioSample(o){return $e(Mt.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&o.channelcount)>>8,255&o.channelcount,(65280&o.samplesize)>>8,255&o.samplesize,0,0,0,0,(65280&o.samplerate)>>8,255&o.samplerate,0,0]),et(o))},ht=function tkhd(o){var s=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,0,(4278190080&o.duration)>>24,(16711680&o.duration)>>16,(65280&o.duration)>>8,255&o.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&o.width)>>8,255&o.width,0,0,(65280&o.height)>>8,255&o.height,0,0]);return $e(Mt.tkhd,s)},At=function traf(o){var s,m,_,S,E,A,O;return s=$e(Mt.tfhd,new Uint8Array([0,0,0,58,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),A=Math.floor(o.baseMediaDecodeTime/Pr),O=Math.floor(o.baseMediaDecodeTime%Pr),m=$e(Mt.tfdt,new Uint8Array([1,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,255&A,O>>>24&255,O>>>16&255,O>>>8&255,255&O])),E=92,"audio"===o.type?(_=Rt(o,E),$e(Mt.traf,s,m,_)):(S=bt(o),_=Rt(o,S.length+E),$e(Mt.traf,s,m,_,S))},dt=function trak(o){return o.duration=o.duration||4294967295,$e(Mt.trak,ht(o),pt(o))},Lt=function trex(o){var s=new Uint8Array([0,0,0,0,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==o.type&&(s[s.length-1]=0),$e(Mt.trex,s)},An=function trunHeader(o,s){var m=0,_=0,S=0,E=0;return o.length&&(void 0!==o[0].duration&&(m=1),void 0!==o[0].size&&(_=2),void 0!==o[0].flags&&(S=4),void 0!==o[0].compositionTimeOffset&&(E=8)),[0,0,m|_|S|E,1,(4278190080&o.length)>>>24,(16711680&o.length)>>>16,(65280&o.length)>>>8,255&o.length,(4278190080&s)>>>24,(16711680&s)>>>16,(65280&s)>>>8,255&s]},In=function videoTrun(o,s){var m,_,S,E,A,O;for(s+=20+16*(E=o.samples||[]).length,S=An(E,s),(_=new Uint8Array(S.length+16*E.length)).set(S),m=S.length,O=0;O<E.length;O++)A=E[O],_[m++]=(4278190080&A.duration)>>>24,_[m++]=(16711680&A.duration)>>>16,_[m++]=(65280&A.duration)>>>8,_[m++]=255&A.duration,_[m++]=(4278190080&A.size)>>>24,_[m++]=(16711680&A.size)>>>16,_[m++]=(65280&A.size)>>>8,_[m++]=255&A.size,_[m++]=A.flags.isLeading<<2|A.flags.dependsOn,_[m++]=A.flags.isDependedOn<<6|A.flags.hasRedundancy<<4|A.flags.paddingValue<<1|A.flags.isNonSyncSample,_[m++]=61440&A.flags.degradationPriority,_[m++]=15&A.flags.degradationPriority,_[m++]=(4278190080&A.compositionTimeOffset)>>>24,_[m++]=(16711680&A.compositionTimeOffset)>>>16,_[m++]=(65280&A.compositionTimeOffset)>>>8,_[m++]=255&A.compositionTimeOffset;return $e(Mt.trun,_)},xn=function audioTrun(o,s){var m,_,S,E,A,O;for(s+=20+8*(E=o.samples||[]).length,S=An(E,s),(m=new Uint8Array(S.length+8*E.length)).set(S),_=S.length,O=0;O<E.length;O++)A=E[O],m[_++]=(4278190080&A.duration)>>>24,m[_++]=(16711680&A.duration)>>>16,m[_++]=(65280&A.duration)>>>8,m[_++]=255&A.duration,m[_++]=(4278190080&A.size)>>>24,m[_++]=(16711680&A.size)>>>16,m[_++]=(65280&A.size)>>>8,m[_++]=255&A.size;return $e(Mt.trun,m)},Rt=function trun(o,s){return"audio"===o.type?xn(o,s):In(o,s)};var Or,Vr,oi,li,hi,gi,_i,bi={ftyp:rt=function ftyp(){return $e(Mt.ftyp,zt,qt,zt,Jt)},mdat:function mdat(o){return $e(Mt.mdat,o)},moof:ot,moov:st,initSegment:function initSegment(o){var s,m=rt(),_=st(o);return(s=new Uint8Array(m.byteLength+_.byteLength)).set(m),s.set(_,m.byteLength),s}},Ui={toUnsigned:function toUnsigned(o){return o>>>0},toHexString:function toHexString(o){return("00"+o.toString(16)).slice(-2)}},ta=function parseType(o){var s="";return s+=String.fromCharCode(o[0]),s+=String.fromCharCode(o[1]),s+=String.fromCharCode(o[2]),s+=String.fromCharCode(o[3])},na=Ui.toUnsigned,aa=function findBox(o,s){var m,_,S,E,A,O=[];if(!s.length)return null;for(m=0;m<o.byteLength;)_=na(o[m]<<24|o[m+1]<<16|o[m+2]<<8|o[m+3]),S=ta(o.subarray(m+4,m+8)),E=_>1?m+_:o.byteLength,S===s[0]&&(1===s.length?O.push(o.subarray(m+8,E)):(A=findBox(o.subarray(m+8,E),s.slice(1))).length&&(O=O.concat(A))),m=E;return O},oa=aa,la=function uint8ToCString(o){for(var s=0,m=String.fromCharCode(o[s]),_="";"\0"!==m;)_+=m,s++,m=String.fromCharCode(o[s]);return _+=m},ca={uint8ToCString:la}.uint8ToCString,da=wr.getUint64,pa=function parseEmsgBox(o){var s,m,_,S,E,A,O,H=4,K=o[0];if(0===K)H+=(s=ca(o.subarray(H))).length,H+=(m=ca(o.subarray(H))).length,_=(z=new DataView(o.buffer)).getUint32(H),H+=4,E=z.getUint32(H),H+=4,A=z.getUint32(H),H+=4,O=z.getUint32(H),H+=4;else if(1===K){var z;_=(z=new DataView(o.buffer)).getUint32(H),H+=4,S=da(o.subarray(H)),H+=8,A=z.getUint32(H),H+=4,O=z.getUint32(H),H+=4,H+=(s=ca(o.subarray(H))).length,H+=(m=ca(o.subarray(H))).length}var G={scheme_id_uri:s,value:m,timescale:_||1,presentation_time:S,presentation_time_delta:E,event_duration:A,id:O,message_data:new Uint8Array(o.subarray(H,o.byteLength))};return fa(K,G)?G:void 0},fa=function isValidEmsgBox(o,s){var m="\0"!==s.scheme_id_uri,_=0===o&&ga(s.presentation_time_delta)&&m,S=1===o&&ga(s.presentation_time)&&m;return!(o>1)&&_||S},ga=function isDefined(o){return void 0!==o||null!==o},ma={parseEmsgBox:pa,scaleTime:function scaleTime(o,s,m,_){return o||0===o?o/s:_+m/s}},_a=function tfhd(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:o[0],flags:new Uint8Array(o.subarray(1,4)),trackId:m.getUint32(4)},S=1&_.flags[2],E=2&_.flags[2],A=8&_.flags[2],O=16&_.flags[2],H=32&_.flags[2],K=65536&_.flags[0],z=131072&_.flags[0];return s=8,S&&(s+=4,_.baseDataOffset=m.getUint32(12),s+=4),E&&(_.sampleDescriptionIndex=m.getUint32(s),s+=4),A&&(_.defaultSampleDuration=m.getUint32(s),s+=4),O&&(_.defaultSampleSize=m.getUint32(s),s+=4),H&&(_.defaultSampleFlags=m.getUint32(s)),K&&(_.durationIsEmpty=!0),!S&&z&&(_.baseDataOffsetIsMoof=!0),_},Sa=_a,ka=function parseSampleFlags(o){return{isLeading:(12&o[0])>>>2,dependsOn:3&o[0],isDependedOn:(192&o[1])>>>6,hasRedundancy:(48&o[1])>>>4,paddingValue:(14&o[1])>>>1,isNonSyncSample:1&o[1],degradationPriority:o[2]<<8|o[3]}},xa=function trun(o){var s,m={version:o[0],flags:new Uint8Array(o.subarray(1,4)),samples:[]},_=new DataView(o.buffer,o.byteOffset,o.byteLength),S=1&m.flags[2],E=4&m.flags[2],A=1&m.flags[1],O=2&m.flags[1],H=4&m.flags[1],K=8&m.flags[1],z=_.getUint32(4),G=8;for(S&&(m.dataOffset=_.getInt32(G),G+=4),E&&z&&(s={flags:ka(o.subarray(G,G+4))},G+=4,A&&(s.duration=_.getUint32(G),G+=4),O&&(s.size=_.getUint32(G),G+=4),K&&(1===m.version?s.compositionTimeOffset=_.getInt32(G):s.compositionTimeOffset=_.getUint32(G),G+=4),m.samples.push(s),z--);z--;)s={},A&&(s.duration=_.getUint32(G),G+=4),O&&(s.size=_.getUint32(G),G+=4),H&&(s.flags=ka(o.subarray(G,G+4)),G+=4),K&&(1===m.version?s.compositionTimeOffset=_.getInt32(G):s.compositionTimeOffset=_.getUint32(G),G+=4),m.samples.push(s);return m},Da=Ui.toUnsigned,Ra=wr.getUint64,ja=function tfdt(o){var s={version:o[0],flags:new Uint8Array(o.subarray(1,4))};return 1===s.version?s.baseMediaDecodeTime=Ra(o.subarray(4)):s.baseMediaDecodeTime=Da(o[4]<<24|o[5]<<16|o[6]<<8|o[7]),s},Va=ja,za=function typedArrayIndexOf(o,s,m){if(!o)return-1;for(var _=m;_<o.length;_++)if(o[_]===s)return _;return-1},qa={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},Qa=function percentEncode(o,s,m){var _,S="";for(_=s;_<m;_++)S+="%"+("00"+o[_].toString(16)).slice(-2);return S},Za=function parseUtf8(o,s,m){return decodeURIComponent(Qa(o,s,m))},ro=function parseIso88591(o,s,m){return unescape(Qa(o,s,m))},oo=function parseSyncSafeInteger(o){return o[0]<<21|o[1]<<14|o[2]<<7|o[3]},lo={APIC:function APIC(o){var s,m,_=1,S="--\x3e";o.data[0]===qa.Utf8&&((s=za(o.data,0,_))<0||(o.mimeType=ro(o.data,_,s),_=s+1,o.pictureType=o.data[_],_++,(m=za(o.data,0,_))<0||(o.description=Za(o.data,_,m),_=m+1,o.mimeType===S?o.url=ro(o.data,_,o.data.length):o.pictureData=o.data.subarray(_,o.data.length))))},"T*":function T(o){o.data[0]===qa.Utf8&&(o.value=Za(o.data,1,o.data.length).replace(/\0*$/,""),o.values=o.value.split("\0"))},TXXX:function TXXX(o){var s;o.data[0]===qa.Utf8&&-1!==(s=za(o.data,0,1))&&(o.description=Za(o.data,1,s),o.value=Za(o.data,s+1,o.data.length).replace(/\0*$/,""),o.data=o.value)},"W*":function W(o){o.url=ro(o.data,0,o.data.length).replace(/\0.*$/,"")},WXXX:function WXXX(o){var s;o.data[0]===qa.Utf8&&-1!==(s=za(o.data,0,1))&&(o.description=Za(o.data,1,s),o.url=ro(o.data,s+1,o.data.length).replace(/\0.*$/,""))},PRIV:function PRIV(o){var s;for(s=0;s<o.data.length;s++)if(0===o.data[s]){o.owner=ro(o.data,0,s);break}o.privateData=o.data.subarray(s+1),o.data=o.privateData}},ho={parseId3Frames:function parseId3Frames(o){var s,m=10,_=0,S=[];if(!(o.length<10||o[0]!=="I".charCodeAt(0)||o[1]!=="D".charCodeAt(0)||o[2]!=="3".charCodeAt(0))){_=oo(o.subarray(6,10)),_+=10,64&o[5]&&(m+=4,m+=oo(o.subarray(10,14)),_-=oo(o.subarray(16,20)));do{if((s=oo(o.subarray(m+4,m+8)))<1)break;var E={id:String.fromCharCode(o[m],o[m+1],o[m+2],o[m+3]),data:o.subarray(m+10,m+s+10)};E.key=E.id,lo[E.id]?lo[E.id](E):"T"===E.id[0]?lo["T*"](E):"W"===E.id[0]&&lo["W*"](E),S.push(E),m+=10,m+=s}while(m<_);return S}},parseSyncSafeInteger:oo,frameParsers:lo},po=Ui.toUnsigned,_o=Ui.toHexString,So=wr.getUint64,To=ho.parseId3Frames;Or=function timescale(o){var s={};return oa(o,["moov","trak"]).reduce((function(o,s){var m,_,S,E,A;return(m=oa(s,["tkhd"])[0])?(_=m[0],E=po(m[S=0===_?12:20]<<24|m[S+1]<<16|m[S+2]<<8|m[S+3]),(A=oa(s,["mdia","mdhd"])[0])?(S=0===(_=A[0])?12:20,o[E]=po(A[S]<<24|A[S+1]<<16|A[S+2]<<8|A[S+3]),o):null):null}),s)},Vr=function startTime(o,m){var _=oa(m,["moof","traf"]).reduce((function(m,_){var S,E,A=oa(_,["tfhd"])[0],O=po(A[4]<<24|A[5]<<16|A[6]<<8|A[7]),H=o[O]||9e4,K=oa(_,["tfdt"])[0],z=new DataView(K.buffer,K.byteOffset,K.byteLength);return"bigint"==typeof(S=1===K[0]?So(K.subarray(4,12)):z.getUint32(4))?E=S/s.default.BigInt(H):"number"!=typeof S||isNaN(S)||(E=S/H),E<Number.MAX_SAFE_INTEGER&&(E=Number(E)),E<m&&(m=E),m}),1/0);return"bigint"==typeof _||isFinite(_)?_:0},oi=function compositionStartTime(o,m){var _,S=oa(m,["moof","traf"]),E=0,A=0;if(S&&S.length){var O=oa(S[0],["tfhd"])[0],H=oa(S[0],["trun"])[0],K=oa(S[0],["tfdt"])[0];if(O&&(_=Sa(O).trackId),K&&(E=Va(K).baseMediaDecodeTime),H){var z=xa(H);z.samples&&z.samples.length&&(A=z.samples[0].compositionTimeOffset||0)}}var G=o[_]||9e4;"bigint"==typeof E&&(A=s.default.BigInt(A),G=s.default.BigInt(G));var q=(E+A)/G;return"bigint"==typeof q&&q<Number.MAX_SAFE_INTEGER&&(q=Number(q)),q},li=function getVideoTrackIds(o){var s=oa(o,["moov","trak"]),m=[];return s.forEach((function(o){var s=oa(o,["mdia","hdlr"]),_=oa(o,["tkhd"]);s.forEach((function(o,s){var S,E,A=ta(o.subarray(8,12)),O=_[s];"vide"===A&&(E=0===(S=new DataView(O.buffer,O.byteOffset,O.byteLength)).getUint8(0)?S.getUint32(12):S.getUint32(20),m.push(E))}))})),m},gi=function getTimescaleFromMediaHeader(o){var s=0===o[0]?12:20;return po(o[s]<<24|o[s+1]<<16|o[s+2]<<8|o[s+3])},hi=function getTracks(o){var s=oa(o,["moov","trak"]),m=[];return s.forEach((function(o){var s,_,S={},E=oa(o,["tkhd"])[0];E&&(_=(s=new DataView(E.buffer,E.byteOffset,E.byteLength)).getUint8(0),S.id=0===_?s.getUint32(12):s.getUint32(20));var A=oa(o,["mdia","hdlr"])[0];if(A){var O=ta(A.subarray(8,12));S.type="vide"===O?"video":"soun"===O?"audio":O}var H=oa(o,["mdia","minf","stbl","stsd"])[0];if(H){var K=H.subarray(8);S.codec=ta(K.subarray(4,8));var z,G=oa(K,[S.codec])[0];G&&(/^[asm]vc[1-9]$/i.test(S.codec)?(z=G.subarray(78),"avcC"===ta(z.subarray(4,8))&&z.length>11?(S.codec+=".",S.codec+=_o(z[9]),S.codec+=_o(z[10]),S.codec+=_o(z[11])):S.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(S.codec)?(z=G.subarray(28),"esds"===ta(z.subarray(4,8))&&z.length>20&&0!==z[19]?(S.codec+="."+_o(z[19]),S.codec+="."+_o(z[20]>>>2&63).replace(/^0/,"")):S.codec="mp4a.40.2"):S.codec=S.codec.toLowerCase())}var q=oa(o,["mdia","mdhd"])[0];q&&(S.timescale=gi(q)),m.push(S)})),m},_i=function getEmsgID3(o,s){return void 0===s&&(s=0),oa(o,["emsg"]).map((function(o){var m=ma.parseEmsgBox(new Uint8Array(o)),_=To(m.message_data);return{cueTime:ma.scaleTime(m.presentation_time,m.timescale,m.presentation_time_delta,s),duration:ma.scaleTime(m.event_duration,m.timescale),frames:_}}))};var Co,Eo={findBox:oa,parseType:ta,timescale:Or,startTime:Vr,compositionStartTime:oi,videoTrackIds:li,tracks:hi,getTimescaleFromMediaHeader:gi,getEmsgID3:_i},Io=function groupNalsIntoFrames(o){var s,m,_=[],S=[];for(S.byteLength=0,S.nalCount=0,S.duration=0,_.byteLength=0,s=0;s<o.length;s++)"access_unit_delimiter_rbsp"===(m=o[s]).nalUnitType?(_.length&&(_.duration=m.dts-_.dts,S.byteLength+=_.byteLength,S.nalCount+=_.length,S.duration+=_.duration,S.push(_)),(_=[m]).byteLength=m.data.byteLength,_.pts=m.pts,_.dts=m.dts):("slice_layer_without_partitioning_rbsp_idr"===m.nalUnitType&&(_.keyFrame=!0),_.duration=m.dts-_.dts,_.byteLength+=m.data.byteLength,_.push(m));return S.length&&(!_.duration||_.duration<=0)&&(_.duration=S[S.length-1].duration),S.byteLength+=_.byteLength,S.nalCount+=_.length,S.duration+=_.duration,S.push(_),S},Lo=function groupFramesIntoGops(o){var s,m,_=[],S=[];for(_.byteLength=0,_.nalCount=0,_.duration=0,_.pts=o[0].pts,_.dts=o[0].dts,S.byteLength=0,S.nalCount=0,S.duration=0,S.pts=o[0].pts,S.dts=o[0].dts,s=0;s<o.length;s++)(m=o[s]).keyFrame?(_.length&&(S.push(_),S.byteLength+=_.byteLength,S.nalCount+=_.nalCount,S.duration+=_.duration),(_=[m]).nalCount=m.length,_.byteLength=m.byteLength,_.pts=m.pts,_.dts=m.dts,_.duration=m.duration):(_.duration+=m.duration,_.nalCount+=m.length,_.byteLength+=m.byteLength,_.push(m));return S.length&&_.duration<=0&&(_.duration=S[S.length-1].duration),S.byteLength+=_.byteLength,S.nalCount+=_.nalCount,S.duration+=_.duration,S.push(_),S},Do=function createDefaultSample(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},Oo=function sampleForFrame(o,s){var m=Do();return m.dataOffset=s,m.compositionTimeOffset=o.pts-o.dts,m.duration=o.duration,m.size=4*o.length,m.size+=o.byteLength,o.keyFrame&&(m.flags.dependsOn=2,m.flags.isNonSyncSample=0),m},Fo=function generateSampleTable(o,s){var m,_,S,E,A,O=s||0,H=[];for(m=0;m<o.length;m++)for(E=o[m],_=0;_<E.length;_++)A=E[_],O+=(S=Oo(A,O)).size,H.push(S);return H},No=function concatenateNalData(o){var s,m,_,S,E,A,O=0,H=o.byteLength,K=o.nalCount,z=new Uint8Array(H+4*K),G=new DataView(z.buffer);for(s=0;s<o.length;s++)for(S=o[s],m=0;m<S.length;m++)for(E=S[m],_=0;_<E.length;_++)A=E[_],G.setUint32(O,A.data.byteLength),O+=4,z.set(A.data,O),O+=A.data.byteLength;return z},Bo=function concatenateNalDataForFrame(o){var s,m,_=0,S=o.byteLength,E=o.length,A=new Uint8Array(S+4*E),O=new DataView(A.buffer);for(s=0;s<o.length;s++)m=o[s],O.setUint32(_,m.data.byteLength),_+=4,A.set(m.data,_),_+=m.data.byteLength;return A},Vo={groupNalsIntoFrames:Io,groupFramesIntoGops:Lo,extendFirstKeyFrame:function extendFirstKeyFrame(o){var s;return!o[0][0].keyFrame&&o.length>1&&(s=o.shift(),o.byteLength-=s.byteLength,o.nalCount-=s.nalCount,o[0][0].dts=s.dts,o[0][0].pts=s.pts,o[0][0].duration+=s.duration),o},generateSampleTable:Fo,concatenateNalData:No,generateSampleTableForFrame:function generateSampleTableForFrame(o,s){var m,_=[];return m=Oo(o,s||0),_.push(m),_},concatenateNalDataForFrame:Bo},Ho=[33,16,5,32,164,27],Go=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],qo=function zeroFill(o){for(var s=[];o--;)s.push(0);return s},Qo=function makeTable(o){return Object.keys(o).reduce((function(s,m){return s[m]=new Uint8Array(o[m].reduce((function(o,s){return o.concat(s)}),[])),s}),{})},as=function silence_1(){if(!Co){var o={96e3:[Ho,[227,64],qo(154),[56]],88200:[Ho,[231],qo(170),[56]],64e3:[Ho,[248,192],qo(240),[56]],48e3:[Ho,[255,192],qo(268),[55,148,128],qo(54),[112]],44100:[Ho,[255,192],qo(268),[55,163,128],qo(84),[112]],32e3:[Ho,[255,192],qo(268),[55,234],qo(226),[112]],24e3:[Ho,[255,192],qo(268),[55,255,128],qo(268),[111,112],qo(126),[224]],16e3:[Ho,[255,192],qo(268),[55,255,128],qo(268),[111,255],qo(269),[223,108],qo(195),[1,192]],12e3:[Go,qo(268),[3,127,248],qo(268),[6,255,240],qo(268),[13,255,224],qo(268),[27,253,128],qo(259),[56]],11025:[Go,qo(268),[3,127,248],qo(268),[6,255,240],qo(268),[13,255,224],qo(268),[27,255,192],qo(268),[55,175,128],qo(108),[112]],8e3:[Go,qo(268),[3,121,16],qo(47),[7]]};Co=Qo(o)}return Co},_s=function sumFrameByteLengths(o){var s,m=0;for(s=0;s<o.length;s++)m+=o[s].data.byteLength;return m},ws=function prefixWithSilence(o,s,m,_){var S,E,A,O,H=0,K=0,z=0,G=0;if(s.length&&(S=X.audioTsToVideoTs(o.baseMediaDecodeTime,o.samplerate),H=Math.ceil(X.ONE_SECOND_IN_TS/(o.samplerate/1024)),m&&_&&(K=S-Math.max(m,_),G=(z=Math.floor(K/H))*H),!(z<1||G>X.ONE_SECOND_IN_TS/2))){for((E=as()[o.samplerate])||(E=s[0].data),A=0;A<z;A++)O=s[0],s.splice(0,0,{data:E,dts:O.dts-H,pts:O.pts-H});return o.baseMediaDecodeTime-=Math.floor(X.videoTsToAudioTs(G,o.samplerate)),G}},Os=function generateSampleTable(o){var s,m,_=[];for(s=0;s<o.length;s++)m=o[s],_.push({size:m.data.byteLength,duration:1024});return _},Us=function concatenateFrameData(o){var s,m,_=0,S=new Uint8Array(_s(o));for(s=0;s<o.length;s++)m=o[s],S.set(m.data,_),_+=m.data.byteLength;return S},Bs={prefixWithSilence:ws,trimAdtsFramesByEarliestDts:function trimAdtsFramesByEarliestDts(o,s,m){return s.minSegmentDts>=m?o:(s.minSegmentDts=1/0,o.filter((function(o){return o.dts>=m&&(s.minSegmentDts=Math.min(s.minSegmentDts,o.dts),s.minSegmentPts=s.minSegmentDts,!0)})))},generateSampleTable:Os,concatenateFrameData:Us},Hs=X.ONE_SECOND_IN_TS,Ys={clearDtsInfo:function clearDtsInfo(o){delete o.minSegmentDts,delete o.maxSegmentDts,delete o.minSegmentPts,delete o.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function calculateTrackBaseMediaDecodeTime(o,s){var m,_=o.minSegmentDts;return s||(_-=o.timelineStartInfo.dts),m=o.timelineStartInfo.baseMediaDecodeTime,m+=_,m=Math.max(0,m),"audio"===o.type&&(m*=o.samplerate/Hs,m=Math.floor(m)),m},collectDtsInfo:function collectDtsInfo(o,s){"number"==typeof s.pts&&(void 0===o.timelineStartInfo.pts&&(o.timelineStartInfo.pts=s.pts),void 0===o.minSegmentPts?o.minSegmentPts=s.pts:o.minSegmentPts=Math.min(o.minSegmentPts,s.pts),void 0===o.maxSegmentPts?o.maxSegmentPts=s.pts:o.maxSegmentPts=Math.max(o.maxSegmentPts,s.pts)),"number"==typeof s.dts&&(void 0===o.timelineStartInfo.dts&&(o.timelineStartInfo.dts=s.dts),void 0===o.minSegmentDts?o.minSegmentDts=s.dts:o.minSegmentDts=Math.min(o.minSegmentDts,s.dts),void 0===o.maxSegmentDts?o.maxSegmentDts=s.dts:o.maxSegmentDts=Math.max(o.maxSegmentDts,s.dts))}},Zs=4,pu=128,_u=function parseSei(o){for(var s=0,m={payloadType:-1,payloadSize:0},_=0,S=0;s<o.byteLength&&o[s]!==pu;){for(;255===o[s];)_+=255,s++;for(_+=o[s++];255===o[s];)S+=255,s++;if(S+=o[s++],!m.payload&&_===Zs){if("GA94"===String.fromCharCode(o[s+3],o[s+4],o[s+5],o[s+6])){m.payloadType=_,m.payloadSize=S,m.payload=o.subarray(s,s+S);break}m.payload=void 0}s+=S,_=0,S=0}return m},vl=function parseCaptionPackets(o,s){var m,_,S,E,A=[];if(!(64&s[0]))return A;for(_=31&s[0],m=0;m<_;m++)E={type:3&s[2+(S=3*m)],pts:o},4&s[S+2]&&(E.ccData=s[S+3]<<8|s[S+4],A.push(E));return A},_l=function discardEmulationPreventionBytes(o){for(var s,m,_=o.byteLength,S=[],E=1;E<_-2;)0===o[E]&&0===o[E+1]&&3===o[E+2]?(S.push(E+2),E+=2):E++;if(0===S.length)return o;s=_-S.length,m=new Uint8Array(s);var A=0;for(E=0;E<s;A++,E++)A===S[0]&&(A++,S.shift()),m[E]=o[A];return m},Pl={parseSei:_u,parseUserData:function parseUserData(o){return 181!==o.payload[0]||49!=(o.payload[1]<<8|o.payload[2])||"GA94"!==String.fromCharCode(o.payload[3],o.payload[4],o.payload[5],o.payload[6])||3!==o.payload[7]?null:o.payload.subarray(8,o.payload.length-1)},parseCaptionPackets:vl,discardEmulationPreventionBytes:_l,USER_DATA_REGISTERED_ITU_T_T35:Zs},Ql=function CaptionStream(o){o=o||{},CaptionStream.prototype.init.call(this),this.parse708captions_="boolean"!=typeof o.parse708captions||o.parse708captions,this.captionPackets_=[],this.ccStreams_=[new Mc(0,0),new Mc(0,1),new Mc(1,0),new Mc(1,1)],this.parse708captions_&&(this.cc708Stream_=new yc({captionServices:o.captionServices})),this.reset(),this.ccStreams_.forEach((function(o){o.on("data",this.trigger.bind(this,"data")),o.on("partialdone",this.trigger.bind(this,"partialdone")),o.on("done",this.trigger.bind(this,"done"))}),this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};Ql.prototype=new z,Ql.prototype.push=function(o){var s,m,_;if("sei_rbsp"===o.nalUnitType&&(s=Pl.parseSei(o.escapedRBSP)).payload&&s.payloadType===Pl.USER_DATA_REGISTERED_ITU_T_T35&&(m=Pl.parseUserData(s)))if(o.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(o.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));_=Pl.parseCaptionPackets(o.pts,m),this.captionPackets_=this.captionPackets_.concat(_),this.latestDts_!==o.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=o.dts}},Ql.prototype.flushCCStreams=function(o){this.ccStreams_.forEach((function(s){return"flush"===o?s.flush():s.partialFlush()}),this)},Ql.prototype.flushStream=function(o){this.captionPackets_.length?(this.captionPackets_.forEach((function(o,s){o.presortIndex=s})),this.captionPackets_.sort((function(o,s){return o.pts===s.pts?o.presortIndex-s.presortIndex:o.pts-s.pts})),this.captionPackets_.forEach((function(o){o.type<2?this.dispatchCea608Packet(o):this.dispatchCea708Packet(o)}),this),this.captionPackets_.length=0,this.flushCCStreams(o)):this.flushCCStreams(o)},Ql.prototype.flush=function(){return this.flushStream("flush")},Ql.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Ql.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(o){o.reset()}))},Ql.prototype.dispatchCea608Packet=function(o){this.setsTextOrXDSActive(o)?this.activeCea608Channel_[o.type]=null:this.setsChannel1Active(o)?this.activeCea608Channel_[o.type]=0:this.setsChannel2Active(o)&&(this.activeCea608Channel_[o.type]=1),null!==this.activeCea608Channel_[o.type]&&this.ccStreams_[(o.type<<1)+this.activeCea608Channel_[o.type]].push(o)},Ql.prototype.setsChannel1Active=function(o){return 4096==(30720&o.ccData)},Ql.prototype.setsChannel2Active=function(o){return 6144==(30720&o.ccData)},Ql.prototype.setsTextOrXDSActive=function(o){return 256==(28928&o.ccData)||4138==(30974&o.ccData)||6186==(30974&o.ccData)},Ql.prototype.dispatchCea708Packet=function(o){this.parse708captions_&&this.cc708Stream_.push(o)};var nc={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},ic=function get708CharFromCode(o){var s=nc[o]||o;return 4096&o&&o===s?"":String.fromCharCode(s)},ac=function within708TextBlock(o){return 32<=o&&o<=127||160<=o&&o<=255},lc=function Cea708Window(o){this.windowNum=o,this.reset()};lc.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},lc.prototype.getText=function(){return this.rows.join("\n")},lc.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},lc.prototype.newLine=function(o){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(o),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},lc.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},lc.prototype.addText=function(o){this.rows[this.rowIdx]+=o},lc.prototype.backspace=function(){if(!this.isEmpty()){var o=this.rows[this.rowIdx];this.rows[this.rowIdx]=o.substr(0,o.length-1)}};var mc=function Cea708Service(o,s,m){this.serviceNum=o,this.text="",this.currentWindow=new lc(-1),this.windows=[],this.stream=m,"string"==typeof s&&this.createTextDecoder(s)};mc.prototype.init=function(o,s){this.startPts=o;for(var m=0;m<8;m++)this.windows[m]=new lc(m),"function"==typeof s&&(this.windows[m].beforeRowOverflow=s)},mc.prototype.setCurrentWindow=function(o){this.currentWindow=this.windows[o]},mc.prototype.createTextDecoder=function(o){if("undefined"==typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(o)}catch(s){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+o+" encoding. "+s})}};var yc=function Cea708Stream(o){o=o||{},Cea708Stream.prototype.init.call(this);var s,m=this,_=o.captionServices||{},S={};Object.keys(_).forEach((function(o){s=_[o],/^SERVICE/.test(o)&&(S[o]=s.encoding)})),this.serviceEncodings=S,this.current708Packet=null,this.services={},this.push=function(o){3===o.type?(m.new708Packet(),m.add708Bytes(o)):(null===m.current708Packet&&m.new708Packet(),m.add708Bytes(o))}};yc.prototype=new z,yc.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},yc.prototype.add708Bytes=function(o){var s=o.ccData,m=s>>>8,_=255&s;this.current708Packet.ptsVals.push(o.pts),this.current708Packet.data.push(m),this.current708Packet.data.push(_)},yc.prototype.push708Packet=function(){var o=this.current708Packet,s=o.data,m=null,_=null,S=0,E=s[S++];for(o.seq=E>>6,o.sizeCode=63&E;S<s.length;S++)_=31&(E=s[S++]),7==(m=E>>5)&&_>0&&(m=E=s[S++]),this.pushServiceBlock(m,S,_),_>0&&(S+=_-1)},yc.prototype.pushServiceBlock=function(o,s,m){var _,S=s,E=this.current708Packet.data,A=this.services[o];for(A||(A=this.initService(o,S));S<s+m&&S<E.length;S++)_=E[S],ac(_)?S=this.handleText(S,A):24===_?S=this.multiByteCharacter(S,A):16===_?S=this.extendedCommands(S,A):128<=_&&_<=135?S=this.setCurrentWindow(S,A):152<=_&&_<=159?S=this.defineWindow(S,A):136===_?S=this.clearWindows(S,A):140===_?S=this.deleteWindows(S,A):137===_?S=this.displayWindows(S,A):138===_?S=this.hideWindows(S,A):139===_?S=this.toggleWindows(S,A):151===_?S=this.setWindowAttributes(S,A):144===_?S=this.setPenAttributes(S,A):145===_?S=this.setPenColor(S,A):146===_?S=this.setPenLocation(S,A):143===_?A=this.reset(S,A):8===_?A.currentWindow.backspace():12===_?A.currentWindow.clearText():13===_?A.currentWindow.pendingNewLine=!0:14===_?A.currentWindow.clearText():141===_&&S++},yc.prototype.extendedCommands=function(o,s){var m=this.current708Packet.data[++o];return ac(m)&&(o=this.handleText(o,s,{isExtended:!0})),o},yc.prototype.getPts=function(o){return this.current708Packet.ptsVals[Math.floor(o/2)]},yc.prototype.initService=function(o,s){var m,_,S=this;return(m="SERVICE"+o)in this.serviceEncodings&&(_=this.serviceEncodings[m]),this.services[o]=new mc(o,_,S),this.services[o].init(this.getPts(s),(function(s){S.flushDisplayed(s,S.services[o])})),this.services[o]},yc.prototype.handleText=function(o,s,m){var _,S,E=m&&m.isExtended,A=m&&m.isMultiByte,O=this.current708Packet.data,H=E?4096:0,K=O[o],z=O[o+1],G=s.currentWindow;return s.textDecoder_&&!E?(A?(S=[K,z],o++):S=[K],_=s.textDecoder_.decode(new Uint8Array(S))):_=ic(H|K),G.pendingNewLine&&!G.isEmpty()&&G.newLine(this.getPts(o)),G.pendingNewLine=!1,G.addText(_),o},yc.prototype.multiByteCharacter=function(o,s){var m=this.current708Packet.data,_=m[o+1],S=m[o+2];return ac(_)&&ac(S)&&(o=this.handleText(++o,s,{isMultiByte:!0})),o},yc.prototype.setCurrentWindow=function(o,s){var m=7&this.current708Packet.data[o];return s.setCurrentWindow(m),o},yc.prototype.defineWindow=function(o,s){var m=this.current708Packet.data,_=m[o],S=7&_;s.setCurrentWindow(S);var E=s.currentWindow;return _=m[++o],E.visible=(32&_)>>5,E.rowLock=(16&_)>>4,E.columnLock=(8&_)>>3,E.priority=7&_,_=m[++o],E.relativePositioning=(128&_)>>7,E.anchorVertical=127&_,_=m[++o],E.anchorHorizontal=_,_=m[++o],E.anchorPoint=(240&_)>>4,E.rowCount=15&_,_=m[++o],E.columnCount=63&_,_=m[++o],E.windowStyle=(56&_)>>3,E.penStyle=7&_,E.virtualRowCount=E.rowCount+1,o},yc.prototype.setWindowAttributes=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.winAttr;return _=m[++o],S.fillOpacity=(192&_)>>6,S.fillRed=(48&_)>>4,S.fillGreen=(12&_)>>2,S.fillBlue=3&_,_=m[++o],S.borderType=(192&_)>>6,S.borderRed=(48&_)>>4,S.borderGreen=(12&_)>>2,S.borderBlue=3&_,_=m[++o],S.borderType+=(128&_)>>5,S.wordWrap=(64&_)>>6,S.printDirection=(48&_)>>4,S.scrollDirection=(12&_)>>2,S.justify=3&_,_=m[++o],S.effectSpeed=(240&_)>>4,S.effectDirection=(12&_)>>2,S.displayEffect=3&_,o},yc.prototype.flushDisplayed=function(o,s){for(var m=[],_=0;_<8;_++)s.windows[_].visible&&!s.windows[_].isEmpty()&&m.push(s.windows[_].getText());s.endPts=o,s.text=m.join("\n\n"),this.pushCaption(s),s.startPts=o},yc.prototype.pushCaption=function(o){""!==o.text&&(this.trigger("data",{startPts:o.startPts,endPts:o.endPts,text:o.text,stream:"cc708_"+o.serviceNum}),o.text="",o.startPts=o.endPts)},yc.prototype.displayWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible=1);return o},yc.prototype.hideWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible=0);return o},yc.prototype.toggleWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible^=1);return o},yc.prototype.clearWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&s.windows[S].clearText();return o},yc.prototype.deleteWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&s.windows[S].reset();return o},yc.prototype.setPenAttributes=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penAttr;return _=m[++o],S.textTag=(240&_)>>4,S.offset=(12&_)>>2,S.penSize=3&_,_=m[++o],S.italics=(128&_)>>7,S.underline=(64&_)>>6,S.edgeType=(56&_)>>3,S.fontStyle=7&_,o},yc.prototype.setPenColor=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penColor;return _=m[++o],S.fgOpacity=(192&_)>>6,S.fgRed=(48&_)>>4,S.fgGreen=(12&_)>>2,S.fgBlue=3&_,_=m[++o],S.bgOpacity=(192&_)>>6,S.bgRed=(48&_)>>4,S.bgGreen=(12&_)>>2,S.bgBlue=3&_,_=m[++o],S.edgeRed=(48&_)>>4,S.edgeGreen=(12&_)>>2,S.edgeBlue=3&_,o},yc.prototype.setPenLocation=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penLoc;return s.currentWindow.pendingNewLine=!0,_=m[++o],S.row=15&_,_=m[++o],S.column=63&_,o},yc.prototype.reset=function(o,s){var m=this.getPts(o);return this.flushDisplayed(m,s),this.initService(s.serviceNum,o)};var _c={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},kc=function getCharFromCode(o){return null===o?"":(o=_c[o]||o,String.fromCharCode(o))},Ec=14,Ac=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Dc=function createDisplayBuffer(){for(var o=[],s=Ec+1;s--;)o.push("");return o},Mc=function Cea608Stream(o,s){Cea608Stream.prototype.init.call(this),this.field_=o||0,this.dataChannel_=s||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(o){var s,m,_,S,E;if((s=32639&o.ccData)!==this.lastControlCode_){if(4096==(61440&s)?this.lastControlCode_=s:s!==this.PADDING_&&(this.lastControlCode_=null),_=s>>>8,S=255&s,s!==this.PADDING_)if(s===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(s===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(o.pts),this.flushDisplayed(o.pts),m=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=m,this.startPts_=o.pts;else if(s===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(o.pts);else if(s===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(o.pts);else if(s===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(o.pts);else if(s===this.CARRIAGE_RETURN_)this.clearFormatting(o.pts),this.flushDisplayed(o.pts),this.shiftRowsUp_(),this.startPts_=o.pts;else if(s===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(s===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(o.pts),this.displayed_=Dc();else if(s===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Dc();else if(s===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(o.pts),this.displayed_=Dc()),this.mode_="paintOn",this.startPts_=o.pts;else if(this.isSpecialCharacter(_,S))E=kc((_=(3&_)<<8)|S),this[this.mode_](o.pts,E),this.column_++;else if(this.isExtCharacter(_,S))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),E=kc((_=(3&_)<<8)|S),this[this.mode_](o.pts,E),this.column_++;else if(this.isMidRowCode(_,S))this.clearFormatting(o.pts),this[this.mode_](o.pts," "),this.column_++,14==(14&S)&&this.addFormatting(o.pts,["i"]),1==(1&S)&&this.addFormatting(o.pts,["u"]);else if(this.isOffsetControlCode(_,S))this.column_+=3&S;else if(this.isPAC(_,S)){var A=Ac.indexOf(7968&s);"rollUp"===this.mode_&&(A-this.rollUpRows_+1<0&&(A=this.rollUpRows_-1),this.setRollUp(o.pts,A)),A!==this.row_&&(this.clearFormatting(o.pts),this.row_=A),1&S&&-1===this.formatting_.indexOf("u")&&this.addFormatting(o.pts,["u"]),16==(16&s)&&(this.column_=4*((14&s)>>1)),this.isColorPAC(S)&&14==(14&S)&&this.addFormatting(o.pts,["i"])}else this.isNormalChar(_)&&(0===S&&(S=null),E=kc(_),E+=kc(S),this[this.mode_](o.pts,E),this.column_+=E.length)}else this.lastControlCode_=null}};Mc.prototype=new z,Mc.prototype.flushDisplayed=function(o){var s=this.displayed_.map((function(o,s){try{return o.trim()}catch(o){return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+s+"."}),""}}),this).join("\n").replace(/^\n+|\n+$/g,"");s.length&&this.trigger("data",{startPts:this.startPts_,endPts:o,text:s,stream:this.name_})},Mc.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Dc(),this.nonDisplayed_=Dc(),this.lastControlCode_=null,this.column_=0,this.row_=Ec,this.rollUpRows_=2,this.formatting_=[]},Mc.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Mc.prototype.isSpecialCharacter=function(o,s){return o===this.EXT_&&s>=48&&s<=63},Mc.prototype.isExtCharacter=function(o,s){return(o===this.EXT_+1||o===this.EXT_+2)&&s>=32&&s<=63},Mc.prototype.isMidRowCode=function(o,s){return o===this.EXT_&&s>=32&&s<=47},Mc.prototype.isOffsetControlCode=function(o,s){return o===this.OFFSET_&&s>=33&&s<=35},Mc.prototype.isPAC=function(o,s){return o>=this.BASE_&&o<this.BASE_+8&&s>=64&&s<=127},Mc.prototype.isColorPAC=function(o){return o>=64&&o<=79||o>=96&&o<=127},Mc.prototype.isNormalChar=function(o){return o>=32&&o<=127},Mc.prototype.setRollUp=function(o,s){if("rollUp"!==this.mode_&&(this.row_=Ec,this.mode_="rollUp",this.flushDisplayed(o),this.nonDisplayed_=Dc(),this.displayed_=Dc()),void 0!==s&&s!==this.row_)for(var m=0;m<this.rollUpRows_;m++)this.displayed_[s-m]=this.displayed_[this.row_-m],this.displayed_[this.row_-m]="";void 0===s&&(s=this.row_),this.topRow_=s-this.rollUpRows_+1},Mc.prototype.addFormatting=function(o,s){this.formatting_=this.formatting_.concat(s);var m=s.reduce((function(o,s){return o+"<"+s+">"}),"");this[this.mode_](o,m)},Mc.prototype.clearFormatting=function(o){if(this.formatting_.length){var s=this.formatting_.reverse().reduce((function(o,s){return o+"</"+s+">"}),"");this.formatting_=[],this[this.mode_](o,s)}},Mc.prototype.popOn=function(o,s){var m=this.nonDisplayed_[this.row_];m+=s,this.nonDisplayed_[this.row_]=m},Mc.prototype.rollUp=function(o,s){var m=this.displayed_[this.row_];m+=s,this.displayed_[this.row_]=m},Mc.prototype.shiftRowsUp_=function(){var o;for(o=0;o<this.topRow_;o++)this.displayed_[o]="";for(o=this.row_+1;o<Ec+1;o++)this.displayed_[o]="";for(o=this.topRow_;o<this.row_;o++)this.displayed_[o]=this.displayed_[o+1];this.displayed_[this.row_]=""},Mc.prototype.paintOn=function(o,s){var m=this.displayed_[this.row_];m+=s,this.displayed_[this.row_]=m};var jc={CaptionStream:Ql,Cea608Stream:Mc,Cea708Stream:yc},zc={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},qc=8589934592,Xc=4294967296,_d="shared",Cd=function handleRollover(o,s){var m=1;for(o>s&&(m=-1);Math.abs(s-o)>Xc;)o+=m*qc;return o},Ad=function TimestampRolloverStream(o){var s,m;TimestampRolloverStream.prototype.init.call(this),this.type_=o||_d,this.push=function(o){this.type_!==_d&&o.type!==this.type_||(void 0===m&&(m=o.dts),o.dts=Cd(o.dts,m),o.pts=Cd(o.pts,m),s=o.dts,this.trigger("data",o))},this.flush=function(){m=s,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){m=void 0,s=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Ad.prototype=new z;var Rd,Ud={TimestampRolloverStream:Ad,handleRollover:Cd};Rd=function MetadataStream(o){var s,m={descriptor:o&&o.descriptor},_=0,S=[],E=0;if(Rd.prototype.init.call(this),this.dispatchType=zc.METADATA_STREAM_TYPE.toString(16),m.descriptor)for(s=0;s<m.descriptor.length;s++)this.dispatchType+=("00"+m.descriptor[s].toString(16)).slice(-2);this.push=function(o){var s,m,A,O,H;if("timed-metadata"===o.type)if(o.dataAlignmentIndicator&&(E=0,S.length=0),0===S.length&&(o.data.length<10||o.data[0]!=="I".charCodeAt(0)||o.data[1]!=="D".charCodeAt(0)||o.data[2]!=="3".charCodeAt(0)))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(S.push(o),E+=o.data.byteLength,1===S.length&&(_=ho.parseSyncSafeInteger(o.data.subarray(6,10)),_+=10),!(E<_)){for(s={data:new Uint8Array(_),frames:[],pts:S[0].pts,dts:S[0].dts},H=0;H<_;)s.data.set(S[0].data.subarray(0,_-H),H),H+=S[0].data.byteLength,E-=S[0].data.byteLength,S.shift();m=10,64&s.data[5]&&(m+=4,m+=ho.parseSyncSafeInteger(s.data.subarray(10,14)),_-=ho.parseSyncSafeInteger(s.data.subarray(16,20)));do{if((A=ho.parseSyncSafeInteger(s.data.subarray(m+4,m+8)))<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if((O={id:String.fromCharCode(s.data[m],s.data[m+1],s.data[m+2],s.data[m+3]),data:s.data.subarray(m+10,m+A+10)}).key=O.id,ho.frameParsers[O.id]?ho.frameParsers[O.id](O):"T"===O.id[0]?ho.frameParsers["T*"](O):"W"===O.id[0]&&ho.frameParsers["W*"](O),"com.apple.streaming.transportStreamTimestamp"===O.owner){var K=O.data,z=(1&K[3])<<30|K[4]<<22|K[5]<<14|K[6]<<6|K[7]>>>2;z*=4,z+=3&K[7],O.timeStamp=z,void 0===s.pts&&void 0===s.dts&&(s.pts=O.timeStamp,s.dts=O.timeStamp),this.trigger("timestamp",O)}s.frames.push(O),m+=10,m+=A}while(m<_);this.trigger("data",s)}}},Rd.prototype=new z;var Vd,zd,qd,eh=Rd,uh=Ud.TimestampRolloverStream,hh=188,mh=71;(Vd=function TransportPacketStream(){var o=new Uint8Array(hh),s=0;Vd.prototype.init.call(this),this.push=function(m){var _,S=0,E=hh;for(s?((_=new Uint8Array(m.byteLength+s)).set(o.subarray(0,s)),_.set(m,s),s=0):_=m;E<_.byteLength;)_[S]!==mh||_[E]!==mh?(S++,E++):(this.trigger("data",_.subarray(S,E)),S+=hh,E+=hh);S<_.byteLength&&(o.set(_.subarray(S),0),s=_.byteLength-S)},this.flush=function(){s===hh&&o[0]===mh&&(this.trigger("data",o),s=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){s=0,this.trigger("reset")}}).prototype=new z,(zd=function TransportParseStream(){var o,s,m,_;zd.prototype.init.call(this),_=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,o=function parsePsi(o,_){var S=0;_.payloadUnitStartIndicator&&(S+=o[S]+1),"pat"===_.type?s(o.subarray(S),_):m(o.subarray(S),_)},s=function parsePat(o,s){s.section_number=o[7],s.last_section_number=o[8],_.pmtPid=(31&o[10])<<8|o[11],s.pmtPid=_.pmtPid},m=function parsePmt(o,s){var m,S;if(1&o[5]){for(_.programMapTable={video:null,audio:null,"timed-metadata":{}},m=3+((15&o[1])<<8|o[2])-4,S=12+((15&o[10])<<8|o[11]);S<m;){var E=o[S],A=(31&o[S+1])<<8|o[S+2];E===zc.H264_STREAM_TYPE&&null===_.programMapTable.video?_.programMapTable.video=A:E===zc.ADTS_STREAM_TYPE&&null===_.programMapTable.audio?_.programMapTable.audio=A:E===zc.METADATA_STREAM_TYPE&&(_.programMapTable["timed-metadata"][A]=E),S+=5+((15&o[S+3])<<8|o[S+4])}s.programMapTable=_.programMapTable}},this.push=function(s){var m={},_=4;if(m.payloadUnitStartIndicator=!!(64&s[1]),m.pid=31&s[1],m.pid<<=8,m.pid|=s[2],(48&s[3])>>>4>1&&(_+=s[_]+1),0===m.pid)m.type="pat",o(s.subarray(_),m),this.trigger("data",m);else if(m.pid===this.pmtPid)for(m.type="pmt",o(s.subarray(_),m),this.trigger("data",m);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([s,_,m]):this.processPes_(s,_,m)},this.processPes_=function(o,s,m){m.pid===this.programMapTable.video?m.streamType=zc.H264_STREAM_TYPE:m.pid===this.programMapTable.audio?m.streamType=zc.ADTS_STREAM_TYPE:m.streamType=this.programMapTable["timed-metadata"][m.pid],m.type="pes",m.data=o.subarray(s),this.trigger("data",m)}}).prototype=new z,zd.STREAM_TYPES={h264:27,adts:15},qd=function ElementaryStream(){var o,s=this,m=!1,_={data:[],size:0},S={data:[],size:0},E={data:[],size:0},A=function parsePes(o,s){var m,_=o[0]<<16|o[1]<<8|o[2];s.data=new Uint8Array,1===_&&(s.packetLength=6+(o[4]<<8|o[5]),s.dataAlignmentIndicator=0!=(4&o[6]),192&(m=o[7])&&(s.pts=(14&o[9])<<27|(255&o[10])<<20|(254&o[11])<<12|(255&o[12])<<5|(254&o[13])>>>3,s.pts*=4,s.pts+=(6&o[13])>>>1,s.dts=s.pts,64&m&&(s.dts=(14&o[14])<<27|(255&o[15])<<20|(254&o[16])<<12|(255&o[17])<<5|(254&o[18])>>>3,s.dts*=4,s.dts+=(6&o[18])>>>1)),s.data=o.subarray(9+o[8]))},O=function flushStream(o,m,_){var S,E=new Uint8Array(o.size),O={type:m},H=0,K=0,z=!1;if(o.data.length&&!(o.size<9)){for(O.trackId=o.data[0].pid,H=0;H<o.data.length;H++)S=o.data[H],E.set(S.data,K),K+=S.data.byteLength;A(E,O),z="video"===m||O.packetLength<=o.size,(_||z)&&(o.size=0,o.data.length=0),z&&s.trigger("data",O)}};qd.prototype.init.call(this),this.push=function(A){({pat:function pat(){},pes:function pes(){var o,s;switch(A.streamType){case zc.H264_STREAM_TYPE:o=_,s="video";break;case zc.ADTS_STREAM_TYPE:o=S,s="audio";break;case zc.METADATA_STREAM_TYPE:o=E,s="timed-metadata";break;default:return}A.payloadUnitStartIndicator&&O(o,s,!0),o.data.push(A),o.size+=A.data.byteLength},pmt:function pmt(){var _={type:"metadata",tracks:[]};null!==(o=A.programMapTable).video&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.video,codec:"avc",type:"video"}),null!==o.audio&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.audio,codec:"adts",type:"audio"}),m=!0,s.trigger("data",_)}})[A.type]()},this.reset=function(){_.size=0,_.data.length=0,S.size=0,S.data.length=0,this.trigger("reset")},this.flushStreams_=function(){O(_,"video"),O(S,"audio"),O(E,"timed-metadata")},this.flush=function(){if(!m&&o){var _={type:"metadata",tracks:[]};null!==o.video&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.video,codec:"avc",type:"video"}),null!==o.audio&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.audio,codec:"adts",type:"audio"}),s.trigger("data",_)}m=!1,this.flushStreams_(),this.trigger("done")}},qd.prototype=new z;var vh={PAT_PID:0,MP2T_PACKET_LENGTH:hh,TransportPacketStream:Vd,TransportParseStream:zd,ElementaryStream:qd,TimestampRolloverStream:uh,CaptionStream:jc.CaptionStream,Cea608Stream:jc.Cea608Stream,Cea708Stream:jc.Cea708Stream,MetadataStream:eh};for(var _h in zc)zc.hasOwnProperty(_h)&&(vh[_h]=zc[_h]);var bh,kh=vh,qh=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],np=function parseId3TagSize(o,s){var m=o[s+6]<<21|o[s+7]<<14|o[s+8]<<7|o[s+9];return m=m>=0?m:0,(16&o[s+5])>>4?m+20:m+10},ap=function getId3Offset(o,s){return o.length-s<10||o[s]!=="I".charCodeAt(0)||o[s+1]!=="D".charCodeAt(0)||o[s+2]!=="3".charCodeAt(0)?s:getId3Offset(o,s+=np(o,s))},mp=function isLikelyAacData(o){var s=ap(o,0);return o.length>=s+2&&255==(255&o[s])&&240==(240&o[s+1])&&16==(22&o[s+1])},yp=function parseSyncSafeInteger(o){return o[0]<<21|o[1]<<14|o[2]<<7|o[3]},vp=function percentEncode(o,s,m){var _,S="";for(_=s;_<m;_++)S+="%"+("00"+o[_].toString(16)).slice(-2);return S},_p=function parseIso88591(o,s,m){return unescape(vp(o,s,m))},bp=function parseSampleRate(o){for(var s=0;s+5<o.length;){if(255===o[s]&&240==(246&o[s+1]))return qh[(60&o[s+2])>>>2];s++}return null},wp=function parseAacTimestamp(o){var s,m,_;s=10,64&o[5]&&(s+=4,s+=yp(o.subarray(10,14)));do{if((m=yp(o.subarray(s+4,s+8)))<1)return null;if("PRIV"===String.fromCharCode(o[s],o[s+1],o[s+2],o[s+3])){_=o.subarray(s+10,s+m+10);for(var S=0;S<_.byteLength;S++)if(0===_[S]){if("com.apple.streaming.transportStreamTimestamp"===_p(_,0,S)){var E=_.subarray(S+1),A=(1&E[3])<<30|E[4]<<22|E[5]<<14|E[6]<<6|E[7]>>>2;return A*=4,A+=3&E[7]}break}}s+=10,s+=m}while(s<o.byteLength);return null},Ip={isLikelyAacData:mp,parseId3TagSize:np,parseAdtsSize:function parseAdtsSize(o,s){var m=(224&o[s+5])>>5,_=o[s+4]<<3;return 6144&o[s+3]|_|m},parseType:function parseType(o,s){return o[s]==="I".charCodeAt(0)&&o[s+1]==="D".charCodeAt(0)&&o[s+2]==="3".charCodeAt(0)?"timed-metadata":!0&o[s]&&240==(240&o[s+1])?"audio":null},parseSampleRate:bp,parseAacTimestamp:wp};(bh=function AacStream(){var o=new Uint8Array,s=0;bh.prototype.init.call(this),this.setTimestamp=function(o){s=o},this.push=function(m){var _,S,E,A,O=0,H=0;for(o.length?(A=o.length,(o=new Uint8Array(m.byteLength+A)).set(o.subarray(0,A)),o.set(m,A)):o=m;o.length-H>=3;)if(o[H]!=="I".charCodeAt(0)||o[H+1]!=="D".charCodeAt(0)||o[H+2]!=="3".charCodeAt(0))if(255!=(255&o[H])||240!=(240&o[H+1]))H++;else{if(o.length-H<7)break;if(H+(O=Ip.parseAdtsSize(o,H))>o.length)break;E={type:"audio",data:o.subarray(H,H+O),pts:s,dts:s},this.trigger("data",E),H+=O}else{if(o.length-H<10)break;if(H+(O=Ip.parseId3TagSize(o,H))>o.length)break;S={type:"timed-metadata",data:o.subarray(H,H+O)},this.trigger("data",S),H+=O}_=o.length-H,o=_>0?o.subarray(H):new Uint8Array},this.reset=function(){o=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){o=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new z;var zp,Wp,Jp,af,hf=bh,pf=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],_f=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Ef=qn.H264Stream,If=Ip.isLikelyAacData,zf=X.ONE_SECOND_IN_TS,Jf=function retriggerForStream(o,s){s.stream=o,this.trigger("log",s)},sg=function addPipelineLogRetriggers(o,s){for(var m=Object.keys(s),_=0;_<m.length;_++){var S=m[_];"headOfPipeline"!==S&&s[S].on&&s[S].on("log",Jf.bind(o,S))}},_g=function arrayEquals(o,s){var m;if(o.length!==s.length)return!1;for(m=0;m<o.length;m++)if(o[m]!==s[m])return!1;return!0},$g=function generateSegmentTimingInfo(o,s,m,_,S,E){return{start:{dts:o,pts:o+(m-s)},end:{dts:o+(_-s),pts:o+(S-m)},prependedContentDuration:E,baseMediaDecodeTime:o}};Wp=function AudioSegmentStream(o,s){var m,_=[],S=0,E=0,A=1/0;m=(s=s||{}).firstSequenceNumber||0,Wp.prototype.init.call(this),this.push=function(s){Ys.collectDtsInfo(o,s),o&&pf.forEach((function(m){o[m]=s[m]})),_.push(s)},this.setEarliestDts=function(o){S=o},this.setVideoBaseMediaDecodeTime=function(o){A=o},this.setAudioAppendStart=function(o){E=o},this.flush=function(){var O,H,K,z,G,q,J;0!==_.length?(O=Bs.trimAdtsFramesByEarliestDts(_,o,S),o.baseMediaDecodeTime=Ys.calculateTrackBaseMediaDecodeTime(o,s.keepOriginalTimestamps),J=Bs.prefixWithSilence(o,O,E,A),o.samples=Bs.generateSampleTable(O),K=bi.mdat(Bs.concatenateFrameData(O)),_=[],H=bi.moof(m,[o]),z=new Uint8Array(H.byteLength+K.byteLength),m++,z.set(H),z.set(K,H.byteLength),Ys.clearDtsInfo(o),G=Math.ceil(1024*zf/o.samplerate),O.length&&(q=O.length*G,this.trigger("segmentTimingInfo",$g(X.audioTsToVideoTs(o.baseMediaDecodeTime,o.samplerate),O[0].dts,O[0].pts,O[0].dts+q,O[0].pts+q,J||0)),this.trigger("timingInfo",{start:O[0].pts,end:O[0].pts+q})),this.trigger("data",{track:o,boxes:z}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){Ys.clearDtsInfo(o),_=[],this.trigger("reset")}},Wp.prototype=new z,zp=function VideoSegmentStream(o,s){var m,_,S,E=[],A=[];m=(s=s||{}).firstSequenceNumber||0,zp.prototype.init.call(this),delete o.minPTS,this.gopCache_=[],this.push=function(s){Ys.collectDtsInfo(o,s),"seq_parameter_set_rbsp"!==s.nalUnitType||_||(_=s.config,o.sps=[s.data],_f.forEach((function(s){o[s]=_[s]}),this)),"pic_parameter_set_rbsp"!==s.nalUnitType||S||(S=s.data,o.pps=[s.data]),E.push(s)},this.flush=function(){for(var _,S,O,H,K,z,G,q,X=0;E.length&&"access_unit_delimiter_rbsp"!==E[0].nalUnitType;)E.shift();if(0===E.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(_=Vo.groupNalsIntoFrames(E),(O=Vo.groupFramesIntoGops(_))[0][0].keyFrame||((S=this.getGopForFusion_(E[0],o))?(X=S.duration,O.unshift(S),O.byteLength+=S.byteLength,O.nalCount+=S.nalCount,O.pts=S.pts,O.dts=S.dts,O.duration+=S.duration):O=Vo.extendFirstKeyFrame(O)),A.length){var J;if(!(J=s.alignGopsAtEnd?this.alignGopsAtEnd_(O):this.alignGopsAtStart_(O)))return this.gopCache_.unshift({gop:O.pop(),pps:o.pps,sps:o.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Ys.clearDtsInfo(o),O=J}Ys.collectDtsInfo(o,O),o.samples=Vo.generateSampleTable(O),K=bi.mdat(Vo.concatenateNalData(O)),o.baseMediaDecodeTime=Ys.calculateTrackBaseMediaDecodeTime(o,s.keepOriginalTimestamps),this.trigger("processedGopsInfo",O.map((function(o){return{pts:o.pts,dts:o.dts,byteLength:o.byteLength}}))),G=O[0],q=O[O.length-1],this.trigger("segmentTimingInfo",$g(o.baseMediaDecodeTime,G.dts,G.pts,q.dts+q.duration,q.pts+q.duration,X)),this.trigger("timingInfo",{start:O[0].pts,end:O[O.length-1].pts+O[O.length-1].duration}),this.gopCache_.unshift({gop:O.pop(),pps:o.pps,sps:o.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.trigger("baseMediaDecodeTime",o.baseMediaDecodeTime),this.trigger("timelineStartInfo",o.timelineStartInfo),H=bi.moof(m,[o]),z=new Uint8Array(H.byteLength+K.byteLength),m++,z.set(H),z.set(K,H.byteLength),this.trigger("data",{track:o,boxes:z}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),E=[],this.gopCache_.length=0,A.length=0,this.trigger("reset")},this.resetStream_=function(){Ys.clearDtsInfo(o),_=void 0,S=void 0},this.getGopForFusion_=function(s){var m,_,S,E,A,O=45e3,H=1e4,K=1/0;for(A=0;A<this.gopCache_.length;A++)S=(E=this.gopCache_[A]).gop,o.pps&&_g(o.pps[0],E.pps[0])&&o.sps&&_g(o.sps[0],E.sps[0])&&(S.dts<o.timelineStartInfo.dts||(m=s.dts-S.dts-S.duration)>=-H&&m<=O&&(!_||K>m)&&(_=E,K=m));return _?_.gop:null},this.alignGopsAtStart_=function(o){var s,m,_,S,E,O,H,K;for(E=o.byteLength,O=o.nalCount,H=o.duration,s=m=0;s<A.length&&m<o.length&&(_=A[s],S=o[m],_.pts!==S.pts);)S.pts>_.pts?s++:(m++,E-=S.byteLength,O-=S.nalCount,H-=S.duration);return 0===m?o:m===o.length?null:((K=o.slice(m)).byteLength=E,K.duration=H,K.nalCount=O,K.pts=K[0].pts,K.dts=K[0].dts,K)},this.alignGopsAtEnd_=function(o){var s,m,_,S,E,O,H;for(s=A.length-1,m=o.length-1,E=null,O=!1;s>=0&&m>=0;){if(_=A[s],S=o[m],_.pts===S.pts){O=!0;break}_.pts>S.pts?s--:(s===A.length-1&&(E=m),m--)}if(!O&&null===E)return null;if(0===(H=O?m:E))return o;var K=o.slice(H),z=K.reduce((function(o,s){return o.byteLength+=s.byteLength,o.duration+=s.duration,o.nalCount+=s.nalCount,o}),{byteLength:0,duration:0,nalCount:0});return K.byteLength=z.byteLength,K.duration=z.duration,K.nalCount=z.nalCount,K.pts=K[0].pts,K.dts=K[0].dts,K},this.alignGopsWith=function(o){A=o}},zp.prototype=new z,(af=function CoalesceStream(o,s){this.numberOfTracks=0,this.metadataStream=s,void 0!==(o=o||{}).remux?this.remuxTracks=!!o.remux:this.remuxTracks=!0,"boolean"==typeof o.keepOriginalTimestamps?this.keepOriginalTimestamps=o.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,af.prototype.init.call(this),this.push=function(o){return o.text?this.pendingCaptions.push(o):o.frames?this.pendingMetadata.push(o):(this.pendingTracks.push(o.track),this.pendingBytes+=o.boxes.byteLength,"video"===o.track.type&&(this.videoTrack=o.track,this.pendingBoxes.push(o.boxes)),void("audio"===o.track.type&&(this.audioTrack=o.track,this.pendingBoxes.unshift(o.boxes))))}}).prototype=new z,af.prototype.flush=function(o){var s,m,_,S,E=0,A={captions:[],captionStreams:{},metadata:[],info:{}},O=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==o&&"AudioSegmentStream"!==o)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(O=this.videoTrack.timelineStartInfo.pts,_f.forEach((function(o){A.info[o]=this.videoTrack[o]}),this)):this.audioTrack&&(O=this.audioTrack.timelineStartInfo.pts,pf.forEach((function(o){A.info[o]=this.audioTrack[o]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?A.type=this.pendingTracks[0].type:A.type="combined",this.emittedTracks+=this.pendingTracks.length,_=bi.initSegment(this.pendingTracks),A.initSegment=new Uint8Array(_.byteLength),A.initSegment.set(_),A.data=new Uint8Array(this.pendingBytes),S=0;S<this.pendingBoxes.length;S++)A.data.set(this.pendingBoxes[S],E),E+=this.pendingBoxes[S].byteLength;for(S=0;S<this.pendingCaptions.length;S++)(s=this.pendingCaptions[S]).startTime=X.metadataTsToSeconds(s.startPts,O,this.keepOriginalTimestamps),s.endTime=X.metadataTsToSeconds(s.endPts,O,this.keepOriginalTimestamps),A.captionStreams[s.stream]=!0,A.captions.push(s);for(S=0;S<this.pendingMetadata.length;S++)(m=this.pendingMetadata[S]).cueTime=X.metadataTsToSeconds(m.pts,O,this.keepOriginalTimestamps),A.metadata.push(m);for(A.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",A),S=0;S<A.captions.length;S++)s=A.captions[S],this.trigger("caption",s);for(S=0;S<A.metadata.length;S++)m=A.metadata[S],this.trigger("id3Frame",m)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},af.prototype.setRemux=function(o){this.remuxTracks=o},Jp=function Transmuxer(o){var s,m,_=this,S=!0;Jp.prototype.init.call(this),o=o||{},this.baseMediaDecodeTime=o.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var S={};this.transmuxPipeline_=S,S.type="aac",S.metadataStream=new kh.MetadataStream,S.aacStream=new hf,S.audioTimestampRolloverStream=new kh.TimestampRolloverStream("audio"),S.timedMetadataTimestampRolloverStream=new kh.TimestampRolloverStream("timed-metadata"),S.adtsStream=new me,S.coalesceStream=new af(o,S.metadataStream),S.headOfPipeline=S.aacStream,S.aacStream.pipe(S.audioTimestampRolloverStream).pipe(S.adtsStream),S.aacStream.pipe(S.timedMetadataTimestampRolloverStream).pipe(S.metadataStream).pipe(S.coalesceStream),S.metadataStream.on("timestamp",(function(o){S.aacStream.setTimestamp(o.timeStamp)})),S.aacStream.on("data",(function(E){"timed-metadata"!==E.type&&"audio"!==E.type||S.audioSegmentStream||(m=m||{timelineStartInfo:{baseMediaDecodeTime:_.baseMediaDecodeTime},codec:"adts",type:"audio"},S.coalesceStream.numberOfTracks++,S.audioSegmentStream=new Wp(m,o),S.audioSegmentStream.on("log",_.getLogTrigger_("audioSegmentStream")),S.audioSegmentStream.on("timingInfo",_.trigger.bind(_,"audioTimingInfo")),S.adtsStream.pipe(S.audioSegmentStream).pipe(S.coalesceStream),_.trigger("trackinfo",{hasAudio:!!m,hasVideo:!!s}))})),S.coalesceStream.on("data",this.trigger.bind(this,"data")),S.coalesceStream.on("done",this.trigger.bind(this,"done")),sg(this,S)},this.setupTsPipeline=function(){var S={};this.transmuxPipeline_=S,S.type="ts",S.metadataStream=new kh.MetadataStream,S.packetStream=new kh.TransportPacketStream,S.parseStream=new kh.TransportParseStream,S.elementaryStream=new kh.ElementaryStream,S.timestampRolloverStream=new kh.TimestampRolloverStream,S.adtsStream=new me,S.h264Stream=new Ef,S.captionStream=new kh.CaptionStream(o),S.coalesceStream=new af(o,S.metadataStream),S.headOfPipeline=S.packetStream,S.packetStream.pipe(S.parseStream).pipe(S.elementaryStream).pipe(S.timestampRolloverStream),S.timestampRolloverStream.pipe(S.h264Stream),S.timestampRolloverStream.pipe(S.adtsStream),S.timestampRolloverStream.pipe(S.metadataStream).pipe(S.coalesceStream),S.h264Stream.pipe(S.captionStream).pipe(S.coalesceStream),S.elementaryStream.on("data",(function(E){var A;if("metadata"===E.type){for(A=E.tracks.length;A--;)s||"video"!==E.tracks[A].type?m||"audio"!==E.tracks[A].type||((m=E.tracks[A]).timelineStartInfo.baseMediaDecodeTime=_.baseMediaDecodeTime):(s=E.tracks[A]).timelineStartInfo.baseMediaDecodeTime=_.baseMediaDecodeTime;s&&!S.videoSegmentStream&&(S.coalesceStream.numberOfTracks++,S.videoSegmentStream=new zp(s,o),S.videoSegmentStream.on("log",_.getLogTrigger_("videoSegmentStream")),S.videoSegmentStream.on("timelineStartInfo",(function(s){m&&!o.keepOriginalTimestamps&&(m.timelineStartInfo=s,S.audioSegmentStream.setEarliestDts(s.dts-_.baseMediaDecodeTime))})),S.videoSegmentStream.on("processedGopsInfo",_.trigger.bind(_,"gopInfo")),S.videoSegmentStream.on("segmentTimingInfo",_.trigger.bind(_,"videoSegmentTimingInfo")),S.videoSegmentStream.on("baseMediaDecodeTime",(function(o){m&&S.audioSegmentStream.setVideoBaseMediaDecodeTime(o)})),S.videoSegmentStream.on("timingInfo",_.trigger.bind(_,"videoTimingInfo")),S.h264Stream.pipe(S.videoSegmentStream).pipe(S.coalesceStream)),m&&!S.audioSegmentStream&&(S.coalesceStream.numberOfTracks++,S.audioSegmentStream=new Wp(m,o),S.audioSegmentStream.on("log",_.getLogTrigger_("audioSegmentStream")),S.audioSegmentStream.on("timingInfo",_.trigger.bind(_,"audioTimingInfo")),S.audioSegmentStream.on("segmentTimingInfo",_.trigger.bind(_,"audioSegmentTimingInfo")),S.adtsStream.pipe(S.audioSegmentStream).pipe(S.coalesceStream)),_.trigger("trackinfo",{hasAudio:!!m,hasVideo:!!s})}})),S.coalesceStream.on("data",this.trigger.bind(this,"data")),S.coalesceStream.on("id3Frame",(function(o){o.dispatchType=S.metadataStream.dispatchType,_.trigger("id3Frame",o)})),S.coalesceStream.on("caption",this.trigger.bind(this,"caption")),S.coalesceStream.on("done",this.trigger.bind(this,"done")),sg(this,S)},this.setBaseMediaDecodeTime=function(_){var S=this.transmuxPipeline_;o.keepOriginalTimestamps||(this.baseMediaDecodeTime=_),m&&(m.timelineStartInfo.dts=void 0,m.timelineStartInfo.pts=void 0,Ys.clearDtsInfo(m),S.audioTimestampRolloverStream&&S.audioTimestampRolloverStream.discontinuity()),s&&(S.videoSegmentStream&&(S.videoSegmentStream.gopCache_=[]),s.timelineStartInfo.dts=void 0,s.timelineStartInfo.pts=void 0,Ys.clearDtsInfo(s),S.captionStream.reset()),S.timestampRolloverStream&&S.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(o){m&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(o)},this.setRemux=function(s){var m=this.transmuxPipeline_;o.remux=s,m&&m.coalesceStream&&m.coalesceStream.setRemux(s)},this.alignGopsWith=function(o){s&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(o)},this.getLogTrigger_=function(o){var s=this;return function(m){m.stream=o,s.trigger("log",m)}},this.push=function(o){if(S){var s=If(o);s&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():s||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),S=!1}this.transmuxPipeline_.headOfPipeline.push(o)},this.flush=function(){S=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Jp.prototype=new z;var lm,_m={Transmuxer:Jp,VideoSegmentStream:zp,AudioSegmentStream:Wp,AUDIO_PROPERTIES:pf,VIDEO_PROPERTIES:_f,generateSegmentTimingInfo:$g},Sm=Pl.discardEmulationPreventionBytes,zm=jc.CaptionStream,Xm=function mapToSample(o,s){for(var m=o,_=0;_<s.length;_++){var S=s[_];if(m<S.size)return S;m-=S.size}return null},Ym=function findSeiNals(o,s,m){var _,S,E,A,O=new DataView(o.buffer,o.byteOffset,o.byteLength),H={logs:[],seiNals:[]};for(S=0;S+4<o.length;S+=E)if(E=O.getUint32(S),S+=4,!(E<=0))switch(31&o[S]){case 6:var K=o.subarray(S+1,S+1+E),z=Xm(S,s);if(_={nalUnitType:"sei_rbsp",size:E,data:K,escapedRBSP:Sm(K),trackId:m},z)_.pts=z.pts,_.dts=z.dts,A=z;else{if(!A){H.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+S+" for trackId "+m+". See mux.js#223."});break}_.pts=A.pts,_.dts=A.dts}H.seiNals.push(_)}return H},Zm=function parseSamples(o,m,_){var S=m,E=_.defaultSampleDuration||0,A=_.defaultSampleSize||0,O=_.trackId,H=[];return o.forEach((function(o){var m=xa(o).samples;m.forEach((function(o){void 0===o.duration&&(o.duration=E),void 0===o.size&&(o.size=A),o.trackId=O,o.dts=S,void 0===o.compositionTimeOffset&&(o.compositionTimeOffset=0),"bigint"==typeof S?(o.pts=S+s.default.BigInt(o.compositionTimeOffset),S+=s.default.BigInt(o.duration)):(o.pts=S+o.compositionTimeOffset,S+=o.duration)})),H=H.concat(m)})),H},ay=function parseCaptionNals(o,s){var m=oa(o,["moof","traf"]),_=oa(o,["mdat"]),S={},E=[];return _.forEach((function(o,s){var _=m[s];E.push({mdat:o,traf:_})})),E.forEach((function(o){var m,_,E=o.mdat,A=o.traf,O=oa(A,["tfhd"]),H=Sa(O[0]),K=H.trackId,z=oa(A,["tfdt"]),G=z.length>0?Va(z[0]).baseMediaDecodeTime:0,q=oa(A,["trun"]);s===K&&q.length>0&&(m=Zm(q,G,H),_=Ym(E,m,K),S[K]||(S[K]={seiNals:[],logs:[]}),S[K].seiNals=S[K].seiNals.concat(_.seiNals),S[K].logs=S[K].logs.concat(_.logs))})),S},uy=function parseEmbeddedCaptions(o,s,m){if(null===s)return null;var _=ay(o,s)[s]||{};return{seiNals:_.seiNals,logs:_.logs,timescale:m}},hy=function CaptionParser(){var o,s,m,_,S,E,A=!1;this.isInitialized=function(){return A},this.init=function(s){o=new zm,A=!0,E=!!s&&s.isPartial,o.on("data",(function(o){o.startTime=o.startPts/_,o.endTime=o.endPts/_,S.captions.push(o),S.captionStreams[o.stream]=!0})),o.on("log",(function(o){S.logs.push(o)}))},this.isNewInit=function(o,s){return!(o&&0===o.length||s&&"object"==typeof s&&0===Object.keys(s).length||m===o[0]&&_===s[m])},this.parse=function(o,E,A){var O;if(!this.isInitialized())return null;if(!E||!A)return null;if(this.isNewInit(E,A))m=E[0],_=A[m];else if(null===m||!_)return s.push(o),null;for(;s.length>0;){var H=s.shift();this.parse(H,E,A)}return(O=uy(o,m,_))&&O.logs&&(S.logs=S.logs.concat(O.logs)),null!==O&&O.seiNals?(this.pushNals(O.seiNals),this.flushStream(),S):S.logs.length?{logs:S.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(s){if(!this.isInitialized()||!s||0===s.length)return null;s.forEach((function(s){o.push(s)}))},this.flushStream=function(){if(!this.isInitialized())return null;E?o.partialFlush():o.flush()},this.clearParsedCaptions=function(){S.captions=[],S.captionStreams={},S.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;o.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){s=[],m=null,_=null,S?this.clearParsedCaptions():S={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},vy=hy,_y={generator:bi,probe:Eo,Transmuxer:_m.Transmuxer,AudioSegmentStream:_m.AudioSegmentStream,VideoSegmentStream:_m.VideoSegmentStream,CaptionParser:vy};lm=function FlvTag(o,s){var m,_=0,S=16384,E=function prepareWrite(o,s){var m,_=o.position+s;_<o.bytes.byteLength||((m=new Uint8Array(2*_)).set(o.bytes.subarray(0,o.position),0),o.bytes=m,o.view=new DataView(o.bytes.buffer))},A=lm.widthBytes||new Uint8Array("width".length),O=lm.heightBytes||new Uint8Array("height".length),H=lm.videocodecidBytes||new Uint8Array("videocodecid".length);if(!lm.widthBytes){for(m=0;m<"width".length;m++)A[m]="width".charCodeAt(m);for(m=0;m<"height".length;m++)O[m]="height".charCodeAt(m);for(m=0;m<"videocodecid".length;m++)H[m]="videocodecid".charCodeAt(m);lm.widthBytes=A,lm.heightBytes=O,lm.videocodecidBytes=H}switch(this.keyFrame=!1,o){case lm.VIDEO_TAG:this.length=16,S*=6;break;case lm.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case lm.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw new Error("Unknown FLV tag type")}this.bytes=new Uint8Array(S),this.view=new DataView(this.bytes.buffer),this.bytes[0]=o,this.position=this.length,this.keyFrame=s,this.pts=0,this.dts=0,this.writeBytes=function(o,s,m){var _,S=s||0;_=S+(m=m||o.byteLength),E(this,m),this.bytes.set(o.subarray(S,_),this.position),this.position+=m,this.length=Math.max(this.length,this.position)},this.writeByte=function(o){E(this,1),this.bytes[this.position]=o,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(o){E(this,2),this.view.setUint16(this.position,o),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(o){return this.bytes[this.length-o]},this.nalUnitSize=function(){return 0===_?0:this.length-(_+4)},this.startNalUnit=function(){if(_>0)throw new Error("Attempted to create new NAL wihout closing the old one");_=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(o){var s,m;this.length===_+4?this.length-=4:_>0&&(s=_+4,m=this.length-s,this.position=_,this.view.setUint32(this.position,m),this.position=this.length,o&&o.push(this.bytes.subarray(s,s+m))),_=0},this.writeMetaDataDouble=function(o,s){var m;if(E(this,2+o.length+9),this.view.setUint16(this.position,o.length),this.position+=2,"width"===o)this.bytes.set(A,this.position),this.position+=5;else if("height"===o)this.bytes.set(O,this.position),this.position+=6;else if("videocodecid"===o)this.bytes.set(H,this.position),this.position+=12;else for(m=0;m<o.length;m++)this.bytes[this.position]=o.charCodeAt(m),this.position++;this.position++,this.view.setFloat64(this.position,s),this.position+=8,this.length=Math.max(this.length,this.position),++_},this.writeMetaDataBoolean=function(o,s){var m;for(E(this,2),this.view.setUint16(this.position,o.length),this.position+=2,m=0;m<o.length;m++)E(this,1),this.bytes[this.position]=o.charCodeAt(m),this.position++;E(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,s?1:0),this.position++,this.length=Math.max(this.length,this.position),++_},this.finalize=function(){var o,m;switch(this.bytes[0]){case lm.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||s?16:32),this.bytes[12]=s?0:1,o=this.pts-this.dts,this.bytes[13]=(16711680&o)>>>16,this.bytes[14]=(65280&o)>>>8,this.bytes[15]=(255&o)>>>0;break;case lm.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=s?0:1;break;case lm.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,_),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return m=this.length-11,this.bytes[1]=(16711680&m)>>>16,this.bytes[2]=(65280&m)>>>8,this.bytes[3]=(255&m)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,E(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=lm.frameTime(this.bytes),this}},lm.AUDIO_TAG=8,lm.VIDEO_TAG=9,lm.METADATA_TAG=18,lm.isAudioFrame=function(o){return lm.AUDIO_TAG===o[0]},lm.isVideoFrame=function(o){return lm.VIDEO_TAG===o[0]},lm.isMetaData=function(o){return lm.METADATA_TAG===o[0]},lm.isKeyFrame=function(o){return lm.isVideoFrame(o)?23===o[11]:!!lm.isAudioFrame(o)||!!lm.isMetaData(o)},lm.frameTime=function(o){var s=o[4]<<16;return s|=o[5]<<8,s|=o[6]<<0,s|=o[7]<<24};var wy=lm,Ay=function CoalesceStream(o){this.numberOfTracks=0,this.metadataStream=o.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,this.processedTracks=0,CoalesceStream.prototype.init.call(this),this.push=function(o){return o.text?this.pendingCaptions.push(o):o.frames?this.pendingMetadata.push(o):("video"===o.track.type&&(this.videoTrack=o.track,this.videoTags=o.tags,this.pendingTracks++),void("audio"===o.track.type&&(this.audioTrack=o.track,this.audioTags=o.tags,this.pendingTracks++)))}};Ay.prototype=new z,Ay.prototype.flush=function(o){var s,m,_,S,E={tags:{},captions:[],captionStreams:{},metadata:[]};if(this.pendingTracks<this.numberOfTracks){if("VideoSegmentStream"!==o&&"AudioSegmentStream"!==o)return;if(0===this.pendingTracks&&(this.processedTracks++,this.processedTracks<this.numberOfTracks))return}if(this.processedTracks+=this.pendingTracks,this.pendingTracks=0,!(this.processedTracks<this.numberOfTracks)){for(this.videoTrack?S=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(S=this.audioTrack.timelineStartInfo.pts),E.tags.videoTags=this.videoTags,E.tags.audioTags=this.audioTags,_=0;_<this.pendingCaptions.length;_++)(m=this.pendingCaptions[_]).startTime=m.startPts-S,m.startTime/=9e4,m.endTime=m.endPts-S,m.endTime/=9e4,E.captionStreams[m.stream]=!0,E.captions.push(m);for(_=0;_<this.pendingMetadata.length;_++)(s=this.pendingMetadata[_]).cueTime=s.pts-S,s.cueTime/=9e4,E.metadata.push(s);E.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.processedTracks=0,this.trigger("data",E),this.trigger("done")}};var Py,Ly,Ry,Oy,Xy,Qy,tv=Ay,_v=function TagList(){var o=this;this.list=[],this.push=function(o){this.list.push({bytes:o.bytes,dts:o.dts,pts:o.pts,keyFrame:o.keyFrame,metaDataTag:o.metaDataTag})},Object.defineProperty(this,"length",{get:function get(){return o.list.length}})},$v=qn.H264Stream;Oy=function collectTimelineInfo(o,s){"number"==typeof s.pts&&(void 0===o.timelineStartInfo.pts?o.timelineStartInfo.pts=s.pts:o.timelineStartInfo.pts=Math.min(o.timelineStartInfo.pts,s.pts)),"number"==typeof s.dts&&(void 0===o.timelineStartInfo.dts?o.timelineStartInfo.dts=s.dts:o.timelineStartInfo.dts=Math.min(o.timelineStartInfo.dts,s.dts))},Xy=function metaDataTag(o,s){var m=new wy(wy.METADATA_TAG);return m.dts=s,m.pts=s,m.writeMetaDataDouble("videocodecid",7),m.writeMetaDataDouble("width",o.width),m.writeMetaDataDouble("height",o.height),m},Qy=function extraDataTag(o,s){var m,_=new wy(wy.VIDEO_TAG,!0);for(_.dts=s,_.pts=s,_.writeByte(1),_.writeByte(o.profileIdc),_.writeByte(o.profileCompatibility),_.writeByte(o.levelIdc),_.writeByte(255),_.writeByte(225),_.writeShort(o.sps[0].length),_.writeBytes(o.sps[0]),_.writeByte(o.pps.length),m=0;m<o.pps.length;++m)_.writeShort(o.pps[m].length),_.writeBytes(o.pps[m]);return _},(Ry=function AudioSegmentStream(o){var s,m=[],_=[];Ry.prototype.init.call(this),this.push=function(s){Oy(o,s),o&&(o.audioobjecttype=s.audioobjecttype,o.channelcount=s.channelcount,o.samplerate=s.samplerate,o.samplingfrequencyindex=s.samplingfrequencyindex,o.samplesize=s.samplesize,o.extraData=o.audioobjecttype<<11|o.samplingfrequencyindex<<7|o.channelcount<<3),s.pts=Math.round(s.pts/90),s.dts=Math.round(s.dts/90),m.push(s)},this.flush=function(){var S,E,A,O=new _v;if(0!==m.length){for(A=-1/0;m.length;)S=m.shift(),_.length&&S.pts>=_[0]&&(A=_.shift(),this.writeMetaDataTags(O,A)),(o.extraData!==s||S.pts-A>=1e3)&&(this.writeMetaDataTags(O,S.pts),s=o.extraData,A=S.pts),(E=new wy(wy.AUDIO_TAG)).pts=S.pts,E.dts=S.dts,E.writeBytes(S.data),O.push(E.finalize());_.length=0,s=null,this.trigger("data",{track:o,tags:O.list}),this.trigger("done","AudioSegmentStream")}else this.trigger("done","AudioSegmentStream")},this.writeMetaDataTags=function(s,m){var _;(_=new wy(wy.METADATA_TAG)).pts=m,_.dts=m,_.writeMetaDataDouble("audiocodecid",10),_.writeMetaDataBoolean("stereo",2===o.channelcount),_.writeMetaDataDouble("audiosamplerate",o.samplerate),_.writeMetaDataDouble("audiosamplesize",16),s.push(_.finalize()),(_=new wy(wy.AUDIO_TAG,!0)).pts=m,_.dts=m,_.view.setUint16(_.position,o.extraData),_.position+=2,_.length=Math.max(_.length,_.position),s.push(_.finalize())},this.onVideoKeyFrame=function(o){_.push(o)}}).prototype=new z,Ly=function VideoSegmentStream(o){var s,m,_=[];Ly.prototype.init.call(this),this.finishFrame=function(_,S){if(S){if(s&&o&&o.newMetadata&&(S.keyFrame||0===_.length)){var E=Xy(s,S.dts).finalize(),A=Qy(o,S.dts).finalize();E.metaDataTag=A.metaDataTag=!0,_.push(E),_.push(A),o.newMetadata=!1,this.trigger("keyframe",S.dts)}S.endNalUnit(),_.push(S.finalize()),m=null}},this.push=function(s){Oy(o,s),s.pts=Math.round(s.pts/90),s.dts=Math.round(s.dts/90),_.push(s)},this.flush=function(){for(var S,E=new _v;_.length&&"access_unit_delimiter_rbsp"!==_[0].nalUnitType;)_.shift();if(0!==_.length){for(;_.length;)"seq_parameter_set_rbsp"===(S=_.shift()).nalUnitType?(o.newMetadata=!0,s=S.config,o.width=s.width,o.height=s.height,o.sps=[S.data],o.profileIdc=s.profileIdc,o.levelIdc=s.levelIdc,o.profileCompatibility=s.profileCompatibility,m.endNalUnit()):"pic_parameter_set_rbsp"===S.nalUnitType?(o.newMetadata=!0,o.pps=[S.data],m.endNalUnit()):"access_unit_delimiter_rbsp"===S.nalUnitType?(m&&this.finishFrame(E,m),(m=new wy(wy.VIDEO_TAG)).pts=S.pts,m.dts=S.dts):("slice_layer_without_partitioning_rbsp_idr"===S.nalUnitType&&(m.keyFrame=!0),m.endNalUnit()),m.startNalUnit(),m.writeBytes(S.data);m&&this.finishFrame(E,m),this.trigger("data",{track:o,tags:E.list}),this.trigger("done","VideoSegmentStream")}else this.trigger("done","VideoSegmentStream")}},Ly.prototype=new z,Py=function Transmuxer(o){var s,m,_,S,E,A,O,H,K,z,G,q,X=this;Py.prototype.init.call(this),o=o||{},this.metadataStream=new kh.MetadataStream,o.metadataStream=this.metadataStream,s=new kh.TransportPacketStream,m=new kh.TransportParseStream,_=new kh.ElementaryStream,S=new kh.TimestampRolloverStream("video"),E=new kh.TimestampRolloverStream("audio"),A=new kh.TimestampRolloverStream("timed-metadata"),O=new me,H=new $v,q=new tv(o),s.pipe(m).pipe(_),_.pipe(S).pipe(H),_.pipe(E).pipe(O),_.pipe(A).pipe(this.metadataStream).pipe(q),G=new kh.CaptionStream(o),H.pipe(G).pipe(q),_.on("data",(function(o){var s,m,_;if("metadata"===o.type){for(s=o.tracks.length;s--;)"video"===o.tracks[s].type?m=o.tracks[s]:"audio"===o.tracks[s].type&&(_=o.tracks[s]);m&&!K&&(q.numberOfTracks++,K=new Ly(m),H.pipe(K).pipe(q)),_&&!z&&(q.numberOfTracks++,z=new Ry(_),O.pipe(z).pipe(q),K&&K.on("keyframe",z.onVideoKeyFrame))}})),this.push=function(o){s.push(o)},this.flush=function(){s.flush()},this.resetCaptions=function(){G.reset()},q.on("data",(function(o){X.trigger("data",o)})),q.on("done",(function(){X.trigger("done")}))},Py.prototype=new z;var Yv=function getFlvHeader(o,s,m){var _,S,E,A=new Uint8Array(9),O=new DataView(A.buffer);return o=o||0,s=void 0===s||s,m=void 0===m||m,O.setUint8(0,70),O.setUint8(1,76),O.setUint8(2,86),O.setUint8(3,1),O.setUint8(4,(s?4:0)|(m?1:0)),O.setUint32(5,A.byteLength),o<=0?((S=new Uint8Array(A.byteLength+4)).set(A),S.set([0,0,0,0],A.byteLength),S):((_=new wy(wy.METADATA_TAG)).pts=_.dts=0,_.writeMetaDataDouble("duration",o),E=_.finalize().length,(S=new Uint8Array(A.byteLength+E)).set(A),S.set(O.byteLength,E),S)},Jv={tag:wy,Transmuxer:Py,getFlvHeader:Yv},e_=kh,t_=X.ONE_SECOND_IN_TS,n_=function AudioSegmentStream(o,s){var m=[],_=0,S=0,E=0,A=1/0,O=null,H=null;s=s||{},AudioSegmentStream.prototype.init.call(this),this.push=function(s){Ys.collectDtsInfo(o,s),o&&pf.forEach((function(m){o[m]=s[m]})),m.push(s)},this.setEarliestDts=function(o){S=o},this.setVideoBaseMediaDecodeTime=function(o){A=o},this.setAudioAppendStart=function(o){E=o},this.processFrames_=function(){var K,z,G,q,X;0!==m.length&&0!==(K=Bs.trimAdtsFramesByEarliestDts(m,o,S)).length&&(o.baseMediaDecodeTime=Ys.calculateTrackBaseMediaDecodeTime(o,s.keepOriginalTimestamps),Bs.prefixWithSilence(o,K,E,A),o.samples=Bs.generateSampleTable(K),G=bi.mdat(Bs.concatenateFrameData(K)),m=[],z=bi.moof(_,[o]),_++,o.initSegment=bi.initSegment([o]),(q=new Uint8Array(z.byteLength+G.byteLength)).set(z),q.set(G,z.byteLength),Ys.clearDtsInfo(o),null===O&&(H=O=K[0].pts),H+=K.length*(1024*t_/o.samplerate),X={start:O},this.trigger("timingInfo",X),this.trigger("data",{track:o,boxes:q}))},this.flush=function(){this.processFrames_(),this.trigger("timingInfo",{start:O,end:H}),this.resetTiming_(),this.trigger("done","AudioSegmentStream")},this.partialFlush=function(){this.processFrames_(),this.trigger("partialdone","AudioSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","AudioSegmentStream")},this.resetTiming_=function(){Ys.clearDtsInfo(o),O=null,H=null},this.reset=function(){this.resetTiming_(),m=[],this.trigger("reset")}};n_.prototype=new z;var r_=n_,i_=function VideoSegmentStream(o,s){var m,_,S,E=0,A=[],O=[],H=null,K=null,z=!0;s=s||{},VideoSegmentStream.prototype.init.call(this),this.push=function(s){Ys.collectDtsInfo(o,s),void 0===o.timelineStartInfo.dts&&(o.timelineStartInfo.dts=s.dts),"seq_parameter_set_rbsp"!==s.nalUnitType||m||(m=s.config,o.sps=[s.data],_f.forEach((function(s){o[s]=m[s]}),this)),"pic_parameter_set_rbsp"!==s.nalUnitType||_||(_=s.data,o.pps=[s.data]),A.push(s)},this.processNals_=function(m){var _;for(A=O.concat(A);A.length&&"access_unit_delimiter_rbsp"!==A[0].nalUnitType;)A.shift();if(0!==A.length){var G=Vo.groupNalsIntoFrames(A);if(G.length)if(O=G[G.length-1],m&&(G.pop(),G.duration-=O.duration,G.nalCount-=O.length,G.byteLength-=O.byteLength),G.length){if(this.trigger("timelineStartInfo",o.timelineStartInfo),z){if(!(S=Vo.groupFramesIntoGops(G))[0][0].keyFrame){if(!(S=Vo.extendFirstKeyFrame(S))[0][0].keyFrame)return A=[].concat.apply([],G).concat(O),void(O=[]);(G=[].concat.apply([],S)).duration=S.duration}z=!1}for(null===H&&(H=G[0].pts,K=H),K+=G.duration,this.trigger("timingInfo",{start:H,end:K}),_=0;_<G.length;_++){var q=G[_];o.samples=Vo.generateSampleTableForFrame(q);var X=bi.mdat(Vo.concatenateNalDataForFrame(q));Ys.clearDtsInfo(o),Ys.collectDtsInfo(o,q),o.baseMediaDecodeTime=Ys.calculateTrackBaseMediaDecodeTime(o,s.keepOriginalTimestamps);var J=bi.moof(E,[o]);E++,o.initSegment=bi.initSegment([o]);var ae=new Uint8Array(J.byteLength+X.byteLength);ae.set(J),ae.set(X,J.byteLength),this.trigger("data",{track:o,boxes:ae,sequence:E,videoFrameDts:q.dts,videoFramePts:q.pts})}A=[]}else A=[]}},this.resetTimingAndConfig_=function(){m=void 0,_=void 0,H=null,K=null},this.partialFlush=function(){this.processNals_(!0),this.trigger("partialdone","VideoSegmentStream")},this.flush=function(){this.processNals_(!1),this.resetTimingAndConfig_(),this.trigger("done","VideoSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","VideoSegmentStream")},this.reset=function(){this.resetTimingAndConfig_(),O=[],A=[],z=!0,this.trigger("reset")}};i_.prototype=new z;var a_=i_,o_=Ip.isLikelyAacData,s_=function createPipeline(o){return o.prototype=new z,o.prototype.init.call(o),o},u_=function tsPipeline(o){var s={type:"ts",tracks:{audio:null,video:null},packet:new kh.TransportPacketStream,parse:new kh.TransportParseStream,elementary:new kh.ElementaryStream,timestampRollover:new kh.TimestampRolloverStream,adts:new ar.Adts,h264:new ar.h264.H264Stream,captionStream:new kh.CaptionStream(o),metadataStream:new kh.MetadataStream};return s.headOfPipeline=s.packet,s.packet.pipe(s.parse).pipe(s.elementary).pipe(s.timestampRollover),s.timestampRollover.pipe(s.h264),s.h264.pipe(s.captionStream),s.timestampRollover.pipe(s.metadataStream),s.timestampRollover.pipe(s.adts),s.elementary.on("data",(function(m){if("metadata"===m.type){for(var _=0;_<m.tracks.length;_++)s.tracks[m.tracks[_].type]||(s.tracks[m.tracks[_].type]=m.tracks[_],s.tracks[m.tracks[_].type].timelineStartInfo.baseMediaDecodeTime=o.baseMediaDecodeTime);s.tracks.video&&!s.videoSegmentStream&&(s.videoSegmentStream=new a_(s.tracks.video,o),s.videoSegmentStream.on("timelineStartInfo",(function(m){s.tracks.audio&&!o.keepOriginalTimestamps&&s.audioSegmentStream.setEarliestDts(m.dts-o.baseMediaDecodeTime)})),s.videoSegmentStream.on("timingInfo",s.trigger.bind(s,"videoTimingInfo")),s.videoSegmentStream.on("data",(function(o){s.trigger("data",{type:"video",data:o})})),s.videoSegmentStream.on("done",s.trigger.bind(s,"done")),s.videoSegmentStream.on("partialdone",s.trigger.bind(s,"partialdone")),s.videoSegmentStream.on("endedtimeline",s.trigger.bind(s,"endedtimeline")),s.h264.pipe(s.videoSegmentStream)),s.tracks.audio&&!s.audioSegmentStream&&(s.audioSegmentStream=new r_(s.tracks.audio,o),s.audioSegmentStream.on("data",(function(o){s.trigger("data",{type:"audio",data:o})})),s.audioSegmentStream.on("done",s.trigger.bind(s,"done")),s.audioSegmentStream.on("partialdone",s.trigger.bind(s,"partialdone")),s.audioSegmentStream.on("endedtimeline",s.trigger.bind(s,"endedtimeline")),s.audioSegmentStream.on("timingInfo",s.trigger.bind(s,"audioTimingInfo")),s.adts.pipe(s.audioSegmentStream)),s.trigger("trackinfo",{hasAudio:!!s.tracks.audio,hasVideo:!!s.tracks.video})}})),s.captionStream.on("data",(function(m){var _;_=s.tracks.video&&s.tracks.video.timelineStartInfo.pts||0,m.startTime=X.metadataTsToSeconds(m.startPts,_,o.keepOriginalTimestamps),m.endTime=X.metadataTsToSeconds(m.endPts,_,o.keepOriginalTimestamps),s.trigger("caption",m)})),(s=s_(s)).metadataStream.on("data",s.trigger.bind(s,"id3Frame")),s},l_=function aacPipeline(o){var s={type:"aac",tracks:{audio:null},metadataStream:new kh.MetadataStream,aacStream:new hf,audioRollover:new kh.TimestampRolloverStream("audio"),timedMetadataRollover:new kh.TimestampRolloverStream("timed-metadata"),adtsStream:new me(!0)};return s.headOfPipeline=s.aacStream,s.aacStream.pipe(s.audioRollover).pipe(s.adtsStream),s.aacStream.pipe(s.timedMetadataRollover).pipe(s.metadataStream),s.metadataStream.on("timestamp",(function(o){s.aacStream.setTimestamp(o.timeStamp)})),s.aacStream.on("data",(function(m){"timed-metadata"!==m.type&&"audio"!==m.type||s.audioSegmentStream||(s.tracks.audio=s.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:o.baseMediaDecodeTime},codec:"adts",type:"audio"},s.audioSegmentStream=new r_(s.tracks.audio,o),s.audioSegmentStream.on("data",(function(o){s.trigger("data",{type:"audio",data:o})})),s.audioSegmentStream.on("partialdone",s.trigger.bind(s,"partialdone")),s.audioSegmentStream.on("done",s.trigger.bind(s,"done")),s.audioSegmentStream.on("endedtimeline",s.trigger.bind(s,"endedtimeline")),s.audioSegmentStream.on("timingInfo",s.trigger.bind(s,"audioTimingInfo")),s.adtsStream.pipe(s.audioSegmentStream),s.trigger("trackinfo",{hasAudio:!!s.tracks.audio,hasVideo:!!s.tracks.video}))})),(s=s_(s)).metadataStream.on("data",s.trigger.bind(s,"id3Frame")),s},c_=function setupPipelineListeners(o,s){o.on("data",s.trigger.bind(s,"data")),o.on("done",s.trigger.bind(s,"done")),o.on("partialdone",s.trigger.bind(s,"partialdone")),o.on("endedtimeline",s.trigger.bind(s,"endedtimeline")),o.on("audioTimingInfo",s.trigger.bind(s,"audioTimingInfo")),o.on("videoTimingInfo",s.trigger.bind(s,"videoTimingInfo")),o.on("trackinfo",s.trigger.bind(s,"trackinfo")),o.on("id3Frame",(function(m){m.dispatchType=o.metadataStream.dispatchType,m.cueTime=X.videoTsToSeconds(m.pts),s.trigger("id3Frame",m)})),o.on("caption",(function(o){s.trigger("caption",o)}))},d_=function Transmuxer(o){var s=null,m=!0;o=o||{},Transmuxer.prototype.init.call(this),o.baseMediaDecodeTime=o.baseMediaDecodeTime||0,this.push=function(_){if(m){var S=o_(_);!S||s&&"aac"===s.type?S||s&&"ts"===s.type||(s=u_(o),c_(s,this)):(s=l_(o),c_(s,this)),m=!1}s.headOfPipeline.push(_)},this.flush=function(){s&&(m=!0,s.headOfPipeline.flush())},this.partialFlush=function(){s&&s.headOfPipeline.partialFlush()},this.endTimeline=function(){s&&s.headOfPipeline.endTimeline()},this.reset=function(){s&&s.headOfPipeline.reset()},this.setBaseMediaDecodeTime=function(m){o.keepOriginalTimestamps||(o.baseMediaDecodeTime=m),s&&(s.tracks.audio&&(s.tracks.audio.timelineStartInfo.dts=void 0,s.tracks.audio.timelineStartInfo.pts=void 0,Ys.clearDtsInfo(s.tracks.audio),s.audioRollover&&s.audioRollover.discontinuity()),s.tracks.video&&(s.videoSegmentStream&&(s.videoSegmentStream.gopCache_=[]),s.tracks.video.timelineStartInfo.dts=void 0,s.tracks.video.timelineStartInfo.pts=void 0,Ys.clearDtsInfo(s.tracks.video)),s.timestampRollover&&s.timestampRollover.discontinuity())},this.setRemux=function(m){o.remux=m,s&&s.coalesceStream&&s.coalesceStream.setRemux(m)},this.setAudioAppendStart=function(o){s&&s.tracks.audio&&s.audioSegmentStream&&s.audioSegmentStream.setAudioAppendStart(o)},this.alignGopsWith=function(o){}};d_.prototype=new z;var h_,p_,f_={Transmuxer:d_},g_=wr.getUint64,m_=function parseSidx(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength),m={version:o[0],flags:new Uint8Array(o.subarray(1,4)),references:[],referenceId:s.getUint32(4),timescale:s.getUint32(8)},_=12;0===m.version?(m.earliestPresentationTime=s.getUint32(_),m.firstOffset=s.getUint32(_+4),_+=8):(m.earliestPresentationTime=g_(o.subarray(_)),m.firstOffset=g_(o.subarray(_+8)),_+=16),_+=2;var S=s.getUint16(_);for(_+=2;S>0;_+=12,S--)m.references.push({referenceType:(128&o[_])>>>7,referencedSize:2147483647&s.getUint32(_),subsegmentDuration:s.getUint32(_+4),startsWithSap:!!(128&o[_+8]),sapType:(112&o[_+8])>>>4,sapDeltaTime:268435455&s.getUint32(_+8)});return m},y_=m_,v_=wr.getUint64,b_=function parseMp4Date(o){return new Date(1e3*o-20828448e5)},S_=function nalParse(o){var s,m,_=new DataView(o.buffer,o.byteOffset,o.byteLength),S=[];for(s=0;s+4<o.length;s+=m)if(m=_.getUint32(s),s+=4,m<=0)S.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&o[s]){case 1:S.push("slice_layer_without_partitioning_rbsp");break;case 5:S.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:S.push("sei_rbsp");break;case 7:S.push("seq_parameter_set_rbsp");break;case 8:S.push("pic_parameter_set_rbsp");break;case 9:S.push("access_unit_delimiter_rbsp");break;default:S.push("UNKNOWN NAL - "+o[s]&31)}return S},T_={avc1:function avc1(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength);return{dataReferenceIndex:s.getUint16(6),width:s.getUint16(24),height:s.getUint16(26),horizresolution:s.getUint16(28)+s.getUint16(30)/16,vertresolution:s.getUint16(32)+s.getUint16(34)/16,frameCount:s.getUint16(40),depth:s.getUint16(74),config:h_(o.subarray(78,o.byteLength))}},avcC:function avcC(o){var s,m,_,S,E=new DataView(o.buffer,o.byteOffset,o.byteLength),A={configurationVersion:o[0],avcProfileIndication:o[1],profileCompatibility:o[2],avcLevelIndication:o[3],lengthSizeMinusOne:3&o[4],sps:[],pps:[]},O=31&o[5];for(_=6,S=0;S<O;S++)m=E.getUint16(_),_+=2,A.sps.push(new Uint8Array(o.subarray(_,_+m))),_+=m;for(s=o[_],_++,S=0;S<s;S++)m=E.getUint16(_),_+=2,A.pps.push(new Uint8Array(o.subarray(_,_+m))),_+=m;return A},btrt:function btrt(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength);return{bufferSizeDB:s.getUint32(0),maxBitrate:s.getUint32(4),avgBitrate:s.getUint32(8)}},edts:function edts(o){return{boxes:h_(o)}},elst:function elst(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:m.getUint8(0),flags:new Uint8Array(o.subarray(1,4)),edits:[]},S=m.getUint32(4);for(s=8;S;S--)0===_.version?(_.edits.push({segmentDuration:m.getUint32(s),mediaTime:m.getInt32(s+4),mediaRate:m.getUint16(s+8)+m.getUint16(s+10)/65536}),s+=12):(_.edits.push({segmentDuration:v_(o.subarray(s)),mediaTime:v_(o.subarray(s+8)),mediaRate:m.getUint16(s+16)+m.getUint16(s+18)/65536}),s+=20);return _},esds:function esds(o){return{version:o[0],flags:new Uint8Array(o.subarray(1,4)),esId:o[6]<<8|o[7],streamPriority:31&o[8],decoderConfig:{objectProfileIndication:o[11],streamType:o[12]>>>2&63,bufferSize:o[13]<<16|o[14]<<8|o[15],maxBitrate:o[16]<<24|o[17]<<16|o[18]<<8|o[19],avgBitrate:o[20]<<24|o[21]<<16|o[22]<<8|o[23],decoderConfigDescriptor:{tag:o[24],length:o[25],audioObjectType:o[26]>>>3&31,samplingFrequencyIndex:(7&o[26])<<1|o[27]>>>7&1,channelConfiguration:o[27]>>>3&15}}}},ftyp:function ftyp(o){for(var s=new DataView(o.buffer,o.byteOffset,o.byteLength),m={majorBrand:ta(o.subarray(0,4)),minorVersion:s.getUint32(4),compatibleBrands:[]},_=8;_<o.byteLength;)m.compatibleBrands.push(ta(o.subarray(_,_+4))),_+=4;return m},dinf:function dinf(o){return{boxes:h_(o)}},dref:function dref(o){return{version:o[0],flags:new Uint8Array(o.subarray(1,4)),dataReferences:h_(o.subarray(8))}},hdlr:function hdlr(o){var s={version:new DataView(o.buffer,o.byteOffset,o.byteLength).getUint8(0),flags:new Uint8Array(o.subarray(1,4)),handlerType:ta(o.subarray(8,12)),name:""},m=8;for(m=24;m<o.byteLength;m++){if(0===o[m]){m++;break}s.name+=String.fromCharCode(o[m])}return s.name=decodeURIComponent(escape(s.name)),s},mdat:function mdat(o){return{byteLength:o.byteLength,nals:S_(o)}},mdhd:function mdhd(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_=4,S={version:m.getUint8(0),flags:new Uint8Array(o.subarray(1,4)),language:""};return 1===S.version?(_+=4,S.creationTime=b_(m.getUint32(_)),_+=8,S.modificationTime=b_(m.getUint32(_)),_+=4,S.timescale=m.getUint32(_),_+=8,S.duration=m.getUint32(_)):(S.creationTime=b_(m.getUint32(_)),_+=4,S.modificationTime=b_(m.getUint32(_)),_+=4,S.timescale=m.getUint32(_),_+=4,S.duration=m.getUint32(_)),_+=4,s=m.getUint16(_),S.language+=String.fromCharCode(96+(s>>10)),S.language+=String.fromCharCode(96+((992&s)>>5)),S.language+=String.fromCharCode(96+(31&s)),S},mdia:function mdia(o){return{boxes:h_(o)}},mfhd:function mfhd(o){return{version:o[0],flags:new Uint8Array(o.subarray(1,4)),sequenceNumber:o[4]<<24|o[5]<<16|o[6]<<8|o[7]}},minf:function minf(o){return{boxes:h_(o)}},mp4a:function mp4a(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength),m={dataReferenceIndex:s.getUint16(6),channelcount:s.getUint16(16),samplesize:s.getUint16(18),samplerate:s.getUint16(24)+s.getUint16(26)/65536};return o.byteLength>28&&(m.streamDescriptor=h_(o.subarray(28))[0]),m},moof:function moof(o){return{boxes:h_(o)}},moov:function moov(o){return{boxes:h_(o)}},mvex:function mvex(o){return{boxes:h_(o)}},mvhd:function mvhd(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength),m=4,_={version:s.getUint8(0),flags:new Uint8Array(o.subarray(1,4))};return 1===_.version?(m+=4,_.creationTime=b_(s.getUint32(m)),m+=8,_.modificationTime=b_(s.getUint32(m)),m+=4,_.timescale=s.getUint32(m),m+=8,_.duration=s.getUint32(m)):(_.creationTime=b_(s.getUint32(m)),m+=4,_.modificationTime=b_(s.getUint32(m)),m+=4,_.timescale=s.getUint32(m),m+=4,_.duration=s.getUint32(m)),m+=4,_.rate=s.getUint16(m)+s.getUint16(m+2)/16,m+=4,_.volume=s.getUint8(m)+s.getUint8(m+1)/8,m+=2,m+=2,m+=8,_.matrix=new Uint32Array(o.subarray(m,m+36)),m+=36,m+=24,_.nextTrackId=s.getUint32(m),_},pdin:function pdin(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength);return{version:s.getUint8(0),flags:new Uint8Array(o.subarray(1,4)),rate:s.getUint32(4),initialDelay:s.getUint32(8)}},sdtp:function sdtp(o){var s,m={version:o[0],flags:new Uint8Array(o.subarray(1,4)),samples:[]};for(s=4;s<o.byteLength;s++)m.samples.push({dependsOn:(48&o[s])>>4,isDependedOn:(12&o[s])>>2,hasRedundancy:3&o[s]});return m},sidx:y_,smhd:function smhd(o){return{version:o[0],flags:new Uint8Array(o.subarray(1,4)),balance:o[4]+o[5]/256}},stbl:function stbl(o){return{boxes:h_(o)}},ctts:function ctts(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:m.getUint8(0),flags:new Uint8Array(o.subarray(1,4)),compositionOffsets:[]},S=m.getUint32(4);for(s=8;S;s+=8,S--)_.compositionOffsets.push({sampleCount:m.getUint32(s),sampleOffset:m[0===_.version?"getUint32":"getInt32"](s+4)});return _},stss:function stss(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:m.getUint8(0),flags:new Uint8Array(o.subarray(1,4)),syncSamples:[]},S=m.getUint32(4);for(s=8;S;s+=4,S--)_.syncSamples.push(m.getUint32(s));return _},stco:function stco(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:o[0],flags:new Uint8Array(o.subarray(1,4)),chunkOffsets:[]},S=m.getUint32(4);for(s=8;S;s+=4,S--)_.chunkOffsets.push(m.getUint32(s));return _},stsc:function stsc(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_=m.getUint32(4),S={version:o[0],flags:new Uint8Array(o.subarray(1,4)),sampleToChunks:[]};for(s=8;_;s+=12,_--)S.sampleToChunks.push({firstChunk:m.getUint32(s),samplesPerChunk:m.getUint32(s+4),sampleDescriptionIndex:m.getUint32(s+8)});return S},stsd:function stsd(o){return{version:o[0],flags:new Uint8Array(o.subarray(1,4)),sampleDescriptions:h_(o.subarray(8))}},stsz:function stsz(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:o[0],flags:new Uint8Array(o.subarray(1,4)),sampleSize:m.getUint32(4),entries:[]};for(s=12;s<o.byteLength;s+=4)_.entries.push(m.getUint32(s));return _},stts:function stts(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:o[0],flags:new Uint8Array(o.subarray(1,4)),timeToSamples:[]},S=m.getUint32(4);for(s=8;S;s+=8,S--)_.timeToSamples.push({sampleCount:m.getUint32(s),sampleDelta:m.getUint32(s+4)});return _},styp:function styp(o){return T_.ftyp(o)},tfdt:Va,tfhd:Sa,tkhd:function tkhd(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength),m=4,_={version:s.getUint8(0),flags:new Uint8Array(o.subarray(1,4))};return 1===_.version?(m+=4,_.creationTime=b_(s.getUint32(m)),m+=8,_.modificationTime=b_(s.getUint32(m)),m+=4,_.trackId=s.getUint32(m),m+=4,m+=8,_.duration=s.getUint32(m)):(_.creationTime=b_(s.getUint32(m)),m+=4,_.modificationTime=b_(s.getUint32(m)),m+=4,_.trackId=s.getUint32(m),m+=4,m+=4,_.duration=s.getUint32(m)),m+=4,m+=8,_.layer=s.getUint16(m),m+=2,_.alternateGroup=s.getUint16(m),m+=2,_.volume=s.getUint8(m)+s.getUint8(m+1)/8,m+=2,m+=2,_.matrix=new Uint32Array(o.subarray(m,m+36)),m+=36,_.width=s.getUint16(m)+s.getUint16(m+2)/65536,m+=4,_.height=s.getUint16(m)+s.getUint16(m+2)/65536,_},traf:function traf(o){return{boxes:h_(o)}},trak:function trak(o){return{boxes:h_(o)}},trex:function trex(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength);return{version:o[0],flags:new Uint8Array(o.subarray(1,4)),trackId:s.getUint32(4),defaultSampleDescriptionIndex:s.getUint32(8),defaultSampleDuration:s.getUint32(12),defaultSampleSize:s.getUint32(16),sampleDependsOn:3&o[20],sampleIsDependedOn:(192&o[21])>>6,sampleHasRedundancy:(48&o[21])>>4,samplePaddingValue:(14&o[21])>>1,sampleIsDifferenceSample:!!(1&o[21]),sampleDegradationPriority:s.getUint16(22)}},trun:xa,"url ":function url(o){return{version:o[0],flags:new Uint8Array(o.subarray(1,4))}},vmhd:function vmhd(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength);return{version:o[0],flags:new Uint8Array(o.subarray(1,4)),graphicsmode:s.getUint16(4),opcolor:new Uint16Array([s.getUint16(6),s.getUint16(8),s.getUint16(10)])}}};h_=function inspectMp4(o){for(var s,m,_,S,E,A=0,O=[],H=new ArrayBuffer(o.length),K=new Uint8Array(H),z=0;z<o.length;++z)K[z]=o[z];for(s=new DataView(H);A<o.byteLength;)m=s.getUint32(A),_=ta(o.subarray(A+4,A+8)),S=m>1?A+m:o.byteLength,(E=(T_[_]||function(o){return{data:o}})(o.subarray(A+8,S))).size=m,E.type=_,O.push(E),A=S;return O},p_=function textifyMp4(o,s){var m;return s=s||0,m=new Array(2*s+1).join(" "),o.map((function(o,_){return m+o.type+"\n"+Object.keys(o).filter((function(o){return"type"!==o&&"boxes"!==o})).map((function(s){var _=m+"  "+s+": ",S=o[s];if(S instanceof Uint8Array||S instanceof Uint32Array){var E=Array.prototype.slice.call(new Uint8Array(S.buffer,S.byteOffset,S.byteLength)).map((function(o){return" "+("00"+o.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);return E?1===E.length?_+"<"+E.join("").slice(1)+">":_+"<\n"+E.map((function(o){return m+"  "+o})).join("\n")+"\n"+m+"  >":_+"<>"}return _+JSON.stringify(S,null,2).split("\n").map((function(o,s){return 0===s?o:m+"  "+o})).join("\n")})).join("\n")+(o.boxes?"\n"+p_(o.boxes,s+1):"")})).join("\n")};var k_={inspect:h_,textify:p_,parseType:ta,findBox:oa,parseTraf:T_.traf,parseTfdt:T_.tfdt,parseHdlr:T_.hdlr,parseTfhd:T_.tfhd,parseTrun:T_.trun,parseSidx:T_.sidx},C_={8:"audio",9:"video",18:"metadata"},w_=function hex(o){return"0x"+("00"+o.toString(16)).slice(-2).toUpperCase()},x_=function hexStringList(o){for(var s,m=[];o.byteLength>0;)s=0,m.push(w_(o[s++])),o=o.subarray(s);return m.join(" ")},E_=function parseAVCTag(o,s){var m=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"],_=o[1]&parseInt("01111111",2)<<16|o[2]<<8|o[3];return(s=s||{}).avcPacketType=m[o[0]],s.CompositionTime=o[1]&parseInt("10000000",2)?-_:_,1===o[0]?s.nalUnitTypeRaw=x_(o.subarray(4,100)):s.data=x_(o.subarray(4)),s},I_=function parseVideoTag(o,s){var m=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"],_=o[0]&parseInt("00001111",2);return(s=s||{}).frameType=m[(o[0]&parseInt("11110000",2))>>>4],s.codecID=_,7===_?E_(o.subarray(1),s):s},A_=function parseAACTag(o,s){var m=["AAC Sequence Header","AAC Raw"];return(s=s||{}).aacPacketType=m[o[0]],s.data=x_(o.subarray(1)),s},P_=function parseAudioTag(o,s){var m=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"],_=["5.5-kHz","11-kHz","22-kHz","44-kHz"],S=(o[0]&parseInt("11110000",2))>>>4;return(s=s||{}).soundFormat=m[S],s.soundRate=_[(o[0]&parseInt("00001100",2))>>>2],s.soundSize=(o[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit",s.soundType=o[0]&parseInt("00000001",2)?"Stereo":"Mono",10===S?A_(o.subarray(1),s):s},L_=function parseGenericTag(o){return{tagType:C_[o[0]],dataSize:o[1]<<16|o[2]<<8|o[3],timestamp:o[7]<<24|o[4]<<16|o[5]<<8|o[6],streamID:o[8]<<16|o[9]<<8|o[10]}},D_=function inspectFlvTag(o){var s=L_(o);switch(o[0]){case 8:P_(o.subarray(11),s);break;case 9:I_(o.subarray(11),s)}return s},R_=function inspectFlv(o){var s,m,_=9,S=[];for(_+=4;_<o.byteLength;)s=o[_+1]<<16,s|=o[_+2]<<8,s|=o[_+3],s+=11,m=o.subarray(_,_+s),S.push(D_(m)),_+=s+4;return S},O_={inspectTag:D_,inspect:R_,textify:function textifyFlv(o){return JSON.stringify(o,null,2)}},M_=function parsePid(o){var s=31&o[1];return s<<=8,s|=o[2]},F_=function parsePayloadUnitStartIndicator(o){return!!(64&o[1])},N_=function parseAdaptionField(o){var s=0;return(48&o[3])>>>4>1&&(s+=o[4]+1),s},U_=function parsePmt(o){var s={},m=F_(o),_=4+N_(o);if(m&&(_+=o[_]+1),1&o[_+5]){var S;S=3+((15&o[_+1])<<8|o[_+2])-4;for(var E=12+((15&o[_+10])<<8|o[_+11]);E<S;){var A=_+E;s[(31&o[A+1])<<8|o[A+2]]=o[A],E+=5+((15&o[A+3])<<8|o[A+4])}return s}},B_=function parsePesType(o,s){switch(s[M_(o)]){case zc.H264_STREAM_TYPE:return"video";case zc.ADTS_STREAM_TYPE:return"audio";case zc.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},j_=function parsePesTime(o){if(!F_(o))return null;var s=4+N_(o);if(s>=o.byteLength)return null;var m,_=null;return 192&(m=o[s+7])&&((_={}).pts=(14&o[s+9])<<27|(255&o[s+10])<<20|(254&o[s+11])<<12|(255&o[s+12])<<5|(254&o[s+13])>>>3,_.pts*=4,_.pts+=(6&o[s+13])>>>1,_.dts=_.pts,64&m&&(_.dts=(14&o[s+14])<<27|(255&o[s+15])<<20|(254&o[s+16])<<12|(255&o[s+17])<<5|(254&o[s+18])>>>3,_.dts*=4,_.dts+=(6&o[s+18])>>>1)),_},$_=function parseNalUnitType(o){switch(o){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},V_={parseType:function parseType(o,s){var m=M_(o);return 0===m?"pat":m===s?"pmt":s?"pes":null},parsePat:function parsePat(o){var s=F_(o),m=4+N_(o);return s&&(m+=o[m]+1),(31&o[m+10])<<8|o[m+11]},parsePmt:U_,parsePayloadUnitStartIndicator:F_,parsePesType:B_,parsePesTime:j_,videoPacketContainsKeyFrame:function videoPacketContainsKeyFrame(o){for(var s=4+N_(o),m=o.subarray(s),_=0,S=0,E=!1;S<m.byteLength-3;S++)if(1===m[S+2]){_=S+5;break}for(;_<m.byteLength;)switch(m[_]){case 0:if(0!==m[_-1]){_+=2;break}if(0!==m[_-2]){_++;break}S+3!==_-2&&"slice_layer_without_partitioning_rbsp_idr"===$_(31&m[S+3])&&(E=!0);do{_++}while(1!==m[_]&&_<m.length);S=_-2,_+=3;break;case 1:if(0!==m[_-1]||0!==m[_-2]){_+=3;break}"slice_layer_without_partitioning_rbsp_idr"===$_(31&m[S+3])&&(E=!0),S=_-2,_+=3;break;default:_+=3}return m=m.subarray(S),_-=S,S=0,m&&m.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===$_(31&m[S+3])&&(E=!0),E}},H_=Ud.handleRollover,K_={};K_.ts=V_,K_.aac=Ip;var z_=X.ONE_SECOND_IN_TS,W_=188,G_=71,q_=function parsePsi_(o,s){for(var m,_=0,S=W_;S<o.byteLength;)if(o[_]!==G_||o[S]!==G_)_++,S++;else{switch(m=o.subarray(_,S),K_.ts.parseType(m,s.pid)){case"pat":s.pid=K_.ts.parsePat(m);break;case"pmt":var E=K_.ts.parsePmt(m);s.table=s.table||{},Object.keys(E).forEach((function(o){s.table[o]=E[o]}))}_+=W_,S+=W_}},X_=function parseAudioPes_(o,s,m){for(var _,S,E,A,O=0,H=W_,K=!1;H<=o.byteLength;)if(o[O]!==G_||o[H]!==G_&&H!==o.byteLength)O++,H++;else{if(_=o.subarray(O,H),"pes"===K_.ts.parseType(_,s.pid)&&(S=K_.ts.parsePesType(_,s.table),E=K_.ts.parsePayloadUnitStartIndicator(_),"audio"===S&&E&&(A=K_.ts.parsePesTime(_))&&(A.type="audio",m.audio.push(A),K=!0)),K)break;O+=W_,H+=W_}for(O=(H=o.byteLength)-W_,K=!1;O>=0;)if(o[O]!==G_||o[H]!==G_&&H!==o.byteLength)O--,H--;else{if(_=o.subarray(O,H),"pes"===K_.ts.parseType(_,s.pid)&&(S=K_.ts.parsePesType(_,s.table),E=K_.ts.parsePayloadUnitStartIndicator(_),"audio"===S&&E&&(A=K_.ts.parsePesTime(_))&&(A.type="audio",m.audio.push(A),K=!0)),K)break;O-=W_,H-=W_}},Y_=function parseVideoPes_(o,s,m){for(var _,S,E,A,O,H,K,z=0,G=W_,q=!1,X={data:[],size:0};G<o.byteLength;)if(o[z]!==G_||o[G]!==G_)z++,G++;else{if(_=o.subarray(z,G),"pes"===K_.ts.parseType(_,s.pid)&&(S=K_.ts.parsePesType(_,s.table),E=K_.ts.parsePayloadUnitStartIndicator(_),"video"===S&&(E&&!q&&(A=K_.ts.parsePesTime(_))&&(A.type="video",m.video.push(A),q=!0),!m.firstKeyFrame))){if(E&&0!==X.size){for(O=new Uint8Array(X.size),H=0;X.data.length;)K=X.data.shift(),O.set(K,H),H+=K.byteLength;if(K_.ts.videoPacketContainsKeyFrame(O)){var J=K_.ts.parsePesTime(O);J?(m.firstKeyFrame=J,m.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}X.size=0}X.data.push(_),X.size+=_.byteLength}if(q&&m.firstKeyFrame)break;z+=W_,G+=W_}for(z=(G=o.byteLength)-W_,q=!1;z>=0;)if(o[z]!==G_||o[G]!==G_)z--,G--;else{if(_=o.subarray(z,G),"pes"===K_.ts.parseType(_,s.pid)&&(S=K_.ts.parsePesType(_,s.table),E=K_.ts.parsePayloadUnitStartIndicator(_),"video"===S&&E&&(A=K_.ts.parsePesTime(_))&&(A.type="video",m.video.push(A),q=!0)),q)break;z-=W_,G-=W_}},Q_=function adjustTimestamp_(o,s){if(o.audio&&o.audio.length){var m=s;(void 0===m||isNaN(m))&&(m=o.audio[0].dts),o.audio.forEach((function(o){o.dts=H_(o.dts,m),o.pts=H_(o.pts,m),o.dtsTime=o.dts/z_,o.ptsTime=o.pts/z_}))}if(o.video&&o.video.length){var _=s;if((void 0===_||isNaN(_))&&(_=o.video[0].dts),o.video.forEach((function(o){o.dts=H_(o.dts,_),o.pts=H_(o.pts,_),o.dtsTime=o.dts/z_,o.ptsTime=o.pts/z_})),o.firstKeyFrame){var S=o.firstKeyFrame;S.dts=H_(S.dts,_),S.pts=H_(S.pts,_),S.dtsTime=S.dts/z_,S.ptsTime=S.pts/z_}}},J_=function inspectAac_(o){for(var s,m=!1,_=0,S=null,E=null,A=0,O=0;o.length-O>=3;){switch(K_.aac.parseType(o,O)){case"timed-metadata":if(o.length-O<10){m=!0;break}if((A=K_.aac.parseId3TagSize(o,O))>o.length){m=!0;break}null===E&&(s=o.subarray(O,O+A),E=K_.aac.parseAacTimestamp(s)),O+=A;break;case"audio":if(o.length-O<7){m=!0;break}if((A=K_.aac.parseAdtsSize(o,O))>o.length){m=!0;break}null===S&&(s=o.subarray(O,O+A),S=K_.aac.parseSampleRate(s)),_++,O+=A;break;default:O++}if(m)return null}if(null===S||null===E)return null;var H=z_/S;return{audio:[{type:"audio",dts:E,pts:E},{type:"audio",dts:E+1024*_*H,pts:E+1024*_*H}]}},Z_=function inspectTs_(o){var s={pid:null,table:null},m={};for(var _ in q_(o,s),s.table)if(s.table.hasOwnProperty(_))switch(s.table[_]){case zc.H264_STREAM_TYPE:m.video=[],Y_(o,s,m),0===m.video.length&&delete m.video;break;case zc.ADTS_STREAM_TYPE:m.audio=[],X_(o,s,m),0===m.audio.length&&delete m.audio}return m},eb={inspect:function inspect(o,s){var m;return(m=K_.aac.isLikelyAacData(o)?J_(o):Z_(o))&&(m.audio||m.video)?(Q_(m,s),m):null},parseAudioPes_:X_},sb={codecs:ar,mp4:_y,flv:Jv,mp2t:e_,partial:f_};sb.mp4.tools=k_,sb.flv.tools=O_,sb.mp2t.tools=eb;var db=sb;return db}($V)}(jV);var VV=jV.exports,__awaiter$3=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},HV=function(){function ShakaPlayer(o){_classCallCheck$1(this,ShakaPlayer),this._currentTime=0,this._bitrateRange={min:-1,max:-1},this.logger=new UV(new BV),this.supportedFormats=[".mpd",".m3u8",".mp4",".mp3",".wav",".ogg",".aac",".flac"],this.shouldRetryOnFailure=!1,this.errorCount=0,this.retryAttempts=2,this.retryWaitTime=1e3,this.timeoutId=null,this._ccEnabled=!1,Object.assign(window,{muxjs:VV}),DV.polyfill.installAll();var s=o.width,m=o.height,_=o.bitrateRange,S=o.videoEl,E=o.shouldRetry,A=o.retryAttempts,O=o.retryWaitTime;S?this.videoEl=S:(this.videoEl=document.createElement("video"),this.videoEl.id="shaka-player",this.videoEl.hidden=!0,this.videoEl.style.position="absolute",document.body.appendChild(this.videoEl)),this.player=new DV.Player(this.videoEl),this.shouldRetryOnFailure=null!=E&&E,this.retryAttempts=null!=A?A:2,this.retryWaitTime=null!=O?O:this.retryWaitTime,Object.assign(window,{_instanceSHAKAPlayer:this.player}),this.size(s,m),this._bitrateRange=_}return _createClass$1(ShakaPlayer,[{key:"size",value:function size(o,s){this.resizeVideo(o,s)}},{key:"resizeVideo",value:function resizeVideo(o,s){this.videoEl.style.width=withPrecision(o),this.videoEl.style.height=withPrecision(s)}},{key:"position",value:function position(o,s){this.videoEl.style.left=withPrecision(o),this.videoEl.style.top=withPrecision(s)}},{key:"registerEventListeners",value:function registerEventListeners(o){var s,m=this,_=_createForOfIteratorHelper(RV);try{for(_.s();!(s=_.n()).done;){var S=s.value;this.videoEl.addEventListener(S[0],(function(s){m.handleEvent(s,o)}))}}catch(o){_.e(o)}finally{_.f()}}},{key:"deregisterEventListeners",value:function deregisterEventListeners(){var o,s=this,m=_createForOfIteratorHelper(RV);try{for(m.s();!(o=m.n()).done;){var _=o.value;this.videoEl.removeEventListener(_[0],(function(o){s.handleEvent(o)}))}}catch(o){m.e(o)}finally{m.f()}}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(o,s){var m=this.getMappedEventKey(o);m&&this.videoEl.addEventListener(m,s)}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(o,s){this.videoEl.removeEventListener(o,s)}},{key:"handleEvent",value:function handleEvent(o,s){return __awaiter$3(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){var m,_,S,E,A,O,H,K=this;return _regeneratorRuntime$1().wrap((function _callee2$(z){for(;;)switch(z.prev=z.next){case 0:if(m=RV.get(o.type),this.player&&this.player.getMediaElement()&&(_=Math.round(this.videoEl.currentTime))!==this._currentTime&&(this._currentTime=_),!m){z.next=12;break}S={playbackConfig:this._playbackConfig},z.t0=m,z.next="Error"===z.t0?7:9;break;case 7:return this.videoEl.error&&(S.errorContext={code:"".concat(this.videoEl.error.code),message:this.videoEl.error.message}),z.abrupt("break",10);case 9:return z.abrupt("break",10);case 10:E={type:m,timestamp:o.timeStamp,metadata:S},"Error"===m?S.errorContext&&parseInt(S.errorContext.code)>=2&&(this.shouldRetryOnFailure&&this.errorCount<=this.retryAttempts?(this.errorCount++,this._playbackConfig&&(A=this._playbackConfig.url,O=this._playbackConfig.type||"VOD",H=this.retryWaitTime>1e3?this.retryWaitTime:this.retryWaitTime*this.errorCount,this.timeoutId=setTimeout((function(){return __awaiter$3(K,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.open(forceHTTPS$1(A),O);case 2:case"end":return o.stop()}}),_callee,this)})))}),H))):(this.errorCount=0,s&&s(E))):s&&s(E);case 12:case"end":return z.stop()}}),_callee2,this)})))}},{key:"renderCC",value:function renderCC(o){this.logger.info(o)}},{key:"play",value:function play(){return __awaiter$3(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.videoEl.play();case 2:case"end":return o.stop()}}),_callee3,this)})))}},{key:"pause",value:function pause(){var o=this;return new Promise((function(s,m){o.videoEl.pause(),o.videoEl.onpause=function(){o.videoEl.onpause=null,o.videoEl.onerror=null,s()},o.videoEl.onerror=function(){o.videoEl.onpause=null,o.videoEl.onerror=null,m()}}))}},{key:"mute",value:function mute(){this.videoEl.muted=!0}},{key:"unmute",value:function unmute(){this.videoEl.muted=!1}},{key:"seek",value:function seek(o){var s=this;return new Promise((function(m,_){s.videoEl.currentTime=Math.max(0,Math.min(o,s.duration-.1)),s.videoEl.onseeked=function(){s.videoEl.onseeked=null,m()},s.videoEl.onerror=function(){s.videoEl.onerror=null,_()}}))}},{key:"hide",value:function hide(){this.videoEl.hidden=!0}},{key:"show",value:function show(){this.videoEl.hidden=!1}},{key:"loop",value:function loop(){this.videoEl.loop=!this.videoEl.loop}},{key:"open",value:function open(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VOD";return __awaiter$3(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(m){for(;;)switch(m.prev=m.next){case 0:return this.timeoutId&&(clearTimeout(Number(this.timeoutId)),this.timeoutId=null),m.next=3,this._load(o,s);case 3:case"end":return m.stop()}}),_callee4,this)})))}},{key:"_load",value:function _load(o,s){return __awaiter$3(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(m){for(;;)switch(m.prev=m.next){case 0:return this._playbackConfig={type:s,url:o,startPosition:null},m.next=3,this._videoLoader(forceHTTPS$1(this._playbackConfig.url));case 3:this.logger.info("".concat(this._playbackConfig.url," '< playWithUrl'"));case 4:case"end":return m.stop()}}),_callee5,this)})))}},{key:"_videoLoader",value:function _videoLoader(o){return __awaiter$3(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,this.player.load(o);case 3:this.show(),s.next=17;break;case 6:if(s.prev=6,s.t0=s.catch(0),this.videoEl.hidden||!(this.errorCount<3)){s.next=14;break}this.errorCount++,this._videoLoader(o),this.logger.error(JSON.stringify(s.t0,null,2)),s.next=17;break;case 14:if(!(this.errorCount>3)){s.next=17;break}throw this.errorCount=0,s.t0;case 17:case"end":return s.stop()}}),_callee6,this,[[0,6]])})))}},{key:"close",value:function close(){return __awaiter$3(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee7(){return _regeneratorRuntime$1().wrap((function _callee7$(o){for(;;)switch(o.prev=o.next){case 0:return this.videoEl.hidden=!0,o.next=3,this.player.unload();case 3:this.videoEl.removeAttribute("src"),this.videoEl.load(),this.deregisterEventListeners();case 6:case"end":return o.stop()}}),_callee7,this)})))}},{key:"destroy",value:function destroy(){return __awaiter$3(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee8(){return _regeneratorRuntime$1().wrap((function _callee8$(o){for(;;)switch(o.prev=o.next){case 0:return document.body.removeChild(this.videoEl),o.next=3,this.player.destroy();case 3:case"end":return o.stop()}}),_callee8,this)})))}},{key:"isFormatSupported",value:function isFormatSupported(o){var s=this.supportedFormats;for(var m in s)if(o.includes(s[m]))return!0;return!1}},{key:"onPlayerEvent",set:function set(o){try{this.registerEventListeners(o)}catch(o){this.logger.warn("Player encountered an error when registering listeners ".concat(o))}}},{key:"getMappedEventKey",value:function getMappedEventKey(o){var s,m=_createForOfIteratorHelper(RV.entries());try{for(m.s();!(s=m.n()).done;){var _=_slicedToArray$1(s.value,2),S=_[0];if(_[1]===o)return S}}catch(o){m.e(o)}finally{m.f()}}},{key:"bitrateRange",get:function get(){return this._bitrateRange}},{key:"duration",get:function get(){return this.videoEl.duration}},{key:"currentTime",get:function get(){return this.videoEl.currentTime},set:function set(o){this.videoEl.currentTime=o}},{key:"isPlaying",get:function get(){return!this.videoEl.paused},set:function set(o){o?this.videoEl.pause():(this.videoEl.play(),this.player.goToLive())}},{key:"width",get:function get(){return this.videoEl.clientWidth}},{key:"height",get:function get(){return this.videoEl.clientHeight}},{key:"ccEnabled",get:function get(){return this._ccEnabled}},{key:"ccAvailable",get:function get(){return!1}},{key:"videoElement",get:function get(){return this.videoEl},set:function set(o){this.videoEl=o,this.size(this.width,this.height)}}]),ShakaPlayer}(),KV=function(){function DependencyRegistry(){_classCallCheck$1(this,DependencyRegistry),this.typeMappings=[],this.dependencyKeys={LogStorage:"LogStorage",API:"API",Store:"Store",Profiling:"Profiling",Logger:"Logger"}}return _createClass$1(DependencyRegistry,[{key:"registerType",value:function registerType(o,s){var m=this.typeMappings.findIndex((function(o){return o.token===s}));-1!==m?this.typeMappings[m]={instance:o,token:s}:this.typeMappings.push({instance:o,token:s})}},{key:"resolveType",value:function resolveType(o){var s=this.typeMappings.find((function(s){return s.token===o}));if(!s)throw new Error("Type registration not found for type ".concat(o));return s.instance}}]),DependencyRegistry}();new KV;var zV=function(){function DebugProxy(){_classCallCheck$1(this,DebugProxy),this._isStarted=!1}return _createClass$1(DebugProxy,[{key:"startProxy",value:function startProxy(o){if(this._isStarted)console.error("Error starting DebugProxy; it is already started");else{o.indexOf(":")<0&&(o+=":8888"),this._isStarted=!0,console.warn("DebugProxy started using proxyAddress=".concat(o));var s="http://".concat(o,"/;"),m=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(_,S,E,A,O){(S=S.toString()).toString().indexOf(o)<0&&(S="".concat(s).concat(S)),m.bind(this)(_,S.toString(),!!E,A,O)};var _=window.fetch;window.fetch=function(m,S){var E=m.toString();return E.toString().indexOf(o)<0&&(E="".concat(s).concat(E)),_(E,S)}}}}]),DebugProxy}();new zV;var WV,GV=function(){function DateTimeService(){_classCallCheck$1(this,DateTimeService)}return _createClass$1(DateTimeService,[{key:"getUTCString",value:function getUTCString(o){return o||(o=new Date),new Date(o).toUTCString()}},{key:"getUTCNow",value:function getUTCNow(){return this.asUTC()}},{key:"asUTC",value:function asUTC(o){return new Date(this.getUTCString(o))}}]),DateTimeService}();!function(o){o[o.ERROR=1]="ERROR",o[o.WARN=2]="WARN",o[o.INFO=3]="INFO",o[o.DEBUG=4]="DEBUG",o[o.PERFORMANCE=5]="PERFORMANCE"}(WV||(WV={}));var qV=function(){function Logger(o){_classCallCheck$1(this,Logger),this.dateTimeService=new GV,this._logLevel=WV.DEBUG,this.logStorage=o}return _createClass$1(Logger,[{key:"LogLevel",get:function get(){return this._logLevel},set:function set(o){this._logLevel=o}},{key:"log",value:function log(o,s){if(o<=this.LogLevel){var m=this.dateTimeService.getUTCNow().toISOString(),_="".concat(m," | [").concat(WV[o],"] ").concat(s);this.logStorage.send(_,o)}}},{key:"error",value:function error(o){this.log(WV.ERROR,o)}},{key:"warn",value:function warn(o){this.log(WV.WARN,o)}},{key:"info",value:function info(o){this.log(WV.INFO,o)}},{key:"debug",value:function debug(o){this.log(WV.DEBUG,o)}},{key:"performance",value:function performance(o){this.log(WV.PERFORMANCE,o)}}]),Logger}(),XV=function(){function ConsoleLogStorage(){_classCallCheck$1(this,ConsoleLogStorage),this.logBatch=[]}return _createClass$1(ConsoleLogStorage,[{key:"send",value:function send(o,s){switch(s){case WV.DEBUG:console.debug(o);break;case WV.ERROR:console.error(o);break;case WV.WARN:console.warn(o);break;case WV.INFO:console.info(o);break;default:console.log(o)}}}]),ConsoleLogStorage}(),YV=new Map([["onbufferingstart","LoadStart"],["onbufferingcomplete","CanPlay"],["oncurrentplaytime","TimeUpdate"],["onbufferingprogress","Waiting"],["onstreamcompleted","Ended"],["onerror","Error"],["playing","Playing"],["onevent","onevent"],["onerrormsg","onerrormsg"],["ondrmevent","ondrmevent"],["onsubtitlechange","CueChange"]]),__awaiter$2=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},QV=function(){function AVPlayer(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{min:0,max:0},_=arguments.length>3?arguments[3]:void 0,S=arguments.length>4?arguments[4]:void 0,E=arguments.length>5?arguments[5]:void 0;_classCallCheck$1(this,AVPlayer),this.width=0,this.height=0,this.bitrateRange={min:0,max:0},this.ccEnabled=!1,this.ccAvailable=!1,this.config={type:"vod",url:""},this.logger=new qV(new XV),this._width=0,this._height=0,this._x=0,this._y=0,this.looping=!1,this.supportedFormats=[".mpd",".m3u8",".mp4",".mp3",".wav",".ogg",".aac",".flac"],this.playingEventSent=!1,this.metadata={type:"",url:"",startPosition:null,errorContext:{code:"",message:""}},this.shouldRetryOnFailure=!1,this.errorCount=0,this.retryAttempts=2,this.retryWaitTime=1e3,this.timeoutId=null,this.appEventListeners={},this.player=webapis.avplay,this.width=o,this.height=s,this.bitrateRange=m,this.shouldRetryOnFailure=null!=_&&_,this.retryAttempts=null!=S?S:2,this.retryWaitTime=null!=E?E:this.retryWaitTime,this.registerAVPLayEventListeners(),Object.assign(window,{_instanceofAVPlayer:this.player})}return _createClass$1(AVPlayer,[{key:"open",value:function open(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VOD";return __awaiter$2(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return this.timeoutId&&(clearTimeout(Number(this.timeoutId)),this.timeoutId=null),m.next=3,this._load(o,s);case 3:case"end":return m.stop()}}),_callee,this)})))}},{key:"_load",value:function _load(o,s){return __awaiter$2(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(m){for(;;)switch(m.prev=m.next){case 0:return this._loadConfig(o,s),m.next=3,this._videoLoader(this.config.url);case 3:this.logger.info("".concat(this.config.url," '< playWithUrl'"));case 4:case"end":return m.stop()}}),_callee2,this)})))}},{key:"_loadConfig",value:function _loadConfig(o,s){this.config={type:s,url:o},this.metadata={type:s,url:o,startPosition:null,errorContext:{code:"",message:""}}}},{key:"_videoLoader",value:function _videoLoader(o){return __awaiter$2(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){var s=this;return _regeneratorRuntime$1().wrap((function _callee3$(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise((function(m,_){try{s.player.open(o),s.size(s._width,s._height),s.position(s._x,s._y),s.player.prepareAsync((function(){return m()}),(function(o){_(o)}))}catch(m){s.errorCount<3?(s.errorCount++,s.player.stop(),s._videoLoader(o),s.logger.error(JSON.stringify(m,null,2))):(s.errorCount=0,_(m))}})));case 1:case"end":return m.stop()}}),_callee3)})))}},{key:"close",value:function close(){var o=this;return new Promise((function(s,m){try{o.player.stop(),s()}catch(o){m(o)}}))}},{key:"size",value:function size(o,s){this._height=s,this._width=o;try{this.player.setDisplayRect(this._x,this._y,this._width,this._height)}catch(o){this.errorHandler(o)}}},{key:"position",value:function position(o,s){this._x=o,this._y=s;try{this.player.setDisplayRect(this._x,this._y,this._width,this._height)}catch(o){this.errorHandler(o)}}},{key:"mute",value:function mute(){tizen.tvaudiocontrol.setMute(!0)}},{key:"unmute",value:function unmute(){tizen.tvaudiocontrol.setMute(!1)}},{key:"play",value:function play(){var o=this;return new Promise((function(s,m){try{o.player.play(),o.handleEvent("Play",null),s()}catch(o){m(o)}}))}},{key:"pause",value:function pause(){var o=this;return new Promise((function(s,m){try{o.player.pause(),o.handleEvent("Pause",null),o.playingEventSent=!1,s()}catch(o){m(o)}}))}},{key:"seek",value:function seek(o){var s=this;return new Promise((function(m,_){try{s.player.seekTo(o),s.handleEvent("Seeking",null),m()}catch(o){s.errorHandler(o),_(o)}}))}},{key:"loop",value:function loop(){var o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.looping=o}},{key:"isFormatSupported",value:function isFormatSupported(o){var s=this.supportedFormats;for(var m in s)if(o.includes(s[m]))return!0;return!1}},{key:"destroy",value:function destroy(){var o=this;return new Promise((function(s,m){try{o.player.close(),o.deregisterEventListeners(),s()}catch(s){o.logger.error(JSON.stringify(s,null,2)),m(s)}}))}},{key:"registerAVPLayEventListeners",value:function registerAVPLayEventListeners(){var o,s=this,m={},_=_createForOfIteratorHelper(YV);try{var S=function _loop2(){var _=o.value;Object.assign(m,_defineProperty$2({},_[0],(function(){for(var o=arguments.length,m=new Array(o),S=0;S<o;S++)m[S]=arguments[S];return s.handleEvent(_[1],m)})))};for(_.s();!(o=_.n()).done;)S()}catch(o){_.e(o)}finally{_.f()}this.player.setListener(m)}},{key:"registerEventListeners",value:function registerEventListeners(o){var s,m=_createForOfIteratorHelper(YV);try{for(m.s();!(s=m.n()).done;){var _=s.value;this.on(_[1],o)}}catch(o){m.e(o)}finally{m.f()}}},{key:"deregisterEventListeners",value:function deregisterEventListeners(){var o,s={},m=_createForOfIteratorHelper(YV);try{for(m.s();!(o=m.n()).done;){var _=o.value;Object.assign(s,_defineProperty$2({},_[0],(function(){})))}}catch(o){m.e(o)}finally{m.f()}this.appEventListeners={},this.player.setListener(s)}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(o,s){this.on(o,s)}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(o){this.appEventListeners[o]=[]}},{key:"handleEvent",value:function handleEvent(o,s){var m=this,_=this.constructEvent(o,s);switch(_.type){case"CueChange":this.logger.info("".concat(_," ").concat(JSON.stringify(s,null,2)));break;case"Error":this.logger.error("Player Event: ".concat(JSON.stringify(_.type,null,2),", 'metadata' ").concat(JSON.stringify(_.metadata,null,2)));break;case"Waiting":this.playingEventSent=!1;break;case"TimeUpdate":this.playingEventSent||(this.playingEventSent=!0,this.handleEvent("Playing",null));break;case"Ended":this.player.stop(),this.looping&&this.seek(0)}if("Error"===_.type){if(_.metadata.errorContext&&parseInt(_.metadata.errorContext.code)>=2)if(this.shouldRetryOnFailure&&this.errorCount<=this.retryAttempts){this.errorCount++;var S=this.retryWaitTime>1e3?this.retryWaitTime:this.retryWaitTime*this.errorCount;this.timeoutId=setTimeout((function(){return __awaiter$2(m,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.open(this.config.url,this.config.type);case 2:case"end":return o.stop()}}),_callee4,this)})))}),S)}else this.errorCount=0,o in this.appEventListeners&&this.appEventListeners[o].forEach((function(o){o.callback(_)}))}else o in this.appEventListeners&&this.appEventListeners[o].forEach((function(o){o.callback(_)}))}},{key:"on",value:function on(o,s){this.appEventListeners[o]||(this.appEventListeners[o]=[]),this.appEventListeners[o].push({callback:s})}},{key:"errorHandler",value:function errorHandler(o){this.logger.error(JSON.stringify(o,null,2)),this.handleEvent("Error",o)}},{key:"constructEvent",value:function constructEvent(o,s){switch(o){case"onevent":return"PLAYER_MSG_BITRATE_CHANGE"===s?{type:"BitrateChange",timestamp:performance.now(),metadata:this.metadata}:"PLAYER_MSG_CUE_TAG_INFO"===s?{type:"CueInterrupted ",timestamp:performance.now(),metadata:this.metadata}:{type:"onEvent ".concat(s),timestamp:performance.now(),metadata:this.metadata};case"Error":var m=this.metadata;return s&&s instanceof JV&&(m.errorContext={code:s.code,message:s.message}),{type:o,timestamp:performance.now(),metadata:m};default:return{type:o,timestamp:performance.now(),metadata:this.metadata}}}},{key:"hide",value:function hide(){this.logger.warn("Method hide not supported.")}},{key:"show",value:function show(){this.logger.warn("Method show not supported.")}},{key:"convertPlayerTime",value:function convertPlayerTime(o){return o/1e3}},{key:"onPlayerEvent",set:function set(o){try{this.registerEventListeners(o)}catch(o){this.logger.warn("Player encountered an error when registering listeners ".concat(o))}}},{key:"renderCC",value:function renderCC(o){console.log("Method not implemented.",o)}},{key:"playerState",get:function get(){return this.player.getState()}},{key:"isPlaying",get:function get(){return"PLAYING"===this.playerState}},{key:"currentTime",get:function get(){return this.convertPlayerTime(this.player.getCurrentTime())}},{key:"duration",get:function get(){return this.convertPlayerTime(this.player.getDuration())}}]),AVPlayer}(),JV=_createClass$1((function AVError(){_classCallCheck$1(this,AVError)}));new(function(){function DependencyRegistry(){_classCallCheck$1(this,DependencyRegistry),this.typeMappings=[],this.dependencyKeys={LogStorage:"LogStorage",API:"API",Store:"Store",Profiling:"Profiling",Logger:"Logger"}}return _createClass$1(DependencyRegistry,[{key:"registerType",value:function registerType(o,s){var m=this.typeMappings.findIndex((function(o){return o.token===s}));-1!==m?this.typeMappings[m]={instance:o,token:s}:this.typeMappings.push({instance:o,token:s})}},{key:"resolveType",value:function resolveType(o){var s=this.typeMappings.find((function(s){return s.token===o}));if(!s)throw new Error("Type registration not found for type ".concat(o));return s.instance}}]),DependencyRegistry}());var ZV=function(){function DebugProxy(){_classCallCheck$1(this,DebugProxy),this._isStarted=!1}return _createClass$1(DebugProxy,[{key:"startProxy",value:function startProxy(o){if(this._isStarted)console.error("Error starting DebugProxy; it is already started");else{o.indexOf(":")<0&&(o+=":8888"),this._isStarted=!0,console.warn("DebugProxy started using proxyAddress=".concat(o));var s="http://".concat(o,"/;"),m=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(_,S,E,A,O){(S=S.toString()).toString().indexOf(o)<0&&(S="".concat(s).concat(S)),m.bind(this)(_,S.toString(),!!E,A,O)};var _=window.fetch;window.fetch=function(m,S){var E=m.toString();return E.toString().indexOf(o)<0&&(E="".concat(s).concat(E)),_(E,S)}}}}]),DebugProxy}();new ZV;var eH,tH=function(){function DateTimeService(){_classCallCheck$1(this,DateTimeService)}return _createClass$1(DateTimeService,[{key:"getUTCString",value:function getUTCString(o){return o||(o=new Date),new Date(o).toUTCString()}},{key:"getUTCNow",value:function getUTCNow(){return this.asUTC()}},{key:"asUTC",value:function asUTC(o){return new Date(this.getUTCString(o))}}]),DateTimeService}();!function(o){o[o.ERROR=1]="ERROR",o[o.WARN=2]="WARN",o[o.INFO=3]="INFO",o[o.DEBUG=4]="DEBUG",o[o.PERFORMANCE=5]="PERFORMANCE"}(eH||(eH={}));var nH,rH=function(){function Logger(o){_classCallCheck$1(this,Logger),this.dateTimeService=new tH,this._logLevel=eH.DEBUG,this.logStorage=o}return _createClass$1(Logger,[{key:"LogLevel",get:function get(){return this._logLevel},set:function set(o){this._logLevel=o}},{key:"log",value:function log(o,s){if(o<=this.LogLevel){var m=this.dateTimeService.getUTCNow().toISOString(),_="".concat(m," | [").concat(eH[o],"] ").concat(s);this.logStorage.send(_,o)}}},{key:"error",value:function error(o){this.log(eH.ERROR,o)}},{key:"warn",value:function warn(o){this.log(eH.WARN,o)}},{key:"info",value:function info(o){this.log(eH.INFO,o)}},{key:"debug",value:function debug(o){this.log(eH.DEBUG,o)}},{key:"performance",value:function performance(o){this.log(eH.PERFORMANCE,o)}}]),Logger}(),iH=function(){function ConsoleLogStorage(){_classCallCheck$1(this,ConsoleLogStorage),this.logBatch=[]}return _createClass$1(ConsoleLogStorage,[{key:"send",value:function send(o,s){switch(s){case eH.DEBUG:console.debug(o);break;case eH.ERROR:console.error(o);break;case eH.WARN:console.warn(o);break;case eH.INFO:console.info(o);break;default:console.log(o)}}}]),ConsoleLogStorage}(),aH=new Map([["Initialized","PlayerInitialized"],["QualityChanged","PlayerQualityChanged"],["DurationChanged","PlayerDurationChanged"],["VolumeChanged","PlayerVolumeChanged"],["MutedChanged","PlayerMutedChanged"],["PlaybackRateChanged","PlayerPlaybackRateChanged"],["Rebuffering","PlayerRebuffering"],["AudioBlocked","PlayerAudioBlocked"],["PlaybackBlocked","PlayerPlaybackBlocked"],["Error","PlayerError"],["TimeUpdate","PlayerTimeUpdate"],["BufferUpdate","PlayerBufferUpdate"],["SeekCompleted","PlayerSeekCompleted"],["TextCue","PlayerTextCue"],["TextMetadataCue","PlayerTextMetadataCue"],["NetworkUnavailable","PlayerNetworkUnavailable"],["Buffering","Buffering"],["Ended","Ended"],["Pause","Idle"],["Idle","Idle"],["Playing","Playing"],["Ready","Ready"]]),__awaiter$1=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},oH=function(){function IVS(o,s,m,_){var S=this;if(_classCallCheck$1(this,IVS),this.supportedFormats=[".mpd",".m3u8",".mp4",".mp3",".aac",".flac"],this.renderFunction=function(o){return console.log(o)},this.logger=new rH(new iH),this.playbackConfig={type:"",url:""},this.playerWidth=o,this.playerHeight=s,this.playerBitrateRange=m,_)this.videoElement=_;else{var E=document.createElement("video");document.body.appendChild(E),this.videoElement=E}this.videoElement.id="ivs-player",this.videoElement.style.position="absolute",window.IVSPlayer?this.initPlayer():this.injectIVS().then((function(){S.initPlayer()}))}return _createClass$1(IVS,[{key:"initPlayer",value:function initPlayer(){var o;this.player=IVSPlayer.create(),null===(o=this.player)||void 0===o||o.attachHTMLVideoElement(this.videoElement),this.registerEventListeners()}},{key:"open",value:function open(o,s){var m;return __awaiter$1(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(_){for(;;)switch(_.prev=_.next){case 0:return this.playbackConfig={type:s||"Live",url:o,startPosition:null},_.abrupt("return",null===(m=this.player)||void 0===m?void 0:m.load(o));case 2:case"end":return _.stop()}}),_callee,this)})))}},{key:"injectIVS",value:function injectIVS(){return new Promise((function(o,s){var m=document.createElement("script");m.src="https://player.live-video.net/1.21.0/amazon-ivs-player.min.js",m.onload=function(){o()},m.onerror=function(){s()},document.body&&document.body.appendChild(m)}))}},{key:"close",value:function close(){var o;return __awaiter$1(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){return _regeneratorRuntime$1().wrap((function _callee2$(s){for(;;)switch(s.prev=s.next){case 0:null===(o=this.player)||void 0===o||o.pause();case 1:case"end":return s.stop()}}),_callee2,this)})))}},{key:"size",value:function size(o,s){this.videoElement&&(this.playerWidth=o,this.playerHeight=s,this.videoElement.style.width="".concat(o,"px"),this.videoElement.style.height="".concat(s,"px"))}},{key:"position",value:function position(o,s){this.videoElement&&(this.videoElement.style.left="".concat(o,"px"),this.videoElement.style.top="".concat(s,"px"))}},{key:"mute",value:function mute(){var o;null===(o=this.player)||void 0===o||o.setMuted(!0)}},{key:"unmute",value:function unmute(){var o;null===(o=this.player)||void 0===o||o.setMuted(!1)}},{key:"play",value:function play(){var o;return __awaiter$1(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(s){for(;;)switch(s.prev=s.next){case 0:null===(o=this.player)||void 0===o||o.play();case 1:case"end":return s.stop()}}),_callee3,this)})))}},{key:"pause",value:function pause(){var o;return __awaiter$1(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(s){for(;;)switch(s.prev=s.next){case 0:null===(o=this.player)||void 0===o||o.pause();case 1:case"end":return s.stop()}}),_callee4,this)})))}},{key:"seek",value:function seek(o){var s;return __awaiter$1(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(m){for(;;)switch(m.prev=m.next){case 0:null===(s=this.player)||void 0===s||s.seekTo(o);case 1:case"end":return m.stop()}}),_callee5,this)})))}},{key:"loop",value:function loop(o){this.logger.warn("Loop method not available ".concat(o))}},{key:"isFormatSupported",value:function isFormatSupported(o){var s,m=_createForOfIteratorHelper(this.supportedFormats);try{for(m.s();!(s=m.n()).done;){var _=s.value;if(o.includes(_))return!0}}catch(o){m.e(o)}finally{m.f()}return!1}},{key:"destroy",value:function destroy(){var o;return __awaiter$1(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(s){for(;;)switch(s.prev=s.next){case 0:null===(o=this.player)||void 0===o||o.delete(),this.videoElement.remove();case 2:case"end":return s.stop()}}),_callee6,this)})))}},{key:"registerEventListeners",value:function registerEventListeners(o){var s,m,_=this,S=_createForOfIteratorHelper(aH);try{var E=function _loop2(){var S=_slicedToArray$1(m.value,2),E=S[0],A=S[1];null===(s=_.player)||void 0===s||s.addEventListener(A,(function(s){return _.handleEvent(E,s,o)}))};for(S.s();!(m=S.n()).done;)E()}catch(o){S.e(o)}finally{S.f()}}},{key:"deregisterEventListeners",value:function deregisterEventListeners(o){var s,m,_=this,S=_createForOfIteratorHelper(aH);try{var E=function _loop3(){var S=_slicedToArray$1(m.value,2),E=S[0],A=S[1];null===(s=_.player)||void 0===s||s.removeEventListener(E,(function(s){return _.handleEvent(A,s,o)}))};for(S.s();!(m=S.n()).done;)E()}catch(o){S.e(o)}finally{S.f()}}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(o,s){var m,_=aH.get(o);_&&(null===(m=this.player)||void 0===m||m.addEventListener(_,s))}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(o,s){var m;null===(m=this.player)||void 0===m||m.removeEventListener(o,s)}},{key:"handleEvent",value:function handleEvent(o,s,m){var _={playbackConfig:this.playbackConfig};if("TextCue"===o){var S=s;this.renderFunction(S.text)}m&&m({type:o,timestamp:performance.now(),metadata:_,payload:s})}},{key:"hide",value:function hide(){this.videoElement.hidden=!0}},{key:"show",value:function show(){this.videoElement.hidden=!1}},{key:"onPlayerEvent",set:function set(o){try{this.registerEventListeners(o)}catch(o){this.logger.warn("Player encountered an error when registering listeners ".concat(o))}}},{key:"renderCC",set:function set(o){this.renderFunction=o}},{key:"isPlaying",get:function get(){var o;return!(null===(o=this.player)||void 0===o?void 0:o.isPaused())}},{key:"currentTime",get:function get(){var o;return(null===(o=this.player)||void 0===o?void 0:o.getPosition())||0}},{key:"duration",get:function get(){var o;return(null===(o=this.player)||void 0===o?void 0:o.getDuration())||0}},{key:"width",get:function get(){return this.playerWidth}},{key:"height",get:function get(){return this.playerHeight}},{key:"bitrateRange",get:function get(){return this.playerBitrateRange}},{key:"ccEnabled",get:function get(){return!0}},{key:"ccAvailable",get:function get(){return!1}}]),IVS}(),sH=void 0!==Or?Or:"undefined"!=typeof window?window:{},uH=getAugmentedNamespace(Object.freeze({__proto__:null,default:{}}));"undefined"!=typeof document?nH=document:(nH=sH["__GLOBAL_DOCUMENT_CACHE@4"])||(nH=sH["__GLOBAL_DOCUMENT_CACHE@4"]=uH);var lH=nH,cH={exports:{}};!function(o,s){function keyCode(o){if(o&&"object"==typeof o){var s=o.which||o.keyCode||o.charCode;s&&(o=s)}if("number"==typeof o)return E[o];var S,A=String(o);return(S=m[A.toLowerCase()])?S:(S=_[A.toLowerCase()])||(1===A.length?A.charCodeAt(0):void 0)}keyCode.isEventKey=function isEventKey(o,s){if(o&&"object"==typeof o){var S=o.which||o.keyCode||o.charCode;if(null==S)return!1;if("string"==typeof s){var E;if(E=m[s.toLowerCase()])return E===S;if(E=_[s.toLowerCase()])return E===S}else if("number"==typeof s)return s===S;return!1}};var m=(s=o.exports=keyCode).code=s.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},_=s.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};
/*!
     * Programatically add the following
     */
for(S=97;S<123;S++)m[String.fromCharCode(S)]=S-32;for(var S=48;S<58;S++)m[S-48]=S;for(S=1;S<13;S++)m["f"+S]=S+111;for(S=0;S<10;S++)m["numpad "+S]=S+96;var E=s.names=s.title={};for(S in m)E[m[S]]=S;for(var A in _)m[A]=_[A]}(cH,cH.exports);var dH=cH.exports,hH=function SafeParseTuple(o,s){var m,_=null;try{m=JSON.parse(o,s)}catch(o){_=o}return[_,m]};var pH={exports:{}},fH={exports:{}};!function(o){function _extends(){return o.exports=_extends=Object.assign?Object.assign.bind():function(o){for(var s=1;s<arguments.length;s++){var m=arguments[s];for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o},o.exports.__esModule=!0,o.exports.default=o.exports,_extends.apply(this,arguments)}o.exports=_extends,o.exports.__esModule=!0,o.exports.default=o.exports}(fH);var gH=getDefaultExportFromCjs$1(fH.exports),mH=function isFunction$1(o){if(!o)return!1;var s=yH.call(o);return"[object Function]"===s||"function"==typeof o&&"[object RegExp]"!==s||"undefined"!=typeof window&&(o===window.setTimeout||o===window.alert||o===window.confirm||o===window.prompt)},yH=Object.prototype.toString;var vH=$V;var _H=function httpResponseHandler(o,s){return void 0===s&&(s=!1),function(m,_,S){if(m)o(m);else if(_.statusCode>=400&&_.statusCode<=599){var E=S;if(s)if(vH.TextDecoder){var A=function getCharset(o){void 0===o&&(o="");return o.toLowerCase().split(";").reduce((function(o,s){var m=s.split("="),_=m[0],S=m[1];return"charset"===_.trim()?S.trim():o}),"utf-8")}(_.headers&&_.headers["content-type"]);try{E=new TextDecoder(A).decode(S)}catch(o){}}else E=String.fromCharCode.apply(null,new Uint8Array(S));o({cause:E})}else o(null,S)}},bH=$V,SH=fH.exports,TH=mH;createXHR.httpHandler=_H;
/**
   * @license
   * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
   * Copyright (c) 2014 David Björklund
   * Available under the MIT license
   * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
   */
var kH=function parseHeaders(o){var s={};return o?(o.trim().split("\n").forEach((function(o){var m=o.indexOf(":"),_=o.slice(0,m).trim().toLowerCase(),S=o.slice(m+1).trim();void 0===s[_]?s[_]=S:Array.isArray(s[_])?s[_].push(S):s[_]=[s[_],S]})),s):s};function initParams(o,s,m){var _=o;return TH(s)?(m=s,"string"==typeof o&&(_={uri:o})):_=SH({},s,{uri:o}),_.callback=m,_}function createXHR(o,s,m){return _createXHR(s=initParams(o,s,m))}function _createXHR(o){if(void 0===o.callback)throw new Error("callback argument missing");var s=!1,m=function cbOnce(m,_,S){s||(s=!0,o.callback(m,_,S))};function getBody(){var o=void 0;if(o=E.response?E.response:E.responseText||function getXml(o){try{if("document"===o.responseType)return o.responseXML;var s=o.responseXML&&"parsererror"===o.responseXML.documentElement.nodeName;if(""===o.responseType&&!s)return o.responseXML}catch(o){}return null}(E),q)try{o=JSON.parse(o)}catch(o){}return o}function errorFunc(o){return clearTimeout(A),o instanceof Error||(o=new Error(""+(o||"Unknown XMLHttpRequest Error"))),o.statusCode=0,m(o,X)}function loadFunc(){if(!S){var s;clearTimeout(A),s=o.useXDR&&void 0===E.status?200:1223===E.status?204:E.status;var _=X,K=null;return 0!==s?(_={body:getBody(),statusCode:s,method:H,headers:{},url:O,rawRequest:E},E.getAllResponseHeaders&&(_.headers=kH(E.getAllResponseHeaders()))):K=new Error("Internal XMLHttpRequest Error"),m(K,_,_.body)}}var _,S,E=o.xhr||null;E||(E=o.cors||o.useXDR?new createXHR.XDomainRequest:new createXHR.XMLHttpRequest);var A,O=E.url=o.uri||o.url,H=E.method=o.method||"GET",K=o.body||o.data,z=E.headers=o.headers||{},G=!!o.sync,q=!1,X={body:void 0,headers:{},statusCode:0,method:H,url:O,rawRequest:E};if("json"in o&&!1!==o.json&&(q=!0,z.accept||z.Accept||(z.Accept="application/json"),"GET"!==H&&"HEAD"!==H&&(z["content-type"]||z["Content-Type"]||(z["Content-Type"]="application/json"),K=JSON.stringify(!0===o.json?K:o.json))),E.onreadystatechange=function readystatechange(){4===E.readyState&&setTimeout(loadFunc,0)},E.onload=loadFunc,E.onerror=errorFunc,E.onprogress=function(){},E.onabort=function(){S=!0},E.ontimeout=errorFunc,E.open(H,O,!G,o.username,o.password),G||(E.withCredentials=!!o.withCredentials),!G&&o.timeout>0&&(A=setTimeout((function(){if(!S){S=!0,E.abort("timeout");var o=new Error("XMLHttpRequest timeout");o.code="ETIMEDOUT",errorFunc(o)}}),o.timeout)),E.setRequestHeader)for(_ in z)z.hasOwnProperty(_)&&E.setRequestHeader(_,z[_]);else if(o.headers&&!function isEmpty(o){for(var s in o)if(o.hasOwnProperty(s))return!1;return!0}(o.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in o&&(E.responseType=o.responseType),"beforeSend"in o&&"function"==typeof o.beforeSend&&o.beforeSend(E),E.send(K||null),E}pH.exports=createXHR,pH.exports.default=createXHR,createXHR.XMLHttpRequest=bH.XMLHttpRequest||function noop$2(){},createXHR.XDomainRequest="withCredentials"in new createXHR.XMLHttpRequest?createXHR.XMLHttpRequest:bH.XDomainRequest,function forEachArray(o,s){for(var m=0;m<o.length;m++)s(o[m])}(["get","put","post","patch","head","delete"],(function(o){createXHR["delete"===o?"del":o]=function(s,m,_){return(m=initParams(s,m,_)).method=o.toUpperCase(),_createXHR(m)}}));var CH=pH.exports,wH={exports:{}},xH=lH,EH=Object.create||function(){function F(){}return function(o){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return F.prototype=o,new F}}();function ParsingError(o,s){this.name="ParsingError",this.code=o.code,this.message=s||o.message}function parseTimeStamp(o){function computeSeconds(o,s,m,_){return 3600*(0|o)+60*(0|s)+(0|m)+(0|_)/1e3}var s=o.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return s?s[3]?computeSeconds(s[1],s[2],s[3].replace(":",""),s[4]):s[1]>59?computeSeconds(s[1],s[2],0,s[4]):computeSeconds(0,s[1],s[2],s[4]):null}function Settings(){this.values=EH(null)}function parseOptions(o,s,m,_){var S=_?o.split(_):[o];for(var E in S)if("string"==typeof S[E]){var A=S[E].split(m);if(2===A.length)s(A[0].trim(),A[1].trim())}}function parseCue(o,s,m){var _=o;function consumeTimeStamp(){var s=parseTimeStamp(o);if(null===s)throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed timestamp: "+_);return o=o.replace(/^[^\sa-zA-Z-]+/,""),s}function skipWhitespace(){o=o.replace(/^\s+/,"")}if(skipWhitespace(),s.startTime=consumeTimeStamp(),skipWhitespace(),"--\x3e"!==o.substr(0,3))throw new ParsingError(ParsingError.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+_);o=o.substr(3),skipWhitespace(),s.endTime=consumeTimeStamp(),skipWhitespace(),function consumeCueSettings(o,s){var _=new Settings;parseOptions(o,(function(o,s){switch(o){case"region":for(var S=m.length-1;S>=0;S--)if(m[S].id===s){_.set(o,m[S].region);break}break;case"vertical":_.alt(o,s,["rl","lr"]);break;case"line":var E=s.split(","),A=E[0];_.integer(o,A),_.percent(o,A)&&_.set("snapToLines",!1),_.alt(o,A,["auto"]),2===E.length&&_.alt("lineAlign",E[1],["start","center","end"]);break;case"position":E=s.split(","),_.percent(o,E[0]),2===E.length&&_.alt("positionAlign",E[1],["start","center","end"]);break;case"size":_.percent(o,s);break;case"align":_.alt(o,s,["start","center","end","left","right"])}}),/:/,/\s/),s.region=_.get("region",null),s.vertical=_.get("vertical","");try{s.line=_.get("line","auto")}catch(o){}s.lineAlign=_.get("lineAlign","start"),s.snapToLines=_.get("snapToLines",!0),s.size=_.get("size",100);try{s.align=_.get("align","center")}catch(o){s.align=_.get("align","middle")}try{s.position=_.get("position","auto")}catch(o){s.position=_.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},s.align)}s.positionAlign=_.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},s.align)}(o,s)}ParsingError.prototype=EH(Error.prototype),ParsingError.prototype.constructor=ParsingError,ParsingError.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Settings.prototype={set:function set(o,s){this.get(o)||""===s||(this.values[o]=s)},get:function get(o,s,m){return m?this.has(o)?this.values[o]:s[m]:this.has(o)?this.values[o]:s},has:function has(o){return o in this.values},alt:function alt(o,s,m){for(var _=0;_<m.length;++_)if(s===m[_]){this.set(o,s);break}},integer:function integer(o,s){/^-?\d+$/.test(s)&&this.set(o,parseInt(s,10))},percent:function percent(o,s){return!!(s.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(s=parseFloat(s))>=0&&s<=100)&&(this.set(o,s),!0)}};var IH=xH.createElement&&xH.createElement("textarea"),AH={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},PH={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},LH={v:"title",lang:"lang"},DH={rt:"ruby"};function parseContent(o,s){function nextToken(){if(!s)return null;var o=s.match(/^([^<]*)(<[^>]*>?)?/);return function consume(o){return s=s.substr(o.length),o}(o[1]?o[1]:o[2])}function unescape(o){return IH.innerHTML=o,o=IH.textContent,IH.textContent="",o}function shouldAdd(o,s){return!DH[s.localName]||DH[s.localName]===o.localName}function createElement(s,m){var _=AH[s];if(!_)return null;var S=o.document.createElement(_),E=LH[s];return E&&m&&(S[E]=m.trim()),S}for(var m,_=o.document.createElement("div"),S=_,E=[];null!==(m=nextToken());)if("<"!==m[0])S.appendChild(o.document.createTextNode(unescape(m)));else{if("/"===m[1]){E.length&&E[E.length-1]===m.substr(2).replace(">","")&&(E.pop(),S=S.parentNode);continue}var A,O=parseTimeStamp(m.substr(1,m.length-2));if(O){A=o.document.createProcessingInstruction("timestamp",O),S.appendChild(A);continue}var H=m.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!H)continue;if(!(A=createElement(H[1],H[3])))continue;if(!shouldAdd(S,A))continue;if(H[2]){var K=H[2].split(".");K.forEach((function(o){var s=/^bg_/.test(o),m=s?o.slice(3):o;if(PH.hasOwnProperty(m)){var _=s?"background-color":"color",S=PH[m];A.style[_]=S}})),A.className=K.join(" ")}E.push(H[1]),S.appendChild(A),S=A}return _}var RH=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function isStrongRTLChar(o){for(var s=0;s<RH.length;s++){var m=RH[s];if(o>=m[0]&&o<=m[1])return!0}return!1}function determineBidi(o){var s=[],m="";if(!o||!o.childNodes)return"ltr";function pushNodes(o,s){for(var m=s.childNodes.length-1;m>=0;m--)o.push(s.childNodes[m])}function nextTextNode(o){if(!o||!o.length)return null;var s=o.pop(),m=s.textContent||s.innerText;if(m){var _=m.match(/^.*(\n|\r)/);return _?(o.length=0,_[0]):m}return"ruby"===s.tagName?nextTextNode(o):s.childNodes?(pushNodes(o,s),nextTextNode(o)):void 0}for(pushNodes(s,o);m=nextTextNode(s);)for(var _=0;_<m.length;_++)if(isStrongRTLChar(m.charCodeAt(_)))return"rtl";return"ltr"}function StyleBox(){}function CueStyleBox(o,s,m){StyleBox.call(this),this.cue=s,this.cueDiv=parseContent(o,s.text);var _={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===s.vertical?"horizontal-tb":"lr"===s.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(_,this.cueDiv),this.div=o.document.createElement("div"),_={direction:determineBidi(this.cueDiv),writingMode:""===s.vertical?"horizontal-tb":"lr"===s.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===s.align?"center":s.align,font:m.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(_),this.div.appendChild(this.cueDiv);var S=0;switch(s.positionAlign){case"start":case"line-left":S=s.position;break;case"center":S=s.position-s.size/2;break;case"end":case"line-right":S=s.position-s.size}""===s.vertical?this.applyStyles({left:this.formatStyle(S,"%"),width:this.formatStyle(s.size,"%")}):this.applyStyles({top:this.formatStyle(S,"%"),height:this.formatStyle(s.size,"%")}),this.move=function(o){this.applyStyles({top:this.formatStyle(o.top,"px"),bottom:this.formatStyle(o.bottom,"px"),left:this.formatStyle(o.left,"px"),right:this.formatStyle(o.right,"px"),height:this.formatStyle(o.height,"px"),width:this.formatStyle(o.width,"px")})}}function BoxPosition(o){var s,m,_,S;if(o.div){m=o.div.offsetHeight,_=o.div.offsetWidth,S=o.div.offsetTop;var E=(E=o.div.childNodes)&&(E=E[0])&&E.getClientRects&&E.getClientRects();o=o.div.getBoundingClientRect(),s=E?Math.max(E[0]&&E[0].height||0,o.height/E.length):0}this.left=o.left,this.right=o.right,this.top=o.top||S,this.height=o.height||m,this.bottom=o.bottom||S+(o.height||m),this.width=o.width||_,this.lineHeight=void 0!==s?s:o.lineHeight}function moveBoxToLinePosition(o,s,m,_){var S=new BoxPosition(s),E=s.cue,A=function computeLinePos(o){if("number"==typeof o.line&&(o.snapToLines||o.line>=0&&o.line<=100))return o.line;if(!o.track||!o.track.textTrackList||!o.track.textTrackList.mediaElement)return-1;for(var s=o.track,m=s.textTrackList,_=0,S=0;S<m.length&&m[S]!==s;S++)"showing"===m[S].mode&&_++;return-1*++_}(E),O=[];if(E.snapToLines){var H;switch(E.vertical){case"":O=["+y","-y"],H="height";break;case"rl":O=["+x","-x"],H="width";break;case"lr":O=["-x","+x"],H="width"}var K=S.lineHeight,z=K*Math.round(A),G=m[H]+K,q=O[0];Math.abs(z)>G&&(z=z<0?-1:1,z*=Math.ceil(G/K)*K),A<0&&(z+=""===E.vertical?m.height:m.width,O=O.reverse()),S.move(q,z)}else{var X=S.lineHeight/m.height*100;switch(E.lineAlign){case"center":A-=X/2;break;case"end":A-=X}switch(E.vertical){case"":s.applyStyles({top:s.formatStyle(A,"%")});break;case"rl":s.applyStyles({left:s.formatStyle(A,"%")});break;case"lr":s.applyStyles({right:s.formatStyle(A,"%")})}O=["+y","-x","+x","-y"],S=new BoxPosition(s)}var J=function findBestPosition(o,s){for(var S,E=new BoxPosition(o),A=1,O=0;O<s.length;O++){for(;o.overlapsOppositeAxis(m,s[O])||o.within(m)&&o.overlapsAny(_);)o.move(s[O]);if(o.within(m))return o;var H=o.intersectPercentage(m);A>H&&(S=new BoxPosition(o),A=H),o=new BoxPosition(E)}return S||E}(S,O);s.move(J.toCSSCompatValues(m))}function WebVTT$1(){}StyleBox.prototype.applyStyles=function(o,s){for(var m in s=s||this.div,o)o.hasOwnProperty(m)&&(s.style[m]=o[m])},StyleBox.prototype.formatStyle=function(o,s){return 0===o?0:o+s},CueStyleBox.prototype=EH(StyleBox.prototype),CueStyleBox.prototype.constructor=CueStyleBox,BoxPosition.prototype.move=function(o,s){switch(s=void 0!==s?s:this.lineHeight,o){case"+x":this.left+=s,this.right+=s;break;case"-x":this.left-=s,this.right-=s;break;case"+y":this.top+=s,this.bottom+=s;break;case"-y":this.top-=s,this.bottom-=s}},BoxPosition.prototype.overlaps=function(o){return this.left<o.right&&this.right>o.left&&this.top<o.bottom&&this.bottom>o.top},BoxPosition.prototype.overlapsAny=function(o){for(var s=0;s<o.length;s++)if(this.overlaps(o[s]))return!0;return!1},BoxPosition.prototype.within=function(o){return this.top>=o.top&&this.bottom<=o.bottom&&this.left>=o.left&&this.right<=o.right},BoxPosition.prototype.overlapsOppositeAxis=function(o,s){switch(s){case"+x":return this.left<o.left;case"-x":return this.right>o.right;case"+y":return this.top<o.top;case"-y":return this.bottom>o.bottom}},BoxPosition.prototype.intersectPercentage=function(o){return Math.max(0,Math.min(this.right,o.right)-Math.max(this.left,o.left))*Math.max(0,Math.min(this.bottom,o.bottom)-Math.max(this.top,o.top))/(this.height*this.width)},BoxPosition.prototype.toCSSCompatValues=function(o){return{top:this.top-o.top,bottom:o.bottom-this.bottom,left:this.left-o.left,right:o.right-this.right,height:this.height,width:this.width}},BoxPosition.getSimpleBoxPosition=function(o){var s=o.div?o.div.offsetHeight:o.tagName?o.offsetHeight:0,m=o.div?o.div.offsetWidth:o.tagName?o.offsetWidth:0,_=o.div?o.div.offsetTop:o.tagName?o.offsetTop:0;return{left:(o=o.div?o.div.getBoundingClientRect():o.tagName?o.getBoundingClientRect():o).left,right:o.right,top:o.top||_,height:o.height||s,bottom:o.bottom||_+(o.height||s),width:o.width||m}},WebVTT$1.StringDecoder=function(){return{decode:function decode(o){if(!o)return"";if("string"!=typeof o)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(o))}}},WebVTT$1.convertCueToDOMTree=function(o,s){return o&&s?parseContent(o,s):null};WebVTT$1.processCues=function(o,s,m){if(!o||!s||!m)return null;for(;m.firstChild;)m.removeChild(m.firstChild);var _=o.document.createElement("div");if(_.style.position="absolute",_.style.left="0",_.style.right="0",_.style.top="0",_.style.bottom="0",_.style.margin="1.5%",m.appendChild(_),function shouldCompute(o){for(var s=0;s<o.length;s++)if(o[s].hasBeenReset||!o[s].displayState)return!0;return!1}(s)){var S=[],E=BoxPosition.getSimpleBoxPosition(_),A={font:Math.round(.05*E.height*100)/100+"px sans-serif"};!function(){for(var m,O,H=0;H<s.length;H++)O=s[H],m=new CueStyleBox(o,O,A),_.appendChild(m.div),moveBoxToLinePosition(0,m,E,S),O.displayState=m.div,S.push(BoxPosition.getSimpleBoxPosition(m))}()}else for(var O=0;O<s.length;O++)_.appendChild(s[O].displayState)},WebVTT$1.Parser=function(o,s,m){m||(m=s,s={}),s||(s={}),this.window=o,this.vttjs=s,this.state="INITIAL",this.buffer="",this.decoder=m||new TextDecoder("utf8"),this.regionList=[]},WebVTT$1.Parser.prototype={reportOrThrowError:function reportOrThrowError(o){if(!(o instanceof ParsingError))throw o;this.onparsingerror&&this.onparsingerror(o)},parse:function parse(o){var s=this;function collectNextLine(){for(var o=s.buffer,m=0;m<o.length&&"\r"!==o[m]&&"\n"!==o[m];)++m;var _=o.substr(0,m);return"\r"===o[m]&&++m,"\n"===o[m]&&++m,s.buffer=o.substr(m),_}function parseHeader(o){o.match(/X-TIMESTAMP-MAP/)?parseOptions(o,(function(o,m){if("X-TIMESTAMP-MAP"===o)!function parseTimestampMap(o){var m=new Settings;parseOptions(o,(function(o,s){switch(o){case"MPEGT":m.integer(o+"S",s);break;case"LOCA":m.set(o+"L",parseTimeStamp(s))}}),/[^\d]:/,/,/),s.ontimestampmap&&s.ontimestampmap({MPEGTS:m.get("MPEGTS"),LOCAL:m.get("LOCAL")})}(m)}),/=/):parseOptions(o,(function(o,m){if("Region"===o)!function parseRegion(o){var m=new Settings;if(parseOptions(o,(function(o,s){switch(o){case"id":m.set(o,s);break;case"width":m.percent(o,s);break;case"lines":m.integer(o,s);break;case"regionanchor":case"viewportanchor":var _=s.split(",");if(2!==_.length)break;var S=new Settings;if(S.percent("x",_[0]),S.percent("y",_[1]),!S.has("x")||!S.has("y"))break;m.set(o+"X",S.get("x")),m.set(o+"Y",S.get("y"));break;case"scroll":m.alt(o,s,["up"])}}),/=/,/\s/),m.has("id")){var _=new(s.vttjs.VTTRegion||s.window.VTTRegion);_.width=m.get("width",100),_.lines=m.get("lines",3),_.regionAnchorX=m.get("regionanchorX",0),_.regionAnchorY=m.get("regionanchorY",100),_.viewportAnchorX=m.get("viewportanchorX",0),_.viewportAnchorY=m.get("viewportanchorY",100),_.scroll=m.get("scroll",""),s.onregion&&s.onregion(_),s.regionList.push({id:m.get("id"),region:_})}}(m)}),/:/)}o&&(s.buffer+=s.decoder.decode(o,{stream:!0}));try{var m;if("INITIAL"===s.state){if(!/\r\n|\n/.test(s.buffer))return this;var _=(m=collectNextLine()).match(/^WEBVTT([ \t].*)?$/);if(!_||!_[0])throw new ParsingError(ParsingError.Errors.BadSignature);s.state="HEADER"}for(var S=!1;s.buffer;){if(!/\r\n|\n/.test(s.buffer))return this;switch(S?S=!1:m=collectNextLine(),s.state){case"HEADER":/:/.test(m)?parseHeader(m):m||(s.state="ID");continue;case"NOTE":m||(s.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(m)){s.state="NOTE";break}if(!m)continue;s.cue=new(s.vttjs.VTTCue||s.window.VTTCue)(0,0,"");try{s.cue.align="center"}catch(o){s.cue.align="middle"}if(s.state="CUE",-1===m.indexOf("--\x3e")){s.cue.id=m;continue}case"CUE":try{parseCue(m,s.cue,s.regionList)}catch(o){s.reportOrThrowError(o),s.cue=null,s.state="BADCUE";continue}s.state="CUETEXT";continue;case"CUETEXT":var E=-1!==m.indexOf("--\x3e");if(!m||E&&(S=!0)){s.oncue&&s.oncue(s.cue),s.cue=null,s.state="ID";continue}s.cue.text&&(s.cue.text+="\n"),s.cue.text+=m.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":m||(s.state="ID");continue}}}catch(o){s.reportOrThrowError(o),"CUETEXT"===s.state&&s.cue&&s.oncue&&s.oncue(s.cue),s.cue=null,s.state="INITIAL"===s.state?"BADWEBVTT":"BADCUE"}return this},flush:function flush(){var o=this;try{if(o.buffer+=o.decoder.decode(),(o.cue||"HEADER"===o.state)&&(o.buffer+="\n\n",o.parse()),"INITIAL"===o.state)throw new ParsingError(ParsingError.Errors.BadSignature)}catch(s){o.reportOrThrowError(s)}return o.onflush&&o.onflush(),this}};var OH=WebVTT$1,MH="auto",FH={"":1,lr:1,rl:1},NH={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function findAlignSetting(o){return"string"==typeof o&&(!!NH[o.toLowerCase()]&&o.toLowerCase())}function VTTCue$1(o,s,m){this.hasBeenReset=!1;var _="",S=!1,E=o,A=s,O=m,H=null,K="",z=!0,G="auto",q="start",X="auto",J="auto",ae=100,pe="center";Object.defineProperties(this,{id:{enumerable:!0,get:function get(){return _},set:function set(o){_=""+o}},pauseOnExit:{enumerable:!0,get:function get(){return S},set:function set(o){S=!!o}},startTime:{enumerable:!0,get:function get(){return E},set:function set(o){if("number"!=typeof o)throw new TypeError("Start time must be set to a number.");E=o,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function get(){return A},set:function set(o){if("number"!=typeof o)throw new TypeError("End time must be set to a number.");A=o,this.hasBeenReset=!0}},text:{enumerable:!0,get:function get(){return O},set:function set(o){O=""+o,this.hasBeenReset=!0}},region:{enumerable:!0,get:function get(){return H},set:function set(o){H=o,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function get(){return K},set:function set(o){var s=function findDirectionSetting(o){return"string"==typeof o&&!!FH[o.toLowerCase()]&&o.toLowerCase()}(o);if(!1===s)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");K=s,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function get(){return z},set:function set(o){z=!!o,this.hasBeenReset=!0}},line:{enumerable:!0,get:function get(){return G},set:function set(o){if("number"!=typeof o&&o!==MH)throw new SyntaxError("Line: an invalid number or illegal string was specified.");G=o,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function get(){return q},set:function set(o){var s=findAlignSetting(o);s?(q=s,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function get(){return X},set:function set(o){if(o<0||o>100)throw new Error("Position must be between 0 and 100.");X=o,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function get(){return J},set:function set(o){var s=findAlignSetting(o);s?(J=s,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function get(){return ae},set:function set(o){if(o<0||o>100)throw new Error("Size must be between 0 and 100.");ae=o,this.hasBeenReset=!0}},align:{enumerable:!0,get:function get(){return pe},set:function set(o){var s=findAlignSetting(o);if(!s)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");pe=s,this.hasBeenReset=!0}}}),this.displayState=void 0}VTTCue$1.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var UH=VTTCue$1,BH={"":!0,up:!0};function isValidPercentValue(o){return"number"==typeof o&&o>=0&&o<=100}var jH=function VTTRegion(){var o=100,s=3,m=0,_=100,S=0,E=100,A="";Object.defineProperties(this,{width:{enumerable:!0,get:function get(){return o},set:function set(s){if(!isValidPercentValue(s))throw new Error("Width must be between 0 and 100.");o=s}},lines:{enumerable:!0,get:function get(){return s},set:function set(o){if("number"!=typeof o)throw new TypeError("Lines must be set to a number.");s=o}},regionAnchorY:{enumerable:!0,get:function get(){return _},set:function set(o){if(!isValidPercentValue(o))throw new Error("RegionAnchorX must be between 0 and 100.");_=o}},regionAnchorX:{enumerable:!0,get:function get(){return m},set:function set(o){if(!isValidPercentValue(o))throw new Error("RegionAnchorY must be between 0 and 100.");m=o}},viewportAnchorY:{enumerable:!0,get:function get(){return E},set:function set(o){if(!isValidPercentValue(o))throw new Error("ViewportAnchorY must be between 0 and 100.");E=o}},viewportAnchorX:{enumerable:!0,get:function get(){return S},set:function set(o){if(!isValidPercentValue(o))throw new Error("ViewportAnchorX must be between 0 and 100.");S=o}},scroll:{enumerable:!0,get:function get(){return A},set:function set(o){var s=function findScrollSetting(o){return"string"==typeof o&&!!BH[o.toLowerCase()]&&o.toLowerCase()}(o);!1===s?console.warn("Scroll: an invalid or illegal string was specified."):A=s}}})},$H=$V,VH=wH.exports={WebVTT:OH,VTTCue:UH,VTTRegion:jH};$H.vttjs=VH,$H.WebVTT=VH.WebVTT;var HH=VH.VTTCue,KH=VH.VTTRegion,zH=$H.VTTCue,WH=$H.VTTRegion;VH.shim=function(){$H.VTTCue=HH,$H.VTTRegion=KH},VH.restore=function(){$H.VTTCue=zH,$H.VTTRegion=WH},$H.VTTCue||VH.shim();var GH=wH.exports,qH={exports:{}};!function(o,s){!function(s){var m=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,_=/^(?=([^\/?#]*))\1([^]*)$/,S=/(?:\/|^)\.(?=\/)/g,E=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,A={buildAbsoluteURL:function buildAbsoluteURL(o,s,m){if(m=m||{},o=o.trim(),!(s=s.trim())){if(!m.alwaysNormalize)return o;var S=A.parseURL(o);if(!S)throw new Error("Error trying to parse base URL.");return S.path=A.normalizePath(S.path),A.buildURLFromParts(S)}var E=A.parseURL(s);if(!E)throw new Error("Error trying to parse relative URL.");if(E.scheme)return m.alwaysNormalize?(E.path=A.normalizePath(E.path),A.buildURLFromParts(E)):s;var O=A.parseURL(o);if(!O)throw new Error("Error trying to parse base URL.");if(!O.netLoc&&O.path&&"/"!==O.path[0]){var H=_.exec(O.path);O.netLoc=H[1],O.path=H[2]}O.netLoc&&!O.path&&(O.path="/");var K={scheme:O.scheme,netLoc:E.netLoc,path:null,params:E.params,query:E.query,fragment:E.fragment};if(!E.netLoc&&(K.netLoc=O.netLoc,"/"!==E.path[0]))if(E.path){var z=O.path,G=z.substring(0,z.lastIndexOf("/")+1)+E.path;K.path=A.normalizePath(G)}else K.path=O.path,E.params||(K.params=O.params,E.query||(K.query=O.query));return null===K.path&&(K.path=m.alwaysNormalize?A.normalizePath(E.path):E.path),A.buildURLFromParts(K)},parseURL:function parseURL(o){var s=m.exec(o);return s?{scheme:s[1]||"",netLoc:s[2]||"",path:s[3]||"",params:s[4]||"",query:s[5]||"",fragment:s[6]||""}:null},normalizePath:function normalizePath(o){for(o=o.split("").reverse().join("").replace(S,"");o.length!==(o=o.replace(E,"")).length;);return o.split("").reverse().join("")},buildURLFromParts:function buildURLFromParts(o){return o.scheme+o.netLoc+o.path+o.params+o.query+o.fragment}};o.exports=A}()}(qH);var XH=qH.exports,YH="http://example.com",QH=function resolveUrl(o,s){if(/^[a-z]+:/i.test(s))return s;/^data:/.test(o)&&(o=$V.location&&$V.location.href||"");var m="function"==typeof $V.URL,_=/^\/\//.test(o),S=!$V.location&&!/\/\//i.test(o);if(m?o=new $V.URL(o,$V.location||YH):/\/\//i.test(o)||(o=XH.buildAbsoluteURL($V.location&&$V.location.href||"",o)),m){var E=new URL(s,o);return S?E.href.slice(YH.length):_?E.href.slice(E.protocol.length):E.href}return XH.buildAbsoluteURL(o,s)},JH=function(){function Stream(){this.listeners={}}var o=Stream.prototype;return o.on=function on(o,s){this.listeners[o]||(this.listeners[o]=[]),this.listeners[o].push(s)},o.off=function off(o,s){if(!this.listeners[o])return!1;var m=this.listeners[o].indexOf(s);return this.listeners[o]=this.listeners[o].slice(0),this.listeners[o].splice(m,1),m>-1},o.trigger=function trigger(o){var s=this.listeners[o];if(s)if(2===arguments.length)for(var m=s.length,_=0;_<m;++_)s[_].call(this,arguments[1]);else for(var S=Array.prototype.slice.call(arguments,1),E=s.length,A=0;A<E;++A)s[A].apply(this,S)},o.dispose=function dispose(){this.listeners={}},o.pipe=function pipe(o){this.on("data",(function(s){o.push(s)}))},Stream}(),ZH=function atob(o){return $V.atob?$V.atob(o):Buffer.from(o,"base64").toString("binary")};function decodeB64ToUint8Array$1(o){for(var s=ZH(o),m=new Uint8Array(s.length),_=0;_<s.length;_++)m[_]=s.charCodeAt(_);return m}var eK=function(o){_inherits$1(LineStream,o);var s=_createSuper$1(LineStream);function LineStream(){var o;return _classCallCheck$1(this,LineStream),(o=s.call(this)).buffer="",o}return _createClass$1(LineStream,[{key:"push",value:function push(o){var s;for(this.buffer+=o,s=this.buffer.indexOf("\n");s>-1;s=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,s)),this.buffer=this.buffer.substring(s+1)}}]),LineStream}(JH),tK=String.fromCharCode(9),nK=function parseByterange(o){var s=/([0-9.]*)?@?([0-9.]*)?/.exec(o||""),m={};return s[1]&&(m.length=parseInt(s[1],10)),s[2]&&(m.offset=parseInt(s[2],10)),m},rK=function parseAttributes(o){var s={};if(!o)return s;for(var m,_=o.split(function attributeSeparator(){return new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')}()),S=_.length;S--;)""!==_[S]&&((m=/([^=]*)=(.*)/.exec(_[S]).slice(1))[0]=m[0].replace(/^\s+|\s+$/g,""),m[1]=m[1].replace(/^\s+|\s+$/g,""),m[1]=m[1].replace(/^['"](.*)['"]$/g,"$1"),s[m[0]]=m[1]);return s},iK=function(o){_inherits$1(ParseStream,o);var s=_createSuper$1(ParseStream);function ParseStream(){var o;return _classCallCheck$1(this,ParseStream),(o=s.call(this)).customParsers=[],o.tagMappers=[],o}return _createClass$1(ParseStream,[{key:"push",value:function push(o){var s,m,_=this;0!==(o=o.trim()).length&&("#"===o[0]?this.tagMappers.reduce((function(s,m){var _=m(o);return _===o?s:s.concat([_])}),[o]).forEach((function(o){for(var S=0;S<_.customParsers.length;S++)if(_.customParsers[S].call(_,o))return;if(0===o.indexOf("#EXT"))if(o=o.replace("\r",""),s=/^#EXTM3U/.exec(o))_.trigger("data",{type:"tag",tagType:"m3u"});else{if(s=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(o))return m={type:"tag",tagType:"inf"},s[1]&&(m.duration=parseFloat(s[1])),s[2]&&(m.title=s[2]),void _.trigger("data",m);if(s=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(o))return m={type:"tag",tagType:"targetduration"},s[1]&&(m.duration=parseInt(s[1],10)),void _.trigger("data",m);if(s=/^#EXT-X-VERSION:([0-9.]*)?/.exec(o))return m={type:"tag",tagType:"version"},s[1]&&(m.version=parseInt(s[1],10)),void _.trigger("data",m);if(s=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(o))return m={type:"tag",tagType:"media-sequence"},s[1]&&(m.number=parseInt(s[1],10)),void _.trigger("data",m);if(s=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(o))return m={type:"tag",tagType:"discontinuity-sequence"},s[1]&&(m.number=parseInt(s[1],10)),void _.trigger("data",m);if(s=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(o))return m={type:"tag",tagType:"playlist-type"},s[1]&&(m.playlistType=s[1]),void _.trigger("data",m);if(s=/^#EXT-X-BYTERANGE:(.*)?$/.exec(o))return m=gH(nK(s[1]),{type:"tag",tagType:"byterange"}),void _.trigger("data",m);if(s=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(o))return m={type:"tag",tagType:"allow-cache"},s[1]&&(m.allowed=!/NO/.test(s[1])),void _.trigger("data",m);if(s=/^#EXT-X-MAP:(.*)$/.exec(o)){if(m={type:"tag",tagType:"map"},s[1]){var E=rK(s[1]);E.URI&&(m.uri=E.URI),E.BYTERANGE&&(m.byterange=nK(E.BYTERANGE))}_.trigger("data",m)}else if(s=/^#EXT-X-STREAM-INF:(.*)$/.exec(o)){if(m={type:"tag",tagType:"stream-inf"},s[1]){if(m.attributes=rK(s[1]),m.attributes.RESOLUTION){var A=m.attributes.RESOLUTION.split("x"),O={};A[0]&&(O.width=parseInt(A[0],10)),A[1]&&(O.height=parseInt(A[1],10)),m.attributes.RESOLUTION=O}m.attributes.BANDWIDTH&&(m.attributes.BANDWIDTH=parseInt(m.attributes.BANDWIDTH,10)),m.attributes["FRAME-RATE"]&&(m.attributes["FRAME-RATE"]=parseFloat(m.attributes["FRAME-RATE"])),m.attributes["PROGRAM-ID"]&&(m.attributes["PROGRAM-ID"]=parseInt(m.attributes["PROGRAM-ID"],10))}_.trigger("data",m)}else{if(s=/^#EXT-X-MEDIA:(.*)$/.exec(o))return m={type:"tag",tagType:"media"},s[1]&&(m.attributes=rK(s[1])),void _.trigger("data",m);if(s=/^#EXT-X-ENDLIST/.exec(o))_.trigger("data",{type:"tag",tagType:"endlist"});else if(s=/^#EXT-X-DISCONTINUITY/.exec(o))_.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(s=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(o))return m={type:"tag",tagType:"program-date-time"},s[1]&&(m.dateTimeString=s[1],m.dateTimeObject=new Date(s[1])),void _.trigger("data",m);if(s=/^#EXT-X-KEY:(.*)$/.exec(o))return m={type:"tag",tagType:"key"},s[1]&&(m.attributes=rK(s[1]),m.attributes.IV&&("0x"===m.attributes.IV.substring(0,2).toLowerCase()&&(m.attributes.IV=m.attributes.IV.substring(2)),m.attributes.IV=m.attributes.IV.match(/.{8}/g),m.attributes.IV[0]=parseInt(m.attributes.IV[0],16),m.attributes.IV[1]=parseInt(m.attributes.IV[1],16),m.attributes.IV[2]=parseInt(m.attributes.IV[2],16),m.attributes.IV[3]=parseInt(m.attributes.IV[3],16),m.attributes.IV=new Uint32Array(m.attributes.IV))),void _.trigger("data",m);if(s=/^#EXT-X-START:(.*)$/.exec(o))return m={type:"tag",tagType:"start"},s[1]&&(m.attributes=rK(s[1]),m.attributes["TIME-OFFSET"]=parseFloat(m.attributes["TIME-OFFSET"]),m.attributes.PRECISE=/YES/.test(m.attributes.PRECISE)),void _.trigger("data",m);if(s=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(o))return m={type:"tag",tagType:"cue-out-cont"},s[1]?m.data=s[1]:m.data="",void _.trigger("data",m);if(s=/^#EXT-X-CUE-OUT:(.*)?$/.exec(o))return m={type:"tag",tagType:"cue-out"},s[1]?m.data=s[1]:m.data="",void _.trigger("data",m);if(s=/^#EXT-X-CUE-IN:(.*)?$/.exec(o))return m={type:"tag",tagType:"cue-in"},s[1]?m.data=s[1]:m.data="",void _.trigger("data",m);if((s=/^#EXT-X-SKIP:(.*)$/.exec(o))&&s[1])return(m={type:"tag",tagType:"skip"}).attributes=rK(s[1]),m.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(m.attributes["SKIPPED-SEGMENTS"]=parseInt(m.attributes["SKIPPED-SEGMENTS"],10)),m.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(m.attributes["RECENTLY-REMOVED-DATERANGES"]=m.attributes["RECENTLY-REMOVED-DATERANGES"].split(tK)),void _.trigger("data",m);if((s=/^#EXT-X-PART:(.*)$/.exec(o))&&s[1])return(m={type:"tag",tagType:"part"}).attributes=rK(s[1]),["DURATION"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=parseFloat(m.attributes[o]))})),["INDEPENDENT","GAP"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=/YES/.test(m.attributes[o]))})),m.attributes.hasOwnProperty("BYTERANGE")&&(m.attributes.byterange=nK(m.attributes.BYTERANGE)),void _.trigger("data",m);if((s=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(o))&&s[1])return(m={type:"tag",tagType:"server-control"}).attributes=rK(s[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=parseFloat(m.attributes[o]))})),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=/YES/.test(m.attributes[o]))})),void _.trigger("data",m);if((s=/^#EXT-X-PART-INF:(.*)$/.exec(o))&&s[1])return(m={type:"tag",tagType:"part-inf"}).attributes=rK(s[1]),["PART-TARGET"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=parseFloat(m.attributes[o]))})),void _.trigger("data",m);if((s=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(o))&&s[1])return(m={type:"tag",tagType:"preload-hint"}).attributes=rK(s[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(o){if(m.attributes.hasOwnProperty(o)){m.attributes[o]=parseInt(m.attributes[o],10);var s="BYTERANGE-LENGTH"===o?"length":"offset";m.attributes.byterange=m.attributes.byterange||{},m.attributes.byterange[s]=m.attributes[o],delete m.attributes[o]}})),void _.trigger("data",m);if((s=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(o))&&s[1])return(m={type:"tag",tagType:"rendition-report"}).attributes=rK(s[1]),["LAST-MSN","LAST-PART"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=parseInt(m.attributes[o],10))})),void _.trigger("data",m);if((s=/^#EXT-X-DATERANGE:(.*)$/.exec(o))&&s[1]){(m={type:"tag",tagType:"daterange"}).attributes=rK(s[1]),["ID","CLASS"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=String(m.attributes[o]))})),["START-DATE","END-DATE"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=new Date(m.attributes[o]))})),["DURATION","PLANNED-DURATION"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=parseFloat(m.attributes[o]))})),["END-ON-NEXT"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=/YES/i.test(m.attributes[o]))})),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach((function(o){m.attributes.hasOwnProperty(o)&&(m.attributes[o]=m.attributes[o].toString(16))}));var H=/^X-([A-Z]+-)+[A-Z]+$/;for(var K in m.attributes)if(H.test(K)){var z=/[0-9A-Fa-f]{6}/g.test(m.attributes[K]),G=/^\d+(\.\d+)?$/.test(m.attributes[K]);m.attributes[K]=z?m.attributes[K].toString(16):G?parseFloat(m.attributes[K]):String(m.attributes[K])}_.trigger("data",m)}else if(s=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(o))_.trigger("data",{type:"tag",tagType:"independent-segments"});else{if(s=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(o))return(m={type:"tag",tagType:"content-steering"}).attributes=rK(s[1]),void _.trigger("data",m);_.trigger("data",{type:"tag",data:o.slice(4)})}}}}else _.trigger("data",{type:"comment",text:o.slice(1)})})):this.trigger("data",{type:"uri",uri:o}))}},{key:"addParser",value:function addParser(o){var s=this,m=o.expression,_=o.customType,S=o.dataParser,E=o.segment;"function"!=typeof S&&(S=function dataParser(o){return o}),this.customParsers.push((function(o){if(m.exec(o))return s.trigger("data",{type:"custom",data:S(o),customType:_,segment:E}),!0}))}},{key:"addTagMapper",value:function addTagMapper(o){var s=o.expression,m=o.map;this.tagMappers.push((function mapFn(o){return s.test(o)?m(o):o}))}}]),ParseStream}(JH),aK=function camelCaseKeys(o){var s={};return Object.keys(o).forEach((function(m){s[function camelCase(o){return o.toLowerCase().replace(/-(\w)/g,(function(o){return o[1].toUpperCase()}))}(m)]=o[m]})),s},oK=function setHoldBack(o){var s=o.serverControl,m=o.targetDuration,_=o.partTargetDuration;if(s){var S="#EXT-X-SERVER-CONTROL",E="holdBack",A="partHoldBack",O=m&&3*m,H=_&&2*_;m&&!s.hasOwnProperty(E)&&(s[E]=O,this.trigger("info",{message:"".concat(S," defaulting HOLD-BACK to targetDuration * 3 (").concat(O,").")})),O&&s[E]<O&&(this.trigger("warn",{message:"".concat(S," clamping HOLD-BACK (").concat(s[E],") to targetDuration * 3 (").concat(O,")")}),s[E]=O),_&&!s.hasOwnProperty(A)&&(s[A]=3*_,this.trigger("info",{message:"".concat(S," defaulting PART-HOLD-BACK to partTargetDuration * 3 (").concat(s[A],").")})),_&&s[A]<H&&(this.trigger("warn",{message:"".concat(S," clamping PART-HOLD-BACK (").concat(s[A],") to partTargetDuration * 2 (").concat(H,").")}),s[A]=H)}},sK=function(o){_inherits$1(Parser,o);var s=_createSuper$1(Parser);function Parser(){var o;_classCallCheck$1(this,Parser),(o=s.call(this)).lineStream=new eK,o.parseStream=new iK,o.lineStream.pipe(o.parseStream),o.lastProgramDateTime=null;var m,_,S=_assertThisInitialized(o),E=[],A={},O=!1,H=function noop(){},K={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},z=0;o.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],segments:[]};var G=0,q=0,X={};return o.on("end",(function(){A.uri||!A.parts&&!A.preloadHints||(!A.map&&m&&(A.map=m),!A.key&&_&&(A.key=_),A.timeline||"number"!=typeof z||(A.timeline=z),o.manifest.preloadSegment=A)})),o.parseStream.on("data",(function(o){var s,J;({tag:function tag(){({version:function version(){o.version&&(this.manifest.version=o.version)},"allow-cache":function allowCache(){this.manifest.allowCache=o.allowed,"allowed"in o||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function byterange(){var byterange={};"length"in o&&(A.byterange=byterange,byterange.length=o.length,"offset"in o||(o.offset=G)),"offset"in o&&(A.byterange=byterange,byterange.offset=o.offset),G=byterange.offset+byterange.length},endlist:function endlist(){this.manifest.endList=!0},inf:function inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),o.title&&(A.title=o.title),o.duration>0&&(A.duration=o.duration),0===o.duration&&(A.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=E},key:function key(){if(o.attributes)if("NONE"!==o.attributes.METHOD)if(o.attributes.URI){if("com.apple.streamingkeydelivery"===o.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:o.attributes});if("com.microsoft.playready"===o.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.microsoft.playready"]={uri:o.attributes.URI});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===o.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(o.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===o.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==o.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):o.attributes.KEYID&&"0x"===o.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:o.attributes.KEYFORMAT,keyId:o.attributes.KEYID.substring(2)},pssh:decodeB64ToUint8Array$1(o.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}o.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),_={method:o.attributes.METHOD||"AES-128",uri:o.attributes.URI},void 0!==o.attributes.IV&&(_.iv=o.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else _=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function mediaSequence(){isFinite(o.number)?this.manifest.mediaSequence=o.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+o.number})},"discontinuity-sequence":function discontinuitySequence(){isFinite(o.number)?(this.manifest.discontinuitySequence=o.number,z=o.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+o.number})},"playlist-type":function playlistType(){/VOD|EVENT/.test(o.playlistType)?this.manifest.playlistType=o.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+o.playlist})},map:function map(){m={},o.uri&&(m.uri=o.uri),o.byterange&&(m.byterange=o.byterange),_&&(m.key=_)},"stream-inf":function streamInf(){this.manifest.playlists=E,this.manifest.mediaGroups=this.manifest.mediaGroups||K,o.attributes?(A.attributes||(A.attributes={}),gH(A.attributes,o.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||K,o.attributes&&o.attributes.TYPE&&o.attributes["GROUP-ID"]&&o.attributes.NAME){var m=this.manifest.mediaGroups[o.attributes.TYPE];m[o.attributes["GROUP-ID"]]=m[o.attributes["GROUP-ID"]]||{},s=m[o.attributes["GROUP-ID"]],(J={default:/yes/i.test(o.attributes.DEFAULT)}).default?J.autoselect=!0:J.autoselect=/yes/i.test(o.attributes.AUTOSELECT),o.attributes.LANGUAGE&&(J.language=o.attributes.LANGUAGE),o.attributes.URI&&(J.uri=o.attributes.URI),o.attributes["INSTREAM-ID"]&&(J.instreamId=o.attributes["INSTREAM-ID"]),o.attributes.CHARACTERISTICS&&(J.characteristics=o.attributes.CHARACTERISTICS),o.attributes.FORCED&&(J.forced=/yes/i.test(o.attributes.FORCED)),s[o.attributes.NAME]=J}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function discontinuity(){z+=1,A.discontinuity=!0,this.manifest.discontinuityStarts.push(E.length)},"program-date-time":function programDateTime(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=o.dateTimeString,this.manifest.dateTimeObject=o.dateTimeObject),A.dateTimeString=o.dateTimeString,A.dateTimeObject=o.dateTimeObject;var s=this.lastProgramDateTime;this.lastProgramDateTime=new Date(o.dateTimeString).getTime(),null===s&&this.manifest.segments.reduceRight((function(o,s){return s.programDateTime=o-1e3*s.duration,s.programDateTime}),this.lastProgramDateTime)},targetduration:function targetduration(){!isFinite(o.duration)||o.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+o.duration}):(this.manifest.targetDuration=o.duration,oK.call(this,this.manifest))},start:function start(){o.attributes&&!isNaN(o.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:o.attributes["TIME-OFFSET"],precise:o.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function cueOut(){A.cueOut=o.data},"cue-out-cont":function cueOutCont(){A.cueOutCont=o.data},"cue-in":function cueIn(){A.cueIn=o.data},skip:function skip(){this.manifest.skip=aK(o.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",o.attributes,["SKIPPED-SEGMENTS"])},part:function part(){var s=this;O=!0;var m=this.manifest.segments.length,part=aK(o.attributes);A.parts=A.parts||[],A.parts.push(part),part.byterange&&(part.byterange.hasOwnProperty("offset")||(part.byterange.offset=q),q=part.byterange.offset+part.byterange.length);var _=A.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #".concat(_," for segment #").concat(m),o.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((function(o,m){o.hasOwnProperty("lastPart")||s.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #".concat(m," lacks required attribute(s): LAST-PART")})}))},"server-control":function serverControl(){var s=this.manifest.serverControl=aK(o.attributes);s.hasOwnProperty("canBlockReload")||(s.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),oK.call(this,this.manifest),s.canSkipDateranges&&!s.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function preloadHint(){var s=this.manifest.segments.length,m=aK(o.attributes),_=m.type&&"PART"===m.type;A.preloadHints=A.preloadHints||[],A.preloadHints.push(m),m.byterange&&(m.byterange.hasOwnProperty("offset")||(m.byterange.offset=_?q:0,_&&(q=m.byterange.offset+m.byterange.length)));var S=A.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #".concat(S," for segment #").concat(s),o.attributes,["TYPE","URI"]),m.type)for(var E=0;E<A.preloadHints.length-1;E++){var O=A.preloadHints[E];O.type&&(O.type===m.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #".concat(S," for segment #").concat(s," has the same TYPE ").concat(m.type," as preload hint #").concat(E)}))}},"rendition-report":function renditionReport(){var s=aK(o.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(s);var m=this.manifest.renditionReports.length-1,_=["LAST-MSN","URI"];O&&_.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #".concat(m),o.attributes,_)},"part-inf":function partInf(){this.manifest.partInf=aK(o.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",o.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),oK.call(this,this.manifest)},daterange:function daterange(){this.manifest.dateRanges.push(aK(o.attributes));var s=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_("#EXT-X-DATERANGE #".concat(s),o.attributes,["ID","START-DATE"]);var m=this.manifest.dateRanges[s];m.endDate&&m.startDate&&new Date(m.endDate)<new Date(m.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),m.duration&&m.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),m.plannedDuration&&m.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});var _=!!m.endOnNext;if(_&&!m.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),_&&(m.duration||m.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),m.duration&&m.endDate){var S=m.startDate.getTime()+1e3*m.duration;this.manifest.dateRanges[s].endDate=new Date(S)}if(X[m.id]){for(var E in X[m.id])if(m[E]&&JSON.stringify(X[m.id][E])!==JSON.stringify(m[E])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}var A=this.manifest.dateRanges.findIndex((function(o){return o.id===m.id}));this.manifest.dateRanges[A]=gH(this.manifest.dateRanges[A],m),X[m.id]=gH(X[m.id],m),this.manifest.dateRanges.pop()}else X[m.id]=m},"independent-segments":function independentSegments(){this.manifest.independentSegments=!0},"content-steering":function contentSteering(){this.manifest.contentSteering=aK(o.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",o.attributes,["SERVER-URI"])}}[o.tagType]||H).call(S)},uri:function uri(){A.uri=o.uri,E.push(A),this.manifest.targetDuration&&!("duration"in A)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),A.duration=this.manifest.targetDuration),_&&(A.key=_),A.timeline=z,m&&(A.map=m),q=0,null!==this.lastProgramDateTime&&(A.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=1e3*A.duration),A={}},comment:function comment(){},custom:function custom(){o.segment?(A.custom=A.custom||{},A.custom[o.customType]=o.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[o.customType]=o.data)}})[o.type].call(S)})),o}return _createClass$1(Parser,[{key:"warnOnMissingAttributes_",value:function warnOnMissingAttributes_(o,s,m){var _=[];m.forEach((function(o){s.hasOwnProperty(o)||_.push(o)})),_.length&&this.trigger("warn",{message:"".concat(o," lacks required attribute(s): ").concat(_.join(", "))})}},{key:"push",value:function push(o){this.lineStream.push(o)}},{key:"end",value:function end(){this.lineStream.push("\n"),this.manifest.dateRanges.length&&null===this.lastProgramDateTime&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}},{key:"addParser",value:function addParser(o){this.parseStream.addParser(o)}},{key:"addTagMapper",value:function addTagMapper(o){this.parseStream.addTagMapper(o)}}]),Parser}(JH),uK={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},lK=["video","audio","text"],cK=["Video","Audio","Text"],dK=function translateLegacyCodec(o){return o?o.replace(/avc1\.(\d+)\.(\d+)/i,(function(o,s,m){return"avc1."+("00"+Number(s).toString(16)).slice(-2)+"00"+("00"+Number(m).toString(16)).slice(-2)})):o},hK=function parseCodecs(o){void 0===o&&(o="");var s=o.split(","),m=[];return s.forEach((function(o){var s;o=o.trim(),lK.forEach((function(_){var S=uK[_].exec(o.toLowerCase());if(S&&!(S.length<=1)){s=_;var E=o.substring(0,S[1].length),A=o.replace(E,"");m.push({type:E,details:A,mediaType:_})}})),s||m.push({type:o,details:"",mediaType:"unknown"})})),m},pK=function codecsFromDefault(o,s){if(!o.mediaGroups.AUDIO||!s)return null;var m=o.mediaGroups.AUDIO[s];if(!m)return null;for(var _ in m){var S=m[_];if(S.default&&S.playlists)return hK(S.playlists[0].attributes.CODECS)}return null},fK=function isAudioCodec(o){return void 0===o&&(o=""),uK.audio.test(o.trim().toLowerCase())},gK=function getMimeForCodec(o){if(o&&"string"==typeof o){var s=o.toLowerCase().split(",").map((function(o){return dK(o.trim())})),m="video";1===s.length&&fK(s[0])?m="audio":1===s.length&&function isTextCodec(o){return void 0===o&&(o=""),uK.text.test(o.trim().toLowerCase())}(s[0])&&(m="application");var _="mp4";return s.every((function(o){return uK.mp4.test(o)}))?_="mp4":s.every((function(o){return uK.webm.test(o)}))?_="webm":s.every((function(o){return uK.ogg.test(o)}))&&(_="ogg"),m+"/"+_+';codecs="'+o+'"'}},mK=function browserSupportsCodec(o){return void 0===o&&(o=""),$V.MediaSource&&$V.MediaSource.isTypeSupported&&$V.MediaSource.isTypeSupported(gK(o))||!1},yK=function muxerSupportsCodec(o){return void 0===o&&(o=""),o.toLowerCase().split(",").every((function(o){o=o.trim();for(var s=0;s<cK.length;s++){if(uK["muxer"+cK[s]].test(o))return!0}return!1}))},vK="mp4a.40.2",_K="avc1.4d400d",bK=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,SK=/^application\/dash\+xml/i,TK=function simpleTypeFromSourceType(o){return bK.test(o)?"hls":SK.test(o)?"dash":"application/vnd.videojs.vhs+json"===o?"vhs-json":null},kK=function isArrayBufferView(o){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(o):o&&o.buffer instanceof ArrayBuffer},CK=function toUint8(o){return o instanceof Uint8Array?o:(Array.isArray(o)||function isTypedArray(o){return kK(o)}(o)||o instanceof ArrayBuffer||(o="number"!=typeof o||"number"==typeof o&&o!=o?0:[o]),new Uint8Array(o&&o.buffer||o,o&&o.byteOffset||0,o&&o.byteLength||0))},wK=$V.BigInt||Number,xK=[wK("0x1"),wK("0x100"),wK("0x10000"),wK("0x1000000"),wK("0x100000000"),wK("0x10000000000"),wK("0x1000000000000"),wK("0x100000000000000"),wK("0x10000000000000000")];!function(){var o=new Uint16Array([65484]),s=new Uint8Array(o.buffer,o.byteOffset,o.byteLength);255===s[0]||s[0]}();var EK=function bytesToNumber(o,s){var m=void 0===s?{}:s,_=m.signed,S=void 0!==_&&_,E=m.le,A=void 0!==E&&E;o=CK(o);var O=A?"reduce":"reduceRight",H=(o[O]?o[O]:Array.prototype[O]).call(o,(function(s,m,_){var S=A?_:Math.abs(_+1-o.length);return s+wK(m)*xK[S]}),wK(0));if(S){var K=xK[o.length]/wK(2)-wK(1);(H=wK(H))>K&&(H-=K,H-=K,H-=wK(2))}return Number(H)},IK=function numberToBytes(o,s){var m=(void 0===s?{}:s).le,_=void 0!==m&&m;("bigint"!=typeof o&&"number"!=typeof o||"number"==typeof o&&o!=o)&&(o=0);for(var S=function countBytes(o){return Math.ceil(function countBits(o){return o.toString(2).length}(o)/8)}(o=wK(o)),E=new Uint8Array(new ArrayBuffer(S)),A=0;A<S;A++){var O=_?A:Math.abs(A+1-E.length);E[O]=Number(o/xK[A]&wK(255)),o<0&&(E[O]=Math.abs(~E[O]),E[O]-=0===A?1:2)}return E},AK=function stringToBytes(o,s){if("string"!=typeof o&&o&&"function"==typeof o.toString&&(o=o.toString()),"string"!=typeof o)return new Uint8Array;s||(o=unescape(encodeURIComponent(o)));for(var m=new Uint8Array(o.length),_=0;_<o.length;_++)m[_]=o.charCodeAt(_);return m},PK=function concatTypedArrays(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];if(s=s.filter((function(o){return o&&(o.byteLength||o.length)&&"string"!=typeof o})),s.length<=1)return CK(s[0]);var _=s.reduce((function(o,s,m){return o+(s.byteLength||s.length)}),0),S=new Uint8Array(_),E=0;return s.forEach((function(o){o=CK(o),S.set(o,E),E+=o.byteLength})),S},LK=function bytesMatch(o,s,m){var _=void 0===m?{}:m,S=_.offset,E=void 0===S?0:S,A=_.mask,O=void 0===A?[]:A;o=CK(o);var H=(s=CK(s)).every?s.every:Array.prototype.every;return s.length&&o.length-E>=s.length&&H.call(s,(function(s,m){return s===(O[m]?O[m]&o[E+m]:o[E+m])}))},DK=function atob(o){return $V.atob?$V.atob(o):Buffer.from(o,"base64").toString("binary")};var RK={},OK={};function freeze(o,s){return void 0===s&&(s=Object),s&&"function"==typeof s.freeze?s.freeze(o):o}var MK=freeze({HTML:"text/html",isHTML:function isHTML(o){return o===MK.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),FK=freeze({HTML:"http://www.w3.org/1999/xhtml",isHTML:function isHTML(o){return o===FK.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});OK.assign=function assign(o,s){if(null===o||"object"!=typeof o)throw new TypeError("target is not an object");for(var m in s)Object.prototype.hasOwnProperty.call(s,m)&&(o[m]=s[m]);return o},OK.find=function find$1(o,s,m){if(void 0===m&&(m=Array.prototype),o&&"function"==typeof m.find)return m.find.call(o,s);for(var _=0;_<o.length;_++)if(Object.prototype.hasOwnProperty.call(o,_)){var S=o[_];if(s.call(void 0,S,_,o))return S}},OK.freeze=freeze,OK.MIME_TYPE=MK,OK.NAMESPACE=FK;var NK=OK,UK=NK.find,BK=NK.NAMESPACE;function notEmptyString(o){return""!==o}function orderedSetReducer(o,s){return o.hasOwnProperty(s)||(o[s]=!0),o}function toOrderedSet(o){if(!o)return[];var s=function splitOnASCIIWhitespace(o){return o?o.split(/[\t\n\f\r ]+/).filter(notEmptyString):[]}(o);return Object.keys(s.reduce(orderedSetReducer,{}))}function copy(o,s){for(var m in o)Object.prototype.hasOwnProperty.call(o,m)&&(s[m]=o[m])}function _extends(o,s){var m=o.prototype;if(!(m instanceof s)){var _=function t(){};_.prototype=s.prototype,copy(m,_=new _),o.prototype=m=_}m.constructor!=o&&("function"!=typeof o&&console.error("unknown Class:"+o),m.constructor=o)}var jK={},$K=jK.ELEMENT_NODE=1,VK=jK.ATTRIBUTE_NODE=2,HK=jK.TEXT_NODE=3,KK=jK.CDATA_SECTION_NODE=4,zK=jK.ENTITY_REFERENCE_NODE=5,WK=jK.ENTITY_NODE=6,GK=jK.PROCESSING_INSTRUCTION_NODE=7,qK=jK.COMMENT_NODE=8,XK=jK.DOCUMENT_NODE=9,YK=jK.DOCUMENT_TYPE_NODE=10,QK=jK.DOCUMENT_FRAGMENT_NODE=11,JK=jK.NOTATION_NODE=12,ZK={},oz={};ZK.INDEX_SIZE_ERR=(oz[1]="Index size error",1),ZK.DOMSTRING_SIZE_ERR=(oz[2]="DOMString size error",2);var uz=ZK.HIERARCHY_REQUEST_ERR=(oz[3]="Hierarchy request error",3);ZK.WRONG_DOCUMENT_ERR=(oz[4]="Wrong document",4),ZK.INVALID_CHARACTER_ERR=(oz[5]="Invalid character",5),ZK.NO_DATA_ALLOWED_ERR=(oz[6]="No data allowed",6),ZK.NO_MODIFICATION_ALLOWED_ERR=(oz[7]="No modification allowed",7);var cz=ZK.NOT_FOUND_ERR=(oz[8]="Not found",8);ZK.NOT_SUPPORTED_ERR=(oz[9]="Not supported",9);var fz=ZK.INUSE_ATTRIBUTE_ERR=(oz[10]="Attribute in use",10);function DOMException$1(o,s){if(s instanceof Error)var m=s;else m=this,Error.call(this,oz[o]),this.message=oz[o],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException$1);return m.code=o,s&&(this.message=this.message+": "+s),m}function NodeList(){}function LiveNodeList(o,s){this._node=o,this._refresh=s,_updateLiveList(this)}function _updateLiveList(o){var s=o._node._inc||o._node.ownerDocument._inc;if(o._inc!==s){var m=o._refresh(o._node);if(__set__(o,"length",m.length),!o.$$length||m.length<o.$$length)for(var _=m.length;_ in o;_++)Object.prototype.hasOwnProperty.call(o,_)&&delete o[_];copy(m,o),o._inc=s}}function NamedNodeMap(){}function _findNodeIndex(o,s){for(var m=o.length;m--;)if(o[m]===s)return m}function _addNamedNode(o,s,m,_){if(_?s[_findNodeIndex(s,_)]=m:s[s.length++]=m,o){m.ownerElement=o;var S=o.ownerDocument;S&&(_&&_onRemoveAttribute(S,o,_),function _onAddAttribute(o,s,m){o&&o._inc++;var _=m.namespaceURI;_===BK.XMLNS&&(s._nsMap[m.prefix?m.localName:""]=m.value)}(S,o,m))}}function _removeNamedNode(o,s,m){var _=_findNodeIndex(s,m);if(!(_>=0))throw new DOMException$1(cz,new Error(o.tagName+"@"+m));for(var S=s.length-1;_<S;)s[_]=s[++_];if(s.length=S,o){var E=o.ownerDocument;E&&(_onRemoveAttribute(E,o,m),m.ownerElement=null)}}function DOMImplementation$1(){}function Node$1(){}function _xmlEncoder(o){return("<"==o?"&lt;":">"==o&&"&gt;")||"&"==o&&"&amp;"||'"'==o&&"&quot;"||"&#"+o.charCodeAt()+";"}function _visitNode(o,s){if(s(o))return!0;if(o=o.firstChild)do{if(_visitNode(o,s))return!0}while(o=o.nextSibling)}function Document$1(){this.ownerDocument=this}function _onRemoveAttribute(o,s,m,_){o&&o._inc++,m.namespaceURI===BK.XMLNS&&delete s._nsMap[m.prefix?m.localName:""]}function _onUpdateChild(o,s,m){if(o&&o._inc){o._inc++;var _=s.childNodes;if(m)_[_.length++]=m;else{for(var S=s.firstChild,E=0;S;)_[E++]=S,S=S.nextSibling;_.length=E,delete _[_.length]}}}function _removeChild(o,s){var m=s.previousSibling,_=s.nextSibling;return m?m.nextSibling=_:o.firstChild=_,_?_.previousSibling=m:o.lastChild=m,s.parentNode=null,s.previousSibling=null,s.nextSibling=null,_onUpdateChild(o.ownerDocument,o),s}function isDocTypeNode(o){return o&&o.nodeType===Node$1.DOCUMENT_TYPE_NODE}function isElementNode(o){return o&&o.nodeType===Node$1.ELEMENT_NODE}function isTextNode$1(o){return o&&o.nodeType===Node$1.TEXT_NODE}function isElementInsertionPossible(o,s){var m=o.childNodes||[];if(UK(m,isElementNode)||isDocTypeNode(s))return!1;var _=UK(m,isDocTypeNode);return!(s&&_&&m.indexOf(_)>m.indexOf(s))}function isElementReplacementPossible(o,s){var m=o.childNodes||[];if(UK(m,(function hasElementChildThatIsNotChild(o){return isElementNode(o)&&o!==s})))return!1;var _=UK(m,isDocTypeNode);return!(s&&_&&m.indexOf(_)>m.indexOf(s))}function assertPreInsertionValidity1to5(o,s,m){if(!function hasValidParentNodeType(o){return o&&(o.nodeType===Node$1.DOCUMENT_NODE||o.nodeType===Node$1.DOCUMENT_FRAGMENT_NODE||o.nodeType===Node$1.ELEMENT_NODE)}(o))throw new DOMException$1(uz,"Unexpected parent node type "+o.nodeType);if(m&&m.parentNode!==o)throw new DOMException$1(cz,"child not in parent");if(!function hasInsertableNodeType(o){return o&&(isElementNode(o)||isTextNode$1(o)||isDocTypeNode(o)||o.nodeType===Node$1.DOCUMENT_FRAGMENT_NODE||o.nodeType===Node$1.COMMENT_NODE||o.nodeType===Node$1.PROCESSING_INSTRUCTION_NODE)}(s)||isDocTypeNode(s)&&o.nodeType!==Node$1.DOCUMENT_NODE)throw new DOMException$1(uz,"Unexpected node type "+s.nodeType+" for parent node type "+o.nodeType)}function assertPreInsertionValidityInDocument(o,s,m){var _=o.childNodes||[],S=s.childNodes||[];if(s.nodeType===Node$1.DOCUMENT_FRAGMENT_NODE){var E=S.filter(isElementNode);if(E.length>1||UK(S,isTextNode$1))throw new DOMException$1(uz,"More than one element or text in fragment");if(1===E.length&&!isElementInsertionPossible(o,m))throw new DOMException$1(uz,"Element in fragment can not be inserted before doctype")}if(isElementNode(s)&&!isElementInsertionPossible(o,m))throw new DOMException$1(uz,"Only one element can be added and only after doctype");if(isDocTypeNode(s)){if(UK(_,isDocTypeNode))throw new DOMException$1(uz,"Only one doctype is allowed");var A=UK(_,isElementNode);if(m&&_.indexOf(A)<_.indexOf(m))throw new DOMException$1(uz,"Doctype can only be inserted before an element");if(!m&&A)throw new DOMException$1(uz,"Doctype can not be appended since element is present")}}function assertPreReplacementValidityInDocument(o,s,m){var _=o.childNodes||[],S=s.childNodes||[];if(s.nodeType===Node$1.DOCUMENT_FRAGMENT_NODE){var E=S.filter(isElementNode);if(E.length>1||UK(S,isTextNode$1))throw new DOMException$1(uz,"More than one element or text in fragment");if(1===E.length&&!isElementReplacementPossible(o,m))throw new DOMException$1(uz,"Element in fragment can not be inserted before doctype")}if(isElementNode(s)&&!isElementReplacementPossible(o,m))throw new DOMException$1(uz,"Only one element can be added and only after doctype");if(isDocTypeNode(s)){if(UK(_,(function hasDoctypeChildThatIsNotChild(o){return isDocTypeNode(o)&&o!==m})))throw new DOMException$1(uz,"Only one doctype is allowed");var A=UK(_,isElementNode);if(m&&_.indexOf(A)<_.indexOf(m))throw new DOMException$1(uz,"Doctype can only be inserted before an element")}}function _insertBefore(o,s,m,_){assertPreInsertionValidity1to5(o,s,m),o.nodeType===Node$1.DOCUMENT_NODE&&(_||assertPreInsertionValidityInDocument)(o,s,m);var S=s.parentNode;if(S&&S.removeChild(s),s.nodeType===QK){var E=s.firstChild;if(null==E)return s;var A=s.lastChild}else E=A=s;var O=m?m.previousSibling:o.lastChild;E.previousSibling=O,A.nextSibling=m,O?O.nextSibling=E:o.firstChild=E,null==m?o.lastChild=A:m.previousSibling=A;do{E.parentNode=o}while(E!==A&&(E=E.nextSibling));return _onUpdateChild(o.ownerDocument||o,o),s.nodeType==QK&&(s.firstChild=s.lastChild=null),s}function Element$1(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function nodeSerializeToString(o,s){var m=[],_=9==this.nodeType&&this.documentElement||this,S=_.prefix,E=_.namespaceURI;if(E&&null==S&&null==(S=_.lookupPrefix(E)))var A=[{namespace:E,prefix:null}];return serializeToString(this,m,o,s,A),m.join("")}function needNamespaceDefine(o,s,m){var _=o.prefix||"",S=o.namespaceURI;if(!S)return!1;if("xml"===_&&S===BK.XML||S===BK.XMLNS)return!1;for(var E=m.length;E--;){var A=m[E];if(A.prefix===_)return A.namespace!==S}return!0}function addSerializedAttribute(o,s,m){o.push(" ",s,'="',m.replace(/[<>&"\t\n\r]/g,_xmlEncoder),'"')}function serializeToString(o,s,m,_,S){if(S||(S=[]),_){if(!(o=_(o)))return;if("string"==typeof o)return void s.push(o)}switch(o.nodeType){case $K:var E=o.attributes,A=E.length,O=o.firstChild,H=o.tagName,K=H;if(!(m=BK.isHTML(o.namespaceURI)||m)&&!o.prefix&&o.namespaceURI){for(var z,G=0;G<E.length;G++)if("xmlns"===E.item(G).name){z=E.item(G).value;break}if(!z)for(var q=S.length-1;q>=0;q--){if(""===(X=S[q]).prefix&&X.namespace===o.namespaceURI){z=X.namespace;break}}if(z!==o.namespaceURI)for(q=S.length-1;q>=0;q--){var X;if((X=S[q]).namespace===o.namespaceURI){X.prefix&&(K=X.prefix+":"+H);break}}}s.push("<",K);for(var J=0;J<A;J++){"xmlns"==(ae=E.item(J)).prefix?S.push({prefix:ae.localName,namespace:ae.value}):"xmlns"==ae.nodeName&&S.push({prefix:"",namespace:ae.value})}for(J=0;J<A;J++){var ae,pe,me;if(needNamespaceDefine(ae=E.item(J),0,S))addSerializedAttribute(s,(pe=ae.prefix||"")?"xmlns:"+pe:"xmlns",me=ae.namespaceURI),S.push({prefix:pe,namespace:me});serializeToString(ae,s,m,_,S)}if(H===K&&needNamespaceDefine(o,0,S))addSerializedAttribute(s,(pe=o.prefix||"")?"xmlns:"+pe:"xmlns",me=o.namespaceURI),S.push({prefix:pe,namespace:me});if(O||m&&!/^(?:meta|link|img|br|hr|input)$/i.test(H)){if(s.push(">"),m&&/^script$/i.test(H))for(;O;)O.data?s.push(O.data):serializeToString(O,s,m,_,S.slice()),O=O.nextSibling;else for(;O;)serializeToString(O,s,m,_,S.slice()),O=O.nextSibling;s.push("</",K,">")}else s.push("/>");return;case XK:case QK:for(O=o.firstChild;O;)serializeToString(O,s,m,_,S.slice()),O=O.nextSibling;return;case VK:return addSerializedAttribute(s,o.name,o.value);case HK:return s.push(o.data.replace(/[<&>]/g,_xmlEncoder));case KK:return s.push("<![CDATA[",o.data,"]]>");case qK:return s.push("\x3c!--",o.data,"--\x3e");case YK:var _e=o.publicId,Se=o.systemId;if(s.push("<!DOCTYPE ",o.name),_e)s.push(" PUBLIC ",_e),Se&&"."!=Se&&s.push(" ",Se),s.push(">");else if(Se&&"."!=Se)s.push(" SYSTEM ",Se,">");else{var Ee=o.internalSubset;Ee&&s.push(" [",Ee,"]"),s.push(">")}return;case GK:return s.push("<?",o.target," ",o.data,"?>");case zK:return s.push("&",o.nodeName,";");default:s.push("??",o.nodeName)}}function _importNode(o,s,m){var _;switch(s.nodeType){case $K:(_=s.cloneNode(!1)).ownerDocument=o;case QK:break;case VK:m=!0}if(_||(_=s.cloneNode(!1)),_.ownerDocument=o,_.parentNode=null,m)for(var S=s.firstChild;S;)_.appendChild(_importNode(o,S,m)),S=S.nextSibling;return _}function _cloneNode(o,s,m){var _=new s.constructor;for(var S in s)if(Object.prototype.hasOwnProperty.call(s,S)){var E=s[S];"object"!=typeof E&&E!=_[S]&&(_[S]=E)}switch(s.childNodes&&(_.childNodes=new NodeList),_.ownerDocument=o,_.nodeType){case $K:var A=s.attributes,O=_.attributes=new NamedNodeMap,H=A.length;O._ownerElement=_;for(var K=0;K<H;K++)_.setAttributeNode(_cloneNode(o,A.item(K),!0));break;case VK:m=!0}if(m)for(var z=s.firstChild;z;)_.appendChild(_cloneNode(o,z,m)),z=z.nextSibling;return _}function __set__(o,s,m){o[s]=m}ZK.INVALID_STATE_ERR=(oz[11]="Invalid state",11),ZK.SYNTAX_ERR=(oz[12]="Syntax error",12),ZK.INVALID_MODIFICATION_ERR=(oz[13]="Invalid modification",13),ZK.NAMESPACE_ERR=(oz[14]="Invalid namespace",14),ZK.INVALID_ACCESS_ERR=(oz[15]="Invalid access",15),DOMException$1.prototype=Error.prototype,copy(ZK,DOMException$1),NodeList.prototype={length:0,item:function item(o){return o>=0&&o<this.length?this[o]:null},toString:function toString(o,s){for(var m=[],_=0;_<this.length;_++)serializeToString(this[_],m,o,s);return m.join("")},filter:function filter(o){return Array.prototype.filter.call(this,o)},indexOf:function indexOf(o){return Array.prototype.indexOf.call(this,o)}},LiveNodeList.prototype.item=function(o){return _updateLiveList(this),this[o]||null},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function getNamedItem(o){for(var s=this.length;s--;){var m=this[s];if(m.nodeName==o)return m}},setNamedItem:function setNamedItem(o){var s=o.ownerElement;if(s&&s!=this._ownerElement)throw new DOMException$1(fz);var m=this.getNamedItem(o.nodeName);return _addNamedNode(this._ownerElement,this,o,m),m},setNamedItemNS:function setNamedItemNS(o){var s,m=o.ownerElement;if(m&&m!=this._ownerElement)throw new DOMException$1(fz);return s=this.getNamedItemNS(o.namespaceURI,o.localName),_addNamedNode(this._ownerElement,this,o,s),s},removeNamedItem:function removeNamedItem(o){var s=this.getNamedItem(o);return _removeNamedNode(this._ownerElement,this,s),s},removeNamedItemNS:function removeNamedItemNS(o,s){var m=this.getNamedItemNS(o,s);return _removeNamedNode(this._ownerElement,this,m),m},getNamedItemNS:function getNamedItemNS(o,s){for(var m=this.length;m--;){var _=this[m];if(_.localName==s&&_.namespaceURI==o)return _}return null}},DOMImplementation$1.prototype={hasFeature:function hasFeature(o,s){return!0},createDocument:function createDocument(o,s,m){var _=new Document$1;if(_.implementation=this,_.childNodes=new NodeList,_.doctype=m||null,m&&_.appendChild(m),s){var S=_.createElementNS(o,s);_.appendChild(S)}return _},createDocumentType:function createDocumentType(o,s,m){var _=new DocumentType;return _.name=o,_.nodeName=o,_.publicId=s||"",_.systemId=m||"",_}},Node$1.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function insertBefore(o,s){return _insertBefore(this,o,s)},replaceChild:function replaceChild(o,s){_insertBefore(this,o,s,assertPreReplacementValidityInDocument),s&&this.removeChild(s)},removeChild:function removeChild(o){return _removeChild(this,o)},appendChild:function appendChild(o){return this.insertBefore(o,null)},hasChildNodes:function hasChildNodes(){return null!=this.firstChild},cloneNode:function cloneNode(o){return _cloneNode(this.ownerDocument||this,this,o)},normalize:function normalize(){for(var o=this.firstChild;o;){var s=o.nextSibling;s&&s.nodeType==HK&&o.nodeType==HK?(this.removeChild(s),o.appendData(s.data)):(o.normalize(),o=s)}},isSupported:function isSupported(o,s){return this.ownerDocument.implementation.hasFeature(o,s)},hasAttributes:function hasAttributes(){return this.attributes.length>0},lookupPrefix:function lookupPrefix(o){for(var s=this;s;){var m=s._nsMap;if(m)for(var _ in m)if(Object.prototype.hasOwnProperty.call(m,_)&&m[_]===o)return _;s=s.nodeType==VK?s.ownerDocument:s.parentNode}return null},lookupNamespaceURI:function lookupNamespaceURI(o){for(var s=this;s;){var m=s._nsMap;if(m&&Object.prototype.hasOwnProperty.call(m,o))return m[o];s=s.nodeType==VK?s.ownerDocument:s.parentNode}return null},isDefaultNamespace:function isDefaultNamespace(o){return null==this.lookupPrefix(o)}},copy(jK,Node$1),copy(jK,Node$1.prototype),Document$1.prototype={nodeName:"#document",nodeType:XK,doctype:null,documentElement:null,_inc:1,insertBefore:function insertBefore(o,s){if(o.nodeType==QK){for(var m=o.firstChild;m;){var _=m.nextSibling;this.insertBefore(m,s),m=_}return o}return _insertBefore(this,o,s),o.ownerDocument=this,null===this.documentElement&&o.nodeType===$K&&(this.documentElement=o),o},removeChild:function removeChild(o){return this.documentElement==o&&(this.documentElement=null),_removeChild(this,o)},replaceChild:function replaceChild(o,s){_insertBefore(this,o,s,assertPreReplacementValidityInDocument),o.ownerDocument=this,s&&this.removeChild(s),isElementNode(o)&&(this.documentElement=o)},importNode:function importNode(o,s){return _importNode(this,o,s)},getElementById:function getElementById(o){var s=null;return _visitNode(this.documentElement,(function(m){if(m.nodeType==$K&&m.getAttribute("id")==o)return s=m,!0})),s},getElementsByClassName:function getElementsByClassName(o){var s=toOrderedSet(o);return new LiveNodeList(this,(function(m){var _=[];return s.length>0&&_visitNode(m.documentElement,(function(S){if(S!==m&&S.nodeType===$K){var E=S.getAttribute("class");if(E){var A=o===E;if(!A){var O=toOrderedSet(E);A=s.every(function arrayIncludes(o){return function(s){return o&&-1!==o.indexOf(s)}}(O))}A&&_.push(S)}}})),_}))},createElement:function createElement(o){var s=new Element$1;return s.ownerDocument=this,s.nodeName=o,s.tagName=o,s.localName=o,s.childNodes=new NodeList,(s.attributes=new NamedNodeMap)._ownerElement=s,s},createDocumentFragment:function createDocumentFragment(){var o=new DocumentFragment;return o.ownerDocument=this,o.childNodes=new NodeList,o},createTextNode:function createTextNode(o){var s=new Text;return s.ownerDocument=this,s.appendData(o),s},createComment:function createComment(o){var s=new Comment;return s.ownerDocument=this,s.appendData(o),s},createCDATASection:function createCDATASection(o){var s=new CDATASection;return s.ownerDocument=this,s.appendData(o),s},createProcessingInstruction:function createProcessingInstruction(o,s){var m=new ProcessingInstruction;return m.ownerDocument=this,m.tagName=m.nodeName=m.target=o,m.nodeValue=m.data=s,m},createAttribute:function createAttribute(o){var s=new Attr;return s.ownerDocument=this,s.name=o,s.nodeName=o,s.localName=o,s.specified=!0,s},createEntityReference:function createEntityReference(o){var s=new EntityReference;return s.ownerDocument=this,s.nodeName=o,s},createElementNS:function createElementNS(o,s){var m=new Element$1,_=s.split(":"),S=m.attributes=new NamedNodeMap;return m.childNodes=new NodeList,m.ownerDocument=this,m.nodeName=s,m.tagName=s,m.namespaceURI=o,2==_.length?(m.prefix=_[0],m.localName=_[1]):m.localName=s,S._ownerElement=m,m},createAttributeNS:function createAttributeNS(o,s){var m=new Attr,_=s.split(":");return m.ownerDocument=this,m.nodeName=s,m.name=s,m.namespaceURI=o,m.specified=!0,2==_.length?(m.prefix=_[0],m.localName=_[1]):m.localName=s,m}},_extends(Document$1,Node$1),Element$1.prototype={nodeType:$K,hasAttribute:function hasAttribute(o){return null!=this.getAttributeNode(o)},getAttribute:function getAttribute(o){var s=this.getAttributeNode(o);return s&&s.value||""},getAttributeNode:function getAttributeNode(o){return this.attributes.getNamedItem(o)},setAttribute:function setAttribute(o,s){var m=this.ownerDocument.createAttribute(o);m.value=m.nodeValue=""+s,this.setAttributeNode(m)},removeAttribute:function removeAttribute(o){var s=this.getAttributeNode(o);s&&this.removeAttributeNode(s)},appendChild:function appendChild(o){return o.nodeType===QK?this.insertBefore(o,null):function _appendSingleChild(o,s){return s.parentNode&&s.parentNode.removeChild(s),s.parentNode=o,s.previousSibling=o.lastChild,s.nextSibling=null,s.previousSibling?s.previousSibling.nextSibling=s:o.firstChild=s,o.lastChild=s,_onUpdateChild(o.ownerDocument,o,s),s}(this,o)},setAttributeNode:function setAttributeNode(o){return this.attributes.setNamedItem(o)},setAttributeNodeNS:function setAttributeNodeNS(o){return this.attributes.setNamedItemNS(o)},removeAttributeNode:function removeAttributeNode(o){return this.attributes.removeNamedItem(o.nodeName)},removeAttributeNS:function removeAttributeNS(o,s){var m=this.getAttributeNodeNS(o,s);m&&this.removeAttributeNode(m)},hasAttributeNS:function hasAttributeNS(o,s){return null!=this.getAttributeNodeNS(o,s)},getAttributeNS:function getAttributeNS(o,s){var m=this.getAttributeNodeNS(o,s);return m&&m.value||""},setAttributeNS:function setAttributeNS(o,s,m){var _=this.ownerDocument.createAttributeNS(o,s);_.value=_.nodeValue=""+m,this.setAttributeNode(_)},getAttributeNodeNS:function getAttributeNodeNS(o,s){return this.attributes.getNamedItemNS(o,s)},getElementsByTagName:function getElementsByTagName(o){return new LiveNodeList(this,(function(s){var m=[];return _visitNode(s,(function(_){_===s||_.nodeType!=$K||"*"!==o&&_.tagName!=o||m.push(_)})),m}))},getElementsByTagNameNS:function getElementsByTagNameNS(o,s){return new LiveNodeList(this,(function(m){var _=[];return _visitNode(m,(function(S){S===m||S.nodeType!==$K||"*"!==o&&S.namespaceURI!==o||"*"!==s&&S.localName!=s||_.push(S)})),_}))}},Document$1.prototype.getElementsByTagName=Element$1.prototype.getElementsByTagName,Document$1.prototype.getElementsByTagNameNS=Element$1.prototype.getElementsByTagNameNS,_extends(Element$1,Node$1),Attr.prototype.nodeType=VK,_extends(Attr,Node$1),CharacterData.prototype={data:"",substringData:function substringData(o,s){return this.data.substring(o,o+s)},appendData:function appendData(o){o=this.data+o,this.nodeValue=this.data=o,this.length=o.length},insertData:function insertData(o,s){this.replaceData(o,0,s)},appendChild:function appendChild(o){throw new Error(oz[uz])},deleteData:function deleteData(o,s){this.replaceData(o,s,"")},replaceData:function replaceData(o,s,m){m=this.data.substring(0,o)+m+this.data.substring(o+s),this.nodeValue=this.data=m,this.length=m.length}},_extends(CharacterData,Node$1),Text.prototype={nodeName:"#text",nodeType:HK,splitText:function splitText(o){var s=this.data,m=s.substring(o);s=s.substring(0,o),this.data=this.nodeValue=s,this.length=s.length;var _=this.ownerDocument.createTextNode(m);return this.parentNode&&this.parentNode.insertBefore(_,this.nextSibling),_}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:qK},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:KK},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=YK,_extends(DocumentType,Node$1),Notation.prototype.nodeType=JK,_extends(Notation,Node$1),Entity.prototype.nodeType=WK,_extends(Entity,Node$1),EntityReference.prototype.nodeType=zK,_extends(EntityReference,Node$1),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=QK,_extends(DocumentFragment,Node$1),ProcessingInstruction.prototype.nodeType=GK,_extends(ProcessingInstruction,Node$1),XMLSerializer.prototype.serializeToString=function(o,s,m){return nodeSerializeToString.call(o,s,m)},Node$1.prototype.toString=nodeSerializeToString;try{if(Object.defineProperty){var yz=function getTextContent(o){switch(o.nodeType){case $K:case QK:var s=[];for(o=o.firstChild;o;)7!==o.nodeType&&8!==o.nodeType&&s.push(getTextContent(o)),o=o.nextSibling;return s.join("");default:return o.nodeValue}};Object.defineProperty(LiveNodeList.prototype,"length",{get:function get(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node$1.prototype,"textContent",{get:function get(){return yz(this)},set:function set(o){switch(this.nodeType){case $K:case QK:for(;this.firstChild;)this.removeChild(this.firstChild);(o||String(o))&&this.appendChild(this.ownerDocument.createTextNode(o));break;default:this.data=o,this.value=o,this.nodeValue=o}}}),__set__=function __set__(o,s,m){o["$$"+s]=m}}}catch(LN){}RK.DocumentType=DocumentType,RK.DOMException=DOMException$1,RK.DOMImplementation=DOMImplementation$1,RK.Element=Element$1,RK.Node=Node$1,RK.NodeList=NodeList,RK.XMLSerializer=XMLSerializer;var vz={},_z={};!function(o){var s=OK.freeze;o.XML_ENTITIES=s({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),o.HTML_ENTITIES=s({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),o.entityMap=o.HTML_ENTITIES}(_z);var bz={},Sz=OK.NAMESPACE,Tz=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Cz=new RegExp("[\\-\\.0-9"+Tz.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),wz=new RegExp("^"+Tz.source+Cz.source+"*(?::"+Tz.source+Cz.source+"*)?$"),xz=0,Ez=1,Iz=2,Az=3,Pz=4,Lz=5,Dz=6,Rz=7;function ParseError$1(o,s){this.message=o,this.locator=s,Error.captureStackTrace&&Error.captureStackTrace(this,ParseError$1)}function XMLReader$1(){}function copyLocator(o,s){return s.lineNumber=o.lineNumber,s.columnNumber=o.columnNumber,s}function parseElementStartPart(o,s,m,_,S,E){function addAttribute(o,s,_){m.attributeNames.hasOwnProperty(o)&&E.fatalError("Attribute "+o+" redefined"),m.addValue(o,s.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,S),_)}for(var A,O=++s,H=xz;;){var K=o.charAt(O);switch(K){case"=":if(H===Ez)A=o.slice(s,O),H=Az;else{if(H!==Iz)throw new Error("attribute equal must after attrName");H=Az}break;case"'":case'"':if(H===Az||H===Ez){if(H===Ez&&(E.warning('attribute value must after "="'),A=o.slice(s,O)),s=O+1,!((O=o.indexOf(K,s))>0))throw new Error("attribute value no end '"+K+"' match");addAttribute(A,z=o.slice(s,O),s-1),H=Lz}else{if(H!=Pz)throw new Error('attribute value must after "="');addAttribute(A,z=o.slice(s,O),s),E.warning('attribute "'+A+'" missed start quot('+K+")!!"),s=O+1,H=Lz}break;case"/":switch(H){case xz:m.setTagName(o.slice(s,O));case Lz:case Dz:case Rz:H=Rz,m.closed=!0;case Pz:case Ez:break;case Iz:m.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return E.error("unexpected end of input"),H==xz&&m.setTagName(o.slice(s,O)),O;case">":switch(H){case xz:m.setTagName(o.slice(s,O));case Lz:case Dz:case Rz:break;case Pz:case Ez:"/"===(z=o.slice(s,O)).slice(-1)&&(m.closed=!0,z=z.slice(0,-1));case Iz:H===Iz&&(z=A),H==Pz?(E.warning('attribute "'+z+'" missed quot(")!'),addAttribute(A,z,s)):(Sz.isHTML(_[""])&&z.match(/^(?:disabled|checked|selected)$/i)||E.warning('attribute "'+z+'" missed value!! "'+z+'" instead!!'),addAttribute(z,z,s));break;case Az:throw new Error("attribute value missed!!")}return O;case"":K=" ";default:if(K<=" ")switch(H){case xz:m.setTagName(o.slice(s,O)),H=Dz;break;case Ez:A=o.slice(s,O),H=Iz;break;case Pz:var z=o.slice(s,O);E.warning('attribute "'+z+'" missed quot(")!!'),addAttribute(A,z,s);case Lz:H=Dz}else switch(H){case Iz:m.tagName,Sz.isHTML(_[""])&&A.match(/^(?:disabled|checked|selected)$/i)||E.warning('attribute "'+A+'" missed value!! "'+A+'" instead2!!'),addAttribute(A,A,s),s=O,H=Ez;break;case Lz:E.warning('attribute space is required"'+A+'"!!');case Dz:H=Ez,s=O;break;case Az:H=Pz,s=O;break;case Rz:throw new Error("elements closed character '/' and '>' must be connected to")}}O++}}function appendElement$1(o,s,m){for(var _=o.tagName,S=null,E=o.length;E--;){var A=o[E],O=A.qName,H=A.value;if((q=O.indexOf(":"))>0)var K=A.prefix=O.slice(0,q),z=O.slice(q+1),G="xmlns"===K&&z;else z=O,K=null,G="xmlns"===O&&"";A.localName=z,!1!==G&&(null==S&&(S={},_copy(m,m={})),m[G]=S[G]=H,A.uri=Sz.XMLNS,s.startPrefixMapping(G,H))}for(E=o.length;E--;){(K=(A=o[E]).prefix)&&("xml"===K&&(A.uri=Sz.XML),"xmlns"!==K&&(A.uri=m[K||""]))}var q;(q=_.indexOf(":"))>0?(K=o.prefix=_.slice(0,q),z=o.localName=_.slice(q+1)):(K=null,z=o.localName=_);var X=o.uri=m[K||""];if(s.startElement(X,z,_,o),!o.closed)return o.currentNSMap=m,o.localNSMap=S,!0;if(s.endElement(X,z,_),S)for(K in S)Object.prototype.hasOwnProperty.call(S,K)&&s.endPrefixMapping(K)}function parseHtmlSpecialContent(o,s,m,_,S){if(/^(?:script|textarea)$/i.test(m)){var E=o.indexOf("</"+m+">",s),A=o.substring(s+1,E);if(/[&<]/.test(A))return/^script$/i.test(m)?(S.characters(A,0,A.length),E):(A=A.replace(/&#?\w+;/g,_),S.characters(A,0,A.length),E)}return s+1}function fixSelfClosed(o,s,m,_){var S=_[m];return null==S&&((S=o.lastIndexOf("</"+m+">"))<s&&(S=o.lastIndexOf("</"+m)),_[m]=S),S<s}function _copy(o,s){for(var m in o)Object.prototype.hasOwnProperty.call(o,m)&&(s[m]=o[m])}function parseDCC(o,s,m,_){if("-"===o.charAt(s+2))return"-"===o.charAt(s+3)?(S=o.indexOf("--\x3e",s+4))>s?(m.comment(o,s+4,S-s-4),S+3):(_.error("Unclosed comment"),-1):-1;if("CDATA["==o.substr(s+3,6)){var S=o.indexOf("]]>",s+9);return m.startCDATA(),m.characters(o,s+9,S-s-9),m.endCDATA(),S+3}var E=function split(o,s){var m,_=[],S=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;S.lastIndex=s,S.exec(o);for(;m=S.exec(o);)if(_.push(m),m[1])return _}(o,s),A=E.length;if(A>1&&/!doctype/i.test(E[0][0])){var O=E[1][0],H=!1,K=!1;A>3&&(/^public$/i.test(E[2][0])?(H=E[3][0],K=A>4&&E[4][0]):/^system$/i.test(E[2][0])&&(K=E[3][0]));var z=E[A-1];return m.startDTD(O,H,K),m.endDTD(),z.index+z[0].length}return-1}function parseInstruction(o,s,m){var _=o.indexOf("?>",s);if(_){var S=o.substring(s,_).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return S?(S[0].length,m.processingInstruction(S[1],S[2]),_+2):-1}return-1}function ElementAttributes(){this.attributeNames={}}ParseError$1.prototype=new Error,ParseError$1.prototype.name=ParseError$1.name,XMLReader$1.prototype={parse:function parse(o,s,m){var _=this.domBuilder;_.startDocument(),_copy(s,s={}),function _parse(o,s,m,_,S){function fixedFromCharCode(o){if(o>65535){var s=55296+((o-=65536)>>10),m=56320+(1023&o);return String.fromCharCode(s,m)}return String.fromCharCode(o)}function entityReplacer(o){var s=o.slice(1,-1);return Object.hasOwnProperty.call(m,s)?m[s]:"#"===s.charAt(0)?fixedFromCharCode(parseInt(s.substr(1).replace("x","0x"))):(S.error("entity not found:"+o),o)}function appendText(s){if(s>G){var m=o.substring(G,s).replace(/&#?\w+;/g,entityReplacer);H&&position(G),_.characters(m,0,s-G),G=s}}function position(s,m){for(;s>=A&&(m=O.exec(o));)E=m.index,A=E+m[0].length,H.lineNumber++;H.columnNumber=s-E+1}var E=0,A=0,O=/.*(?:\r\n?|\n)|.*$/g,H=_.locator,K=[{currentNSMap:s}],z={},G=0;for(;;){try{var q=o.indexOf("<",G);if(q<0){if(!o.substr(G).match(/^\s*$/)){var X=_.doc,J=X.createTextNode(o.substr(G));X.appendChild(J),_.currentElement=J}return}switch(q>G&&appendText(q),o.charAt(q+1)){case"/":var ae=o.indexOf(">",q+3),pe=o.substring(q+2,ae).replace(/[ \t\n\r]+$/g,""),me=K.pop();ae<0?(pe=o.substring(q+2).replace(/[\s<].*/,""),S.error("end tag name: "+pe+" is not complete:"+me.tagName),ae=q+1+pe.length):pe.match(/\s</)&&(pe=pe.replace(/[\s<].*/,""),S.error("end tag name: "+pe+" maybe not complete"),ae=q+1+pe.length);var _e=me.localNSMap,Se=me.tagName==pe;if(Se||me.tagName&&me.tagName.toLowerCase()==pe.toLowerCase()){if(_.endElement(me.uri,me.localName,pe),_e)for(var Ee in _e)Object.prototype.hasOwnProperty.call(_e,Ee)&&_.endPrefixMapping(Ee);Se||S.fatalError("end tag name: "+pe+" is not match the current start tagName:"+me.tagName)}else K.push(me);ae++;break;case"?":H&&position(q),ae=parseInstruction(o,q,_);break;case"!":H&&position(q),ae=parseDCC(o,q,_,S);break;default:H&&position(q);var De=new ElementAttributes,$e=K[K.length-1].currentNSMap,He=(ae=parseElementStartPart(o,q,De,$e,entityReplacer,S),De.length);if(!De.closed&&fixSelfClosed(o,ae,De.tagName,z)&&(De.closed=!0,m.nbsp||S.warning("unclosed xml attribute")),H&&He){for(var et=copyLocator(H,{}),rt=0;rt<He;rt++){var it=De[rt];position(it.offset),it.locator=copyLocator(H,{})}_.locator=et,appendElement$1(De,_,$e)&&K.push(De),_.locator=H}else appendElement$1(De,_,$e)&&K.push(De);Sz.isHTML(De.uri)&&!De.closed?ae=parseHtmlSpecialContent(o,ae,De.tagName,entityReplacer,_):ae++}}catch(o){if(o instanceof ParseError$1)throw o;S.error("element parse error: "+o),ae=-1}ae>G?G=ae:appendText(Math.max(q,G)+1)}}(o,s,m,_,this.errorHandler),_.endDocument()}},ElementAttributes.prototype={setTagName:function setTagName(o){if(!wz.test(o))throw new Error("invalid tagName:"+o);this.tagName=o},addValue:function addValue(o,s,m){if(!wz.test(o))throw new Error("invalid attribute:"+o);this.attributeNames[o]=this.length,this[this.length++]={qName:o,value:s,offset:m}},length:0,getLocalName:function getLocalName(o){return this[o].localName},getLocator:function getLocator(o){return this[o].locator},getQName:function getQName(o){return this[o].qName},getURI:function getURI(o){return this[o].uri},getValue:function getValue(o){return this[o].value}},bz.XMLReader=XMLReader$1,bz.ParseError=ParseError$1;var Oz=OK,Mz=_z,Fz=bz,Nz=RK.DOMImplementation,Uz=Oz.NAMESPACE,Bz=Fz.ParseError,$z=Fz.XMLReader;function normalizeLineEndings(o){return o.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function DOMParser$2(o){this.options=o||{locator:{}}}function DOMHandler(){this.cdata=!1}function position(o,s){s.lineNumber=o.lineNumber,s.columnNumber=o.columnNumber}function _locator(o){if(o)return"\n@"+(o.systemId||"")+"#[line:"+o.lineNumber+",col:"+o.columnNumber+"]"}function _toString(o,s,m){return"string"==typeof o?o.substr(s,m):o.length>=s+m||s?new java.lang.String(o,s,m)+"":o}function appendElement(o,s){o.currentElement?o.currentElement.appendChild(s):o.doc.appendChild(s)}DOMParser$2.prototype.parseFromString=function(o,s){var m=this.options,_=new $z,S=m.domBuilder||new DOMHandler,E=m.errorHandler,A=m.locator,O=m.xmlns||{},H=/\/x?html?$/.test(s),K=H?Mz.HTML_ENTITIES:Mz.XML_ENTITIES;A&&S.setDocumentLocator(A),_.errorHandler=function buildErrorHandler(o,s,m){if(!o){if(s instanceof DOMHandler)return s;o=s}var _={},S=o instanceof Function;function build(s){var E=o[s];!E&&S&&(E=2==o.length?function(m){o(s,m)}:o),_[s]=E&&function(o){E("[xmldom "+s+"]\t"+o+_locator(m))}||function(){}}return m=m||{},build("warning"),build("error"),build("fatalError"),_}(E,S,A),_.domBuilder=m.domBuilder||S,H&&(O[""]=Uz.HTML),O.xml=O.xml||Uz.XML;var z=m.normalizeLineEndings||normalizeLineEndings;return o&&"string"==typeof o?_.parse(z(o),O,K):_.errorHandler.error("invalid doc source"),S.doc},DOMHandler.prototype={startDocument:function startDocument(){this.doc=(new Nz).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function startElement(o,s,m,_){var S=this.doc,E=S.createElementNS(o,m||s),A=_.length;appendElement(this,E),this.currentElement=E,this.locator&&position(this.locator,E);for(var O=0;O<A;O++){o=_.getURI(O);var H=_.getValue(O),K=(m=_.getQName(O),S.createAttributeNS(o,m));this.locator&&position(_.getLocator(O),K),K.value=K.nodeValue=H,E.setAttributeNode(K)}},endElement:function endElement(o,s,m){var _=this.currentElement;_.tagName,this.currentElement=_.parentNode},startPrefixMapping:function startPrefixMapping(o,s){},endPrefixMapping:function endPrefixMapping(o){},processingInstruction:function processingInstruction(o,s){var m=this.doc.createProcessingInstruction(o,s);this.locator&&position(this.locator,m),appendElement(this,m)},ignorableWhitespace:function ignorableWhitespace(o,s,m){},characters:function characters(o,s,m){if(o=_toString.apply(this,arguments)){if(this.cdata)var _=this.doc.createCDATASection(o);else _=this.doc.createTextNode(o);this.currentElement?this.currentElement.appendChild(_):/^\s*$/.test(o)&&this.doc.appendChild(_),this.locator&&position(this.locator,_)}},skippedEntity:function skippedEntity(o){},endDocument:function endDocument(){this.doc.normalize()},setDocumentLocator:function setDocumentLocator(o){(this.locator=o)&&(o.lineNumber=0)},comment:function comment(o,s,m){o=_toString.apply(this,arguments);var _=this.doc.createComment(o);this.locator&&position(this.locator,_),appendElement(this,_)},startCDATA:function startCDATA(){this.cdata=!0},endCDATA:function endCDATA(){this.cdata=!1},startDTD:function startDTD(o,s,m){var _=this.doc.implementation;if(_&&_.createDocumentType){var S=_.createDocumentType(o,s,m);this.locator&&position(this.locator,S),appendElement(this,S),this.doc.doctype=S}},warning:function warning(o){console.warn("[xmldom warning]\t"+o,_locator(this.locator))},error:function error(o){console.error("[xmldom error]\t"+o,_locator(this.locator))},fatalError:function fatalError(o){throw new Bz(o,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(o){DOMHandler.prototype[o]=function(){return null}})),vz.__DOMHandler=DOMHandler,vz.normalizeLineEndings=normalizeLineEndings,vz.DOMParser=DOMParser$2;var Vz=vz.DOMParser,Hz=function isObject(o){return!!o&&"object"==typeof o},Kz=function merge(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];return s.reduce((function(o,s){return"object"!=typeof s||Object.keys(s).forEach((function(m){Array.isArray(o[m])&&Array.isArray(s[m])?o[m]=o[m].concat(s[m]):Hz(o[m])&&Hz(s[m])?o[m]=merge(o[m],s[m]):o[m]=s[m]})),o}),{})},zz=function values(o){return Object.keys(o).map((function(s){return o[s]}))},Wz=function flatten(o){return o.reduce((function(o,s){return o.concat(s)}),[])},Gz=function from(o){if(!o.length)return[];for(var s=[],m=0;m<o.length;m++)s.push(o[m]);return s},Xz="INVALID_NUMBER_OF_PERIOD",Yz="DASH_EMPTY_MANIFEST",Qz="DASH_INVALID_XML",Jz="NO_BASE_URL",Zz="SEGMENT_TIME_UNSPECIFIED",eW="UNSUPPORTED_UTC_TIMING_SCHEME",tW=function urlTypeToSegment(o){var s=o.baseUrl,m=void 0===s?"":s,_=o.source,S=void 0===_?"":_,E=o.range,A=void 0===E?"":E,O=o.indexRange,H=void 0===O?"":O,K={uri:S,resolvedUri:QH(m||"",S)};if(A||H){var z,G=(A||H).split("-"),q=$V.BigInt?$V.BigInt(G[0]):parseInt(G[0],10),X=$V.BigInt?$V.BigInt(G[1]):parseInt(G[1],10);q<Number.MAX_SAFE_INTEGER&&"bigint"==typeof q&&(q=Number(q)),X<Number.MAX_SAFE_INTEGER&&"bigint"==typeof X&&(X=Number(X)),"bigint"==typeof(z="bigint"==typeof X||"bigint"==typeof q?$V.BigInt(X)-$V.BigInt(q)+$V.BigInt(1):X-q+1)&&z<Number.MAX_SAFE_INTEGER&&(z=Number(z)),K.byterange={length:z,offset:q}}return K},nW=function parseEndNumber(o){return o&&"number"!=typeof o&&(o=parseInt(o,10)),isNaN(o)?null:o},rW={static:function _static(o){var s=o.duration,m=o.timescale,_=void 0===m?1:m,S=o.sourceDuration,E=o.periodDuration,A=nW(o.endNumber),O=s/_;return"number"==typeof A?{start:0,end:A}:"number"==typeof E?{start:0,end:E/O}:{start:0,end:S/O}},dynamic:function dynamic(o){var s=o.NOW,m=o.clientOffset,_=o.availabilityStartTime,S=o.timescale,E=void 0===S?1:S,A=o.duration,O=o.periodStart,H=void 0===O?0:O,K=o.minimumUpdatePeriod,z=void 0===K?0:K,G=o.timeShiftBufferDepth,q=void 0===G?1/0:G,X=nW(o.endNumber),J=(s+m)/1e3,ae=_+H,pe=J+z-ae,me=Math.ceil(pe*E/A),_e=Math.floor((J-ae-q)*E/A),Se=Math.floor((J-ae)*E/A);return{start:Math.max(0,_e),end:"number"==typeof X?X:Math.min(me,Se)}}},iW=function parseByDuration(o){var s=o.type,m=o.duration,_=o.timescale,S=void 0===_?1:_,E=o.periodDuration,A=o.sourceDuration,O=rW[s](o),H=function range(o,s){for(var m=[],_=o;_<s;_++)m.push(_);return m}(O.start,O.end).map(function toSegments(o){return function(s){var m=o.duration,_=o.timescale,S=void 0===_?1:_,E=o.periodStart,A=o.startNumber;return{number:(void 0===A?1:A)+s,duration:m/S,timeline:E,time:s*m}}}(o));if("static"===s){var K=H.length-1,z="number"==typeof E?E:A;H[K].duration=z-m/S*K}return H},aW=function segmentsFromBase(o){var s=o.baseUrl,m=o.initialization,_=void 0===m?{}:m,S=o.sourceDuration,E=o.indexRange,A=void 0===E?"":E,O=o.periodStart,H=o.presentationTime,K=o.number,z=void 0===K?0:K,G=o.duration;if(!s)throw new Error(Jz);var q=tW({baseUrl:s,source:_.sourceURL,range:_.range}),X=tW({baseUrl:s,source:s,indexRange:A});if(X.map=q,G){var J=iW(o);J.length&&(X.duration=J[0].duration,X.timeline=J[0].timeline)}else S&&(X.duration=S,X.timeline=O);return X.presentationTime=H||O,X.number=z,[X]},oW=function addSidxSegmentsToPlaylist$1(o,s,m){var _,S=o.sidx.map?o.sidx.map:null,E=o.sidx.duration,A=o.timeline||0,O=o.sidx.byterange,H=O.offset+O.length,K=s.timescale,z=s.references.filter((function(o){return 1!==o.referenceType})),G=[],q=o.endList?"static":"dynamic",X=o.sidx.timeline,J=X,ae=o.mediaSequence||0;_="bigint"==typeof s.firstOffset?$V.BigInt(H)+s.firstOffset:H+s.firstOffset;for(var pe=0;pe<z.length;pe++){var me=s.references[pe],_e=me.referencedSize,Se=me.subsegmentDuration,Ee=void 0;Ee="bigint"==typeof _?_+$V.BigInt(_e)-$V.BigInt(1):_+_e-1;var De="".concat(_,"-").concat(Ee),$e=aW({baseUrl:m,timescale:K,timeline:A,periodStart:X,presentationTime:J,number:ae,duration:Se,sourceDuration:E,indexRange:De,type:q})[0];S&&($e.map=S),G.push($e),_+="bigint"==typeof _?$V.BigInt(_e):_e,J+=Se/K,ae++}return o.segments=G,o},sW=["AUDIO","SUBTITLES"],uW=function getUniqueTimelineStarts(o){return function union(o,s){return zz(o.reduce((function(o,m){return m.forEach((function(m){o[s(m)]=m})),o}),{}))}(o,(function(o){return o.timeline})).sort((function(o,s){return o.timeline>s.timeline?1:-1}))},lW=function getMediaGroupPlaylists(o){var s=[];return function forEachMediaGroup(o,s,m){s.forEach((function(s){for(var _ in o.mediaGroups[s])for(var S in o.mediaGroups[s][_]){var E=o.mediaGroups[s][_][S];m(E,s,_,S)}}))}(o,sW,(function(o,m,_,S){s=s.concat(o.playlists||[])})),s},cW=function updateMediaSequenceForPlaylist(o){var s=o.playlist,m=o.mediaSequence;s.mediaSequence=m,s.segments.forEach((function(o,m){o.number=s.mediaSequence+m}))},dW=function positionManifestOnTimeline(o){var s=o.oldManifest,m=o.newManifest,_=s.playlists.concat(lW(s)),S=m.playlists.concat(lW(m));return m.timelineStarts=uW([s.timelineStarts,m.timelineStarts]),function updateSequenceNumbers(o){var s=o.oldPlaylists,m=o.newPlaylists,_=o.timelineStarts;m.forEach((function(o){o.discontinuitySequence=_.findIndex((function(s){return s.timeline===o.timeline}));var m=function findPlaylistWithName(o,s){for(var m=0;m<o.length;m++)if(o[m].attributes.NAME===s)return o[m];return null}(s,o.attributes.NAME);if(m&&!o.sidx){var S=o.segments[0],E=m.segments.findIndex((function(o){return Math.abs(o.presentationTime-S.presentationTime)<.016666666666666666}));if(-1===E)return cW({playlist:o,mediaSequence:m.mediaSequence+m.segments.length}),o.segments[0].discontinuity=!0,o.discontinuityStarts.unshift(0),void((!m.segments.length&&o.timeline>m.timeline||m.segments.length&&o.timeline>m.segments[m.segments.length-1].timeline)&&o.discontinuitySequence--);m.segments[E].discontinuity&&!S.discontinuity&&(S.discontinuity=!0,o.discontinuityStarts.unshift(0),o.discontinuitySequence--),cW({playlist:o,mediaSequence:m.segments[E].number})}}))}({oldPlaylists:_,newPlaylists:S,timelineStarts:m.timelineStarts}),m},hW=function generateSidxKey(o){return o&&o.uri+"-"+function byteRangeToString(o){var s;return s="bigint"==typeof o.offset||"bigint"==typeof o.length?$V.BigInt(o.offset)+$V.BigInt(o.length)-$V.BigInt(1):o.offset+o.length-1,"".concat(o.offset,"-").concat(s)}(o.byterange)},pW=function mergeDiscontiguousPlaylists(o){var s=o.reduce((function(o,s){return o[s.attributes.baseUrl]||(o[s.attributes.baseUrl]=[]),o[s.attributes.baseUrl].push(s),o}),{}),m=[];return Object.values(s).forEach((function(o){var s=zz(o.reduce((function(o,s){var m=s.attributes.id+(s.attributes.lang||"");if(o[m]){var _;if(s.segments)s.segments[0]&&(s.segments[0].discontinuity=!0),(_=o[m].segments).push.apply(_,_toConsumableArray$1(s.segments));s.attributes.contentProtection&&(o[m].attributes.contentProtection=s.attributes.contentProtection)}else o[m]=s,o[m].attributes.timelineStarts=[];return o[m].attributes.timelineStarts.push({start:s.attributes.periodStart,timeline:s.attributes.periodStart}),o}),{}));m=m.concat(s)})),m.map((function(o){return o.discontinuityStarts=function findIndexes(o,s){return o.reduce((function(o,m,_){return m[s]&&o.push(_),o}),[])}(o.segments||[],"discontinuity"),o}))},fW=function addSidxSegmentsToPlaylist(o,s){var m=hW(o.sidx),_=m&&s[m]&&s[m].sidx;return _&&oW(o,_,o.sidx.resolvedUri),o},gW=function addSidxSegmentsToPlaylists(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Object.keys(s).length)return o;for(var m in o)o[m]=fW(o[m],s);return o},mW=function organizeAudioPlaylists(o){var s,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_=arguments.length>2&&void 0!==arguments[2]&&arguments[2],S=o.reduce((function(o,S){var E=S.attributes.role&&S.attributes.role.value||"",A=S.attributes.lang||"",O=S.attributes.label||"main";if(A&&!S.attributes.label){var H=E?" (".concat(E,")"):"";O="".concat(S.attributes.lang).concat(H)}o[O]||(o[O]={language:A,autoselect:!0,default:"main"===E,playlists:[],uri:""});var K=fW(function formatAudioPlaylist(o,s){var m=o.attributes,_=o.segments,S=o.sidx,E=o.mediaSequence,A=o.discontinuitySequence,O=o.discontinuityStarts,H={attributes:_defineProperty$2({NAME:m.id,BANDWIDTH:m.bandwidth,CODECS:m.codecs},"PROGRAM-ID",1),uri:"",endList:"static"===m.type,timeline:m.periodStart,resolvedUri:m.baseUrl||"",targetDuration:m.duration,discontinuitySequence:A,discontinuityStarts:O,timelineStarts:m.timelineStarts,mediaSequence:E,segments:_};return m.contentProtection&&(H.contentProtection=m.contentProtection),m.serviceLocation&&(H.attributes.serviceLocation=m.serviceLocation),S&&(H.sidx=S),s&&(H.attributes.AUDIO="audio",H.attributes.SUBTITLES="subs"),H}(S,_),m);return o[O].playlists.push(K),void 0===s&&"main"===E&&((s=S).default=!0),o}),{});s||(S[Object.keys(S)[0]].default=!0);return S},yW=function organizeVttPlaylists(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o.reduce((function(o,m){var _=m.attributes.label||m.attributes.lang||"text";return o[_]||(o[_]={language:_,default:!1,autoselect:!1,playlists:[],uri:""}),o[_].playlists.push(fW(function formatVttPlaylist(o){var s=o.attributes,m=o.segments,_=o.mediaSequence,S=o.discontinuityStarts,E=o.discontinuitySequence;void 0===m&&(m=[{uri:s.baseUrl,timeline:s.periodStart,resolvedUri:s.baseUrl||"",duration:s.sourceDuration,number:0}],s.duration=s.sourceDuration);var A=_defineProperty$2({NAME:s.id,BANDWIDTH:s.bandwidth},"PROGRAM-ID",1);s.codecs&&(A.CODECS=s.codecs);var O={attributes:A,uri:"",endList:"static"===s.type,timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,timelineStarts:s.timelineStarts,discontinuityStarts:S,discontinuitySequence:E,mediaSequence:_,segments:m};return s.serviceLocation&&(O.attributes.serviceLocation=s.serviceLocation),O}(m),s)),o}),{})},vW=function formatVideoPlaylist(o){var s=o.attributes,m=o.segments,_=o.sidx,S=o.discontinuityStarts,E={attributes:_defineProperty$2({NAME:s.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:s.width,height:s.height},CODECS:s.codecs,BANDWIDTH:s.bandwidth},"PROGRAM-ID",1),uri:"",endList:"static"===s.type,timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuityStarts:S,timelineStarts:s.timelineStarts,segments:m};return s.frameRate&&(E.attributes["FRAME-RATE"]=s.frameRate),s.contentProtection&&(E.contentProtection=s.contentProtection),s.serviceLocation&&(E.attributes.serviceLocation=s.serviceLocation),_&&(E.sidx=_),E},_W=function videoOnly(o){var s=o.attributes;return"video/mp4"===s.mimeType||"video/webm"===s.mimeType||"video"===s.contentType},bW=function audioOnly(o){var s=o.attributes;return"audio/mp4"===s.mimeType||"audio/webm"===s.mimeType||"audio"===s.contentType},SW=function vttOnly(o){var s=o.attributes;return"text/vtt"===s.mimeType||"text"===s.contentType},TW=function flattenMediaGroupPlaylists(o){return o?Object.keys(o).reduce((function(s,m){var _=o[m];return s.concat(_.playlists)}),[]):[]},kW=function getLiveRValue(o,s,m){var _=o.NOW,S=o.clientOffset,E=o.availabilityStartTime,A=o.timescale,O=void 0===A?1:A,H=o.periodStart,K=void 0===H?0:H,z=o.minimumUpdatePeriod,G=(_+S)/1e3+(void 0===z?0:z)-(E+K);return Math.ceil((G*O-s)/m)},CW=function parseByTimeline(o,s){for(var m=o.type,_=o.minimumUpdatePeriod,S=void 0===_?0:_,E=o.media,A=void 0===E?"":E,O=o.sourceDuration,H=o.timescale,K=void 0===H?1:H,z=o.startNumber,G=void 0===z?1:z,q=o.periodStart,X=[],J=-1,ae=0;ae<s.length;ae++){var pe=s[ae],me=pe.d,_e=pe.r||0,Se=pe.t||0;J<0&&(J=Se),Se&&Se>J&&(J=Se);var Ee=void 0;if(_e<0){var De=ae+1;Ee=De===s.length?"dynamic"===m&&S>0&&A.indexOf("$Number$")>0?kW(o,J,me):(O*K-J)/me:(s[De].t-J)/me}else Ee=_e+1;for(var $e=G+X.length+Ee,He=G+X.length;He<$e;)X.push({number:He,duration:me/K,time:J,timeline:q}),J+=me,He++}return X},wW=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,xW=function constructTemplateUrl(o,s){return o.replace(wW,function identifierReplacement(o){return function(s,m,_,S){if("$$"===s)return"$";if(void 0===o[m])return s;var E=""+o[m];return"RepresentationID"===m?E:(S=_?parseInt(S,10):1,E.length>=S?E:"".concat(new Array(S-E.length+1).join("0")).concat(E))}}(s))},EW=function segmentsFromTemplate(o,s){var m={RepresentationID:o.id,Bandwidth:o.bandwidth||0},_=o.initialization,S=void 0===_?{sourceURL:"",range:""}:_,E=tW({baseUrl:o.baseUrl,source:xW(S.sourceURL,m),range:S.range}),A=function parseTemplateInfo(o,s){return o.duration||s?o.duration?iW(o):CW(o,s):[{number:o.startNumber||1,duration:o.sourceDuration,time:0,timeline:o.periodStart}]}(o,s);return A.map((function(s){m.Number=s.number,m.Time=s.time;var _=xW(o.media||"",m),S=o.timescale||1,A=o.presentationTimeOffset||0,O=o.periodStart+(s.time-A)/S;return{uri:_,timeline:s.timeline,duration:s.duration,resolvedUri:QH(o.baseUrl||"",_),map:E,number:s.number,presentationTime:O}}))},IW=function segmentsFromList(o,s){var m=o.duration,_=o.segmentUrls,S=void 0===_?[]:_,E=o.periodStart;if(!m&&!s||m&&s)throw new Error(Zz);var A,O=S.map((function(s){return function SegmentURLToSegmentObject(o,s){var m=o.baseUrl,_=o.initialization,S=void 0===_?{}:_,E=tW({baseUrl:m,source:S.sourceURL,range:S.range}),A=tW({baseUrl:m,source:s.media,range:s.mediaRange});return A.map=E,A}(o,s)}));m&&(A=iW(o)),s&&(A=CW(o,s));var H=A.map((function(s,m){if(O[m]){var _=O[m],S=o.timescale||1,A=o.presentationTimeOffset||0;return _.timeline=s.timeline,_.duration=s.duration,_.number=s.number,_.presentationTime=E+(s.time-A)/S,_}})).filter((function(o){return o}));return H},AW=function generateSegments(o){var s,m,_=o.attributes,S=o.segmentInfo;S.template?(m=EW,s=Kz(_,S.template)):S.base?(m=aW,s=Kz(_,S.base)):S.list&&(m=IW,s=Kz(_,S.list));var E={attributes:_};if(!m)return E;var A=m(s,S.segmentTimeline);if(s.duration){var O=s,H=O.duration,K=O.timescale,z=void 0===K?1:K;s.duration=H/z}else A.length?s.duration=A.reduce((function(o,s){return Math.max(o,Math.ceil(s.duration))}),0):s.duration=0;return E.attributes=s,E.segments=A,S.base&&s.indexRange&&(E.sidx=A[0],E.segments=[]),E},PW=function findChildren(o,s){return Gz(o.childNodes).filter((function(o){return o.tagName===s}))},LW=function getContent(o){return o.textContent.trim()},DW=function parseDuration(o){var s=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(o);if(!s)return 0;var m=_slicedToArray$1(s.slice(1),6),_=m[0],S=m[1],E=m[2],A=m[3],O=m[4],H=m[5];return 31536e3*parseFloat(_||0)+2592e3*parseFloat(S||0)+86400*parseFloat(E||0)+3600*parseFloat(A||0)+60*parseFloat(O||0)+parseFloat(H||0)},RW={mediaPresentationDuration:function mediaPresentationDuration(o){return DW(o)},availabilityStartTime:function availabilityStartTime(o){return function parseDate(o){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(o)&&(o+="Z"),Date.parse(o)}(o)/1e3},minimumUpdatePeriod:function minimumUpdatePeriod(o){return DW(o)},suggestedPresentationDelay:function suggestedPresentationDelay(o){return DW(o)},type:function type(o){return o},timeShiftBufferDepth:function timeShiftBufferDepth(o){return DW(o)},start:function start(o){return DW(o)},width:function width(o){return parseInt(o,10)},height:function height(o){return parseInt(o,10)},bandwidth:function bandwidth(o){return parseInt(o,10)},frameRate:function frameRate(o){return function parseDivisionValue(o){return parseFloat(o.split("/").reduce((function(o,s){return o/s})))}(o)},startNumber:function startNumber(o){return parseInt(o,10)},timescale:function timescale(o){return parseInt(o,10)},presentationTimeOffset:function presentationTimeOffset(o){return parseInt(o,10)},duration:function duration(o){var s=parseInt(o,10);return isNaN(s)?DW(o):s},d:function d(o){return parseInt(o,10)},t:function t(o){return parseInt(o,10)},r:function r(o){return parseInt(o,10)},presentationTime:function presentationTime(o){return parseInt(o,10)},DEFAULT:function DEFAULT(o){return o}},OW=function parseAttributes(o){return o&&o.attributes?Gz(o.attributes).reduce((function(o,s){var m=RW[s.name]||RW.DEFAULT;return o[s.name]=m(s.value),o}),{}):{}},MW={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},FW=function buildBaseUrls(o,s){return s.length?Wz(o.map((function(o){return s.map((function(s){var m=LW(s),_=QH(o.baseUrl,m),S=Kz(OW(s),{baseUrl:_});return _!==m&&!S.serviceLocation&&o.serviceLocation&&(S.serviceLocation=o.serviceLocation),S}))}))):o},NW=function getSegmentInformation(o){var s=PW(o,"SegmentTemplate")[0],m=PW(o,"SegmentList")[0],_=m&&PW(m,"SegmentURL").map((function(o){return Kz({tag:"SegmentURL"},OW(o))})),S=PW(o,"SegmentBase")[0],E=m||s,A=E&&PW(E,"SegmentTimeline")[0],O=m||S||s,H=O&&PW(O,"Initialization")[0],K=s&&OW(s);K&&H?K.initialization=H&&OW(H):K&&K.initialization&&(K.initialization={sourceURL:K.initialization});var z={template:K,segmentTimeline:A&&PW(A,"S").map((function(o){return OW(o)})),list:m&&Kz(OW(m),{segmentUrls:_,initialization:OW(H)}),base:S&&Kz(OW(S),{initialization:OW(H)})};return Object.keys(z).forEach((function(o){z[o]||delete z[o]})),z},UW=function generateKeySystemInformation(o){return o.reduce((function(o,s){var m=OW(s);m.schemeIdUri&&(m.schemeIdUri=m.schemeIdUri.toLowerCase());var _=MW[m.schemeIdUri];if(_){o[_]={attributes:m};var S=PW(s,"cenc:pssh")[0];if(S){var E=LW(S);o[_].pssh=E&&function decodeB64ToUint8Array(o){for(var s=DK(o),m=new Uint8Array(s.length),_=0;_<s.length;_++)m[_]=s.charCodeAt(_);return m}(E)}}return o}),{})},BW=function toEventStream(o){return Wz(PW(o.node,"EventStream").map((function(s){var m=OW(s),_=m.schemeIdUri;return PW(s,"Event").map((function(s){var S=OW(s),E=S.presentationTime||0,A=m.timescale||1,O=S.duration||0,H=E/A+o.attributes.start;return{schemeIdUri:_,value:m.value,id:S.id,start:H,end:H+O/A,messageData:LW(s)||S.messageData,contentEncoding:m.contentEncoding,presentationTimeOffset:m.presentationTimeOffset||0}}))})))},jW=function toRepresentations(o,s,m){return function(_){var S=OW(_),E=FW(s,PW(_,"BaseURL")),A=PW(_,"Role")[0],O={role:OW(A)},H=Kz(o,S,O),K=PW(_,"Accessibility")[0],z=function parseCaptionServiceMetadata(o){return"urn:scte:dash:cc:cea-608:2015"===o.schemeIdUri?("string"!=typeof o.value?[]:o.value.split(";")).map((function(o){var s,m;if(m=o,/^CC\d=/.test(o)){var _=_slicedToArray$1(o.split("="),2);s=_[0],m=_[1]}else/^CC\d$/.test(o)&&(s=o);return{channel:s,language:m}})):"urn:scte:dash:cc:cea-708:2015"===o.schemeIdUri?("string"!=typeof o.value?[]:o.value.split(";")).map((function(o){var s={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(o)){var m=_slicedToArray$1(o.split("="),2),_=m[0],S=m[1],E=void 0===S?"":S;s.channel=_,s.language=o,E.split(",").forEach((function(o){var m=_slicedToArray$1(o.split(":"),2),_=m[0],S=m[1];"lang"===_?s.language=S:"er"===_?s.easyReader=Number(S):"war"===_?s.aspectRatio=Number(S):"3D"===_&&(s["3D"]=Number(S))}))}else s.language=o;return s.channel&&(s.channel="SERVICE"+s.channel),s})):void 0}(OW(K));z&&(H=Kz(H,{captionServices:z}));var G=PW(_,"Label")[0];if(G&&G.childNodes.length){var q=G.childNodes[0].nodeValue.trim();H=Kz(H,{label:q})}var X=UW(PW(_,"ContentProtection"));Object.keys(X).length&&(H=Kz(H,{contentProtection:X}));var J=NW(_),ae=PW(_,"Representation"),pe=Kz(m,J);return Wz(ae.map(function inheritBaseUrls(o,s,m){return function(_){var S=PW(_,"BaseURL"),E=FW(s,S),A=Kz(o,OW(_)),O=NW(_);return E.map((function(o){return{segmentInfo:Kz(m,O),attributes:Kz(A,o)}}))}}(H,E,pe)))}},$W=function toAdaptationSets(o,s){return function(m,_){var S=FW(s,PW(m.node,"BaseURL")),E=Kz(o,{periodStart:m.attributes.start});"number"==typeof m.attributes.duration&&(E.periodDuration=m.attributes.duration);var A=PW(m.node,"AdaptationSet"),O=NW(m.node);return Wz(A.map(jW(E,S,O)))}},VW=function generateContentSteeringInformation(o,s){if(o.length>1&&s({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!o.length)return null;var m=Kz({serverURL:LW(o[0])},OW(o[0]));return m.queryBeforeStart="true"===m.queryBeforeStart,m},HW=function stringToMpdXml(o){if(""===o)throw new Error(Yz);var s,m,_=new Vz;try{m=(s=_.parseFromString(o,"application/xml"))&&"MPD"===s.documentElement.tagName?s.documentElement:null}catch(o){}if(!m||m&&m.getElementsByTagName("parsererror").length>0)throw new Error(Qz);return m},KW=function parse(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=function inheritAttributes(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=s.manifestUri,_=void 0===m?"":m,S=s.NOW,E=void 0===S?Date.now():S,A=s.clientOffset,O=void 0===A?0:A,H=s.eventHandler,K=void 0===H?function(){}:H,z=PW(o,"Period");if(!z.length)throw new Error(Xz);var G=PW(o,"Location"),q=OW(o),X=FW([{baseUrl:_}],PW(o,"BaseURL")),J=PW(o,"ContentSteering");q.type=q.type||"static",q.sourceDuration=q.mediaPresentationDuration||0,q.NOW=E,q.clientOffset=O,G.length&&(q.locations=G.map(LW));var ae=[];return z.forEach((function(o,s){var m=OW(o),_=ae[s-1];m.start=function getPeriodStart(o){var s=o.attributes,m=o.priorPeriodAttributes,_=o.mpdType;return"number"==typeof s.start?s.start:m&&"number"==typeof m.start&&"number"==typeof m.duration?m.start+m.duration:m||"static"!==_?null:0}({attributes:m,priorPeriodAttributes:_?_.attributes:null,mpdType:q.type}),ae.push({node:o,attributes:m})})),{locations:q.locations,contentSteeringInfo:VW(J,K),representationInfo:Wz(ae.map($W(q,X))),eventStream:Wz(ae.map(BW))}}(HW(o),s);return function toM3u8(o){var s,m=o.dashPlaylists,_=o.locations,S=o.contentSteering,E=o.sidxMapping,A=void 0===E?{}:E,O=o.previousManifest,H=o.eventStream;if(!m.length)return{};var K=m[0].attributes,z=K.sourceDuration,G=K.type,q=K.suggestedPresentationDelay,X=K.minimumUpdatePeriod,J=pW(m.filter(_W)).map(vW),ae=pW(m.filter(bW)),pe=pW(m.filter(SW)),me=m.map((function(o){return o.attributes.captionServices})).filter(Boolean),_e={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(s={AUDIO:{},VIDEO:{}},_defineProperty$2(s,"CLOSED-CAPTIONS",{}),_defineProperty$2(s,"SUBTITLES",{}),s),uri:"",duration:z,playlists:gW(J,A)};X>=0&&(_e.minimumUpdatePeriod=1e3*X),_&&(_e.locations=_),S&&(_e.contentSteering=S),"dynamic"===G&&(_e.suggestedPresentationDelay=q),H&&H.length>0&&(_e.eventStream=H);var Se=0===_e.playlists.length,Ee=ae.length?mW(ae,A,Se):null,De=pe.length?yW(pe,A):null,$e=J.concat(TW(Ee),TW(De)),He=$e.map((function(o){return o.timelineStarts}));return _e.timelineStarts=uW(He),function addMediaSequenceValues(o,s){o.forEach((function(o){o.mediaSequence=0,o.discontinuitySequence=s.findIndex((function(s){return s.timeline===o.timeline})),o.segments&&o.segments.forEach((function(o,s){o.number=s}))}))}($e,_e.timelineStarts),Ee&&(_e.mediaGroups.AUDIO.audio=Ee),De&&(_e.mediaGroups.SUBTITLES.subs=De),me.length&&(_e.mediaGroups["CLOSED-CAPTIONS"].cc=function organizeCaptionServices(o){return o.reduce((function(o,s){return s?(s.forEach((function(s){var m=s.channel,_=s.language;o[_]={autoselect:!1,default:!1,instreamId:m,language:_},s.hasOwnProperty("aspectRatio")&&(o[_].aspectRatio=s.aspectRatio),s.hasOwnProperty("easyReader")&&(o[_].easyReader=s.easyReader),s.hasOwnProperty("3D")&&(o[_]["3D"]=s["3D"])})),o):o}),{})}(me)),O?dW({oldManifest:O,newManifest:_e}):_e}({dashPlaylists:function toPlaylists(o){return o.map(AW)}(m.representationInfo),locations:m.locations,contentSteering:m.contentSteeringInfo,sidxMapping:s.sidxMapping,previousManifest:s.previousManifest,eventStream:m.eventStream})},zW=function parseUTCTiming(o){return function parseUTCTimingScheme(o){var s=PW(o,"UTCTiming")[0];if(!s)return null;var m=OW(s);switch(m.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":m.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":m.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":m.method="DIRECT",m.value=Date.parse(m.value);break;default:throw new Error(eW)}return m}(HW(o))},WW=Math.pow(2,32),GW=function getUint64(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength);return m.getBigUint64?(s=m.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(s):s:m.getUint32(0)*WW+m.getUint32(4)},qW=function parseSidx(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength),m={version:o[0],flags:new Uint8Array(o.subarray(1,4)),references:[],referenceId:s.getUint32(4),timescale:s.getUint32(8)},_=12;0===m.version?(m.earliestPresentationTime=s.getUint32(_),m.firstOffset=s.getUint32(_+4),_+=8):(m.earliestPresentationTime=GW(o.subarray(_)),m.firstOffset=GW(o.subarray(_+8)),_+=16),_+=2;var S=s.getUint16(_);for(_+=2;S>0;_+=12,S--)m.references.push({referenceType:(128&o[_])>>>7,referencedSize:2147483647&s.getUint32(_),subsegmentDuration:s.getUint32(_+4),startsWithSap:!!(128&o[_+8]),sapType:(112&o[_+8])>>>4,sapDeltaTime:268435455&s.getUint32(_+8)});return m},XW=CK([73,68,51]),YW=function getId3Offset(o,s){return void 0===s&&(s=0),(o=CK(o)).length-s<10||!LK(o,XW,{offset:s})?s:(s+=function getId3Size(o,s){void 0===s&&(s=0);var m=(o=CK(o))[s+5],_=o[s+6]<<21|o[s+7]<<14|o[s+8]<<7|o[s+9];return(16&m)>>4?_+20:_+10}(o,s),getId3Offset(o,s))},QW=function normalizePath(o){return"string"==typeof o?AK(o):o},JW=function findBox(o,s,m){void 0===m&&(m=!1),s=function normalizePaths(o){return Array.isArray(o)?o.map((function(o){return QW(o)})):[QW(o)]}(s),o=CK(o);var _=[];if(!s.length)return _;for(var S=0;S<o.length;){var E=(o[S]<<24|o[S+1]<<16|o[S+2]<<8|o[S+3])>>>0,A=o.subarray(S+4,S+8);if(0===E)break;var O=S+E;if(O>o.length){if(m)break;O=o.length}var H=o.subarray(S+8,O);LK(A,s[0])&&(1===s.length?_.push(H):_.push.apply(_,findBox(H,s.slice(1),m))),S=O}return _},ZW={EBML:CK([26,69,223,163]),DocType:CK([66,130]),Segment:CK([24,83,128,103]),SegmentInfo:CK([21,73,169,102]),Tracks:CK([22,84,174,107]),Track:CK([174]),TrackNumber:CK([215]),DefaultDuration:CK([35,227,131]),TrackEntry:CK([174]),TrackType:CK([131]),FlagDefault:CK([136]),CodecID:CK([134]),CodecPrivate:CK([99,162]),VideoTrack:CK([224]),AudioTrack:CK([225]),Cluster:CK([31,67,182,117]),Timestamp:CK([231]),TimestampScale:CK([42,215,177]),BlockGroup:CK([160]),BlockDuration:CK([155]),Block:CK([161]),SimpleBlock:CK([163])},eG=[128,64,32,16,8,4,2,1],tG=function getvint(o,s,m,_){void 0===m&&(m=!0),void 0===_&&(_=!1);var S=function getLength(o){for(var s=1,m=0;m<eG.length&&!(o&eG[m]);m++)s++;return s}(o[s]),E=o.subarray(s,s+S);return m&&((E=Array.prototype.slice.call(o,s,s+S))[0]^=eG[S-1]),{length:S,value:EK(E,{signed:_}),bytes:E}},nG=function normalizePath(o){return"string"==typeof o?o.match(/.{1,2}/g).map((function(o){return normalizePath(o)})):"number"==typeof o?IK(o):o},rG=function getInfinityDataSize(o,s,m){if(m>=s.length)return s.length;var _=tG(s,m,!1);if(LK(o.bytes,_.bytes))return m;var S=tG(s,m+_.length);return getInfinityDataSize(o,s,m+S.length+S.value+_.length)},iG=function findEbml(o,s){s=function normalizePaths(o){return Array.isArray(o)?o.map((function(o){return nG(o)})):[nG(o)]}(s),o=CK(o);var m=[];if(!s.length)return m;for(var _=0;_<o.length;){var S=tG(o,_,!1),E=tG(o,_+S.length),A=_+S.length+E.length;127===E.value&&(E.value=rG(S,o,A),E.value!==o.length&&(E.value-=A));var O=A+E.value>o.length?o.length:A+E.value,H=o.subarray(A,O);LK(s[0],S.bytes)&&(1===s.length?m.push(H):m=m.concat(findEbml(H,s.slice(1)))),_+=S.length+E.length+H.length}return m},aG=CK([0,0,0,1]),oG=CK([0,0,1]),sG=CK([0,0,3]),uG=function discardEmulationPreventionBytes(o){for(var s=[],m=1;m<o.length-2;)LK(o.subarray(m,m+3),sG)&&(s.push(m+2),m++),m++;if(0===s.length)return o;var _=o.length-s.length,S=new Uint8Array(_),E=0;for(m=0;m<_;E++,m++)E===s[0]&&(E++,s.shift()),S[m]=o[E];return S},lG=function findNal(o,s,m,_){void 0===_&&(_=1/0),o=CK(o),m=[].concat(m);for(var S,E=0,A=0;E<o.length&&(A<_||S);){var O=void 0;if(LK(o.subarray(E),aG)?O=4:LK(o.subarray(E),oG)&&(O=3),O){if(A++,S)return uG(o.subarray(S,E));var H=void 0;"h264"===s?H=31&o[E+O]:"h265"===s&&(H=o[E+O]>>1&63),-1!==m.indexOf(H)&&(S=E+O),E+=O+("h264"===s?1:2)}else E++}return o.subarray(0,0)},cG={webm:CK([119,101,98,109]),matroska:CK([109,97,116,114,111,115,107,97]),flac:CK([102,76,97,67]),ogg:CK([79,103,103,83]),ac3:CK([11,119]),riff:CK([82,73,70,70]),avi:CK([65,86,73]),wav:CK([87,65,86,69]),"3gp":CK([102,116,121,112,51,103]),mp4:CK([102,116,121,112]),fmp4:CK([115,116,121,112]),mov:CK([102,116,121,112,113,116]),moov:CK([109,111,111,118]),moof:CK([109,111,111,102])},dG={aac:function aac(o){var s=YW(o);return LK(o,[255,16],{offset:s,mask:[255,22]})},mp3:function mp3(o){var s=YW(o);return LK(o,[255,2],{offset:s,mask:[255,6]})},webm:function webm(o){var s=iG(o,[ZW.EBML,ZW.DocType])[0];return LK(s,cG.webm)},mkv:function mkv(o){var s=iG(o,[ZW.EBML,ZW.DocType])[0];return LK(s,cG.matroska)},mp4:function mp4(o){return!dG["3gp"](o)&&!dG.mov(o)&&(!(!LK(o,cG.mp4,{offset:4})&&!LK(o,cG.fmp4,{offset:4}))||(!(!LK(o,cG.moof,{offset:4})&&!LK(o,cG.moov,{offset:4}))||void 0))},mov:function mov(o){return LK(o,cG.mov,{offset:4})},"3gp":function gp(o){return LK(o,cG["3gp"],{offset:4})},ac3:function ac3(o){var s=YW(o);return LK(o,cG.ac3,{offset:s})},ts:function ts(o){if(o.length<189&&o.length>=1)return 71===o[0];for(var s=0;s+188<o.length&&s<188;){if(71===o[s]&&71===o[s+188])return!0;s+=1}return!1},flac:function flac(o){var s=YW(o);return LK(o,cG.flac,{offset:s})},ogg:function ogg(o){return LK(o,cG.ogg)},avi:function avi(o){return LK(o,cG.riff)&&LK(o,cG.avi,{offset:8})},wav:function wav(o){return LK(o,cG.riff)&&LK(o,cG.wav,{offset:8})},h264:function h264(o){return function findH264Nal(o,s,m){return lG(o,"h264",s,m)}(o,7,3).length},h265:function h265(o){return function findH265Nal(o,s,m){return lG(o,"h265",s,m)}(o,[32,33],3).length}},hG=Object.keys(dG).filter((function(o){return"ts"!==o&&"h264"!==o&&"h265"!==o})).concat(["ts","h264","h265"]);hG.forEach((function(o){var s=dG[o];dG[o]=function(o){return s(CK(o))}}));var pG,fG,gG,mG,yG=dG,vG=function detectContainerForBytes(o){o=CK(o);for(var s=0;s<hG.length;s++){var m=hG[s];if(yG[m](o))return m}return""},_G=function isLikelyFmp4MediaSegment(o){return JW(o,["moof"]).length>0},bG=9e4;for(var SG,TG=bG,kG=(pG=function secondsToVideoTs(o){return o*bG},fG=function secondsToAudioTs(o,s){return o*s},gG=function videoTsToSeconds(o){return o/bG},mG=function audioTsToSeconds(o,s){return o/s},"8.10.0"),CG={},wG=function hooks(o,s){return CG[o]=CG[o]||[],s&&(CG[o]=CG[o].concat(s)),CG[o]},xG=function removeHook(o,s){var m=wG(o).indexOf(s);return!(m<=-1)&&(CG[o]=CG[o].slice(),CG[o].splice(m,1),!0)},EG={prefixed:!0},IG=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],AG=IG[0],PG=0;PG<IG.length;PG++)if(IG[PG][1]in lH){SG=IG[PG];break}if(SG){for(var LG=0;LG<SG.length;LG++)EG[AG[LG]]=SG[LG];EG.prefixed=SG[0]!==AG[0]}var DG=[],RG=function LogByTypeFactory(o,s,m){return function(_,S,E){var A=s.levels[S],O=new RegExp("^(".concat(A,")$")),H=o;if("log"!==_&&E.unshift(_.toUpperCase()+":"),m&&(H="%c".concat(o),E.unshift(m)),E.unshift(H+":"),DG){DG.push([].concat(E));var K=DG.length-1e3;DG.splice(0,K>0?K:0)}if($V.console){var z=$V.console[_];z||"debug"!==_||(z=$V.console.info||$V.console.log),z&&A&&O.test(_)&&z[Array.isArray(E)?"apply":"call"]($V.console,E)}}};var OG=function createLogger$1(o){var s,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:":",_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",S="info",E=function log(){for(var o=arguments.length,m=new Array(o),_=0;_<o;_++)m[_]=arguments[_];s("log",S,m)};return s=RG(o,E,_),E.createLogger=function(s,S,E){var A=void 0!==S?S:m,O=void 0!==E?E:_;return createLogger$1("".concat(o," ").concat(A," ").concat(s),A,O)},E.createNewLogger=function(o,s,m){return createLogger$1(o,s,m)},E.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:S},E.level=function(o){if("string"==typeof o){if(!E.levels.hasOwnProperty(o))throw new Error('"'.concat(o,'" in not a valid log level'));S=o}return S},(E.history=function(){return DG?[].concat(DG):[]}).filter=function(o){return(DG||[]).filter((function(s){return new RegExp(".*".concat(o,".*")).test(s[0])}))},E.history.clear=function(){DG&&(DG.length=0)},E.history.disable=function(){null!==DG&&(DG.length=0,DG=null)},E.history.enable=function(){null===DG&&(DG=[])},E.error=function(){for(var o=arguments.length,m=new Array(o),_=0;_<o;_++)m[_]=arguments[_];return s("error",S,m)},E.warn=function(){for(var o=arguments.length,m=new Array(o),_=0;_<o;_++)m[_]=arguments[_];return s("warn",S,m)},E.debug=function(){for(var o=arguments.length,m=new Array(o),_=0;_<o;_++)m[_]=arguments[_];return s("debug",S,m)},E}("VIDEOJS"),MG=OG.createLogger,FG=Object.prototype.toString,NG=function keys(o){return isObject(o)?Object.keys(o):[]};function each(o,s){NG(o).forEach((function(m){return s(o[m],m)}))}function reduce(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return NG(o).reduce((function(m,_){return s(m,o[_],_)}),m)}function isObject(o){return!!o&&"object"==typeof o}function isPlain(o){return isObject(o)&&"[object Object]"===FG.call(o)&&o.constructor===Object}function merge$1(){for(var o={},s=arguments.length,m=new Array(s),_=0;_<s;_++)m[_]=arguments[_];return m.forEach((function(s){s&&each(s,(function(s,m){isPlain(s)?(isPlain(o[m])||(o[m]={}),o[m]=merge$1(o[m],s)):o[m]=s}))})),o}function values(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=[];for(var m in o)if(o.hasOwnProperty(m)){var _=o[m];s.push(_)}return s}function defineLazyProperty(o,s,m){var _=function set(m){return Object.defineProperty(o,s,{value:m,enumerable:!0,writable:!0})},S={configurable:!0,enumerable:!0,get:function get(){var o=m();return _(o),o}};return(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])&&(S.set=_),Object.defineProperty(o,s,S)}var UG,BG,jG=Object.freeze({__proto__:null,each:each,reduce:reduce,isObject:isObject,isPlain:isPlain,merge:merge$1,values:values,defineLazyProperty:defineLazyProperty}),$G=!1,VG=null,HG=!1,KG=!1,zG=!1,WG=!1,GG=!1,qG=null,XG=null,YG=null,QG=!1,JG=!1,ZG=!1,_q=!1,Wq=Boolean(isReal()&&("ontouchstart"in $V||$V.navigator.maxTouchPoints||$V.DocumentTouch&&$V.document instanceof $V.DocumentTouch)),Yq=$V.navigator&&$V.navigator.userAgentData;if(Yq&&Yq.platform&&Yq.brands&&(HG="Android"===Yq.platform,zG=Boolean(Yq.brands.find((function(o){return"Microsoft Edge"===o.brand}))),WG=Boolean(Yq.brands.find((function(o){return"Chromium"===o.brand}))),GG=!zG&&WG,qG=XG=(Yq.brands.find((function(o){return"Chromium"===o.brand}))||{}).version||null,JG="Windows"===Yq.platform),!WG){var Zq=$V.navigator&&$V.navigator.userAgent||"";$G=/iPod/i.test(Zq),BG=Zq.match(/OS (\d+)_/i),VG=BG&&BG[1]?BG[1]:null,HG=/Android/i.test(Zq),UG=function(){var o=Zq.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!o)return null;var s=o[1]&&parseFloat(o[1]),m=o[2]&&parseFloat(o[2]);return s&&m?parseFloat(o[1]+"."+o[2]):s||null}(),KG=/Firefox/i.test(Zq),zG=/Edg/i.test(Zq),WG=/Chrome/i.test(Zq)||/CriOS/i.test(Zq),GG=!zG&&WG,qG=XG=function(){var o=Zq.match(/(Chrome|CriOS)\/(\d+)/);return o&&o[2]?parseFloat(o[2]):null}(),YG=function(){var o=/MSIE\s(\d+)\.\d/.exec(Zq),s=o&&parseFloat(o[1]);return!s&&/Trident\/7.0/i.test(Zq)&&/rv:11.0/.test(Zq)&&(s=11),s}(),QG=/Safari/i.test(Zq)&&!GG&&!HG&&!zG,JG=/Windows/i.test(Zq),ZG=/iPad/i.test(Zq)||QG&&Wq&&!/iPhone/i.test(Zq),_q=/iPhone/i.test(Zq)&&!ZG}var eX=_q||ZG||$G,tX=(QG||eX)&&!GG,nX=Object.freeze({__proto__:null,get IS_IPOD(){return $G},get IOS_VERSION(){return VG},get IS_ANDROID(){return HG},get ANDROID_VERSION(){return UG},get IS_FIREFOX(){return KG},get IS_EDGE(){return zG},get IS_CHROMIUM(){return WG},get IS_CHROME(){return GG},get CHROMIUM_VERSION(){return qG},get CHROME_VERSION(){return XG},get IE_VERSION(){return YG},get IS_SAFARI(){return QG},get IS_WINDOWS(){return JG},get IS_IPAD(){return ZG},get IS_IPHONE(){return _q},TOUCH_ENABLED:Wq,IS_IOS:eX,IS_ANY_SAFARI:tX});function isNonBlankString(o){return"string"==typeof o&&Boolean(o.trim())}function isReal(){return lH===$V.document}function isEl(o){return isObject(o)&&1===o.nodeType}function isInFrame(){try{return $V.parent!==$V.self}catch(o){return!0}}function createQuerier(o){return function(s,m){if(!isNonBlankString(s))return lH[o](null);isNonBlankString(m)&&(m=lH.querySelector(m));var _=isEl(m)?m:lH;return _[o]&&_[o](s)}}function _createEl(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_=arguments.length>3?arguments[3]:void 0,S=lH.createElement(o);return Object.getOwnPropertyNames(s).forEach((function(o){var m=s[o];"textContent"===o?textContent(S,m):S[o]===m&&"tabIndex"!==o||(S[o]=m)})),Object.getOwnPropertyNames(m).forEach((function(o){S.setAttribute(o,m[o])})),_&&appendContent(S,_),S}function textContent(o,s){return void 0===o.textContent?o.innerText=s:o.textContent=s,o}function prependTo(o,s){s.firstChild?s.insertBefore(o,s.firstChild):s.appendChild(o)}function _hasClass(o,s){return function throwIfWhitespace(o){if(o.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}(s),o.classList.contains(s)}function _addClass(o){for(var s,m=arguments.length,_=new Array(m>1?m-1:0),S=1;S<m;S++)_[S-1]=arguments[S];return(s=o.classList).add.apply(s,_toConsumableArray$1(_.reduce((function(o,s){return o.concat(s.split(/\s+/))}),[]))),o}function _removeClass(o){var s;if(!o)return OG.warn("removeClass was called with an element that doesn't exist"),null;for(var m=arguments.length,_=new Array(m>1?m-1:0),S=1;S<m;S++)_[S-1]=arguments[S];return(s=o.classList).remove.apply(s,_toConsumableArray$1(_.reduce((function(o,s){return o.concat(s.split(/\s+/))}),[]))),o}function _toggleClass(o,s,m){return"function"==typeof m&&(m=m(o,s)),"boolean"!=typeof m&&(m=void 0),s.split(/\s+/).forEach((function(s){return o.classList.toggle(s,m)})),o}function setAttributes(o,s){Object.getOwnPropertyNames(s).forEach((function(m){var _=s[m];null==_||!1===_?o.removeAttribute(m):o.setAttribute(m,!0===_?"":_)}))}function getAttributes(o){var s={},m=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(o&&o.attributes&&o.attributes.length>0)for(var _=o.attributes,S=_.length-1;S>=0;S--){var E=_[S].name,A=_[S].value;m.includes(E)&&(A=null!==A),s[E]=A}return s}function _getAttribute(o,s){return o.getAttribute(s)}function _setAttribute(o,s,m){o.setAttribute(s,m)}function _removeAttribute(o,s){o.removeAttribute(s)}function blockTextSelection(){lH.body.focus(),lH.onselectstart=function(){return!1}}function unblockTextSelection(){lH.onselectstart=function(){return!0}}function getBoundingClientRect(o){if(o&&o.getBoundingClientRect&&o.parentNode){var s=o.getBoundingClientRect(),m={};return["bottom","height","left","right","top","width"].forEach((function(o){void 0!==s[o]&&(m[o]=s[o])})),m.height||(m.height=parseFloat(computedStyle(o,"height"))),m.width||(m.width=parseFloat(computedStyle(o,"width"))),m}}function findPosition(o){if(!o||o&&!o.offsetParent)return{left:0,top:0,width:0,height:0};for(var s=o.offsetWidth,m=o.offsetHeight,_=0,S=0;o.offsetParent&&o!==lH[EG.fullscreenElement];)_+=o.offsetLeft,S+=o.offsetTop,o=o.offsetParent;return{left:_,top:S,width:s,height:m}}function getPointerPosition(o,s){var m={x:0,y:0};if(eX)for(var _=o;_&&"html"!==_.nodeName.toLowerCase();){var S=computedStyle(_,"transform");if(/^matrix/.test(S)){var E=S.slice(7,-1).split(/,\s/).map(Number);m.x+=E[4],m.y+=E[5]}else if(/^matrix3d/.test(S)){var A=S.slice(9,-1).split(/,\s/).map(Number);m.x+=A[12],m.y+=A[13]}_=_.parentNode}var O={},H=findPosition(s.target),K=findPosition(o),z=K.width,G=K.height,q=s.offsetY-(K.top-H.top),X=s.offsetX-(K.left-H.left);return s.changedTouches&&(X=s.changedTouches[0].pageX-K.left,q=s.changedTouches[0].pageY+K.top,eX&&(X-=m.x,q-=m.y)),O.y=1-Math.max(0,Math.min(1,q/G)),O.x=Math.max(0,Math.min(1,X/z)),O}function isTextNode(o){return isObject(o)&&3===o.nodeType}function emptyEl(o){for(;o.firstChild;)o.removeChild(o.firstChild);return o}function normalizeContent(o){return"function"==typeof o&&(o=o()),(Array.isArray(o)?o:[o]).map((function(o){return"function"==typeof o&&(o=o()),isEl(o)||isTextNode(o)?o:"string"==typeof o&&/\S/.test(o)?lH.createTextNode(o):void 0})).filter((function(o){return o}))}function appendContent(o,s){return normalizeContent(s).forEach((function(s){return o.appendChild(s)})),o}function insertContent(o,s){return appendContent(emptyEl(o),s)}function isSingleLeftClick(o){return void 0===o.button&&void 0===o.buttons||(0===o.button&&void 0===o.buttons||("mouseup"===o.type&&0===o.button&&0===o.buttons||0===o.button&&1===o.buttons))}var rX=createQuerier("querySelector"),iX=createQuerier("querySelectorAll");function computedStyle(o,s){if(!o||!s)return"";if("function"==typeof $V.getComputedStyle){var m;try{m=$V.getComputedStyle(o)}catch(o){return""}return m?m.getPropertyValue(s)||m[s]:""}return""}function copyStyleSheetsToWindow(o){_toConsumableArray$1(lH.styleSheets).forEach((function(s){try{var m=_toConsumableArray$1(s.cssRules).map((function(o){return o.cssText})).join(""),_=lH.createElement("style");_.textContent=m,o.document.head.appendChild(_)}catch(m){var S=lH.createElement("link");S.rel="stylesheet",S.type=s.type,S.media=s.media.mediaText,S.href=s.href,o.document.head.appendChild(S)}}))}var aX,oX=Object.freeze({__proto__:null,isReal:isReal,isEl:isEl,isInFrame:isInFrame,createEl:_createEl,textContent:textContent,prependTo:prependTo,hasClass:_hasClass,addClass:_addClass,removeClass:_removeClass,toggleClass:_toggleClass,setAttributes:setAttributes,getAttributes:getAttributes,getAttribute:_getAttribute,setAttribute:_setAttribute,removeAttribute:_removeAttribute,blockTextSelection:blockTextSelection,unblockTextSelection:unblockTextSelection,getBoundingClientRect:getBoundingClientRect,findPosition:findPosition,getPointerPosition:getPointerPosition,isTextNode:isTextNode,emptyEl:emptyEl,normalizeContent:normalizeContent,appendContent:appendContent,insertContent:insertContent,isSingleLeftClick:isSingleLeftClick,$:rX,$$:iX,computedStyle:computedStyle,copyStyleSheetsToWindow:copyStyleSheetsToWindow}),sX=!1,uX=function autoSetup(){if(!1!==aX.options.autoSetup){var o=Array.prototype.slice.call(lH.getElementsByTagName("video")),s=Array.prototype.slice.call(lH.getElementsByTagName("audio")),m=Array.prototype.slice.call(lH.getElementsByTagName("video-js")),_=o.concat(s,m);if(_&&_.length>0)for(var S=0,E=_.length;S<E;S++){var A=_[S];if(!A||!A.getAttribute){autoSetupTimeout(1);break}void 0===A.player&&null!==A.getAttribute("data-setup")&&aX(A)}else sX||autoSetupTimeout(1)}};function autoSetupTimeout(o,s){isReal()&&(s&&(aX=s),$V.setTimeout(uX,o))}function setWindowLoaded(){sX=!0,$V.removeEventListener("load",setWindowLoaded)}isReal()&&("complete"===lH.readyState?setWindowLoaded():$V.addEventListener("load",setWindowLoaded));var lX,cX=function createStyleElement(o){var s=lH.createElement("style");return s.className=o,s},dX=function setTextContent(o,s){o.styleSheet?o.styleSheet.cssText=s:o.textContent=s},hX=new WeakMap,pX=3;function newGUID(){return pX++}function _cleanUpEvents(o,s){if(hX.has(o)){var m=hX.get(o);0===m.handlers[s].length&&(delete m.handlers[s],o.removeEventListener?o.removeEventListener(s,m.dispatcher,!1):o.detachEvent&&o.detachEvent("on"+s,m.dispatcher)),Object.getOwnPropertyNames(m.handlers).length<=0&&(delete m.handlers,delete m.dispatcher,delete m.disabled),0===Object.getOwnPropertyNames(m).length&&hX.delete(o)}}function _handleMultipleEvents(o,s,m,_){m.forEach((function(m){o(s,m,_)}))}function fixEvent(o){if(o.fixed_)return o;function returnTrue(){return!0}function returnFalse(){return!1}if(!o||!o.isPropagationStopped||!o.isImmediatePropagationStopped){var s=o||$V.event;for(var m in o={},s)"layerX"!==m&&"layerY"!==m&&"keyLocation"!==m&&"webkitMovementX"!==m&&"webkitMovementY"!==m&&"path"!==m&&("returnValue"===m&&s.preventDefault||(o[m]=s[m]));if(o.target||(o.target=o.srcElement||lH),o.relatedTarget||(o.relatedTarget=o.fromElement===o.target?o.toElement:o.fromElement),o.preventDefault=function(){s.preventDefault&&s.preventDefault(),o.returnValue=!1,s.returnValue=!1,o.defaultPrevented=!0},o.defaultPrevented=!1,o.stopPropagation=function(){s.stopPropagation&&s.stopPropagation(),o.cancelBubble=!0,s.cancelBubble=!0,o.isPropagationStopped=returnTrue},o.isPropagationStopped=returnFalse,o.stopImmediatePropagation=function(){s.stopImmediatePropagation&&s.stopImmediatePropagation(),o.isImmediatePropagationStopped=returnTrue,o.stopPropagation()},o.isImmediatePropagationStopped=returnFalse,null!==o.clientX&&void 0!==o.clientX){var _=lH.documentElement,S=lH.body;o.pageX=o.clientX+(_&&_.scrollLeft||S&&S.scrollLeft||0)-(_&&_.clientLeft||S&&S.clientLeft||0),o.pageY=o.clientY+(_&&_.scrollTop||S&&S.scrollTop||0)-(_&&_.clientTop||S&&S.clientTop||0)}o.which=o.charCode||o.keyCode,null!==o.button&&void 0!==o.button&&(o.button=1&o.button?0:4&o.button?1:2&o.button?2:0)}return o.fixed_=!0,o}var fX=function supportsPassive(){if("boolean"!=typeof lX){lX=!1;try{var o=Object.defineProperty({},"passive",{get:function get(){lX=!0}});$V.addEventListener("test",null,o),$V.removeEventListener("test",null,o)}catch(o){}}return lX},gX=["touchstart","touchmove"];function _on(o,s,m){if(Array.isArray(s))return _handleMultipleEvents(_on,o,s,m);hX.has(o)||hX.set(o,{});var _=hX.get(o);if(_.handlers||(_.handlers={}),_.handlers[s]||(_.handlers[s]=[]),m.guid||(m.guid=newGUID()),_.handlers[s].push(m),_.dispatcher||(_.disabled=!1,_.dispatcher=function(s,m){if(!_.disabled){s=fixEvent(s);var S=_.handlers[s.type];if(S)for(var E=S.slice(0),A=0,O=E.length;A<O&&!s.isImmediatePropagationStopped();A++)try{E[A].call(o,s,m)}catch(o){OG.error(o)}}}),1===_.handlers[s].length)if(o.addEventListener){var S=!1;fX()&&gX.indexOf(s)>-1&&(S={passive:!0}),o.addEventListener(s,_.dispatcher,S)}else o.attachEvent&&o.attachEvent("on"+s,_.dispatcher)}function _off(o,s,m){if(hX.has(o)){var _=hX.get(o);if(_.handlers){if(Array.isArray(s))return _handleMultipleEvents(_off,o,s,m);var S=function removeType(o,s){_.handlers[s]=[],_cleanUpEvents(o,s)};if(void 0!==s){var E=_.handlers[s];if(E)if(m){if(m.guid)for(var A=0;A<E.length;A++)E[A].guid===m.guid&&E.splice(A--,1);_cleanUpEvents(o,s)}else S(o,s)}else for(var O in _.handlers)Object.prototype.hasOwnProperty.call(_.handlers||{},O)&&S(o,O)}}}function _trigger(o,s,m){var _=hX.has(o)?hX.get(o):{},S=o.parentNode||o.ownerDocument;if("string"==typeof s?s={type:s,target:o}:s.target||(s.target=o),s=fixEvent(s),_.dispatcher&&_.dispatcher.call(o,s,m),S&&!s.isPropagationStopped()&&!0===s.bubbles)_trigger.call(null,S,s,m);else if(!S&&!s.defaultPrevented&&s.target&&s.target[s.type]){hX.has(s.target)||hX.set(s.target,{});var E=hX.get(s.target);s.target[s.type]&&(E.disabled=!0,"function"==typeof s.target[s.type]&&s.target[s.type](),E.disabled=!1)}return!s.defaultPrevented}function _one(o,s,m){if(Array.isArray(s))return _handleMultipleEvents(_one,o,s,m);var _=function func(){_off(o,s,func),m.apply(this,arguments)};_.guid=m.guid=m.guid||newGUID(),_on(o,s,_)}function _any(o,s,m){var _=function func(){_off(o,s,func),m.apply(this,arguments)};_.guid=m.guid=m.guid||newGUID(),_on(o,s,_)}var mX,yX=Object.freeze({__proto__:null,fixEvent:fixEvent,on:_on,off:_off,trigger:_trigger,one:_one,any:_any}),vX=30,_X=function bind_(o,s,m){s.guid||(s.guid=newGUID());var _=s.bind(o);return _.guid=m?m+"_"+s.guid:s.guid,_},bX=function throttle(o,s){var m=$V.performance.now();return function throttled(){var _=$V.performance.now();_-m>=s&&(o.apply(void 0,arguments),m=_)}},SX=function debounce(o,s,m){var _,S=arguments.length>3&&void 0!==arguments[3]?arguments[3]:$V,E=function debounced(){var E=this,A=arguments,O=function later(){_=null,O=null,m||o.apply(E,A)};!_&&m&&o.apply(E,A),S.clearTimeout(_),_=S.setTimeout(O,s)};return E.cancel=function cancel(){S.clearTimeout(_),_=null},E},TX=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:vX,bind_:_X,throttle:bX,debounce:SX}),kX=function(){function EventTarget$2(){_classCallCheck$1(this,EventTarget$2)}return _createClass$1(EventTarget$2,[{key:"on",value:function on(o,s){var m=this.addEventListener;this.addEventListener=function(){},_on(this,o,s),this.addEventListener=m}},{key:"off",value:function off(o,s){_off(this,o,s)}},{key:"one",value:function one(o,s){var m=this.addEventListener;this.addEventListener=function(){},_one(this,o,s),this.addEventListener=m}},{key:"any",value:function any(o,s){var m=this.addEventListener;this.addEventListener=function(){},_any(this,o,s),this.addEventListener=m}},{key:"trigger",value:function trigger(o){var s=o.type||o;"string"==typeof o&&(o={type:s}),o=fixEvent(o),this.allowedEvents_[s]&&this["on"+s]&&this["on"+s](o),_trigger(this,o)}},{key:"queueTrigger",value:function queueTrigger(o){var s=this;mX||(mX=new Map);var m=o.type||o,_=mX.get(this);_||(_=new Map,mX.set(this,_));var S=_.get(m);_.delete(m),$V.clearTimeout(S);var E=$V.setTimeout((function(){_.delete(m),0===_.size&&(_=null,mX.delete(s)),s.trigger(o)}),0);_.set(m,E)}}]),EventTarget$2}();kX.prototype.allowedEvents_={},kX.prototype.addEventListener=kX.prototype.on,kX.prototype.removeEventListener=kX.prototype.off,kX.prototype.dispatchEvent=kX.prototype.trigger;var CX=function objName(o){return"function"==typeof o.name?o.name():"string"==typeof o.name?o.name:o.name_?o.name_:o.constructor&&o.constructor.name?o.constructor.name:typeof o},wX=function isEvented(o){return o instanceof kX||!!o.eventBusEl_&&["on","one","off","trigger"].every((function(s){return"function"==typeof o[s]}))},xX=function isValidEventType(o){return"string"==typeof o&&/\S/.test(o)||Array.isArray(o)&&!!o.length},EX=function validateTarget(o,s,m){if(!o||!o.nodeName&&!wX(o))throw new Error("Invalid target for ".concat(CX(s),"#").concat(m,"; must be a DOM node or evented object."))},IX=function validateEventType(o,s,m){if(!xX(o))throw new Error("Invalid event type for ".concat(CX(s),"#").concat(m,"; must be a non-empty string or array."))},AX=function validateListener(o,s,m){if("function"!=typeof o)throw new Error("Invalid listener for ".concat(CX(s),"#").concat(m,"; must be a function."))},PX=function normalizeListenArgs(o,s,m){var _,S,E,A=s.length<3||s[0]===o||s[0]===o.eventBusEl_;if(A){_=o.eventBusEl_,s.length>=3&&s.shift();var O=_slicedToArray$1(s,2);S=O[0],E=O[1]}else{var H=_slicedToArray$1(s,3);_=H[0],S=H[1],E=H[2]}return EX(_,o,m),IX(S,o,m),AX(E,o,m),{isTargetingSelf:A,target:_,type:S,listener:E=_X(o,E)}},LX=function listen(o,s,m,_){EX(o,o,s),o.nodeName?yX[s](o,m,_):o[s](m,_)},DX={on:function on(){for(var o=this,s=arguments.length,m=new Array(s),_=0;_<s;_++)m[_]=arguments[_];var S=PX(this,m,"on"),E=S.isTargetingSelf,A=S.target,O=S.type,H=S.listener;if(LX(A,"on",O,H),!E){var K=function removeListenerOnDispose(){return o.off(A,O,H)};K.guid=H.guid;var z=function removeRemoverOnTargetDispose(){return o.off("dispose",K)};z.guid=H.guid,LX(this,"on","dispose",K),LX(A,"on","dispose",z)}},one:function one(){for(var o=this,s=arguments.length,m=new Array(s),_=0;_<s;_++)m[_]=arguments[_];var S=PX(this,m,"one"),E=S.isTargetingSelf,A=S.target,O=S.type,H=S.listener;if(E)LX(A,"one",O,H);else{var K=function wrapper(){o.off(A,O,wrapper);for(var s=arguments.length,m=new Array(s),_=0;_<s;_++)m[_]=arguments[_];H.apply(null,m)};K.guid=H.guid,LX(A,"one",O,K)}},any:function any(){for(var o=this,s=arguments.length,m=new Array(s),_=0;_<s;_++)m[_]=arguments[_];var S=PX(this,m,"any"),E=S.isTargetingSelf,A=S.target,O=S.type,H=S.listener;if(E)LX(A,"any",O,H);else{var K=function wrapper(){o.off(A,O,wrapper);for(var s=arguments.length,m=new Array(s),_=0;_<s;_++)m[_]=arguments[_];H.apply(null,m)};K.guid=H.guid,LX(A,"any",O,K)}},off:function off(o,s,m){if(!o||xX(o))_off(this.eventBusEl_,o,s);else{var _=o,S=s;EX(_,this,"off"),IX(S,this,"off"),AX(m,this,"off"),m=_X(this,m),this.off("dispose",m),_.nodeName?(_off(_,S,m),_off(_,"dispose",m)):wX(_)&&(_.off(S,m),_.off("dispose",m))}},trigger:function trigger(o,s){EX(this.eventBusEl_,this,"trigger");var m=o&&"string"!=typeof o?o.type:o;if(!xX(m))throw new Error("Invalid event type for ".concat(CX(this),"#trigger; ")+"must be a non-empty string or object with a type key that has a non-empty value.");return _trigger(this.eventBusEl_,o,s)}};function evented(o){var s=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).eventBusKey;if(s){if(!o[s].nodeName)throw new Error('The eventBusKey "'.concat(s,'" does not refer to an element.'));o.eventBusEl_=o[s]}else o.eventBusEl_=_createEl("span",{className:"vjs-event-bus"});return Object.assign(o,DX),o.eventedCallbacks&&o.eventedCallbacks.forEach((function(o){o()})),o.on("dispose",(function(){o.off(),[o,o.el_,o.eventBusEl_].forEach((function(o){o&&hX.has(o)&&hX.delete(o)})),$V.setTimeout((function(){o.eventBusEl_=null}),0)})),o}var RX={state:{},setState:function setState(o){var s,m=this;return"function"==typeof o&&(o=o()),each(o,(function(o,_){m.state[_]!==o&&((s=s||{})[_]={from:m.state[_],to:o}),m.state[_]=o})),s&&wX(this)&&this.trigger({changes:s,type:"statechanged"}),s}};function stateful(o,s){return Object.assign(o,RX),o.state=Object.assign({},o.state,s),"function"==typeof o.handleStateChanged&&wX(o)&&o.on("statechanged",o.handleStateChanged),o}var OX=function toLowerCase(o){return"string"!=typeof o?o:o.replace(/./,(function(o){return o.toLowerCase()}))},MX=function toTitleCase$1(o){return"string"!=typeof o?o:o.replace(/./,(function(o){return o.toUpperCase()}))},FX=function titleCaseEquals(o,s){return MX(o)===MX(s)},NX=Object.freeze({__proto__:null,toLowerCase:OX,toTitleCase:MX,titleCaseEquals:FX}),UX=function(){function Component$1(o,s,m){var _=this;if(_classCallCheck$1(this,Component$1),!o&&this.play?this.player_=o=this:this.player_=o,this.isDisposed_=!1,this.parentComponent_=null,this.options_=merge$1({},this.options_),s=this.options_=merge$1(this.options_,s),this.id_=s.id||s.el&&s.el.id,!this.id_){var S=o&&o.id&&o.id()||"no_player";this.id_="".concat(S,"_component_").concat(newGUID())}this.name_=s.name||null,s.el?this.el_=s.el:!1!==s.createEl&&(this.el_=this.createEl()),s.className&&this.el_&&s.className.split(" ").forEach((function(o){return _.addClass(o)})),["on","off","one","any","trigger"].forEach((function(o){_[o]=void 0})),!1!==s.evented&&(evented(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),stateful(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,!1!==s.initChildren&&this.initChildren(),this.ready(m),!1!==s.reportTouchActivity&&this.enableTouchActivity()}return _createClass$1(Component$1,[{key:"on",value:function on(o,s){}},{key:"off",value:function off(o,s){}},{key:"one",value:function one(o,s){}},{key:"any",value:function any(o,s){}},{key:"trigger",value:function trigger(o,s){}},{key:"dispose",value:function dispose(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var s=this.children_.length-1;s>=0;s--)this.children_[s].dispose&&this.children_[s].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(o.restoreEl?this.el_.parentNode.replaceChild(o.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}},{key:"isDisposed",value:function isDisposed(){return Boolean(this.isDisposed_)}},{key:"player",value:function player(){return this.player_}},{key:"options",value:function options(o){return o?(this.options_=merge$1(this.options_,o),this.options_):this.options_}},{key:"el",value:function el(){return this.el_}},{key:"createEl",value:function createEl(o,s,m){return _createEl(o,s,m)}},{key:"localize",value:function localize(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,_=this.player_.language&&this.player_.language(),S=this.player_.languages&&this.player_.languages(),E=S&&S[_],A=_&&_.split("-")[0],O=S&&S[A],H=m;return E&&E[o]?H=E[o]:O&&O[o]&&(H=O[o]),s&&(H=H.replace(/\{(\d+)\}/g,(function(o,m){var _=s[m-1],S=_;return void 0===_&&(S=o),S}))),H}},{key:"handleLanguagechange",value:function handleLanguagechange(){}},{key:"contentEl",value:function contentEl(){return this.contentEl_||this.el_}},{key:"id",value:function id(){return this.id_}},{key:"name",value:function name(){return this.name_}},{key:"children",value:function children(){return this.children_}},{key:"getChildById",value:function getChildById(o){return this.childIndex_[o]}},{key:"getChild",value:function getChild(o){if(o)return this.childNameIndex_[o]}},{key:"getDescendant",value:function getDescendant(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];s=s.reduce((function(o,s){return o.concat(s)}),[]);for(var _=this,S=0;S<s.length;S++)if(!(_=_.getChild(s[S]))||!_.getChild)return;return _}},{key:"setIcon",value:function setIcon(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.el();if(this.player_.options_.experimentalSvgIcons){var m="http://www.w3.org/2000/svg",_=_createEl("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),S=lH.createElementNS(m,"svg");S.setAttributeNS(null,"viewBox","0 0 512 512");var E=lH.createElementNS(m,"use");return S.appendChild(E),E.setAttributeNS(null,"href","#vjs-icon-".concat(o)),_.appendChild(S),this.iconIsSet_?s.replaceChild(_,s.querySelector(".vjs-icon-placeholder")):s.appendChild(_),this.iconIsSet_=!0,_}}},{key:"addChild",value:function addChild(o){var s,m,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.children_.length;if("string"==typeof o){m=MX(o);var E=_.componentClass||m;_.name=m;var A=Component$1.getComponent(E);if(!A)throw new Error("Component ".concat(E," does not exist"));if("function"!=typeof A)return null;s=new A(this.player_||this,_)}else s=o;if(s.parentComponent_&&s.parentComponent_.removeChild(s),this.children_.splice(S,0,s),s.parentComponent_=this,"function"==typeof s.id&&(this.childIndex_[s.id()]=s),(m=m||s.name&&MX(s.name()))&&(this.childNameIndex_[m]=s,this.childNameIndex_[OX(m)]=s),"function"==typeof s.el&&s.el()){var O=null;this.children_[S+1]&&(this.children_[S+1].el_?O=this.children_[S+1].el_:isEl(this.children_[S+1])&&(O=this.children_[S+1])),this.contentEl().insertBefore(s.el(),O)}return s}},{key:"removeChild",value:function removeChild(o){if("string"==typeof o&&(o=this.getChild(o)),o&&this.children_){for(var s=!1,m=this.children_.length-1;m>=0;m--)if(this.children_[m]===o){s=!0,this.children_.splice(m,1);break}if(s){o.parentComponent_=null,this.childIndex_[o.id()]=null,this.childNameIndex_[MX(o.name())]=null,this.childNameIndex_[OX(o.name())]=null;var _=o.el();_&&_.parentNode===this.contentEl()&&this.contentEl().removeChild(o.el())}}}},{key:"initChildren",value:function initChildren(){var o=this,s=this.options_.children;if(s){var m,_=this.options_,S=Component$1.getComponent("Tech");(m=Array.isArray(s)?s:Object.keys(s)).concat(Object.keys(this.options_).filter((function(o){return!m.some((function(s){return"string"==typeof s?o===s:o===s.name}))}))).map((function(m){var _,S;return"string"==typeof m?S=s[_=m]||o.options_[_]||{}:(_=m.name,S=m),{name:_,opts:S}})).filter((function(o){var s=Component$1.getComponent(o.opts.componentClass||MX(o.name));return s&&!S.isTech(s)})).forEach((function handleAdd(s){var m=s.name,S=s.opts;if(void 0!==_[m]&&(S=_[m]),!1!==S){!0===S&&(S={}),S.playerOptions=o.options_.playerOptions;var E=o.addChild(m,S);E&&(o[m]=E)}}))}}},{key:"buildCSSClass",value:function buildCSSClass(){return""}},{key:"ready",value:function ready(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(o)return this.isReady_?void(s?o.call(this):this.setTimeout(o,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(o))}},{key:"triggerReady",value:function triggerReady(){this.isReady_=!0,this.setTimeout((function(){var o=this.readyQueue_;this.readyQueue_=[],o&&o.length>0&&o.forEach((function(o){o.call(this)}),this),this.trigger("ready")}),1)}},{key:"$",value:function $(o,s){return rX(o,s||this.contentEl())}},{key:"$$",value:function $$(o,s){return iX(o,s||this.contentEl())}},{key:"hasClass",value:function hasClass(o){return _hasClass(this.el_,o)}},{key:"addClass",value:function addClass(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];_addClass.apply(void 0,[this.el_].concat(s))}},{key:"removeClass",value:function removeClass(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];_removeClass.apply(void 0,[this.el_].concat(s))}},{key:"toggleClass",value:function toggleClass(o,s){_toggleClass(this.el_,o,s)}},{key:"show",value:function show(){this.removeClass("vjs-hidden")}},{key:"hide",value:function hide(){this.addClass("vjs-hidden")}},{key:"lockShowing",value:function lockShowing(){this.addClass("vjs-lock-showing")}},{key:"unlockShowing",value:function unlockShowing(){this.removeClass("vjs-lock-showing")}},{key:"getAttribute",value:function getAttribute(o){return _getAttribute(this.el_,o)}},{key:"setAttribute",value:function setAttribute(o,s){_setAttribute(this.el_,o,s)}},{key:"removeAttribute",value:function removeAttribute(o){_removeAttribute(this.el_,o)}},{key:"width",value:function width(o,s){return this.dimension("width",o,s)}},{key:"height",value:function height(o,s){return this.dimension("height",o,s)}},{key:"dimensions",value:function dimensions(o,s){this.width(o,!0),this.height(s)}},{key:"dimension",value:function dimension(o,s,m){if(void 0!==s)return null!==s&&s==s||(s=0),-1!==(""+s).indexOf("%")||-1!==(""+s).indexOf("px")?this.el_.style[o]=s:this.el_.style[o]="auto"===s?"":s+"px",void(m||this.trigger("componentresize"));if(!this.el_)return 0;var _=this.el_.style[o],S=_.indexOf("px");return-1!==S?parseInt(_.slice(0,S),10):parseInt(this.el_["offset"+MX(o)],10)}},{key:"currentDimension",value:function currentDimension(o){var s=0;if("width"!==o&&"height"!==o)throw new Error("currentDimension only accepts width or height value");if(s=computedStyle(this.el_,o),0===(s=parseFloat(s))||isNaN(s)){var m="offset".concat(MX(o));s=this.el_[m]}return s}},{key:"currentDimensions",value:function currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}},{key:"currentWidth",value:function currentWidth(){return this.currentDimension("width")}},{key:"currentHeight",value:function currentHeight(){return this.currentDimension("height")}},{key:"focus",value:function focus(){this.el_.focus()}},{key:"blur",value:function blur(){this.el_.blur()}},{key:"handleKeyDown",value:function handleKeyDown(o){this.player_&&(dH.isEventKey(o,"Tab")||o.stopPropagation(),this.player_.handleKeyDown(o))}},{key:"handleKeyPress",value:function handleKeyPress(o){this.handleKeyDown(o)}},{key:"emitTapEvents",value:function emitTapEvents(){var o,s=0,m=null;this.on("touchstart",(function(_){1===_.touches.length&&(m={pageX:_.touches[0].pageX,pageY:_.touches[0].pageY},s=$V.performance.now(),o=!0)})),this.on("touchmove",(function(s){if(s.touches.length>1)o=!1;else if(m){var _=s.touches[0].pageX-m.pageX,S=s.touches[0].pageY-m.pageY;Math.sqrt(_*_+S*S)>10&&(o=!1)}}));var _=function noTap(){o=!1};this.on("touchleave",_),this.on("touchcancel",_),this.on("touchend",(function(_){(m=null,!0===o)&&($V.performance.now()-s<200&&(_.preventDefault(),this.trigger("tap")))}))}},{key:"enableTouchActivity",value:function enableTouchActivity(){if(this.player()&&this.player().reportUserActivity){var o,s=_X(this.player(),this.player().reportUserActivity);this.on("touchstart",(function(){s(),this.clearInterval(o),o=this.setInterval(s,250)}));var m=function touchEnd(m){s(),this.clearInterval(o)};this.on("touchmove",s),this.on("touchend",m),this.on("touchcancel",m)}}},{key:"setTimeout",value:function setTimeout(o,s){var m,_=this;return o=_X(this,o),this.clearTimersOnDispose_(),m=$V.setTimeout((function(){_.setTimeoutIds_.has(m)&&_.setTimeoutIds_.delete(m),o()}),s),this.setTimeoutIds_.add(m),m}},{key:"clearTimeout",value:function clearTimeout(o){return this.setTimeoutIds_.has(o)&&(this.setTimeoutIds_.delete(o),$V.clearTimeout(o)),o}},{key:"setInterval",value:function setInterval(o,s){o=_X(this,o),this.clearTimersOnDispose_();var m=$V.setInterval(o,s);return this.setIntervalIds_.add(m),m}},{key:"clearInterval",value:function clearInterval(o){return this.setIntervalIds_.has(o)&&(this.setIntervalIds_.delete(o),$V.clearInterval(o)),o}},{key:"requestAnimationFrame",value:function requestAnimationFrame(o){var s,m=this;return this.clearTimersOnDispose_(),o=_X(this,o),s=$V.requestAnimationFrame((function(){m.rafIds_.has(s)&&m.rafIds_.delete(s),o()})),this.rafIds_.add(s),s}},{key:"requestNamedAnimationFrame",value:function requestNamedAnimationFrame(o,s){var m=this;if(!this.namedRafs_.has(o)){this.clearTimersOnDispose_(),s=_X(this,s);var _=this.requestAnimationFrame((function(){s(),m.namedRafs_.has(o)&&m.namedRafs_.delete(o)}));return this.namedRafs_.set(o,_),o}}},{key:"cancelNamedAnimationFrame",value:function cancelNamedAnimationFrame(o){this.namedRafs_.has(o)&&(this.cancelAnimationFrame(this.namedRafs_.get(o)),this.namedRafs_.delete(o))}},{key:"cancelAnimationFrame",value:function cancelAnimationFrame(o){return this.rafIds_.has(o)&&(this.rafIds_.delete(o),$V.cancelAnimationFrame(o)),o}},{key:"clearTimersOnDispose_",value:function clearTimersOnDispose_(){var o=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",(function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((function(s){var m=_slicedToArray$1(s,2),_=m[0],S=m[1];o[_].forEach((function(s,m){return o[S](m)}))})),o.clearingTimersOnDispose_=!1})))}}],[{key:"registerComponent",value:function registerComponent(o,s){if("string"!=typeof o||!o)throw new Error('Illegal component name, "'.concat(o,'"; must be a non-empty string.'));var m,_=Component$1.getComponent("Tech"),S=_&&_.isTech(s),E=Component$1===s||Component$1.prototype.isPrototypeOf(s.prototype);if(S||!E)throw m=S?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'.concat(o,'"; ').concat(m,"."));o=MX(o),Component$1.components_||(Component$1.components_={});var A=Component$1.getComponent("Player");if("Player"===o&&A&&A.players){var O=A.players,H=Object.keys(O);if(O&&H.length>0&&H.map((function(o){return O[o]})).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return Component$1.components_[o]=s,Component$1.components_[OX(o)]=s,s}},{key:"getComponent",value:function getComponent(o){if(o&&Component$1.components_)return Component$1.components_[o]}}]),Component$1}();function getRange(o,s,m,_){return function rangeCheck(o,s,m){if("number"!=typeof s||s<0||s>m)throw new Error("Failed to execute '".concat(o,"' on 'TimeRanges': The index provided (").concat(s,") is non-numeric or out of bounds (0-").concat(m,")."))}(o,_,m.length-1),m[_][s]}function createTimeRangesObj(o){var s;return s=void 0===o||0===o.length?{length:0,start:function start(){throw new Error("This TimeRanges object is empty")},end:function end(){throw new Error("This TimeRanges object is empty")}}:{length:o.length,start:getRange.bind(null,"start",0,o),end:getRange.bind(null,"end",1,o)},$V.Symbol&&$V.Symbol.iterator&&(s[$V.Symbol.iterator]=function(){return(o||[]).values()}),s}function createTimeRanges$1(o,s){return Array.isArray(o)?createTimeRangesObj(o):void 0===o||void 0===s?createTimeRangesObj():createTimeRangesObj([[o,s]])}UX.registerComponent("Component",UX);var BX=function defaultImplementation(o,s){o=o<0?0:o;var m=Math.floor(o%60),_=Math.floor(o/60%60),S=Math.floor(o/3600),E=Math.floor(s/60%60),A=Math.floor(s/3600);return(isNaN(o)||o===1/0)&&(S=_=m="-"),(S=S>0||A>0?S+":":"")+(_=((S||E>=10)&&_<10?"0"+_:_)+":")+(m=m<10?"0"+m:m)},jX=BX;function setFormatTime(o){jX=o}function resetFormatTime(){jX=BX}function formatTime(o){return jX(o,arguments.length>1&&void 0!==arguments[1]?arguments[1]:o)}var $X=Object.freeze({__proto__:null,createTimeRanges:createTimeRanges$1,createTimeRange:createTimeRanges$1,setFormatTime:setFormatTime,resetFormatTime:resetFormatTime,formatTime:formatTime});function _bufferedPercent(o,s){var m,_,S=0;if(!s)return 0;o&&o.length||(o=createTimeRanges$1(0,0));for(var E=0;E<o.length;E++)m=o.start(E),(_=o.end(E))>s&&(_=s),S+=_-m;return S/s}function MediaError(o){if(o instanceof MediaError)return o;"number"==typeof o?this.code=o:"string"==typeof o?this.message=o:isObject(o)&&("number"==typeof o.code&&(this.code=o.code),Object.assign(this,o)),this.message||(this.message=MediaError.defaultMessages[this.code]||"")}MediaError.prototype.code=0,MediaError.prototype.message="",MediaError.prototype.status=null,MediaError.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],MediaError.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var VX=0;VX<MediaError.errorTypes.length;VX++)MediaError[MediaError.errorTypes[VX]]=VX,MediaError.prototype[MediaError.errorTypes[VX]]=VX;function isPromise(o){return null!=o&&"function"==typeof o.then}function silencePromise(o){isPromise(o)&&o.then(null,(function(o){}))}var HX=function trackToJson_(o){var s=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(s,m,_){return o[m]&&(s[m]=o[m]),s}),{cues:o.cues&&Array.prototype.map.call(o.cues,(function(o){return{startTime:o.startTime,endTime:o.endTime,text:o.text,id:o.id}}))});return s},KX=function textTracksToJson(o){var s=o.$$("track"),m=Array.prototype.map.call(s,(function(o){return o.track}));return Array.prototype.map.call(s,(function(o){var s=HX(o.track);return o.src&&(s.src=o.src),s})).concat(Array.prototype.filter.call(o.textTracks(),(function(o){return-1===m.indexOf(o)})).map(HX))},zX=function jsonToTextTracks(o,s){return o.forEach((function(o){var m=s.addRemoteTextTrack(o).track;!o.src&&o.cues&&o.cues.forEach((function(o){return m.addCue(o)}))})),s.textTracks()},WX="vjs-modal-dialog",GX=function(o){_inherits$1(ModalDialog,o);var s=_createSuper$1(ModalDialog);function ModalDialog(o,m){var _;return _classCallCheck$1(this,ModalDialog),(_=s.call(this,o,m)).handleKeyDown_=function(o){return _.handleKeyDown(o)},_.close_=function(o){return _.close(o)},_.opened_=_.hasBeenOpened_=_.hasBeenFilled_=!1,_.closeable(!_.options_.uncloseable),_.content(_.options_.content),_.contentEl_=_createEl("div",{className:"".concat(WX,"-content")},{role:"document"}),_.descEl_=_createEl("p",{className:"".concat(WX,"-description vjs-control-text"),id:_.el().getAttribute("aria-describedby")}),textContent(_.descEl_,_.description()),_.el_.appendChild(_.descEl_),_.el_.appendChild(_.contentEl_),_}return _createClass$1(ModalDialog,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(ModalDialog.prototype),"createEl",this).call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":"".concat(this.id(),"_description"),"aria-hidden":"true","aria-label":this.label(),role:"dialog"})}},{key:"dispose",value:function dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,_get$1(_getPrototypeOf$1(ModalDialog.prototype),"dispose",this).call(this)}},{key:"buildCSSClass",value:function buildCSSClass(){return"".concat(WX," vjs-hidden ").concat(_get$1(_getPrototypeOf$1(ModalDialog.prototype),"buildCSSClass",this).call(this))}},{key:"label",value:function label(){return this.localize(this.options_.label||"Modal Window")}},{key:"description",value:function description(){var o=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(o+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),o}},{key:"open",value:function open(){if(!this.opened_){var o=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!o.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&o.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=o.controls(),o.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}}},{key:"opened",value:function opened(o){return"boolean"==typeof o&&this[o?"open":"close"](),this.opened_}},{key:"close",value:function close(){if(this.opened_){var o=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&o.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&o.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}}},{key:"closeable",value:function closeable(o){if("boolean"==typeof o){var closeable=this.closeable_=!!o,s=this.getChild("closeButton");if(closeable&&!s){var m=this.contentEl_;this.contentEl_=this.el_,s=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=m,this.on(s,"close",this.close_)}!closeable&&s&&(this.off(s,"close",this.close_),this.removeChild(s),s.dispose())}return this.closeable_}},{key:"fill",value:function fill(){this.fillWith(this.content())}},{key:"fillWith",value:function fillWith(o){var s=this.contentEl(),m=s.parentNode,_=s.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,m.removeChild(s),this.empty(),insertContent(s,o),this.trigger("modalfill"),_?m.insertBefore(s,_):m.appendChild(s);var S=this.getChild("closeButton");S&&m.appendChild(S.el_)}},{key:"empty",value:function empty(){this.trigger("beforemodalempty"),emptyEl(this.contentEl()),this.trigger("modalempty")}},{key:"content",value:function content(o){return void 0!==o&&(this.content_=o),this.content_}},{key:"conditionalFocus_",value:function conditionalFocus_(){var o=lH.activeElement,s=this.player_.el_;this.previouslyActiveEl_=null,(s.contains(o)||s===o)&&(this.previouslyActiveEl_=o,this.focus())}},{key:"conditionalBlur_",value:function conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}},{key:"handleKeyDown",value:function handleKeyDown(o){if(o.stopPropagation(),dH.isEventKey(o,"Escape")&&this.closeable())return o.preventDefault(),void this.close();if(dH.isEventKey(o,"Tab")){for(var s,m=this.focusableEls_(),_=this.el_.querySelector(":focus"),S=0;S<m.length;S++)if(_===m[S]){s=S;break}lH.activeElement===this.el_&&(s=0),o.shiftKey&&0===s?(m[m.length-1].focus(),o.preventDefault()):o.shiftKey||s!==m.length-1||(m[0].focus(),o.preventDefault())}}},{key:"focusableEls_",value:function focusableEls_(){var o=this.el_.querySelectorAll("*");return Array.prototype.filter.call(o,(function(o){return(o instanceof $V.HTMLAnchorElement||o instanceof $V.HTMLAreaElement)&&o.hasAttribute("href")||(o instanceof $V.HTMLInputElement||o instanceof $V.HTMLSelectElement||o instanceof $V.HTMLTextAreaElement||o instanceof $V.HTMLButtonElement)&&!o.hasAttribute("disabled")||o instanceof $V.HTMLIFrameElement||o instanceof $V.HTMLObjectElement||o instanceof $V.HTMLEmbedElement||o.hasAttribute("tabindex")&&-1!==o.getAttribute("tabindex")||o.hasAttribute("contenteditable")}))}}]),ModalDialog}(UX);GX.prototype.options_={pauseOnOpen:!0,temporary:!0},UX.registerComponent("ModalDialog",GX);var qX=function(o){_inherits$1(TrackList,o);var s=_createSuper$1(TrackList);function TrackList(){var o,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck$1(this,TrackList),(o=s.call(this)).tracks_=[],Object.defineProperty(_assertThisInitialized(o),"length",{get:function get(){return this.tracks_.length}});for(var _=0;_<m.length;_++)o.addTrack(m[_]);return o}return _createClass$1(TrackList,[{key:"addTrack",value:function addTrack(o){var s=this,m=this.tracks_.length;""+m in this||Object.defineProperty(this,m,{get:function get(){return this.tracks_[m]}}),-1===this.tracks_.indexOf(o)&&(this.tracks_.push(o),this.trigger({track:o,type:"addtrack",target:this})),o.labelchange_=function(){s.trigger({track:o,type:"labelchange",target:s})},wX(o)&&o.addEventListener("labelchange",o.labelchange_)}},{key:"removeTrack",value:function removeTrack(o){for(var s,m=0,_=this.length;m<_;m++)if(this[m]===o){(s=this[m]).off&&s.off(),this.tracks_.splice(m,1);break}s&&this.trigger({track:s,type:"removetrack",target:this})}},{key:"getTrackById",value:function getTrackById(o){for(var s=null,m=0,_=this.length;m<_;m++){var S=this[m];if(S.id===o){s=S;break}}return s}}]),TrackList}(kX);for(var XX in qX.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"},qX.prototype.allowedEvents_)qX.prototype["on"+XX]=null;var YX=function disableOthers$1(o,s){for(var m=0;m<o.length;m++)Object.keys(o[m]).length&&s.id!==o[m].id&&(o[m].enabled=!1)},QX=function(o){_inherits$1(AudioTrackList,o);var s=_createSuper$1(AudioTrackList);function AudioTrackList(){var o,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck$1(this,AudioTrackList);for(var _=m.length-1;_>=0;_--)if(m[_].enabled){YX(m,m[_]);break}return(o=s.call(this,m)).changing_=!1,o}return _createClass$1(AudioTrackList,[{key:"addTrack",value:function addTrack(o){var s=this;o.enabled&&YX(this,o),_get$1(_getPrototypeOf$1(AudioTrackList.prototype),"addTrack",this).call(this,o),o.addEventListener&&(o.enabledChange_=function(){s.changing_||(s.changing_=!0,YX(s,o),s.changing_=!1,s.trigger("change"))},o.addEventListener("enabledchange",o.enabledChange_))}},{key:"removeTrack",value:function removeTrack(o){_get$1(_getPrototypeOf$1(AudioTrackList.prototype),"removeTrack",this).call(this,o),o.removeEventListener&&o.enabledChange_&&(o.removeEventListener("enabledchange",o.enabledChange_),o.enabledChange_=null)}}]),AudioTrackList}(qX),JX=function disableOthers(o,s){for(var m=0;m<o.length;m++)Object.keys(o[m]).length&&s.id!==o[m].id&&(o[m].selected=!1)},ZX=function(o){_inherits$1(VideoTrackList,o);var s=_createSuper$1(VideoTrackList);function VideoTrackList(){var o,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck$1(this,VideoTrackList);for(var _=m.length-1;_>=0;_--)if(m[_].selected){JX(m,m[_]);break}return(o=s.call(this,m)).changing_=!1,Object.defineProperty(_assertThisInitialized(o),"selectedIndex",{get:function get(){for(var o=0;o<this.length;o++)if(this[o].selected)return o;return-1},set:function set(){}}),o}return _createClass$1(VideoTrackList,[{key:"addTrack",value:function addTrack(o){var s=this;o.selected&&JX(this,o),_get$1(_getPrototypeOf$1(VideoTrackList.prototype),"addTrack",this).call(this,o),o.addEventListener&&(o.selectedChange_=function(){s.changing_||(s.changing_=!0,JX(s,o),s.changing_=!1,s.trigger("change"))},o.addEventListener("selectedchange",o.selectedChange_))}},{key:"removeTrack",value:function removeTrack(o){_get$1(_getPrototypeOf$1(VideoTrackList.prototype),"removeTrack",this).call(this,o),o.removeEventListener&&o.selectedChange_&&(o.removeEventListener("selectedchange",o.selectedChange_),o.selectedChange_=null)}}]),VideoTrackList}(qX),eY=function(o){_inherits$1(TextTrackList,o);var s=_createSuper$1(TextTrackList);function TextTrackList(){return _classCallCheck$1(this,TextTrackList),s.apply(this,arguments)}return _createClass$1(TextTrackList,[{key:"addTrack",value:function addTrack(o){var s=this;_get$1(_getPrototypeOf$1(TextTrackList.prototype),"addTrack",this).call(this,o),this.queueChange_||(this.queueChange_=function(){return s.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return s.trigger("selectedlanguagechange")}),o.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(o.kind)&&o.addEventListener("modechange",this.triggerSelectedlanguagechange_)}},{key:"removeTrack",value:function removeTrack(o){_get$1(_getPrototypeOf$1(TextTrackList.prototype),"removeTrack",this).call(this,o),o.removeEventListener&&(this.queueChange_&&o.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&o.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}]),TextTrackList}(qX),tY=function(){function HtmlTrackElementList(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck$1(this,HtmlTrackElementList),this.trackElements_=[],Object.defineProperty(this,"length",{get:function get(){return this.trackElements_.length}});for(var s=0,m=o.length;s<m;s++)this.addTrackElement_(o[s])}return _createClass$1(HtmlTrackElementList,[{key:"addTrackElement_",value:function addTrackElement_(o){var s=this.trackElements_.length;""+s in this||Object.defineProperty(this,s,{get:function get(){return this.trackElements_[s]}}),-1===this.trackElements_.indexOf(o)&&this.trackElements_.push(o)}},{key:"getTrackElementByTrack_",value:function getTrackElementByTrack_(o){for(var s,m=0,_=this.trackElements_.length;m<_;m++)if(o===this.trackElements_[m].track){s=this.trackElements_[m];break}return s}},{key:"removeTrackElement_",value:function removeTrackElement_(o){for(var s=0,m=this.trackElements_.length;s<m;s++)if(o===this.trackElements_[s]){this.trackElements_[s].track&&"function"==typeof this.trackElements_[s].track.off&&this.trackElements_[s].track.off(),"function"==typeof this.trackElements_[s].off&&this.trackElements_[s].off(),this.trackElements_.splice(s,1);break}}}]),HtmlTrackElementList}(),nY=function(){function TextTrackCueList(o){_classCallCheck$1(this,TextTrackCueList),TextTrackCueList.prototype.setCues_.call(this,o),Object.defineProperty(this,"length",{get:function get(){return this.length_}})}return _createClass$1(TextTrackCueList,[{key:"setCues_",value:function setCues_(o){var s=this.length||0,m=0,_=o.length;this.cues_=o,this.length_=o.length;var S=function defineProp(o){""+o in this||Object.defineProperty(this,""+o,{get:function get(){return this.cues_[o]}})};if(s<_)for(m=s;m<_;m++)S.call(this,m)}},{key:"getCueById",value:function getCueById(o){for(var s=null,m=0,_=this.length;m<_;m++){var S=this[m];if(S.id===o){s=S;break}}return s}}]),TextTrackCueList}(),rY={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},iY={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},aY={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},oY={disabled:"disabled",hidden:"hidden",showing:"showing"},sY=function(o){_inherits$1(Track,o);var s=_createSuper$1(Track);function Track(){var o,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck$1(this,Track),o=s.call(this);var _={id:m.id||"vjs_track_"+newGUID(),kind:m.kind||"",language:m.language||""},S=m.label||"",E=function _loop(s){Object.defineProperty(_assertThisInitialized(o),s,{get:function get(){return _[s]},set:function set(){}})};for(var A in _)E(A);return Object.defineProperty(_assertThisInitialized(o),"label",{get:function get(){return S},set:function set(o){o!==S&&(S=o,this.trigger("labelchange"))}}),o}return _createClass$1(Track)}(kX),uY=function parseUrl(o){var s=["protocol","hostname","port","pathname","search","hash","host"],m=lH.createElement("a");m.href=o;for(var _={},S=0;S<s.length;S++)_[s[S]]=m[s[S]];return"http:"===_.protocol&&(_.host=_.host.replace(/:80$/,"")),"https:"===_.protocol&&(_.host=_.host.replace(/:443$/,"")),_.protocol||(_.protocol=$V.location.protocol),_.host||(_.host=$V.location.host),_},lY=function getAbsoluteURL(o){if(!o.match(/^https?:\/\//)){var s=lH.createElement("a");s.href=o,o=s.href}return o},cY=function getFileExtension(o){if("string"==typeof o){var s=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(o);if(s)return s.pop().toLowerCase()}return""},dY=function isCrossOrigin(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$V.location,m=uY(o);return(":"===m.protocol?s.protocol:m.protocol)+m.host!==s.protocol+s.host},hY=Object.freeze({__proto__:null,parseUrl:uY,getAbsoluteURL:lY,getFileExtension:cY,isCrossOrigin:dY}),pY=function parseCues(o,s){var m=new $V.WebVTT.Parser($V,$V.vttjs,$V.WebVTT.StringDecoder()),_=[];m.oncue=function(o){s.addCue(o)},m.onparsingerror=function(o){_.push(o)},m.onflush=function(){s.trigger({type:"loadeddata",target:s})},m.parse(o),_.length>0&&($V.console&&$V.console.groupCollapsed&&$V.console.groupCollapsed("Text Track parsing errors for ".concat(s.src)),_.forEach((function(o){return OG.error(o)})),$V.console&&$V.console.groupEnd&&$V.console.groupEnd()),m.flush()},fY=function loadTrack(o,s){var m={uri:o},_=dY(o);_&&(m.cors=_);var S="use-credentials"===s.tech_.crossOrigin();S&&(m.withCredentials=S),CH(m,_X(this,(function(o,m,_){if(o)return OG.error(o,m);s.loaded_=!0,"function"!=typeof $V.WebVTT?s.tech_&&s.tech_.any(["vttjsloaded","vttjserror"],(function(o){if("vttjserror"!==o.type)return pY(_,s);OG.error("vttjs failed to load, stopping trying to process ".concat(s.src))})):pY(_,s)})))},gY=function(o){_inherits$1(TextTrack,o);var s=_createSuper$1(TextTrack);function TextTrack(){var o,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck$1(this,TextTrack),!m.tech)throw new Error("A tech was not provided.");var _=merge$1(m,{kind:aY[m.kind]||"subtitles",language:m.language||m.srclang||""}),S=oY[_.mode]||"disabled",E=_.default;"metadata"!==_.kind&&"chapters"!==_.kind||(S="hidden"),(o=s.call(this,_)).tech_=_.tech,o.cues_=[],o.activeCues_=[],o.preload_=!1!==o.tech_.preloadTextTracks;var A=new nY(o.cues_),O=new nY(o.activeCues_),H=!1;o.timeupdateHandler=_X(_assertThisInitialized(o),(function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.tech_.isDisposed()||(this.tech_.isReady_?(this.activeCues=this.activeCues,H&&(this.trigger("cuechange"),H=!1),"timeupdate"!==o.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))):"timeupdate"!==o.type&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)))}));return o.tech_.one("dispose",(function disposeHandler(){o.stopTracking()})),"disabled"!==S&&o.startTracking(),Object.defineProperties(_assertThisInitialized(o),{default:{get:function get(){return E},set:function set(){}},mode:{get:function get(){return S},set:function set(o){oY[o]&&S!==o&&(S=o,this.preload_||"disabled"===S||0!==this.cues.length||fY(this.src,this),this.stopTracking(),"disabled"!==S&&this.startTracking(),this.trigger("modechange"))}},cues:{get:function get(){return this.loaded_?A:null},set:function set(){}},activeCues:{get:function get(){if(!this.loaded_)return null;if(0===this.cues.length)return O;for(var o=this.tech_.currentTime(),s=[],m=0,_=this.cues.length;m<_;m++){var S=this.cues[m];S.startTime<=o&&S.endTime>=o&&s.push(S)}if(H=!1,s.length!==this.activeCues_.length)H=!0;else for(var E=0;E<s.length;E++)-1===this.activeCues_.indexOf(s[E])&&(H=!0);return this.activeCues_=s,O.setCues_(this.activeCues_),O},set:function set(){}}}),_.src?(o.src=_.src,o.preload_||(o.loaded_=!0),(o.preload_||"subtitles"!==_.kind&&"captions"!==_.kind)&&fY(o.src,_assertThisInitialized(o))):o.loaded_=!0,o}return _createClass$1(TextTrack,[{key:"startTracking",value:function startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}},{key:"stopTracking",value:function stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}},{key:"addCue",value:function addCue(o){var s=o;if(!("getCueAsHTML"in s)){for(var m in s=new $V.vttjs.VTTCue(o.startTime,o.endTime,o.text),o)m in s||(s[m]=o[m]);s.id=o.id,s.originalCue_=o}for(var _=this.tech_.textTracks(),S=0;S<_.length;S++)_[S]!==this&&_[S].removeCue(s);this.cues_.push(s),this.cues.setCues_(this.cues_)}},{key:"removeCue",value:function removeCue(o){for(var s=this.cues_.length;s--;){var m=this.cues_[s];if(m===o||m.originalCue_&&m.originalCue_===o){this.cues_.splice(s,1),this.cues.setCues_(this.cues_);break}}}}]),TextTrack}(sY);gY.prototype.allowedEvents_={cuechange:"cuechange"};var mY=function(o){_inherits$1(AudioTrack,o);var s=_createSuper$1(AudioTrack);function AudioTrack(){var o,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck$1(this,AudioTrack);var _=merge$1(m,{kind:iY[m.kind]||""});o=s.call(this,_);var S=!1;return Object.defineProperty(_assertThisInitialized(o),"enabled",{get:function get(){return S},set:function set(o){"boolean"==typeof o&&o!==S&&(S=o,this.trigger("enabledchange"))}}),_.enabled&&(o.enabled=_.enabled),o.loaded_=!0,o}return _createClass$1(AudioTrack)}(sY),yY=function(o){_inherits$1(VideoTrack,o);var s=_createSuper$1(VideoTrack);function VideoTrack(){var o,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck$1(this,VideoTrack);var _=merge$1(m,{kind:rY[m.kind]||""});o=s.call(this,_);var S=!1;return Object.defineProperty(_assertThisInitialized(o),"selected",{get:function get(){return S},set:function set(o){"boolean"==typeof o&&o!==S&&(S=o,this.trigger("selectedchange"))}}),_.selected&&(o.selected=_.selected),o}return _createClass$1(VideoTrack)}(sY),vY=function(o){_inherits$1(HTMLTrackElement,o);var s=_createSuper$1(HTMLTrackElement);function HTMLTrackElement(){var o,m,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck$1(this,HTMLTrackElement),o=s.call(this);var S=new gY(_);return o.kind=S.kind,o.src=S.src,o.srclang=S.language,o.label=S.label,o.default=S.default,Object.defineProperties(_assertThisInitialized(o),{readyState:{get:function get(){return m}},track:{get:function get(){return S}}}),m=HTMLTrackElement.NONE,S.addEventListener("loadeddata",(function(){m=HTMLTrackElement.LOADED,o.trigger({type:"load",target:_assertThisInitialized(o)})})),o}return _createClass$1(HTMLTrackElement)}(kX);vY.prototype.allowedEvents_={load:"load"},vY.NONE=0,vY.LOADING=1,vY.LOADED=2,vY.ERROR=3;var _Y={audio:{ListClass:QX,TrackClass:mY,capitalName:"Audio"},video:{ListClass:ZX,TrackClass:yY,capitalName:"Video"},text:{ListClass:eY,TrackClass:gY,capitalName:"Text"}};Object.keys(_Y).forEach((function(o){_Y[o].getterName="".concat(o,"Tracks"),_Y[o].privateName="".concat(o,"Tracks_")}));var bY={remoteText:{ListClass:eY,TrackClass:gY,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:tY,TrackClass:vY,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},SY=Object.assign({},_Y,bY);bY.names=Object.keys(bY),_Y.names=Object.keys(_Y),SY.names=[].concat(bY.names).concat(_Y.names);var TY=function(o){_inherits$1(Tech,o);var s=_createSuper$1(Tech);function Tech(){var o,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return _classCallCheck$1(this,Tech),m.reportTouchActivity=!1,(o=s.call(this,null,m,_)).onDurationChange_=function(s){return o.onDurationChange(s)},o.trackProgress_=function(s){return o.trackProgress(s)},o.trackCurrentTime_=function(s){return o.trackCurrentTime(s)},o.stopTrackingCurrentTime_=function(s){return o.stopTrackingCurrentTime(s)},o.disposeSourceHandler_=function(s){return o.disposeSourceHandler(s)},o.queuedHanders_=new Set,o.hasStarted_=!1,o.on("playing",(function(){this.hasStarted_=!0})),o.on("loadstart",(function(){this.hasStarted_=!1})),SY.names.forEach((function(s){var _=SY[s];m&&m[_.getterName]&&(o[_.privateName]=m[_.getterName])})),o.featuresProgressEvents||o.manualProgressOn(),o.featuresTimeupdateEvents||o.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach((function(s){!1===m["native".concat(s,"Tracks")]&&(o["featuresNative".concat(s,"Tracks")]=!1)})),!1===m.nativeCaptions||!1===m.nativeTextTracks?o.featuresNativeTextTracks=!1:!0!==m.nativeCaptions&&!0!==m.nativeTextTracks||(o.featuresNativeTextTracks=!0),o.featuresNativeTextTracks||o.emulateTextTracks(),o.preloadTextTracks=!1!==m.preloadTextTracks,o.autoRemoteTextTracks_=new SY.text.ListClass,o.initTrackListeners(),m.nativeControlsForTouch||o.emitTapEvents(),o.constructor&&(o.name_=o.constructor.name||"Unknown Tech"),o}return _createClass$1(Tech,[{key:"triggerSourceset",value:function triggerSourceset(o){var s=this;this.isReady_||this.one("ready",(function(){return s.setTimeout((function(){return s.triggerSourceset(o)}),1)})),this.trigger({src:o,type:"sourceset"})}},{key:"manualProgressOn",value:function manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}},{key:"manualProgressOff",value:function manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}},{key:"trackProgress",value:function trackProgress(o){this.stopTrackingProgress(),this.progressInterval=this.setInterval(_X(this,(function(){var o=this.bufferedPercent();this.bufferedPercent_!==o&&this.trigger("progress"),this.bufferedPercent_=o,1===o&&this.stopTrackingProgress()})),500)}},{key:"onDurationChange",value:function onDurationChange(o){this.duration_=this.duration()}},{key:"buffered",value:function buffered(){return createTimeRanges$1(0,0)}},{key:"bufferedPercent",value:function bufferedPercent(){return _bufferedPercent(this.buffered(),this.duration_)}},{key:"stopTrackingProgress",value:function stopTrackingProgress(){this.clearInterval(this.progressInterval)}},{key:"manualTimeUpdatesOn",value:function manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}},{key:"manualTimeUpdatesOff",value:function manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}},{key:"trackCurrentTime",value:function trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}),250)}},{key:"stopTrackingCurrentTime",value:function stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}},{key:"dispose",value:function dispose(){this.clearTracks(_Y.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),_get$1(_getPrototypeOf$1(Tech.prototype),"dispose",this).call(this)}},{key:"clearTracks",value:function clearTracks(o){var s=this;(o=[].concat(o)).forEach((function(o){for(var m=s["".concat(o,"Tracks")]()||[],_=m.length;_--;){var S=m[_];"text"===o&&s.removeRemoteTextTrack(S),m.removeTrack(S)}}))}},{key:"cleanupAutoTextTracks",value:function cleanupAutoTextTracks(){for(var o=this.autoRemoteTextTracks_||[],s=o.length;s--;){var m=o[s];this.removeRemoteTextTrack(m)}}},{key:"reset",value:function reset(){}},{key:"crossOrigin",value:function crossOrigin(){}},{key:"setCrossOrigin",value:function setCrossOrigin(){}},{key:"error",value:function error(o){return void 0!==o&&(this.error_=new MediaError(o),this.trigger("error")),this.error_}},{key:"played",value:function played(){return this.hasStarted_?createTimeRanges$1(0,0):createTimeRanges$1()}},{key:"play",value:function play(){}},{key:"setScrubbing",value:function setScrubbing(o){}},{key:"scrubbing",value:function scrubbing(){}},{key:"setCurrentTime",value:function setCurrentTime(o){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}},{key:"initTrackListeners",value:function initTrackListeners(){var o=this;_Y.names.forEach((function(s){var m=_Y[s],_=function trackListChanges(){o.trigger("".concat(s,"trackchange"))},S=o[m.getterName]();S.addEventListener("removetrack",_),S.addEventListener("addtrack",_),o.on("dispose",(function(){S.removeEventListener("removetrack",_),S.removeEventListener("addtrack",_)}))}))}},{key:"addWebVttScript_",value:function addWebVttScript_(){var o=this;if(!$V.WebVTT)if(lH.body.contains(this.el())){if(!this.options_["vtt.js"]&&isPlain(GH)&&Object.keys(GH).length>0)return void this.trigger("vttjsloaded");var s=lH.createElement("script");s.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",s.onload=function(){o.trigger("vttjsloaded")},s.onerror=function(){o.trigger("vttjserror")},this.on("dispose",(function(){s.onload=null,s.onerror=null})),$V.WebVTT=!0,this.el().parentNode.appendChild(s)}else this.ready(this.addWebVttScript_)}},{key:"emulateTextTracks",value:function emulateTextTracks(){var o=this,s=this.textTracks(),m=this.remoteTextTracks(),_=function handleAddTrack(o){return s.addTrack(o.track)},S=function handleRemoveTrack(o){return s.removeTrack(o.track)};m.on("addtrack",_),m.on("removetrack",S),this.addWebVttScript_();var E=function updateDisplay(){return o.trigger("texttrackchange")},A=function textTracksChanges(){E();for(var o=0;o<s.length;o++){var m=s[o];m.removeEventListener("cuechange",E),"showing"===m.mode&&m.addEventListener("cuechange",E)}};A(),s.addEventListener("change",A),s.addEventListener("addtrack",A),s.addEventListener("removetrack",A),this.on("dispose",(function(){m.off("addtrack",_),m.off("removetrack",S),s.removeEventListener("change",A),s.removeEventListener("addtrack",A),s.removeEventListener("removetrack",A);for(var o=0;o<s.length;o++){s[o].removeEventListener("cuechange",E)}}))}},{key:"addTextTrack",value:function addTextTrack(o,s,m){if(!o)throw new Error("TextTrack kind is required but was not provided");return function createTrackHelper(o,s,m,_){var S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},E=o.textTracks();S.kind=s,m&&(S.label=m),_&&(S.language=_),S.tech=o;var A=new SY.text.TrackClass(S);return E.addTrack(A),A}(this,o,s,m)}},{key:"createRemoteTextTrack",value:function createRemoteTextTrack(o){var s=merge$1(o,{tech:this});return new bY.remoteTextEl.TrackClass(s)}},{key:"addRemoteTextTrack",value:function addRemoteTextTrack(){var o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},m=arguments.length>1?arguments[1]:void 0,_=this.createRemoteTextTrack(s);return"boolean"!=typeof m&&(m=!1),this.remoteTextTrackEls().addTrackElement_(_),this.remoteTextTracks().addTrack(_.track),!1===m&&this.ready((function(){return o.autoRemoteTextTracks_.addTrack(_.track)})),_}},{key:"removeRemoteTextTrack",value:function removeRemoteTextTrack(o){var s=this.remoteTextTrackEls().getTrackElementByTrack_(o);this.remoteTextTrackEls().removeTrackElement_(s),this.remoteTextTracks().removeTrack(o),this.autoRemoteTextTracks_.removeTrack(o)}},{key:"getVideoPlaybackQuality",value:function getVideoPlaybackQuality(){return{}}},{key:"requestPictureInPicture",value:function requestPictureInPicture(){return Promise.reject()}},{key:"disablePictureInPicture",value:function disablePictureInPicture(){return!0}},{key:"setDisablePictureInPicture",value:function setDisablePictureInPicture(){}},{key:"requestVideoFrameCallback",value:function requestVideoFrameCallback(o){var s=this,m=newGUID();return!this.isReady_||this.paused()?(this.queuedHanders_.add(m),this.one("playing",(function(){s.queuedHanders_.has(m)&&(s.queuedHanders_.delete(m),o())}))):this.requestNamedAnimationFrame(m,o),m}},{key:"cancelVideoFrameCallback",value:function cancelVideoFrameCallback(o){this.queuedHanders_.has(o)?this.queuedHanders_.delete(o):this.cancelNamedAnimationFrame(o)}},{key:"setPoster",value:function setPoster(){}},{key:"playsinline",value:function playsinline(){}},{key:"setPlaysinline",value:function setPlaysinline(){}},{key:"overrideNativeAudioTracks",value:function overrideNativeAudioTracks(o){}},{key:"overrideNativeVideoTracks",value:function overrideNativeVideoTracks(o){}},{key:"canPlayType",value:function canPlayType(o){return""}}],[{key:"canPlayType",value:function canPlayType(o){return""}},{key:"canPlaySource",value:function canPlaySource(o,s){return Tech.canPlayType(o.type)}},{key:"isTech",value:function isTech(o){return o.prototype instanceof Tech||o instanceof Tech||o===Tech}},{key:"registerTech",value:function registerTech(o,s){if(Tech.techs_||(Tech.techs_={}),!Tech.isTech(s))throw new Error("Tech ".concat(o," must be a Tech"));if(!Tech.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Tech.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return o=MX(o),Tech.techs_[o]=s,Tech.techs_[OX(o)]=s,"Tech"!==o&&Tech.defaultTechOrder_.push(o),s}},{key:"getTech",value:function getTech(o){if(o)return Tech.techs_&&Tech.techs_[o]?Tech.techs_[o]:(o=MX(o),$V&&$V.videojs&&$V.videojs[o]?(OG.warn("The ".concat(o," tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)")),$V.videojs[o]):void 0)}}]),Tech}(UX);SY.names.forEach((function(o){var s=SY[o];TY.prototype[s.getterName]=function(){return this[s.privateName]=this[s.privateName]||new s.ListClass,this[s.privateName]}})),TY.prototype.featuresVolumeControl=!0,TY.prototype.featuresMuteControl=!0,TY.prototype.featuresFullscreenResize=!1,TY.prototype.featuresPlaybackRate=!1,TY.prototype.featuresProgressEvents=!1,TY.prototype.featuresSourceset=!1,TY.prototype.featuresTimeupdateEvents=!1,TY.prototype.featuresNativeTextTracks=!1,TY.prototype.featuresVideoFrameCallback=!1,TY.withSourceHandlers=function(o){o.registerSourceHandler=function(s,m){var _=o.sourceHandlers;_||(_=o.sourceHandlers=[]),void 0===m&&(m=_.length),_.splice(m,0,s)},o.canPlayType=function(s){for(var m,_=o.sourceHandlers||[],S=0;S<_.length;S++)if(m=_[S].canPlayType(s))return m;return""},o.selectSourceHandler=function(s,m){for(var _=o.sourceHandlers||[],S=0;S<_.length;S++)if(_[S].canHandleSource(s,m))return _[S];return null},o.canPlaySource=function(s,m){var _=o.selectSourceHandler(s,m);return _?_.canHandleSource(s,m):""};["seekable","seeking","duration"].forEach((function(o){var s=this[o];"function"==typeof s&&(this[o]=function(){return this.sourceHandler_&&this.sourceHandler_[o]?this.sourceHandler_[o].apply(this.sourceHandler_,arguments):s.apply(this,arguments)})}),o.prototype),o.prototype.setSource=function(s){var m=o.selectSourceHandler(s,this.options_);m||(o.nativeSourceHandler?m=o.nativeSourceHandler:OG.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),m!==o.nativeSourceHandler&&(this.currentSource_=s),this.sourceHandler_=m.handleSource(s,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},o.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},UX.registerComponent("Tech",TY),TY.registerTech("Tech",TY),TY.defaultTechOrder_=[];var kY={},CY={},wY={};function setSource(o,s,m){o.setTimeout((function(){return setSourceHelper(s,kY[s.type],m,o)}),1)}function mediate(o,s,m){var _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,S="call"+MX(m),E=o.reduce(middlewareIterator(S),_),A=E===wY,O=A?null:s[m](E);return function executeRight(o,s,m,_){for(var S=o.length-1;S>=0;S--){var E=o[S];E[s]&&E[s](_,m)}}(o,m,O,A),O}var xY={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},EY={setCurrentTime:1,setMuted:1,setVolume:1},IY={play:1,pause:1};function middlewareIterator(o){return function(s,m){return s===wY?wY:m[o]?m[o](s):s}}function setSourceHelper(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>2?arguments[2]:void 0,m=arguments.length>3?arguments[3]:void 0,_=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],S=arguments.length>5&&void 0!==arguments[5]&&arguments[5],E=_toArray(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]),A=E[0],O=E.slice(1);if("string"==typeof A)setSourceHelper(o,kY[A],s,m,_,S);else if(A){var H=function getOrCreateFactory(o,s){var m=CY[o.id()],_=null;if(null==m)return _=s(o),CY[o.id()]=[[s,_]],_;for(var S=0;S<m.length;S++){var E=_slicedToArray$1(m[S],2),A=E[0],O=E[1];A===s&&(_=O)}return null===_&&(_=s(o),m.push([s,_])),_}(m,A);if(!H.setSource)return _.push(H),setSourceHelper(o,O,s,m,_,S);H.setSource(Object.assign({},o),(function(E,A){if(E)return setSourceHelper(o,O,s,m,_,S);_.push(H),setSourceHelper(A,o.type===A.type?O:kY[A.type],s,m,_,S)}))}else O.length?setSourceHelper(o,O,s,m,_,S):S?s(o,_):setSourceHelper(o,kY["*"],s,m,_,!0)}var AY={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},PY=function getMimetype(){var o=cY(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"");return AY[o.toLowerCase()]||""},LY=function filterSource(o){if(Array.isArray(o)){var s=[];o.forEach((function(o){o=filterSource(o),Array.isArray(o)?s=s.concat(o):isObject(o)&&s.push(o)})),o=s}else o="string"==typeof o&&o.trim()?[fixSource({src:o})]:isObject(o)&&"string"==typeof o.src&&o.src&&o.src.trim()?[fixSource(o)]:[];return o};function fixSource(o){if(!o.type){var s=PY(o.src);s&&(o.type=s)}return o}var DY=function(o){_inherits$1(MediaLoader,o);var s=_createSuper$1(MediaLoader);function MediaLoader(o,m,_){var S;_classCallCheck$1(this,MediaLoader);var E=merge$1({createEl:!1},m);if(S=s.call(this,o,E,_),m.playerOptions.sources&&0!==m.playerOptions.sources.length)o.src(m.playerOptions.sources);else for(var A=0,O=m.playerOptions.techOrder;A<O.length;A++){var H=MX(O[A]),K=TY.getTech(H);if(H||(K=UX.getComponent(H)),K&&K.isSupported()){o.loadTech_(H);break}}return S}return _createClass$1(MediaLoader)}(UX);UX.registerComponent("MediaLoader",DY);var RY=function(o){_inherits$1(ClickableComponent,o);var s=_createSuper$1(ClickableComponent);function ClickableComponent(o,m){var _;return _classCallCheck$1(this,ClickableComponent),(_=s.call(this,o,m)).options_.controlText&&_.controlText(_.options_.controlText),_.handleMouseOver_=function(o){return _.handleMouseOver(o)},_.handleMouseOut_=function(o){return _.handleMouseOut(o)},_.handleClick_=function(o){return _.handleClick(o)},_.handleKeyDown_=function(o){return _.handleKeyDown(o)},_.emitTapEvents(),_.enable(),_}return _createClass$1(ClickableComponent,[{key:"createEl",value:function createEl(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};s=Object.assign({className:this.buildCSSClass(),tabIndex:0},s),"button"===o&&OG.error("Creating a ClickableComponent with an HTML element of ".concat(o," is not supported; use a Button instead.")),m=Object.assign({role:"button"},m),this.tabIndex_=s.tabIndex;var _=_createEl(o,s,m);return this.player_.options_.experimentalSvgIcons||_.appendChild(_createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(_),_}},{key:"dispose",value:function dispose(){this.controlTextEl_=null,_get$1(_getPrototypeOf$1(ClickableComponent.prototype),"dispose",this).call(this)}},{key:"createControlTextEl",value:function createControlTextEl(o){return this.controlTextEl_=_createEl("span",{className:"vjs-control-text"},{"aria-live":"polite"}),o&&o.appendChild(this.controlTextEl_),this.controlText(this.controlText_,o),this.controlTextEl_}},{key:"controlText",value:function controlText(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.el();if(void 0===o)return this.controlText_||"Need Text";var m=this.localize(o);this.controlText_=o,textContent(this.controlTextEl_,m),this.nonIconControl||this.player_.options_.noUITitleAttributes||s.setAttribute("title",m)}},{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-control vjs-button ".concat(_get$1(_getPrototypeOf$1(ClickableComponent.prototype),"buildCSSClass",this).call(this))}},{key:"enable",value:function enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}},{key:"disable",value:function disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}},{key:"handleLanguagechange",value:function handleLanguagechange(){this.controlText(this.controlText_)}},{key:"handleClick",value:function handleClick(o){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}},{key:"handleKeyDown",value:function handleKeyDown(o){dH.isEventKey(o,"Space")||dH.isEventKey(o,"Enter")?(o.preventDefault(),o.stopPropagation(),this.trigger("click")):_get$1(_getPrototypeOf$1(ClickableComponent.prototype),"handleKeyDown",this).call(this,o)}}]),ClickableComponent}(UX);UX.registerComponent("ClickableComponent",RY);var OY=function(o){_inherits$1(PosterImage,o);var s=_createSuper$1(PosterImage);function PosterImage(o,m){var _;return _classCallCheck$1(this,PosterImage),(_=s.call(this,o,m)).update(),_.update_=function(o){return _.update(o)},o.on("posterchange",_.update_),_}return _createClass$1(PosterImage,[{key:"dispose",value:function dispose(){this.player().off("posterchange",this.update_),_get$1(_getPrototypeOf$1(PosterImage.prototype),"dispose",this).call(this)}},{key:"createEl",value:function createEl(){return _createEl("div",{className:"vjs-poster"})}},{key:"crossOrigin",value:function crossOrigin(o){if(void 0===o)return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;null===o||"anonymous"===o||"use-credentials"===o?this.$("img")&&(this.$("img").crossOrigin=o):this.player_.log.warn('crossOrigin must be null,  "anonymous" or "use-credentials", given "'.concat(o,'"'))}},{key:"update",value:function update(o){var s=this.player().poster();this.setSrc(s),s?this.show():this.hide()}},{key:"setSrc",value:function setSrc(o){o?(this.$("img")||this.el_.appendChild(_createEl("picture",{className:"vjs-poster",tabIndex:-1},{},_createEl("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=o):this.el_.textContent=""}},{key:"handleClick",value:function handleClick(o){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?silencePromise(this.player_.play()):this.player_.pause())}}]),PosterImage}(RY);OY.prototype.crossorigin=OY.prototype.crossOrigin,UX.registerComponent("PosterImage",OY);var MY="#222",FY="#ccc",NY={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function constructColor(o,s){var m;if(4===o.length)m=o[1]+o[1]+o[2]+o[2]+o[3]+o[3];else{if(7!==o.length)throw new Error("Invalid color code provided, "+o+"; must be formatted as e.g. #f0e or #f604e2.");m=o.slice(1)}return"rgba("+parseInt(m.slice(0,2),16)+","+parseInt(m.slice(2,4),16)+","+parseInt(m.slice(4,6),16)+","+s+")"}function tryUpdateStyle(o,s,m){try{o.style[s]=m}catch(o){return}}function getCSSPositionValue(o){return o?"".concat(o,"px"):""}var UY=function(o){_inherits$1(TextTrackDisplay,o);var s=_createSuper$1(TextTrackDisplay);function TextTrackDisplay(o,m,_){var S;_classCallCheck$1(this,TextTrackDisplay),S=s.call(this,o,m,_);var E=function updateDisplayHandler(o){S.updateDisplayOverlay(),S.updateDisplay(o)};return o.on("loadstart",(function(o){return S.toggleDisplay(o)})),o.on("texttrackchange",(function updateDisplayTextHandler(o){return S.updateDisplay(o)})),o.on("loadedmetadata",(function(o){S.updateDisplayOverlay(),S.preselectTrack(o)})),o.ready(_X(_assertThisInitialized(S),(function(){if(o.tech_&&o.tech_.featuresNativeTextTracks)this.hide();else{o.on("fullscreenchange",E),o.on("playerresize",E);var s=$V.screen.orientation||$V,m=$V.screen.orientation?"change":"orientationchange";s.addEventListener(m,E),o.on("dispose",(function(){return s.removeEventListener(m,E)}));for(var _=this.options_.playerOptions.tracks||[],S=0;S<_.length;S++)this.player_.addRemoteTextTrack(_[S],!0);this.preselectTrack()}}))),S}return _createClass$1(TextTrackDisplay,[{key:"preselectTrack",value:function preselectTrack(){for(var o,s,m,_={captions:1,subtitles:1},S=this.player_.textTracks(),E=this.player_.cache_.selectedLanguage,A=0;A<S.length;A++){var O=S[A];E&&E.enabled&&E.language&&E.language===O.language&&O.kind in _?O.kind===E.kind?m=O:m||(m=O):E&&!E.enabled?(m=null,o=null,s=null):O.default&&("descriptions"!==O.kind||o?O.kind in _&&!s&&(s=O):o=O)}m?m.mode="showing":s?s.mode="showing":o&&(o.mode="showing")}},{key:"toggleDisplay",value:function toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}},{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(TextTrackDisplay.prototype),"createEl",this).call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}},{key:"clearDisplay",value:function clearDisplay(){"function"==typeof $V.WebVTT&&$V.WebVTT.processCues($V,[],this.el_)}},{key:"updateDisplay",value:function updateDisplay(){var o=this.player_.textTracks(),s=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),s){for(var m=[],_=0;_<o.length;++_){var S=o[_];"showing"===S.mode&&m.push(S)}this.updateForTrack(m)}else{for(var E=null,A=null,O=o.length;O--;){var H=o[O];"showing"===H.mode&&("descriptions"===H.kind?E=H:A=H)}A?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(A)):E&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(E))}}},{key:"updateDisplayOverlay",value:function updateDisplayOverlay(){if(this.player_.videoHeight()&&$V.CSS.supports("inset-inline: 10px")){var o=this.player_.currentWidth(),s=this.player_.currentHeight(),m=o/s,_=this.player_.videoWidth()/this.player_.videoHeight(),S=0,E=0;Math.abs(m-_)>.1&&(m>_?S=Math.round((o-s*_)/2):E=Math.round((s-o/_)/2)),tryUpdateStyle(this.el_,"insetInline",getCSSPositionValue(S)),tryUpdateStyle(this.el_,"insetBlock",getCSSPositionValue(E))}}},{key:"updateDisplayState",value:function updateDisplayState(o){for(var s=this.player_.textTrackSettings.getValues(),m=o.activeCues,_=m.length;_--;){var S=m[_];if(S){var E=S.displayState;if(s.color&&(E.firstChild.style.color=s.color),s.textOpacity&&tryUpdateStyle(E.firstChild,"color",constructColor(s.color||"#fff",s.textOpacity)),s.backgroundColor&&(E.firstChild.style.backgroundColor=s.backgroundColor),s.backgroundOpacity&&tryUpdateStyle(E.firstChild,"backgroundColor",constructColor(s.backgroundColor||"#000",s.backgroundOpacity)),s.windowColor&&(s.windowOpacity?tryUpdateStyle(E,"backgroundColor",constructColor(s.windowColor,s.windowOpacity)):E.style.backgroundColor=s.windowColor),s.edgeStyle&&("dropshadow"===s.edgeStyle?E.firstChild.style.textShadow="2px 2px 3px ".concat(MY,", 2px 2px 4px ").concat(MY,", 2px 2px 5px ").concat(MY):"raised"===s.edgeStyle?E.firstChild.style.textShadow="1px 1px ".concat(MY,", 2px 2px ").concat(MY,", 3px 3px ").concat(MY):"depressed"===s.edgeStyle?E.firstChild.style.textShadow="1px 1px ".concat(FY,", 0 1px ").concat(FY,", -1px -1px ").concat(MY,", 0 -1px ").concat(MY):"uniform"===s.edgeStyle&&(E.firstChild.style.textShadow="0 0 4px ".concat(MY,", 0 0 4px ").concat(MY,", 0 0 4px ").concat(MY,", 0 0 4px ").concat(MY))),s.fontPercent&&1!==s.fontPercent){var A=$V.parseFloat(E.style.fontSize);E.style.fontSize=A*s.fontPercent+"px",E.style.height="auto",E.style.top="auto"}s.fontFamily&&"default"!==s.fontFamily&&("small-caps"===s.fontFamily?E.firstChild.style.fontVariant="small-caps":E.firstChild.style.fontFamily=NY[s.fontFamily])}}}},{key:"updateForTrack",value:function updateForTrack(o){if(Array.isArray(o)||(o=[o]),"function"==typeof $V.WebVTT&&!o.every((function(o){return!o.activeCues}))){for(var s=[],m=0;m<o.length;++m)for(var _=o[m],S=0;S<_.activeCues.length;++S)s.push(_.activeCues[S]);$V.WebVTT.processCues($V,s,this.el_);for(var E=0;E<o.length;++E){for(var A=o[E],O=0;O<A.activeCues.length;++O){var H=A.activeCues[O].displayState;_addClass(H,"vjs-text-track-cue","vjs-text-track-cue-"+(A.language?A.language:E)),A.language&&_setAttribute(H,"lang",A.language)}this.player_.textTrackSettings&&this.updateDisplayState(A)}}}}]),TextTrackDisplay}(UX);UX.registerComponent("TextTrackDisplay",UY);var BY=function(o){_inherits$1(LoadingSpinner,o);var s=_createSuper$1(LoadingSpinner);function LoadingSpinner(){return _classCallCheck$1(this,LoadingSpinner),s.apply(this,arguments)}return _createClass$1(LoadingSpinner,[{key:"createEl",value:function createEl(){var o=this.player_.isAudio(),s=this.localize(o?"Audio Player":"Video Player"),m=_createEl("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[s])}),_=_get$1(_getPrototypeOf$1(LoadingSpinner.prototype),"createEl",this).call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return _.appendChild(m),_}},{key:"handleLanguagechange",value:function handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}]),LoadingSpinner}(UX);UX.registerComponent("LoadingSpinner",BY);var jY=function(o){_inherits$1(Button,o);var s=_createSuper$1(Button);function Button(){return _classCallCheck$1(this,Button),s.apply(this,arguments)}return _createClass$1(Button,[{key:"createEl",value:function createEl(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_=_createEl(o="button",s=Object.assign({className:this.buildCSSClass()},s),m=Object.assign({type:"button"},m));return this.player_.options_.experimentalSvgIcons||_.appendChild(_createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(_),_}},{key:"addChild",value:function addChild(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=this.constructor.name;return OG.warn("Adding an actionable (user controllable) child to a Button (".concat(m,") is not supported; use a ClickableComponent instead.")),UX.prototype.addChild.call(this,o,s)}},{key:"enable",value:function enable(){_get$1(_getPrototypeOf$1(Button.prototype),"enable",this).call(this),this.el_.removeAttribute("disabled")}},{key:"disable",value:function disable(){_get$1(_getPrototypeOf$1(Button.prototype),"disable",this).call(this),this.el_.setAttribute("disabled","disabled")}},{key:"handleKeyDown",value:function handleKeyDown(o){dH.isEventKey(o,"Space")||dH.isEventKey(o,"Enter")?o.stopPropagation():_get$1(_getPrototypeOf$1(Button.prototype),"handleKeyDown",this).call(this,o)}}]),Button}(RY);UX.registerComponent("Button",jY);var $Y=function(o){_inherits$1(BigPlayButton,o);var s=_createSuper$1(BigPlayButton);function BigPlayButton(o,m){var _;return _classCallCheck$1(this,BigPlayButton),(_=s.call(this,o,m)).mouseused_=!1,_.setIcon("play"),_.on("mousedown",(function(o){return _.handleMouseDown(o)})),_}return _createClass$1(BigPlayButton,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-big-play-button"}},{key:"handleClick",value:function handleClick(o){var s=this.player_.play();if(this.mouseused_&&"clientX"in o&&"clientY"in o)return silencePromise(s),void(this.player_.tech(!0)&&this.player_.tech(!0).focus());var m=this.player_.getChild("controlBar"),_=m&&m.getChild("playToggle");if(_){var S=function playFocus(){return _.focus()};isPromise(s)?s.then(S,(function(){})):this.setTimeout(S,1)}else this.player_.tech(!0).focus()}},{key:"handleKeyDown",value:function handleKeyDown(o){this.mouseused_=!1,_get$1(_getPrototypeOf$1(BigPlayButton.prototype),"handleKeyDown",this).call(this,o)}},{key:"handleMouseDown",value:function handleMouseDown(o){this.mouseused_=!0}}]),BigPlayButton}(jY);$Y.prototype.controlText_="Play Video",UX.registerComponent("BigPlayButton",$Y);var VY=function(o){_inherits$1(CloseButton,o);var s=_createSuper$1(CloseButton);function CloseButton(o,m){var _;return _classCallCheck$1(this,CloseButton),(_=s.call(this,o,m)).setIcon("cancel"),_.controlText(m&&m.controlText||_.localize("Close")),_}return _createClass$1(CloseButton,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-close-button ".concat(_get$1(_getPrototypeOf$1(CloseButton.prototype),"buildCSSClass",this).call(this))}},{key:"handleClick",value:function handleClick(o){this.trigger({type:"close",bubbles:!1})}},{key:"handleKeyDown",value:function handleKeyDown(o){dH.isEventKey(o,"Esc")?(o.preventDefault(),o.stopPropagation(),this.trigger("click")):_get$1(_getPrototypeOf$1(CloseButton.prototype),"handleKeyDown",this).call(this,o)}}]),CloseButton}(jY);UX.registerComponent("CloseButton",VY);var HY=function(o){_inherits$1(PlayToggle,o);var s=_createSuper$1(PlayToggle);function PlayToggle(o){var m,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck$1(this,PlayToggle),m=s.call(this,o,_),_.replay=void 0===_.replay||_.replay,m.setIcon("play"),m.on(o,"play",(function(o){return m.handlePlay(o)})),m.on(o,"pause",(function(o){return m.handlePause(o)})),_.replay&&m.on(o,"ended",(function(o){return m.handleEnded(o)})),m}return _createClass$1(PlayToggle,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-play-control ".concat(_get$1(_getPrototypeOf$1(PlayToggle.prototype),"buildCSSClass",this).call(this))}},{key:"handleClick",value:function handleClick(o){this.player_.paused()?silencePromise(this.player_.play()):this.player_.pause()}},{key:"handleSeeked",value:function handleSeeked(o){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(o):this.handlePlay(o)}},{key:"handlePlay",value:function handlePlay(o){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}},{key:"handlePause",value:function handlePause(o){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}},{key:"handleEnded",value:function handleEnded(o){var s=this;this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",(function(o){return s.handleSeeked(o)}))}}]),PlayToggle}(jY);HY.prototype.controlText_="Play",UX.registerComponent("PlayToggle",HY);var KY=function(o){_inherits$1(TimeDisplay,o);var s=_createSuper$1(TimeDisplay);function TimeDisplay(o,m){var _;return _classCallCheck$1(this,TimeDisplay),(_=s.call(this,o,m)).on(o,["timeupdate","ended","seeking"],(function(o){return _.update(o)})),_.updateTextNode_(),_}return _createClass$1(TimeDisplay,[{key:"createEl",value:function createEl(){var o=this.buildCSSClass(),s=_get$1(_getPrototypeOf$1(TimeDisplay.prototype),"createEl",this).call(this,"div",{className:"".concat(o," vjs-time-control vjs-control")}),m=_createEl("span",{className:"vjs-control-text",textContent:"".concat(this.localize(this.labelText_)," ")},{role:"presentation"});return s.appendChild(m),this.contentEl_=_createEl("span",{className:"".concat(o,"-display")},{role:"presentation"}),s.appendChild(this.contentEl_),s}},{key:"dispose",value:function dispose(){this.contentEl_=null,this.textNode_=null,_get$1(_getPrototypeOf$1(TimeDisplay.prototype),"dispose",this).call(this)}},{key:"update",value:function update(o){(this.player_.options_.enableSmoothSeeking||"seeking"!==o.type)&&this.updateContent(o)}},{key:"updateTextNode_",value:function updateTextNode_(){var o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;s=formatTime(s),this.formattedTime_!==s&&(this.formattedTime_=s,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",(function(){if(o.contentEl_){var s=o.textNode_;s&&o.contentEl_.firstChild!==s&&(s=null,OG.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),o.textNode_=lH.createTextNode(o.formattedTime_),o.textNode_&&(s?o.contentEl_.replaceChild(o.textNode_,s):o.contentEl_.appendChild(o.textNode_))}})))}},{key:"updateContent",value:function updateContent(o){}}]),TimeDisplay}(UX);KY.prototype.labelText_="Time",KY.prototype.controlText_="Time",UX.registerComponent("TimeDisplay",KY);var zY=function(o){_inherits$1(CurrentTimeDisplay,o);var s=_createSuper$1(CurrentTimeDisplay);function CurrentTimeDisplay(){return _classCallCheck$1(this,CurrentTimeDisplay),s.apply(this,arguments)}return _createClass$1(CurrentTimeDisplay,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-current-time"}},{key:"updateContent",value:function updateContent(o){var s;s=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(s)}}]),CurrentTimeDisplay}(KY);zY.prototype.labelText_="Current Time",zY.prototype.controlText_="Current Time",UX.registerComponent("CurrentTimeDisplay",zY);var WY=function(o){_inherits$1(DurationDisplay,o);var s=_createSuper$1(DurationDisplay);function DurationDisplay(o,m){var _;_classCallCheck$1(this,DurationDisplay);var S=function updateContent(o){return _.updateContent(o)};return(_=s.call(this,o,m)).on(o,"durationchange",S),_.on(o,"loadstart",S),_.on(o,"loadedmetadata",S),_}return _createClass$1(DurationDisplay,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-duration"}},{key:"updateContent",value:function updateContent(o){var s=this.player_.duration();this.updateTextNode_(s)}}]),DurationDisplay}(KY);WY.prototype.labelText_="Duration",WY.prototype.controlText_="Duration",UX.registerComponent("DurationDisplay",WY);var GY=function(o){_inherits$1(TimeDivider,o);var s=_createSuper$1(TimeDivider);function TimeDivider(){return _classCallCheck$1(this,TimeDivider),s.apply(this,arguments)}return _createClass$1(TimeDivider,[{key:"createEl",value:function createEl(){var o=_get$1(_getPrototypeOf$1(TimeDivider.prototype),"createEl",this).call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),s=_get$1(_getPrototypeOf$1(TimeDivider.prototype),"createEl",this).call(this,"div"),m=_get$1(_getPrototypeOf$1(TimeDivider.prototype),"createEl",this).call(this,"span",{textContent:"/"});return s.appendChild(m),o.appendChild(s),o}}]),TimeDivider}(UX);UX.registerComponent("TimeDivider",GY);var qY=function(o){_inherits$1(RemainingTimeDisplay,o);var s=_createSuper$1(RemainingTimeDisplay);function RemainingTimeDisplay(o,m){var _;return _classCallCheck$1(this,RemainingTimeDisplay),(_=s.call(this,o,m)).on(o,"durationchange",(function(o){return _.updateContent(o)})),_}return _createClass$1(RemainingTimeDisplay,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-remaining-time"}},{key:"createEl",value:function createEl(){var o=_get$1(_getPrototypeOf$1(RemainingTimeDisplay.prototype),"createEl",this).call(this);return!1!==this.options_.displayNegative&&o.insertBefore(_createEl("span",{},{"aria-hidden":!0},"-"),this.contentEl_),o}},{key:"updateContent",value:function updateContent(o){var s;"number"==typeof this.player_.duration()&&(s=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(s))}}]),RemainingTimeDisplay}(KY);qY.prototype.labelText_="Remaining Time",qY.prototype.controlText_="Remaining Time",UX.registerComponent("RemainingTimeDisplay",qY);var XY=function(o){_inherits$1(LiveDisplay,o);var s=_createSuper$1(LiveDisplay);function LiveDisplay(o,m){var _;return _classCallCheck$1(this,LiveDisplay),(_=s.call(this,o,m)).updateShowing(),_.on(_.player(),"durationchange",(function(o){return _.updateShowing(o)})),_}return _createClass$1(LiveDisplay,[{key:"createEl",value:function createEl(){var o=_get$1(_getPrototypeOf$1(LiveDisplay.prototype),"createEl",this).call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=_createEl("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(_createEl("span",{className:"vjs-control-text",textContent:"".concat(this.localize("Stream Type")," ")})),this.contentEl_.appendChild(lH.createTextNode(this.localize("LIVE"))),o.appendChild(this.contentEl_),o}},{key:"dispose",value:function dispose(){this.contentEl_=null,_get$1(_getPrototypeOf$1(LiveDisplay.prototype),"dispose",this).call(this)}},{key:"updateShowing",value:function updateShowing(o){this.player().duration()===1/0?this.show():this.hide()}}]),LiveDisplay}(UX);UX.registerComponent("LiveDisplay",XY);var YY=function(o){_inherits$1(SeekToLive,o);var s=_createSuper$1(SeekToLive);function SeekToLive(o,m){var _;return _classCallCheck$1(this,SeekToLive),(_=s.call(this,o,m)).updateLiveEdgeStatus(),_.player_.liveTracker&&(_.updateLiveEdgeStatusHandler_=function(o){return _.updateLiveEdgeStatus(o)},_.on(_.player_.liveTracker,"liveedgechange",_.updateLiveEdgeStatusHandler_)),_}return _createClass$1(SeekToLive,[{key:"createEl",value:function createEl(){var o=_get$1(_getPrototypeOf$1(SeekToLive.prototype),"createEl",this).call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",o),this.textEl_=_createEl("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),o.appendChild(this.textEl_),o}},{key:"updateLiveEdgeStatus",value:function updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}},{key:"handleClick",value:function handleClick(){this.player_.liveTracker.seekToLiveEdge()}},{key:"dispose",value:function dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,_get$1(_getPrototypeOf$1(SeekToLive.prototype),"dispose",this).call(this)}}]),SeekToLive}(jY);function clamp(o,s,m){return o=Number(o),Math.min(m,Math.max(s,isNaN(o)?s:o))}YY.prototype.controlText_="Seek to live, currently playing live",UX.registerComponent("SeekToLive",YY);var QY=Object.freeze({__proto__:null,clamp:clamp}),JY=function(o){_inherits$1(Slider,o);var s=_createSuper$1(Slider);function Slider(o,m){var _;return _classCallCheck$1(this,Slider),(_=s.call(this,o,m)).handleMouseDown_=function(o){return _.handleMouseDown(o)},_.handleMouseUp_=function(o){return _.handleMouseUp(o)},_.handleKeyDown_=function(o){return _.handleKeyDown(o)},_.handleClick_=function(o){return _.handleClick(o)},_.handleMouseMove_=function(o){return _.handleMouseMove(o)},_.update_=function(o){return _.update(o)},_.bar=_.getChild(_.options_.barName),_.vertical(!!_.options_.vertical),_.enable(),_}return _createClass$1(Slider,[{key:"enabled",value:function enabled(){return this.enabled_}},{key:"enable",value:function enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}},{key:"disable",value:function disable(){if(this.enabled()){var o=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(o,"mousemove",this.handleMouseMove_),this.off(o,"mouseup",this.handleMouseUp_),this.off(o,"touchmove",this.handleMouseMove_),this.off(o,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}}},{key:"createEl",value:function createEl(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.className=s.className+" vjs-slider",s=Object.assign({tabIndex:0},s),m=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},m),_get$1(_getPrototypeOf$1(Slider.prototype),"createEl",this).call(this,o,s,m)}},{key:"handleMouseDown",value:function handleMouseDown(o){var s=this.bar.el_.ownerDocument;"mousedown"===o.type&&o.preventDefault(),"touchstart"!==o.type||GG||o.preventDefault(),blockTextSelection(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(s,"mousemove",this.handleMouseMove_),this.on(s,"mouseup",this.handleMouseUp_),this.on(s,"touchmove",this.handleMouseMove_),this.on(s,"touchend",this.handleMouseUp_),this.handleMouseMove(o,!0)}},{key:"handleMouseMove",value:function handleMouseMove(o){}},{key:"handleMouseUp",value:function handleMouseUp(o){var s=this.bar.el_.ownerDocument;unblockTextSelection(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(s,"mousemove",this.handleMouseMove_),this.off(s,"mouseup",this.handleMouseUp_),this.off(s,"touchmove",this.handleMouseMove_),this.off(s,"touchend",this.handleMouseUp_),this.update()}},{key:"update",value:function update(){var o=this;if(this.el_&&this.bar){var s=this.getProgress();return s===this.progress_||(this.progress_=s,this.requestNamedAnimationFrame("Slider#update",(function(){var m=o.vertical()?"height":"width";o.bar.el().style[m]=(100*s).toFixed(2)+"%"}))),s}}},{key:"getProgress",value:function getProgress(){return Number(clamp(this.getPercent(),0,1).toFixed(4))}},{key:"calculateDistance",value:function calculateDistance(o){var s=getPointerPosition(this.el_,o);return this.vertical()?s.y:s.x}},{key:"handleKeyDown",value:function handleKeyDown(o){dH.isEventKey(o,"Left")||dH.isEventKey(o,"Down")?(o.preventDefault(),o.stopPropagation(),this.stepBack()):dH.isEventKey(o,"Right")||dH.isEventKey(o,"Up")?(o.preventDefault(),o.stopPropagation(),this.stepForward()):_get$1(_getPrototypeOf$1(Slider.prototype),"handleKeyDown",this).call(this,o)}},{key:"handleClick",value:function handleClick(o){o.stopPropagation(),o.preventDefault()}},{key:"vertical",value:function vertical(o){if(void 0===o)return this.vertical_||!1;this.vertical_=!!o,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}]),Slider}(UX);UX.registerComponent("Slider",JY);var ZY=function percentify(o,s){return clamp(o/s*100,0,100).toFixed(2)+"%"},eQ=function(o){_inherits$1(LoadProgressBar,o);var s=_createSuper$1(LoadProgressBar);function LoadProgressBar(o,m){var _;return _classCallCheck$1(this,LoadProgressBar),(_=s.call(this,o,m)).partEls_=[],_.on(o,"progress",(function(o){return _.update(o)})),_}return _createClass$1(LoadProgressBar,[{key:"createEl",value:function createEl(){var o=_get$1(_getPrototypeOf$1(LoadProgressBar.prototype),"createEl",this).call(this,"div",{className:"vjs-load-progress"}),s=_createEl("span",{className:"vjs-control-text"}),m=_createEl("span",{textContent:this.localize("Loaded")}),_=lH.createTextNode(": ");return this.percentageEl_=_createEl("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),o.appendChild(s),s.appendChild(m),s.appendChild(_),s.appendChild(this.percentageEl_),o}},{key:"dispose",value:function dispose(){this.partEls_=null,this.percentageEl_=null,_get$1(_getPrototypeOf$1(LoadProgressBar.prototype),"dispose",this).call(this)}},{key:"update",value:function update(o){var s=this;this.requestNamedAnimationFrame("LoadProgressBar#update",(function(){var o=s.player_.liveTracker,m=s.player_.buffered(),_=o&&o.isLive()?o.seekableEnd():s.player_.duration(),S=s.player_.bufferedEnd(),E=s.partEls_,A=ZY(S,_);s.percent_!==A&&(s.el_.style.width=A,textContent(s.percentageEl_,A),s.percent_=A);for(var O=0;O<m.length;O++){var H=m.start(O),K=m.end(O),z=E[O];z||(z=s.el_.appendChild(_createEl()),E[O]=z),z.dataset.start===H&&z.dataset.end===K||(z.dataset.start=H,z.dataset.end=K,z.style.left=ZY(H,S),z.style.width=ZY(K-H,S))}for(var G=E.length;G>m.length;G--)s.el_.removeChild(E[G-1]);E.length=m.length}))}}]),LoadProgressBar}(UX);UX.registerComponent("LoadProgressBar",eQ);var tQ=function(o){_inherits$1(TimeTooltip,o);var s=_createSuper$1(TimeTooltip);function TimeTooltip(o,m){var _;return _classCallCheck$1(this,TimeTooltip),(_=s.call(this,o,m)).update=bX(_X(_assertThisInitialized(_),_.update),vX),_}return _createClass$1(TimeTooltip,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(TimeTooltip.prototype),"createEl",this).call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}},{key:"update",value:function update(o,s,m){var _=findPosition(this.el_),S=getBoundingClientRect(this.player_.el()),E=o.width*s;if(S&&_){var A=o.left-S.left+E,O=o.width-E+(S.right-o.right),H=_.width/2;A<H?H+=H-A:O<H&&(H=O),H<0?H=0:H>_.width&&(H=_.width),H=Math.round(H),this.el_.style.right="-".concat(H,"px"),this.write(m)}}},{key:"write",value:function write(o){textContent(this.el_,o)}},{key:"updateTime",value:function updateTime(o,s,m,_){var S=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",(function(){var E,A=S.player_.duration();if(S.player_.liveTracker&&S.player_.liveTracker.isLive()){var O=S.player_.liveTracker.liveWindow(),H=O-s*O;E=(H<1?"":"-")+formatTime(H,O)}else E=formatTime(m,A);S.update(o,s,E),_&&_()}))}}]),TimeTooltip}(UX);UX.registerComponent("TimeTooltip",tQ);var nQ=function(o){_inherits$1(PlayProgressBar,o);var s=_createSuper$1(PlayProgressBar);function PlayProgressBar(o,m){var _;return _classCallCheck$1(this,PlayProgressBar),(_=s.call(this,o,m)).setIcon("circle"),_.update=bX(_X(_assertThisInitialized(_),_.update),vX),_}return _createClass$1(PlayProgressBar,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(PlayProgressBar.prototype),"createEl",this).call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}},{key:"update",value:function update(o,s){var m=this.getChild("timeTooltip");if(m){var _=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();m.updateTime(o,s,_)}}}]),PlayProgressBar}(UX);nQ.prototype.options_={children:[]},eX||HG||nQ.prototype.options_.children.push("timeTooltip"),UX.registerComponent("PlayProgressBar",nQ);var rQ=function(o){_inherits$1(MouseTimeDisplay,o);var s=_createSuper$1(MouseTimeDisplay);function MouseTimeDisplay(o,m){var _;return _classCallCheck$1(this,MouseTimeDisplay),(_=s.call(this,o,m)).update=bX(_X(_assertThisInitialized(_),_.update),vX),_}return _createClass$1(MouseTimeDisplay,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(MouseTimeDisplay.prototype),"createEl",this).call(this,"div",{className:"vjs-mouse-display"})}},{key:"update",value:function update(o,s){var m=this,_=s*this.player_.duration();this.getChild("timeTooltip").updateTime(o,s,_,(function(){m.el_.style.left="".concat(o.width*s,"px")}))}}]),MouseTimeDisplay}(UX);rQ.prototype.options_={children:["timeTooltip"]},UX.registerComponent("MouseTimeDisplay",rQ);var iQ=function(o){_inherits$1(SeekBar,o);var s=_createSuper$1(SeekBar);function SeekBar(o,m){var _;return _classCallCheck$1(this,SeekBar),(_=s.call(this,o,m)).setEventHandlers_(),_}return _createClass$1(SeekBar,[{key:"setEventHandlers_",value:function setEventHandlers_(){var o=this;this.update_=_X(this,this.update),this.update=bX(this.update_,vX),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=function(s){return o.enableInterval_(s)},this.disableIntervalHandler_=function(s){return o.disableInterval_(s)},this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in lH&&"visibilityState"in lH&&this.on(lH,"visibilitychange",this.toggleVisibility_)}},{key:"toggleVisibility_",value:function toggleVisibility_(o){"hidden"===lH.visibilityState?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(o)):(this.player_.ended()||this.player_.paused()||this.enableInterval_(),this.update())}},{key:"enableInterval_",value:function enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,vX))}},{key:"disableInterval_",value:function disableInterval_(o){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&o&&"ended"!==o.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}},{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(SeekBar.prototype),"createEl",this).call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}},{key:"update",value:function update(o){var s=this;if("hidden"!==lH.visibilityState){var m=_get$1(_getPrototypeOf$1(SeekBar.prototype),"update",this).call(this);return this.requestNamedAnimationFrame("SeekBar#update",(function(){var o=s.player_.ended()?s.player_.duration():s.getCurrentTime_(),_=s.player_.liveTracker,S=s.player_.duration();_&&_.isLive()&&(S=s.player_.liveTracker.liveCurrentTime()),s.percent_!==m&&(s.el_.setAttribute("aria-valuenow",(100*m).toFixed(2)),s.percent_=m),s.currentTime_===o&&s.duration_===S||(s.el_.setAttribute("aria-valuetext",s.localize("progress bar timing: currentTime={1} duration={2}",[formatTime(o,S),formatTime(S,S)],"{1} of {2}")),s.currentTime_=o,s.duration_=S),s.bar&&s.bar.update(getBoundingClientRect(s.el()),s.getProgress())})),m}}},{key:"userSeek_",value:function userSeek_(o){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(o)}},{key:"getCurrentTime_",value:function getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}},{key:"getPercent",value:function getPercent(){var o,s=this.getCurrentTime_(),m=this.player_.liveTracker;return m&&m.isLive()?(o=(s-m.seekableStart())/m.liveWindow(),m.atLiveEdge()&&(o=1)):o=s/this.player_.duration(),o}},{key:"handleMouseDown",value:function handleMouseDown(o){isSingleLeftClick(o)&&(o.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),_get$1(_getPrototypeOf$1(SeekBar.prototype),"handleMouseDown",this).call(this,o))}},{key:"handleMouseMove",value:function handleMouseMove(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(isSingleLeftClick(o)&&!isNaN(this.player_.duration())){var m;s||this.player_.scrubbing()||this.player_.scrubbing(!0);var _=this.calculateDistance(o),S=this.player_.liveTracker;if(S&&S.isLive()){if(_>=.99)return void S.seekToLiveEdge();var E=S.seekableStart(),A=S.liveCurrentTime();if((m=E+_*S.liveWindow())>=A&&(m=A),m<=E&&(m=E+.1),m===1/0)return}else(m=_*this.player_.duration())===this.player_.duration()&&(m-=.1);this.userSeek_(m),this.player_.options_.enableSmoothSeeking&&this.update()}}},{key:"enable",value:function enable(){_get$1(_getPrototypeOf$1(SeekBar.prototype),"enable",this).call(this);var o=this.getChild("mouseTimeDisplay");o&&o.show()}},{key:"disable",value:function disable(){_get$1(_getPrototypeOf$1(SeekBar.prototype),"disable",this).call(this);var o=this.getChild("mouseTimeDisplay");o&&o.hide()}},{key:"handleMouseUp",value:function handleMouseUp(o){_get$1(_getPrototypeOf$1(SeekBar.prototype),"handleMouseUp",this).call(this,o),o&&o.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?silencePromise(this.player_.play()):this.update_()}},{key:"stepForward",value:function stepForward(){this.userSeek_(this.player_.currentTime()+5)}},{key:"stepBack",value:function stepBack(){this.userSeek_(this.player_.currentTime()-5)}},{key:"handleAction",value:function handleAction(o){this.player_.paused()?this.player_.play():this.player_.pause()}},{key:"handleKeyDown",value:function handleKeyDown(o){var s=this.player_.liveTracker;if(dH.isEventKey(o,"Space")||dH.isEventKey(o,"Enter"))o.preventDefault(),o.stopPropagation(),this.handleAction(o);else if(dH.isEventKey(o,"Home"))o.preventDefault(),o.stopPropagation(),this.userSeek_(0);else if(dH.isEventKey(o,"End"))o.preventDefault(),o.stopPropagation(),s&&s.isLive()?this.userSeek_(s.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(dH(o))){o.preventDefault(),o.stopPropagation();var m=10*(dH.codes[dH(o)]-dH.codes[0])/100;s&&s.isLive()?this.userSeek_(s.seekableStart()+s.liveWindow()*m):this.userSeek_(this.player_.duration()*m)}else dH.isEventKey(o,"PgDn")?(o.preventDefault(),o.stopPropagation(),this.userSeek_(this.player_.currentTime()-60)):dH.isEventKey(o,"PgUp")?(o.preventDefault(),o.stopPropagation(),this.userSeek_(this.player_.currentTime()+60)):_get$1(_getPrototypeOf$1(SeekBar.prototype),"handleKeyDown",this).call(this,o)}},{key:"dispose",value:function dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in lH&&"visibilityState"in lH&&this.off(lH,"visibilitychange",this.toggleVisibility_),_get$1(_getPrototypeOf$1(SeekBar.prototype),"dispose",this).call(this)}}]),SeekBar}(JY);iQ.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},eX||HG||iQ.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),UX.registerComponent("SeekBar",iQ);var aQ=function(o){_inherits$1(ProgressControl,o);var s=_createSuper$1(ProgressControl);function ProgressControl(o,m){var _;return _classCallCheck$1(this,ProgressControl),(_=s.call(this,o,m)).handleMouseMove=bX(_X(_assertThisInitialized(_),_.handleMouseMove),vX),_.throttledHandleMouseSeek=bX(_X(_assertThisInitialized(_),_.handleMouseSeek),vX),_.handleMouseUpHandler_=function(o){return _.handleMouseUp(o)},_.handleMouseDownHandler_=function(o){return _.handleMouseDown(o)},_.enable(),_}return _createClass$1(ProgressControl,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(ProgressControl.prototype),"createEl",this).call(this,"div",{className:"vjs-progress-control vjs-control"})}},{key:"handleMouseMove",value:function handleMouseMove(o){var s=this.getChild("seekBar");if(s){var m=s.getChild("playProgressBar"),_=s.getChild("mouseTimeDisplay");if(m||_){var S=s.el(),E=findPosition(S),A=getPointerPosition(S,o).x;A=clamp(A,0,1),_&&_.update(E,A),m&&m.update(E,s.getProgress())}}}},{key:"handleMouseSeek",value:function handleMouseSeek(o){var s=this.getChild("seekBar");s&&s.handleMouseMove(o)}},{key:"enabled",value:function enabled(){return this.enabled_}},{key:"disable",value:function disable(){if(this.children().forEach((function(o){return o.disable&&o.disable()})),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){var o=this.getChild("seekBar");this.player_.scrubbing(!1),o.videoWasPlaying&&silencePromise(this.player_.play())}}},{key:"enable",value:function enable(){this.children().forEach((function(o){return o.enable&&o.enable()})),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}},{key:"removeListenersAddedOnMousedownAndTouchstart",value:function removeListenersAddedOnMousedownAndTouchstart(){var o=this.el_.ownerDocument;this.off(o,"mousemove",this.throttledHandleMouseSeek),this.off(o,"touchmove",this.throttledHandleMouseSeek),this.off(o,"mouseup",this.handleMouseUpHandler_),this.off(o,"touchend",this.handleMouseUpHandler_)}},{key:"handleMouseDown",value:function handleMouseDown(o){var s=this.el_.ownerDocument,m=this.getChild("seekBar");m&&m.handleMouseDown(o),this.on(s,"mousemove",this.throttledHandleMouseSeek),this.on(s,"touchmove",this.throttledHandleMouseSeek),this.on(s,"mouseup",this.handleMouseUpHandler_),this.on(s,"touchend",this.handleMouseUpHandler_)}},{key:"handleMouseUp",value:function handleMouseUp(o){var s=this.getChild("seekBar");s&&s.handleMouseUp(o),this.removeListenersAddedOnMousedownAndTouchstart()}}]),ProgressControl}(UX);aQ.prototype.options_={children:["seekBar"]},UX.registerComponent("ProgressControl",aQ);var oQ=function(o){_inherits$1(PictureInPictureToggle,o);var s=_createSuper$1(PictureInPictureToggle);function PictureInPictureToggle(o,m){var _;return _classCallCheck$1(this,PictureInPictureToggle),(_=s.call(this,o,m)).setIcon("picture-in-picture-enter"),_.on(o,["enterpictureinpicture","leavepictureinpicture"],(function(o){return _.handlePictureInPictureChange(o)})),_.on(o,["disablepictureinpicturechanged","loadedmetadata"],(function(o){return _.handlePictureInPictureEnabledChange(o)})),_.on(o,["loadedmetadata","audioonlymodechange","audiopostermodechange"],(function(){return _.handlePictureInPictureAudioModeChange()})),_.disable(),_}return _createClass$1(PictureInPictureToggle,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-picture-in-picture-control vjs-hidden ".concat(_get$1(_getPrototypeOf$1(PictureInPictureToggle.prototype),"buildCSSClass",this).call(this))}},{key:"handlePictureInPictureAudioModeChange",value:function handlePictureInPictureAudioModeChange(){"audio"===this.player_.currentType().substring(0,5)||this.player_.audioPosterMode()||this.player_.audioOnlyMode()?(this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()):this.show()}},{key:"handlePictureInPictureEnabledChange",value:function handlePictureInPictureEnabledChange(){lH.pictureInPictureEnabled&&!1===this.player_.disablePictureInPicture()||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in $V?this.enable():this.disable()}},{key:"handlePictureInPictureChange",value:function handlePictureInPictureChange(o){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}},{key:"handleClick",value:function handleClick(o){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}},{key:"show",value:function show(){"function"==typeof lH.exitPictureInPicture&&_get$1(_getPrototypeOf$1(PictureInPictureToggle.prototype),"show",this).call(this)}}]),PictureInPictureToggle}(jY);oQ.prototype.controlText_="Picture-in-Picture",UX.registerComponent("PictureInPictureToggle",oQ);var sQ=function(o){_inherits$1(FullscreenToggle,o);var s=_createSuper$1(FullscreenToggle);function FullscreenToggle(o,m){var _;return _classCallCheck$1(this,FullscreenToggle),(_=s.call(this,o,m)).setIcon("fullscreen-enter"),_.on(o,"fullscreenchange",(function(o){return _.handleFullscreenChange(o)})),!1===lH[o.fsApi_.fullscreenEnabled]&&_.disable(),_}return _createClass$1(FullscreenToggle,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-fullscreen-control ".concat(_get$1(_getPrototypeOf$1(FullscreenToggle.prototype),"buildCSSClass",this).call(this))}},{key:"handleFullscreenChange",value:function handleFullscreenChange(o){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}},{key:"handleClick",value:function handleClick(o){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}]),FullscreenToggle}(jY);sQ.prototype.controlText_="Fullscreen",UX.registerComponent("FullscreenToggle",sQ);var uQ=function(o){_inherits$1(VolumeLevel,o);var s=_createSuper$1(VolumeLevel);function VolumeLevel(){return _classCallCheck$1(this,VolumeLevel),s.apply(this,arguments)}return _createClass$1(VolumeLevel,[{key:"createEl",value:function createEl(){var o=_get$1(_getPrototypeOf$1(VolumeLevel.prototype),"createEl",this).call(this,"div",{className:"vjs-volume-level"});return this.setIcon("circle",o),o.appendChild(_get$1(_getPrototypeOf$1(VolumeLevel.prototype),"createEl",this).call(this,"span",{className:"vjs-control-text"})),o}}]),VolumeLevel}(UX);UX.registerComponent("VolumeLevel",uQ);var lQ=function(o){_inherits$1(VolumeLevelTooltip,o);var s=_createSuper$1(VolumeLevelTooltip);function VolumeLevelTooltip(o,m){var _;return _classCallCheck$1(this,VolumeLevelTooltip),(_=s.call(this,o,m)).update=bX(_X(_assertThisInitialized(_),_.update),vX),_}return _createClass$1(VolumeLevelTooltip,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(VolumeLevelTooltip.prototype),"createEl",this).call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}},{key:"update",value:function update(o,s,m,_){if(!m){var S=getBoundingClientRect(this.el_),E=getBoundingClientRect(this.player_.el()),A=o.width*s;if(!E||!S)return;var O=o.left-E.left+A,H=o.width-A+(E.right-o.right),K=S.width/2;O<K?K+=K-O:H<K&&(K=H),K<0?K=0:K>S.width&&(K=S.width),this.el_.style.right="-".concat(K,"px")}this.write("".concat(_,"%"))}},{key:"write",value:function write(o){textContent(this.el_,o)}},{key:"updateVolume",value:function updateVolume(o,s,m,_,S){var E=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",(function(){E.update(o,s,m,_.toFixed(0)),S&&S()}))}}]),VolumeLevelTooltip}(UX);UX.registerComponent("VolumeLevelTooltip",lQ);var cQ=function(o){_inherits$1(MouseVolumeLevelDisplay,o);var s=_createSuper$1(MouseVolumeLevelDisplay);function MouseVolumeLevelDisplay(o,m){var _;return _classCallCheck$1(this,MouseVolumeLevelDisplay),(_=s.call(this,o,m)).update=bX(_X(_assertThisInitialized(_),_.update),vX),_}return _createClass$1(MouseVolumeLevelDisplay,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(MouseVolumeLevelDisplay.prototype),"createEl",this).call(this,"div",{className:"vjs-mouse-display"})}},{key:"update",value:function update(o,s,m){var _=this,S=100*s;this.getChild("volumeLevelTooltip").updateVolume(o,s,m,S,(function(){m?_.el_.style.bottom="".concat(o.height*s,"px"):_.el_.style.left="".concat(o.width*s,"px")}))}}]),MouseVolumeLevelDisplay}(UX);cQ.prototype.options_={children:["volumeLevelTooltip"]},UX.registerComponent("MouseVolumeLevelDisplay",cQ);var dQ=function(o){_inherits$1(VolumeBar,o);var s=_createSuper$1(VolumeBar);function VolumeBar(o,m){var _;return _classCallCheck$1(this,VolumeBar),(_=s.call(this,o,m)).on("slideractive",(function(o){return _.updateLastVolume_(o)})),_.on(o,"volumechange",(function(o){return _.updateARIAAttributes(o)})),o.ready((function(){return _.updateARIAAttributes()})),_}return _createClass$1(VolumeBar,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(VolumeBar.prototype),"createEl",this).call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}},{key:"handleMouseDown",value:function handleMouseDown(o){isSingleLeftClick(o)&&_get$1(_getPrototypeOf$1(VolumeBar.prototype),"handleMouseDown",this).call(this,o)}},{key:"handleMouseMove",value:function handleMouseMove(o){var s=this.getChild("mouseVolumeLevelDisplay");if(s){var m=this.el(),_=getBoundingClientRect(m),S=this.vertical(),E=getPointerPosition(m,o);E=clamp(E=S?E.y:E.x,0,1),s.update(_,E,S)}isSingleLeftClick(o)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(o)))}},{key:"checkMuted",value:function checkMuted(){this.player_.muted()&&this.player_.muted(!1)}},{key:"getPercent",value:function getPercent(){return this.player_.muted()?0:this.player_.volume()}},{key:"stepForward",value:function stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}},{key:"stepBack",value:function stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}},{key:"updateARIAAttributes",value:function updateARIAAttributes(o){var s=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",s),this.el_.setAttribute("aria-valuetext",s+"%")}},{key:"volumeAsPercentage_",value:function volumeAsPercentage_(){return Math.round(100*this.player_.volume())}},{key:"updateLastVolume_",value:function updateLastVolume_(){var o=this,s=this.player_.volume();this.one("sliderinactive",(function(){0===o.player_.volume()&&o.player_.lastVolume_(s)}))}}]),VolumeBar}(JY);dQ.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},eX||HG||dQ.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),dQ.prototype.playerEvent="volumechange",UX.registerComponent("VolumeBar",dQ);var hQ=function(o){_inherits$1(VolumeControl,o);var s=_createSuper$1(VolumeControl);function VolumeControl(o){var m,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck$1(this,VolumeControl),_.vertical=_.vertical||!1,(void 0===_.volumeBar||isPlain(_.volumeBar))&&(_.volumeBar=_.volumeBar||{},_.volumeBar.vertical=_.vertical),function checkVolumeSupport(o,s){s.tech_&&!s.tech_.featuresVolumeControl&&o.addClass("vjs-hidden"),o.on(s,"loadstart",(function(){s.tech_.featuresVolumeControl?o.removeClass("vjs-hidden"):o.addClass("vjs-hidden")}))}(_assertThisInitialized(m=s.call(this,o,_)),o),m.throttledHandleMouseMove=bX(_X(_assertThisInitialized(m),m.handleMouseMove),vX),m.handleMouseUpHandler_=function(o){return m.handleMouseUp(o)},m.on("mousedown",(function(o){return m.handleMouseDown(o)})),m.on("touchstart",(function(o){return m.handleMouseDown(o)})),m.on("mousemove",(function(o){return m.handleMouseMove(o)})),m.on(m.volumeBar,["focus","slideractive"],(function(){m.volumeBar.addClass("vjs-slider-active"),m.addClass("vjs-slider-active"),m.trigger("slideractive")})),m.on(m.volumeBar,["blur","sliderinactive"],(function(){m.volumeBar.removeClass("vjs-slider-active"),m.removeClass("vjs-slider-active"),m.trigger("sliderinactive")})),m}return _createClass$1(VolumeControl,[{key:"createEl",value:function createEl(){var o="vjs-volume-horizontal";return this.options_.vertical&&(o="vjs-volume-vertical"),_get$1(_getPrototypeOf$1(VolumeControl.prototype),"createEl",this).call(this,"div",{className:"vjs-volume-control vjs-control ".concat(o)})}},{key:"handleMouseDown",value:function handleMouseDown(o){var s=this.el_.ownerDocument;this.on(s,"mousemove",this.throttledHandleMouseMove),this.on(s,"touchmove",this.throttledHandleMouseMove),this.on(s,"mouseup",this.handleMouseUpHandler_),this.on(s,"touchend",this.handleMouseUpHandler_)}},{key:"handleMouseUp",value:function handleMouseUp(o){var s=this.el_.ownerDocument;this.off(s,"mousemove",this.throttledHandleMouseMove),this.off(s,"touchmove",this.throttledHandleMouseMove),this.off(s,"mouseup",this.handleMouseUpHandler_),this.off(s,"touchend",this.handleMouseUpHandler_)}},{key:"handleMouseMove",value:function handleMouseMove(o){this.volumeBar.handleMouseMove(o)}}]),VolumeControl}(UX);hQ.prototype.options_={children:["volumeBar"]},UX.registerComponent("VolumeControl",hQ);var pQ=function(o){_inherits$1(MuteToggle,o);var s=_createSuper$1(MuteToggle);function MuteToggle(o,m){var _;return _classCallCheck$1(this,MuteToggle),function checkMuteSupport(o,s){s.tech_&&!s.tech_.featuresMuteControl&&o.addClass("vjs-hidden"),o.on(s,"loadstart",(function(){s.tech_.featuresMuteControl?o.removeClass("vjs-hidden"):o.addClass("vjs-hidden")}))}(_assertThisInitialized(_=s.call(this,o,m)),o),_.on(o,["loadstart","volumechange"],(function(o){return _.update(o)})),_}return _createClass$1(MuteToggle,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-mute-control ".concat(_get$1(_getPrototypeOf$1(MuteToggle.prototype),"buildCSSClass",this).call(this))}},{key:"handleClick",value:function handleClick(o){var s=this.player_.volume(),m=this.player_.lastVolume_();if(0===s){var _=m<.1?.1:m;this.player_.volume(_),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}},{key:"update",value:function update(o){this.updateIcon_(),this.updateControlText_()}},{key:"updateIcon_",value:function updateIcon_(){var o=this.player_.volume(),s=3;this.setIcon("volume-high"),eX&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===o||this.player_.muted()?(this.setIcon("volume-mute"),s=0):o<.33?(this.setIcon("volume-low"),s=1):o<.67&&(this.setIcon("volume-medium"),s=2),_removeClass(this.el_,[0,1,2,3].reduce((function(o,s){return o+"".concat(s?" ":"","vjs-vol-").concat(s)}),"")),_addClass(this.el_,"vjs-vol-".concat(s))}},{key:"updateControlText_",value:function updateControlText_(){var o=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==o&&this.controlText(o)}}]),MuteToggle}(jY);pQ.prototype.controlText_="Mute",UX.registerComponent("MuteToggle",pQ);var fQ=function(o){_inherits$1(VolumePanel,o);var s=_createSuper$1(VolumePanel);function VolumePanel(o){var m,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck$1(this,VolumePanel),void 0!==_.inline?_.inline=_.inline:_.inline=!0,(void 0===_.volumeControl||isPlain(_.volumeControl))&&(_.volumeControl=_.volumeControl||{},_.volumeControl.vertical=!_.inline),(m=s.call(this,o,_)).handleKeyPressHandler_=function(o){return m.handleKeyPress(o)},m.on(o,["loadstart"],(function(o){return m.volumePanelState_(o)})),m.on(m.muteToggle,"keyup",(function(o){return m.handleKeyPress(o)})),m.on(m.volumeControl,"keyup",(function(o){return m.handleVolumeControlKeyUp(o)})),m.on("keydown",(function(o){return m.handleKeyPress(o)})),m.on("mouseover",(function(o){return m.handleMouseOver(o)})),m.on("mouseout",(function(o){return m.handleMouseOut(o)})),m.on(m.volumeControl,["slideractive"],m.sliderActive_),m.on(m.volumeControl,["sliderinactive"],m.sliderInactive_),m}return _createClass$1(VolumePanel,[{key:"sliderActive_",value:function sliderActive_(){this.addClass("vjs-slider-active")}},{key:"sliderInactive_",value:function sliderInactive_(){this.removeClass("vjs-slider-active")}},{key:"volumePanelState_",value:function volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}},{key:"createEl",value:function createEl(){var o="vjs-volume-panel-horizontal";return this.options_.inline||(o="vjs-volume-panel-vertical"),_get$1(_getPrototypeOf$1(VolumePanel.prototype),"createEl",this).call(this,"div",{className:"vjs-volume-panel vjs-control ".concat(o)})}},{key:"dispose",value:function dispose(){this.handleMouseOut(),_get$1(_getPrototypeOf$1(VolumePanel.prototype),"dispose",this).call(this)}},{key:"handleVolumeControlKeyUp",value:function handleVolumeControlKeyUp(o){dH.isEventKey(o,"Esc")&&this.muteToggle.focus()}},{key:"handleMouseOver",value:function handleMouseOver(o){this.addClass("vjs-hover"),_on(lH,"keyup",this.handleKeyPressHandler_)}},{key:"handleMouseOut",value:function handleMouseOut(o){this.removeClass("vjs-hover"),_off(lH,"keyup",this.handleKeyPressHandler_)}},{key:"handleKeyPress",value:function handleKeyPress(o){dH.isEventKey(o,"Esc")&&this.handleMouseOut()}}]),VolumePanel}(UX);fQ.prototype.options_={children:["muteToggle","volumeControl"]},UX.registerComponent("VolumePanel",fQ);var gQ=function(o){_inherits$1(SkipForward,o);var s=_createSuper$1(SkipForward);function SkipForward(o,m){var _;return _classCallCheck$1(this,SkipForward),(_=s.call(this,o,m)).validOptions=[5,10,30],_.skipTime=_.getSkipForwardTime(),_.skipTime&&_.validOptions.includes(_.skipTime)?(_.setIcon("forward-".concat(_.skipTime)),_.controlText(_.localize("Skip forward {1} seconds",[_.skipTime])),_.show()):_.hide(),_}return _createClass$1(SkipForward,[{key:"getSkipForwardTime",value:function getSkipForwardTime(){var o=this.options_.playerOptions;return o.controlBar&&o.controlBar.skipButtons&&o.controlBar.skipButtons.forward}},{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-skip-forward-".concat(this.getSkipForwardTime()," ").concat(_get$1(_getPrototypeOf$1(SkipForward.prototype),"buildCSSClass",this).call(this))}},{key:"handleClick",value:function handleClick(o){if(!isNaN(this.player_.duration())){var s,m=this.player_.currentTime(),_=this.player_.liveTracker,S=_&&_.isLive()?_.seekableEnd():this.player_.duration();s=m+this.skipTime<=S?m+this.skipTime:S,this.player_.currentTime(s)}}},{key:"handleLanguagechange",value:function handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}]),SkipForward}(jY);gQ.prototype.controlText_="Skip Forward",UX.registerComponent("SkipForward",gQ);var mQ=function(o){_inherits$1(SkipBackward,o);var s=_createSuper$1(SkipBackward);function SkipBackward(o,m){var _;return _classCallCheck$1(this,SkipBackward),(_=s.call(this,o,m)).validOptions=[5,10,30],_.skipTime=_.getSkipBackwardTime(),_.skipTime&&_.validOptions.includes(_.skipTime)?(_.setIcon("replay-".concat(_.skipTime)),_.controlText(_.localize("Skip backward {1} seconds",[_.skipTime])),_.show()):_.hide(),_}return _createClass$1(SkipBackward,[{key:"getSkipBackwardTime",value:function getSkipBackwardTime(){var o=this.options_.playerOptions;return o.controlBar&&o.controlBar.skipButtons&&o.controlBar.skipButtons.backward}},{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-skip-backward-".concat(this.getSkipBackwardTime()," ").concat(_get$1(_getPrototypeOf$1(SkipBackward.prototype),"buildCSSClass",this).call(this))}},{key:"handleClick",value:function handleClick(o){var s,m=this.player_.currentTime(),_=this.player_.liveTracker,S=_&&_.isLive()&&_.seekableStart();s=S&&m-this.skipTime<=S?S:m>=this.skipTime?m-this.skipTime:0,this.player_.currentTime(s)}},{key:"handleLanguagechange",value:function handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}]),SkipBackward}(jY);mQ.prototype.controlText_="Skip Backward",UX.registerComponent("SkipBackward",mQ);var yQ=function(o){_inherits$1(Menu,o);var s=_createSuper$1(Menu);function Menu(o,m){var _;return _classCallCheck$1(this,Menu),_=s.call(this,o,m),m&&(_.menuButton_=m.menuButton),_.focusedChild_=-1,_.on("keydown",(function(o){return _.handleKeyDown(o)})),_.boundHandleBlur_=function(o){return _.handleBlur(o)},_.boundHandleTapClick_=function(o){return _.handleTapClick(o)},_}return _createClass$1(Menu,[{key:"addEventListenerForItem",value:function addEventListenerForItem(o){o instanceof UX&&(this.on(o,"blur",this.boundHandleBlur_),this.on(o,["tap","click"],this.boundHandleTapClick_))}},{key:"removeEventListenerForItem",value:function removeEventListenerForItem(o){o instanceof UX&&(this.off(o,"blur",this.boundHandleBlur_),this.off(o,["tap","click"],this.boundHandleTapClick_))}},{key:"removeChild",value:function removeChild(o){"string"==typeof o&&(o=this.getChild(o)),this.removeEventListenerForItem(o),_get$1(_getPrototypeOf$1(Menu.prototype),"removeChild",this).call(this,o)}},{key:"addItem",value:function addItem(o){var s=this.addChild(o);s&&this.addEventListenerForItem(s)}},{key:"createEl",value:function createEl(){var o=this.options_.contentElType||"ul";this.contentEl_=_createEl(o,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var s=_get$1(_getPrototypeOf$1(Menu.prototype),"createEl",this).call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return s.appendChild(this.contentEl_),_on(s,"click",(function(o){o.preventDefault(),o.stopImmediatePropagation()})),s}},{key:"dispose",value:function dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,_get$1(_getPrototypeOf$1(Menu.prototype),"dispose",this).call(this)}},{key:"handleBlur",value:function handleBlur(o){var s=o.relatedTarget||lH.activeElement;if(!this.children().some((function(o){return o.el()===s}))){var m=this.menuButton_;m&&m.buttonPressed_&&s!==m.el().firstChild&&m.unpressButton()}}},{key:"handleTapClick",value:function handleTapClick(o){if(this.menuButton_){this.menuButton_.unpressButton();var s=this.children();if(!Array.isArray(s))return;var m=s.filter((function(s){return s.el()===o.target}))[0];if(!m)return;"CaptionSettingsMenuItem"!==m.name()&&this.menuButton_.focus()}}},{key:"handleKeyDown",value:function handleKeyDown(o){dH.isEventKey(o,"Left")||dH.isEventKey(o,"Down")?(o.preventDefault(),o.stopPropagation(),this.stepForward()):(dH.isEventKey(o,"Right")||dH.isEventKey(o,"Up"))&&(o.preventDefault(),o.stopPropagation(),this.stepBack())}},{key:"stepForward",value:function stepForward(){var o=0;void 0!==this.focusedChild_&&(o=this.focusedChild_+1),this.focus(o)}},{key:"stepBack",value:function stepBack(){var o=0;void 0!==this.focusedChild_&&(o=this.focusedChild_-1),this.focus(o)}},{key:"focus",value:function focus(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=this.children().slice();s.length&&s[0].hasClass("vjs-menu-title")&&s.shift(),s.length>0&&(o<0?o=0:o>=s.length&&(o=s.length-1),this.focusedChild_=o,s[o].el_.focus())}}]),Menu}(UX);UX.registerComponent("Menu",yQ);var vQ=function(o){_inherits$1(MenuButton,o);var s=_createSuper$1(MenuButton);function MenuButton(o){var m,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck$1(this,MenuButton),(m=s.call(this,o,_)).menuButton_=new jY(o,_),m.menuButton_.controlText(m.controlText_),m.menuButton_.el_.setAttribute("aria-haspopup","true");var S=jY.prototype.buildCSSClass();m.menuButton_.el_.className=m.buildCSSClass()+" "+S,m.menuButton_.removeClass("vjs-control"),m.addChild(m.menuButton_),m.update(),m.enabled_=!0;var E=function handleClick(o){return m.handleClick(o)};return m.handleMenuKeyUp_=function(o){return m.handleMenuKeyUp(o)},m.on(m.menuButton_,"tap",E),m.on(m.menuButton_,"click",E),m.on(m.menuButton_,"keydown",(function(o){return m.handleKeyDown(o)})),m.on(m.menuButton_,"mouseenter",(function(){m.addClass("vjs-hover"),m.menu.show(),_on(lH,"keyup",m.handleMenuKeyUp_)})),m.on("mouseleave",(function(o){return m.handleMouseLeave(o)})),m.on("keydown",(function(o){return m.handleSubmenuKeyDown(o)})),m}return _createClass$1(MenuButton,[{key:"update",value:function update(){var o=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=o,this.addChild(o),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}},{key:"createMenu",value:function createMenu(){var o=new yQ(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var s=_createEl("li",{className:"vjs-menu-title",textContent:MX(this.options_.title),tabIndex:-1}),m=new UX(this.player_,{el:s});o.addItem(m)}if(this.items=this.createItems(),this.items)for(var _=0;_<this.items.length;_++)o.addItem(this.items[_]);return o}},{key:"createItems",value:function createItems(){}},{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(MenuButton.prototype),"createEl",this).call(this,"div",{className:this.buildWrapperCSSClass()},{})}},{key:"setIcon",value:function setIcon(o){_get$1(_getPrototypeOf$1(MenuButton.prototype),"setIcon",this).call(this,o,this.menuButton_.el_)}},{key:"buildWrapperCSSClass",value:function buildWrapperCSSClass(){var o="vjs-menu-button";!0===this.options_.inline?o+="-inline":o+="-popup";var s=jY.prototype.buildCSSClass();return"vjs-menu-button ".concat(o," ").concat(s," ").concat(_get$1(_getPrototypeOf$1(MenuButton.prototype),"buildCSSClass",this).call(this))}},{key:"buildCSSClass",value:function buildCSSClass(){var o="vjs-menu-button";return!0===this.options_.inline?o+="-inline":o+="-popup","vjs-menu-button ".concat(o," ").concat(_get$1(_getPrototypeOf$1(MenuButton.prototype),"buildCSSClass",this).call(this))}},{key:"controlText",value:function controlText(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.menuButton_.el();return this.menuButton_.controlText(o,s)}},{key:"dispose",value:function dispose(){this.handleMouseLeave(),_get$1(_getPrototypeOf$1(MenuButton.prototype),"dispose",this).call(this)}},{key:"handleClick",value:function handleClick(o){this.buttonPressed_?this.unpressButton():this.pressButton()}},{key:"handleMouseLeave",value:function handleMouseLeave(o){this.removeClass("vjs-hover"),_off(lH,"keyup",this.handleMenuKeyUp_)}},{key:"focus",value:function focus(){this.menuButton_.focus()}},{key:"blur",value:function blur(){this.menuButton_.blur()}},{key:"handleKeyDown",value:function handleKeyDown(o){dH.isEventKey(o,"Esc")||dH.isEventKey(o,"Tab")?(this.buttonPressed_&&this.unpressButton(),dH.isEventKey(o,"Tab")||(o.preventDefault(),this.menuButton_.focus())):(dH.isEventKey(o,"Up")||dH.isEventKey(o,"Down"))&&(this.buttonPressed_||(o.preventDefault(),this.pressButton()))}},{key:"handleMenuKeyUp",value:function handleMenuKeyUp(o){(dH.isEventKey(o,"Esc")||dH.isEventKey(o,"Tab"))&&this.removeClass("vjs-hover")}},{key:"handleSubmenuKeyPress",value:function handleSubmenuKeyPress(o){this.handleSubmenuKeyDown(o)}},{key:"handleSubmenuKeyDown",value:function handleSubmenuKeyDown(o){(dH.isEventKey(o,"Esc")||dH.isEventKey(o,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),dH.isEventKey(o,"Tab")||(o.preventDefault(),this.menuButton_.focus()))}},{key:"pressButton",value:function pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),eX&&isInFrame())return;this.menu.focus()}}},{key:"unpressButton",value:function unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}},{key:"disable",value:function disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}},{key:"enable",value:function enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}]),MenuButton}(UX);UX.registerComponent("MenuButton",vQ);var _Q=function(o){_inherits$1(TrackButton,o);var s=_createSuper$1(TrackButton);function TrackButton(o,m){var _;_classCallCheck$1(this,TrackButton);var S=m.tracks;if((_=s.call(this,o,m)).items.length<=1&&_.hide(),!S)return _possibleConstructorReturn(_);var E=_X(_assertThisInitialized(_),_.update);return S.addEventListener("removetrack",E),S.addEventListener("addtrack",E),S.addEventListener("labelchange",E),_.player_.on("ready",E),_.player_.on("dispose",(function(){S.removeEventListener("removetrack",E),S.removeEventListener("addtrack",E),S.removeEventListener("labelchange",E)})),_}return _createClass$1(TrackButton)}(vQ);UX.registerComponent("TrackButton",_Q);var bQ=["Tab","Esc","Up","Down","Right","Left"],SQ=function(o){_inherits$1(MenuItem,o);var s=_createSuper$1(MenuItem);function MenuItem(o,m){var _;return _classCallCheck$1(this,MenuItem),(_=s.call(this,o,m)).selectable=m.selectable,_.isSelected_=m.selected||!1,_.multiSelectable=m.multiSelectable,_.selected(_.isSelected_),_.selectable?_.multiSelectable?_.el_.setAttribute("role","menuitemcheckbox"):_.el_.setAttribute("role","menuitemradio"):_.el_.setAttribute("role","menuitem"),_}return _createClass$1(MenuItem,[{key:"createEl",value:function createEl(o,s,m){this.nonIconControl=!0;var _=_get$1(_getPrototypeOf$1(MenuItem.prototype),"createEl",this).call(this,"li",Object.assign({className:"vjs-menu-item",tabIndex:-1},s),m),S=_createEl("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?_.appendChild(S):_.replaceChild(S,_.querySelector(".vjs-icon-placeholder")),_}},{key:"handleKeyDown",value:function handleKeyDown(o){bQ.some((function(s){return dH.isEventKey(o,s)}))||_get$1(_getPrototypeOf$1(MenuItem.prototype),"handleKeyDown",this).call(this,o)}},{key:"handleClick",value:function handleClick(o){this.selected(!0)}},{key:"selected",value:function selected(o){this.selectable&&(o?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}]),MenuItem}(RY);UX.registerComponent("MenuItem",SQ);var TQ=function(o){_inherits$1(TextTrackMenuItem,o);var s=_createSuper$1(TextTrackMenuItem);function TextTrackMenuItem(o,m){var _;_classCallCheck$1(this,TextTrackMenuItem);var S=m.track,E=o.textTracks();m.label=S.label||S.language||"Unknown",m.selected="showing"===S.mode,(_=s.call(this,o,m)).track=S,_.kinds=(m.kinds||[m.kind||_.track.kind]).filter(Boolean);var A,O=function changeHandler(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];_.handleTracksChange.apply(_assertThisInitialized(_),s)},H=function selectedLanguageChangeHandler(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];_.handleSelectedLanguageChange.apply(_assertThisInitialized(_),s)};(o.on(["loadstart","texttrackchange"],O),E.addEventListener("change",O),E.addEventListener("selectedlanguagechange",H),_.on("dispose",(function(){o.off(["loadstart","texttrackchange"],O),E.removeEventListener("change",O),E.removeEventListener("selectedlanguagechange",H)})),void 0===E.onchange)&&_.on(["tap","click"],(function(){if("object"!=typeof $V.Event)try{A=new $V.Event("change")}catch(o){}A||(A=lH.createEvent("Event")).initEvent("change",!0,!0),E.dispatchEvent(A)}));return _.handleTracksChange(),_}return _createClass$1(TextTrackMenuItem,[{key:"handleClick",value:function handleClick(o){var s=this.track,m=this.player_.textTracks();if(_get$1(_getPrototypeOf$1(TextTrackMenuItem.prototype),"handleClick",this).call(this,o),m)for(var _=0;_<m.length;_++){var S=m[_];-1!==this.kinds.indexOf(S.kind)&&(S===s?"showing"!==S.mode&&(S.mode="showing"):"disabled"!==S.mode&&(S.mode="disabled"))}}},{key:"handleTracksChange",value:function handleTracksChange(o){var s="showing"===this.track.mode;s!==this.isSelected_&&this.selected(s)}},{key:"handleSelectedLanguageChange",value:function handleSelectedLanguageChange(o){if("showing"===this.track.mode){var s=this.player_.cache_.selectedLanguage;if(s&&s.enabled&&s.language===this.track.language&&s.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}},{key:"dispose",value:function dispose(){this.track=null,_get$1(_getPrototypeOf$1(TextTrackMenuItem.prototype),"dispose",this).call(this)}}]),TextTrackMenuItem}(SQ);UX.registerComponent("TextTrackMenuItem",TQ);var kQ=function(o){_inherits$1(OffTextTrackMenuItem,o);var s=_createSuper$1(OffTextTrackMenuItem);function OffTextTrackMenuItem(o,m){return _classCallCheck$1(this,OffTextTrackMenuItem),m.track={player:o,kind:m.kind,kinds:m.kinds,default:!1,mode:"disabled"},m.kinds||(m.kinds=[m.kind]),m.label?m.track.label=m.label:m.track.label=m.kinds.join(" and ")+" off",m.selectable=!0,m.multiSelectable=!1,s.call(this,o,m)}return _createClass$1(OffTextTrackMenuItem,[{key:"handleTracksChange",value:function handleTracksChange(o){for(var s=this.player().textTracks(),m=!0,_=0,S=s.length;_<S;_++){var E=s[_];if(this.options_.kinds.indexOf(E.kind)>-1&&"showing"===E.mode){m=!1;break}}m!==this.isSelected_&&this.selected(m)}},{key:"handleSelectedLanguageChange",value:function handleSelectedLanguageChange(o){for(var s=this.player().textTracks(),m=!0,_=0,S=s.length;_<S;_++){var E=s[_];if(["captions","descriptions","subtitles"].indexOf(E.kind)>-1&&"showing"===E.mode){m=!1;break}}m&&(this.player_.cache_.selectedLanguage={enabled:!1})}},{key:"handleLanguagechange",value:function handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),_get$1(_getPrototypeOf$1(OffTextTrackMenuItem.prototype),"handleLanguagechange",this).call(this)}}]),OffTextTrackMenuItem}(TQ);UX.registerComponent("OffTextTrackMenuItem",kQ);var CQ=function(o){_inherits$1(TextTrackButton,o);var s=_createSuper$1(TextTrackButton);function TextTrackButton(o){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck$1(this,TextTrackButton),m.tracks=o.textTracks(),s.call(this,o,m)}return _createClass$1(TextTrackButton,[{key:"createItems",value:function createItems(){var o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:TQ;this.label_&&(o="".concat(this.label_," off")),s.push(new kQ(this.player_,{kinds:this.kinds_,kind:this.kind_,label:o})),this.hideThreshold_+=1;var _=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var S=0;S<_.length;S++){var E=_[S];if(this.kinds_.indexOf(E.kind)>-1){var A=new m(this.player_,{track:E,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});A.addClass("vjs-".concat(E.kind,"-menu-item")),s.push(A)}}return s}}]),TextTrackButton}(_Q);UX.registerComponent("TextTrackButton",CQ);var wQ=function(o){_inherits$1(ChaptersTrackMenuItem,o);var s=_createSuper$1(ChaptersTrackMenuItem);function ChaptersTrackMenuItem(o,m){var _;_classCallCheck$1(this,ChaptersTrackMenuItem);var S=m.track,E=m.cue,A=o.currentTime();return m.selectable=!0,m.multiSelectable=!1,m.label=E.text,m.selected=E.startTime<=A&&A<E.endTime,(_=s.call(this,o,m)).track=S,_.cue=E,_}return _createClass$1(ChaptersTrackMenuItem,[{key:"handleClick",value:function handleClick(o){_get$1(_getPrototypeOf$1(ChaptersTrackMenuItem.prototype),"handleClick",this).call(this),this.player_.currentTime(this.cue.startTime)}}]),ChaptersTrackMenuItem}(SQ);UX.registerComponent("ChaptersTrackMenuItem",wQ);var xQ=function(o){_inherits$1(ChaptersButton,o);var s=_createSuper$1(ChaptersButton);function ChaptersButton(o,m,_){var S;return _classCallCheck$1(this,ChaptersButton),(S=s.call(this,o,m,_)).setIcon("chapters"),S.selectCurrentItem_=function(){S.items.forEach((function(o){o.selected(S.track_.activeCues[0]===o.cue)}))},S}return _createClass$1(ChaptersButton,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-chapters-button ".concat(_get$1(_getPrototypeOf$1(ChaptersButton.prototype),"buildCSSClass",this).call(this))}},{key:"buildWrapperCSSClass",value:function buildWrapperCSSClass(){return"vjs-chapters-button ".concat(_get$1(_getPrototypeOf$1(ChaptersButton.prototype),"buildWrapperCSSClass",this).call(this))}},{key:"update",value:function update(o){if(!o||!o.track||"chapters"===o.track.kind){var s=this.findChaptersTrack();s!==this.track_?(this.setTrack(s),_get$1(_getPrototypeOf$1(ChaptersButton.prototype),"update",this).call(this)):(!this.items||s&&s.cues&&s.cues.length!==this.items.length)&&_get$1(_getPrototypeOf$1(ChaptersButton.prototype),"update",this).call(this)}}},{key:"setTrack",value:function setTrack(o){if(this.track_!==o){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var s=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);s&&s.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=o,this.track_){this.track_.mode="hidden";var m=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);m&&m.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}},{key:"findChaptersTrack",value:function findChaptersTrack(){for(var o=this.player_.textTracks()||[],s=o.length-1;s>=0;s--){var m=o[s];if(m.kind===this.kind_)return m}}},{key:"getMenuCaption",value:function getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(MX(this.kind_))}},{key:"createMenu",value:function createMenu(){return this.options_.title=this.getMenuCaption(),_get$1(_getPrototypeOf$1(ChaptersButton.prototype),"createMenu",this).call(this)}},{key:"createItems",value:function createItems(){var o=[];if(!this.track_)return o;var s=this.track_.cues;if(!s)return o;for(var m=0,_=s.length;m<_;m++){var S=s[m],E=new wQ(this.player_,{track:this.track_,cue:S});o.push(E)}return o}}]),ChaptersButton}(CQ);xQ.prototype.kind_="chapters",xQ.prototype.controlText_="Chapters",UX.registerComponent("ChaptersButton",xQ);var EQ=function(o){_inherits$1(DescriptionsButton,o);var s=_createSuper$1(DescriptionsButton);function DescriptionsButton(o,m,_){var S;_classCallCheck$1(this,DescriptionsButton),(S=s.call(this,o,m,_)).setIcon("audio-description");var E=o.textTracks(),A=_X(_assertThisInitialized(S),S.handleTracksChange);return E.addEventListener("change",A),S.on("dispose",(function(){E.removeEventListener("change",A)})),S}return _createClass$1(DescriptionsButton,[{key:"handleTracksChange",value:function handleTracksChange(o){for(var s=this.player().textTracks(),m=!1,_=0,S=s.length;_<S;_++){var E=s[_];if(E.kind!==this.kind_&&"showing"===E.mode){m=!0;break}}m?this.disable():this.enable()}},{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-descriptions-button ".concat(_get$1(_getPrototypeOf$1(DescriptionsButton.prototype),"buildCSSClass",this).call(this))}},{key:"buildWrapperCSSClass",value:function buildWrapperCSSClass(){return"vjs-descriptions-button ".concat(_get$1(_getPrototypeOf$1(DescriptionsButton.prototype),"buildWrapperCSSClass",this).call(this))}}]),DescriptionsButton}(CQ);EQ.prototype.kind_="descriptions",EQ.prototype.controlText_="Descriptions",UX.registerComponent("DescriptionsButton",EQ);var IQ=function(o){_inherits$1(SubtitlesButton,o);var s=_createSuper$1(SubtitlesButton);function SubtitlesButton(o,m,_){var S;return _classCallCheck$1(this,SubtitlesButton),(S=s.call(this,o,m,_)).setIcon("subtitles"),S}return _createClass$1(SubtitlesButton,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-subtitles-button ".concat(_get$1(_getPrototypeOf$1(SubtitlesButton.prototype),"buildCSSClass",this).call(this))}},{key:"buildWrapperCSSClass",value:function buildWrapperCSSClass(){return"vjs-subtitles-button ".concat(_get$1(_getPrototypeOf$1(SubtitlesButton.prototype),"buildWrapperCSSClass",this).call(this))}}]),SubtitlesButton}(CQ);IQ.prototype.kind_="subtitles",IQ.prototype.controlText_="Subtitles",UX.registerComponent("SubtitlesButton",IQ);var AQ=function(o){_inherits$1(CaptionSettingsMenuItem,o);var s=_createSuper$1(CaptionSettingsMenuItem);function CaptionSettingsMenuItem(o,m){var _;return _classCallCheck$1(this,CaptionSettingsMenuItem),m.track={player:o,kind:m.kind,label:m.kind+" settings",selectable:!1,default:!1,mode:"disabled"},m.selectable=!1,m.name="CaptionSettingsMenuItem",(_=s.call(this,o,m)).addClass("vjs-texttrack-settings"),_.controlText(", opens "+m.kind+" settings dialog"),_}return _createClass$1(CaptionSettingsMenuItem,[{key:"handleClick",value:function handleClick(o){this.player().getChild("textTrackSettings").open()}},{key:"handleLanguagechange",value:function handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),_get$1(_getPrototypeOf$1(CaptionSettingsMenuItem.prototype),"handleLanguagechange",this).call(this)}}]),CaptionSettingsMenuItem}(TQ);UX.registerComponent("CaptionSettingsMenuItem",AQ);var PQ=function(o){_inherits$1(CaptionsButton,o);var s=_createSuper$1(CaptionsButton);function CaptionsButton(o,m,_){var S;return _classCallCheck$1(this,CaptionsButton),(S=s.call(this,o,m,_)).setIcon("captions"),S}return _createClass$1(CaptionsButton,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-captions-button ".concat(_get$1(_getPrototypeOf$1(CaptionsButton.prototype),"buildCSSClass",this).call(this))}},{key:"buildWrapperCSSClass",value:function buildWrapperCSSClass(){return"vjs-captions-button ".concat(_get$1(_getPrototypeOf$1(CaptionsButton.prototype),"buildWrapperCSSClass",this).call(this))}},{key:"createItems",value:function createItems(){var o=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(o.push(new AQ(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),_get$1(_getPrototypeOf$1(CaptionsButton.prototype),"createItems",this).call(this,o)}}]),CaptionsButton}(CQ);PQ.prototype.kind_="captions",PQ.prototype.controlText_="Captions",UX.registerComponent("CaptionsButton",PQ);var LQ=function(o){_inherits$1(SubsCapsMenuItem,o);var s=_createSuper$1(SubsCapsMenuItem);function SubsCapsMenuItem(){return _classCallCheck$1(this,SubsCapsMenuItem),s.apply(this,arguments)}return _createClass$1(SubsCapsMenuItem,[{key:"createEl",value:function createEl(o,s,m){var _=_get$1(_getPrototypeOf$1(SubsCapsMenuItem.prototype),"createEl",this).call(this,o,s,m),S=_.querySelector(".vjs-menu-item-text");return"captions"===this.options_.track.kind&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",_):S.appendChild(_createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),S.appendChild(_createEl("span",{className:"vjs-control-text",textContent:" ".concat(this.localize("Captions"))}))),_}}]),SubsCapsMenuItem}(TQ);UX.registerComponent("SubsCapsMenuItem",LQ);var DQ=function(o){_inherits$1(SubsCapsButton,o);var s=_createSuper$1(SubsCapsButton);function SubsCapsButton(o){var m,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck$1(this,SubsCapsButton),(m=s.call(this,o,_)).label_="subtitles",m.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(m.player_.language_)>-1&&(m.label_="captions",m.setIcon("captions")),m.menuButton_.controlText(MX(m.label_)),m}return _createClass$1(SubsCapsButton,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-subs-caps-button ".concat(_get$1(_getPrototypeOf$1(SubsCapsButton.prototype),"buildCSSClass",this).call(this))}},{key:"buildWrapperCSSClass",value:function buildWrapperCSSClass(){return"vjs-subs-caps-button ".concat(_get$1(_getPrototypeOf$1(SubsCapsButton.prototype),"buildWrapperCSSClass",this).call(this))}},{key:"createItems",value:function createItems(){var o=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(o.push(new AQ(this.player_,{kind:this.label_})),this.hideThreshold_+=1),o=_get$1(_getPrototypeOf$1(SubsCapsButton.prototype),"createItems",this).call(this,o,LQ)}}]),SubsCapsButton}(CQ);DQ.prototype.kinds_=["captions","subtitles"],DQ.prototype.controlText_="Subtitles",UX.registerComponent("SubsCapsButton",DQ);var RQ=function(o){_inherits$1(AudioTrackMenuItem,o);var s=_createSuper$1(AudioTrackMenuItem);function AudioTrackMenuItem(o,m){var _;_classCallCheck$1(this,AudioTrackMenuItem);var S=m.track,E=o.audioTracks();m.label=S.label||S.language||"Unknown",m.selected=S.enabled,(_=s.call(this,o,m)).track=S,_.addClass("vjs-".concat(S.kind,"-menu-item"));var A=function changeHandler(){for(var o=arguments.length,s=new Array(o),m=0;m<o;m++)s[m]=arguments[m];_.handleTracksChange.apply(_assertThisInitialized(_),s)};return E.addEventListener("change",A),_.on("dispose",(function(){E.removeEventListener("change",A)})),_}return _createClass$1(AudioTrackMenuItem,[{key:"createEl",value:function createEl(o,s,m){var _=_get$1(_getPrototypeOf$1(AudioTrackMenuItem.prototype),"createEl",this).call(this,o,s,m),S=_.querySelector(".vjs-menu-item-text");return["main-desc","description"].indexOf(this.options_.track.kind)>=0&&(S.appendChild(_createEl("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),S.appendChild(_createEl("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),_}},{key:"handleClick",value:function handleClick(o){if(_get$1(_getPrototypeOf$1(AudioTrackMenuItem.prototype),"handleClick",this).call(this,o),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks)for(var s=this.player_.audioTracks(),m=0;m<s.length;m++){var _=s[m];_!==this.track&&(_.enabled=_===this.track)}}},{key:"handleTracksChange",value:function handleTracksChange(o){this.selected(this.track.enabled)}}]),AudioTrackMenuItem}(SQ);UX.registerComponent("AudioTrackMenuItem",RQ);var OQ=function(o){_inherits$1(AudioTrackButton,o);var s=_createSuper$1(AudioTrackButton);function AudioTrackButton(o){var m,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck$1(this,AudioTrackButton),_.tracks=o.audioTracks(),(m=s.call(this,o,_)).setIcon("audio"),m}return _createClass$1(AudioTrackButton,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-audio-button ".concat(_get$1(_getPrototypeOf$1(AudioTrackButton.prototype),"buildCSSClass",this).call(this))}},{key:"buildWrapperCSSClass",value:function buildWrapperCSSClass(){return"vjs-audio-button ".concat(_get$1(_getPrototypeOf$1(AudioTrackButton.prototype),"buildWrapperCSSClass",this).call(this))}},{key:"createItems",value:function createItems(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.hideThreshold_=1;for(var s=this.player_.audioTracks(),m=0;m<s.length;m++){var _=s[m];o.push(new RQ(this.player_,{track:_,selectable:!0,multiSelectable:!1}))}return o}}]),AudioTrackButton}(_Q);OQ.prototype.controlText_="Audio Track",UX.registerComponent("AudioTrackButton",OQ);var MQ=function(o){_inherits$1(PlaybackRateMenuItem,o);var s=_createSuper$1(PlaybackRateMenuItem);function PlaybackRateMenuItem(o,m){var _;_classCallCheck$1(this,PlaybackRateMenuItem);var S=m.rate,E=parseFloat(S,10);return m.label=S,m.selected=E===o.playbackRate(),m.selectable=!0,m.multiSelectable=!1,(_=s.call(this,o,m)).label=S,_.rate=E,_.on(o,"ratechange",(function(o){return _.update(o)})),_}return _createClass$1(PlaybackRateMenuItem,[{key:"handleClick",value:function handleClick(o){_get$1(_getPrototypeOf$1(PlaybackRateMenuItem.prototype),"handleClick",this).call(this),this.player().playbackRate(this.rate)}},{key:"update",value:function update(o){this.selected(this.player().playbackRate()===this.rate)}}]),PlaybackRateMenuItem}(SQ);MQ.prototype.contentElType="button",UX.registerComponent("PlaybackRateMenuItem",MQ);var FQ=function(o){_inherits$1(PlaybackRateMenuButton,o);var s=_createSuper$1(PlaybackRateMenuButton);function PlaybackRateMenuButton(o,m){var _;return _classCallCheck$1(this,PlaybackRateMenuButton),(_=s.call(this,o,m)).menuButton_.el_.setAttribute("aria-describedby",_.labelElId_),_.updateVisibility(),_.updateLabel(),_.on(o,"loadstart",(function(o){return _.updateVisibility(o)})),_.on(o,"ratechange",(function(o){return _.updateLabel(o)})),_.on(o,"playbackrateschange",(function(o){return _.handlePlaybackRateschange(o)})),_}return _createClass$1(PlaybackRateMenuButton,[{key:"createEl",value:function createEl(){var o=_get$1(_getPrototypeOf$1(PlaybackRateMenuButton.prototype),"createEl",this).call(this);return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=_createEl("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),o.appendChild(this.labelEl_),o}},{key:"dispose",value:function dispose(){this.labelEl_=null,_get$1(_getPrototypeOf$1(PlaybackRateMenuButton.prototype),"dispose",this).call(this)}},{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-playback-rate ".concat(_get$1(_getPrototypeOf$1(PlaybackRateMenuButton.prototype),"buildCSSClass",this).call(this))}},{key:"buildWrapperCSSClass",value:function buildWrapperCSSClass(){return"vjs-playback-rate ".concat(_get$1(_getPrototypeOf$1(PlaybackRateMenuButton.prototype),"buildWrapperCSSClass",this).call(this))}},{key:"createItems",value:function createItems(){for(var o=this.playbackRates(),s=[],m=o.length-1;m>=0;m--)s.push(new MQ(this.player(),{rate:o[m]+"x"}));return s}},{key:"handlePlaybackRateschange",value:function handlePlaybackRateschange(o){this.update()}},{key:"playbackRates",value:function playbackRates(){var o=this.player();return o.playbackRates&&o.playbackRates()||[]}},{key:"playbackRateSupported",value:function playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}},{key:"updateVisibility",value:function updateVisibility(o){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}},{key:"updateLabel",value:function updateLabel(o){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}]),PlaybackRateMenuButton}(vQ);FQ.prototype.controlText_="Playback Rate",UX.registerComponent("PlaybackRateMenuButton",FQ);var NQ=function(o){_inherits$1(Spacer,o);var s=_createSuper$1(Spacer);function Spacer(){return _classCallCheck$1(this,Spacer),s.apply(this,arguments)}return _createClass$1(Spacer,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-spacer ".concat(_get$1(_getPrototypeOf$1(Spacer.prototype),"buildCSSClass",this).call(this))}},{key:"createEl",value:function createEl(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.className||(s.className=this.buildCSSClass()),_get$1(_getPrototypeOf$1(Spacer.prototype),"createEl",this).call(this,o,s,m)}}]),Spacer}(UX);UX.registerComponent("Spacer",NQ);var UQ=function(o){_inherits$1(CustomControlSpacer,o);var s=_createSuper$1(CustomControlSpacer);function CustomControlSpacer(){return _classCallCheck$1(this,CustomControlSpacer),s.apply(this,arguments)}return _createClass$1(CustomControlSpacer,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-custom-control-spacer ".concat(_get$1(_getPrototypeOf$1(CustomControlSpacer.prototype),"buildCSSClass",this).call(this))}},{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(CustomControlSpacer.prototype),"createEl",this).call(this,"div",{className:this.buildCSSClass(),textContent:" "})}}]),CustomControlSpacer}(NQ);UX.registerComponent("CustomControlSpacer",UQ);var BQ=function(o){_inherits$1(ControlBar,o);var s=_createSuper$1(ControlBar);function ControlBar(){return _classCallCheck$1(this,ControlBar),s.apply(this,arguments)}return _createClass$1(ControlBar,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(ControlBar.prototype),"createEl",this).call(this,"div",{className:"vjs-control-bar",dir:"ltr"})}}]),ControlBar}(UX);BQ.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},UX.registerComponent("ControlBar",BQ);var jQ=function(o){_inherits$1(ErrorDisplay,o);var s=_createSuper$1(ErrorDisplay);function ErrorDisplay(o,m){var _;return _classCallCheck$1(this,ErrorDisplay),(_=s.call(this,o,m)).on(o,"error",(function(o){_.close(),_.open(o)})),_}return _createClass$1(ErrorDisplay,[{key:"buildCSSClass",value:function buildCSSClass(){return"vjs-error-display ".concat(_get$1(_getPrototypeOf$1(ErrorDisplay.prototype),"buildCSSClass",this).call(this))}},{key:"content",value:function content(){var o=this.player().error();return o?this.localize(o.message):""}}]),ErrorDisplay}(GX);jQ.prototype.options_=Object.assign({},GX.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),UX.registerComponent("ErrorDisplay",jQ);var $Q="vjs-text-track-settings",VQ=["#000","Black"],HQ=["#00F","Blue"],KQ=["#0FF","Cyan"],zQ=["#0F0","Green"],WQ=["#F0F","Magenta"],GQ=["#F00","Red"],qQ=["#FFF","White"],XQ=["#FF0","Yellow"],YQ=["1","Opaque"],QQ=["0.5","Semi-Transparent"],JQ=["0","Transparent"],ZQ={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[VQ,qQ,GQ,zQ,HQ,XQ,WQ,KQ]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[YQ,QQ,JQ]},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[qQ,VQ,GQ,zQ,HQ,XQ,WQ,KQ]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function parser(o){return"1.00"===o?null:Number(o)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[YQ,QQ]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[JQ,QQ,YQ]}};function parseOptionValue(o,s){if(s&&(o=s(o)),o&&"none"!==o)return o}ZQ.windowColor.options=ZQ.backgroundColor.options;var eJ=function(o){_inherits$1(TextTrackSettings,o);var s=_createSuper$1(TextTrackSettings);function TextTrackSettings(o,m){var _;return _classCallCheck$1(this,TextTrackSettings),m.temporary=!1,(_=s.call(this,o,m)).updateDisplay=_.updateDisplay.bind(_assertThisInitialized(_)),_.fill(),_.hasBeenOpened_=_.hasBeenFilled_=!0,_.endDialog=_createEl("p",{className:"vjs-control-text",textContent:_.localize("End of dialog window.")}),_.el().appendChild(_.endDialog),_.setDefaults(),void 0===m.persistTextTrackSettings&&(_.options_.persistTextTrackSettings=_.options_.playerOptions.persistTextTrackSettings),_.on(_.$(".vjs-done-button"),"click",(function(){_.saveSettings(),_.close()})),_.on(_.$(".vjs-default-button"),"click",(function(){_.setDefaults(),_.updateDisplay()})),each(ZQ,(function(o){_.on(_.$(o.selector),"change",_.updateDisplay)})),_.options_.persistTextTrackSettings&&_.restoreSettings(),_}return _createClass$1(TextTrackSettings,[{key:"dispose",value:function dispose(){this.endDialog=null,_get$1(_getPrototypeOf$1(TextTrackSettings.prototype),"dispose",this).call(this)}},{key:"createElSelect_",value:function createElSelect_(o){var s=this,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",_=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label",S=ZQ[o],E=S.id.replace("%s",this.id_),A=[m,E].join(" ").trim(),O="vjs_select_".concat(newGUID());return["<".concat(_,' id="').concat(E,'"').concat("label"===_?' for="'.concat(O,'" class="vjs-label"'):"",">"),this.localize(S.label),"</".concat(_,">"),'<select aria-labelledby="'.concat(A,'" id="').concat(O,'">')].concat(S.options.map((function(o){var m=E+"-"+o[1].replace(/\W+/g,"");return['<option id="'.concat(m,'" value="').concat(o[0],'" '),'aria-labelledby="'.concat(A," ").concat(m,'">'),s.localize(o[1]),"</option>"].join("")}))).concat("</select>").join("")}},{key:"createElFgColor_",value:function createElFgColor_(){var o="captions-text-legend-".concat(this.id_);return['<fieldset class="vjs-fg vjs-track-setting">','<legend id="'.concat(o,'">'),this.localize("Text"),"</legend>",'<span class="vjs-text-color">',this.createElSelect_("color",o),"</span>",'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",o),"</span>","</fieldset>"].join("")}},{key:"createElBgColor_",value:function createElBgColor_(){var o="captions-background-".concat(this.id_);return['<fieldset class="vjs-bg vjs-track-setting">','<legend id="'.concat(o,'">'),this.localize("Text Background"),"</legend>",'<span class="vjs-bg-color">',this.createElSelect_("backgroundColor",o),"</span>",'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",o),"</span>","</fieldset>"].join("")}},{key:"createElWinColor_",value:function createElWinColor_(){var o="captions-window-".concat(this.id_);return['<fieldset class="vjs-window vjs-track-setting">','<legend id="'.concat(o,'">'),this.localize("Caption Area Background"),"</legend>",'<span class="vjs-window-color">',this.createElSelect_("windowColor",o),"</span>",'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",o),"</span>","</fieldset>"].join("")}},{key:"createElColors_",value:function createElColors_(){return _createEl("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}},{key:"createElFont_",value:function createElFont_(){return _createEl("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}},{key:"createElControls_",value:function createElControls_(){var o=this.localize("restore all settings to the default values");return _createEl("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'.concat(o,'">'),this.localize("Reset"),'<span class="vjs-control-text"> '.concat(o,"</span>"),"</button>",'<button type="button" class="vjs-done-button">'.concat(this.localize("Done"),"</button>")].join("")})}},{key:"content",value:function content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}},{key:"label",value:function label(){return this.localize("Caption Settings Dialog")}},{key:"description",value:function description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}},{key:"buildCSSClass",value:function buildCSSClass(){return _get$1(_getPrototypeOf$1(TextTrackSettings.prototype),"buildCSSClass",this).call(this)+" vjs-text-track-settings"}},{key:"getValues",value:function getValues(){var o=this;return reduce(ZQ,(function(s,m,_){var S=function getSelectedOptionValue(o,s){return parseOptionValue(o.options[o.options.selectedIndex].value,s)}(o.$(m.selector),m.parser);return void 0!==S&&(s[_]=S),s}),{})}},{key:"setValues",value:function setValues(o){var s=this;each(ZQ,(function(m,_){!function setSelectedOption(o,s,m){if(s)for(var _=0;_<o.options.length;_++)if(parseOptionValue(o.options[_].value,m)===s){o.selectedIndex=_;break}}(s.$(m.selector),o[_],m.parser)}))}},{key:"setDefaults",value:function setDefaults(){var o=this;each(ZQ,(function(s){var m=s.hasOwnProperty("default")?s.default:0;o.$(s.selector).selectedIndex=m}))}},{key:"restoreSettings",value:function restoreSettings(){var o;try{o=JSON.parse($V.localStorage.getItem($Q))}catch(o){OG.warn(o)}o&&this.setValues(o)}},{key:"saveSettings",value:function saveSettings(){if(this.options_.persistTextTrackSettings){var o=this.getValues();try{Object.keys(o).length?$V.localStorage.setItem($Q,JSON.stringify(o)):$V.localStorage.removeItem($Q)}catch(o){OG.warn(o)}}}},{key:"updateDisplay",value:function updateDisplay(){var o=this.player_.getChild("textTrackDisplay");o&&o.updateDisplay()}},{key:"conditionalBlur_",value:function conditionalBlur_(){this.previouslyActiveEl_=null;var o=this.player_.controlBar,s=o&&o.subsCapsButton,m=o&&o.captionsButton;s?s.focus():m&&m.focus()}},{key:"handleLanguagechange",value:function handleLanguagechange(){this.fill()}}]),TextTrackSettings}(GX);UX.registerComponent("TextTrackSettings",eJ);var tJ=function(o){_inherits$1(ResizeManager,o);var s=_createSuper$1(ResizeManager);function ResizeManager(o,m){var _;_classCallCheck$1(this,ResizeManager);var S=m.ResizeObserver||$V.ResizeObserver;null===m.ResizeObserver&&(S=!1);var E=merge$1({createEl:!S,reportTouchActivity:!1},m);return(_=s.call(this,o,E)).ResizeObserver=m.ResizeObserver||$V.ResizeObserver,_.loadListener_=null,_.resizeObserver_=null,_.debouncedHandler_=SX((function(){_.resizeHandler()}),100,!1,_assertThisInitialized(_)),S?(_.resizeObserver_=new _.ResizeObserver(_.debouncedHandler_),_.resizeObserver_.observe(o.el())):(_.loadListener_=function(){if(_.el_&&_.el_.contentWindow){var o=_.debouncedHandler_,s=_.unloadListener_=function(){_off(this,"resize",o),_off(this,"unload",s),s=null};_on(_.el_.contentWindow,"unload",s),_on(_.el_.contentWindow,"resize",o)}},_.one("load",_.loadListener_)),_}return _createClass$1(ResizeManager,[{key:"createEl",value:function createEl(){return _get$1(_getPrototypeOf$1(ResizeManager.prototype),"createEl",this).call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}},{key:"resizeHandler",value:function resizeHandler(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")}},{key:"dispose",value:function dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,_get$1(_getPrototypeOf$1(ResizeManager.prototype),"dispose",this).call(this)}}]),ResizeManager}(UX);UX.registerComponent("ResizeManager",tJ);var nJ={trackingThreshold:20,liveTolerance:15},rJ=function(o){_inherits$1(LiveTracker,o);var s=_createSuper$1(LiveTracker);function LiveTracker(o,m){var _;_classCallCheck$1(this,LiveTracker);var S=merge$1(nJ,m,{createEl:!1});return(_=s.call(this,o,S)).trackLiveHandler_=function(){return _.trackLive_()},_.handlePlay_=function(o){return _.handlePlay(o)},_.handleFirstTimeupdate_=function(o){return _.handleFirstTimeupdate(o)},_.handleSeeked_=function(o){return _.handleSeeked(o)},_.seekToLiveEdge_=function(o){return _.seekToLiveEdge(o)},_.reset_(),_.on(_.player_,"durationchange",(function(o){return _.handleDurationchange(o)})),_.on(_.player_,"canplay",(function(){return _.toggleTracking()})),_}return _createClass$1(LiveTracker,[{key:"trackLive_",value:function trackLive_(){var o=this.player_.seekable();if(o&&o.length){var s=Number($V.performance.now().toFixed(4)),m=-1===this.lastTime_?0:(s-this.lastTime_)/1e3;this.lastTime_=s,this.pastSeekEnd_=this.pastSeekEnd()+m;var _=this.liveCurrentTime(),S=this.player_.currentTime(),E=this.player_.paused()||this.seekedBehindLive_||Math.abs(_-S)>this.options_.liveTolerance;this.timeupdateSeen_&&_!==1/0||(E=!1),E!==this.behindLiveEdge_&&(this.behindLiveEdge_=E,this.trigger("liveedgechange"))}}},{key:"handleDurationchange",value:function handleDurationchange(){this.toggleTracking()}},{key:"toggleTracking",value:function toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}},{key:"startTracking",value:function startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,vX),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}},{key:"handleFirstTimeupdate",value:function handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}},{key:"handleSeeked",value:function handleSeeked(){var o=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&o>2,this.nextSeekedFromUser_=!1,this.trackLive_()}},{key:"handlePlay",value:function handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}},{key:"reset_",value:function reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}},{key:"nextSeekedFromUser",value:function nextSeekedFromUser(){this.nextSeekedFromUser_=!0}},{key:"stopTracking",value:function stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}},{key:"seekableEnd",value:function seekableEnd(){for(var o=this.player_.seekable(),s=[],m=o?o.length:0;m--;)s.push(o.end(m));return s.length?s.sort()[s.length-1]:1/0}},{key:"seekableStart",value:function seekableStart(){for(var o=this.player_.seekable(),s=[],m=o?o.length:0;m--;)s.push(o.start(m));return s.length?s.sort()[0]:0}},{key:"liveWindow",value:function liveWindow(){var o=this.liveCurrentTime();return o===1/0?0:o-this.seekableStart()}},{key:"isLive",value:function isLive(){return this.isTracking()}},{key:"atLiveEdge",value:function atLiveEdge(){return!this.behindLiveEdge()}},{key:"liveCurrentTime",value:function liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}},{key:"pastSeekEnd",value:function pastSeekEnd(){var o=this.seekableEnd();return-1!==this.lastSeekEnd_&&o!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=o,this.pastSeekEnd_}},{key:"behindLiveEdge",value:function behindLiveEdge(){return this.behindLiveEdge_}},{key:"isTracking",value:function isTracking(){return"number"==typeof this.trackingInterval_}},{key:"seekToLiveEdge",value:function seekToLiveEdge(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}},{key:"dispose",value:function dispose(){this.stopTracking(),_get$1(_getPrototypeOf$1(LiveTracker.prototype),"dispose",this).call(this)}}]),LiveTracker}(UX);UX.registerComponent("LiveTracker",rJ);var iJ=function(o){_inherits$1(TitleBar,o);var s=_createSuper$1(TitleBar);function TitleBar(o,m){var _;return _classCallCheck$1(this,TitleBar),(_=s.call(this,o,m)).on("statechanged",(function(o){return _.updateDom_()})),_.updateDom_(),_}return _createClass$1(TitleBar,[{key:"createEl",value:function createEl(){return this.els={title:_createEl("div",{className:"vjs-title-bar-title",id:"vjs-title-bar-title-".concat(newGUID())}),description:_createEl("div",{className:"vjs-title-bar-description",id:"vjs-title-bar-description-".concat(newGUID())})},_createEl("div",{className:"vjs-title-bar"},{},values(this.els))}},{key:"updateDom_",value:function updateDom_(){var o=this,s=this.player_.tech_,m=s&&s.el_,_={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach((function(s){var S=o.state[s],E=o.els[s],A=_[s];emptyEl(E),S&&textContent(E,S),m&&(m.removeAttribute(A),S&&m.setAttribute(A,E.id))})),this.state.title||this.state.description?this.show():this.hide()}},{key:"update",value:function update(o){this.setState(o)}},{key:"dispose",value:function dispose(){var o=this.player_.tech_,s=o&&o.el_;s&&(s.removeAttribute("aria-labelledby"),s.removeAttribute("aria-describedby")),_get$1(_getPrototypeOf$1(TitleBar.prototype),"dispose",this).call(this),this.els=null}}]),TitleBar}(UX);UX.registerComponent("TitleBar",iJ);var aJ=function sourcesetLoad(o){var s=o.el();if(s.hasAttribute("src"))return o.triggerSourceset(s.src),!0;var m=o.$$("source"),_=[],S="";if(!m.length)return!1;for(var E=0;E<m.length;E++){var A=m[E].src;A&&-1===_.indexOf(A)&&_.push(A)}return!!_.length&&(1===_.length&&(S=_[0]),o.triggerSourceset(S),!0)},oJ=Object.defineProperty({},"innerHTML",{get:function get(){return this.cloneNode(!0).innerHTML},set:function set(o){var s=lH.createElement(this.nodeName.toLowerCase());s.innerHTML=o;for(var m=lH.createDocumentFragment();s.childNodes.length;)m.appendChild(s.childNodes[0]);return this.innerText="",$V.Element.prototype.appendChild.call(this,m),this.innerHTML}}),sJ=function getDescriptor(o,s){for(var m={},_=0;_<o.length&&!((m=Object.getOwnPropertyDescriptor(o[_],s))&&m.set&&m.get);_++);return m.enumerable=!0,m.configurable=!0,m},uJ=function firstSourceWatch(o){var s=o.el();if(!s.resetSourceWatch_){var m={},_=function getInnerHTMLDescriptor(o){return sJ([o.el(),$V.HTMLMediaElement.prototype,$V.Element.prototype,oJ],"innerHTML")}(o),S=function appendWrapper(m){return function(){for(var _=arguments.length,S=new Array(_),E=0;E<_;E++)S[E]=arguments[E];var A=m.apply(s,S);return aJ(o),A}};["append","appendChild","insertAdjacentHTML"].forEach((function(o){s[o]&&(m[o]=s[o],s[o]=S(m[o]))})),Object.defineProperty(s,"innerHTML",merge$1(_,{set:S(_.set)})),s.resetSourceWatch_=function(){s.resetSourceWatch_=null,Object.keys(m).forEach((function(o){s[o]=m[o]})),Object.defineProperty(s,"innerHTML",_)},o.one("sourceset",s.resetSourceWatch_)}},lJ=Object.defineProperty({},"src",{get:function get(){return this.hasAttribute("src")?lY($V.Element.prototype.getAttribute.call(this,"src")):""},set:function set(o){return $V.Element.prototype.setAttribute.call(this,"src",o),o}}),cJ=function setupSourceset(o){if(o.featuresSourceset){var s=o.el();if(!s.resetSourceset_){var m=function getSrcDescriptor(o){return sJ([o.el(),$V.HTMLMediaElement.prototype,lJ],"src")}(o),_=s.setAttribute,S=s.load;Object.defineProperty(s,"src",merge$1(m,{set:function set(_){var S=m.set.call(s,_);return o.triggerSourceset(s.src),S}})),s.setAttribute=function(m,S){var E=_.call(s,m,S);return/src/i.test(m)&&o.triggerSourceset(s.src),E},s.load=function(){var m=S.call(s);return aJ(o)||(o.triggerSourceset(""),uJ(o)),m},s.currentSrc?o.triggerSourceset(s.currentSrc):aJ(o)||uJ(o),s.resetSourceset_=function(){s.resetSourceset_=null,s.load=S,s.setAttribute=_,Object.defineProperty(s,"src",m),s.resetSourceWatch_&&s.resetSourceWatch_()}}}},dJ=function(o){_inherits$1(Html5,o);var s=_createSuper$1(Html5);function Html5(o,m){var _;_classCallCheck$1(this,Html5),_=s.call(this,o,m);var S=o.source,E=!1;if(_.featuresVideoFrameCallback=_.featuresVideoFrameCallback&&"VIDEO"===_.el_.tagName,S&&(_.el_.currentSrc!==S.src||o.tag&&3===o.tag.initNetworkState_)?_.setSource(S):_.handleLateInit_(_.el_),o.enableSourceset&&_.setupSourcesetHandling_(),_.isScrubbing_=!1,_.el_.hasChildNodes()){for(var A=_.el_.childNodes,O=A.length,H=[];O--;){var K=A[O];"track"===K.nodeName.toLowerCase()&&(_.featuresNativeTextTracks?(_.remoteTextTrackEls().addTrackElement_(K),_.remoteTextTracks().addTrack(K.track),_.textTracks().addTrack(K.track),E||_.el_.hasAttribute("crossorigin")||!dY(K.src)||(E=!0)):H.push(K))}for(var z=0;z<H.length;z++)_.el_.removeChild(H[z])}return _.proxyNativeTracks_(),_.featuresNativeTextTracks&&E&&OG.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),_.restoreMetadataTracksInIOSNativePlayer_(),(Wq||_q)&&!0===o.nativeControlsForTouch&&_.setControls(!0),_.proxyWebkitFullscreen_(),_.triggerReady(),_}return _createClass$1(Html5,[{key:"dispose",value:function dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Html5.disposeMediaElement(this.el_),this.options_=null,_get$1(_getPrototypeOf$1(Html5.prototype),"dispose",this).call(this)}},{key:"setupSourcesetHandling_",value:function setupSourcesetHandling_(){cJ(this)}},{key:"restoreMetadataTracksInIOSNativePlayer_",value:function restoreMetadataTracksInIOSNativePlayer_(){var o,s=this.textTracks(),m=function takeMetadataTrackSnapshot(){o=[];for(var m=0;m<s.length;m++){var _=s[m];"metadata"===_.kind&&o.push({track:_,storedMode:_.mode})}};m(),s.addEventListener("change",m),this.on("dispose",(function(){return s.removeEventListener("change",m)}));var _=function restoreTrackMode(){for(var m=0;m<o.length;m++){var _=o[m];"disabled"===_.track.mode&&_.track.mode!==_.storedMode&&(_.track.mode=_.storedMode)}s.removeEventListener("change",restoreTrackMode)};this.on("webkitbeginfullscreen",(function(){s.removeEventListener("change",m),s.removeEventListener("change",_),s.addEventListener("change",_)})),this.on("webkitendfullscreen",(function(){s.removeEventListener("change",m),s.addEventListener("change",m),s.removeEventListener("change",_)}))}},{key:"overrideNative_",value:function overrideNative_(o,s){var m=this;if(s===this["featuresNative".concat(o,"Tracks")]){var _=o.toLowerCase();this["".concat(_,"TracksListeners_")]&&Object.keys(this["".concat(_,"TracksListeners_")]).forEach((function(o){m.el()["".concat(_,"Tracks")].removeEventListener(o,m["".concat(_,"TracksListeners_")][o])})),this["featuresNative".concat(o,"Tracks")]=!s,this["".concat(_,"TracksListeners_")]=null,this.proxyNativeTracksForType_(_)}}},{key:"overrideNativeAudioTracks",value:function overrideNativeAudioTracks(o){this.overrideNative_("Audio",o)}},{key:"overrideNativeVideoTracks",value:function overrideNativeVideoTracks(o){this.overrideNative_("Video",o)}},{key:"proxyNativeTracksForType_",value:function proxyNativeTracksForType_(o){var s=this,m=_Y[o],_=this.el()[m.getterName],S=this[m.getterName]();if(this["featuresNative".concat(m.capitalName,"Tracks")]&&_&&_.addEventListener){var E={change:function change(m){var _={type:"change",target:S,currentTarget:S,srcElement:S};S.trigger(_),"text"===o&&s[bY.remoteText.getterName]().trigger(_)},addtrack:function addtrack(o){S.addTrack(o.track)},removetrack:function removetrack(o){S.removeTrack(o.track)}},A=function removeOldTracks(){for(var o=[],s=0;s<S.length;s++){for(var m=!1,E=0;E<_.length;E++)if(_[E]===S[s]){m=!0;break}m||o.push(S[s])}for(;o.length;)S.removeTrack(o.shift())};this[m.getterName+"Listeners_"]=E,Object.keys(E).forEach((function(o){var m=E[o];_.addEventListener(o,m),s.on("dispose",(function(s){return _.removeEventListener(o,m)}))})),this.on("loadstart",A),this.on("dispose",(function(o){return s.off("loadstart",A)}))}}},{key:"proxyNativeTracks_",value:function proxyNativeTracks_(){var o=this;_Y.names.forEach((function(s){o.proxyNativeTracksForType_(s)}))}},{key:"createEl",value:function createEl(){var o=this.options_.tag;if(!o||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(o){var s=o.cloneNode(!0);o.parentNode&&o.parentNode.insertBefore(s,o),Html5.disposeMediaElement(o),o=s}else{o=lH.createElement("video");var m=merge$1({},this.options_.tag&&getAttributes(this.options_.tag));Wq&&!0===this.options_.nativeControlsForTouch||delete m.controls,setAttributes(o,Object.assign(m,{id:this.options_.techId,class:"vjs-tech"}))}o.playerId=this.options_.playerId}void 0!==this.options_.preload&&_setAttribute(o,"preload",this.options_.preload),void 0!==this.options_.disablePictureInPicture&&(o.disablePictureInPicture=this.options_.disablePictureInPicture);for(var _=["loop","muted","playsinline","autoplay"],S=0;S<_.length;S++){var E=_[S],A=this.options_[E];void 0!==A&&(A?_setAttribute(o,E,E):_removeAttribute(o,E),o[E]=A)}return o}},{key:"handleLateInit_",value:function handleLateInit_(o){if(0!==o.networkState&&3!==o.networkState){if(0===o.readyState){var s=!1,m=function setLoadstartFired(){s=!0};this.on("loadstart",m);var _=function triggerLoadstart(){s||this.trigger("loadstart")};return this.on("loadedmetadata",_),void this.ready((function(){this.off("loadstart",m),this.off("loadedmetadata",_),s||this.trigger("loadstart")}))}var S=["loadstart"];S.push("loadedmetadata"),o.readyState>=2&&S.push("loadeddata"),o.readyState>=3&&S.push("canplay"),o.readyState>=4&&S.push("canplaythrough"),this.ready((function(){S.forEach((function(o){this.trigger(o)}),this)}))}}},{key:"setScrubbing",value:function setScrubbing(o){this.isScrubbing_=o}},{key:"scrubbing",value:function scrubbing(){return this.isScrubbing_}},{key:"setCurrentTime",value:function setCurrentTime(o){try{this.isScrubbing_&&this.el_.fastSeek&&tX?this.el_.fastSeek(o):this.el_.currentTime=o}catch(o){OG(o,"Video is not ready. (Video.js)")}}},{key:"duration",value:function duration(){var o=this;if(this.el_.duration===1/0&&HG&&GG&&0===this.el_.currentTime){return this.on("timeupdate",(function checkProgress(){o.el_.currentTime>0&&(o.el_.duration===1/0&&o.trigger("durationchange"),o.off("timeupdate",checkProgress))})),NaN}return this.el_.duration||NaN}},{key:"width",value:function width(){return this.el_.offsetWidth}},{key:"height",value:function height(){return this.el_.offsetHeight}},{key:"proxyWebkitFullscreen_",value:function proxyWebkitFullscreen_(){var o=this;if("webkitDisplayingFullscreen"in this.el_){var s=function endFn(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},m=function beginFn(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",s),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",m),this.on("dispose",(function(){o.off("webkitbeginfullscreen",m),o.off("webkitendfullscreen",s)}))}}},{key:"supportsFullScreen",value:function supportsFullScreen(){return"function"==typeof this.el_.webkitEnterFullScreen}},{key:"enterFullScreen",value:function enterFullScreen(){var o=this.el_;if(o.paused&&o.networkState<=o.HAVE_METADATA)silencePromise(this.el_.play()),this.setTimeout((function(){o.pause();try{o.webkitEnterFullScreen()}catch(o){this.trigger("fullscreenerror",o)}}),0);else try{o.webkitEnterFullScreen()}catch(o){this.trigger("fullscreenerror",o)}}},{key:"exitFullScreen",value:function exitFullScreen(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))}},{key:"requestPictureInPicture",value:function requestPictureInPicture(){return this.el_.requestPictureInPicture()}},{key:"requestVideoFrameCallback",value:function requestVideoFrameCallback(o){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(o):_get$1(_getPrototypeOf$1(Html5.prototype),"requestVideoFrameCallback",this).call(this,o)}},{key:"cancelVideoFrameCallback",value:function cancelVideoFrameCallback(o){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(o):_get$1(_getPrototypeOf$1(Html5.prototype),"cancelVideoFrameCallback",this).call(this,o)}},{key:"src",value:function src(o){if(void 0===o)return this.el_.src;this.setSrc(o)}},{key:"reset",value:function reset(){Html5.resetMediaElement(this.el_)}},{key:"currentSrc",value:function currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}},{key:"setControls",value:function setControls(o){this.el_.controls=!!o}},{key:"addTextTrack",value:function addTextTrack(o,s,m){return this.featuresNativeTextTracks?this.el_.addTextTrack(o,s,m):_get$1(_getPrototypeOf$1(Html5.prototype),"addTextTrack",this).call(this,o,s,m)}},{key:"createRemoteTextTrack",value:function createRemoteTextTrack(o){if(!this.featuresNativeTextTracks)return _get$1(_getPrototypeOf$1(Html5.prototype),"createRemoteTextTrack",this).call(this,o);var s=lH.createElement("track");return o.kind&&(s.kind=o.kind),o.label&&(s.label=o.label),(o.language||o.srclang)&&(s.srclang=o.language||o.srclang),o.default&&(s.default=o.default),o.id&&(s.id=o.id),o.src&&(s.src=o.src),s}},{key:"addRemoteTextTrack",value:function addRemoteTextTrack(o,s){var m=_get$1(_getPrototypeOf$1(Html5.prototype),"addRemoteTextTrack",this).call(this,o,s);return this.featuresNativeTextTracks&&this.el().appendChild(m),m}},{key:"removeRemoteTextTrack",value:function removeRemoteTextTrack(o){if(_get$1(_getPrototypeOf$1(Html5.prototype),"removeRemoteTextTrack",this).call(this,o),this.featuresNativeTextTracks)for(var s=this.$$("track"),m=s.length;m--;)o!==s[m]&&o!==s[m].track||this.el().removeChild(s[m])}},{key:"getVideoPlaybackQuality",value:function getVideoPlaybackQuality(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var o={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(o.droppedVideoFrames=this.el().webkitDroppedFrameCount,o.totalVideoFrames=this.el().webkitDecodedFrameCount),$V.performance&&(o.creationTime=$V.performance.now()),o}}]),Html5}(TY);defineLazyProperty(dJ,"TEST_VID",(function(){if(isReal()){var o=lH.createElement("video"),s=lH.createElement("track");return s.kind="captions",s.srclang="en",s.label="English",o.appendChild(s),o}})),dJ.isSupported=function(){try{dJ.TEST_VID.volume=.5}catch(o){return!1}return!(!dJ.TEST_VID||!dJ.TEST_VID.canPlayType)},dJ.canPlayType=function(o){return dJ.TEST_VID.canPlayType(o)},dJ.canPlaySource=function(o,s){return dJ.canPlayType(o.type)},dJ.canControlVolume=function(){try{var o=dJ.TEST_VID.volume;dJ.TEST_VID.volume=o/2+.1;var s=o!==dJ.TEST_VID.volume;return s&&eX?($V.setTimeout((function(){dJ&&dJ.prototype&&(dJ.prototype.featuresVolumeControl=o!==dJ.TEST_VID.volume)})),!1):s}catch(o){return!1}},dJ.canMuteVolume=function(){try{var o=dJ.TEST_VID.muted;return dJ.TEST_VID.muted=!o,dJ.TEST_VID.muted?_setAttribute(dJ.TEST_VID,"muted","muted"):_removeAttribute(dJ.TEST_VID,"muted"),o!==dJ.TEST_VID.muted}catch(o){return!1}},dJ.canControlPlaybackRate=function(){if(HG&&GG&&XG<58)return!1;try{var o=dJ.TEST_VID.playbackRate;return dJ.TEST_VID.playbackRate=o/2+.1,o!==dJ.TEST_VID.playbackRate}catch(o){return!1}},dJ.canOverrideAttributes=function(){try{var o=function _noop(){};Object.defineProperty(lH.createElement("video"),"src",{get:o,set:o}),Object.defineProperty(lH.createElement("audio"),"src",{get:o,set:o}),Object.defineProperty(lH.createElement("video"),"innerHTML",{get:o,set:o}),Object.defineProperty(lH.createElement("audio"),"innerHTML",{get:o,set:o})}catch(o){return!1}return!0},dJ.supportsNativeTextTracks=function(){return tX||eX&&GG},dJ.supportsNativeVideoTracks=function(){return!(!dJ.TEST_VID||!dJ.TEST_VID.videoTracks)},dJ.supportsNativeAudioTracks=function(){return!(!dJ.TEST_VID||!dJ.TEST_VID.audioTracks)},dJ.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(o){var s=_slicedToArray$1(o,2),m=s[0],_=s[1];defineLazyProperty(dJ.prototype,m,(function(){return dJ[_]()}),!0)})),dJ.prototype.featuresVolumeControl=dJ.canControlVolume(),dJ.prototype.movingMediaElementInDOM=!eX,dJ.prototype.featuresFullscreenResize=!0,dJ.prototype.featuresProgressEvents=!0,dJ.prototype.featuresTimeupdateEvents=!0,dJ.prototype.featuresVideoFrameCallback=!(!dJ.TEST_VID||!dJ.TEST_VID.requestVideoFrameCallback),dJ.disposeMediaElement=function(o){if(o){for(o.parentNode&&o.parentNode.removeChild(o);o.hasChildNodes();)o.removeChild(o.firstChild);o.removeAttribute("src"),"function"==typeof o.load&&function(){try{o.load()}catch(o){}}()}},dJ.resetMediaElement=function(o){if(o){for(var s=o.querySelectorAll("source"),m=s.length;m--;)o.removeChild(s[m]);o.removeAttribute("src"),"function"==typeof o.load&&function(){try{o.load()}catch(o){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(o){dJ.prototype[o]=function(){return this.el_[o]||this.el_.hasAttribute(o)}})),["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(o){dJ.prototype["set"+MX(o)]=function(s){this.el_[o]=s,s?this.el_.setAttribute(o,o):this.el_.removeAttribute(o)}})),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(o){dJ.prototype[o]=function(){return this.el_[o]}})),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach((function(o){dJ.prototype["set"+MX(o)]=function(s){this.el_[o]=s}})),["pause","load","play"].forEach((function(o){dJ.prototype[o]=function(){return this.el_[o]()}})),TY.withSourceHandlers(dJ),dJ.nativeSourceHandler={},dJ.nativeSourceHandler.canPlayType=function(o){try{return dJ.TEST_VID.canPlayType(o)}catch(o){return""}},dJ.nativeSourceHandler.canHandleSource=function(o,s){if(o.type)return dJ.nativeSourceHandler.canPlayType(o.type);if(o.src){var m=cY(o.src);return dJ.nativeSourceHandler.canPlayType("video/".concat(m))}return""},dJ.nativeSourceHandler.handleSource=function(o,s,m){s.setSrc(o.src)},dJ.nativeSourceHandler.dispose=function(){},dJ.registerSourceHandler(dJ.nativeSourceHandler),TY.registerTech("Html5",dJ);var hJ=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],pJ={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},fJ=["tiny","xsmall","small","medium","large","xlarge","huge"],gJ={};fJ.forEach((function(o){var s="x"===o.charAt(0)?"x-".concat(o.substring(1)):o;gJ[o]="vjs-layout-".concat(s)}));var mJ={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},yJ=function(o){_inherits$1(Player,o);var s=_createSuper$1(Player);function Player(o,m,_){var S;if(_classCallCheck$1(this,Player),o.id=o.id||m.id||"vjs_video_".concat(newGUID()),(m=Object.assign(Player.getTagSettings(o),m)).initChildren=!1,m.createEl=!1,m.evented=!1,m.reportTouchActivity=!1,!m.language){var E=o.closest("[lang]");E&&(m.language=E.getAttribute("lang"))}if((S=s.call(this,null,m,_)).boundDocumentFullscreenChange_=function(o){return S.documentFullscreenChange_(o)},S.boundFullWindowOnEscKey_=function(o){return S.fullWindowOnEscKey(o)},S.boundUpdateStyleEl_=function(o){return S.updateStyleEl_(o)},S.boundApplyInitTime_=function(o){return S.applyInitTime_(o)},S.boundUpdateCurrentBreakpoint_=function(o){return S.updateCurrentBreakpoint_(o)},S.boundHandleTechClick_=function(o){return S.handleTechClick_(o)},S.boundHandleTechDoubleClick_=function(o){return S.handleTechDoubleClick_(o)},S.boundHandleTechTouchStart_=function(o){return S.handleTechTouchStart_(o)},S.boundHandleTechTouchMove_=function(o){return S.handleTechTouchMove_(o)},S.boundHandleTechTouchEnd_=function(o){return S.handleTechTouchEnd_(o)},S.boundHandleTechTap_=function(o){return S.handleTechTap_(o)},S.isFullscreen_=!1,S.log=MG(S.id_),S.fsApi_=EG,S.isPosterFromTech_=!1,S.queuedCallbacks_=[],S.isReady_=!1,S.hasStarted_=!1,S.userActive_=!1,S.debugEnabled_=!1,S.audioOnlyMode_=!1,S.audioPosterMode_=!1,S.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!S.options_||!S.options_.techOrder||!S.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(S.tag=o,S.tagAttributes=o&&getAttributes(o),S.language(S.options_.language),m.languages){var A={};Object.getOwnPropertyNames(m.languages).forEach((function(o){A[o.toLowerCase()]=m.languages[o]})),S.languages_=A}else S.languages_=Player.prototype.options_.languages;S.resetCache_(),S.poster_=m.poster||"",S.controls_=!!m.controls,o.controls=!1,o.removeAttribute("controls"),S.changingSrc_=!1,S.playCallbacks_=[],S.playTerminatedQueue_=[],o.hasAttribute("autoplay")?S.autoplay(!0):S.autoplay(S.options_.autoplay),m.plugins&&Object.keys(m.plugins).forEach((function(o){if("function"!=typeof S[o])throw new Error('plugin "'.concat(o,'" does not exist'))})),S.scrubbing_=!1,S.el_=S.createEl(),evented(_assertThisInitialized(S),{eventBusKey:"el_"}),S.fsApi_.requestFullscreen&&(_on(lH,S.fsApi_.fullscreenchange,S.boundDocumentFullscreenChange_),S.on(S.fsApi_.fullscreenchange,S.boundDocumentFullscreenChange_)),S.fluid_&&S.on(["playerreset","resize"],S.boundUpdateStyleEl_);var O=merge$1(S.options_);if(m.plugins&&Object.keys(m.plugins).forEach((function(o){S[o](m.plugins[o])})),m.debug&&S.debug(!0),S.options_.playerOptions=O,S.middleware_=[],S.playbackRates(m.playbackRates),m.experimentalSvgIcons){var H=(new $V.DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg">\n  <defs>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-play">\n      <path d="M16 10v28l22-14z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">\n      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">\n      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">\n      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">\n      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">\n      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">\n      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">\n      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">\n      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">\n      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">\n      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">\n      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">\n      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>\n    </symbol>\n    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">\n      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">\n      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>\n    </symbol>\n    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">\n      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">\n      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">\n      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">\n      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-share">\n      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">\n      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-square">\n      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">\n      <circle cx="24" cy="24" r="20"></circle>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">\n      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">\n      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">\n      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">\n      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">\n      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">\n      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">\n      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">\n      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">\n      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">\n      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>\n    </symbol>\n    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">\n      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>\n    </symbol>\n    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">\n      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">\n      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">\n      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">\n      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">\n      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>\n    </symbol>\n    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">\n      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>\n    </symbol>\n    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">\n      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>\n      <path fill="none" d="M-1-3h24v24H-1z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">\n      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">\n      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-twitter">\n      <path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5T1369.5 1125 1185 1335.5t-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5T285 1033q33 5 61 5 43 0 85-11-112-23-185.5-111.5T172 710v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5T884 653q-8-38-8-74 0-134 94.5-228.5T1199 256q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">\n      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>\n    </symbol>\n    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">\n      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>\n    </symbol>\n  </defs>\n</svg>',"image/svg+xml");if(H.querySelector("parsererror"))OG.warn("Failed to load SVG Icons. Falling back to Font Icons."),S.options_.experimentalSvgIcons=null;else{var K=H.documentElement;K.style.display="none",S.el_.appendChild(K),S.addClass("vjs-svg-icons-enabled")}}S.initChildren(),S.isAudio("audio"===o.nodeName.toLowerCase()),S.controls()?S.addClass("vjs-controls-enabled"):S.addClass("vjs-controls-disabled"),S.el_.setAttribute("role","region"),S.isAudio()?S.el_.setAttribute("aria-label",S.localize("Audio Player")):S.el_.setAttribute("aria-label",S.localize("Video Player")),S.isAudio()&&S.addClass("vjs-audio"),Wq&&S.addClass("vjs-touch-enabled"),eX||S.addClass("vjs-workinghover"),Player.players[S.id_]=_assertThisInitialized(S);var z=kG.split(".")[0];return S.addClass("vjs-v".concat(z)),S.userActive(!0),S.reportUserActivity(),S.one("play",(function(o){return S.listenForUserActivity_(o)})),S.on("keydown",(function(o){return S.handleKeyDown(o)})),S.on("languagechange",(function(o){return S.handleLanguagechange(o)})),S.breakpoints(S.options_.breakpoints),S.responsive(S.options_.responsive),S.on("ready",(function(){S.audioPosterMode(S.options_.audioPosterMode),S.audioOnlyMode(S.options_.audioOnlyMode)})),S}return _createClass$1(Player,[{key:"dispose",value:function dispose(){var o=this;this.trigger("dispose"),this.off("dispose"),_off(lH,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),_off(lH,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),Player.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),function clearCacheForPlayer(o){CY[o.id()]=null}(this),SY.names.forEach((function(s){var m=SY[s],_=o[m.getterName]();_&&_.off&&_.off()})),_get$1(_getPrototypeOf$1(Player.prototype),"dispose",this).call(this,{restoreEl:this.options_.restoreEl})}},{key:"createEl",value:function createEl(){var o,s=this.tag,m=this.playerElIngest_=s.parentNode&&s.parentNode.hasAttribute&&s.parentNode.hasAttribute("data-vjs-player"),_="video-js"===this.tag.tagName.toLowerCase();m?o=this.el_=s.parentNode:_||(o=this.el_=_get$1(_getPrototypeOf$1(Player.prototype),"createEl",this).call(this,"div"));var S=getAttributes(s);if(_){for(o=this.el_=s,s=this.tag=lH.createElement("video");o.children.length;)s.appendChild(o.firstChild);_hasClass(o,"video-js")||_addClass(o,"video-js"),o.appendChild(s),m=this.playerElIngest_=o,Object.keys(o).forEach((function(m){try{s[m]=o[m]}catch(o){}}))}if(s.setAttribute("tabindex","-1"),S.tabindex="-1",GG&&JG&&(s.setAttribute("role","application"),S.role="application"),s.removeAttribute("width"),s.removeAttribute("height"),"width"in S&&delete S.width,"height"in S&&delete S.height,Object.getOwnPropertyNames(S).forEach((function(m){_&&"class"===m||o.setAttribute(m,S[m]),_&&s.setAttribute(m,S[m])})),s.playerId=s.id,s.id+="_html5_api",s.className="vjs-tech",s.player=o.player=this,this.addClass("vjs-paused"),!0!==$V.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=cX("vjs-styles-dimensions");var E=rX(".vjs-styles-defaults"),A=rX("head");A.insertBefore(this.styleEl_,E?E.nextSibling:A.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var O=s.getElementsByTagName("a"),H=0;H<O.length;H++){var K=O.item(H);_addClass(K,"vjs-hidden"),K.setAttribute("hidden","hidden")}return s.initNetworkState_=s.networkState,s.parentNode&&!m&&s.parentNode.insertBefore(o,s),prependTo(s,o),this.children_.unshift(s),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=o,o}},{key:"crossOrigin",value:function crossOrigin(o){if(void 0===o)return this.techGet_("crossOrigin");null===o||"anonymous"===o||"use-credentials"===o?(this.techCall_("setCrossOrigin",o),this.posterImage&&this.posterImage.crossOrigin(o)):OG.warn('crossOrigin must be null,  "anonymous" or "use-credentials", given "'.concat(o,'"'))}},{key:"width",value:function width(o){return this.dimension("width",o)}},{key:"height",value:function height(o){return this.dimension("height",o)}},{key:"dimension",value:function dimension(o,s){var m=o+"_";if(void 0===s)return this[m]||0;if(""===s||"auto"===s)return this[m]=void 0,void this.updateStyleEl_();var _=parseFloat(s);isNaN(_)?OG.error('Improper value "'.concat(s,'" supplied for for ').concat(o)):(this[m]=_,this.updateStyleEl_())}},{key:"fluid",value:function fluid(o){var s=this;if(void 0===o)return!!this.fluid_;this.fluid_=!!o,wX(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),o?(this.addClass("vjs-fluid"),this.fill(!1),function addEventedCallback(o,s){wX(o)?s():(o.eventedCallbacks||(o.eventedCallbacks=[]),o.eventedCallbacks.push(s))}(this,(function(){s.on(["playerreset","resize"],s.boundUpdateStyleEl_)}))):this.removeClass("vjs-fluid"),this.updateStyleEl_()}},{key:"fill",value:function fill(o){if(void 0===o)return!!this.fill_;this.fill_=!!o,o?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}},{key:"aspectRatio",value:function aspectRatio(o){if(void 0===o)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(o))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=o,this.fluid(!0),this.updateStyleEl_()}},{key:"updateStyleEl_",value:function updateStyleEl_(){if(!0!==$V.VIDEOJS_NO_DYNAMIC_STYLE){var o,s,m,_=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),S=_[1]/_[0];o=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/S:this.videoWidth()||300,s=void 0!==this.height_?this.height_:o*S,m=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(m),dX(this.styleEl_,"\n      .".concat(m," {\n        width: ").concat(o,"px;\n        height: ").concat(s,"px;\n      }\n\n      .").concat(m,".vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: ").concat(100*S,"%;\n      }\n    "))}else{var E="number"==typeof this.width_?this.width_:this.options_.width,A="number"==typeof this.height_?this.height_:this.options_.height,O=this.tech_&&this.tech_.el();O&&(E>=0&&(O.width=E),A>=0&&(O.height=A))}}},{key:"loadTech_",value:function loadTech_(o,s){var m=this;this.tech_&&this.unloadTech_();var _=MX(o),S=o.charAt(0).toLowerCase()+o.slice(1);"Html5"!==_&&this.tag&&(TY.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=_,this.isReady_=!1;var E=this.autoplay();("string"==typeof this.autoplay()||!0===this.autoplay()&&this.options_.normalizeAutoplay)&&(E=!1);var A={source:s,autoplay:E,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:"".concat(this.id(),"_").concat(S,"_api"),playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};SY.names.forEach((function(o){var s=SY[o];A[s.getterName]=m[s.privateName]})),Object.assign(A,this.options_[_]),Object.assign(A,this.options_[S]),Object.assign(A,this.options_[o.toLowerCase()]),this.tag&&(A.tag=this.tag),s&&s.src===this.cache_.src&&this.cache_.currentTime>0&&(A.startTime=this.cache_.currentTime);var O=TY.getTech(o);if(!O)throw new Error("No Tech named '".concat(_,"' exists! '").concat(_,"' should be registered using videojs.registerTech()'"));this.tech_=new O(A),this.tech_.ready(_X(this,this.handleTechReady_),!0),zX(this.textTracksJson_||[],this.tech_),hJ.forEach((function(o){m.on(m.tech_,o,(function(s){return m["handleTech".concat(MX(o),"_")](s)}))})),Object.keys(pJ).forEach((function(o){m.on(m.tech_,o,(function(s){0===m.tech_.playbackRate()&&m.tech_.seeking()?m.queuedCallbacks_.push({callback:m["handleTech".concat(pJ[o],"_")].bind(m),event:s}):m["handleTech".concat(pJ[o],"_")](s)}))})),this.on(this.tech_,"loadstart",(function(o){return m.handleTechLoadStart_(o)})),this.on(this.tech_,"sourceset",(function(o){return m.handleTechSourceset_(o)})),this.on(this.tech_,"waiting",(function(o){return m.handleTechWaiting_(o)})),this.on(this.tech_,"ended",(function(o){return m.handleTechEnded_(o)})),this.on(this.tech_,"seeking",(function(o){return m.handleTechSeeking_(o)})),this.on(this.tech_,"play",(function(o){return m.handleTechPlay_(o)})),this.on(this.tech_,"pause",(function(o){return m.handleTechPause_(o)})),this.on(this.tech_,"durationchange",(function(o){return m.handleTechDurationChange_(o)})),this.on(this.tech_,"fullscreenchange",(function(o,s){return m.handleTechFullscreenChange_(o,s)})),this.on(this.tech_,"fullscreenerror",(function(o,s){return m.handleTechFullscreenError_(o,s)})),this.on(this.tech_,"enterpictureinpicture",(function(o){return m.handleTechEnterPictureInPicture_(o)})),this.on(this.tech_,"leavepictureinpicture",(function(o){return m.handleTechLeavePictureInPicture_(o)})),this.on(this.tech_,"error",(function(o){return m.handleTechError_(o)})),this.on(this.tech_,"posterchange",(function(o){return m.handleTechPosterChange_(o)})),this.on(this.tech_,"textdata",(function(o){return m.handleTechTextData_(o)})),this.on(this.tech_,"ratechange",(function(o){return m.handleTechRateChange_(o)})),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===_&&this.tag||prependTo(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}},{key:"unloadTech_",value:function unloadTech_(){var o=this;SY.names.forEach((function(s){var m=SY[s];o[m.privateName]=o[m.getterName]()})),this.textTracksJson_=KX(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}},{key:"tech",value:function tech(o){return void 0===o&&OG.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_}},{key:"version",value:function version(){return{"video.js":kG}}},{key:"addTechControlsListeners_",value:function addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}},{key:"removeTechControlsListeners_",value:function removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}},{key:"handleTechReady_",value:function handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}},{key:"handleTechLoadStart_",value:function handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(!0===this.autoplay()&&this.options_.normalizeAutoplay?"play":this.autoplay())}},{key:"manualAutoplay_",value:function manualAutoplay_(o){var s=this;if(this.tech_&&"string"==typeof o){var m,_=function resolveMuted(){var o=s.muted();s.muted(!0);var m=function restoreMuted(){s.muted(o)};s.playTerminatedQueue_.push(m);var _=s.play();if(isPromise(_))return _.catch((function(o){throw m(),new Error("Rejection at manualAutoplay. Restoring muted value. ".concat(o||""))}))};if("any"!==o||this.muted()?m="muted"!==o||this.muted()?this.play():_():isPromise(m=this.play())&&(m=m.catch(_)),isPromise(m))return m.then((function(){s.trigger({type:"autoplay-success",autoplay:o})})).catch((function(){s.trigger({type:"autoplay-failure",autoplay:o})}))}}},{key:"updateSourceCaches_",value:function updateSourceCaches_(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=o,m="";"string"!=typeof s&&(s=o.src,m=o.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],s&&!m&&(m=function findMimetype(o,s){if(!s)return"";if(o.cache_.source.src===s&&o.cache_.source.type)return o.cache_.source.type;var m=o.cache_.sources.filter((function(o){return o.src===s}));if(m.length)return m[0].type;for(var _=o.$$("source"),S=0;S<_.length;S++){var E=_[S];if(E.type&&E.src&&E.src===s)return E.type}return PY(s)}(this,s)),this.cache_.source=merge$1({},o,{src:s,type:m});for(var _=this.cache_.sources.filter((function(o){return o.src&&o.src===s})),S=[],E=this.$$("source"),A=[],O=0;O<E.length;O++){var H=getAttributes(E[O]);S.push(H),H.src&&H.src===s&&A.push(H.src)}A.length&&!_.length?this.cache_.sources=S:_.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=s}},{key:"handleTechSourceset_",value:function handleTechSourceset_(o){var s=this;if(!this.changingSrc_){var m=function updateSourceCaches(o){return s.updateSourceCaches_(o)},_=this.currentSource().src,S=o.src;_&&!/^blob:/.test(_)&&/^blob:/.test(S)&&(!this.lastSource_||this.lastSource_.tech!==S&&this.lastSource_.player!==_)&&(m=function updateSourceCaches(){}),m(S),o.src||this.tech_.any(["sourceset","loadstart"],(function(o){if("sourceset"!==o.type){var m=s.techGet_("currentSrc");s.lastSource_.tech=m,s.updateSourceCaches_(m)}}))}this.lastSource_={player:this.currentSource().src,tech:o.src},this.trigger({src:o.src,type:"sourceset"})}},{key:"hasStarted",value:function hasStarted(o){if(void 0===o)return this.hasStarted_;o!==this.hasStarted_&&(this.hasStarted_=o,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}},{key:"handleTechPlay_",value:function handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}},{key:"handleTechRateChange_",value:function handleTechRateChange_(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach((function(o){return o.callback(o.event)})),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}},{key:"handleTechWaiting_",value:function handleTechWaiting_(){var o=this;this.addClass("vjs-waiting"),this.trigger("waiting");var s=this.currentTime();this.on("timeupdate",(function timeUpdateListener(){s!==o.currentTime()&&(o.removeClass("vjs-waiting"),o.off("timeupdate",timeUpdateListener))}))}},{key:"handleTechCanPlay_",value:function handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}},{key:"handleTechCanPlayThrough_",value:function handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}},{key:"handleTechPlaying_",value:function handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}},{key:"handleTechSeeking_",value:function handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}},{key:"handleTechSeeked_",value:function handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}},{key:"handleTechPause_",value:function handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}},{key:"handleTechEnded_",value:function handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}},{key:"handleTechDurationChange_",value:function handleTechDurationChange_(){this.duration(this.techGet_("duration"))}},{key:"handleTechClick_",value:function handleTechClick_(o){this.controls_&&(void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.click&&!1===this.options_.userActions.click||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.click?this.options_.userActions.click.call(this,o):this.paused()?silencePromise(this.play()):this.pause()))}},{key:"handleTechDoubleClick_",value:function handleTechDoubleClick_(o){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(function(s){return s.contains(o.target)}))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,o):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))}},{key:"handleTechTap_",value:function handleTechTap_(){this.userActive(!this.userActive())}},{key:"handleTechTouchStart_",value:function handleTechTouchStart_(){this.userWasActive=this.userActive()}},{key:"handleTechTouchMove_",value:function handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}},{key:"handleTechTouchEnd_",value:function handleTechTouchEnd_(o){o.cancelable&&o.preventDefault()}},{key:"toggleFullscreenClass_",value:function toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}},{key:"documentFullscreenChange_",value:function documentFullscreenChange_(o){var s=o.target.player;if(!s||s===this){var m=this.el(),_=lH[this.fsApi_.fullscreenElement]===m;!_&&m.matches&&(_=m.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(_)}}},{key:"handleTechFullscreenChange_",value:function handleTechFullscreenChange_(o,s){var m=this;s&&(s.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",(function(){m.removeClass("vjs-ios-native-fs")}))),this.isFullscreen(s.isFullscreen))}},{key:"handleTechFullscreenError_",value:function handleTechFullscreenError_(o,s){this.trigger("fullscreenerror",s)}},{key:"togglePictureInPictureClass_",value:function togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}},{key:"handleTechEnterPictureInPicture_",value:function handleTechEnterPictureInPicture_(o){this.isInPictureInPicture(!0)}},{key:"handleTechLeavePictureInPicture_",value:function handleTechLeavePictureInPicture_(o){this.isInPictureInPicture(!1)}},{key:"handleTechError_",value:function handleTechError_(){var o=this.tech_.error();o&&this.error(o)}},{key:"handleTechTextData_",value:function handleTechTextData_(){var o=null;arguments.length>1&&(o=arguments[1]),this.trigger("textdata",o)}},{key:"getCache",value:function getCache(){return this.cache_}},{key:"resetCache_",value:function resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}},{key:"techCall_",value:function techCall_(o,s){this.ready((function(){if(o in EY)return function set(o,s,m,_){return s[m](o.reduce(middlewareIterator(m),_))}(this.middleware_,this.tech_,o,s);if(o in IY)return mediate(this.middleware_,this.tech_,o,s);try{this.tech_&&this.tech_[o](s)}catch(o){throw OG(o),o}}),!0)}},{key:"techGet_",value:function techGet_(o){if(this.tech_&&this.tech_.isReady_){if(o in xY)return function get(o,s,m){return o.reduceRight(middlewareIterator(m),s[m]())}(this.middleware_,this.tech_,o);if(o in IY)return mediate(this.middleware_,this.tech_,o);try{return this.tech_[o]()}catch(s){if(void 0===this.tech_[o])throw OG("Video.js: ".concat(o," method not defined for ").concat(this.techName_," playback technology."),s),s;if("TypeError"===s.name)throw OG("Video.js: ".concat(o," unavailable on ").concat(this.techName_," playback technology element."),s),this.tech_.isReady_=!1,s;throw OG(s),s}}}},{key:"play",value:function play(){var o=this;return new Promise((function(s){o.play_(s)}))}},{key:"play_",value:function play_(){var o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:silencePromise;this.playCallbacks_.push(s);var m=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),_=Boolean(tX||eX);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!m)return this.waitToPlay_=function(s){o.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(!m&&_&&this.load());var S=this.techGet_("play");_&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),null===S?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(S)}},{key:"runPlayTerminatedQueue_",value:function runPlayTerminatedQueue_(){var o=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],o.forEach((function(o){o()}))}},{key:"runPlayCallbacks_",value:function runPlayCallbacks_(o){var s=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],s.forEach((function(s){s(o)}))}},{key:"pause",value:function pause(){this.techCall_("pause")}},{key:"paused",value:function paused(){return!1!==this.techGet_("paused")}},{key:"played",value:function played(){return this.techGet_("played")||createTimeRanges$1(0,0)}},{key:"scrubbing",value:function scrubbing(o){if(void 0===o)return this.scrubbing_;this.scrubbing_=!!o,this.techCall_("setScrubbing",this.scrubbing_),o?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}},{key:"currentTime",value:function currentTime(o){return void 0===o?(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime):(o<0&&(o=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",o),this.cache_.initTime=0,void(isFinite(o)&&(this.cache_.currentTime=Number(o)))):(this.cache_.initTime=o,this.off("canplay",this.boundApplyInitTime_),void this.one("canplay",this.boundApplyInitTime_)))}},{key:"applyInitTime_",value:function applyInitTime_(){this.currentTime(this.cache_.initTime)}},{key:"duration",value:function duration(o){if(void 0===o)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(o=parseFloat(o))<0&&(o=1/0),o!==this.cache_.duration&&(this.cache_.duration=o,o===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(o)||this.trigger("durationchange"))}},{key:"remainingTime",value:function remainingTime(){return this.duration()-this.currentTime()}},{key:"remainingTimeDisplay",value:function remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}},{key:"buffered",value:function buffered(){var buffered=this.techGet_("buffered");return buffered&&buffered.length||(buffered=createTimeRanges$1(0,0)),buffered}},{key:"seekable",value:function seekable(){var seekable=this.techGet_("seekable");return seekable&&seekable.length||(seekable=createTimeRanges$1(0,0)),seekable}},{key:"seeking",value:function seeking(){return this.techGet_("seeking")}},{key:"ended",value:function ended(){return this.techGet_("ended")}},{key:"networkState",value:function networkState(){return this.techGet_("networkState")}},{key:"readyState",value:function readyState(){return this.techGet_("readyState")}},{key:"bufferedPercent",value:function bufferedPercent(){return _bufferedPercent(this.buffered(),this.duration())}},{key:"bufferedEnd",value:function bufferedEnd(){var o=this.buffered(),s=this.duration(),m=o.end(o.length-1);return m>s&&(m=s),m}},{key:"volume",value:function volume(o){var s;return void 0!==o?(s=Math.max(0,Math.min(1,o)),this.cache_.volume=s,this.techCall_("setVolume",s),void(s>0&&this.lastVolume_(s))):(s=parseFloat(this.techGet_("volume")),isNaN(s)?1:s)}},{key:"muted",value:function muted(o){if(void 0===o)return this.techGet_("muted")||!1;this.techCall_("setMuted",o)}},{key:"defaultMuted",value:function defaultMuted(o){return void 0!==o&&this.techCall_("setDefaultMuted",o),this.techGet_("defaultMuted")||!1}},{key:"lastVolume_",value:function lastVolume_(o){if(void 0===o||0===o)return this.cache_.lastVolume;this.cache_.lastVolume=o}},{key:"supportsFullScreen",value:function supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}},{key:"isFullscreen",value:function isFullscreen(o){if(void 0!==o){var s=this.isFullscreen_;return this.isFullscreen_=Boolean(o),this.isFullscreen_!==s&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_}},{key:"requestFullscreen",value:function requestFullscreen(o){this.isInPictureInPicture()&&this.exitPictureInPicture();var s=this;return new Promise((function(m,_){function offHandler(){s.off("fullscreenerror",errorHandler),s.off("fullscreenchange",changeHandler)}function changeHandler(){offHandler(),m()}function errorHandler(o,s){offHandler(),_(s)}s.one("fullscreenchange",changeHandler),s.one("fullscreenerror",errorHandler);var S=s.requestFullscreenHelper_(o);S&&(S.then(offHandler,offHandler),S.then(m,_))}))}},{key:"requestFullscreenHelper_",value:function requestFullscreenHelper_(o){var s,m=this;if(this.fsApi_.prefixed||(s=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==o&&(s=o)),this.fsApi_.requestFullscreen){var _=this.el_[this.fsApi_.requestFullscreen](s);return _&&_.then((function(){return m.isFullscreen(!0)}),(function(){return m.isFullscreen(!1)})),_}this.tech_.supportsFullScreen()&&!0==!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}},{key:"exitFullscreen",value:function exitFullscreen(){var o=this;return new Promise((function(s,m){function offHandler(){o.off("fullscreenerror",errorHandler),o.off("fullscreenchange",changeHandler)}function changeHandler(){offHandler(),s()}function errorHandler(o,s){offHandler(),m(s)}o.one("fullscreenchange",changeHandler),o.one("fullscreenerror",errorHandler);var _=o.exitFullscreenHelper_();_&&(_.then(offHandler,offHandler),_.then(s,m))}))}},{key:"exitFullscreenHelper_",value:function exitFullscreenHelper_(){var o=this;if(this.fsApi_.requestFullscreen){var s=lH[this.fsApi_.exitFullscreen]();return s&&silencePromise(s.then((function(){return o.isFullscreen(!1)}))),s}this.tech_.supportsFullScreen()&&!0==!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}},{key:"enterFullWindow",value:function enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=lH.documentElement.style.overflow,_on(lH,"keydown",this.boundFullWindowOnEscKey_),lH.documentElement.style.overflow="hidden",_addClass(lH.body,"vjs-full-window"),this.trigger("enterFullWindow")}},{key:"fullWindowOnEscKey",value:function fullWindowOnEscKey(o){dH.isEventKey(o,"Esc")&&!0===this.isFullscreen()&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}},{key:"exitFullWindow",value:function exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,_off(lH,"keydown",this.boundFullWindowOnEscKey_),lH.documentElement.style.overflow=this.docOrigOverflow,_removeClass(lH.body,"vjs-full-window"),this.trigger("exitFullWindow")}},{key:"disablePictureInPicture",value:function disablePictureInPicture(o){if(void 0===o)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",o),this.options_.disablePictureInPicture=o,this.trigger("disablepictureinpicturechanged")}},{key:"isInPictureInPicture",value:function isInPictureInPicture(o){return void 0!==o?(this.isInPictureInPicture_=!!o,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_}},{key:"requestPictureInPicture",value:function requestPictureInPicture(){var o=this;if(this.options_.enableDocumentPictureInPicture&&$V.documentPictureInPicture){var s=lH.createElement(this.el().tagName);return s.classList=this.el().classList,s.classList.add("vjs-pip-container"),this.posterImage&&s.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&s.appendChild(this.titleBar.el().cloneNode(!0)),s.appendChild(_createEl("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),$V.documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then((function(m){return copyStyleSheetsToWindow(m),o.el_.parentNode.insertBefore(s,o.el_),m.document.body.appendChild(o.el_),m.document.body.classList.add("vjs-pip-window"),o.player_.isInPictureInPicture(!0),o.player_.trigger("enterpictureinpicture"),m.addEventListener("pagehide",(function(m){var _=m.target.querySelector(".video-js");s.parentNode.replaceChild(_,s),o.player_.isInPictureInPicture(!1),o.player_.trigger("leavepictureinpicture")})),m}))}return"pictureInPictureEnabled"in lH&&!1===this.disablePictureInPicture()?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}},{key:"exitPictureInPicture",value:function exitPictureInPicture(){return $V.documentPictureInPicture&&$V.documentPictureInPicture.window?($V.documentPictureInPicture.window.close(),Promise.resolve()):"pictureInPictureEnabled"in lH?lH.exitPictureInPicture():void 0}},{key:"handleKeyDown",value:function handleKeyDown(o){var s=this.options_.userActions;if(s&&s.hotkeys){(function excludeElement(o){var s=o.tagName.toLowerCase();if(o.isContentEditable)return!0;if("input"===s)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(o.type);return-1!==["textarea"].indexOf(s)})(this.el_.ownerDocument.activeElement)||("function"==typeof s.hotkeys?s.hotkeys.call(this,o):this.handleHotkeys(o))}}},{key:"handleHotkeys",value:function handleHotkeys(o){var s=this.options_.userActions?this.options_.userActions.hotkeys:{},m=s.fullscreenKey,_=void 0===m?function(o){return dH.isEventKey(o,"f")}:m,S=s.muteKey,E=void 0===S?function(o){return dH.isEventKey(o,"m")}:S,A=s.playPauseKey,O=void 0===A?function(o){return dH.isEventKey(o,"k")||dH.isEventKey(o,"Space")}:A;if(_.call(this,o)){o.preventDefault(),o.stopPropagation();var H=UX.getComponent("FullscreenToggle");!1!==lH[this.fsApi_.fullscreenEnabled]&&H.prototype.handleClick.call(this,o)}else if(E.call(this,o)){o.preventDefault(),o.stopPropagation(),UX.getComponent("MuteToggle").prototype.handleClick.call(this,o)}else if(O.call(this,o)){o.preventDefault(),o.stopPropagation(),UX.getComponent("PlayToggle").prototype.handleClick.call(this,o)}}},{key:"canPlayType",value:function canPlayType(o){for(var s,m=0,_=this.options_.techOrder;m<_.length;m++){var S=_[m],E=TY.getTech(S);if(E||(E=UX.getComponent(S)),E){if(E.isSupported()&&(s=E.canPlayType(o)))return s}else OG.error('The "'.concat(S,'" tech is undefined. Skipped browser support check for that tech.'))}return""}},{key:"selectSource",value:function selectSource(o){var s,m=this,_=this.options_.techOrder.map((function(o){return[o,TY.getTech(o)]})).filter((function(o){var s=_slicedToArray$1(o,2),m=s[0],_=s[1];return _?_.isSupported():(OG.error('The "'.concat(m,'" tech is undefined. Skipped browser support check for that tech.')),!1)})),S=function findFirstPassingTechSourcePair(o,s,m){var _;return o.some((function(o){return s.some((function(s){if(_=m(o,s))return!0}))})),_},E=function finder(o,s){var _=_slicedToArray$1(o,2),S=_[0];if(_[1].canPlaySource(s,m.options_[S.toLowerCase()]))return{source:s,tech:S}};return s=this.options_.sourceOrder?S(o,_,function flip(o){return function(s,m){return o(m,s)}}(E)):S(_,o,E),s||!1}},{key:"handleSrc_",value:function handleSrc_(o,s){var m=this;if(void 0===o)return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();var _=LY(o);if(_.length){if(this.changingSrc_=!0,s||(this.cache_.sources=_),this.updateSourceCaches_(_[0]),setSource(this,_[0],(function(o,S){if(m.middleware_=S,s||(m.cache_.sources=_),m.updateSourceCaches_(o),m.src_(o))return _.length>1?m.handleSrc_(_.slice(1)):(m.changingSrc_=!1,m.setTimeout((function(){this.error({code:4,message:this.options_.notSupportedMessage})}),0),void m.triggerReady());!function setTech(o,s){o.forEach((function(o){return o.setTech&&o.setTech(s)}))}(S,m.tech_)})),_.length>1){var S=function retry(){m.error(null),m.handleSrc_(_.slice(1),!0)},E=function stopListeningForErrors(){m.off("error",S)};this.one("error",S),this.one("playing",E),this.resetRetryOnError_=function(){m.off("error",S),m.off("playing",E)}}}else this.setTimeout((function(){this.error({code:4,message:this.options_.notSupportedMessage})}),0)}},{key:"src",value:function src(o){return this.handleSrc_(o,!1)}},{key:"src_",value:function src_(o){var s=this,m=this.selectSource([o]);return!m||(FX(m.tech,this.techName_)?(this.ready((function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",o):this.techCall_("src",o.src),this.changingSrc_=!1}),!0),!1):(this.changingSrc_=!0,this.loadTech_(m.tech,m.source),this.tech_.ready((function(){s.changingSrc_=!1})),!1))}},{key:"load",value:function load(){this.tech_&&this.tech_.vhs?this.src(this.currentSource()):this.techCall_("load")}},{key:"reset",value:function reset(){var o=this;this.paused()?this.doReset_():silencePromise(this.play().then((function(){return o.doReset_()})))}},{key:"doReset_",value:function doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),wX(this)&&this.trigger("playerreset")}},{key:"resetControlBarUI_",value:function resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}},{key:"resetProgressBar_",value:function resetProgressBar_(){this.currentTime(0);var o=this.controlBar||{},s=o.currentTimeDisplay,m=o.durationDisplay,_=o.progressControl,S=o.remainingTimeDisplay,E=(_||{}).seekBar;s&&s.updateContent(),m&&m.updateContent(),S&&S.updateContent(),E&&(E.update(),E.loadProgressBar&&E.loadProgressBar.update())}},{key:"resetPlaybackRate_",value:function resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}},{key:"resetVolumeBar_",value:function resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}},{key:"currentSources",value:function currentSources(){var o=this.currentSource(),s=[];return 0!==Object.keys(o).length&&s.push(o),this.cache_.sources||s}},{key:"currentSource",value:function currentSource(){return this.cache_.source||{}}},{key:"currentSrc",value:function currentSrc(){return this.currentSource()&&this.currentSource().src||""}},{key:"currentType",value:function currentType(){return this.currentSource()&&this.currentSource().type||""}},{key:"preload",value:function preload(o){return void 0!==o?(this.techCall_("setPreload",o),void(this.options_.preload=o)):this.techGet_("preload")}},{key:"autoplay",value:function autoplay(o){if(void 0===o)return this.options_.autoplay||!1;var s;"string"==typeof o&&/(any|play|muted)/.test(o)||!0===o&&this.options_.normalizeAutoplay?(this.options_.autoplay=o,this.manualAutoplay_("string"==typeof o?o:"play"),s=!1):this.options_.autoplay=!!o,s=void 0===s?this.options_.autoplay:s,this.tech_&&this.techCall_("setAutoplay",s)}},{key:"playsinline",value:function playsinline(o){return void 0!==o&&(this.techCall_("setPlaysinline",o),this.options_.playsinline=o),this.techGet_("playsinline")}},{key:"loop",value:function loop(o){return void 0!==o?(this.techCall_("setLoop",o),void(this.options_.loop=o)):this.techGet_("loop")}},{key:"poster",value:function poster(o){if(void 0===o)return this.poster_;o||(o=""),o!==this.poster_&&(this.poster_=o,this.techCall_("setPoster",o),this.isPosterFromTech_=!1,this.trigger("posterchange"))}},{key:"handleTechPosterChange_",value:function handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var o=this.tech_.poster()||"";o!==this.poster_&&(this.poster_=o,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}},{key:"controls",value:function controls(o){if(void 0===o)return!!this.controls_;o=!!o,this.controls_!==o&&(this.controls_=o,this.usingNativeControls()&&this.techCall_("setControls",o),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}},{key:"usingNativeControls",value:function usingNativeControls(o){if(void 0===o)return!!this.usingNativeControls_;o=!!o,this.usingNativeControls_!==o&&(this.usingNativeControls_=o,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}},{key:"error",value:function error(o){var s=this;if(void 0===o)return this.error_||null;if(wG("beforeerror").forEach((function(m){var _=m(s,o);isObject(_)&&!Array.isArray(_)||"string"==typeof _||"number"==typeof _||null===_?o=_:s.log.error("please return a value that MediaError expects in beforeerror hooks")})),this.options_.suppressNotSupportedError&&o&&4===o.code){var m=function triggerSuppressedError(){this.error(o)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],m),void this.one("loadstart",(function(){this.off(["click","touchstart"],m)}))}if(null===o)return this.error_=null,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new MediaError(o),this.addClass("vjs-error"),OG.error("(CODE:".concat(this.error_.code," ").concat(MediaError.errorTypes[this.error_.code],")"),this.error_.message,this.error_),this.trigger("error"),wG("error").forEach((function(o){return o(s,s.error_)}))}},{key:"reportUserActivity",value:function reportUserActivity(o){this.userActivity_=!0}},{key:"userActive",value:function userActive(o){if(void 0===o)return this.userActive_;if((o=!!o)!==this.userActive_){if(this.userActive_=o,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",(function(o){o.stopPropagation(),o.preventDefault()})),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}},{key:"listenForUserActivity_",value:function listenForUserActivity_(){var o,s,m,_=_X(this,this.reportUserActivity),S=function handleMouseUpAndMouseLeave(s){_(),this.clearInterval(o)};this.on("mousedown",(function handleMouseDown(){_(),this.clearInterval(o),o=this.setInterval(_,250)})),this.on("mousemove",(function handleMouseMove(o){o.screenX===s&&o.screenY===m||(s=o.screenX,m=o.screenY,_())})),this.on("mouseup",S),this.on("mouseleave",S);var E,A=this.getChild("controlBar");!A||eX||HG||(A.on("mouseenter",(function(o){0!==this.player().options_.inactivityTimeout&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0})),A.on("mouseleave",(function(o){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))),this.on("keydown",_),this.on("keyup",_);this.setInterval((function activityCheck(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(E);var o=this.options_.inactivityTimeout;o<=0||(E=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),o))}}),250)}},{key:"playbackRate",value:function playbackRate(o){if(void 0===o)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",o)}},{key:"defaultPlaybackRate",value:function defaultPlaybackRate(o){return void 0!==o?this.techCall_("setDefaultPlaybackRate",o):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}},{key:"isAudio",value:function isAudio(o){if(void 0===o)return!!this.isAudio_;this.isAudio_=!!o}},{key:"enableAudioOnlyUI_",value:function enableAudioOnlyUI_(){var o=this;this.addClass("vjs-audio-only-mode");var s=this.children(),m=this.getChild("ControlBar"),_=m&&m.currentHeight();s.forEach((function(s){s!==m&&s.el_&&!s.hasClass("vjs-hidden")&&(s.hide(),o.audioOnlyCache_.hiddenChildren.push(s))})),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(_),this.trigger("audioonlymodechange")}},{key:"disableAudioOnlyUI_",value:function disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach((function(o){return o.show()})),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}},{key:"audioOnlyMode",value:function audioOnlyMode(o){var s=this;if("boolean"!=typeof o||o===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=o,o){var m=[];return this.isInPictureInPicture()&&m.push(this.exitPictureInPicture()),this.isFullscreen()&&m.push(this.exitFullscreen()),this.audioPosterMode()&&m.push(this.audioPosterMode(!1)),Promise.all(m).then((function(){return s.enableAudioOnlyUI_()}))}return Promise.resolve().then((function(){return s.disableAudioOnlyUI_()}))}},{key:"enablePosterModeUI_",value:function enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}},{key:"disablePosterModeUI_",value:function disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}},{key:"audioPosterMode",value:function audioPosterMode(o){var s=this;return"boolean"!=typeof o||o===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=o,o?this.audioOnlyMode()?this.audioOnlyMode(!1).then((function(){s.enablePosterModeUI_()})):Promise.resolve().then((function(){s.enablePosterModeUI_()})):Promise.resolve().then((function(){s.disablePosterModeUI_()})))}},{key:"addTextTrack",value:function addTextTrack(o,s,m){if(this.tech_)return this.tech_.addTextTrack(o,s,m)}},{key:"addRemoteTextTrack",value:function addRemoteTextTrack(o,s){if(this.tech_)return this.tech_.addRemoteTextTrack(o,s)}},{key:"removeRemoteTextTrack",value:function removeRemoteTextTrack(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=o.track;if(s||(s=o),this.tech_)return this.tech_.removeRemoteTextTrack(s)}},{key:"getVideoPlaybackQuality",value:function getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}},{key:"videoWidth",value:function videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}},{key:"videoHeight",value:function videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}},{key:"language",value:function language(o){if(void 0===o)return this.language_;this.language_!==String(o).toLowerCase()&&(this.language_=String(o).toLowerCase(),wX(this)&&this.trigger("languagechange"))}},{key:"languages",value:function languages(){return merge$1(Player.prototype.options_.languages,this.languages_)}},{key:"toJSON",value:function toJSON(){var o=merge$1(this.options_),s=o.tracks;o.tracks=[];for(var m=0;m<s.length;m++){var _=s[m];(_=merge$1(_)).player=void 0,o.tracks[m]=_}return o}},{key:"createModal",value:function createModal(o,s){var m=this;(s=s||{}).content=o||"";var _=new GX(this,s);return this.addChild(_),_.on("dispose",(function(){m.removeChild(_)})),_.open(),_}},{key:"updateCurrentBreakpoint_",value:function updateCurrentBreakpoint_(){if(this.responsive())for(var o=this.currentBreakpoint(),s=this.currentWidth(),m=0;m<fJ.length;m++){var _=fJ[m];if(s<=this.breakpoints_[_]){if(o===_)return;o&&this.removeClass(gJ[o]),this.addClass(gJ[_]),this.breakpoint_=_;break}}}},{key:"removeCurrentBreakpoint_",value:function removeCurrentBreakpoint_(){var o=this.currentBreakpointClass();this.breakpoint_="",o&&this.removeClass(o)}},{key:"breakpoints",value:function breakpoints(o){return void 0===o||(this.breakpoint_="",this.breakpoints_=Object.assign({},mJ,o),this.updateCurrentBreakpoint_()),Object.assign(this.breakpoints_)}},{key:"responsive",value:function responsive(o){return void 0===o?this.responsive_:(o=Boolean(o))!==this.responsive_?(this.responsive_=o,o?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),o):void 0}},{key:"currentBreakpoint",value:function currentBreakpoint(){return this.breakpoint_}},{key:"currentBreakpointClass",value:function currentBreakpointClass(){return gJ[this.breakpoint_]||""}},{key:"loadMedia",value:function loadMedia(o,s){var m=this;if(o&&"object"==typeof o){var _=this.crossOrigin();this.reset(),this.cache_.media=merge$1(o);var S=this.cache_.media,E=S.artist,A=S.artwork,O=S.description,H=S.poster,K=S.src,z=S.textTracks,G=S.title;!A&&H&&(this.cache_.media.artwork=[{src:H,type:PY(H)}]),_&&this.crossOrigin(_),K&&this.src(K),H&&this.poster(H),Array.isArray(z)&&z.forEach((function(o){return m.addRemoteTextTrack(o,!1)})),this.titleBar&&this.titleBar.update({title:G,description:O||E||""}),this.ready(s)}}},{key:"getMedia",value:function getMedia(){if(!this.cache_.media){var o=this.poster(),s=this.currentSources(),m=Array.prototype.map.call(this.remoteTextTracks(),(function(o){return{kind:o.kind,label:o.label,language:o.language,src:o.src}})),_={src:s,textTracks:m};return o&&(_.poster=o,_.artwork=[{src:_.poster,type:PY(_.poster)}]),_}return merge$1(this.cache_.media)}},{key:"debug",value:function debug(o){if(void 0===o)return this.debugEnabled_;o?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}},{key:"playbackRates",value:function playbackRates(o){if(void 0===o)return this.cache_.playbackRates;Array.isArray(o)&&o.every((function(o){return"number"==typeof o}))&&(this.cache_.playbackRates=o,this.trigger("playbackrateschange"))}}],[{key:"getTagSettings",value:function getTagSettings(o){var s={sources:[],tracks:[]},m=getAttributes(o),_=m["data-setup"];if(_hasClass(o,"vjs-fill")&&(m.fill=!0),_hasClass(o,"vjs-fluid")&&(m.fluid=!0),null!==_){var S=_slicedToArray$1(hH(_||"{}"),2),E=S[0],A=S[1];E&&OG.error(E),Object.assign(m,A)}if(Object.assign(s,m),o.hasChildNodes())for(var O=o.childNodes,H=0,K=O.length;H<K;H++){var z=O[H],G=z.nodeName.toLowerCase();"source"===G?s.sources.push(getAttributes(z)):"track"===G&&s.tracks.push(getAttributes(z))}return s}}]),Player}(UX);SY.names.forEach((function(o){var s=SY[o];yJ.prototype[s.getterName]=function(){return this.tech_?this.tech_[s.getterName]():(this[s.privateName]=this[s.privateName]||new s.ListClass,this[s.privateName])}})),yJ.prototype.crossorigin=yJ.prototype.crossOrigin,yJ.players={};var vJ=$V.navigator;yJ.prototype.options_={techOrder:TY.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:vJ&&(vJ.languages&&vJ.languages[0]||vJ.userLanguage||vJ.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,enableSmoothSeeking:!1},hJ.forEach((function(o){yJ.prototype["handleTech".concat(MX(o),"_")]=function(){return this.trigger(o)}})),UX.registerComponent("Player",yJ);var _J="plugin",bJ="activePlugins_",SJ={},TJ=function pluginExists(o){return SJ.hasOwnProperty(o)},kJ=function getPlugin(o){return TJ(o)?SJ[o]:void 0},CJ=function markPluginAsActive(o,s){o[bJ]=o[bJ]||{},o[bJ][s]=!0},wJ=function triggerSetupEvent(o,s,m){var _=(m?"before":"")+"pluginsetup";o.trigger(_,s),o.trigger(_+":"+s.name,s)},xJ=function createPluginFactory(o,s){return s.prototype.name=o,function(){wJ(this,{name:o,plugin:s,instance:null},!0);for(var m=arguments.length,_=new Array(m),S=0;S<m;S++)_[S]=arguments[S];var E=_construct(s,[this].concat(_));return this[o]=function(){return E},wJ(this,E.getEventHash()),E}},EJ=function(){function Plugin(o){if(_classCallCheck$1(this,Plugin),this.constructor===Plugin)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=o,this.log||(this.log=this.player.log.createLogger(this.name)),evented(this),delete this.trigger,stateful(this,this.constructor.defaultState),CJ(o,this.name),this.dispose=this.dispose.bind(this),o.on("dispose",this.dispose)}return _createClass$1(Plugin,[{key:"version",value:function version(){return this.constructor.VERSION}},{key:"getEventHash",value:function getEventHash(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o.name=this.name,o.plugin=this.constructor,o.instance=this,o}},{key:"trigger",value:function trigger(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _trigger(this.eventBusEl_,o,this.getEventHash(s))}},{key:"handleStateChanged",value:function handleStateChanged(o){}},{key:"dispose",value:function dispose(){var o=this.name,s=this.player;this.trigger("dispose"),this.off(),s.off("dispose",this.dispose),s[bJ][o]=!1,this.player=this.state=null,s[o]=xJ(o,SJ[o])}}],[{key:"isBasic",value:function isBasic(o){var s="string"==typeof o?kJ(o):o;return"function"==typeof s&&!Plugin.prototype.isPrototypeOf(s.prototype)}},{key:"registerPlugin",value:function registerPlugin(o,s){if("string"!=typeof o)throw new Error('Illegal plugin name, "'.concat(o,'", must be a string, was ').concat(typeof o,"."));if(TJ(o))OG.warn('A plugin named "'.concat(o,'" already exists. You may want to avoid re-registering plugins!'));else if(yJ.prototype.hasOwnProperty(o))throw new Error('Illegal plugin name, "'.concat(o,'", cannot share a name with an existing player method!'));if("function"!=typeof s)throw new Error('Illegal plugin for "'.concat(o,'", must be a function, was ').concat(typeof s,"."));return SJ[o]=s,o!==_J&&(Plugin.isBasic(s)?yJ.prototype[o]=function createBasicPlugin(o,s){var m=function basicPluginWrapper(){wJ(this,{name:o,plugin:s,instance:null},!0);var m=s.apply(this,arguments);return CJ(this,o),wJ(this,{name:o,plugin:s,instance:m}),m};return Object.keys(s).forEach((function(o){m[o]=s[o]})),m}(o,s):yJ.prototype[o]=xJ(o,s)),s}},{key:"deregisterPlugin",value:function deregisterPlugin(o){if(o===_J)throw new Error("Cannot de-register base plugin.");TJ(o)&&(delete SJ[o],delete yJ.prototype[o])}},{key:"getPlugins",value:function getPlugins(){var o;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(SJ)).forEach((function(s){var m=kJ(s);m&&((o=o||{})[s]=m)})),o}},{key:"getPluginVersion",value:function getPluginVersion(o){var s=kJ(o);return s&&s.VERSION||""}}]),Plugin}();function deprecateForMajor(o,s,m,_){return function deprecate(o,s){var m=!1;return function(){m||OG.warn(o),m=!0;for(var _=arguments.length,S=new Array(_),E=0;E<_;E++)S[E]=arguments[E];return s.apply(this,S)}}("".concat(s," is deprecated and will be removed in ").concat(o,".0; please use ").concat(m," instead."),_)}EJ.getPlugin=kJ,EJ.BASE_PLUGIN_NAME=_J,EJ.registerPlugin(_J,EJ),yJ.prototype.usingPlugin=function(o){return!!this[bJ]&&!0===this[bJ][o]},yJ.prototype.hasPlugin=function(o){return!!TJ(o)};var IJ=function normalizeId(o){return 0===o.indexOf("#")?o.slice(1):o};function videojs(o,s,m){var _=videojs.getPlayer(o);if(_)return s&&OG.warn('Player "'.concat(o,'" is already initialised. Options will not be applied.')),m&&_.ready(m),_;var S="string"==typeof o?rX("#"+IJ(o)):o;if(!isEl(S))throw new TypeError("The element or ID supplied is not valid. (videojs)");var E="getRootNode"in S&&S.getRootNode()instanceof $V.ShadowRoot?S.getRootNode():S.ownerDocument.body;S.ownerDocument.defaultView&&E.contains(S)||OG.warn("The element supplied is not included in the DOM"),!0===(s=s||{}).restoreEl&&(s.restoreEl=(S.parentNode&&S.parentNode.hasAttribute("data-vjs-player")?S.parentNode:S).cloneNode(!0)),wG("beforesetup").forEach((function(o){var m=o(S,merge$1(s));isObject(m)&&!Array.isArray(m)?s=merge$1(s,m):OG.error("please return an object in beforesetup hooks")}));var A=UX.getComponent("Player");return _=new A(S,s,m),wG("setup").forEach((function(o){return o(_)})),_}if(videojs.hooks_=CG,videojs.hooks=wG,videojs.hook=function hook(o,s){wG(o,s)},videojs.hookOnce=function hookOnce(o,s){wG(o,[].concat(s).map((function(s){return function wrapper(){return xG(o,wrapper),s.apply(void 0,arguments)}})))},videojs.removeHook=xG,!0!==$V.VIDEOJS_NO_DYNAMIC_STYLE&&isReal()){var AJ=rX(".vjs-styles-defaults");if(!AJ){AJ=cX("vjs-styles-defaults");var PJ=rX("head");PJ&&PJ.insertBefore(AJ,PJ.firstChild),dX(AJ,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid:not(.vjs-audio-only-mode) {\n        padding-top: 56.25%\n      }\n    ")}}autoSetupTimeout(1,videojs),videojs.VERSION=kG,videojs.options=yJ.prototype.options_,videojs.getPlayers=function(){return yJ.players},videojs.getPlayer=function(o){var s,m=yJ.players;if("string"==typeof o){var _=IJ(o),S=m[_];if(S)return S;s=rX("#"+_)}else s=o;if(isEl(s)){var E=s,A=E.player,O=E.playerId;if(A||m[O])return A||m[O]}},videojs.getAllPlayers=function(){return Object.keys(yJ.players).map((function(o){return yJ.players[o]})).filter(Boolean)},videojs.players=yJ.players,videojs.getComponent=UX.getComponent,videojs.registerComponent=function(o,s){return TY.isTech(s)&&OG.warn("The ".concat(o," tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)")),UX.registerComponent.call(UX,o,s)},videojs.getTech=TY.getTech,videojs.registerTech=TY.registerTech,videojs.use=function use(o,s){kY[o]=kY[o]||[],kY[o].push(s)},Object.defineProperty(videojs,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(videojs.middleware,"TERMINATOR",{value:wY,writeable:!1,enumerable:!0}),videojs.browser=nX,videojs.obj=jG,videojs.mergeOptions=deprecateForMajor(9,"videojs.mergeOptions","videojs.obj.merge",merge$1),videojs.defineLazyProperty=deprecateForMajor(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",defineLazyProperty),videojs.bind=deprecateForMajor(9,"videojs.bind","native Function.prototype.bind",_X),videojs.registerPlugin=EJ.registerPlugin,videojs.deregisterPlugin=EJ.deregisterPlugin,videojs.plugin=function(o,s){return OG.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),EJ.registerPlugin(o,s)},videojs.getPlugins=EJ.getPlugins,videojs.getPlugin=EJ.getPlugin,videojs.getPluginVersion=EJ.getPluginVersion,videojs.addLanguage=function(o,s){return o=(""+o).toLowerCase(),videojs.options.languages=merge$1(videojs.options.languages,_defineProperty$2({},o,s)),videojs.options.languages[o]},videojs.log=OG,videojs.createLogger=MG,videojs.time=$X,videojs.createTimeRange=deprecateForMajor(9,"videojs.createTimeRange","videojs.time.createTimeRanges",createTimeRanges$1),videojs.createTimeRanges=deprecateForMajor(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",createTimeRanges$1),videojs.formatTime=deprecateForMajor(9,"videojs.formatTime","videojs.time.formatTime",formatTime),videojs.setFormatTime=deprecateForMajor(9,"videojs.setFormatTime","videojs.time.setFormatTime",setFormatTime),videojs.resetFormatTime=deprecateForMajor(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",resetFormatTime),videojs.parseUrl=deprecateForMajor(9,"videojs.parseUrl","videojs.url.parseUrl",uY),videojs.isCrossOrigin=deprecateForMajor(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",dY),videojs.EventTarget=kX,videojs.any=_any,videojs.on=_on,videojs.one=_one,videojs.off=_off,videojs.trigger=_trigger,videojs.xhr=CH,videojs.TextTrack=gY,videojs.AudioTrack=mY,videojs.VideoTrack=yY,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(o){videojs[o]=function(){return OG.warn("videojs.".concat(o,"() is deprecated; use videojs.dom.").concat(o,"() instead")),oX[o].apply(null,arguments)}})),videojs.computedStyle=deprecateForMajor(9,"videojs.computedStyle","videojs.dom.computedStyle",computedStyle),videojs.dom=oX,videojs.fn=TX,videojs.num=QY,videojs.str=NX,videojs.url=hY;/*! @name videojs-contrib-quality-levels @version 4.0.0 @license Apache-2.0 */
var LJ=_createClass$1((function QualityLevel(o){_classCallCheck$1(this,QualityLevel);var s=this;return s.id=o.id,s.label=s.id,s.width=o.width,s.height=o.height,s.bitrate=o.bandwidth,s.frameRate=o.frameRate,s.enabled_=o.enabled,Object.defineProperty(s,"enabled",{get:function get(){return s.enabled_()},set:function set(o){s.enabled_(o)}}),s})),DJ=function(o){_inherits$1(QualityLevelList,o);var s=_createSuper$1(QualityLevelList);function QualityLevelList(){var o;_classCallCheck$1(this,QualityLevelList);var m=_assertThisInitialized(o=s.call(this));return m.levels_=[],m.selectedIndex_=-1,Object.defineProperty(m,"selectedIndex",{get:function get(){return m.selectedIndex_}}),Object.defineProperty(m,"length",{get:function get(){return m.levels_.length}}),m[Symbol.iterator]=function(){return m.levels_.values()},_possibleConstructorReturn(o,m)}return _createClass$1(QualityLevelList,[{key:"addQualityLevel",value:function addQualityLevel(o){var s=this.getQualityLevelById(o.id);if(s)return s;var m=this.levels_.length;return s=new LJ(o),""+m in this||Object.defineProperty(this,m,{get:function get(){return this.levels_[m]}}),this.levels_.push(s),this.trigger({qualityLevel:s,type:"addqualitylevel"}),s}},{key:"removeQualityLevel",value:function removeQualityLevel(o){for(var s=null,m=0,_=this.length;m<_;m++)if(this[m]===o){s=this.levels_.splice(m,1)[0],this.selectedIndex_===m?this.selectedIndex_=-1:this.selectedIndex_>m&&this.selectedIndex_--;break}return s&&this.trigger({qualityLevel:o,type:"removequalitylevel"}),s}},{key:"getQualityLevelById",value:function getQualityLevelById(o){for(var s=0,m=this.length;s<m;s++){var _=this[s];if(_.id===o)return _}return null}},{key:"dispose",value:function dispose(){this.selectedIndex_=-1,this.levels_.length=0}}]),QualityLevelList}(videojs.EventTarget);for(var RJ in DJ.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"},DJ.prototype.allowedEvents_)DJ.prototype["on"+RJ]=null;var OJ="4.0.0",MJ=function qualityLevels(o){return function initPlugin$1(o,s){var m=o.qualityLevels,_=new DJ;return o.on("dispose",(function disposeHandler(){_.dispose(),o.qualityLevels=m,o.off("dispose",disposeHandler)})),o.qualityLevels=function(){return _},o.qualityLevels.VERSION=OJ,_}(this,videojs.obj.merge({},o))};videojs.registerPlugin("qualityLevels",MJ),MJ.VERSION=OJ;/*! @name @videojs/http-streaming @version 3.10.0 @license Apache-2.0 */
var FJ=QH,NJ=function resolveManifestRedirect(o,s){return s&&s.responseURL&&o!==s.responseURL?s.responseURL:o},UJ=function logger(o){return videojs.log.debug?videojs.log.debug.bind(videojs,"VHS:","".concat(o," >")):function(){}};function merge$2(){for(var o=videojs.obj||videojs,s=o.merge||o.mergeOptions,m=arguments.length,_=new Array(m),S=0;S<m;S++)_[S]=arguments[S];return s.apply(o,_)}function createTimeRanges$2(){for(var o=videojs.time||videojs,s=o.createTimeRanges||o.createTimeRanges,m=arguments.length,_=new Array(m),S=0;S<m;S++)_[S]=arguments[S];return s.apply(o,_)}var BJ=1/30,jJ=.1,$J=function filterRanges(o,s){var m,_=[];if(o&&o.length)for(m=0;m<o.length;m++)s(o.start(m),o.end(m))&&_.push([o.start(m),o.end(m)]);return createTimeRanges$2(_)},VJ=function findRange(o,s){return $J(o,(function(o,m){return o-jJ<=s&&m+jJ>=s}))},HJ=function findNextRange(o,s){return $J(o,(function(o){return o-BJ>=s}))},KJ=function printableRange(o){var s=[];if(!o||!o.length)return"";for(var m=0;m<o.length;m++)s.push(o.start(m)+" => "+o.end(m));return s.join(", ")},zJ=function timeRangesToArray(o){for(var s=[],m=0;m<o.length;m++)s.push({start:o.start(m),end:o.end(m)});return s},WJ=function lastBufferedEnd(o){if(o&&o.length&&o.end)return o.end(o.length-1)},GJ=function timeAheadOf(o,s){var m=0;if(!o||!o.length)return m;for(var _=0;_<o.length;_++){var S=o.start(_),E=o.end(_);s>E||(m+=s>S&&s<=E?E-s:E-S)}return m},qJ=function segmentDurationWithParts(o,s){if(!s.preload)return s.duration;var m=0;return(s.parts||[]).forEach((function(o){m+=o.duration})),(s.preloadHints||[]).forEach((function(s){"PART"===s.type&&(m+=o.partTargetDuration)})),m},XJ=function getPartsAndSegments(o){return(o.segments||[]).reduce((function(o,s,m){return s.parts?s.parts.forEach((function(_,S){o.push({duration:_.duration,segmentIndex:m,partIndex:S,part:_,segment:s})})):o.push({duration:s.duration,segmentIndex:m,partIndex:null,segment:s,part:null}),o}),[])},YJ=function getLastParts(o){var s=o.segments&&o.segments.length&&o.segments[o.segments.length-1];return s&&s.parts||[]},QJ=function getKnownPartCount(o){var s=o.preloadSegment;if(s){var m=s.parts,_=(s.preloadHints||[]).reduce((function(o,s){return o+("PART"===s.type?1:0)}),0);return _+=m&&m.length?m.length:0}},JJ=function liveEdgeDelay(o,s){if(s.endList)return 0;if(o&&o.suggestedPresentationDelay)return o.suggestedPresentationDelay;var m=YJ(s).length>0;return m&&s.serverControl&&s.serverControl.partHoldBack?s.serverControl.partHoldBack:m&&s.partTargetDuration?3*s.partTargetDuration:s.serverControl&&s.serverControl.holdBack?s.serverControl.holdBack:s.targetDuration?3*s.targetDuration:0},ZJ=function intervalDuration(o,s,m){if(void 0===s&&(s=o.mediaSequence+o.segments.length),s<o.mediaSequence)return 0;var _=function backwardDuration(o,s){var m=0,_=s-o.mediaSequence,S=o.segments[_];if(S){if(void 0!==S.start)return{result:S.start,precise:!0};if(void 0!==S.end)return{result:S.end-S.duration,precise:!0}}for(;_--;){if(void 0!==(S=o.segments[_]).end)return{result:m+S.end,precise:!0};if(m+=qJ(o,S),void 0!==S.start)return{result:m+S.start,precise:!0}}return{result:m,precise:!1}}(o,s);if(_.precise)return _.result;var S=function forwardDuration(o,s){for(var m,_=0,S=s-o.mediaSequence;S<o.segments.length;S++){if(void 0!==(m=o.segments[S]).start)return{result:m.start-_,precise:!0};if(_+=qJ(o,m),void 0!==m.end)return{result:m.end-_,precise:!0}}return{result:-1,precise:!1}}(o,s);return S.precise?S.result:_.result+m},eZ=function duration(o,s,m){if(!o)return 0;if("number"!=typeof m&&(m=0),void 0===s){if(o.totalDuration)return o.totalDuration;if(!o.endList)return $V.Infinity}return ZJ(o,s,m)},tZ=function sumDurations(o){var s=o.defaultDuration,m=o.durationList,_=o.startIndex,S=o.endIndex,E=0;if(_>S){var A=[S,_];_=A[0],S=A[1]}if(_<0){for(var O=_;O<Math.min(0,S);O++)E+=s;_=0}for(var H=_;H<S;H++)E+=m[H].duration;return E},nZ=function playlistEnd(o,s,m,_){if(!o||!o.segments)return null;if(o.endList)return eZ(o);if(null===s)return null;s=s||0;var S=ZJ(o,o.mediaSequence+o.segments.length,s);return m&&(S-=_="number"==typeof _?_:JJ(null,o)),Math.max(0,S)},rZ=function isExcluded(o){return o.excludeUntil&&o.excludeUntil>Date.now()},iZ=function isIncompatible(o){return o.excludeUntil&&o.excludeUntil===1/0},aZ=function isEnabled(o){var s=rZ(o);return!o.disabled&&!s},oZ=function hasAttribute(o,s){return s.attributes&&s.attributes[o]},sZ=function isLowestEnabledRendition(o,s){if(1===o.playlists.length)return!0;var m=s.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===o.playlists.filter((function(o){return!!aZ(o)&&(o.attributes.BANDWIDTH||0)<m})).length},uZ=function playlistMatch(o,s){return!(!o&&!s||!o&&s||o&&!s)&&(o===s||(!(!o.id||!s.id||o.id!==s.id)||(!(!o.resolvedUri||!s.resolvedUri||o.resolvedUri!==s.resolvedUri)||!(!o.uri||!s.uri||o.uri!==s.uri))))},lZ=function someAudioVariant(o,s){var m=o&&o.mediaGroups&&o.mediaGroups.AUDIO||{},_=!1;for(var S in m){for(var E in m[S])if(_=s(m[S][E]))break;if(_)break}return!!_},cZ=function isAudioOnly(o){if(!o||!o.playlists||!o.playlists.length)return lZ(o,(function(o){return o.playlists&&o.playlists.length||o.uri}));for(var s=function _loop2(){var s=o.playlists[m],_=s.attributes&&s.attributes.CODECS;return _&&_.split(",").every((function(o){return fK(o)}))||lZ(o,(function(o){return uZ(s,o)}))?"continue":{v:!1}},m=0;m<o.playlists.length;m++){var _=s();if("continue"!==_&&"object"==typeof _)return _.v}return!0},dZ={liveEdgeDelay:JJ,duration:eZ,seekable:function seekable(o,s,m){var _=s||0,S=nZ(o,s,!0,m);return null===S?createTimeRanges$2():(S<_&&(S=_),createTimeRanges$2(_,S))},getMediaInfoForTime:function getMediaInfoForTime(o){for(var s=o.playlist,m=o.currentTime,_=o.startingSegmentIndex,S=o.startingPartIndex,E=o.startTime,A=o.exactManifestTimings,O=m-E,H=XJ(s),K=0,z=0;z<H.length;z++){var G=H[z];if(_===G.segmentIndex&&("number"!=typeof S||"number"!=typeof G.partIndex||S===G.partIndex)){K=z;break}}if(O<0){if(K>0)for(var q=K-1;q>=0;q--){var X=H[q];if(O+=X.duration,A){if(O<0)continue}else if(O+BJ<=0)continue;return{partIndex:X.partIndex,segmentIndex:X.segmentIndex,startTime:E-tZ({defaultDuration:s.targetDuration,durationList:H,startIndex:K,endIndex:q})}}return{partIndex:H[0]&&H[0].partIndex||null,segmentIndex:H[0]&&H[0].segmentIndex||0,startTime:m}}if(K<0){for(var J=K;J<0;J++)if((O-=s.targetDuration)<0)return{partIndex:H[0]&&H[0].partIndex||null,segmentIndex:H[0]&&H[0].segmentIndex||0,startTime:m};K=0}for(var ae=K;ae<H.length;ae++){var pe=H[ae];O-=pe.duration;var me=pe.duration>BJ;if(!(0===O)&&!(me&&O+BJ>=0)||ae===H.length-1){if(A){if(O>0)continue}else if(O-BJ>=0)continue;return{partIndex:pe.partIndex,segmentIndex:pe.segmentIndex,startTime:E+tZ({defaultDuration:s.targetDuration,durationList:H,startIndex:K,endIndex:ae})}}}return{segmentIndex:H[H.length-1].segmentIndex,partIndex:H[H.length-1].partIndex,startTime:m}},isEnabled:aZ,isDisabled:function isDisabled(o){return o.disabled},isExcluded:rZ,isIncompatible:iZ,playlistEnd:nZ,isAes:function isAes(o){for(var s=0;s<o.segments.length;s++)if(o.segments[s].key)return!0;return!1},hasAttribute:oZ,estimateSegmentRequestTime:function estimateSegmentRequestTime(o,s,m){var _=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return oZ("BANDWIDTH",m)?(o*m.attributes.BANDWIDTH-8*_)/s:NaN},isLowestEnabledRendition:sZ,isAudioOnly:cZ,playlistMatch:uZ,segmentDurationWithParts:qJ},hZ=videojs.log,pZ=function createPlaylistID(o,s){return"".concat(o,"-").concat(s)},fZ=function groupID(o,s,m){return"placeholder-uri-".concat(o,"-").concat(s,"-").concat(m)},gZ=function forEachMediaGroup(o,s){o.mediaGroups&&["AUDIO","SUBTITLES"].forEach((function(m){if(o.mediaGroups[m])for(var _ in o.mediaGroups[m])for(var S in o.mediaGroups[m][_]){var E=o.mediaGroups[m][_][S];s(E,m,_,S)}}))},mZ=function setupMediaPlaylist(o){var s=o.playlist,m=o.uri,_=o.id;s.id=_,s.playlistErrors_=0,m&&(s.uri=m),s.attributes=s.attributes||{}},yZ=function addPropertiesToMain(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fZ;o.uri=s;for(var _=0;_<o.playlists.length;_++)if(!o.playlists[_].uri){var S="placeholder-uri-".concat(_);o.playlists[_].uri=S}var E=cZ(o);gZ(o,(function(s,_,S,A){if(!s.playlists||!s.playlists.length){if(E&&"AUDIO"===_&&!s.uri)for(var O=0;O<o.playlists.length;O++){var H=o.playlists[O];if(H.attributes&&H.attributes.AUDIO&&H.attributes.AUDIO===S)return}s.playlists=[gH({},s)]}s.playlists.forEach((function(s,E){var O=m(_,S,A,s),H=pZ(E,O);s.uri?s.resolvedUri=s.resolvedUri||FJ(o.uri,s.uri):(s.uri=0===E?O:H,s.resolvedUri=s.uri),s.id=s.id||H,s.attributes=s.attributes||{},o.playlists[s.id]=s,o.playlists[s.uri]=s}))})),function setupMediaPlaylists(o){for(var s=o.playlists.length;s--;){var m=o.playlists[s];mZ({playlist:m,id:pZ(s,m.uri)}),m.resolvedUri=FJ(o.uri,m.uri),o.playlists[m.id]=m,o.playlists[m.uri]=m,m.attributes.BANDWIDTH||hZ.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}}(o),function resolveMediaGroupUris(o){gZ(o,(function(s){s.uri&&(s.resolvedUri=FJ(o.uri,s.uri))}))}(o)},vZ=function(){function DateRangesStorage(){_classCallCheck$1(this,DateRangesStorage),this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}return _createClass$1(DateRangesStorage,[{key:"setOffset",value:function setOffset(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(null===this.offset_&&o.length){var s=_slicedToArray$1(o,1)[0];void 0!==s.programDateTime&&(this.offset_=s.programDateTime/1e3)}}},{key:"setPendingDateRanges",value:function setPendingDateRanges(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(o.length){var s=_slicedToArray$1(o,1)[0].startDate.getTime();this.trimProcessedDateRanges_(s),this.pendingDateRanges_=o.reduce((function(o,s){return o.set(s.id,s),o}),new Map)}}},{key:"processDateRange",value:function processDateRange(o){this.pendingDateRanges_.delete(o.id),this.processedDateRanges_.set(o.id,o)}},{key:"getDateRangesToProcess",value:function getDateRangesToProcess(){var o=this;if(null===this.offset_)return[];var s={},m=[];this.pendingDateRanges_.forEach((function(_,S){if(!o.processedDateRanges_.has(S)&&(_.startTime=_.startDate.getTime()/1e3-o.offset_,_.processDateRange=function(){return o.processDateRange(_)},m.push(_),_.class))if(s[_.class]){var E=s[_.class].push(_);_.classListIndex=E-1}else s[_.class]=[_],_.classListIndex=0}));for(var _=0,S=m;_<S.length;_++){var E=S[_],A=s[E.class]||[];E.endDate?E.endTime=E.endDate.getTime()/1e3-this.offset_:E.endOnNext&&A[E.classListIndex+1]?E.endTime=A[E.classListIndex+1].startTime:E.duration?E.endTime=E.startTime+E.duration:E.plannedDuration?E.endTime=E.startTime+E.plannedDuration:E.endTime=E.startTime}return m}},{key:"trimProcessedDateRanges_",value:function trimProcessedDateRanges_(o){var s=this;new Map(this.processedDateRanges_).forEach((function(m,_){m.startDate.getTime()<o&&s.processedDateRanges_.delete(_)}))}}]),DateRangesStorage}(),_Z=videojs.EventTarget,bZ=function updateSegment(o,s){if(!o)return s;var m=merge$2(o,s);if(o.preloadHints&&!s.preloadHints&&delete m.preloadHints,o.parts&&!s.parts)delete m.parts;else if(o.parts&&s.parts)for(var _=0;_<s.parts.length;_++)o.parts&&o.parts[_]&&(m.parts[_]=merge$2(o.parts[_],s.parts[_]));return!o.skipped&&s.skipped&&(m.skipped=!1),o.preload&&!s.preload&&(m.preload=!1),m},SZ=function resolveSegmentUris(o,s){!o.resolvedUri&&o.uri&&(o.resolvedUri=FJ(s,o.uri)),o.key&&!o.key.resolvedUri&&(o.key.resolvedUri=FJ(s,o.key.uri)),o.map&&!o.map.resolvedUri&&(o.map.resolvedUri=FJ(s,o.map.uri)),o.map&&o.map.key&&!o.map.key.resolvedUri&&(o.map.key.resolvedUri=FJ(s,o.map.key.uri)),o.parts&&o.parts.length&&o.parts.forEach((function(o){o.resolvedUri||(o.resolvedUri=FJ(s,o.uri))})),o.preloadHints&&o.preloadHints.length&&o.preloadHints.forEach((function(o){o.resolvedUri||(o.resolvedUri=FJ(s,o.uri))}))},TZ=function getAllSegments(o){var s=o.segments||[],m=o.preloadSegment;if(m&&m.parts&&m.parts.length){if(m.preloadHints)for(var _=0;_<m.preloadHints.length;_++)if("MAP"===m.preloadHints[_].type)return s;m.duration=o.targetDuration,m.preload=!0,s.push(m)}return s},kZ=function isPlaylistUnchanged(o,s){return o===s||o.segments&&s.segments&&o.segments.length===s.segments.length&&o.endList===s.endList&&o.mediaSequence===s.mediaSequence&&o.preloadSegment===s.preloadSegment},CZ=function updateMain$1(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kZ,_=merge$2(o,{}),S=_.playlists[s.id];if(!S)return null;if(m(S,s))return null;s.segments=TZ(s);var E=merge$2(S,s);if(E.preloadSegment&&!s.preloadSegment&&delete E.preloadSegment,S.segments){if(s.skip){s.segments=s.segments||[];for(var A=0;A<s.skip.skippedSegments;A++)s.segments.unshift({skipped:!0})}E.segments=function updateSegments(o,s,m){var _=o.slice(),S=s.slice();m=m||0;for(var E,A=[],O=0;O<S.length;O++){var H=_[O+m],K=S[O];H?(E=H.map||E,A.push(bZ(H,K))):(E&&!K.map&&(K.map=E),A.push(K))}return A}(S.segments,s.segments,s.mediaSequence-S.mediaSequence)}E.segments.forEach((function(o){SZ(o,E.resolvedUri)}));for(var O=0;O<_.playlists.length;O++)_.playlists[O].id===s.id&&(_.playlists[O]=E);return _.playlists[s.id]=E,_.playlists[s.uri]=E,gZ(o,(function(o,m,_,S){if(o.playlists)for(var A=0;A<o.playlists.length;A++)s.id===o.playlists[A].id&&(o.playlists[A]=E)})),_},wZ=function refreshDelay(o,s){var m=o.segments||[],_=m[m.length-1],S=_&&_.parts&&_.parts[_.parts.length-1],E=S&&S.duration||_&&_.duration;return s&&E?1e3*E:500*(o.partTargetDuration||o.targetDuration||10)},xZ=function(o){_inherits$1(PlaylistLoader,o);var s=_createSuper$1(PlaylistLoader);function PlaylistLoader(o,m){var _,S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(_classCallCheck$1(this,PlaylistLoader),_=s.call(this),!o)throw new Error("A non-empty playlist URL or object is required");_.logger_=UJ("PlaylistLoader");var E=S.withCredentials,A=void 0!==E&&E;_.src=o,_.vhs_=m,_.withCredentials=A,_.addDateRangesToTextTrack_=S.addDateRangesToTextTrack;var O=m.options_;return _.customTagParsers=O&&O.customTagParsers||[],_.customTagMappers=O&&O.customTagMappers||[],_.llhls=O&&O.llhls,_.dateRangesStorage_=new vZ,_.state="HAVE_NOTHING",_.handleMediaupdatetimeout_=_.handleMediaupdatetimeout_.bind(_assertThisInitialized(_)),_.on("mediaupdatetimeout",_.handleMediaupdatetimeout_),_.on("loadedplaylist",_.handleLoadedPlaylist_.bind(_assertThisInitialized(_))),_}return _createClass$1(PlaylistLoader,[{key:"handleLoadedPlaylist_",value:function handleLoadedPlaylist_(){var o=this.media();if(o){this.dateRangesStorage_.setOffset(o.segments),this.dateRangesStorage_.setPendingDateRanges(o.dateRanges);var s=this.dateRangesStorage_.getDateRangesToProcess();s.length&&this.addDateRangesToTextTrack_&&this.addDateRangesToTextTrack_(s)}}},{key:"handleMediaupdatetimeout_",value:function handleMediaupdatetimeout_(){var o=this;if("HAVE_METADATA"===this.state){var s=this.media(),m=FJ(this.main.uri,s.uri);this.llhls&&(m=function addLLHLSQueryDirectives(o,s){if(s.endList||!s.serverControl)return o;var m={};if(s.serverControl.canBlockReload){var _=s.preloadSegment,S=s.mediaSequence+s.segments.length;if(_){var E=_.parts||[],A=QJ(s)-1;A>-1&&A!==E.length-1&&(m._HLS_part=A),(A>-1||E.length)&&S--}m._HLS_msn=S}if(s.serverControl&&s.serverControl.canSkipUntil&&(m._HLS_skip=s.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(m).length){var O=new $V.URL(o);["_HLS_skip","_HLS_msn","_HLS_part"].forEach((function(o){m.hasOwnProperty(o)&&O.searchParams.set(o,m[o])})),o=O.toString()}return o}(m,s)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:m,withCredentials:this.withCredentials},(function(s,m){if(o.request)return s?o.playlistRequestError(o.request,o.media(),"HAVE_METADATA"):void o.haveMetadata({playlistString:o.request.responseText,url:o.media().uri,id:o.media().id})}))}}},{key:"playlistRequestError",value:function playlistRequestError(o,s,m){var _=s.uri,S=s.id;this.request=null,m&&(this.state=m),this.error={playlist:this.main.playlists[S],status:o.status,message:"HLS playlist request error at URL: ".concat(_,"."),responseText:o.responseText,code:o.status>=500?4:2},this.trigger("error")}},{key:"parseManifest_",value:function parseManifest_(o){var s=this,m=o.url;return function parseManifest(o){var s=o.onwarn,m=o.oninfo,_=o.manifestString,S=o.customTagParsers,E=void 0===S?[]:S,A=o.customTagMappers,O=void 0===A?[]:A,H=o.llhls,K=new sK;s&&K.on("warn",s),m&&K.on("info",m),E.forEach((function(o){return K.addParser(o)})),O.forEach((function(o){return K.addTagMapper(o)})),K.push(_),K.end();var z=K.manifest;if(H||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach((function(o){z.hasOwnProperty(o)&&delete z[o]})),z.segments&&z.segments.forEach((function(o){["parts","preloadHints"].forEach((function(s){o.hasOwnProperty(s)&&delete o[s]}))}))),!z.targetDuration){var G=10;z.segments&&z.segments.length&&(G=z.segments.reduce((function(o,s){return Math.max(o,s.duration)}),0)),s&&s({message:"manifest has no targetDuration defaulting to ".concat(G)}),z.targetDuration=G}var q=YJ(z);if(q.length&&!z.partTargetDuration){var X=q.reduce((function(o,s){return Math.max(o,s.duration)}),0);s&&(s({message:"manifest has no partTargetDuration defaulting to ".concat(X)}),hZ.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),z.partTargetDuration=X}return z}({onwarn:function onwarn(o){var _=o.message;return s.logger_("m3u8-parser warn for ".concat(m,": ").concat(_))},oninfo:function oninfo(o){var _=o.message;return s.logger_("m3u8-parser info for ".concat(m,": ").concat(_))},manifestString:o.manifestString,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}},{key:"haveMetadata",value:function haveMetadata(o){var s=o.playlistString,m=o.playlistObject,_=o.url,S=o.id;this.request=null,this.state="HAVE_METADATA";var E=m||this.parseManifest_({url:_,manifestString:s});E.lastRequest=Date.now(),mZ({playlist:E,uri:_,id:S});var A=CZ(this.main,E);this.targetDuration=E.partTargetDuration||E.targetDuration,this.pendingMedia_=null,A?(this.main=A,this.media_=this.main.playlists[S]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(wZ(this.media(),!!A)),this.trigger("loadedplaylist")}},{key:"dispose",value:function dispose(){this.trigger("dispose"),this.stopRequest(),$V.clearTimeout(this.mediaUpdateTimeout),$V.clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new vZ,this.off()}},{key:"stopRequest",value:function stopRequest(){if(this.request){var o=this.request;this.request=null,o.onreadystatechange=null,o.abort()}}},{key:"media",value:function media(o,s){var m=this;if(!o)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof o){if(!this.main.playlists[o])throw new Error("Unknown playlist URI: "+o);o=this.main.playlists[o]}if($V.clearTimeout(this.finalRenditionTimeout),s){var _=(o.partTargetDuration||o.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=$V.setTimeout(this.media.bind(this,o,!1),_)}else{var S=this.state,E=!this.media_||o.id!==this.media_.id,A=this.main.playlists[o.id];if(A&&A.endList||o.endList&&o.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=o,void(E&&(this.trigger("mediachanging"),"HAVE_MAIN_MANIFEST"===S?this.trigger("loadedmetadata"):this.trigger("mediachange")));if(this.updateMediaUpdateTimeout_(wZ(o,!0)),E){if(this.state="SWITCHING_MEDIA",this.request){if(o.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=o,this.request=this.vhs_.xhr({uri:o.resolvedUri,withCredentials:this.withCredentials},(function(s,_){if(m.request){if(o.lastRequest=Date.now(),o.resolvedUri=NJ(o.resolvedUri,_),s)return m.playlistRequestError(m.request,o,S);m.haveMetadata({playlistString:_.responseText,url:o.uri,id:o.id}),"HAVE_MAIN_MANIFEST"===S?m.trigger("loadedmetadata"):m.trigger("mediachange")}}))}}}},{key:"pause",value:function pause(){this.mediaUpdateTimeout&&($V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function load(o){var s=this;this.mediaUpdateTimeout&&($V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var m=this.media();if(o){var _=m?(m.partTargetDuration||m.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=$V.setTimeout((function(){s.mediaUpdateTimeout=null,s.load()}),_)}else this.started?m&&!m.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"updateMediaUpdateTimeout_",value:function updateMediaUpdateTimeout_(o){var s=this;this.mediaUpdateTimeout&&($V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=$V.setTimeout((function(){s.mediaUpdateTimeout=null,s.trigger("mediaupdatetimeout"),s.updateMediaUpdateTimeout_(o)}),o))}},{key:"start",value:function start(){var o=this;if(this.started=!0,"object"==typeof this.src)return this.src.uri||(this.src.uri=$V.location.href),this.src.resolvedUri=this.src.uri,void setTimeout((function(){o.setupInitialPlaylist(o.src)}),0);this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(function(s,m){if(o.request){if(o.request=null,s)return o.error={status:m.status,message:"HLS playlist request error at URL: ".concat(o.src,"."),responseText:m.responseText,code:2},"HAVE_NOTHING"===o.state&&(o.started=!1),o.trigger("error");o.src=NJ(o.src,m);var _=o.parseManifest_({manifestString:m.responseText,url:o.src});o.setupInitialPlaylist(_)}}))}},{key:"srcUri",value:function srcUri(){return"string"==typeof this.src?this.src:this.src.uri}},{key:"setupInitialPlaylist",value:function setupInitialPlaylist(o){if(this.state="HAVE_MAIN_MANIFEST",o.playlists)return this.main=o,yZ(this.main,this.srcUri()),o.playlists.forEach((function(o){o.segments=TZ(o),o.segments.forEach((function(s){SZ(s,o.resolvedUri)}))})),this.trigger("loadedplaylist"),void(this.request||this.media(this.main.playlists[0]));var s=this.srcUri()||$V.location.href;this.main=function mainForMedia(o,s){var m=pZ(0,s),_={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:$V.location.href,resolvedUri:$V.location.href,playlists:[{uri:s,id:m,resolvedUri:s,attributes:{}}]};return _.playlists[m]=_.playlists[0],_.playlists[s]=_.playlists[0],_}(0,s),this.haveMetadata({playlistObject:o,url:s,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}},{key:"updateOrDeleteClone",value:function updateOrDeleteClone(o,s){for(var m=this.main,_=o.ID,S=m.playlists.length;S--;){var E=m.playlists[S];if(E.attributes["PATHWAY-ID"]===_){var A=E.resolvedUri,O=E.id;if(s){var H=this.createCloneURI_(E.resolvedUri,o),K=pZ(_,H),z=this.createCloneAttributes_(_,E.attributes),G=this.createClonePlaylist_(E,K,o,z);m.playlists[S]=G,m.playlists[K]=G,m.playlists[H]=G}else m.playlists.splice(S,1);delete m.playlists[O],delete m.playlists[A]}}this.updateOrDeleteCloneMedia(o,s)}},{key:"updateOrDeleteCloneMedia",value:function updateOrDeleteCloneMedia(o,s){var m=this.main,_=o.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(o){if(m.mediaGroups[o]&&m.mediaGroups[o][_])for(var s in m.mediaGroups[o])if(s===_){for(var S in m.mediaGroups[o][s]){m.mediaGroups[o][s][S].playlists.forEach((function(o,s){var _=m.playlists[o.id],S=_.id,E=_.resolvedUri;delete m.playlists[S],delete m.playlists[E]}))}delete m.mediaGroups[o][s]}})),s&&this.createClonedMediaGroups_(o)}},{key:"addClonePathway",value:function addClonePathway(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=this.main,_=m.playlists.length,S=this.createCloneURI_(s.resolvedUri,o),E=pZ(o.ID,S),A=this.createCloneAttributes_(o.ID,s.attributes),O=this.createClonePlaylist_(s,E,o,A);m.playlists[_]=O,m.playlists[E]=O,m.playlists[S]=O,this.createClonedMediaGroups_(o)}},{key:"createClonedMediaGroups_",value:function createClonedMediaGroups_(o){var s=this,m=o.ID,_=o["BASE-ID"],S=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(E){if(S.mediaGroups[E]&&!S.mediaGroups[E][m])for(var A in S.mediaGroups[E])if(A===_){S.mediaGroups[E][m]={};var O=function _loop3(_){var O=S.mediaGroups[E][A][_];S.mediaGroups[E][m][_]=gH({},O);var H=S.mediaGroups[E][m][_],K=s.createCloneURI_(O.resolvedUri,o);H.resolvedUri=K,H.uri=K,H.playlists=[],O.playlists.forEach((function(A,O){var K=S.playlists[A.id],z=fZ(E,m,_),G=pZ(m,z);if(K&&!S.playlists[G]){var q=s.createClonePlaylist_(K,G,o),X=q.resolvedUri;S.playlists[G]=q,S.playlists[X]=q}H.playlists[O]=s.createClonePlaylist_(A,G,o)}))};for(var H in S.mediaGroups[E][A])O(H)}}))}},{key:"createClonePlaylist_",value:function createClonePlaylist_(o,s,m,_){var S=this.createCloneURI_(o.resolvedUri,m),E={resolvedUri:S,uri:S,id:s};return o.segments&&(E.segments=[]),_&&(E.attributes=_),merge$2(o,E)}},{key:"createCloneURI_",value:function createCloneURI_(o,s){var m=new URL(o);m.hostname=s["URI-REPLACEMENT"].HOST;for(var _=s["URI-REPLACEMENT"].PARAMS,S=0,E=Object.keys(_);S<E.length;S++){var A=E[S];m.searchParams.set(A,_[A])}return m.href}},{key:"createCloneAttributes_",value:function createCloneAttributes_(o,s){var m=_defineProperty$2({},"PATHWAY-ID",o);return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(_){s[_]&&(m[_]=o)})),m}},{key:"getKeyIdSet",value:function getKeyIdSet(o){if(o.contentProtection){var s=new Set;for(var m in o.contentProtection){var _=o.contentProtection[m].attributes.keyId;_&&s.add(_.toLowerCase())}return s}}}]),PlaylistLoader}(_Z),EZ=videojs.xhr,IZ=function callbackWrapper(o,s,m,_){var S="arraybuffer"===o.responseType?o.response:o.responseText;!s&&S&&(o.responseTime=Date.now(),o.roundTripTime=o.responseTime-o.requestTime,o.bytesReceived=S.byteLength||S.length,o.bandwidth||(o.bandwidth=Math.floor(o.bytesReceived/o.roundTripTime*8*1e3))),m.headers&&(o.responseHeaders=m.headers),s&&"ETIMEDOUT"===s.code&&(o.timedout=!0),s||o.aborted||200===m.statusCode||206===m.statusCode||0===m.statusCode||(s=new Error("XHR Failed with a response of: "+(o&&(S||o.responseText)))),_(s,o)},AZ=function xhrFactory(){var o=function XhrFunction(o,s){o=merge$2({timeout:45e3},o);var m=XhrFunction.beforeRequest||videojs.Vhs.xhr.beforeRequest,_=XhrFunction._requestCallbackSet||videojs.Vhs.xhr._requestCallbackSet||new Set,S=XhrFunction._responseCallbackSet||videojs.Vhs.xhr._responseCallbackSet;m&&"function"==typeof m&&(videojs.log.warn("beforeRequest is deprecated, use onRequest instead."),_.add(m));var E=!0===videojs.Vhs.xhr.original?EZ:videojs.Vhs.xhr,A=function callAllRequestHooks(o,s){if(o&&o.size){var m=s;return o.forEach((function(o){m=o(m)})),m}}(_,o);_.delete(m);var O=E(A||o,(function(o,m){return function callAllResponseHooks(o,s,m,_){o&&o.size&&o.forEach((function(o){o(s,m,_)}))}(S,O,o,m),IZ(O,o,m,s)})),H=O.abort;return O.abort=function(){return O.aborted=!0,H.apply(O,arguments)},O.uri=o.uri,O.requestTime=Date.now(),O};return o.original=!0,o},PZ=function segmentXhrHeaders(o){var s={};return o.byterange&&(s.Range=function byterangeStr(o){return"bytes="+o.offset+"-"+("bigint"==typeof o.offset||"bigint"==typeof o.length?$V.BigInt(o.offset)+$V.BigInt(o.length)-$V.BigInt(1):o.offset+o.length-1)}(o.byterange)),s},LZ=function textRange(o,s){return o.start(s)+"-"+o.end(s)},DZ=function formatHexString(o,s){var m=o.toString(16);return"00".substring(0,2-m.length)+m+(s%2?" ":"")},RZ=function formatAsciiString(o){return o>=32&&o<126?String.fromCharCode(o):"."},OZ=function createTransferableMessage(o){var s={};return Object.keys(o).forEach((function(m){var _=o[m];kK(_)?s[m]={bytes:_.buffer,byteOffset:_.byteOffset,byteLength:_.byteLength}:s[m]=_})),s},MZ=function initSegmentId(o){var s=o.byterange||{length:1/0,offset:0};return[s.length,s.offset,o.resolvedUri].join(",")},FZ=function segmentKeyId(o){return o.resolvedUri},NZ=function hexDump(o){for(var s=Array.prototype.slice.call(o),m=16,_="",S=0;S<s.length/m;S++)_+=s.slice(S*m,S*m+m).map(DZ).join("")+" "+s.slice(S*m,S*m+m).map(RZ).join("")+"\n";return _},UZ=Object.freeze({__proto__:null,createTransferableMessage:OZ,initSegmentId:MZ,segmentKeyId:FZ,hexDump:NZ,tagDump:function tagDump(o){var s=o.bytes;return NZ(s)},textRanges:function textRanges(o){var s,m="";for(s=0;s<o.length;s++)m+=LZ(o,s)+" ";return m}}),BZ=function getProgramTime(o){var s=o.playlist,m=o.time,_=void 0===m?void 0:m,S=o.callback;if(!S)throw new Error("getProgramTime: callback must be provided");if(!s||void 0===_)return S({message:"getProgramTime: playlist and time must be provided"});var E=function findSegmentForPlayerTime(o,s){if(!s||!s.segments||0===s.segments.length)return null;for(var m,_=0,S=0;S<s.segments.length&&!(o<=(_=(m=s.segments[S]).videoTimingInfo?m.videoTimingInfo.transmuxedPresentationEnd:_+m.duration));S++);var E=s.segments[s.segments.length-1];if(E.videoTimingInfo&&E.videoTimingInfo.transmuxedPresentationEnd<o)return null;if(o>_){if(o>_+.25*E.duration)return null;m=E}return{segment:m,estimatedStart:m.videoTimingInfo?m.videoTimingInfo.transmuxedPresentationStart:_-m.duration,type:m.videoTimingInfo?"accurate":"estimate"}}(_,s);if(!E)return S({message:"valid programTime was not found"});if("estimate"===E.type)return S({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:E.estimatedStart});var A={mediaSeconds:_},O=function playerTimeToProgramTime(o,s){if(!s.dateTimeObject)return null;var m=s.videoTimingInfo.transmuxerPrependedSeconds,_=o-(s.videoTimingInfo.transmuxedPresentationStart+m);return new Date(s.dateTimeObject.getTime()+1e3*_)}(_,E.segment);return O&&(A.programDateTime=O.toISOString()),S(null,A)},jZ=function seekToProgramTime(o){var s=o.programTime,m=o.playlist,_=o.retryCount,S=void 0===_?2:_,E=o.seekTo,A=o.pauseAfterSeek,O=void 0===A||A,H=o.tech,K=o.callback;if(!K)throw new Error("seekToProgramTime: callback must be provided");if(void 0===s||!m||!E)return K({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!m.endList&&!H.hasStarted_)return K({message:"player must be playing a live stream to start buffering"});if(!function verifyProgramDateTimeTags(o){if(!o.segments||0===o.segments.length)return!1;for(var s=0;s<o.segments.length;s++)if(!o.segments[s].dateTimeObject)return!1;return!0}(m))return K({message:"programDateTime tags must be provided in the manifest "+m.resolvedUri});var z=function findSegmentForProgramTime(o,s){var m;try{m=new Date(o)}catch(o){return null}if(!s||!s.segments||0===s.segments.length)return null;var _=s.segments[0];if(m<new Date(_.dateTimeObject))return null;for(var S=0;S<s.segments.length-1&&(_=s.segments[S],!(m<new Date(s.segments[S+1].dateTimeObject)));S++);var E=s.segments[s.segments.length-1],A=E.dateTimeObject,O=E.videoTimingInfo?function originalSegmentVideoDuration(o){return o.transmuxedPresentationEnd-o.transmuxedPresentationStart-o.transmuxerPrependedSeconds}(E.videoTimingInfo):E.duration+.25*E.duration;return m>new Date(A.getTime()+1e3*O)?null:(m>new Date(A)&&(_=E),{segment:_,estimatedStart:_.videoTimingInfo?_.videoTimingInfo.transmuxedPresentationStart:dZ.duration(s,s.mediaSequence+s.segments.indexOf(_)),type:_.videoTimingInfo?"accurate":"estimate"})}(s,m);if(!z)return K({message:"".concat(s," was not found in the stream")});var G=z.segment,q=function getOffsetFromTimestamp(o,s){var m,_;try{m=new Date(o),_=new Date(s)}catch(o){}var S=m.getTime();return(_.getTime()-S)/1e3}(G.dateTimeObject,s);if("estimate"===z.type)return 0===S?K({message:"".concat(s," is not buffered yet. Try again")}):(E(z.estimatedStart+q),void H.one("seeked",(function(){jZ({programTime:s,playlist:m,retryCount:S-1,seekTo:E,pauseAfterSeek:O,tech:H,callback:K})})));var X=G.start+q;H.one("seeked",(function seekedCallback(){return K(null,H.currentTime())})),O&&H.pause(),E(X)},$Z=function callbackOnCompleted(o,s){if(4===o.readyState)return s()},VZ=videojs.EventTarget,HZ=function dashPlaylistUnchanged(o,s){if(!kZ(o,s))return!1;if(o.sidx&&s.sidx&&(o.sidx.offset!==s.sidx.offset||o.sidx.length!==s.sidx.length))return!1;if(!o.sidx&&s.sidx||o.sidx&&!s.sidx)return!1;if(o.segments&&!s.segments||!o.segments&&s.segments)return!1;if(!o.segments&&!s.segments)return!0;for(var m=0;m<o.segments.length;m++){var _=o.segments[m],S=s.segments[m];if(_.uri!==S.uri)return!1;if(_.byterange||S.byterange){var E=_.byterange,A=S.byterange;if(E&&!A||!E&&A)return!1;if(E.offset!==A.offset||E.length!==A.length)return!1}}return!0},KZ=function dashGroupId(o,s,m,_){var S=_.attributes.NAME||m;return"placeholder-uri-".concat(o,"-").concat(s,"-").concat(S)},zZ=function updateMain(o,s,m){for(var _=!0,S=merge$2(o,{duration:s.duration,minimumUpdatePeriod:s.minimumUpdatePeriod,timelineStarts:s.timelineStarts}),E=0;E<s.playlists.length;E++){var A=s.playlists[E];if(A.sidx){var O=hW(A.sidx);m&&m[O]&&m[O].sidx&&oW(A,m[O].sidx,A.sidx.resolvedUri)}var H=CZ(S,A,HZ);H&&(S=H,_=!1)}return gZ(s,(function(o,s,m,E){if(o.playlists&&o.playlists.length){var A=o.playlists[0].id,O=CZ(S,o.playlists[0],HZ);O&&(E in(S=O).mediaGroups[s][m]||(S.mediaGroups[s][m][E]=o),S.mediaGroups[s][m][E].playlists[0]=S.playlists[A],_=!1)}})),function removeOldMediaGroupLabels(o,s){gZ(o,(function(m,_,S,E){E in s.mediaGroups[_][S]||delete o.mediaGroups[_][S][E]}))}(S,s),s.minimumUpdatePeriod!==o.minimumUpdatePeriod&&(_=!1),_?null:S},WZ=function equivalentSidx(o,s){return(Boolean(!o.map&&!s.map)||Boolean(o.map&&s.map&&o.map.byterange.offset===s.map.byterange.offset&&o.map.byterange.length===s.map.byterange.length))&&o.uri===s.uri&&o.byterange.offset===s.byterange.offset&&o.byterange.length===s.byterange.length},GZ=function compareSidxEntry(o,s){var m={};for(var _ in o){var S=o[_].sidx;if(S){var E=hW(S);if(!s[E])break;var A=s[E].sidxInfo;WZ(A,S)&&(m[E]=s[E])}}return m},qZ=function(o){_inherits$1(DashPlaylistLoader,o);var s=_createSuper$1(DashPlaylistLoader);function DashPlaylistLoader(o,m){var _,S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},E=arguments.length>3?arguments[3]:void 0;_classCallCheck$1(this,DashPlaylistLoader),(_=s.call(this)).mainPlaylistLoader_=E||_assertThisInitialized(_),E||(_.isMain_=!0);var A=S.withCredentials,O=void 0!==A&&A;if(_.vhs_=m,_.withCredentials=O,_.addMetadataToTextTrack=S.addMetadataToTextTrack,!o)throw new Error("A non-empty playlist URL or object is required");return _.on("minimumUpdatePeriod",(function(){_.refreshXml_()})),_.on("mediaupdatetimeout",(function(){_.refreshMedia_(_.media().id)})),_.state="HAVE_NOTHING",_.loadedPlaylists_={},_.logger_=UJ("DashPlaylistLoader"),_.isMain_?(_.mainPlaylistLoader_.srcUrl=o,_.mainPlaylistLoader_.sidxMapping_={}):_.childPlaylist_=o,_}return _createClass$1(DashPlaylistLoader,[{key:"requestErrored_",value:function requestErrored_(o,s,m){return!this.request||(this.request=null,o?(this.error="object"!=typeof o||o instanceof Error?{status:s.status,message:"DASH request error at URL: "+s.uri,response:s.response,code:2}:o,m&&(this.state=m),this.trigger("error"),!0):void 0)}},{key:"addSidxSegments_",value:function addSidxSegments_(o,s,m){var _=this,S=o.sidx&&hW(o.sidx);if(o.sidx&&S&&!this.mainPlaylistLoader_.sidxMapping_[S]){var E=NJ(o.sidx.resolvedUri),A=function fin(E,A){if(!_.requestErrored_(E,A,s)){var O,H=_.mainPlaylistLoader_.sidxMapping_;try{O=qW(CK(A.response).subarray(8))}catch(o){return void _.requestErrored_(o,A,s)}return H[S]={sidxInfo:o.sidx,sidx:O},oW(o,O,o.sidx.resolvedUri),m(!0)}};this.request=function containerRequest(o,s,m){var _,S=[],E=!1,A=function endRequestAndCallback(o,s,_,S){return s.abort(),E=!0,m(o,s,_,S)},O=function progressListener(o,s){if(!E){if(o)return A(o,s,"",S);var m=s.responseText.substring(S&&S.byteLength||0,s.responseText.length);if(S=PK(S,AK(m,!0)),_=_||YW(S),S.length<10||_&&S.length<_+2)return $Z(s,(function(){return A(o,s,"",S)}));var O=vG(S);return"ts"===O&&S.length<188||!O&&S.length<376?$Z(s,(function(){return A(o,s,"",S)})):A(null,s,O,S)}},H={uri:o,beforeSend:function beforeSend(o){o.overrideMimeType("text/plain; charset=x-user-defined"),o.addEventListener("progress",(function(s){return s.total,s.loaded,IZ(o,null,{statusCode:o.status},O)}))}},K=s(H,(function(o,s){return IZ(K,o,s,O)}));return K}(E,this.vhs_.xhr,(function(s,m,S,O){if(s)return A(s,m);if(!S||"mp4"!==S)return A({status:m.status,message:"Unsupported ".concat(S||"unknown"," container type for sidx segment at URL: ").concat(E),response:"",playlist:o,internal:!0,playlistExclusionDuration:1/0,code:2},m);var H=o.sidx.byterange,K=H.offset,z=H.length;if(O.length>=z+K)return A(s,{response:O.subarray(K,K+z),status:m.status,uri:m.uri});_.request=_.vhs_.xhr({uri:E,responseType:"arraybuffer",headers:PZ({byterange:o.sidx.byterange})},A)}))}else this.mediaRequest_=$V.setTimeout((function(){return m(!1)}),0)}},{key:"dispose",value:function dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},$V.clearTimeout(this.minimumUpdatePeriodTimeout_),$V.clearTimeout(this.mediaRequest_),$V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}},{key:"hasPendingRequest",value:function hasPendingRequest(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function stopRequest(){if(this.request){var o=this.request;this.request=null,o.onreadystatechange=null,o.abort()}}},{key:"media",value:function media(o){var s=this;if(!o)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var m=this.state;if("string"==typeof o){if(!this.mainPlaylistLoader_.main.playlists[o])throw new Error("Unknown playlist URI: "+o);o=this.mainPlaylistLoader_.main.playlists[o]}var _=!this.media_||o.id!==this.media_.id;if(_&&this.loadedPlaylists_[o.id]&&this.loadedPlaylists_[o.id].endList)return this.state="HAVE_METADATA",this.media_=o,void(_&&(this.trigger("mediachanging"),this.trigger("mediachange")));_&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(o,m,(function(_){s.haveMetadata({startingState:m,playlist:o})})))}},{key:"haveMetadata",value:function haveMetadata(o){var s=o.startingState,m=o.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[m.id]=m,this.mediaRequest_=null,this.refreshMedia_(m.id),"HAVE_MAIN_MANIFEST"===s?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),$V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&($V.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function load(o){var s=this;$V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var m=this.media();if(o){var _=m?m.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=$V.setTimeout((function(){return s.load()}),_)}else this.started?m&&!m.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function start(){var o=this;this.started=!0,this.isMain_?this.requestMain_((function(s,m){o.haveMain_(),o.hasPendingRequest()||o.media_||o.media(o.mainPlaylistLoader_.main.playlists[0])})):this.mediaRequest_=$V.setTimeout((function(){return o.haveMain_()}),0)}},{key:"requestMain_",value:function requestMain_(o){var s=this;this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(function(m,_){if(!s.requestErrored_(m,_)){var S=_.responseText!==s.mainPlaylistLoader_.mainXml_;return s.mainPlaylistLoader_.mainXml_=_.responseText,_.responseHeaders&&_.responseHeaders.date?s.mainLoaded_=Date.parse(_.responseHeaders.date):s.mainLoaded_=Date.now(),s.mainPlaylistLoader_.srcUrl=NJ(s.mainPlaylistLoader_.srcUrl,_),S?(s.handleMain_(),void s.syncClientServerClock_((function(){return o(_,S)}))):o(_,S)}"HAVE_NOTHING"===s.state&&(s.started=!1)}))}},{key:"syncClientServerClock_",value:function syncClientServerClock_(o){var s=this,m=zW(this.mainPlaylistLoader_.mainXml_);return null===m?(this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),o()):"DIRECT"===m.method?(this.mainPlaylistLoader_.clientOffset_=m.value-Date.now(),o()):void(this.request=this.vhs_.xhr({uri:FJ(this.mainPlaylistLoader_.srcUrl,m.value),method:m.method,withCredentials:this.withCredentials},(function(_,S){if(s.request){if(_)return s.mainPlaylistLoader_.clientOffset_=s.mainLoaded_-Date.now(),o();var E;E="HEAD"===m.method?S.responseHeaders&&S.responseHeaders.date?Date.parse(S.responseHeaders.date):s.mainLoaded_:Date.parse(S.responseText),s.mainPlaylistLoader_.clientOffset_=E-Date.now(),o()}})))}},{key:"haveMain_",value:function haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}},{key:"handleMain_",value:function handleMain_(){this.mediaRequest_=null;var o=this.mainPlaylistLoader_.main,s=function parseMainXml(o){var s=o.mainXml,m=o.srcUrl,_=o.clientOffset,S=o.sidxMapping,E=o.previousManifest,A=KW(s,{manifestUri:m,clientOffset:_,sidxMapping:S,previousManifest:E});return yZ(A,m,KZ),A}({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:o});o&&(s=zZ(o,s,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=s||o;var m=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return m&&m!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=m),(!o||s&&s.minimumUpdatePeriod!==o.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(s),Boolean(s)}},{key:"updateMinimumUpdatePeriodTimeout_",value:function updateMinimumUpdatePeriodTimeout_(){var o=this.mainPlaylistLoader_;o.createMupOnMedia_&&(o.off("loadedmetadata",o.createMupOnMedia_),o.createMupOnMedia_=null),o.minimumUpdatePeriodTimeout_&&($V.clearTimeout(o.minimumUpdatePeriodTimeout_),o.minimumUpdatePeriodTimeout_=null);var s=o.main&&o.main.minimumUpdatePeriod;0===s&&(o.media()?s=1e3*o.media().targetDuration:(o.createMupOnMedia_=o.updateMinimumUpdatePeriodTimeout_,o.one("loadedmetadata",o.createMupOnMedia_))),"number"!=typeof s||s<=0?s<0&&this.logger_("found invalid minimumUpdatePeriod of ".concat(s,", not setting a timeout")):this.createMUPTimeout_(s)}},{key:"createMUPTimeout_",value:function createMUPTimeout_(o){var s=this.mainPlaylistLoader_;s.minimumUpdatePeriodTimeout_=$V.setTimeout((function(){s.minimumUpdatePeriodTimeout_=null,s.trigger("minimumUpdatePeriod"),s.createMUPTimeout_(o)}),o)}},{key:"refreshXml_",value:function refreshXml_(){var o=this;this.requestMain_((function(s,m){m&&(o.media_&&(o.media_=o.mainPlaylistLoader_.main.playlists[o.media_.id]),o.mainPlaylistLoader_.sidxMapping_=function filterChangedSidxMappings(o,s){var m=GZ(o.playlists,s);return gZ(o,(function(o,_,S,E){if(o.playlists&&o.playlists.length){var A=o.playlists;m=merge$2(m,GZ(A,s))}})),m}(o.mainPlaylistLoader_.main,o.mainPlaylistLoader_.sidxMapping_),o.addSidxSegments_(o.media(),o.state,(function(s){o.refreshMedia_(o.media().id)})))}))}},{key:"refreshMedia_",value:function refreshMedia_(o){var s=this;if(!o)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();var m=this.mainPlaylistLoader_.main.playlists,_=!this.media_||this.media_!==m[o];if(_?this.media_=m[o]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){!function createMediaUpdateTimeout(){s.media().endList||(s.mediaUpdateTimeout=$V.setTimeout((function(){s.trigger("mediaupdatetimeout"),createMediaUpdateTimeout()}),wZ(s.media(),Boolean(_))))}()}this.trigger("loadedplaylist")}},{key:"addEventStreamToMetadataTrack_",value:function addEventStreamToMetadataTrack_(o){if(o&&this.mainPlaylistLoader_.main.eventStream){var s=this.mainPlaylistLoader_.main.eventStream.map((function(o){return{cueTime:o.start,frames:[{data:o.messageData}]}}));this.addMetadataToTextTrack("EventStream",s,this.mainPlaylistLoader_.main.duration)}}},{key:"getKeyIdSet",value:function getKeyIdSet(o){if(o.contentProtection){var s=new Set;for(var m in o.contentProtection){var _=o.contentProtection[m].attributes["cenc:default_KID"];_&&s.add(_.replace(/-/g,"").toLowerCase())}return s}}}]),DashPlaylistLoader}(VZ),XZ={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30},YZ=function browserWorkerPolyFill(o){return o.on=o.addEventListener,o.off=o.removeEventListener,o},QZ=function factory(o){return function(){var s=function createObjectURL(o){try{return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))}catch(m){var s=new BlobBuilder;return s.append(o),URL.createObjectURL(s.getBlob())}}(o),m=YZ(new Worker(s));m.objURL=s;var _=m.terminate;return m.on=m.addEventListener,m.off=m.removeEventListener,m.terminate=function(){return URL.revokeObjectURL(s),_.call(this)},m}},JZ=function transform(o){return"var browserWorkerPolyFill = ".concat(YZ.toString(),";\n")+"browserWorkerPolyFill(self);\n"+o},ZZ=function getWorkerString(o){return o.toString().replace(/^function.+?{/,"").slice(0,-1)},e0=JZ(ZZ((function(){var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=function Stream$8(){this.init=function(){var o={};this.on=function(s,m){o[s]||(o[s]=[]),o[s]=o[s].concat(m)},this.off=function(s,m){var _;return!!o[s]&&(_=o[s].indexOf(m),o[s]=o[s].slice(),o[s].splice(_,1),_>-1)},this.trigger=function(s){var m,_,S,E;if(m=o[s])if(2===arguments.length)for(S=m.length,_=0;_<S;++_)m[_].call(this,arguments[1]);else{for(E=[],_=arguments.length,_=1;_<arguments.length;++_)E.push(arguments[_]);for(S=m.length,_=0;_<S;++_)m[_].apply(this,E)}},this.dispose=function(){o={}}}};s.prototype.pipe=function(o){return this.on("data",(function(s){o.push(s)})),this.on("done",(function(s){o.flush(s)})),this.on("partialdone",(function(s){o.partialFlush(s)})),this.on("endedtimeline",(function(s){o.endTimeline(s)})),this.on("reset",(function(s){o.reset(s)})),o},s.prototype.push=function(o){this.trigger("data",o)},s.prototype.flush=function(o){this.trigger("done",o)},s.prototype.partialFlush=function(o){this.trigger("partialdone",o)},s.prototype.endTimeline=function(o){this.trigger("endedtimeline",o)},s.prototype.reset=function(o){this.trigger("reset",o)};var m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He,et,rt,it,at,ot,st,ut,ct,dt,ht,pt,gt,_t,bt,kt,It,At,Lt,Rt=s,Mt=Math.pow(2,32),zt={getUint64:function getUint64$3(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength);return m.getBigUint64?(s=m.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(s):s:m.getUint32(0)*Mt+m.getUint32(4)},MAX_UINT32:Mt},qt=zt.MAX_UINT32;!function(){var o;if(He={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(o in He)He.hasOwnProperty(o)&&(He[o]=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)]);et=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),it=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),rt=new Uint8Array([0,0,0,1]),at=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),ot=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),st={video:at,audio:ot},dt=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ct=new Uint8Array([0,0,0,0,0,0,0,0]),ht=new Uint8Array([0,0,0,0,0,0,0,0]),pt=ht,gt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),_t=ht,ut=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),m=function box(o){var s,m,_=[],S=0;for(s=1;s<arguments.length;s++)_.push(arguments[s]);for(s=_.length;s--;)S+=_[s].byteLength;for(m=new Uint8Array(S+8),new DataView(m.buffer,m.byteOffset,m.byteLength).setUint32(0,m.byteLength),m.set(o,4),s=0,S=8;s<_.length;s++)m.set(_[s],S),S+=_[s].byteLength;return m},_=function dinf(){return m(He.dinf,m(He.dref,dt))},S=function esds(o){return m(He.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,o.audioobjecttype<<3|o.samplingfrequencyindex>>>1,o.samplingfrequencyindex<<7|o.channelcount<<3,6,1,2]))},pe=function hdlr(o){return m(He.hdlr,st[o])},ae=function mdhd(o){var s=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,o.duration>>>24&255,o.duration>>>16&255,o.duration>>>8&255,255&o.duration,85,196,0,0]);return o.samplerate&&(s[12]=o.samplerate>>>24&255,s[13]=o.samplerate>>>16&255,s[14]=o.samplerate>>>8&255,s[15]=255&o.samplerate),m(He.mdhd,s)},J=function mdia(o){return m(He.mdia,ae(o),pe(o.type),O(o))},A=function mfhd(o){return m(He.mfhd,new Uint8Array([0,0,0,0,(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o]))},O=function minf(o){return m(He.minf,"video"===o.type?m(He.vmhd,ut):m(He.smhd,ct),_(),_e(o))},H=function moof(o,s){for(var _=[],S=s.length;S--;)_[S]=Ee(s[S]);return m.apply(null,[He.moof,A(o)].concat(_))},K=function moov(o){for(var s=o.length,_=[];s--;)_[s]=q(o[s]);return m.apply(null,[He.moov,G(4294967295)].concat(_).concat(z(o)))},z=function mvex(o){for(var s=o.length,_=[];s--;)_[s]=De(o[s]);return m.apply(null,[He.mvex].concat(_))},G=function mvhd(o){var s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return m(He.mvhd,s)},me=function sdtp(o){var s,_,S=o.samples||[],E=new Uint8Array(4+S.length);for(_=0;_<S.length;_++)s=S[_].flags,E[_+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return m(He.sdtp,E)},_e=function stbl(o){return m(He.stbl,Se(o),m(He.stts,_t),m(He.stsc,pt),m(He.stsz,gt),m(He.stco,ht))},Se=function stsd(o){return m(He.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===o.type?bt(o):kt(o))},bt=function videoSample(o){var s,_,S=o.sps||[],E=o.pps||[],A=[],O=[];for(s=0;s<S.length;s++)A.push((65280&S[s].byteLength)>>>8),A.push(255&S[s].byteLength),A=A.concat(Array.prototype.slice.call(S[s]));for(s=0;s<E.length;s++)O.push((65280&E[s].byteLength)>>>8),O.push(255&E[s].byteLength),O=O.concat(Array.prototype.slice.call(E[s]));if(_=[He.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&o.width)>>8,255&o.width,(65280&o.height)>>8,255&o.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),m(He.avcC,new Uint8Array([1,o.profileIdc,o.profileCompatibility,o.levelIdc,255].concat([S.length],A,[E.length],O))),m(He.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],o.sarRatio){var H=o.sarRatio[0],K=o.sarRatio[1];_.push(m(He.pasp,new Uint8Array([(4278190080&H)>>24,(16711680&H)>>16,(65280&H)>>8,255&H,(4278190080&K)>>24,(16711680&K)>>16,(65280&K)>>8,255&K])))}return m.apply(null,_)},kt=function audioSample(o){return m(He.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&o.channelcount)>>8,255&o.channelcount,(65280&o.samplesize)>>8,255&o.samplesize,0,0,0,0,(65280&o.samplerate)>>8,255&o.samplerate,0,0]),S(o))},X=function tkhd(o){var s=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,0,(4278190080&o.duration)>>24,(16711680&o.duration)>>16,(65280&o.duration)>>8,255&o.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&o.width)>>8,255&o.width,0,0,(65280&o.height)>>8,255&o.height,0,0]);return m(He.tkhd,s)},Ee=function traf(o){var s,_,S,E,A,O;return s=m(He.tfhd,new Uint8Array([0,0,0,58,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),A=Math.floor(o.baseMediaDecodeTime/qt),O=Math.floor(o.baseMediaDecodeTime%qt),_=m(He.tfdt,new Uint8Array([1,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,255&A,O>>>24&255,O>>>16&255,O>>>8&255,255&O])),92,"audio"===o.type?(S=$e(o,92),m(He.traf,s,_,S)):(E=me(o),S=$e(o,E.length+92),m(He.traf,s,_,S,E))},q=function trak(o){return o.duration=o.duration||4294967295,m(He.trak,X(o),J(o))},De=function trex(o){var s=new Uint8Array([0,0,0,0,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==o.type&&(s[s.length-1]=0),m(He.trex,s)},Lt=function trunHeader(o,s){var m=0,_=0,S=0,E=0;return o.length&&(void 0!==o[0].duration&&(m=1),void 0!==o[0].size&&(_=2),void 0!==o[0].flags&&(S=4),void 0!==o[0].compositionTimeOffset&&(E=8)),[0,0,m|_|S|E,1,(4278190080&o.length)>>>24,(16711680&o.length)>>>16,(65280&o.length)>>>8,255&o.length,(4278190080&s)>>>24,(16711680&s)>>>16,(65280&s)>>>8,255&s]},At=function videoTrun(o,s){var _,S,E,A,O,H;for(s+=20+16*(A=o.samples||[]).length,E=Lt(A,s),(S=new Uint8Array(E.length+16*A.length)).set(E),_=E.length,H=0;H<A.length;H++)O=A[H],S[_++]=(4278190080&O.duration)>>>24,S[_++]=(16711680&O.duration)>>>16,S[_++]=(65280&O.duration)>>>8,S[_++]=255&O.duration,S[_++]=(4278190080&O.size)>>>24,S[_++]=(16711680&O.size)>>>16,S[_++]=(65280&O.size)>>>8,S[_++]=255&O.size,S[_++]=O.flags.isLeading<<2|O.flags.dependsOn,S[_++]=O.flags.isDependedOn<<6|O.flags.hasRedundancy<<4|O.flags.paddingValue<<1|O.flags.isNonSyncSample,S[_++]=61440&O.flags.degradationPriority,S[_++]=15&O.flags.degradationPriority,S[_++]=(4278190080&O.compositionTimeOffset)>>>24,S[_++]=(16711680&O.compositionTimeOffset)>>>16,S[_++]=(65280&O.compositionTimeOffset)>>>8,S[_++]=255&O.compositionTimeOffset;return m(He.trun,S)},It=function audioTrun(o,s){var _,S,E,A,O,H;for(s+=20+8*(A=o.samples||[]).length,E=Lt(A,s),(_=new Uint8Array(E.length+8*A.length)).set(E),S=E.length,H=0;H<A.length;H++)O=A[H],_[S++]=(4278190080&O.duration)>>>24,_[S++]=(16711680&O.duration)>>>16,_[S++]=(65280&O.duration)>>>8,_[S++]=255&O.duration,_[S++]=(4278190080&O.size)>>>24,_[S++]=(16711680&O.size)>>>16,_[S++]=(65280&O.size)>>>8,_[S++]=255&O.size;return m(He.trun,_)},$e=function trun$1(o,s){return"audio"===o.type?It(o,s):At(o,s)};var Jt,tn,nn,rn,sn,un,pn,vn,_n={ftyp:E=function ftyp(){return m(He.ftyp,et,rt,et,it)},mdat:function mdat(o){return m(He.mdat,o)},moof:H,moov:K,initSegment:function initSegment(o){var s,m=E(),_=K(o);return(s=new Uint8Array(m.byteLength+_.byteLength)).set(m),s.set(_,m.byteLength),s}},Cn=function sampleForFrame(o,s){var m={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return m.dataOffset=s,m.compositionTimeOffset=o.pts-o.dts,m.duration=o.duration,m.size=4*o.length,m.size+=o.byteLength,o.keyFrame&&(m.flags.dependsOn=2,m.flags.isNonSyncSample=0),m},wn={groupNalsIntoFrames:function groupNalsIntoFrames(o){var s,m,_=[],S=[];for(S.byteLength=0,S.nalCount=0,S.duration=0,_.byteLength=0,s=0;s<o.length;s++)"access_unit_delimiter_rbsp"===(m=o[s]).nalUnitType?(_.length&&(_.duration=m.dts-_.dts,S.byteLength+=_.byteLength,S.nalCount+=_.length,S.duration+=_.duration,S.push(_)),(_=[m]).byteLength=m.data.byteLength,_.pts=m.pts,_.dts=m.dts):("slice_layer_without_partitioning_rbsp_idr"===m.nalUnitType&&(_.keyFrame=!0),_.duration=m.dts-_.dts,_.byteLength+=m.data.byteLength,_.push(m));return S.length&&(!_.duration||_.duration<=0)&&(_.duration=S[S.length-1].duration),S.byteLength+=_.byteLength,S.nalCount+=_.length,S.duration+=_.duration,S.push(_),S},groupFramesIntoGops:function groupFramesIntoGops(o){var s,m,_=[],S=[];for(_.byteLength=0,_.nalCount=0,_.duration=0,_.pts=o[0].pts,_.dts=o[0].dts,S.byteLength=0,S.nalCount=0,S.duration=0,S.pts=o[0].pts,S.dts=o[0].dts,s=0;s<o.length;s++)(m=o[s]).keyFrame?(_.length&&(S.push(_),S.byteLength+=_.byteLength,S.nalCount+=_.nalCount,S.duration+=_.duration),(_=[m]).nalCount=m.length,_.byteLength=m.byteLength,_.pts=m.pts,_.dts=m.dts,_.duration=m.duration):(_.duration+=m.duration,_.nalCount+=m.length,_.byteLength+=m.byteLength,_.push(m));return S.length&&_.duration<=0&&(_.duration=S[S.length-1].duration),S.byteLength+=_.byteLength,S.nalCount+=_.nalCount,S.duration+=_.duration,S.push(_),S},extendFirstKeyFrame:function extendFirstKeyFrame(o){var s;return!o[0][0].keyFrame&&o.length>1&&(s=o.shift(),o.byteLength-=s.byteLength,o.nalCount-=s.nalCount,o[0][0].dts=s.dts,o[0][0].pts=s.pts,o[0][0].duration+=s.duration),o},generateSampleTable:function generateSampleTable$1(o,s){var m,_,S,E,A,O=s||0,H=[];for(m=0;m<o.length;m++)for(E=o[m],_=0;_<E.length;_++)A=E[_],O+=(S=Cn(A,O)).size,H.push(S);return H},concatenateNalData:function concatenateNalData(o){var s,m,_,S,E,A,O=0,H=o.byteLength,K=o.nalCount,z=new Uint8Array(H+4*K),G=new DataView(z.buffer);for(s=0;s<o.length;s++)for(S=o[s],m=0;m<S.length;m++)for(E=S[m],_=0;_<E.length;_++)A=E[_],G.setUint32(O,A.data.byteLength),O+=4,z.set(A.data,O),O+=A.data.byteLength;return z},generateSampleTableForFrame:function generateSampleTableForFrame(o,s){var m,_=[];return m=Cn(o,s||0),_.push(m),_},concatenateNalDataForFrame:function concatenateNalDataForFrame(o){var s,m,_=0,S=o.byteLength,E=o.length,A=new Uint8Array(S+4*E),O=new DataView(A.buffer);for(s=0;s<o.length;s++)m=o[s],O.setUint32(_,m.data.byteLength),_+=4,A.set(m.data,_),_+=m.data.byteLength;return A}},xn=[33,16,5,32,164,27],In=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],An=function zeroFill(o){for(var s=[];o--;)s.push(0);return s},Fn=9e4;un=function audioTsToVideoTs(o,s){return tn(sn(o,s))},pn=function videoTsToAudioTs(o,s){return nn(rn(o),s)},vn=function metadataTsToSeconds(o,s,m){return rn(m?o:o-s)};var Gn={ONE_SECOND_IN_TS:Fn,secondsToVideoTs:tn=function secondsToVideoTs(o){return o*Fn},secondsToAudioTs:nn=function secondsToAudioTs(o,s){return o*s},videoTsToSeconds:rn=function videoTsToSeconds(o){return o/Fn},audioTsToSeconds:sn=function audioTsToSeconds(o,s){return o/s},audioTsToVideoTs:un,videoTsToAudioTs:pn,metadataTsToSeconds:vn},qn=function silence_1(){if(!Jt){var o={96e3:[xn,[227,64],An(154),[56]],88200:[xn,[231],An(170),[56]],64e3:[xn,[248,192],An(240),[56]],48e3:[xn,[255,192],An(268),[55,148,128],An(54),[112]],44100:[xn,[255,192],An(268),[55,163,128],An(84),[112]],32e3:[xn,[255,192],An(268),[55,234],An(226),[112]],24e3:[xn,[255,192],An(268),[55,255,128],An(268),[111,112],An(126),[224]],16e3:[xn,[255,192],An(268),[55,255,128],An(268),[111,255],An(269),[223,108],An(195),[1,192]],12e3:[In,An(268),[3,127,248],An(268),[6,255,240],An(268),[13,255,224],An(268),[27,253,128],An(259),[56]],11025:[In,An(268),[3,127,248],An(268),[6,255,240],An(268),[13,255,224],An(268),[27,255,192],An(268),[55,175,128],An(108),[112]],8e3:[In,An(268),[3,121,16],An(47),[7]]};Jt=function makeTable(o){return Object.keys(o).reduce((function(s,m){return s[m]=new Uint8Array(o[m].reduce((function(o,s){return o.concat(s)}),[])),s}),{})}(o)}return Jt},ar=Gn,vr={prefixWithSilence:function prefixWithSilence(o,s,m,_){var S,E,A,O,H,K=0,z=0,G=0;if(s.length&&(S=ar.audioTsToVideoTs(o.baseMediaDecodeTime,o.samplerate),E=Math.ceil(ar.ONE_SECOND_IN_TS/(o.samplerate/1024)),m&&_&&(K=S-Math.max(m,_),G=(z=Math.floor(K/E))*E),!(z<1||G>ar.ONE_SECOND_IN_TS/2))){for((A=qn()[o.samplerate])||(A=s[0].data),O=0;O<z;O++)H=s[0],s.splice(0,0,{data:A,dts:H.dts-E,pts:H.pts-E});return o.baseMediaDecodeTime-=Math.floor(ar.videoTsToAudioTs(G,o.samplerate)),G}},trimAdtsFramesByEarliestDts:function trimAdtsFramesByEarliestDts(o,s,m){return s.minSegmentDts>=m?o:(s.minSegmentDts=1/0,o.filter((function(o){return o.dts>=m&&(s.minSegmentDts=Math.min(s.minSegmentDts,o.dts),s.minSegmentPts=s.minSegmentDts,!0)})))},generateSampleTable:function generateSampleTable(o){var s,m,_=[];for(s=0;s<o.length;s++)m=o[s],_.push({size:m.data.byteLength,duration:1024});return _},concatenateFrameData:function concatenateFrameData(o){var s,m,_=0,S=new Uint8Array(function sumFrameByteLengths(o){var s,m=0;for(s=0;s<o.length;s++)m+=o[s].data.byteLength;return m}(o));for(s=0;s<o.length;s++)m=o[s],S.set(m.data,_),_+=m.data.byteLength;return S}},_r=Gn.ONE_SECOND_IN_TS,wr={clearDtsInfo:function clearDtsInfo(o){delete o.minSegmentDts,delete o.maxSegmentDts,delete o.minSegmentPts,delete o.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function calculateTrackBaseMediaDecodeTime(o,s){var m,_=o.minSegmentDts;return s||(_-=o.timelineStartInfo.dts),m=o.timelineStartInfo.baseMediaDecodeTime,m+=_,m=Math.max(0,m),"audio"===o.type&&(m*=o.samplerate/_r,m=Math.floor(m)),m},collectDtsInfo:function collectDtsInfo(o,s){"number"==typeof s.pts&&(void 0===o.timelineStartInfo.pts&&(o.timelineStartInfo.pts=s.pts),void 0===o.minSegmentPts?o.minSegmentPts=s.pts:o.minSegmentPts=Math.min(o.minSegmentPts,s.pts),void 0===o.maxSegmentPts?o.maxSegmentPts=s.pts:o.maxSegmentPts=Math.max(o.maxSegmentPts,s.pts)),"number"==typeof s.dts&&(void 0===o.timelineStartInfo.dts&&(o.timelineStartInfo.dts=s.dts),void 0===o.minSegmentDts?o.minSegmentDts=s.dts:o.minSegmentDts=Math.min(o.minSegmentDts,s.dts),void 0===o.maxSegmentDts?o.maxSegmentDts=s.dts:o.maxSegmentDts=Math.max(o.maxSegmentDts,s.dts))}},Pr={parseSei:function parseSei(o){for(var s=0,m={payloadType:-1,payloadSize:0},_=0,S=0;s<o.byteLength&&128!==o[s];){for(;255===o[s];)_+=255,s++;for(_+=o[s++];255===o[s];)S+=255,s++;if(S+=o[s++],!m.payload&&4===_){if("GA94"===String.fromCharCode(o[s+3],o[s+4],o[s+5],o[s+6])){m.payloadType=_,m.payloadSize=S,m.payload=o.subarray(s,s+S);break}m.payload=void 0}s+=S,_=0,S=0}return m},parseUserData:function parseUserData(o){return 181!==o.payload[0]||49!=(o.payload[1]<<8|o.payload[2])||"GA94"!==String.fromCharCode(o.payload[3],o.payload[4],o.payload[5],o.payload[6])||3!==o.payload[7]?null:o.payload.subarray(8,o.payload.length-1)},parseCaptionPackets:function parseCaptionPackets(o,s){var m,_,S,E,A=[];if(!(64&s[0]))return A;for(_=31&s[0],m=0;m<_;m++)E={type:3&s[(S=3*m)+2],pts:o},4&s[S+2]&&(E.ccData=s[S+3]<<8|s[S+4],A.push(E));return A},discardEmulationPreventionBytes:function discardEmulationPreventionBytes$1(o){for(var s,m,_=o.byteLength,S=[],E=1;E<_-2;)0===o[E]&&0===o[E+1]&&3===o[E+2]?(S.push(E+2),E+=2):E++;if(0===S.length)return o;s=_-S.length,m=new Uint8Array(s);var A=0;for(E=0;E<s;A++,E++)A===S[0]&&(A++,S.shift()),m[E]=o[A];return m},USER_DATA_REGISTERED_ITU_T_T35:4},Or=Rt,Vr=Pr,oi=function CaptionStream$2(o){o=o||{},CaptionStream$2.prototype.init.call(this),this.parse708captions_="boolean"!=typeof o.parse708captions||o.parse708captions,this.captionPackets_=[],this.ccStreams_=[new oa(0,0),new oa(0,1),new oa(1,0),new oa(1,1)],this.parse708captions_&&(this.cc708Stream_=new bi({captionServices:o.captionServices})),this.reset(),this.ccStreams_.forEach((function(o){o.on("data",this.trigger.bind(this,"data")),o.on("partialdone",this.trigger.bind(this,"partialdone")),o.on("done",this.trigger.bind(this,"done"))}),this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};(oi.prototype=new Or).push=function(o){var s,m,_;if("sei_rbsp"===o.nalUnitType&&(s=Vr.parseSei(o.escapedRBSP)).payload&&s.payloadType===Vr.USER_DATA_REGISTERED_ITU_T_T35&&(m=Vr.parseUserData(s)))if(o.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(o.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));_=Vr.parseCaptionPackets(o.pts,m),this.captionPackets_=this.captionPackets_.concat(_),this.latestDts_!==o.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=o.dts}},oi.prototype.flushCCStreams=function(o){this.ccStreams_.forEach((function(s){return"flush"===o?s.flush():s.partialFlush()}),this)},oi.prototype.flushStream=function(o){this.captionPackets_.length?(this.captionPackets_.forEach((function(o,s){o.presortIndex=s})),this.captionPackets_.sort((function(o,s){return o.pts===s.pts?o.presortIndex-s.presortIndex:o.pts-s.pts})),this.captionPackets_.forEach((function(o){o.type<2?this.dispatchCea608Packet(o):this.dispatchCea708Packet(o)}),this),this.captionPackets_.length=0,this.flushCCStreams(o)):this.flushCCStreams(o)},oi.prototype.flush=function(){return this.flushStream("flush")},oi.prototype.partialFlush=function(){return this.flushStream("partialFlush")},oi.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(o){o.reset()}))},oi.prototype.dispatchCea608Packet=function(o){this.setsTextOrXDSActive(o)?this.activeCea608Channel_[o.type]=null:this.setsChannel1Active(o)?this.activeCea608Channel_[o.type]=0:this.setsChannel2Active(o)&&(this.activeCea608Channel_[o.type]=1),null!==this.activeCea608Channel_[o.type]&&this.ccStreams_[(o.type<<1)+this.activeCea608Channel_[o.type]].push(o)},oi.prototype.setsChannel1Active=function(o){return 4096==(30720&o.ccData)},oi.prototype.setsChannel2Active=function(o){return 6144==(30720&o.ccData)},oi.prototype.setsTextOrXDSActive=function(o){return 256==(28928&o.ccData)||4138==(30974&o.ccData)||6186==(30974&o.ccData)},oi.prototype.dispatchCea708Packet=function(o){this.parse708captions_&&this.cc708Stream_.push(o)};var li={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},hi=function within708TextBlock(o){return 32<=o&&o<=127||160<=o&&o<=255},gi=function Cea708Window(o){this.windowNum=o,this.reset()};gi.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},gi.prototype.getText=function(){return this.rows.join("\n")},gi.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},gi.prototype.newLine=function(o){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(o),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},gi.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},gi.prototype.addText=function(o){this.rows[this.rowIdx]+=o},gi.prototype.backspace=function(){if(!this.isEmpty()){var o=this.rows[this.rowIdx];this.rows[this.rowIdx]=o.substr(0,o.length-1)}};var _i=function Cea708Service(o,s,m){this.serviceNum=o,this.text="",this.currentWindow=new gi(-1),this.windows=[],this.stream=m,"string"==typeof s&&this.createTextDecoder(s)};_i.prototype.init=function(o,s){this.startPts=o;for(var m=0;m<8;m++)this.windows[m]=new gi(m),"function"==typeof s&&(this.windows[m].beforeRowOverflow=s)},_i.prototype.setCurrentWindow=function(o){this.currentWindow=this.windows[o]},_i.prototype.createTextDecoder=function(o){if("undefined"==typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(o)}catch(s){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+o+" encoding. "+s})}};var bi=function Cea708Stream(o){o=o||{},Cea708Stream.prototype.init.call(this);var s,m=this,_=o.captionServices||{},S={};Object.keys(_).forEach((function(o){s=_[o],/^SERVICE/.test(o)&&(S[o]=s.encoding)})),this.serviceEncodings=S,this.current708Packet=null,this.services={},this.push=function(o){3===o.type?(m.new708Packet(),m.add708Bytes(o)):(null===m.current708Packet&&m.new708Packet(),m.add708Bytes(o))}};bi.prototype=new Or,bi.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},bi.prototype.add708Bytes=function(o){var s=o.ccData,m=s>>>8,_=255&s;this.current708Packet.ptsVals.push(o.pts),this.current708Packet.data.push(m),this.current708Packet.data.push(_)},bi.prototype.push708Packet=function(){var o=this.current708Packet,s=o.data,m=null,_=null,S=0,E=s[S++];for(o.seq=E>>6,o.sizeCode=63&E;S<s.length;S++)_=31&(E=s[S++]),7===(m=E>>5)&&_>0&&(m=E=s[S++]),this.pushServiceBlock(m,S,_),_>0&&(S+=_-1)},bi.prototype.pushServiceBlock=function(o,s,m){var _,S=s,E=this.current708Packet.data,A=this.services[o];for(A||(A=this.initService(o,S));S<s+m&&S<E.length;S++)_=E[S],hi(_)?S=this.handleText(S,A):24===_?S=this.multiByteCharacter(S,A):16===_?S=this.extendedCommands(S,A):128<=_&&_<=135?S=this.setCurrentWindow(S,A):152<=_&&_<=159?S=this.defineWindow(S,A):136===_?S=this.clearWindows(S,A):140===_?S=this.deleteWindows(S,A):137===_?S=this.displayWindows(S,A):138===_?S=this.hideWindows(S,A):139===_?S=this.toggleWindows(S,A):151===_?S=this.setWindowAttributes(S,A):144===_?S=this.setPenAttributes(S,A):145===_?S=this.setPenColor(S,A):146===_?S=this.setPenLocation(S,A):143===_?A=this.reset(S,A):8===_?A.currentWindow.backspace():12===_?A.currentWindow.clearText():13===_?A.currentWindow.pendingNewLine=!0:14===_?A.currentWindow.clearText():141===_&&S++},bi.prototype.extendedCommands=function(o,s){var m=this.current708Packet.data[++o];return hi(m)&&(o=this.handleText(o,s,{isExtended:!0})),o},bi.prototype.getPts=function(o){return this.current708Packet.ptsVals[Math.floor(o/2)]},bi.prototype.initService=function(o,s){var m,_,S=this;return(m="SERVICE"+o)in this.serviceEncodings&&(_=this.serviceEncodings[m]),this.services[o]=new _i(o,_,S),this.services[o].init(this.getPts(s),(function(s){S.flushDisplayed(s,S.services[o])})),this.services[o]},bi.prototype.handleText=function(o,s,m){var _,S,E=m&&m.isExtended,A=m&&m.isMultiByte,O=this.current708Packet.data,H=E?4096:0,K=O[o],z=O[o+1],G=s.currentWindow;if(A?(S=[K,z],o++):S=[K],s.textDecoder_&&!E)_=s.textDecoder_.decode(new Uint8Array(S));else if(A){var q=function toHexString(o){return o.map((function(o){return("0"+(255&o).toString(16)).slice(-2)})).join("")}(S);_=String.fromCharCode(parseInt(q,16))}else _=function get708CharFromCode(o){var s=li[o]||o;return 4096&o&&o===s?"":String.fromCharCode(s)}(H|K);return G.pendingNewLine&&!G.isEmpty()&&G.newLine(this.getPts(o)),G.pendingNewLine=!1,G.addText(_),o},bi.prototype.multiByteCharacter=function(o,s){var m=this.current708Packet.data,_=m[o+1],S=m[o+2];return hi(_)&&hi(S)&&(o=this.handleText(++o,s,{isMultiByte:!0})),o},bi.prototype.setCurrentWindow=function(o,s){var m=7&this.current708Packet.data[o];return s.setCurrentWindow(m),o},bi.prototype.defineWindow=function(o,s){var m=this.current708Packet.data,_=m[o],S=7&_;s.setCurrentWindow(S);var E=s.currentWindow;return _=m[++o],E.visible=(32&_)>>5,E.rowLock=(16&_)>>4,E.columnLock=(8&_)>>3,E.priority=7&_,_=m[++o],E.relativePositioning=(128&_)>>7,E.anchorVertical=127&_,_=m[++o],E.anchorHorizontal=_,_=m[++o],E.anchorPoint=(240&_)>>4,E.rowCount=15&_,_=m[++o],E.columnCount=63&_,_=m[++o],E.windowStyle=(56&_)>>3,E.penStyle=7&_,E.virtualRowCount=E.rowCount+1,o},bi.prototype.setWindowAttributes=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.winAttr;return _=m[++o],S.fillOpacity=(192&_)>>6,S.fillRed=(48&_)>>4,S.fillGreen=(12&_)>>2,S.fillBlue=3&_,_=m[++o],S.borderType=(192&_)>>6,S.borderRed=(48&_)>>4,S.borderGreen=(12&_)>>2,S.borderBlue=3&_,_=m[++o],S.borderType+=(128&_)>>5,S.wordWrap=(64&_)>>6,S.printDirection=(48&_)>>4,S.scrollDirection=(12&_)>>2,S.justify=3&_,_=m[++o],S.effectSpeed=(240&_)>>4,S.effectDirection=(12&_)>>2,S.displayEffect=3&_,o},bi.prototype.flushDisplayed=function(o,s){for(var m=[],_=0;_<8;_++)s.windows[_].visible&&!s.windows[_].isEmpty()&&m.push(s.windows[_].getText());s.endPts=o,s.text=m.join("\n\n"),this.pushCaption(s),s.startPts=o},bi.prototype.pushCaption=function(o){""!==o.text&&(this.trigger("data",{startPts:o.startPts,endPts:o.endPts,text:o.text,stream:"cc708_"+o.serviceNum}),o.text="",o.startPts=o.endPts)},bi.prototype.displayWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible=1);return o},bi.prototype.hideWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible=0);return o},bi.prototype.toggleWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible^=1);return o},bi.prototype.clearWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&s.windows[S].clearText();return o},bi.prototype.deleteWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&s.windows[S].reset();return o},bi.prototype.setPenAttributes=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penAttr;return _=m[++o],S.textTag=(240&_)>>4,S.offset=(12&_)>>2,S.penSize=3&_,_=m[++o],S.italics=(128&_)>>7,S.underline=(64&_)>>6,S.edgeType=(56&_)>>3,S.fontStyle=7&_,o},bi.prototype.setPenColor=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penColor;return _=m[++o],S.fgOpacity=(192&_)>>6,S.fgRed=(48&_)>>4,S.fgGreen=(12&_)>>2,S.fgBlue=3&_,_=m[++o],S.bgOpacity=(192&_)>>6,S.bgRed=(48&_)>>4,S.bgGreen=(12&_)>>2,S.bgBlue=3&_,_=m[++o],S.edgeRed=(48&_)>>4,S.edgeGreen=(12&_)>>2,S.edgeBlue=3&_,o},bi.prototype.setPenLocation=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penLoc;return s.currentWindow.pendingNewLine=!0,_=m[++o],S.row=15&_,_=m[++o],S.column=63&_,o},bi.prototype.reset=function(o,s){var m=this.getPts(o);return this.flushDisplayed(m,s),this.initService(s.serviceNum,o)};var Ui={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},ta=function getCharFromCode(o){return null===o?"":(o=Ui[o]||o,String.fromCharCode(o))},na=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],aa=function createDisplayBuffer(){for(var o=[],s=15;s--;)o.push({text:"",indent:0,offset:0});return o},oa=function Cea608Stream(o,s){Cea608Stream.prototype.init.call(this),this.field_=o||0,this.dataChannel_=s||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(o){var s,m,_,S,E;if((s=32639&o.ccData)!==this.lastControlCode_){if(4096==(61440&s)?this.lastControlCode_=s:s!==this.PADDING_&&(this.lastControlCode_=null),_=s>>>8,S=255&s,s!==this.PADDING_)if(s===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(s===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(o.pts),this.flushDisplayed(o.pts),m=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=m,this.startPts_=o.pts;else if(s===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(o.pts);else if(s===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(o.pts);else if(s===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(o.pts);else if(s===this.CARRIAGE_RETURN_)this.clearFormatting(o.pts),this.flushDisplayed(o.pts),this.shiftRowsUp_(),this.startPts_=o.pts;else if(s===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(s===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(o.pts),this.displayed_=aa();else if(s===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=aa();else if(s===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(o.pts),this.displayed_=aa()),this.mode_="paintOn",this.startPts_=o.pts;else if(this.isSpecialCharacter(_,S))E=ta((_=(3&_)<<8)|S),this[this.mode_](o.pts,E),this.column_++;else if(this.isExtCharacter(_,S))"popOn"===this.mode_?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),E=ta((_=(3&_)<<8)|S),this[this.mode_](o.pts,E),this.column_++;else if(this.isMidRowCode(_,S))this.clearFormatting(o.pts),this[this.mode_](o.pts," "),this.column_++,14==(14&S)&&this.addFormatting(o.pts,["i"]),1==(1&S)&&this.addFormatting(o.pts,["u"]);else if(this.isOffsetControlCode(_,S)){var A=3&S;this.nonDisplayed_[this.row_].offset=A,this.column_+=A}else if(this.isPAC(_,S)){var O=na.indexOf(7968&s);if("rollUp"===this.mode_&&(O-this.rollUpRows_+1<0&&(O=this.rollUpRows_-1),this.setRollUp(o.pts,O)),O!==this.row_&&(this.clearFormatting(o.pts),this.row_=O),1&S&&-1===this.formatting_.indexOf("u")&&this.addFormatting(o.pts,["u"]),16==(16&s)){var H=(14&s)>>1;this.column_=4*H,this.nonDisplayed_[this.row_].indent+=H}this.isColorPAC(S)&&14==(14&S)&&this.addFormatting(o.pts,["i"])}else this.isNormalChar(_)&&(0===S&&(S=null),E=ta(_),E+=ta(S),this[this.mode_](o.pts,E),this.column_+=E.length)}else this.lastControlCode_=null}};oa.prototype=new Or,oa.prototype.flushDisplayed=function(o){var s=this,m=function logWarning(o){s.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+o+"."})},_=[];this.displayed_.forEach((function(o,s){if(o&&o.text&&o.text.length){try{o.text=o.text.trim()}catch(o){m(s)}o.text.length&&_.push({text:o.text,line:s+1,position:10+Math.min(70,10*o.indent)+2.5*o.offset})}else null==o&&m(s)})),_.length&&this.trigger("data",{startPts:this.startPts_,endPts:o,content:_,stream:this.name_})},oa.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=aa(),this.nonDisplayed_=aa(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},oa.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},oa.prototype.isSpecialCharacter=function(o,s){return o===this.EXT_&&s>=48&&s<=63},oa.prototype.isExtCharacter=function(o,s){return(o===this.EXT_+1||o===this.EXT_+2)&&s>=32&&s<=63},oa.prototype.isMidRowCode=function(o,s){return o===this.EXT_&&s>=32&&s<=47},oa.prototype.isOffsetControlCode=function(o,s){return o===this.OFFSET_&&s>=33&&s<=35},oa.prototype.isPAC=function(o,s){return o>=this.BASE_&&o<this.BASE_+8&&s>=64&&s<=127},oa.prototype.isColorPAC=function(o){return o>=64&&o<=79||o>=96&&o<=127},oa.prototype.isNormalChar=function(o){return o>=32&&o<=127},oa.prototype.setRollUp=function(o,s){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(o),this.nonDisplayed_=aa(),this.displayed_=aa()),void 0!==s&&s!==this.row_)for(var m=0;m<this.rollUpRows_;m++)this.displayed_[s-m]=this.displayed_[this.row_-m],this.displayed_[this.row_-m]={text:"",indent:0,offset:0};void 0===s&&(s=this.row_),this.topRow_=s-this.rollUpRows_+1},oa.prototype.addFormatting=function(o,s){this.formatting_=this.formatting_.concat(s);var m=s.reduce((function(o,s){return o+"<"+s+">"}),"");this[this.mode_](o,m)},oa.prototype.clearFormatting=function(o){if(this.formatting_.length){var s=this.formatting_.reverse().reduce((function(o,s){return o+"</"+s+">"}),"");this.formatting_=[],this[this.mode_](o,s)}},oa.prototype.popOn=function(o,s){var m=this.nonDisplayed_[this.row_].text;m+=s,this.nonDisplayed_[this.row_].text=m},oa.prototype.rollUp=function(o,s){var m=this.displayed_[this.row_].text;m+=s,this.displayed_[this.row_].text=m},oa.prototype.shiftRowsUp_=function(){var o;for(o=0;o<this.topRow_;o++)this.displayed_[o]={text:"",indent:0,offset:0};for(o=this.row_+1;o<15;o++)this.displayed_[o]={text:"",indent:0,offset:0};for(o=this.topRow_;o<this.row_;o++)this.displayed_[o]=this.displayed_[o+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},oa.prototype.paintOn=function(o,s){var m=this.displayed_[this.row_].text;m+=s,this.displayed_[this.row_].text=m};var la={CaptionStream:oi,Cea608Stream:oa,Cea708Stream:bi},ca={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},da="shared",pa=function handleRollover$1(o,s){var m=1;for(o>s&&(m=-1);Math.abs(s-o)>4294967296;)o+=8589934592*m;return o},fa=function TimestampRolloverStream$1(o){var s,m;TimestampRolloverStream$1.prototype.init.call(this),this.type_=o||da,this.push=function(o){"metadata"!==o.type?this.type_!==da&&o.type!==this.type_||(void 0===m&&(m=o.dts),o.dts=pa(o.dts,m),o.pts=pa(o.pts,m),s=o.dts,this.trigger("data",o)):this.trigger("data",o)},this.flush=function(){m=s,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){m=void 0,s=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};fa.prototype=new Rt;var ga,ma=fa,_a=pa,Sa=function typedArrayIndexOf$1(o,s,m){if(!o)return-1;for(var _=m;_<o.length;_++)if(o[_]===s)return _;return-1},ka=Sa,xa=3,Da=function percentEncode$1(o,s,m){var _,S="";for(_=s;_<m;_++)S+="%"+("00"+o[_].toString(16)).slice(-2);return S},Ra=function parseUtf8(o,s,m){return decodeURIComponent(Da(o,s,m))},ja=function parseIso88591$1(o,s,m){return unescape(Da(o,s,m))},Va=function parseSyncSafeInteger$1(o){return o[0]<<21|o[1]<<14|o[2]<<7|o[3]},za={APIC:function APIC(o){var s,m,_=1;o.data[0]===xa&&((s=ka(o.data,0,_))<0||(o.mimeType=ja(o.data,_,s),_=s+1,o.pictureType=o.data[_],_++,(m=ka(o.data,0,_))<0||(o.description=Ra(o.data,_,m),_=m+1,"--\x3e"===o.mimeType?o.url=ja(o.data,_,o.data.length):o.pictureData=o.data.subarray(_,o.data.length))))},"T*":function T(o){o.data[0]===xa&&(o.value=Ra(o.data,1,o.data.length).replace(/\0*$/,""),o.values=o.value.split("\0"))},TXXX:function TXXX(o){var s;o.data[0]===xa&&-1!==(s=ka(o.data,0,1))&&(o.description=Ra(o.data,1,s),o.value=Ra(o.data,s+1,o.data.length).replace(/\0*$/,""),o.data=o.value)},"W*":function W(o){o.url=ja(o.data,0,o.data.length).replace(/\0.*$/,"")},WXXX:function WXXX(o){var s;o.data[0]===xa&&-1!==(s=ka(o.data,0,1))&&(o.description=Ra(o.data,1,s),o.url=ja(o.data,s+1,o.data.length).replace(/\0.*$/,""))},PRIV:function PRIV(o){var s;for(s=0;s<o.data.length;s++)if(0===o.data[s]){o.owner=ja(o.data,0,s);break}o.privateData=o.data.subarray(s+1),o.data=o.privateData}},qa={parseId3Frames:function parseId3Frames$1(o){var s,m=10,_=0,S=[];if(!(o.length<10||o[0]!=="I".charCodeAt(0)||o[1]!=="D".charCodeAt(0)||o[2]!=="3".charCodeAt(0))){_=Va(o.subarray(6,10)),_+=10,64&o[5]&&(m+=4,m+=Va(o.subarray(10,14)),_-=Va(o.subarray(16,20)));do{if((s=Va(o.subarray(m+4,m+8)))<1)break;var E={id:String.fromCharCode(o[m],o[m+1],o[m+2],o[m+3]),data:o.subarray(m+10,m+s+10)};E.key=E.id,za[E.id]?za[E.id](E):"T"===E.id[0]?za["T*"](E):"W"===E.id[0]&&za["W*"](E),S.push(E),m+=10,m+=s}while(m<_);return S}},parseSyncSafeInteger:Va,frameParsers:za},Qa=Rt,Za=ca,ro=qa;ga=function MetadataStream(o){var s,m={descriptor:o&&o.descriptor},_=0,S=[],E=0;if(ga.prototype.init.call(this),this.dispatchType=Za.METADATA_STREAM_TYPE.toString(16),m.descriptor)for(s=0;s<m.descriptor.length;s++)this.dispatchType+=("00"+m.descriptor[s].toString(16)).slice(-2);this.push=function(o){var s,m,A,O,H;if("timed-metadata"===o.type)if(o.dataAlignmentIndicator&&(E=0,S.length=0),0===S.length&&(o.data.length<10||o.data[0]!=="I".charCodeAt(0)||o.data[1]!=="D".charCodeAt(0)||o.data[2]!=="3".charCodeAt(0)))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(S.push(o),E+=o.data.byteLength,1===S.length&&(_=ro.parseSyncSafeInteger(o.data.subarray(6,10)),_+=10),!(E<_)){for(s={data:new Uint8Array(_),frames:[],pts:S[0].pts,dts:S[0].dts},H=0;H<_;)s.data.set(S[0].data.subarray(0,_-H),H),H+=S[0].data.byteLength,E-=S[0].data.byteLength,S.shift();m=10,64&s.data[5]&&(m+=4,m+=ro.parseSyncSafeInteger(s.data.subarray(10,14)),_-=ro.parseSyncSafeInteger(s.data.subarray(16,20)));do{if((A=ro.parseSyncSafeInteger(s.data.subarray(m+4,m+8)))<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if((O={id:String.fromCharCode(s.data[m],s.data[m+1],s.data[m+2],s.data[m+3]),data:s.data.subarray(m+10,m+A+10)}).key=O.id,ro.frameParsers[O.id]?ro.frameParsers[O.id](O):"T"===O.id[0]?ro.frameParsers["T*"](O):"W"===O.id[0]&&ro.frameParsers["W*"](O),"com.apple.streaming.transportStreamTimestamp"===O.owner){var K=O.data,z=(1&K[3])<<30|K[4]<<22|K[5]<<14|K[6]<<6|K[7]>>>2;z*=4,z+=3&K[7],O.timeStamp=z,void 0===s.pts&&void 0===s.dts&&(s.pts=O.timeStamp,s.dts=O.timeStamp),this.trigger("timestamp",O)}s.frames.push(O),m+=10,m+=A}while(m<_);this.trigger("data",s)}}},ga.prototype=new Qa;var oo,lo,ho,po=ga,_o=Rt,So=la,To=ca,Co=ma,Eo=188;(oo=function TransportPacketStream(){var o=new Uint8Array(Eo),s=0;oo.prototype.init.call(this),this.push=function(m){var _,S=0,E=Eo;for(s?((_=new Uint8Array(m.byteLength+s)).set(o.subarray(0,s)),_.set(m,s),s=0):_=m;E<_.byteLength;)71!==_[S]||71!==_[E]?(S++,E++):(this.trigger("data",_.subarray(S,E)),S+=Eo,E+=Eo);S<_.byteLength&&(o.set(_.subarray(S),0),s=_.byteLength-S)},this.flush=function(){s===Eo&&71===o[0]&&(this.trigger("data",o),s=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){s=0,this.trigger("reset")}}).prototype=new _o,lo=function TransportParseStream(){var o,s,m,_;lo.prototype.init.call(this),_=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,o=function parsePsi(o,_){var S=0;_.payloadUnitStartIndicator&&(S+=o[S]+1),"pat"===_.type?s(o.subarray(S),_):m(o.subarray(S),_)},s=function parsePat(o,s){s.section_number=o[7],s.last_section_number=o[8],_.pmtPid=(31&o[10])<<8|o[11],s.pmtPid=_.pmtPid},m=function parsePmt(o,s){var m,S;if(1&o[5]){for(_.programMapTable={video:null,audio:null,"timed-metadata":{}},m=3+((15&o[1])<<8|o[2])-4,S=12+((15&o[10])<<8|o[11]);S<m;){var E=o[S],A=(31&o[S+1])<<8|o[S+2];E===To.H264_STREAM_TYPE&&null===_.programMapTable.video?_.programMapTable.video=A:E===To.ADTS_STREAM_TYPE&&null===_.programMapTable.audio?_.programMapTable.audio=A:E===To.METADATA_STREAM_TYPE&&(_.programMapTable["timed-metadata"][A]=E),S+=5+((15&o[S+3])<<8|o[S+4])}s.programMapTable=_.programMapTable}},this.push=function(s){var m={},_=4;if(m.payloadUnitStartIndicator=!!(64&s[1]),m.pid=31&s[1],m.pid<<=8,m.pid|=s[2],(48&s[3])>>>4>1&&(_+=s[_]+1),0===m.pid)m.type="pat",o(s.subarray(_),m),this.trigger("data",m);else if(m.pid===this.pmtPid)for(m.type="pmt",o(s.subarray(_),m),this.trigger("data",m);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([s,_,m]):this.processPes_(s,_,m)},this.processPes_=function(o,s,m){m.pid===this.programMapTable.video?m.streamType=To.H264_STREAM_TYPE:m.pid===this.programMapTable.audio?m.streamType=To.ADTS_STREAM_TYPE:m.streamType=this.programMapTable["timed-metadata"][m.pid],m.type="pes",m.data=o.subarray(s),this.trigger("data",m)}},lo.prototype=new _o,lo.STREAM_TYPES={h264:27,adts:15},ho=function ElementaryStream(){var o,s=this,m=!1,_={data:[],size:0},S={data:[],size:0},E={data:[],size:0},A=function flushStream(o,m,_){var S,E,A=new Uint8Array(o.size),O={type:m},H=0,K=0;if(o.data.length&&!(o.size<9)){for(O.trackId=o.data[0].pid,H=0;H<o.data.length;H++)E=o.data[H],A.set(E.data,K),K+=E.data.byteLength;!function parsePes(o,s){var m,_=o[0]<<16|o[1]<<8|o[2];s.data=new Uint8Array,1===_&&(s.packetLength=6+(o[4]<<8|o[5]),s.dataAlignmentIndicator=0!=(4&o[6]),192&(m=o[7])&&(s.pts=(14&o[9])<<27|(255&o[10])<<20|(254&o[11])<<12|(255&o[12])<<5|(254&o[13])>>>3,s.pts*=4,s.pts+=(6&o[13])>>>1,s.dts=s.pts,64&m&&(s.dts=(14&o[14])<<27|(255&o[15])<<20|(254&o[16])<<12|(255&o[17])<<5|(254&o[18])>>>3,s.dts*=4,s.dts+=(6&o[18])>>>1)),s.data=o.subarray(9+o[8]))}(A,O),S="video"===m||O.packetLength<=o.size,(_||S)&&(o.size=0,o.data.length=0),S&&s.trigger("data",O)}};ho.prototype.init.call(this),this.push=function(O){({pat:function pat(){},pes:function pes(){var o,s;switch(O.streamType){case To.H264_STREAM_TYPE:o=_,s="video";break;case To.ADTS_STREAM_TYPE:o=S,s="audio";break;case To.METADATA_STREAM_TYPE:o=E,s="timed-metadata";break;default:return}O.payloadUnitStartIndicator&&A(o,s,!0),o.data.push(O),o.size+=O.data.byteLength},pmt:function pmt(){var _={type:"metadata",tracks:[]};null!==(o=O.programMapTable).video&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.video,codec:"avc",type:"video"}),null!==o.audio&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.audio,codec:"adts",type:"audio"}),m=!0,s.trigger("data",_)}})[O.type]()},this.reset=function(){_.size=0,_.data.length=0,S.size=0,S.data.length=0,this.trigger("reset")},this.flushStreams_=function(){A(_,"video"),A(S,"audio"),A(E,"timed-metadata")},this.flush=function(){if(!m&&o){var _={type:"metadata",tracks:[]};null!==o.video&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.video,codec:"avc",type:"video"}),null!==o.audio&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.audio,codec:"adts",type:"audio"}),s.trigger("data",_)}m=!1,this.flushStreams_(),this.trigger("done")}},ho.prototype=new _o;var Io={PAT_PID:0,MP2T_PACKET_LENGTH:Eo,TransportPacketStream:oo,TransportParseStream:lo,ElementaryStream:ho,TimestampRolloverStream:Co,CaptionStream:So.CaptionStream,Cea608Stream:So.Cea608Stream,Cea708Stream:So.Cea708Stream,MetadataStream:po};for(var Lo in To)To.hasOwnProperty(Lo)&&(Io[Lo]=To[Lo]);var Do,Oo=Io,Fo=Rt,No=Gn.ONE_SECOND_IN_TS,Bo=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Do=function AdtsStream$1(o){var s,m=0;Do.prototype.init.call(this),this.skipWarn_=function(o,s){this.trigger("log",{level:"warn",message:"adts skiping bytes ".concat(o," to ").concat(s," in frame ").concat(m," outside syncword")})},this.push=function(_){var S,E,A,O,H,K=0;if(o||(m=0),"audio"===_.type){var z;for(s&&s.length?(A=s,(s=new Uint8Array(A.byteLength+_.data.byteLength)).set(A),s.set(_.data,A.byteLength)):s=_.data;K+7<s.length;)if(255===s[K]&&240==(246&s[K+1])){if("number"==typeof z&&(this.skipWarn_(z,K),z=null),E=2*(1&~s[K+1]),S=(3&s[K+3])<<11|s[K+4]<<3|(224&s[K+5])>>5,H=(O=1024*(1+(3&s[K+6])))*No/Bo[(60&s[K+2])>>>2],s.byteLength-K<S)break;this.trigger("data",{pts:_.pts+m*H,dts:_.dts+m*H,sampleCount:O,audioobjecttype:1+(s[K+2]>>>6&3),channelcount:(1&s[K+2])<<2|(192&s[K+3])>>>6,samplerate:Bo[(60&s[K+2])>>>2],samplingfrequencyindex:(60&s[K+2])>>>2,samplesize:16,data:s.subarray(K+7+E,K+S)}),m++,K+=S}else"number"!=typeof z&&(z=K),K++;"number"==typeof z&&(this.skipWarn_(z,K),z=null),s=s.subarray(K)}},this.flush=function(){m=0,this.trigger("done")},this.reset=function(){s=void 0,this.trigger("reset")},this.endTimeline=function(){s=void 0,this.trigger("endedtimeline")}},Do.prototype=new Fo;var Vo,Ho=Do;Vo=function ExpGolomb$1(o){var s=o.byteLength,m=0,_=0;this.length=function(){return 8*s},this.bitsAvailable=function(){return 8*s+_},this.loadWord=function(){var S=o.byteLength-s,E=new Uint8Array(4),A=Math.min(4,s);if(0===A)throw new Error("no bytes available");E.set(o.subarray(S,S+A)),m=new DataView(E.buffer).getUint32(0),_=8*A,s-=A},this.skipBits=function(o){var S;_>o?(m<<=o,_-=o):(o-=_,o-=8*(S=Math.floor(o/8)),s-=S,this.loadWord(),m<<=o,_-=o)},this.readBits=function(o){var S=Math.min(_,o),E=m>>>32-S;return(_-=S)>0?m<<=S:s>0&&this.loadWord(),(S=o-S)>0?E<<S|this.readBits(S):E},this.skipLeadingZeros=function(){var o;for(o=0;o<_;++o)if(0!=(m&2147483648>>>o))return m<<=o,_-=o,o;return this.loadWord(),o+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var o=this.skipLeadingZeros();return this.readBits(o+1)-1},this.readExpGolomb=function(){var o=this.readUnsignedExpGolomb();return 1&o?1+o>>>1:-1*(o>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var Go,qo,Qo,as=Rt,_s=Vo;qo=function NalByteStream(){var o,s,m=0;qo.prototype.init.call(this),this.push=function(_){var S;s?((S=new Uint8Array(s.byteLength+_.data.byteLength)).set(s),S.set(_.data,s.byteLength),s=S):s=_.data;for(var E=s.byteLength;m<E-3;m++)if(1===s[m+2]){o=m+5;break}for(;o<E;)switch(s[o]){case 0:if(0!==s[o-1]){o+=2;break}if(0!==s[o-2]){o++;break}m+3!==o-2&&this.trigger("data",s.subarray(m+3,o-2));do{o++}while(1!==s[o]&&o<E);m=o-2,o+=3;break;case 1:if(0!==s[o-1]||0!==s[o-2]){o+=3;break}this.trigger("data",s.subarray(m+3,o-2)),m=o-2,o+=3;break;default:o+=3}s=s.subarray(m),o-=m,m=0},this.reset=function(){s=null,m=0,this.trigger("reset")},this.flush=function(){s&&s.byteLength>3&&this.trigger("data",s.subarray(m+3)),s=null,m=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},qo.prototype=new as,Qo={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},Go=function H264Stream$1(){var o,s,m,_,S,E,A,O=new qo;Go.prototype.init.call(this),o=this,this.push=function(o){"video"===o.type&&(s=o.trackId,m=o.pts,_=o.dts,O.push(o))},O.on("data",(function(A){var O={trackId:s,pts:m,dts:_,data:A,nalUnitTypeCode:31&A[0]};switch(O.nalUnitTypeCode){case 5:O.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:O.nalUnitType="sei_rbsp",O.escapedRBSP=S(A.subarray(1));break;case 7:O.nalUnitType="seq_parameter_set_rbsp",O.escapedRBSP=S(A.subarray(1)),O.config=E(O.escapedRBSP);break;case 8:O.nalUnitType="pic_parameter_set_rbsp";break;case 9:O.nalUnitType="access_unit_delimiter_rbsp"}o.trigger("data",O)})),O.on("done",(function(){o.trigger("done")})),O.on("partialdone",(function(){o.trigger("partialdone")})),O.on("reset",(function(){o.trigger("reset")})),O.on("endedtimeline",(function(){o.trigger("endedtimeline")})),this.flush=function(){O.flush()},this.partialFlush=function(){O.partialFlush()},this.reset=function(){O.reset()},this.endTimeline=function(){O.endTimeline()},A=function skipScalingList(o,s){var m,_=8,S=8;for(m=0;m<o;m++)0!==S&&(S=(_+s.readExpGolomb()+256)%256),_=0===S?_:S},S=function discardEmulationPreventionBytes(o){for(var s,m,_=o.byteLength,S=[],E=1;E<_-2;)0===o[E]&&0===o[E+1]&&3===o[E+2]?(S.push(E+2),E+=2):E++;if(0===S.length)return o;s=_-S.length,m=new Uint8Array(s);var A=0;for(E=0;E<s;A++,E++)A===S[0]&&(A++,S.shift()),m[E]=o[A];return m},E=function readSequenceParameterSet(o){var s,m,_,S,E,O,H,K,z,G,q,X,J=0,ae=0,pe=0,me=0,_e=[1,1];if(m=(s=new _s(o)).readUnsignedByte(),S=s.readUnsignedByte(),_=s.readUnsignedByte(),s.skipUnsignedExpGolomb(),Qo[m]&&(3===(E=s.readUnsignedExpGolomb())&&s.skipBits(1),s.skipUnsignedExpGolomb(),s.skipUnsignedExpGolomb(),s.skipBits(1),s.readBoolean()))for(q=3!==E?8:12,X=0;X<q;X++)s.readBoolean()&&A(X<6?16:64,s);if(s.skipUnsignedExpGolomb(),0===(O=s.readUnsignedExpGolomb()))s.readUnsignedExpGolomb();else if(1===O)for(s.skipBits(1),s.skipExpGolomb(),s.skipExpGolomb(),H=s.readUnsignedExpGolomb(),X=0;X<H;X++)s.skipExpGolomb();if(s.skipUnsignedExpGolomb(),s.skipBits(1),K=s.readUnsignedExpGolomb(),z=s.readUnsignedExpGolomb(),0===(G=s.readBits(1))&&s.skipBits(1),s.skipBits(1),s.readBoolean()&&(J=s.readUnsignedExpGolomb(),ae=s.readUnsignedExpGolomb(),pe=s.readUnsignedExpGolomb(),me=s.readUnsignedExpGolomb()),s.readBoolean()&&s.readBoolean()){switch(s.readUnsignedByte()){case 1:_e=[1,1];break;case 2:_e=[12,11];break;case 3:_e=[10,11];break;case 4:_e=[16,11];break;case 5:_e=[40,33];break;case 6:_e=[24,11];break;case 7:_e=[20,11];break;case 8:_e=[32,11];break;case 9:_e=[80,33];break;case 10:_e=[18,11];break;case 11:_e=[15,11];break;case 12:_e=[64,33];break;case 13:_e=[160,99];break;case 14:_e=[4,3];break;case 15:_e=[3,2];break;case 16:_e=[2,1];break;case 255:_e=[s.readUnsignedByte()<<8|s.readUnsignedByte(),s.readUnsignedByte()<<8|s.readUnsignedByte()]}_e&&(_e[0],_e[1])}return{profileIdc:m,levelIdc:_,profileCompatibility:S,width:16*(K+1)-2*J-2*ae,height:(2-G)*(z+1)*16-2*pe-2*me,sarRatio:_e}}},Go.prototype=new as;var ws,Os={H264Stream:Go,NalByteStream:qo},Us=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Bs=function parseId3TagSize(o,s){var m=o[s+6]<<21|o[s+7]<<14|o[s+8]<<7|o[s+9];return m=m>=0?m:0,(16&o[s+5])>>4?m+20:m+10},Hs=function getId3Offset(o,s){return o.length-s<10||o[s]!=="I".charCodeAt(0)||o[s+1]!=="D".charCodeAt(0)||o[s+2]!=="3".charCodeAt(0)?s:getId3Offset(o,s+=Bs(o,s))},Ys=function parseSyncSafeInteger(o){return o[0]<<21|o[1]<<14|o[2]<<7|o[3]},Zs=function parseIso88591(o,s,m){return unescape(function percentEncode(o,s,m){var _,S="";for(_=s;_<m;_++)S+="%"+("00"+o[_].toString(16)).slice(-2);return S}(o,s,m))},pu={isLikelyAacData:function isLikelyAacData$1(o){var s=Hs(o,0);return o.length>=s+2&&255==(255&o[s])&&240==(240&o[s+1])&&16==(22&o[s+1])},parseId3TagSize:Bs,parseAdtsSize:function parseAdtsSize(o,s){var m=(224&o[s+5])>>5,_=o[s+4]<<3;return 6144&o[s+3]|_|m},parseType:function parseType$4(o,s){return o[s]==="I".charCodeAt(0)&&o[s+1]==="D".charCodeAt(0)&&o[s+2]==="3".charCodeAt(0)?"timed-metadata":!0&o[s]&&240==(240&o[s+1])?"audio":null},parseSampleRate:function parseSampleRate(o){for(var s=0;s+5<o.length;){if(255===o[s]&&240==(246&o[s+1]))return Us[(60&o[s+2])>>>2];s++}return null},parseAacTimestamp:function parseAacTimestamp(o){var s,m,_;s=10,64&o[5]&&(s+=4,s+=Ys(o.subarray(10,14)));do{if((m=Ys(o.subarray(s+4,s+8)))<1)return null;if("PRIV"===String.fromCharCode(o[s],o[s+1],o[s+2],o[s+3])){_=o.subarray(s+10,s+m+10);for(var S=0;S<_.byteLength;S++)if(0===_[S]){if("com.apple.streaming.transportStreamTimestamp"===Zs(_,0,S)){var E=_.subarray(S+1),A=(1&E[3])<<30|E[4]<<22|E[5]<<14|E[6]<<6|E[7]>>>2;return A*=4,A+=3&E[7]}break}}s+=10,s+=m}while(s<o.byteLength);return null}},_u=pu;(ws=function AacStream$1(){var o=new Uint8Array,s=0;ws.prototype.init.call(this),this.setTimestamp=function(o){s=o},this.push=function(m){var _,S,E,A,O=0,H=0;for(o.length?(A=o.length,(o=new Uint8Array(m.byteLength+A)).set(o.subarray(0,A)),o.set(m,A)):o=m;o.length-H>=3;)if(o[H]!=="I".charCodeAt(0)||o[H+1]!=="D".charCodeAt(0)||o[H+2]!=="3".charCodeAt(0))if(255!=(255&o[H])||240!=(240&o[H+1]))H++;else{if(o.length-H<7)break;if(H+(O=_u.parseAdtsSize(o,H))>o.length)break;E={type:"audio",data:o.subarray(H,H+O),pts:s,dts:s},this.trigger("data",E),H+=O}else{if(o.length-H<10)break;if(H+(O=_u.parseId3TagSize(o,H))>o.length)break;S={type:"timed-metadata",data:o.subarray(H,H+O)},this.trigger("data",S),H+=O}_=o.length-H,o=_>0?o.subarray(H):new Uint8Array},this.reset=function(){o=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){o=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new Rt;var vl,_l,Pl,Ql,nc=Rt,ic=_n,ac=wn,lc=vr,mc=wr,yc=Oo,_c=Gn,kc=Ho,Ec=Os.H264Stream,Ac=ws,Dc=pu.isLikelyAacData,Mc=Gn.ONE_SECOND_IN_TS,jc=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],zc=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],qc=function retriggerForStream(o,s){s.stream=o,this.trigger("log",s)},Xc=function addPipelineLogRetriggers(o,s){for(var m=Object.keys(s),_=0;_<m.length;_++){var S=m[_];"headOfPipeline"!==S&&s[S].on&&s[S].on("log",qc.bind(o,S))}},_d=function arrayEquals(o,s){var m;if(o.length!==s.length)return!1;for(m=0;m<o.length;m++)if(o[m]!==s[m])return!1;return!0},Cd=function generateSegmentTimingInfo(o,s,m,_,S,E){return{start:{dts:o,pts:o+(m-s)},end:{dts:o+(_-s),pts:o+(S-m)},prependedContentDuration:E,baseMediaDecodeTime:o}};_l=function AudioSegmentStream(o,s){var m,_=[],S=0,E=0,A=1/0;m=(s=s||{}).firstSequenceNumber||0,_l.prototype.init.call(this),this.push=function(s){mc.collectDtsInfo(o,s),o&&jc.forEach((function(m){o[m]=s[m]})),_.push(s)},this.setEarliestDts=function(o){S=o},this.setVideoBaseMediaDecodeTime=function(o){A=o},this.setAudioAppendStart=function(o){E=o},this.flush=function(){var O,H,K,z,G,q,X;0!==_.length?(O=lc.trimAdtsFramesByEarliestDts(_,o,S),o.baseMediaDecodeTime=mc.calculateTrackBaseMediaDecodeTime(o,s.keepOriginalTimestamps),X=lc.prefixWithSilence(o,O,E,A),o.samples=lc.generateSampleTable(O),K=ic.mdat(lc.concatenateFrameData(O)),_=[],H=ic.moof(m,[o]),z=new Uint8Array(H.byteLength+K.byteLength),m++,z.set(H),z.set(K,H.byteLength),mc.clearDtsInfo(o),G=Math.ceil(1024*Mc/o.samplerate),O.length&&(q=O.length*G,this.trigger("segmentTimingInfo",Cd(_c.audioTsToVideoTs(o.baseMediaDecodeTime,o.samplerate),O[0].dts,O[0].pts,O[0].dts+q,O[0].pts+q,X||0)),this.trigger("timingInfo",{start:O[0].pts,end:O[0].pts+q})),this.trigger("data",{track:o,boxes:z}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){mc.clearDtsInfo(o),_=[],this.trigger("reset")}},_l.prototype=new nc,vl=function VideoSegmentStream(o,s){var m,_,S,E=[],A=[];m=(s=s||{}).firstSequenceNumber||0,vl.prototype.init.call(this),delete o.minPTS,this.gopCache_=[],this.push=function(s){mc.collectDtsInfo(o,s),"seq_parameter_set_rbsp"!==s.nalUnitType||_||(_=s.config,o.sps=[s.data],zc.forEach((function(s){o[s]=_[s]}),this)),"pic_parameter_set_rbsp"!==s.nalUnitType||S||(S=s.data,o.pps=[s.data]),E.push(s)},this.flush=function(){for(var _,S,O,H,K,z,G,q,X=0;E.length&&"access_unit_delimiter_rbsp"!==E[0].nalUnitType;)E.shift();if(0===E.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(_=ac.groupNalsIntoFrames(E),(O=ac.groupFramesIntoGops(_))[0][0].keyFrame||((S=this.getGopForFusion_(E[0],o))?(X=S.duration,O.unshift(S),O.byteLength+=S.byteLength,O.nalCount+=S.nalCount,O.pts=S.pts,O.dts=S.dts,O.duration+=S.duration):O=ac.extendFirstKeyFrame(O)),A.length){var J;if(!(J=s.alignGopsAtEnd?this.alignGopsAtEnd_(O):this.alignGopsAtStart_(O)))return this.gopCache_.unshift({gop:O.pop(),pps:o.pps,sps:o.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");mc.clearDtsInfo(o),O=J}mc.collectDtsInfo(o,O),o.samples=ac.generateSampleTable(O),K=ic.mdat(ac.concatenateNalData(O)),o.baseMediaDecodeTime=mc.calculateTrackBaseMediaDecodeTime(o,s.keepOriginalTimestamps),this.trigger("processedGopsInfo",O.map((function(o){return{pts:o.pts,dts:o.dts,byteLength:o.byteLength}}))),G=O[0],q=O[O.length-1],this.trigger("segmentTimingInfo",Cd(o.baseMediaDecodeTime,G.dts,G.pts,q.dts+q.duration,q.pts+q.duration,X)),this.trigger("timingInfo",{start:O[0].pts,end:O[O.length-1].pts+O[O.length-1].duration}),this.gopCache_.unshift({gop:O.pop(),pps:o.pps,sps:o.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.trigger("baseMediaDecodeTime",o.baseMediaDecodeTime),this.trigger("timelineStartInfo",o.timelineStartInfo),H=ic.moof(m,[o]),z=new Uint8Array(H.byteLength+K.byteLength),m++,z.set(H),z.set(K,H.byteLength),this.trigger("data",{track:o,boxes:z}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),E=[],this.gopCache_.length=0,A.length=0,this.trigger("reset")},this.resetStream_=function(){mc.clearDtsInfo(o),_=void 0,S=void 0},this.getGopForFusion_=function(s){var m,_,S,E,A,O=1/0;for(A=0;A<this.gopCache_.length;A++)S=(E=this.gopCache_[A]).gop,o.pps&&_d(o.pps[0],E.pps[0])&&o.sps&&_d(o.sps[0],E.sps[0])&&(S.dts<o.timelineStartInfo.dts||(m=s.dts-S.dts-S.duration)>=-1e4&&m<=45e3&&(!_||O>m)&&(_=E,O=m));return _?_.gop:null},this.alignGopsAtStart_=function(o){var s,m,_,S,E,O,H,K;for(E=o.byteLength,O=o.nalCount,H=o.duration,s=m=0;s<A.length&&m<o.length&&(_=A[s],S=o[m],_.pts!==S.pts);)S.pts>_.pts?s++:(m++,E-=S.byteLength,O-=S.nalCount,H-=S.duration);return 0===m?o:m===o.length?null:((K=o.slice(m)).byteLength=E,K.duration=H,K.nalCount=O,K.pts=K[0].pts,K.dts=K[0].dts,K)},this.alignGopsAtEnd_=function(o){var s,m,_,S,E,O,H;for(s=A.length-1,m=o.length-1,E=null,O=!1;s>=0&&m>=0;){if(_=A[s],S=o[m],_.pts===S.pts){O=!0;break}_.pts>S.pts?s--:(s===A.length-1&&(E=m),m--)}if(!O&&null===E)return null;if(0===(H=O?m:E))return o;var K=o.slice(H),z=K.reduce((function(o,s){return o.byteLength+=s.byteLength,o.duration+=s.duration,o.nalCount+=s.nalCount,o}),{byteLength:0,duration:0,nalCount:0});return K.byteLength=z.byteLength,K.duration=z.duration,K.nalCount=z.nalCount,K.pts=K[0].pts,K.dts=K[0].dts,K},this.alignGopsWith=function(o){A=o}},vl.prototype=new nc,Ql=function CoalesceStream(o,s){this.numberOfTracks=0,this.metadataStream=s,void 0!==(o=o||{}).remux?this.remuxTracks=!!o.remux:this.remuxTracks=!0,"boolean"==typeof o.keepOriginalTimestamps?this.keepOriginalTimestamps=o.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Ql.prototype.init.call(this),this.push=function(o){return o.content||o.text?this.pendingCaptions.push(o):o.frames?this.pendingMetadata.push(o):(this.pendingTracks.push(o.track),this.pendingBytes+=o.boxes.byteLength,"video"===o.track.type&&(this.videoTrack=o.track,this.pendingBoxes.push(o.boxes)),void("audio"===o.track.type&&(this.audioTrack=o.track,this.pendingBoxes.unshift(o.boxes))))}},Ql.prototype=new nc,Ql.prototype.flush=function(o){var s,m,_,S,E=0,A={captions:[],captionStreams:{},metadata:[],info:{}},O=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==o&&"AudioSegmentStream"!==o)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(O=this.videoTrack.timelineStartInfo.pts,zc.forEach((function(o){A.info[o]=this.videoTrack[o]}),this)):this.audioTrack&&(O=this.audioTrack.timelineStartInfo.pts,jc.forEach((function(o){A.info[o]=this.audioTrack[o]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?A.type=this.pendingTracks[0].type:A.type="combined",this.emittedTracks+=this.pendingTracks.length,_=ic.initSegment(this.pendingTracks),A.initSegment=new Uint8Array(_.byteLength),A.initSegment.set(_),A.data=new Uint8Array(this.pendingBytes),S=0;S<this.pendingBoxes.length;S++)A.data.set(this.pendingBoxes[S],E),E+=this.pendingBoxes[S].byteLength;for(S=0;S<this.pendingCaptions.length;S++)(s=this.pendingCaptions[S]).startTime=_c.metadataTsToSeconds(s.startPts,O,this.keepOriginalTimestamps),s.endTime=_c.metadataTsToSeconds(s.endPts,O,this.keepOriginalTimestamps),A.captionStreams[s.stream]=!0,A.captions.push(s);for(S=0;S<this.pendingMetadata.length;S++)(m=this.pendingMetadata[S]).cueTime=_c.metadataTsToSeconds(m.pts,O,this.keepOriginalTimestamps),A.metadata.push(m);for(A.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",A),S=0;S<A.captions.length;S++)s=A.captions[S],this.trigger("caption",s);for(S=0;S<A.metadata.length;S++)m=A.metadata[S],this.trigger("id3Frame",m)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Ql.prototype.setRemux=function(o){this.remuxTracks=o},Pl=function Transmuxer(o){var s,m,_=this,S=!0;Pl.prototype.init.call(this),o=o||{},this.baseMediaDecodeTime=o.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var S={};this.transmuxPipeline_=S,S.type="aac",S.metadataStream=new yc.MetadataStream,S.aacStream=new Ac,S.audioTimestampRolloverStream=new yc.TimestampRolloverStream("audio"),S.timedMetadataTimestampRolloverStream=new yc.TimestampRolloverStream("timed-metadata"),S.adtsStream=new kc,S.coalesceStream=new Ql(o,S.metadataStream),S.headOfPipeline=S.aacStream,S.aacStream.pipe(S.audioTimestampRolloverStream).pipe(S.adtsStream),S.aacStream.pipe(S.timedMetadataTimestampRolloverStream).pipe(S.metadataStream).pipe(S.coalesceStream),S.metadataStream.on("timestamp",(function(o){S.aacStream.setTimestamp(o.timeStamp)})),S.aacStream.on("data",(function(E){"timed-metadata"!==E.type&&"audio"!==E.type||S.audioSegmentStream||(m=m||{timelineStartInfo:{baseMediaDecodeTime:_.baseMediaDecodeTime},codec:"adts",type:"audio"},S.coalesceStream.numberOfTracks++,S.audioSegmentStream=new _l(m,o),S.audioSegmentStream.on("log",_.getLogTrigger_("audioSegmentStream")),S.audioSegmentStream.on("timingInfo",_.trigger.bind(_,"audioTimingInfo")),S.adtsStream.pipe(S.audioSegmentStream).pipe(S.coalesceStream),_.trigger("trackinfo",{hasAudio:!!m,hasVideo:!!s}))})),S.coalesceStream.on("data",this.trigger.bind(this,"data")),S.coalesceStream.on("done",this.trigger.bind(this,"done")),Xc(this,S)},this.setupTsPipeline=function(){var S={};this.transmuxPipeline_=S,S.type="ts",S.metadataStream=new yc.MetadataStream,S.packetStream=new yc.TransportPacketStream,S.parseStream=new yc.TransportParseStream,S.elementaryStream=new yc.ElementaryStream,S.timestampRolloverStream=new yc.TimestampRolloverStream,S.adtsStream=new kc,S.h264Stream=new Ec,S.captionStream=new yc.CaptionStream(o),S.coalesceStream=new Ql(o,S.metadataStream),S.headOfPipeline=S.packetStream,S.packetStream.pipe(S.parseStream).pipe(S.elementaryStream).pipe(S.timestampRolloverStream),S.timestampRolloverStream.pipe(S.h264Stream),S.timestampRolloverStream.pipe(S.adtsStream),S.timestampRolloverStream.pipe(S.metadataStream).pipe(S.coalesceStream),S.h264Stream.pipe(S.captionStream).pipe(S.coalesceStream),S.elementaryStream.on("data",(function(E){var A;if("metadata"===E.type){for(A=E.tracks.length;A--;)s||"video"!==E.tracks[A].type?m||"audio"!==E.tracks[A].type||((m=E.tracks[A]).timelineStartInfo.baseMediaDecodeTime=_.baseMediaDecodeTime):(s=E.tracks[A]).timelineStartInfo.baseMediaDecodeTime=_.baseMediaDecodeTime;s&&!S.videoSegmentStream&&(S.coalesceStream.numberOfTracks++,S.videoSegmentStream=new vl(s,o),S.videoSegmentStream.on("log",_.getLogTrigger_("videoSegmentStream")),S.videoSegmentStream.on("timelineStartInfo",(function(s){m&&!o.keepOriginalTimestamps&&(m.timelineStartInfo=s,S.audioSegmentStream.setEarliestDts(s.dts-_.baseMediaDecodeTime))})),S.videoSegmentStream.on("processedGopsInfo",_.trigger.bind(_,"gopInfo")),S.videoSegmentStream.on("segmentTimingInfo",_.trigger.bind(_,"videoSegmentTimingInfo")),S.videoSegmentStream.on("baseMediaDecodeTime",(function(o){m&&S.audioSegmentStream.setVideoBaseMediaDecodeTime(o)})),S.videoSegmentStream.on("timingInfo",_.trigger.bind(_,"videoTimingInfo")),S.h264Stream.pipe(S.videoSegmentStream).pipe(S.coalesceStream)),m&&!S.audioSegmentStream&&(S.coalesceStream.numberOfTracks++,S.audioSegmentStream=new _l(m,o),S.audioSegmentStream.on("log",_.getLogTrigger_("audioSegmentStream")),S.audioSegmentStream.on("timingInfo",_.trigger.bind(_,"audioTimingInfo")),S.audioSegmentStream.on("segmentTimingInfo",_.trigger.bind(_,"audioSegmentTimingInfo")),S.adtsStream.pipe(S.audioSegmentStream).pipe(S.coalesceStream)),_.trigger("trackinfo",{hasAudio:!!m,hasVideo:!!s})}})),S.coalesceStream.on("data",this.trigger.bind(this,"data")),S.coalesceStream.on("id3Frame",(function(o){o.dispatchType=S.metadataStream.dispatchType,_.trigger("id3Frame",o)})),S.coalesceStream.on("caption",this.trigger.bind(this,"caption")),S.coalesceStream.on("done",this.trigger.bind(this,"done")),Xc(this,S)},this.setBaseMediaDecodeTime=function(_){var S=this.transmuxPipeline_;o.keepOriginalTimestamps||(this.baseMediaDecodeTime=_),m&&(m.timelineStartInfo.dts=void 0,m.timelineStartInfo.pts=void 0,mc.clearDtsInfo(m),S.audioTimestampRolloverStream&&S.audioTimestampRolloverStream.discontinuity()),s&&(S.videoSegmentStream&&(S.videoSegmentStream.gopCache_=[]),s.timelineStartInfo.dts=void 0,s.timelineStartInfo.pts=void 0,mc.clearDtsInfo(s),S.captionStream.reset()),S.timestampRolloverStream&&S.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(o){m&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(o)},this.setRemux=function(s){var m=this.transmuxPipeline_;o.remux=s,m&&m.coalesceStream&&m.coalesceStream.setRemux(s)},this.alignGopsWith=function(o){s&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(o)},this.getLogTrigger_=function(o){var s=this;return function(m){m.stream=o,s.trigger("log",m)}},this.push=function(o){if(S){var s=Dc(o);s&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():s||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),S=!1}this.transmuxPipeline_.headOfPipeline.push(o)},this.flush=function(){S=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Pl.prototype=new nc;var Ad,Rd,Ud,Vd,zd,qd={Transmuxer:Pl,VideoSegmentStream:vl,AudioSegmentStream:_l,AUDIO_PROPERTIES:jc,VIDEO_PROPERTIES:zc,generateSegmentTimingInfo:Cd},eh=function toUnsigned$3(o){return o>>>0},uh=function parseType$3(o){var s="";return s+=String.fromCharCode(o[0]),s+=String.fromCharCode(o[1]),s+=String.fromCharCode(o[2]),s+=String.fromCharCode(o[3])},hh=eh,mh=uh,vh=function findBox$2(o,s){var m,_,S,E,A,O=[];if(!s.length)return null;for(m=0;m<o.byteLength;)_=hh(o[m]<<24|o[m+1]<<16|o[m+2]<<8|o[m+3]),S=mh(o.subarray(m+4,m+8)),E=_>1?m+_:o.byteLength,S===s[0]&&(1===s.length?O.push(o.subarray(m+8,E)):(A=findBox$2(o.subarray(m+8,E),s.slice(1))).length&&(O=O.concat(A))),m=E;return O},_h=eh,bh=zt.getUint64,kh=function tfdt(o){var s={version:o[0],flags:new Uint8Array(o.subarray(1,4))};return 1===s.version?s.baseMediaDecodeTime=bh(o.subarray(4)):s.baseMediaDecodeTime=_h(o[4]<<24|o[5]<<16|o[6]<<8|o[7]),s},qh=function parseSampleFlags$1(o){return{isLeading:(12&o[0])>>>2,dependsOn:3&o[0],isDependedOn:(192&o[1])>>>6,hasRedundancy:(48&o[1])>>>4,paddingValue:(14&o[1])>>>1,isNonSyncSample:1&o[1],degradationPriority:o[2]<<8|o[3]}},np=function trun(o){var s,m={version:o[0],flags:new Uint8Array(o.subarray(1,4)),samples:[]},_=new DataView(o.buffer,o.byteOffset,o.byteLength),S=1&m.flags[2],E=4&m.flags[2],A=1&m.flags[1],O=2&m.flags[1],H=4&m.flags[1],K=8&m.flags[1],z=_.getUint32(4),G=8;for(S&&(m.dataOffset=_.getInt32(G),G+=4),E&&z&&(s={flags:qh(o.subarray(G,G+4))},G+=4,A&&(s.duration=_.getUint32(G),G+=4),O&&(s.size=_.getUint32(G),G+=4),K&&(1===m.version?s.compositionTimeOffset=_.getInt32(G):s.compositionTimeOffset=_.getUint32(G),G+=4),m.samples.push(s),z--);z--;)s={},A&&(s.duration=_.getUint32(G),G+=4),O&&(s.size=_.getUint32(G),G+=4),H&&(s.flags=qh(o.subarray(G,G+4)),G+=4),K&&(1===m.version?s.compositionTimeOffset=_.getInt32(G):s.compositionTimeOffset=_.getUint32(G),G+=4),m.samples.push(s);return m},ap=function tfhd(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:o[0],flags:new Uint8Array(o.subarray(1,4)),trackId:m.getUint32(4)},S=1&_.flags[2],E=2&_.flags[2],A=8&_.flags[2],O=16&_.flags[2],H=32&_.flags[2],K=65536&_.flags[0],z=131072&_.flags[0];return s=8,S&&(s+=4,_.baseDataOffset=m.getUint32(12),s+=4),E&&(_.sampleDescriptionIndex=m.getUint32(s),s+=4),A&&(_.defaultSampleDuration=m.getUint32(s),s+=4),O&&(_.defaultSampleSize=m.getUint32(s),s+=4),H&&(_.defaultSampleFlags=m.getUint32(s)),K&&(_.durationIsEmpty=!0),!S&&z&&(_.baseDataOffsetIsMoof=!0),_},mp=(Ad="undefined"!=typeof window?window:void 0!==o?o:"undefined"!=typeof self?self:{},Pr.discardEmulationPreventionBytes),yp=la.CaptionStream,vp=vh,_p=kh,bp=np,wp=ap,Ip=Ad,zp=function mapToSample(o,s){for(var m=o,_=0;_<s.length;_++){var S=s[_];if(m<S.size)return S;m-=S.size}return null},Wp=function parseCaptionNals(o,s){var m=vp(o,["moof","traf"]),_=vp(o,["mdat"]),S={},E=[];return _.forEach((function(o,s){var _=m[s];E.push({mdat:o,traf:_})})),E.forEach((function(o){var m,_,E=o.mdat,A=o.traf,O=vp(A,["tfhd"]),H=wp(O[0]),K=H.trackId,z=vp(A,["tfdt"]),G=z.length>0?_p(z[0]).baseMediaDecodeTime:0,q=vp(A,["trun"]);s===K&&q.length>0&&(m=function parseSamples(o,s,m){var _=s,S=m.defaultSampleDuration||0,E=m.defaultSampleSize||0,A=m.trackId,O=[];return o.forEach((function(o){var s=bp(o).samples;s.forEach((function(o){void 0===o.duration&&(o.duration=S),void 0===o.size&&(o.size=E),o.trackId=A,o.dts=_,void 0===o.compositionTimeOffset&&(o.compositionTimeOffset=0),"bigint"==typeof _?(o.pts=_+Ip.BigInt(o.compositionTimeOffset),_+=Ip.BigInt(o.duration)):(o.pts=_+o.compositionTimeOffset,_+=o.duration)})),O=O.concat(s)})),O}(q,G,H),_=function findSeiNals(o,s,m){var _,S,E,A,O=new DataView(o.buffer,o.byteOffset,o.byteLength),H={logs:[],seiNals:[]};for(S=0;S+4<o.length;S+=E)if(E=O.getUint32(S),S+=4,!(E<=0))switch(31&o[S]){case 6:var K=o.subarray(S+1,S+1+E),z=zp(S,s);if(_={nalUnitType:"sei_rbsp",size:E,data:K,escapedRBSP:mp(K),trackId:m},z)_.pts=z.pts,_.dts=z.dts,A=z;else{if(!A){H.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+S+" for trackId "+m+". See mux.js#223."});break}_.pts=A.pts,_.dts=A.dts}H.seiNals.push(_)}return H}(E,m,K),S[K]||(S[K]={seiNals:[],logs:[]}),S[K].seiNals=S[K].seiNals.concat(_.seiNals),S[K].logs=S[K].logs.concat(_.logs))})),S},Jp=function CaptionParser(){var o,s,m,_,S,E,A=!1;this.isInitialized=function(){return A},this.init=function(s){o=new yp,A=!0,E=!!s&&s.isPartial,o.on("data",(function(o){o.startTime=o.startPts/_,o.endTime=o.endPts/_,S.captions.push(o),S.captionStreams[o.stream]=!0})),o.on("log",(function(o){S.logs.push(o)}))},this.isNewInit=function(o,s){return!(o&&0===o.length||s&&"object"==typeof s&&0===Object.keys(s).length)&&(m!==o[0]||_!==s[m])},this.parse=function(o,E,A){var O;if(!this.isInitialized())return null;if(!E||!A)return null;if(this.isNewInit(E,A))m=E[0],_=A[m];else if(null===m||!_)return s.push(o),null;for(;s.length>0;){var H=s.shift();this.parse(H,E,A)}return O=function parseEmbeddedCaptions(o,s,m){if(null===s)return null;var _=Wp(o,s)[s]||{};return{seiNals:_.seiNals,logs:_.logs,timescale:m}}(o,m,_),O&&O.logs&&(S.logs=S.logs.concat(O.logs)),null!==O&&O.seiNals?(this.pushNals(O.seiNals),this.flushStream(),S):S.logs.length?{logs:S.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(s){if(!this.isInitialized()||!s||0===s.length)return null;s.forEach((function(s){o.push(s)}))},this.flushStream=function(){if(!this.isInitialized())return null;E?o.partialFlush():o.flush()},this.clearParsedCaptions=function(){S.captions=[],S.captionStreams={},S.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;o.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){s=[],m=null,_=null,S?this.clearParsedCaptions():S={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},af=function uint8ToCString$1(o){for(var s=0,m=String.fromCharCode(o[s]),_="";"\0"!==m;)_+=m,s++,m=String.fromCharCode(o[s]);return _+=m},hf=af,pf=zt.getUint64,_f=function isValidEmsgBox(o,s){var m="\0"!==s.scheme_id_uri,_=0===o&&Ef(s.presentation_time_delta)&&m,S=1===o&&Ef(s.presentation_time)&&m;return!(o>1)&&_||S},Ef=function isDefined(o){return void 0!==o||null!==o},If={parseEmsgBox:function parseEmsgBox(o){var s,m,_,S,E,A,O,H=4,K=o[0];if(0===K)H+=(s=hf(o.subarray(H))).length,H+=(m=hf(o.subarray(H))).length,_=(z=new DataView(o.buffer)).getUint32(H),H+=4,E=z.getUint32(H),H+=4,A=z.getUint32(H),H+=4,O=z.getUint32(H),H+=4;else if(1===K){var z;_=(z=new DataView(o.buffer)).getUint32(H),H+=4,S=pf(o.subarray(H)),H+=8,A=z.getUint32(H),H+=4,O=z.getUint32(H),H+=4,H+=(s=hf(o.subarray(H))).length,H+=(m=hf(o.subarray(H))).length}var G={scheme_id_uri:s,value:m,timescale:_||1,presentation_time:S,presentation_time_delta:E,event_duration:A,id:O,message_data:new Uint8Array(o.subarray(H,o.byteLength))};return _f(K,G)?G:void 0},scaleTime:function scaleTime(o,s,m,_){return o||0===o?o/s:_+m/s}},zf=eh,Jf=function toHexString$1(o){return("00"+o.toString(16)).slice(-2)},sg=vh,_g=uh,$g=If,lm=ap,_m=np,Sm=kh,zm=zt.getUint64,Xm=Ad,Ym=qa.parseId3Frames;Rd=function startTime(o,s){var m=sg(s,["moof","traf"]).reduce((function(s,m){var _,S,E=sg(m,["tfhd"])[0],A=zf(E[4]<<24|E[5]<<16|E[6]<<8|E[7]),O=o[A]||9e4,H=sg(m,["tfdt"])[0],K=new DataView(H.buffer,H.byteOffset,H.byteLength);return"bigint"==typeof(_=1===H[0]?zm(H.subarray(4,12)):K.getUint32(4))?S=_/Xm.BigInt(O):"number"!=typeof _||isNaN(_)||(S=_/O),S<Number.MAX_SAFE_INTEGER&&(S=Number(S)),S<s&&(s=S),s}),1/0);return"bigint"==typeof m||isFinite(m)?m:0},Vd=function getTimescaleFromMediaHeader(o){var s=0===o[0]?12:20;return zf(o[s]<<24|o[s+1]<<16|o[s+2]<<8|o[s+3])},Ud=function getTracks(o){var s=sg(o,["moov","trak"]),m=[];return s.forEach((function(o){var s,_,S={},E=sg(o,["tkhd"])[0];E&&(_=(s=new DataView(E.buffer,E.byteOffset,E.byteLength)).getUint8(0),S.id=0===_?s.getUint32(12):s.getUint32(20));var A=sg(o,["mdia","hdlr"])[0];if(A){var O=_g(A.subarray(8,12));S.type="vide"===O?"video":"soun"===O?"audio":O}var H=sg(o,["mdia","minf","stbl","stsd"])[0];if(H){var K=H.subarray(8);S.codec=_g(K.subarray(4,8));var z,G=sg(K,[S.codec])[0];G&&(/^[asm]vc[1-9]$/i.test(S.codec)?(z=G.subarray(78),"avcC"===_g(z.subarray(4,8))&&z.length>11?(S.codec+=".",S.codec+=Jf(z[9]),S.codec+=Jf(z[10]),S.codec+=Jf(z[11])):S.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(S.codec)?(z=G.subarray(28),"esds"===_g(z.subarray(4,8))&&z.length>20&&0!==z[19]?(S.codec+="."+Jf(z[19]),S.codec+="."+Jf(z[20]>>>2&63).replace(/^0/,"")):S.codec="mp4a.40.2"):S.codec=S.codec.toLowerCase())}var q=sg(o,["mdia","mdhd"])[0];q&&(S.timescale=Vd(q)),m.push(S)})),m},zd=function getEmsgID3(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return sg(o,["emsg"]).map((function(o){var m=$g.parseEmsgBox(new Uint8Array(o)),_=Ym(m.message_data);return{cueTime:$g.scaleTime(m.presentation_time,m.timescale,m.presentation_time_delta,s),duration:$g.scaleTime(m.event_duration,m.timescale),frames:_}}))};var Zm=Rd,ay=Ud,uy=zd,hy=ca,vy=function parsePid(o){var s=31&o[1];return s<<=8,s|=o[2]},_y=function parsePayloadUnitStartIndicator(o){return!!(64&o[1])},wy=function parseAdaptionField(o){var s=0;return(48&o[3])>>>4>1&&(s+=o[4]+1),s},Ay=function parseNalUnitType(o){switch(o){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},Py={parseType:function parseType(o,s){var m=vy(o);return 0===m?"pat":m===s?"pmt":s?"pes":null},parsePat:function parsePat(o){var s=_y(o),m=4+wy(o);return s&&(m+=o[m]+1),(31&o[m+10])<<8|o[m+11]},parsePmt:function parsePmt(o){var s={},m=_y(o),_=4+wy(o);if(m&&(_+=o[_]+1),1&o[_+5]){var S;S=3+((15&o[_+1])<<8|o[_+2])-4;for(var E=12+((15&o[_+10])<<8|o[_+11]);E<S;){var A=_+E;s[(31&o[A+1])<<8|o[A+2]]=o[A],E+=5+((15&o[A+3])<<8|o[A+4])}return s}},parsePayloadUnitStartIndicator:_y,parsePesType:function parsePesType(o,s){switch(s[vy(o)]){case hy.H264_STREAM_TYPE:return"video";case hy.ADTS_STREAM_TYPE:return"audio";case hy.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function parsePesTime(o){if(!_y(o))return null;var s=4+wy(o);if(s>=o.byteLength)return null;var m,_=null;return 192&(m=o[s+7])&&((_={}).pts=(14&o[s+9])<<27|(255&o[s+10])<<20|(254&o[s+11])<<12|(255&o[s+12])<<5|(254&o[s+13])>>>3,_.pts*=4,_.pts+=(6&o[s+13])>>>1,_.dts=_.pts,64&m&&(_.dts=(14&o[s+14])<<27|(255&o[s+15])<<20|(254&o[s+16])<<12|(255&o[s+17])<<5|(254&o[s+18])>>>3,_.dts*=4,_.dts+=(6&o[s+18])>>>1)),_},videoPacketContainsKeyFrame:function videoPacketContainsKeyFrame(o){for(var s=4+wy(o),m=o.subarray(s),_=0,S=0,E=!1;S<m.byteLength-3;S++)if(1===m[S+2]){_=S+5;break}for(;_<m.byteLength;)switch(m[_]){case 0:if(0!==m[_-1]){_+=2;break}if(0!==m[_-2]){_++;break}S+3!==_-2&&"slice_layer_without_partitioning_rbsp_idr"===Ay(31&m[S+3])&&(E=!0);do{_++}while(1!==m[_]&&_<m.length);S=_-2,_+=3;break;case 1:if(0!==m[_-1]||0!==m[_-2]){_+=3;break}"slice_layer_without_partitioning_rbsp_idr"===Ay(31&m[S+3])&&(E=!0),S=_-2,_+=3;break;default:_+=3}return m=m.subarray(S),_-=S,S=0,m&&m.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===Ay(31&m[S+3])&&(E=!0),E}},Ly=ca,Ry=_a,Oy={};Oy.ts=Py,Oy.aac=pu;var Xy=Gn.ONE_SECOND_IN_TS,Qy=188,tv=71,_v=function parseAudioPes_(o,s,m){for(var _,S,E,A,O=0,H=Qy,K=!1;H<=o.byteLength;)if(o[O]!==tv||o[H]!==tv&&H!==o.byteLength)O++,H++;else{if(_=o.subarray(O,H),"pes"===Oy.ts.parseType(_,s.pid))S=Oy.ts.parsePesType(_,s.table),E=Oy.ts.parsePayloadUnitStartIndicator(_),"audio"===S&&E&&(A=Oy.ts.parsePesTime(_))&&(A.type="audio",m.audio.push(A),K=!0);if(K)break;O+=Qy,H+=Qy}for(O=(H=o.byteLength)-Qy,K=!1;O>=0;)if(o[O]!==tv||o[H]!==tv&&H!==o.byteLength)O--,H--;else{if(_=o.subarray(O,H),"pes"===Oy.ts.parseType(_,s.pid))S=Oy.ts.parsePesType(_,s.table),E=Oy.ts.parsePayloadUnitStartIndicator(_),"audio"===S&&E&&(A=Oy.ts.parsePesTime(_))&&(A.type="audio",m.audio.push(A),K=!0);if(K)break;O-=Qy,H-=Qy}},$v=function parseVideoPes_(o,s,m){for(var _,S,E,A,O,H,K,z=0,G=Qy,q=!1,X={data:[],size:0};G<o.byteLength;)if(o[z]!==tv||o[G]!==tv)z++,G++;else{if(_=o.subarray(z,G),"pes"===Oy.ts.parseType(_,s.pid))if(S=Oy.ts.parsePesType(_,s.table),E=Oy.ts.parsePayloadUnitStartIndicator(_),"video"===S&&(E&&!q&&(A=Oy.ts.parsePesTime(_))&&(A.type="video",m.video.push(A),q=!0),!m.firstKeyFrame)){if(E&&0!==X.size){for(O=new Uint8Array(X.size),H=0;X.data.length;)K=X.data.shift(),O.set(K,H),H+=K.byteLength;if(Oy.ts.videoPacketContainsKeyFrame(O)){var J=Oy.ts.parsePesTime(O);J?(m.firstKeyFrame=J,m.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}X.size=0}X.data.push(_),X.size+=_.byteLength}if(q&&m.firstKeyFrame)break;z+=Qy,G+=Qy}for(z=(G=o.byteLength)-Qy,q=!1;z>=0;)if(o[z]!==tv||o[G]!==tv)z--,G--;else{if(_=o.subarray(z,G),"pes"===Oy.ts.parseType(_,s.pid))S=Oy.ts.parsePesType(_,s.table),E=Oy.ts.parsePayloadUnitStartIndicator(_),"video"===S&&E&&(A=Oy.ts.parsePesTime(_))&&(A.type="video",m.video.push(A),q=!0);if(q)break;z-=Qy,G-=Qy}},Yv=function inspectTs_(o){var s={pid:null,table:null},m={};for(var _ in function parsePsi_(o,s){for(var m,_=0,S=Qy;S<o.byteLength;)if(o[_]!==tv||o[S]!==tv)_++,S++;else{switch(m=o.subarray(_,S),Oy.ts.parseType(m,s.pid)){case"pat":s.pid=Oy.ts.parsePat(m);break;case"pmt":var E=Oy.ts.parsePmt(m);s.table=s.table||{},Object.keys(E).forEach((function(o){s.table[o]=E[o]}))}_+=Qy,S+=Qy}}(o,s),s.table){if(s.table.hasOwnProperty(_))switch(s.table[_]){case Ly.H264_STREAM_TYPE:m.video=[],$v(o,s,m),0===m.video.length&&delete m.video;break;case Ly.ADTS_STREAM_TYPE:m.audio=[],_v(o,s,m),0===m.audio.length&&delete m.audio}}return m},Jv=function inspect(o,s){var m;return m=Oy.aac.isLikelyAacData(o)?function inspectAac_(o){for(var s,m=!1,_=0,S=null,E=null,A=0,O=0;o.length-O>=3;){switch(Oy.aac.parseType(o,O)){case"timed-metadata":if(o.length-O<10){m=!0;break}if((A=Oy.aac.parseId3TagSize(o,O))>o.length){m=!0;break}null===E&&(s=o.subarray(O,O+A),E=Oy.aac.parseAacTimestamp(s)),O+=A;break;case"audio":if(o.length-O<7){m=!0;break}if((A=Oy.aac.parseAdtsSize(o,O))>o.length){m=!0;break}null===S&&(s=o.subarray(O,O+A),S=Oy.aac.parseSampleRate(s)),_++,O+=A;break;default:O++}if(m)return null}if(null===S||null===E)return null;var H=Xy/S;return{audio:[{type:"audio",dts:E,pts:E},{type:"audio",dts:E+1024*_*H,pts:E+1024*_*H}]}}(o):Yv(o),m&&(m.audio||m.video)?(function adjustTimestamp_(o,s){if(o.audio&&o.audio.length){var m=s;(void 0===m||isNaN(m))&&(m=o.audio[0].dts),o.audio.forEach((function(o){o.dts=Ry(o.dts,m),o.pts=Ry(o.pts,m),o.dtsTime=o.dts/Xy,o.ptsTime=o.pts/Xy}))}if(o.video&&o.video.length){var _=s;if((void 0===_||isNaN(_))&&(_=o.video[0].dts),o.video.forEach((function(o){o.dts=Ry(o.dts,_),o.pts=Ry(o.pts,_),o.dtsTime=o.dts/Xy,o.ptsTime=o.pts/Xy})),o.firstKeyFrame){var S=o.firstKeyFrame;S.dts=Ry(S.dts,_),S.pts=Ry(S.pts,_),S.dtsTime=S.dts/Xy,S.ptsTime=S.pts/Xy}}}(m,s),m):null},e_=function(){function MessageHandlers(o,s){_classCallCheck$1(this,MessageHandlers),this.options=s||{},this.self=o,this.init()}return _createClass$1(MessageHandlers,[{key:"init",value:function init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new qd.Transmuxer(this.options),function wireTransmuxerEvents(o,s){s.on("data",(function(s){var m=s.initSegment;s.initSegment={data:m.buffer,byteOffset:m.byteOffset,byteLength:m.byteLength};var _=s.data;s.data=_.buffer,o.postMessage({action:"data",segment:s,byteOffset:_.byteOffset,byteLength:_.byteLength},[s.data])})),s.on("done",(function(s){o.postMessage({action:"done"})})),s.on("gopInfo",(function(s){o.postMessage({action:"gopInfo",gopInfo:s})})),s.on("videoSegmentTimingInfo",(function(s){var m={start:{decode:Gn.videoTsToSeconds(s.start.dts),presentation:Gn.videoTsToSeconds(s.start.pts)},end:{decode:Gn.videoTsToSeconds(s.end.dts),presentation:Gn.videoTsToSeconds(s.end.pts)},baseMediaDecodeTime:Gn.videoTsToSeconds(s.baseMediaDecodeTime)};s.prependedContentDuration&&(m.prependedContentDuration=Gn.videoTsToSeconds(s.prependedContentDuration)),o.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:m})})),s.on("audioSegmentTimingInfo",(function(s){var m={start:{decode:Gn.videoTsToSeconds(s.start.dts),presentation:Gn.videoTsToSeconds(s.start.pts)},end:{decode:Gn.videoTsToSeconds(s.end.dts),presentation:Gn.videoTsToSeconds(s.end.pts)},baseMediaDecodeTime:Gn.videoTsToSeconds(s.baseMediaDecodeTime)};s.prependedContentDuration&&(m.prependedContentDuration=Gn.videoTsToSeconds(s.prependedContentDuration)),o.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:m})})),s.on("id3Frame",(function(s){o.postMessage({action:"id3Frame",id3Frame:s})})),s.on("caption",(function(s){o.postMessage({action:"caption",caption:s})})),s.on("trackinfo",(function(s){o.postMessage({action:"trackinfo",trackInfo:s})})),s.on("audioTimingInfo",(function(s){o.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:Gn.videoTsToSeconds(s.start),end:Gn.videoTsToSeconds(s.end)}})})),s.on("videoTimingInfo",(function(s){o.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:Gn.videoTsToSeconds(s.start),end:Gn.videoTsToSeconds(s.end)}})})),s.on("log",(function(s){o.postMessage({action:"log",log:s})}))}(this.self,this.transmuxer)}},{key:"pushMp4Captions",value:function pushMp4Captions(o){this.captionParser||(this.captionParser=new Jp,this.captionParser.init());var s=new Uint8Array(o.data,o.byteOffset,o.byteLength),m=this.captionParser.parse(s,o.trackIds,o.timescales);this.self.postMessage({action:"mp4Captions",captions:m&&m.captions||[],logs:m&&m.logs||[],data:s.buffer},[s.buffer])}},{key:"probeMp4StartTime",value:function probeMp4StartTime(o){var s=o.timescales,m=o.data,_=Zm(s,m);this.self.postMessage({action:"probeMp4StartTime",startTime:_,data:m},[m.buffer])}},{key:"probeMp4Tracks",value:function probeMp4Tracks(o){var s=o.data,m=ay(s);this.self.postMessage({action:"probeMp4Tracks",tracks:m,data:s},[s.buffer])}},{key:"probeEmsgID3",value:function probeEmsgID3(o){var s=o.data,m=o.offset,_=uy(s,m);this.self.postMessage({action:"probeEmsgID3",id3Frames:_,emsgData:s},[s.buffer])}},{key:"probeTs",value:function probeTs(o){var s=o.data,m=o.baseStartTime,_="number"!=typeof m||isNaN(m)?void 0:m*Gn.ONE_SECOND_IN_TS,S=Jv(s,_),E=null;S&&((E={hasVideo:S.video&&2===S.video.length||!1,hasAudio:S.audio&&2===S.audio.length||!1}).hasVideo&&(E.videoStart=S.video[0].ptsTime),E.hasAudio&&(E.audioStart=S.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:E,data:s},[s.buffer])}},{key:"clearAllMp4Captions",value:function clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}},{key:"clearParsedMp4Captions",value:function clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}},{key:"push",value:function push(o){var s=new Uint8Array(o.data,o.byteOffset,o.byteLength);this.transmuxer.push(s)}},{key:"reset",value:function reset(){this.transmuxer.reset()}},{key:"setTimestampOffset",value:function setTimestampOffset(o){var s=o.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(Gn.secondsToVideoTs(s)))}},{key:"setAudioAppendStart",value:function setAudioAppendStart(o){this.transmuxer.setAudioAppendStart(Math.ceil(Gn.secondsToVideoTs(o.appendStart)))}},{key:"setRemux",value:function setRemux(o){this.transmuxer.setRemux(o.remux)}},{key:"flush",value:function flush(o){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}},{key:"endTimeline",value:function endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}},{key:"alignGopsWith",value:function alignGopsWith(o){this.transmuxer.alignGopsWith(o.gopsToAlignWith.slice())}}]),MessageHandlers}();self.onmessage=function(o){"init"===o.data.action&&o.data.options?this.messageHandlers=new e_(self,o.data.options):(this.messageHandlers||(this.messageHandlers=new e_(self)),o.data&&o.data.action&&"init"!==o.data.action&&this.messageHandlers[o.data.action]&&this.messageHandlers[o.data.action](o.data))}}))),t0=QZ(e0),n0=function processTransmux(o){var s=o.transmuxer,m=o.bytes,_=o.audioAppendStart,S=o.gopsToAlignWith,E=o.remux,A=o.onData,O=o.onTrackInfo,H=o.onAudioTimingInfo,K=o.onVideoTimingInfo,z=o.onVideoSegmentTimingInfo,G=o.onAudioSegmentTimingInfo,q=o.onId3,X=o.onCaptions,J=o.onDone,ae=o.onEndedTimeline,pe=o.onTransmuxerLog,me=o.isEndOfTimeline,_e={buffer:[]},Se=me;if(s.onmessage=function handleMessage(m){s.currentTransmux===o&&("data"===m.data.action&&function handleData_(o,s,m){var _=o.data.segment,S=_.type,E=_.initSegment,A=_.captions,O=_.captionStreams,H=_.metadata,K=_.videoFrameDtsTime,z=_.videoFramePtsTime;s.buffer.push({captions:A,captionStreams:O,metadata:H});var G=o.data.segment.boxes||{data:o.data.segment.data},q={type:S,data:new Uint8Array(G.data,G.data.byteOffset,G.data.byteLength),initSegment:new Uint8Array(E.data,E.byteOffset,E.byteLength)};void 0!==K&&(q.videoFrameDtsTime=K),void 0!==z&&(q.videoFramePtsTime=z),m(q)}(m,_e,A),"trackinfo"===m.data.action&&O(m.data.trackInfo),"gopInfo"===m.data.action&&function handleGopInfo_(o,s){s.gopInfo=o.data.gopInfo}(m,_e),"audioTimingInfo"===m.data.action&&H(m.data.audioTimingInfo),"videoTimingInfo"===m.data.action&&K(m.data.videoTimingInfo),"videoSegmentTimingInfo"===m.data.action&&z(m.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===m.data.action&&G(m.data.audioSegmentTimingInfo),"id3Frame"===m.data.action&&q([m.data.id3Frame],m.data.id3Frame.dispatchType),"caption"===m.data.action&&X(m.data.caption),"endedtimeline"===m.data.action&&(Se=!1,ae()),"log"===m.data.action&&pe(m.data.log),"transmuxed"===m.data.type&&(Se||(s.onmessage=null,function handleDone_(o){var s=o.transmuxedData,m=o.callback;s.buffer=[],m(s)}({transmuxedData:_e,callback:J}),r0(s))))},_&&s.postMessage({action:"setAudioAppendStart",appendStart:_}),Array.isArray(S)&&s.postMessage({action:"alignGopsWith",gopsToAlignWith:S}),void 0!==E&&s.postMessage({action:"setRemux",remux:E}),m.byteLength){var Ee=m instanceof ArrayBuffer?m:m.buffer,De=m instanceof ArrayBuffer?0:m.byteOffset;s.postMessage({action:"push",data:Ee,byteOffset:De,byteLength:m.byteLength},[Ee])}me&&s.postMessage({action:"endTimeline"}),s.postMessage({action:"flush"})},r0=function dequeue(o){o.currentTransmux=null,o.transmuxQueue.length&&(o.currentTransmux=o.transmuxQueue.shift(),"function"==typeof o.currentTransmux?o.currentTransmux():n0(o.currentTransmux))},i0=function processAction(o,s){o.postMessage({action:s}),r0(o)},a0=function enqueueAction(o,s){if(!s.currentTransmux)return s.currentTransmux=o,void i0(s,o);s.transmuxQueue.push(i0.bind(null,s,o))},o0=function transmux(o){if(!o.transmuxer.currentTransmux)return o.transmuxer.currentTransmux=o,void n0(o);o.transmuxer.transmuxQueue.push(o)},s0=function reset(o){a0("reset",o)},u0=function createTransmuxer(o){var s=new t0;s.currentTransmux=null,s.transmuxQueue=[];var m=s.terminate;return s.terminate=function(){return s.currentTransmux=null,s.transmuxQueue.length=0,m.call(s)},s.postMessage({action:"init",options:o}),s},l0=function workerCallback(o){var s=o.transmuxer,m=o.endAction||o.action,_=o.callback,S=gH({},o,{endAction:null,transmuxer:null,callback:null});if(s.addEventListener("message",(function listenForEndEvent(S){S.data.action===m&&(s.removeEventListener("message",listenForEndEvent),S.data.data&&(S.data.data=new Uint8Array(S.data.data,o.byteOffset||0,o.byteLength||S.data.data.byteLength),o.data&&(o.data=S.data.data)),_(S.data))})),o.data){var E=o.data instanceof ArrayBuffer;S.byteOffset=E?0:o.data.byteOffset,S.byteLength=o.data.byteLength;var A=[E?o.data:o.data.buffer];s.postMessage(S,A)}else s.postMessage(S)},c0=2,d0=-101,h0=-102,p0=function abortAll(o){o.forEach((function(o){o.abort()}))},f0=function handleErrors(o,s){return s.timedout?{status:s.status,message:"HLS request timed-out at URL: "+s.uri,code:d0,xhr:s}:s.aborted?{status:s.status,message:"HLS request aborted at URL: "+s.uri,code:h0,xhr:s}:o?{status:s.status,message:"HLS request errored at URL: "+s.uri,code:c0,xhr:s}:"arraybuffer"===s.responseType&&0===s.response.byteLength?{status:s.status,message:"Empty HLS response at URL: "+s.uri,code:c0,xhr:s}:null},g0=function handleKeyResponse(o,s,m){return function(_,S){var E=S.response,A=f0(_,S);if(A)return m(A,o);if(16!==E.byteLength)return m({status:S.status,message:"Invalid HLS key at URL: "+S.uri,code:c0,xhr:S},o);for(var O=new DataView(E),H=new Uint32Array([O.getUint32(0),O.getUint32(4),O.getUint32(8),O.getUint32(12)]),K=0;K<s.length;K++)s[K].bytes=H;return m(null,o)}},m0=function parseInitSegment(o,s){var m=vG(o.map.bytes);if("mp4"!==m){var _=o.map.resolvedUri||o.map.uri;return s({internal:!0,message:"Found unsupported ".concat(m||"unknown"," container for initialization segment at URL: ").concat(_),code:c0})}l0({action:"probeMp4Tracks",data:o.map.bytes,transmuxer:o.transmuxer,callback:function callback(m){var _=m.tracks,S=m.data;return o.map.bytes=S,_.forEach((function(s){o.map.tracks=o.map.tracks||{},o.map.tracks[s.type]||(o.map.tracks[s.type]=s,"number"==typeof s.id&&s.timescale&&(o.map.timescales=o.map.timescales||{},o.map.timescales[s.id]=s.timescale))})),s(null)}})},y0=function handleSegmentResponse(o){var s=o.segment,m=o.finishProcessingFn,_=o.responseType;return function(o,S){var E=f0(o,S);if(E)return m(E,s);var A="arraybuffer"!==_&&S.responseText?function stringToArrayBuffer(o){for(var s=new Uint8Array(new ArrayBuffer(o.length)),m=0;m<o.length;m++)s[m]=o.charCodeAt(m);return s.buffer}(S.responseText.substring(s.lastReachedChar||0)):S.response;return s.stats=function getRequestStats(o){return{bandwidth:o.bandwidth,bytesReceived:o.bytesReceived||0,roundTripTime:o.roundTripTime||0}}(S),s.key?s.encryptedBytes=new Uint8Array(A):s.bytes=new Uint8Array(A),m(null,s)}},v0=function transmuxAndNotify(o){var s=o.segment,m=o.bytes,_=o.trackInfoFn,S=o.timingInfoFn,E=o.videoSegmentTimingInfoFn,A=o.audioSegmentTimingInfoFn,O=o.id3Fn,H=o.captionsFn,K=o.isEndOfTimeline,z=o.endedTimelineFn,G=o.dataFn,q=o.doneFn,X=o.onTransmuxerLog,J=s.map&&s.map.tracks||{},ae=Boolean(J.audio&&J.video),pe=S.bind(null,s,"audio","start"),me=S.bind(null,s,"audio","end"),_e=S.bind(null,s,"video","start"),Se=S.bind(null,s,"video","end");l0({action:"probeTs",transmuxer:s.transmuxer,data:m,baseStartTime:s.baseStartTime,callback:function callback(o){s.bytes=m=o.data;var S=o.result;S&&(_(s,{hasAudio:S.hasAudio,hasVideo:S.hasVideo,isMuxed:ae}),_=null),function finish(){o0({bytes:m,transmuxer:s.transmuxer,audioAppendStart:s.audioAppendStart,gopsToAlignWith:s.gopsToAlignWith,remux:ae,onData:function onData(o){o.type="combined"===o.type?"video":o.type,G(s,o)},onTrackInfo:function onTrackInfo(o){_&&(ae&&(o.isMuxed=!0),_(s,o))},onAudioTimingInfo:function onAudioTimingInfo(o){pe&&void 0!==o.start&&(pe(o.start),pe=null),me&&void 0!==o.end&&me(o.end)},onVideoTimingInfo:function onVideoTimingInfo(o){_e&&void 0!==o.start&&(_e(o.start),_e=null),Se&&void 0!==o.end&&Se(o.end)},onVideoSegmentTimingInfo:function onVideoSegmentTimingInfo(o){E(o)},onAudioSegmentTimingInfo:function onAudioSegmentTimingInfo(o){A(o)},onId3:function onId3(o,m){O(s,o,m)},onCaptions:function onCaptions(o){H(s,[o])},isEndOfTimeline:K,onEndedTimeline:function onEndedTimeline(){z()},onTransmuxerLog:X,onDone:function onDone(o){q&&(o.type="combined"===o.type?"video":o.type,q(null,s,o))}})}()}})},_0=function handleSegmentBytes(o){var s=o.segment,m=o.bytes,_=o.trackInfoFn,S=o.timingInfoFn,E=o.videoSegmentTimingInfoFn,A=o.audioSegmentTimingInfoFn,O=o.id3Fn,H=o.captionsFn,K=o.isEndOfTimeline,z=o.endedTimelineFn,G=o.dataFn,q=o.doneFn,X=o.onTransmuxerLog,J=new Uint8Array(m);if(_G(J)){s.isFmp4=!0;var ae=s.map.tracks,pe={isFmp4:!0,hasVideo:!!ae.video,hasAudio:!!ae.audio};ae.audio&&ae.audio.codec&&"enca"!==ae.audio.codec&&(pe.audioCodec=ae.audio.codec),ae.video&&ae.video.codec&&"encv"!==ae.video.codec&&(pe.videoCodec=ae.video.codec),ae.video&&ae.audio&&(pe.isMuxed=!0),_(s,pe);var me=function finishLoading(o,m){G(s,{data:J,type:pe.hasAudio&&!pe.isMuxed?"audio":"video"}),m&&m.length&&O(s,m),o&&o.length&&H(s,o),q(null,s,{})};l0({action:"probeMp4StartTime",timescales:s.map.timescales,data:J,transmuxer:s.transmuxer,callback:function callback(o){var _=o.data,E=o.startTime;m=_.buffer,s.bytes=J=_,pe.hasAudio&&!pe.isMuxed&&S(s,"audio","start",E),pe.hasVideo&&S(s,"video","start",E),l0({action:"probeEmsgID3",data:J,transmuxer:s.transmuxer,offset:E,callback:function callback(o){var _=o.emsgData,S=o.id3Frames;m=_.buffer,s.bytes=J=_,ae.video&&_.byteLength&&s.transmuxer?l0({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:s.transmuxer,data:J,timescales:s.map.timescales,trackIds:[ae.video.id],callback:function callback(o){m=o.data.buffer,s.bytes=J=o.data,o.logs.forEach((function(o){X(merge$2(o,{stream:"mp4CaptionParser"}))})),me(o.captions,S)}}):me(void 0,S)}})}})}else if(s.transmuxer){if(void 0===s.container&&(s.container=vG(J)),"ts"!==s.container&&"aac"!==s.container)return _(s,{hasAudio:!1,hasVideo:!1}),void q(null,s,{});v0({segment:s,bytes:m,trackInfoFn:_,timingInfoFn:S,videoSegmentTimingInfoFn:E,audioSegmentTimingInfoFn:A,id3Fn:O,captionsFn:H,isEndOfTimeline:K,endedTimelineFn:z,dataFn:G,doneFn:q,onTransmuxerLog:X})}else q(null,s,{})},b0=function decrypt(o,s){var m,_=o.id,S=o.key,E=o.encryptedBytes,A=o.decryptionWorker;A.addEventListener("message",(function decryptionHandler(o){if(o.data.source===_){A.removeEventListener("message",decryptionHandler);var m=o.data.decrypted;s(new Uint8Array(m.bytes,m.byteOffset,m.byteLength))}})),m=S.bytes.slice?S.bytes.slice():new Uint32Array(Array.prototype.slice.call(S.bytes)),A.postMessage(OZ({source:_,encrypted:E,key:m,iv:S.iv}),[E.buffer,m.buffer])},S0=function waitForCompletion(o){var s=o.activeXhrs,m=o.decryptionWorker,_=o.trackInfoFn,S=o.timingInfoFn,E=o.videoSegmentTimingInfoFn,A=o.audioSegmentTimingInfoFn,O=o.id3Fn,H=o.captionsFn,K=o.isEndOfTimeline,z=o.endedTimelineFn,G=o.dataFn,q=o.doneFn,X=o.onTransmuxerLog,J=0,ae=!1;return function(o,pe){if(!ae){if(o)return ae=!0,p0(s),q(o,pe);if((J+=1)===s.length){var me=function segmentFinish(){if(pe.encryptedBytes)return function decryptSegment(o){var s=o.decryptionWorker,m=o.segment,_=o.trackInfoFn,S=o.timingInfoFn,E=o.videoSegmentTimingInfoFn,A=o.audioSegmentTimingInfoFn,O=o.id3Fn,H=o.captionsFn,K=o.isEndOfTimeline,z=o.endedTimelineFn,G=o.dataFn,q=o.doneFn,X=o.onTransmuxerLog;b0({id:m.requestId,key:m.key,encryptedBytes:m.encryptedBytes,decryptionWorker:s},(function(o){m.bytes=o,_0({segment:m,bytes:m.bytes,trackInfoFn:_,timingInfoFn:S,videoSegmentTimingInfoFn:E,audioSegmentTimingInfoFn:A,id3Fn:O,captionsFn:H,isEndOfTimeline:K,endedTimelineFn:z,dataFn:G,doneFn:q,onTransmuxerLog:X})}))}({decryptionWorker:m,segment:pe,trackInfoFn:_,timingInfoFn:S,videoSegmentTimingInfoFn:E,audioSegmentTimingInfoFn:A,id3Fn:O,captionsFn:H,isEndOfTimeline:K,endedTimelineFn:z,dataFn:G,doneFn:q,onTransmuxerLog:X});_0({segment:pe,bytes:pe.bytes,trackInfoFn:_,timingInfoFn:S,videoSegmentTimingInfoFn:E,audioSegmentTimingInfoFn:A,id3Fn:O,captionsFn:H,isEndOfTimeline:K,endedTimelineFn:z,dataFn:G,doneFn:q,onTransmuxerLog:X})};if(pe.endOfAllRequests=Date.now(),pe.map&&pe.map.encryptedBytes&&!pe.map.bytes)return b0({decryptionWorker:m,id:pe.requestId+"-init",encryptedBytes:pe.map.encryptedBytes,key:pe.map.key},(function(o){pe.map.bytes=o,m0(pe,(function(o){if(o)return p0(s),q(o,pe);me()}))}));me()}}}},T0=function handleProgress(o){var s=o.segment,m=o.progressFn;return o.trackInfoFn,o.timingInfoFn,o.videoSegmentTimingInfoFn,o.audioSegmentTimingInfoFn,o.id3Fn,o.captionsFn,o.isEndOfTimeline,o.endedTimelineFn,o.dataFn,function(o){if(!o.target.aborted)return s.stats=merge$2(s.stats,function getProgressStats(o){var s=o.target,m={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-s.requestTime||0};return m.bytesReceived=o.loaded,m.bandwidth=Math.floor(m.bytesReceived/m.roundTripTime*8*1e3),m}(o)),!s.stats.firstBytesReceivedAt&&s.stats.bytesReceived&&(s.stats.firstBytesReceivedAt=Date.now()),m(o,s)}},k0=function mediaSegmentRequest(o){var s=o.xhr,m=o.xhrOptions,_=o.decryptionWorker,S=o.segment,E=o.abortFn,A=o.progressFn,O=o.trackInfoFn,H=o.timingInfoFn,K=o.videoSegmentTimingInfoFn,z=o.audioSegmentTimingInfoFn,G=o.id3Fn,q=o.captionsFn,X=o.isEndOfTimeline,J=o.endedTimelineFn,ae=o.dataFn,pe=o.doneFn,me=o.onTransmuxerLog,_e=[],Se=S0({activeXhrs:_e,decryptionWorker:_,trackInfoFn:O,timingInfoFn:H,videoSegmentTimingInfoFn:K,audioSegmentTimingInfoFn:z,id3Fn:G,captionsFn:q,isEndOfTimeline:X,endedTimelineFn:J,dataFn:ae,doneFn:pe,onTransmuxerLog:me});if(S.key&&!S.key.bytes){var Ee=[S.key];S.map&&!S.map.bytes&&S.map.key&&S.map.key.resolvedUri===S.key.resolvedUri&&Ee.push(S.map.key);var De=s(merge$2(m,{uri:S.key.resolvedUri,responseType:"arraybuffer"}),g0(S,Ee,Se));_e.push(De)}if(S.map&&!S.map.bytes){if(S.map.key&&(!S.key||S.key.resolvedUri!==S.map.key.resolvedUri)){var $e=s(merge$2(m,{uri:S.map.key.resolvedUri,responseType:"arraybuffer"}),g0(S,[S.map.key],Se));_e.push($e)}var He=merge$2(m,{uri:S.map.resolvedUri,responseType:"arraybuffer",headers:PZ(S.map)}),et=function handleInitSegmentResponse(o){var s=o.segment,m=o.finishProcessingFn;return function(o,_){var S=f0(o,_);if(S)return m(S,s);var E=new Uint8Array(_.response);if(s.map.key)return s.map.encryptedBytes=E,m(null,s);s.map.bytes=E,m0(s,(function(o){if(o)return o.xhr=_,o.status=_.status,m(o,s);m(null,s)}))}}({segment:S,finishProcessingFn:Se}),rt=s(He,et);_e.push(rt)}var it=merge$2(m,{uri:S.part&&S.part.resolvedUri||S.resolvedUri,responseType:"arraybuffer",headers:PZ(S)}),at=s(it,y0({segment:S,finishProcessingFn:Se,responseType:it.responseType}));at.addEventListener("progress",T0({segment:S,progressFn:A,trackInfoFn:O,timingInfoFn:H,videoSegmentTimingInfoFn:K,audioSegmentTimingInfoFn:z,id3Fn:G,captionsFn:q,isEndOfTimeline:X,endedTimelineFn:J,dataFn:ae})),_e.push(at);var ot={};return _e.forEach((function(o){o.addEventListener("loadend",function handleLoadEnd(o){var s=o.loadendState,m=o.abortFn;return function(o){o.target.aborted&&m&&!s.calledAbortFn&&(m(),s.calledAbortFn=!0)}}({loadendState:ot,abortFn:E}))})),function(){return p0(_e)}},C0=UJ("CodecUtils"),w0=function isMaat(o,s){var m=s.attributes||{};return o&&o.mediaGroups&&o.mediaGroups.AUDIO&&m.AUDIO&&o.mediaGroups.AUDIO[m.AUDIO]},x0=function unwrapCodecList(o){var s={};return o.forEach((function(o){var m=o.mediaType,_=o.type,S=o.details;s[m]=s[m]||[],s[m].push(dK("".concat(_).concat(S)))})),Object.keys(s).forEach((function(o){if(s[o].length>1)return C0("multiple ".concat(o," codecs found as attributes: ").concat(s[o].join(", "),". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.")),void(s[o]=null);s[o]=s[o][0]})),s},E0=function codecCount(o){var s=0;return o.audio&&s++,o.video&&s++,s},I0=function codecsForPlaylist(o,s){var m=s.attributes||{},_=x0(function getCodecs(o){var s=o.attributes||{};if(s.CODECS)return hK(s.CODECS)}(s)||[]);if(w0(o,s)&&!_.audio&&!function isMuxed(o,s){if(!w0(o,s))return!0;var m=s.attributes||{},_=o.mediaGroups.AUDIO[m.AUDIO];for(var S in _)if(!_[S].uri&&!_[S].playlists)return!0;return!1}(o,s)){var S=x0(pK(o,m.AUDIO)||[]);S.audio&&(_.audio=S.audio)}return _},A0=UJ("PlaylistSelector"),P0=function representationToString(o){if(o&&o.playlist){var s=o.playlist;return JSON.stringify({id:s.id,bandwidth:o.bandwidth,width:o.width,height:o.height,codecs:s.attributes&&s.attributes.CODECS||""})}},L0=function safeGetComputedStyle(o,s){if(!o)return"";var m=$V.getComputedStyle(o);return m?m[s]:""},D0=function stableSort(o,s){var m=o.slice();o.sort((function(o,_){var S=s(o,_);return 0===S?m.indexOf(o)-m.indexOf(_):S}))},R0=function comparePlaylistBandwidth(o,s){var m,_;return o.attributes.BANDWIDTH&&(m=o.attributes.BANDWIDTH),m=m||$V.Number.MAX_VALUE,s.attributes.BANDWIDTH&&(_=s.attributes.BANDWIDTH),m-(_=_||$V.Number.MAX_VALUE)},O0=function simpleSelector(o,s,m,_,S,E){if(o){var A={bandwidth:s,width:m,height:_,limitRenditionByPlayerDimensions:S},O=o.playlists;dZ.isAudioOnly(o)&&(O=E.getAudioTrackPlaylists_(),A.audioOnly=!0);var H=O.map((function(o){var s=o.attributes&&o.attributes.RESOLUTION&&o.attributes.RESOLUTION.width,m=o.attributes&&o.attributes.RESOLUTION&&o.attributes.RESOLUTION.height;return{bandwidth:o.attributes&&o.attributes.BANDWIDTH||$V.Number.MAX_VALUE,width:s,height:m,playlist:o}}));D0(H,(function(o,s){return o.bandwidth-s.bandwidth}));var K=(H=H.filter((function(o){return!dZ.isIncompatible(o.playlist)}))).filter((function(o){return dZ.isEnabled(o.playlist)}));K.length||(K=H.filter((function(o){return!dZ.isDisabled(o.playlist)})));var z=K.filter((function(o){return o.bandwidth*XZ.BANDWIDTH_VARIANCE<s})),G=z[z.length-1],q=z.filter((function(o){return o.bandwidth===G.bandwidth}))[0];if(!1===S){var X=q||K[0]||H[0];if(X&&X.playlist){var J="sortedPlaylistReps";return q&&(J="bandwidthBestRep"),K[0]&&(J="enabledPlaylistReps"),A0("choosing ".concat(P0(X)," using ").concat(J," with options"),A),X.playlist}return A0("could not choose a playlist with options",A),null}var ae=z.filter((function(o){return o.width&&o.height}));D0(ae,(function(o,s){return o.width-s.width}));var pe=ae.filter((function(o){return o.width===m&&o.height===_}));G=pe[pe.length-1];var me,_e,Se,Ee,De=pe.filter((function(o){return o.bandwidth===G.bandwidth}))[0];if(De||(_e=(me=ae.filter((function(o){return o.width>m||o.height>_}))).filter((function(o){return o.width===me[0].width&&o.height===me[0].height})),G=_e[_e.length-1],Se=_e.filter((function(o){return o.bandwidth===G.bandwidth}))[0]),E.leastPixelDiffSelector){var $e=ae.map((function(o){return o.pixelDiff=Math.abs(o.width-m)+Math.abs(o.height-_),o}));D0($e,(function(o,s){return o.pixelDiff===s.pixelDiff?s.bandwidth-o.bandwidth:o.pixelDiff-s.pixelDiff})),Ee=$e[0]}var He=Ee||Se||De||q||K[0]||H[0];if(He&&He.playlist){var et="sortedPlaylistReps";return Ee?et="leastPixelDiffRep":Se?et="resolutionPlusOneRep":De?et="resolutionBestRep":q?et="bandwidthBestRep":K[0]&&(et="enabledPlaylistReps"),A0("choosing ".concat(P0(He)," using ").concat(et," with options"),A),He.playlist}return A0("could not choose a playlist with options",A),null}},M0=function lastBandwidthSelector(){var o=this.useDevicePixelRatio&&$V.devicePixelRatio||1;return O0(this.playlists.main,this.systemBandwidth,parseInt(L0(this.tech_.el(),"width"),10)*o,parseInt(L0(this.tech_.el(),"height"),10)*o,this.limitRenditionByPlayerDimensions,this.playlistController_)},F0=function addMetadata(o){var s=o.inbandTextTracks,m=o.metadataArray,_=o.timestampOffset,S=o.videoDuration;if(m){var E=$V.WebKitDataCue||$V.VTTCue,A=s.metadataTrack_;if(A&&(m.forEach((function(o){var s=o.cueTime+_;!("number"!=typeof s||$V.isNaN(s)||s<0)&&s<1/0&&o.frames&&o.frames.length&&o.frames.forEach((function(o){var m=new E(s,s,o.value||o.url||o.data||"");m.frame=o,m.value=o,function deprecateOldCue(o){Object.defineProperties(o.frame,{id:{get:function get(){return videojs.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),o.value.key}},value:{get:function get(){return videojs.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),o.value.data}},privateData:{get:function get(){return videojs.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),o.value.data}}})}(m),A.addCue(m)}))})),A.cues&&A.cues.length)){for(var O=A.cues,H=[],K=0;K<O.length;K++)O[K]&&H.push(O[K]);var z=H.reduce((function(o,s){var m=o[s.startTime]||[];return m.push(s),o[s.startTime]=m,o}),{}),G=Object.keys(z).sort((function(o,s){return Number(o)-Number(s)}));G.forEach((function(o,s){var m=z[o],_=isFinite(S)?S:o,E=Number(G[s+1])||_;m.forEach((function(o){o.endTime=E}))}))}}},N0={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},U0=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),B0=function createMetadataTrackIfNotExists(o,s,m){o.metadataTrack_||(o.metadataTrack_=m.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,videojs.browser.IS_ANY_SAFARI||(o.metadataTrack_.inBandMetadataTrackDispatchType=s))},j0=function removeCuesFromTrack(o,s,m){var _,S;if(m&&m.cues)for(_=m.cues.length;_--;)(S=m.cues[_]).startTime>=o&&S.endTime<=s&&m.removeCue(S)},$0=function finite(o){return"number"==typeof o&&isFinite(o)},V0=1/60,H0=function segmentInfoString(o){var s=o.startOfSegment,m=o.duration,_=o.segment,S=o.part,E=o.playlist,A=E.mediaSequence,O=E.id,H=E.segments,K=void 0===H?[]:H,z=o.mediaIndex,G=o.partIndex,q=o.timeline,X=K.length-1,J="mediaIndex/partIndex increment";o.getMediaInfoForTime?J="getMediaInfoForTime (".concat(o.getMediaInfoForTime,")"):o.isSyncRequest&&(J="getSyncSegmentCandidate (isSyncRequest)"),o.independent&&(J+=" with independent ".concat(o.independent));var ae="number"==typeof G,pe=o.segment.uri?"segment":"pre-segment",me=ae?QJ({preloadSegment:_})-1:0;return"".concat(pe," [").concat(A+z,"/").concat(A+X,"]")+(ae?" part [".concat(G,"/").concat(me,"]"):"")+" segment start/end [".concat(_.start," => ").concat(_.end,"]")+(ae?" part start/end [".concat(S.start," => ").concat(S.end,"]"):"")+" startOfSegment [".concat(s,"]")+" duration [".concat(m,"]")+" timeline [".concat(q,"]")+" selected by [".concat(J,"]")+" playlist [".concat(O,"]")},K0=function timingInfoPropertyForMedia(o){return"".concat(o,"TimingInfo")},z0=function shouldWaitForTimelineChange(o){var s=o.timelineChangeController,m=o.currentTimeline,_=o.segmentTimeline,S=o.loaderType,E=o.audioDisabled;if(m===_)return!1;if("audio"===S){var A=s.lastTimelineChange({type:"main"});return!A||A.to!==_}if("main"===S&&E){var O=s.pendingTimelineChange({type:"audio"});return!O||O.to!==_}return!1},W0=function segmentTooLong(o){var s=o.segmentDuration,m=o.maxDuration;return!!s&&Math.round(s)>m+BJ},G0=function getTroublesomeSegmentDurationMessage(o,s){if("hls"!==s)return null;var m=function mediaDuration(o){var s=0;return["video","audio"].forEach((function(m){var _=o["".concat(m,"TimingInfo")];if(_){var S,E=_.start,A=_.end;"bigint"==typeof E||"bigint"==typeof A?S=$V.BigInt(A)-$V.BigInt(E):"number"==typeof E&&"number"==typeof A&&(S=A-E),void 0!==S&&S>s&&(s=S)}})),"bigint"==typeof s&&s<Number.MAX_SAFE_INTEGER&&(s=Number(s)),s}({audioTimingInfo:o.audioTimingInfo,videoTimingInfo:o.videoTimingInfo});if(!m)return null;var _=o.playlist.targetDuration,S=W0({segmentDuration:m,maxDuration:2*_}),E=W0({segmentDuration:m,maxDuration:_}),A="Segment with index ".concat(o.mediaIndex," ")+"from playlist ".concat(o.playlist.id," ")+"has a duration of ".concat(m," ")+"when the reported duration is ".concat(o.duration," ")+"and the target duration is ".concat(_,". ")+"For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";return S||E?{severity:S?"warn":"info",message:A}:null},q0=function(o){_inherits$1(SegmentLoader,o);var s=_createSuper$1(SegmentLoader);function SegmentLoader(o){var m;if(_classCallCheck$1(this,SegmentLoader),m=s.call(this),!o)throw new TypeError("Initialization settings are required");if("function"!=typeof o.currentTime)throw new TypeError("No currentTime getter specified");if(!o.mediaSource)throw new TypeError("No MediaSource specified");return m.bandwidth=o.bandwidth,m.throughput={rate:0,count:0},m.roundTrip=NaN,m.resetStats_(),m.mediaIndex=null,m.partIndex=null,m.hasPlayed_=o.hasPlayed,m.currentTime_=o.currentTime,m.seekable_=o.seekable,m.seeking_=o.seeking,m.duration_=o.duration,m.mediaSource_=o.mediaSource,m.vhs_=o.vhs,m.loaderType_=o.loaderType,m.currentMediaInfo_=void 0,m.startingMediaInfo_=void 0,m.segmentMetadataTrack_=o.segmentMetadataTrack,m.goalBufferLength_=o.goalBufferLength,m.sourceType_=o.sourceType,m.sourceUpdater_=o.sourceUpdater,m.inbandTextTracks_=o.inbandTextTracks,m.state_="INIT",m.timelineChangeController_=o.timelineChangeController,m.shouldSaveSegmentTimingInfo_=!0,m.parse708captions_=o.parse708captions,m.useDtsForTimestampOffset_=o.useDtsForTimestampOffset,m.captionServices_=o.captionServices,m.exactManifestTimings=o.exactManifestTimings,m.addMetadataToTextTrack=o.addMetadataToTextTrack,m.checkBufferTimeout_=null,m.error_=void 0,m.currentTimeline_=-1,m.shouldForceTimestampOffsetAfterResync_=!1,m.pendingSegment_=null,m.xhrOptions_=null,m.pendingSegments_=[],m.audioDisabled_=!1,m.isPendingTimestampOffset_=!1,m.gopBuffer_=[],m.timeMapping_=0,m.safeAppend_=!1,m.appendInitSegment_={audio:!0,video:!0},m.playlistOfLastInitSegment_={audio:null,video:null},m.callQueue_=[],m.loadQueue_=[],m.metadataQueue_={id3:[],caption:[]},m.waitingOnRemove_=!1,m.quotaExceededErrorRetryTimeout_=null,m.activeInitSegmentId_=null,m.initSegments_={},m.cacheEncryptionKeys_=o.cacheEncryptionKeys,m.keyCache_={},m.decrypter_=o.decrypter,m.syncController_=o.syncController,m.syncPoint_={segmentIndex:0,time:0},m.transmuxer_=m.createTransmuxer_(),m.triggerSyncInfoUpdate_=function(){return m.trigger("syncinfoupdate")},m.syncController_.on("syncinfoupdate",m.triggerSyncInfoUpdate_),m.mediaSource_.addEventListener("sourceopen",(function(){m.isEndOfStream_()||(m.ended_=!1)})),m.fetchAtBuffer_=!1,m.logger_=UJ("SegmentLoader[".concat(m.loaderType_,"]")),Object.defineProperty(_assertThisInitialized(m),"state",{get:function get(){return this.state_},set:function set(o){o!==this.state_&&(this.logger_("".concat(this.state_," -> ").concat(o)),this.state_=o,this.trigger("statechange"))}}),m.sourceUpdater_.on("ready",(function(){m.hasEnoughInfoToAppend_()&&m.processCallQueue_()})),"main"===m.loaderType_&&m.timelineChangeController_.on("pendingtimelinechange",(function(){m.hasEnoughInfoToAppend_()&&m.processCallQueue_()})),"audio"===m.loaderType_&&m.timelineChangeController_.on("timelinechange",(function(){m.hasEnoughInfoToLoad_()&&m.processLoadQueue_(),m.hasEnoughInfoToAppend_()&&m.processCallQueue_()})),m}return _createClass$1(SegmentLoader,[{key:"createTransmuxer_",value:function createTransmuxer_(){return u0({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}},{key:"resetStats_",value:function resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}},{key:"dispose",value:function dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&$V.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}},{key:"setAudio",value:function setAudio(o){this.audioDisabled_=!o,o?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}},{key:"abort",value:function abort(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,$V.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}},{key:"checkForAbort_",value:function checkForAbort_(o){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==o:(this.state="READY",!0)}},{key:"error",value:function error(o){return void 0!==o&&(this.logger_("error occurred:",o),this.error_=o),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function endOfStream(){this.ended_=!0,this.transmuxer_&&s0(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function buffered_(){var o=this.getMediaInfo_();if(!this.sourceUpdater_||!o)return createTimeRanges$2();if("main"===this.loaderType_){var s=o.hasAudio,m=o.hasVideo,_=o.isMuxed;if(m&&s&&!this.audioDisabled_&&!_)return this.sourceUpdater_.buffered();if(m)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}},{key:"initSegmentForMap",value:function initSegmentForMap(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!o)return null;var m=MZ(o),_=this.initSegments_[m];return s&&!_&&o.bytes&&(this.initSegments_[m]=_={resolvedUri:o.resolvedUri,byterange:o.byterange,bytes:o.bytes,tracks:o.tracks,timescales:o.timescales}),_||o}},{key:"segmentKey",value:function segmentKey(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!o)return null;var m=FZ(o),_=this.keyCache_[m];this.cacheEncryptionKeys_&&s&&!_&&o.bytes&&(this.keyCache_[m]=_={resolvedUri:o.resolvedUri,bytes:o.bytes});var S={resolvedUri:(_||o).resolvedUri};return _&&(S.bytes=_.bytes),S}},{key:"couldBeginLoading_",value:function couldBeginLoading_(){return this.playlist_&&!this.paused()}},{key:"load",value:function load(){if(this.monitorBuffer_(),this.playlist_)return"INIT"===this.state&&this.couldBeginLoading_()?this.init_():void(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY"))}},{key:"init_",value:function init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function playlist(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(o){var m=this.playlist_,_=this.pendingSegment_;this.playlist_=o,this.xhrOptions_=s,"INIT"===this.state&&(o.syncInfo={mediaSequence:o.mediaSequence,time:0},"main"===this.loaderType_&&this.syncController_.setDateTimeMappingForStart(o));var S=null;if(m&&(m.id?S=m.id:m.uri&&(S=m.uri)),this.logger_("playlist update [".concat(S," => ").concat(o.id||o.uri,"]")),this.syncController_.updateMediaSequenceMap(o,this.currentTime_(),this.loaderType_),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!m||m.uri!==o.uri){if(null!==this.mediaIndex)!o.endList&&"number"==typeof o.partTargetDuration?this.resetLoader():this.resyncLoader();return this.currentMediaInfo_=void 0,void this.trigger("playlistupdate")}var E=o.mediaSequence-m.mediaSequence;if(this.logger_("live window shift [".concat(E,"]")),null!==this.mediaIndex)if(this.mediaIndex-=E,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{var A=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!A.parts||!A.parts.length||!A.parts[this.partIndex])){var O=this.mediaIndex;this.logger_("currently processing part (index ".concat(this.partIndex,") no longer exists.")),this.resetLoader(),this.mediaIndex=O}}_&&(_.mediaIndex-=E,_.mediaIndex<0?(_.mediaIndex=null,_.partIndex=null):(_.mediaIndex>=0&&(_.segment=o.segments[_.mediaIndex]),_.partIndex>=0&&_.segment.parts&&(_.part=_.segment.parts[_.partIndex]))),this.syncController_.saveExpiredSegmentInfo(m,o)}}},{key:"pause",value:function pause(){this.checkBufferTimeout_&&($V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function paused(){return null===this.checkBufferTimeout_}},{key:"resetEverything",value:function resetEverything(o){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,o),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}},{key:"resetLoader",value:function resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function resyncLoader(){this.transmuxer_&&s0(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.shouldForceTimestampOffsetAfterResync_=!0,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}},{key:"remove",value:function remove(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},_=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(s===1/0&&(s=this.duration_()),s<=o)this.logger_("skipping remove because end ${end} is <= start ${start}");else if(this.sourceUpdater_&&this.getMediaInfo_()){var S=1,E=function removeFinished(){0===--S&&m()};for(var A in!_&&this.audioDisabled_||(S++,this.sourceUpdater_.removeAudio(o,s,E)),(_||"main"===this.loaderType_)&&(this.gopBuffer_=function removeGopBuffer(o,s,m,_){for(var S=Math.ceil((s-_)*TG),E=Math.ceil((m-_)*TG),A=o.slice(),O=o.length;O--&&!(o[O].pts<=E););if(-1===O)return A;for(var H=O+1;H--&&!(o[H].pts<=S););return H=Math.max(H,0),A.splice(H,O-H+1),A}(this.gopBuffer_,o,s,this.timeMapping_),S++,this.sourceUpdater_.removeVideo(o,s,E)),this.inbandTextTracks_)j0(o,s,this.inbandTextTracks_[A]);j0(o,s,this.segmentMetadataTrack_),E()}else this.logger_("skipping remove because no source updater or starting media info")}},{key:"monitorBuffer_",value:function monitorBuffer_(){this.checkBufferTimeout_&&$V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=$V.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function monitorBufferTick_(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&$V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=$V.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function fillBuffer_(){if(!this.sourceUpdater_.updating()){var o=this.chooseNextRequest_();o&&("number"==typeof o.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:o.timeline})),this.loadSegment_(o))}}},{key:"isEndOfStream_",value:function isEndOfStream_(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mediaIndex,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playlist_,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.partIndex;if(!s||!this.mediaSource_)return!1;var _="number"==typeof o&&s.segments[o],S=o+1===s.segments.length,E=!_||!_.parts||m+1===_.parts.length;return s.endList&&"open"===this.mediaSource_.readyState&&S&&E}},{key:"chooseNextRequest_",value:function chooseNextRequest_(){var o=this.buffered_(),s=WJ(o)||0,m=GJ(o,this.currentTime_()),_=!this.hasPlayed_()&&m>=1,S=m>=this.goalBufferLength_(),E=this.playlist_.segments;if(!E.length||_||S)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);var A={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(A.isSyncRequest)A.mediaIndex=function getSyncSegmentCandidate(o,s,m){s=s||[];for(var _=[],S=0,E=0;E<s.length;E++){var A=s[E];if(o===A.timeline&&(_.push(E),(S+=A.duration)>m))return E}return 0===_.length?0:_[_.length-1]}(this.currentTimeline_,E,s),this.logger_("choose next request. Can not find sync point. Fallback to media Index: ".concat(A.mediaIndex));else if(null!==this.mediaIndex){var O=E[this.mediaIndex],H="number"==typeof this.partIndex?this.partIndex:-1;A.startOfSegment=O.end?O.end:s,O.parts&&O.parts[H+1]?(A.mediaIndex=this.mediaIndex,A.partIndex=H+1):A.mediaIndex=this.mediaIndex+1}else{var K=dZ.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?s:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),z=K.segmentIndex,G=K.startTime,q=K.partIndex;A.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd ".concat(s):"currentTime ".concat(this.currentTime_()),A.mediaIndex=z,A.startOfSegment=G,A.partIndex=q,this.logger_("choose next request. Playlist switched and we have a sync point. Media Index: ".concat(A.mediaIndex," "))}var X=E[A.mediaIndex],J=X&&"number"==typeof A.partIndex&&X.parts&&X.parts[A.partIndex];if(!X||"number"==typeof A.partIndex&&!J)return null;"number"!=typeof A.partIndex&&X.parts&&(A.partIndex=0,J=X.parts[0]);var ae=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!m&&J&&!ae&&!J.independent)if(0===A.partIndex){var pe=E[A.mediaIndex-1],me=pe.parts&&pe.parts.length&&pe.parts[pe.parts.length-1];me&&me.independent&&(A.mediaIndex-=1,A.partIndex=pe.parts.length-1,A.independent="previous segment")}else X.parts[A.partIndex-1].independent&&(A.partIndex-=1,A.independent="previous part");var _e=this.mediaSource_&&"ended"===this.mediaSource_.readyState;return A.mediaIndex>=E.length-1&&_e&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,A.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(A))}},{key:"generateSegmentInfo_",value:function generateSegmentInfo_(o){var s=o.independent,m=o.playlist,_=o.mediaIndex,S=o.startOfSegment,E=o.isSyncRequest,A=o.partIndex,O=o.forceTimestampOffset,H=o.getMediaInfoForTime,K=m.segments[_],z="number"==typeof A&&K.parts[A],G={requestId:"segment-loader-"+Math.random(),uri:z&&z.resolvedUri||K.resolvedUri,mediaIndex:_,partIndex:z?A:null,isSyncRequest:E,startOfSegment:S,playlist:m,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:K.timeline,duration:z&&z.duration||K.duration,segment:K,part:z,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:H,independent:s},q=void 0!==O?O:this.isPendingTimestampOffset_;G.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:K.timeline,currentTimeline:this.currentTimeline_,startOfSegment:S,buffered:this.buffered_(),overrideCheck:q});var X=WJ(this.sourceUpdater_.audioBuffered());return"number"==typeof X&&(G.audioAppendStart=X-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(G.gopsToAlignWith=function gopsSafeToAlignWith(o,s,m){if(null==s||!o.length)return[];var _,S=Math.ceil((s-m+3)*TG);for(_=0;_<o.length&&!(o[_].pts>S);_++);return o.slice(_)}(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),G}},{key:"timestampOffsetForSegment_",value:function timestampOffsetForSegment_(o){return function timestampOffsetForSegment(o){var s=o.segmentTimeline,m=o.currentTimeline,_=o.startOfSegment,S=o.buffered;return o.overrideCheck||s!==m?s<m?_:S.length?S.end(S.length-1):_:null}(o)}},{key:"earlyAbortWhenNeeded_",value:function earlyAbortWhenNeeded_(o){if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(o.firstBytesReceivedAt||Date.now())<1e3)){var s=this.currentTime_(),m=o.bandwidth,_=this.pendingSegment_.duration,S=dZ.estimateSegmentRequestTime(_,m,this.playlist_,o.bytesReceived),E=function timeUntilRebuffer(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return((o.length?o.end(o.length-1):0)-s)/m}(this.buffered_(),s,this.vhs_.tech_.playbackRate())-1;if(!(S<=E)){var A=function minRebufferMaxBandwidthSelector(o){var s=o.main,m=o.currentTime,_=o.bandwidth,S=o.duration,E=o.segmentDuration,A=o.timeUntilRebuffer,O=o.currentTimeline,H=o.syncController,K=s.playlists.filter((function(o){return!dZ.isIncompatible(o)})),z=K.filter(dZ.isEnabled);z.length||(z=K.filter((function(o){return!dZ.isDisabled(o)})));var G=z.filter(dZ.hasAttribute.bind(null,"BANDWIDTH")).map((function(o){var s=H.getSyncPoint(o,S,O,m)?1:2;return{playlist:o,rebufferingImpact:dZ.estimateSegmentRequestTime(E,_,o)*s-A}})),q=G.filter((function(o){return o.rebufferingImpact<=0}));return D0(q,(function(o,s){return R0(s.playlist,o.playlist)})),q.length?q[0]:(D0(G,(function(o,s){return o.rebufferingImpact-s.rebufferingImpact})),G[0]||null)}({main:this.vhs_.playlists.main,currentTime:s,bandwidth:m,duration:this.duration_(),segmentDuration:_,timeUntilRebuffer:E,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(A){var O=S-E-A.rebufferingImpact,H=.5;E<=BJ&&(H=1),!A.playlist||A.playlist.uri===this.playlist_.uri||O<H||(this.bandwidth=A.playlist.attributes.BANDWIDTH*XZ.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}}},{key:"handleAbort_",value:function handleAbort_(o){this.logger_("Aborting ".concat(H0(o))),this.mediaRequestsAborted+=1}},{key:"handleProgress_",value:function handleProgress_(o,s){this.earlyAbortWhenNeeded_(s.stats),this.checkForAbort_(s.requestId)||this.trigger("progress")}},{key:"handleTrackInfo_",value:function handleTrackInfo_(o,s){this.earlyAbortWhenNeeded_(o.stats),this.checkForAbort_(o.requestId)||this.checkForIllegalMediaSwitch(s)||(s=s||{},function shallowEqual(o,s){if(!o&&!s||!o&&s||o&&!s)return!1;if(o===s)return!0;var m=Object.keys(o).sort(),_=Object.keys(s).sort();if(m.length!==_.length)return!1;for(var S=0;S<m.length;S++){var E=m[S];if(E!==_[S])return!1;if(o[E]!==s[E])return!1}return!0}(this.currentMediaInfo_,s)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=s,this.currentMediaInfo_=s,this.logger_("trackinfo update",s),this.trigger("trackinfo")),this.checkForAbort_(o.requestId)||(this.pendingSegment_.trackInfo=s,this.hasEnoughInfoToAppend_()&&this.processCallQueue_()))}},{key:"handleTimingInfo_",value:function handleTimingInfo_(o,s,m,_){if(this.earlyAbortWhenNeeded_(o.stats),!this.checkForAbort_(o.requestId)){var S=this.pendingSegment_,E=K0(s);S[E]=S[E]||{},S[E][m]=_,this.logger_("timinginfo: ".concat(s," - ").concat(m," - ").concat(_)),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}}},{key:"handleCaptions_",value:function handleCaptions_(o,s){var m=this;if(this.earlyAbortWhenNeeded_(o.stats),!this.checkForAbort_(o.requestId))if(0!==s.length)if(this.pendingSegment_.hasAppendedData_){var _=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),S={};s.forEach((function(o){S[o.stream]=S[o.stream]||{startTime:1/0,captions:[],endTime:0};var s=S[o.stream];s.startTime=Math.min(s.startTime,o.startTime+_),s.endTime=Math.max(s.endTime,o.endTime+_),s.captions.push(o)})),Object.keys(S).forEach((function(o){var s=S[o],E=s.startTime,A=s.endTime,O=s.captions,H=m.inbandTextTracks_;m.logger_("adding cues from ".concat(E," -> ").concat(A," for ").concat(o)),function createCaptionsTrackIfNotExists(o,s,m){if(!o[m]){s.trigger({type:"usage",name:"vhs-608"});var _=m;/^cc708_/.test(m)&&(_="SERVICE"+m.split("_")[1]);var S=s.textTracks().getTrackById(_);if(S)o[m]=S;else{var E=m,A=m,O=!1,H=(s.options_.vhs&&s.options_.vhs.captionServices||{})[_];H&&(E=H.label,A=H.language,O=H.default),o[m]=s.addRemoteTextTrack({kind:"captions",id:_,default:O,label:E,language:A},!1).track}}}(H,m.vhs_.tech_,o),j0(E,A,H[o]),function addCaptionData(o){var s=o.inbandTextTracks,m=o.captionArray,_=o.timestampOffset;if(m){var S=$V.WebKitDataCue||$V.VTTCue;m.forEach((function(o){var m=o.stream;o.content?o.content.forEach((function(E){var A=new S(o.startTime+_,o.endTime+_,E.text);A.line=E.line,A.align="left",A.position=E.position,A.positionAlign="line-left",s[m].addCue(A)})):s[m].addCue(new S(o.startTime+_,o.endTime+_,o.text))}))}}({captionArray:O,inbandTextTracks:H,timestampOffset:_})})),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}else this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,o,s));else this.logger_("SegmentLoader received no captions from a caption event")}},{key:"handleId3_",value:function handleId3_(o,s,m){(this.earlyAbortWhenNeeded_(o.stats),this.checkForAbort_(o.requestId))||(this.pendingSegment_.hasAppendedData_?this.addMetadataToTextTrack(m,s,this.duration_()):this.metadataQueue_.id3.push(this.handleId3_.bind(this,o,s,m)))}},{key:"processMetadataQueue_",value:function processMetadataQueue_(){this.metadataQueue_.id3.forEach((function(o){return o()})),this.metadataQueue_.caption.forEach((function(o){return o()})),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}},{key:"processCallQueue_",value:function processCallQueue_(){var o=this.callQueue_;this.callQueue_=[],o.forEach((function(o){return o()}))}},{key:"processLoadQueue_",value:function processLoadQueue_(){var o=this.loadQueue_;this.loadQueue_=[],o.forEach((function(o){return o()}))}},{key:"hasEnoughInfoToLoad_",value:function hasEnoughInfoToLoad_(){if("audio"!==this.loaderType_)return!0;var o=this.pendingSegment_;return!!o&&(!this.getCurrentMediaInfo_()||!z0({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:o.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}},{key:"getCurrentMediaInfo_",value:function getCurrentMediaInfo_(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pendingSegment_;return o&&o.trackInfo||this.currentMediaInfo_}},{key:"getMediaInfo_",value:function getMediaInfo_(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pendingSegment_;return this.getCurrentMediaInfo_(o)||this.startingMediaInfo_}},{key:"getPendingSegmentPlaylist",value:function getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}},{key:"hasEnoughInfoToAppend_",value:function hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready())return!1;if(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;var o=this.pendingSegment_,s=this.getCurrentMediaInfo_();if(!o||!s)return!1;var m=s.hasAudio,_=s.hasVideo,S=s.isMuxed;return!(_&&!o.videoTimingInfo)&&(!(m&&!this.audioDisabled_&&!S&&!o.audioTimingInfo)&&!z0({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:o.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}},{key:"handleData_",value:function handleData_(o,s){if(this.earlyAbortWhenNeeded_(o.stats),!this.checkForAbort_(o.requestId))if(!this.callQueue_.length&&this.hasEnoughInfoToAppend_()){var m=this.pendingSegment_;if(this.setTimeMapping_(m.timeline),this.updateMediaSecondsLoaded_(m.part||m.segment),"closed"!==this.mediaSource_.readyState){if(o.map&&(o.map=this.initSegmentForMap(o.map,!0),m.segment.map=o.map),o.key&&this.segmentKey(o.key,!0),m.isFmp4=o.isFmp4,m.timingInfo=m.timingInfo||{},m.isFmp4)this.trigger("fmp4"),m.timingInfo.start=m[K0(s.type)].start;else{var _,S=this.getCurrentMediaInfo_(),E="main"===this.loaderType_&&S&&S.hasVideo;E&&(_=m.videoTimingInfo.start),m.timingInfo.start=this.trueSegmentStart_({currentStart:m.timingInfo.start,playlist:m.playlist,mediaIndex:m.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:E,firstVideoFrameTimeForData:_,videoTimingInfo:m.videoTimingInfo,audioTimingInfo:m.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(m,s.type),this.updateSourceBufferTimestampOffset_(m),m.isSyncRequest){this.updateTimingInfoEnd_(m),this.syncController_.saveSegmentTimingInfo({segmentInfo:m,shouldSaveTimelineMapping:"main"===this.loaderType_});var A=this.chooseNextRequest_();if(A.mediaIndex!==m.mediaIndex||A.partIndex!==m.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}m.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(m,s)}}else this.callQueue_.push(this.handleData_.bind(this,o,s))}},{key:"updateAppendInitSegmentStatus",value:function updateAppendInitSegmentStatus(o,s){"main"!==this.loaderType_||"number"!=typeof o.timestampOffset||o.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[s]!==o.playlist&&(this.appendInitSegment_[s]=!0)}},{key:"getInitSegmentAndUpdateState_",value:function getInitSegmentAndUpdateState_(o){var s=o.type,m=o.initSegment,_=o.map,S=o.playlist;if(_){var E=MZ(_);if(this.activeInitSegmentId_===E)return null;m=this.initSegmentForMap(_,!0).bytes,this.activeInitSegmentId_=E}return m&&this.appendInitSegment_[s]?(this.playlistOfLastInitSegment_[s]=S,this.appendInitSegment_[s]=!1,this.activeInitSegmentId_=null,m):null}},{key:"handleQuotaExceededError_",value:function handleQuotaExceededError_(o,s){var m=this,_=o.segmentInfo,S=o.type,E=o.bytes,A=this.sourceUpdater_.audioBuffered(),O=this.sourceUpdater_.videoBuffered();A.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+zJ(A).join(", ")),O.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+zJ(O).join(", "));var H=A.length?A.start(0):0,K=A.length?A.end(A.length-1):0,z=O.length?O.start(0):0,G=O.length?O.end(O.length-1):0;if(K-H<=1&&G-z<=1)return this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. "+"Appended byte length: ".concat(E.byteLength,", ")+"audio buffer: ".concat(zJ(A).join(", "),", ")+"video buffer: ".concat(zJ(O).join(", "),", ")),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),void this.trigger("error");this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:_,type:S,bytes:E}));var q=this.currentTime_()-1;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ".concat(q)),this.remove(0,q,(function(){m.logger_("On QUOTA_EXCEEDED_ERR, retrying append in ".concat(1,"s")),m.waitingOnRemove_=!1,m.quotaExceededErrorRetryTimeout_=$V.setTimeout((function(){m.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),m.quotaExceededErrorRetryTimeout_=null,m.processCallQueue_()}),1e3)}),!0)}},{key:"handleAppendError_",value:function handleAppendError_(o,s){var m=o.segmentInfo,_=o.type,S=o.bytes;s&&(22!==s.code?(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",s),this.error("".concat(_," append of ").concat(S.length,"b failed for segment ")+"#".concat(m.mediaIndex," in playlist ").concat(m.playlist.id)),this.trigger("appenderror")):this.handleQuotaExceededError_({segmentInfo:m,type:_,bytes:S}))}},{key:"appendToSourceBuffer_",value:function appendToSourceBuffer_(o){var s=o.segmentInfo,m=o.type,_=o.initSegment,S=o.data,E=o.bytes;if(!E){var A=[S],O=S.byteLength;_&&(A.unshift(_),O+=_.byteLength),E=function concatSegments(o){var s,m=0;return o.bytes&&(s=new Uint8Array(o.bytes),o.segments.forEach((function(o){s.set(o,m),m+=o.byteLength}))),s}({bytes:O,segments:A})}this.sourceUpdater_.appendBuffer({segmentInfo:s,type:m,bytes:E},this.handleAppendError_.bind(this,{segmentInfo:s,type:m,bytes:E}))}},{key:"handleSegmentTimingInfo_",value:function handleSegmentTimingInfo_(o,s,m){if(this.pendingSegment_&&s===this.pendingSegment_.requestId){var _=this.pendingSegment_.segment,S="".concat(o,"TimingInfo");_[S]||(_[S]={}),_[S].transmuxerPrependedSeconds=m.prependedContentDuration||0,_[S].transmuxedPresentationStart=m.start.presentation,_[S].transmuxedDecodeStart=m.start.decode,_[S].transmuxedPresentationEnd=m.end.presentation,_[S].transmuxedDecodeEnd=m.end.decode,_[S].baseMediaDecodeTime=m.baseMediaDecodeTime}}},{key:"appendData_",value:function appendData_(o,s){var m=s.type,_=s.data;if(_&&_.byteLength&&("audio"!==m||!this.audioDisabled_)){var S=this.getInitSegmentAndUpdateState_({type:m,initSegment:s.initSegment,playlist:o.playlist,map:o.isFmp4?o.segment.map:null});this.appendToSourceBuffer_({segmentInfo:o,type:m,initSegment:S,data:_})}}},{key:"loadSegment_",value:function loadSegment_(o){var s=this;this.state="WAITING",this.pendingSegment_=o,this.trimBackBuffer_(o),"number"==typeof o.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(o):this.loadQueue_.push((function(){var m=gH({},o,{forceTimestampOffset:!0});gH(o,s.generateSegmentInfo_(m)),s.isPendingTimestampOffset_=!1,s.updateTransmuxerAndRequestSegment_(o)}))}},{key:"updateTransmuxerAndRequestSegment_",value:function updateTransmuxerAndRequestSegment_(o){var s=this;this.shouldUpdateTransmuxerTimestampOffset_(o.timestampOffset)&&(this.gopBuffer_.length=0,o.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:o.timestampOffset}));var m=this.createSimplifiedSegmentObj_(o),_=this.isEndOfStream_(o.mediaIndex,o.playlist,o.partIndex),S=null!==this.mediaIndex,E=o.timeline!==this.currentTimeline_&&o.timeline>0,A=_||S&&E;this.logger_("Requesting ".concat(H0(o))),m.map&&!m.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),o.abortRequests=k0({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:m,abortFn:this.handleAbort_.bind(this,o),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",o.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",o.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:A,endedTimelineFn:function endedTimelineFn(){s.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:function onTransmuxerLog(m){var _=m.message,S=m.level,E=m.stream;s.logger_("".concat(H0(o)," logged from transmuxer stream ").concat(E," as a ").concat(S,": ").concat(_))}})}},{key:"trimBackBuffer_",value:function trimBackBuffer_(o){var s=function safeBackBufferTrimTime(o,s,m){var _=s-XZ.BACK_BUFFER_LENGTH;o.length&&(_=Math.max(_,o.start(0)));var S=s-m;return Math.min(S,_)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);s>0&&this.remove(0,s)}},{key:"createSimplifiedSegmentObj_",value:function createSimplifiedSegmentObj_(o){var s=o.segment,m=o.part,_={resolvedUri:m?m.resolvedUri:s.resolvedUri,byterange:m?m.byterange:s.byterange,requestId:o.requestId,transmuxer:o.transmuxer,audioAppendStart:o.audioAppendStart,gopsToAlignWith:o.gopsToAlignWith,part:o.part},S=o.playlist.segments[o.mediaIndex-1];if(S&&S.timeline===s.timeline&&(S.videoTimingInfo?_.baseStartTime=S.videoTimingInfo.transmuxedDecodeEnd:S.audioTimingInfo&&(_.baseStartTime=S.audioTimingInfo.transmuxedDecodeEnd)),s.key){var E=s.key.iv||new Uint32Array([0,0,0,o.mediaIndex+o.playlist.mediaSequence]);_.key=this.segmentKey(s.key),_.key.iv=E}return s.map&&(_.map=this.initSegmentForMap(s.map)),_}},{key:"saveTransferStats_",value:function saveTransferStats_(o){this.mediaRequests+=1,o&&(this.mediaBytesTransferred+=o.bytesReceived,this.mediaTransferDuration+=o.roundTripTime)}},{key:"saveBandwidthRelatedStats_",value:function saveBandwidthRelatedStats_(o,s){this.pendingSegment_.byteLength=s.bytesReceived,o<V0?this.logger_("Ignoring segment's bandwidth because its duration of ".concat(o)+" is less than the min to record ".concat(V0)):(this.bandwidth=s.bandwidth,this.roundTrip=s.roundTripTime)}},{key:"handleTimeout_",value:function handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}},{key:"segmentRequestFinished_",value:function segmentRequestFinished_(o,s,m){if(this.callQueue_.length)this.callQueue_.push(this.segmentRequestFinished_.bind(this,o,s,m));else if(this.saveTransferStats_(s.stats),this.pendingSegment_&&s.requestId===this.pendingSegment_.requestId){if(o){if(this.pendingSegment_=null,this.state="READY",o.code===h0)return;return this.pause(),o.code===d0?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(o),void this.trigger("error"))}var _=this.pendingSegment_;this.saveBandwidthRelatedStats_(_.duration,s.stats),_.endOfAllRequests=s.endOfAllRequests,m.gopInfo&&(this.gopBuffer_=function updateGopBuffer(o,s,m){if(!s.length)return o;if(m)return s.slice();for(var _=s[0].pts,S=0;S<o.length&&!(o[S].pts>=_);S++);return o.slice(0,S).concat(s)}(this.gopBuffer_,m.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(_)}}},{key:"setTimeMapping_",value:function setTimeMapping_(o){var s=this.syncController_.mappingForTimeline(o);null!==s&&(this.timeMapping_=s)}},{key:"updateMediaSecondsLoaded_",value:function updateMediaSecondsLoaded_(o){"number"==typeof o.start&&"number"==typeof o.end?this.mediaSecondsLoaded+=o.end-o.start:this.mediaSecondsLoaded+=o.duration}},{key:"shouldUpdateTransmuxerTimestampOffset_",value:function shouldUpdateTransmuxerTimestampOffset_(o){return null!==o&&("main"===this.loaderType_&&o!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&o!==this.sourceUpdater_.audioTimestampOffset())}},{key:"trueSegmentStart_",value:function trueSegmentStart_(o){var s=o.currentStart,m=o.playlist,_=o.mediaIndex,S=o.firstVideoFrameTimeForData,E=o.currentVideoTimestampOffset,A=o.useVideoTimingInfo,O=o.videoTimingInfo,H=o.audioTimingInfo;if(void 0!==s)return s;if(!A)return H.start;var K=m.segments[_-1];return 0!==_&&K&&void 0!==K.start&&K.end===S+E?O.start:S}},{key:"waitForAppendsToComplete_",value:function waitForAppendsToComplete_(o){var s=this.getCurrentMediaInfo_(o);if(!s)return this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),void this.trigger("error");var m=s.hasAudio,_=s.hasVideo,S=s.isMuxed,E="main"===this.loaderType_&&_,A=!this.audioDisabled_&&m&&!S;if(o.waitingOnAppends=0,!o.hasAppendedData_)return o.timingInfo||"number"!=typeof o.timestampOffset||(this.isPendingTimestampOffset_=!0),o.timingInfo={start:0},o.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(o),this.processMetadataQueue_()),void this.checkAppendsDone_(o);E&&o.waitingOnAppends++,A&&o.waitingOnAppends++,E&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,o)),A&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,o))}},{key:"checkAppendsDone_",value:function checkAppendsDone_(o){this.checkForAbort_(o.requestId)||(o.waitingOnAppends--,0===o.waitingOnAppends&&this.handleAppendsDone_())}},{key:"checkForIllegalMediaSwitch",value:function checkForIllegalMediaSwitch(o){var s=function illegalMediaSwitch(o,s,m){return"main"===o&&s&&m?m.hasAudio||m.hasVideo?s.hasVideo&&!m.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!s.hasVideo&&m.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.getCurrentMediaInfo_(),o);return!!s&&(this.error({message:s,playlistExclusionDuration:1/0}),this.trigger("error"),!0)}},{key:"updateSourceBufferTimestampOffset_",value:function updateSourceBufferTimestampOffset_(o){if(null!==o.timestampOffset&&"number"==typeof o.timingInfo.start&&!o.changedTimestampOffset&&"main"===this.loaderType_){var s=!1;o.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:o.segment.videoTimingInfo,audioTimingInfo:o.segment.audioTimingInfo,timingInfo:o.timingInfo}),o.changedTimestampOffset=!0,o.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(o.timestampOffset),s=!0),o.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(o.timestampOffset),s=!0),s&&this.trigger("timestampoffset")}}},{key:"getSegmentStartTimeForTimestampOffsetCalculation_",value:function getSegmentStartTimeForTimestampOffsetCalculation_(o){var s=o.videoTimingInfo,m=o.audioTimingInfo,_=o.timingInfo;return this.useDtsForTimestampOffset_?s&&"number"==typeof s.transmuxedDecodeStart?s.transmuxedDecodeStart:m&&"number"==typeof m.transmuxedDecodeStart?m.transmuxedDecodeStart:_.start:_.start}},{key:"updateTimingInfoEnd_",value:function updateTimingInfoEnd_(o){o.timingInfo=o.timingInfo||{};var s=this.getMediaInfo_(),m="main"===this.loaderType_&&s&&s.hasVideo&&o.videoTimingInfo?o.videoTimingInfo:o.audioTimingInfo;m&&(o.timingInfo.end="number"==typeof m.end?m.end:m.start+o.duration)}},{key:"handleAppendsDone_",value:function handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var o=this.pendingSegment_;this.updateTimingInfoEnd_(o),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:o,shouldSaveTimelineMapping:"main"===this.loaderType_});var s=G0(o,this.sourceType_);if(s&&("warn"===s.severity?videojs.log.warn(s.message):this.logger_(s.message)),this.recordThroughput_(o),this.pendingSegment_=null,this.state="READY",!o.isSyncRequest||(this.trigger("syncinfoupdate"),o.hasAppendedData_)){this.logger_("Appended ".concat(H0(o))),this.addSegmentMetadataCue_(o),this.fetchAtBuffer_=!0,this.currentTimeline_!==o.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:o.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:o.timeline})),this.currentTimeline_=o.timeline,this.trigger("syncinfoupdate");var m=o.segment,_=o.part,S=m.end&&this.currentTime_()-m.end>3*o.playlist.targetDuration,E=_&&_.end&&this.currentTime_()-_.end>3*o.playlist.partTargetDuration;if(S||E)return this.logger_("bad ".concat(S?"segment":"part"," ").concat(H0(o))),void this.resetEverything();null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=o.mediaIndex,this.partIndex=o.partIndex,this.isEndOfStream_(o.mediaIndex,o.playlist,o.partIndex)&&this.endOfStream(),this.trigger("appended"),o.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}else this.logger_("Throwing away un-appended sync request ".concat(H0(o)))}},{key:"recordThroughput_",value:function recordThroughput_(o){if(o.duration<V0)this.logger_("Ignoring segment's throughput because its duration of ".concat(o.duration)+" is less than the min to record ".concat(V0));else{var s=this.throughput.rate,m=Date.now()-o.endOfAllRequests+1,_=Math.floor(o.byteLength/m*8*1e3);this.throughput.rate+=(_-s)/++this.throughput.count}}},{key:"addSegmentMetadataCue_",value:function addSegmentMetadataCue_(o){if(this.segmentMetadataTrack_){var s=o.segment,m=s.start,_=s.end;if($0(m)&&$0(_)){j0(m,_,this.segmentMetadataTrack_);var S=$V.WebKitDataCue||$V.VTTCue,E={custom:s.custom,dateTimeObject:s.dateTimeObject,dateTimeString:s.dateTimeString,programDateTime:s.programDateTime,bandwidth:o.playlist.attributes.BANDWIDTH,resolution:o.playlist.attributes.RESOLUTION,codecs:o.playlist.attributes.CODECS,byteLength:o.byteLength,uri:o.uri,timeline:o.timeline,playlist:o.playlist.id,start:m,end:_},A=new S(m,_,JSON.stringify(E));A.value=E,this.segmentMetadataTrack_.addCue(A)}}}}]),SegmentLoader}(videojs.EventTarget);function noop$1(){}var X0,Y0=function toTitleCase(o){return"string"!=typeof o?o:o.replace(/./,(function(o){return o.toUpperCase()}))},Q0=["video","audio"],J0=function updating(o,s){var m=s["".concat(o,"Buffer")];return m&&m.updating||s.queuePending[o]},Z0=function shiftQueue(o,s){if(0!==s.queue.length){var m=0,_=s.queue[m];if("mediaSource"!==_.type){if("mediaSource"!==o&&s.ready()&&"closed"!==s.mediaSource.readyState&&!J0(o,s)){if(_.type!==o){if(m=function nextQueueIndexOfType(o,s){for(var m=0;m<s.length;m++){var _=s[m];if("mediaSource"===_.type)return null;if(_.type===o)return m}return null}(o,s.queue),null===m)return;_=s.queue[m]}return s.queue.splice(m,1),s.queuePending[o]=_,_.action(o,s),_.doneFn?void 0:(s.queuePending[o]=null,void shiftQueue(o,s))}}else s.updating()||"closed"===s.mediaSource.readyState||(s.queue.shift(),_.action(s),_.doneFn&&_.doneFn(),shiftQueue("audio",s),shiftQueue("video",s))}},e1=function cleanupBuffer(o,s){var m=s["".concat(o,"Buffer")],_=Y0(o);m&&(m.removeEventListener("updateend",s["on".concat(_,"UpdateEnd_")]),m.removeEventListener("error",s["on".concat(_,"Error_")]),s.codecs[o]=null,s["".concat(o,"Buffer")]=null)},t1=function inSourceBuffers(o,s){return o&&s&&-1!==Array.prototype.indexOf.call(o.sourceBuffers,s)},n1=function appendBuffer(o,s,m){return function(_,S){var E=S["".concat(_,"Buffer")];if(t1(S.mediaSource,E)){S.logger_("Appending segment ".concat(s.mediaIndex,"'s ").concat(o.length," bytes to ").concat(_,"Buffer"));try{E.appendBuffer(o)}catch(o){S.logger_("Error with code ".concat(o.code," ")+(22===o.code?"(QUOTA_EXCEEDED_ERR) ":"")+"when appending segment ".concat(s.mediaIndex," to ").concat(_,"Buffer")),S.queuePending[_]=null,m(o)}}}},r1=function remove(o,s){return function(m,_){var S=_["".concat(m,"Buffer")];if(t1(_.mediaSource,S)){_.logger_("Removing ".concat(o," to ").concat(s," from ").concat(m,"Buffer"));try{S.remove(o,s)}catch(S){_.logger_("Remove ".concat(o," to ").concat(s," from ").concat(m,"Buffer failed"))}}}},i1=function timestampOffset(o){return function(s,m){var _=m["".concat(s,"Buffer")];t1(m.mediaSource,_)&&(m.logger_("Setting ".concat(s,"timestampOffset to ").concat(o)),_.timestampOffset=o)}},a1=function callback(o){return function(s,m){o()}},o1=function endOfStream(o){return function(s){if("open"===s.mediaSource.readyState){s.logger_("Calling mediaSource endOfStream(".concat(o||"",")"));try{s.mediaSource.endOfStream(o)}catch(o){videojs.log.warn("Failed to call media source endOfStream",o)}}}},s1=function duration(o){return function(s){s.logger_("Setting mediaSource duration to ".concat(o));try{s.mediaSource.duration=o}catch(o){videojs.log.warn("Failed to set media source duration",o)}}},u1=function abort(){return function(o,s){if("open"===s.mediaSource.readyState){var m=s["".concat(o,"Buffer")];if(t1(s.mediaSource,m)){s.logger_("calling abort on ".concat(o,"Buffer"));try{m.abort()}catch(s){videojs.log.warn("Failed to abort on ".concat(o,"Buffer"),s)}}}}},l1=function addSourceBuffer(o,s){return function(m){var _=Y0(o),S=gK(s);m.logger_("Adding ".concat(o,"Buffer with codec ").concat(s," to mediaSource"));var E=m.mediaSource.addSourceBuffer(S);E.addEventListener("updateend",m["on".concat(_,"UpdateEnd_")]),E.addEventListener("error",m["on".concat(_,"Error_")]),m.codecs[o]=s,m["".concat(o,"Buffer")]=E}},c1=function removeSourceBuffer(o){return function(s){var m=s["".concat(o,"Buffer")];if(e1(o,s),t1(s.mediaSource,m)){s.logger_("Removing ".concat(o,"Buffer with codec ").concat(s.codecs[o]," from mediaSource"));try{s.mediaSource.removeSourceBuffer(m)}catch(s){videojs.log.warn("Failed to removeSourceBuffer ".concat(o,"Buffer"),s)}}}},d1=function changeType(o){return function(s,m){var _=m["".concat(s,"Buffer")],S=gK(o);if(t1(m.mediaSource,_)&&m.codecs[s]!==o){m.logger_("changing ".concat(s,"Buffer codec from ").concat(m.codecs[s]," to ").concat(o));try{_.changeType(S),m.codecs[s]=o}catch(o){videojs.log.warn("Failed to changeType on ".concat(s,"Buffer"),o)}}}},h1=function pushQueue(o){var s=o.type,m=o.sourceUpdater,_=o.action,S=o.doneFn,E=o.name;m.queue.push({type:s,action:_,doneFn:S,name:E}),Z0(s,m)},p1=function onUpdateend(o,s){return function(m){if(s.queuePending[o]){var _=s.queuePending[o].doneFn;s.queuePending[o]=null,_&&_(s["".concat(o,"Error_")])}Z0(o,s)}},f1=function(o){_inherits$1(SourceUpdater,o);var s=_createSuper$1(SourceUpdater);function SourceUpdater(o){var m;return _classCallCheck$1(this,SourceUpdater),(m=s.call(this)).mediaSource=o,m.sourceopenListener_=function(){return Z0("mediaSource",_assertThisInitialized(m))},m.mediaSource.addEventListener("sourceopen",m.sourceopenListener_),m.logger_=UJ("SourceUpdater"),m.audioTimestampOffset_=0,m.videoTimestampOffset_=0,m.queue=[],m.queuePending={audio:null,video:null},m.delayedAudioAppendQueue_=[],m.videoAppendQueued_=!1,m.codecs={},m.onVideoUpdateEnd_=p1("video",_assertThisInitialized(m)),m.onAudioUpdateEnd_=p1("audio",_assertThisInitialized(m)),m.onVideoError_=function(o){m.videoError_=o},m.onAudioError_=function(o){m.audioError_=o},m.createdSourceBuffers_=!1,m.initializedEme_=!1,m.triggeredReady_=!1,m}return _createClass$1(SourceUpdater,[{key:"initializedEme",value:function initializedEme(){this.initializedEme_=!0,this.triggerReady()}},{key:"hasCreatedSourceBuffers",value:function hasCreatedSourceBuffers(){return this.createdSourceBuffers_}},{key:"hasInitializedAnyEme",value:function hasInitializedAnyEme(){return this.initializedEme_}},{key:"ready",value:function ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}},{key:"createSourceBuffers",value:function createSourceBuffers(o){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(o),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}},{key:"triggerReady",value:function triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}},{key:"addSourceBuffer",value:function addSourceBuffer(o,s){h1({type:"mediaSource",sourceUpdater:this,action:l1(o,s),name:"addSourceBuffer"})}},{key:"abort",value:function abort(o){h1({type:o,sourceUpdater:this,action:u1(o),name:"abort"})}},{key:"removeSourceBuffer",value:function removeSourceBuffer(o){this.canRemoveSourceBuffer()?h1({type:"mediaSource",sourceUpdater:this,action:c1(o),name:"removeSourceBuffer"}):videojs.log.error("removeSourceBuffer is not supported!")}},{key:"canRemoveSourceBuffer",value:function canRemoveSourceBuffer(){return!videojs.browser.IS_FIREFOX&&$V.MediaSource&&$V.MediaSource.prototype&&"function"==typeof $V.MediaSource.prototype.removeSourceBuffer}},{key:"canChangeType",value:function canChangeType(){return this.constructor.canChangeType()}},{key:"changeType",value:function changeType(o,s){this.canChangeType()?h1({type:o,sourceUpdater:this,action:d1(s),name:"changeType"}):videojs.log.error("changeType is not supported!")}},{key:"addOrChangeSourceBuffers",value:function addOrChangeSourceBuffers(o){var s=this;if(!o||"object"!=typeof o||0===Object.keys(o).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(o).forEach((function(m){var _=o[m];if(!s.hasCreatedSourceBuffers())return s.addSourceBuffer(m,_);s.canChangeType()&&s.changeType(m,_)}))}},{key:"appendBuffer",value:function appendBuffer(o,s){var m=this,_=o.segmentInfo,S=o.type,E=o.bytes;if(this.processedAppend_=!0,"audio"===S&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([o,s]),void this.logger_("delayed audio append of ".concat(E.length," until video append"));if(h1({type:S,sourceUpdater:this,action:n1(E,_||{mediaIndex:-1},s),doneFn:s,name:"appendBuffer"}),"video"===S){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var A=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio ".concat(A.length," appendBuffers")),this.delayedAudioAppendQueue_.length=0,A.forEach((function(o){m.appendBuffer.apply(m,o)}))}}},{key:"audioBuffered",value:function audioBuffered(){return t1(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:createTimeRanges$2()}},{key:"videoBuffered",value:function videoBuffered(){return t1(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:createTimeRanges$2()}},{key:"buffered",value:function buffered(){var o=t1(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,s=t1(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return s&&!o?this.audioBuffered():o&&!s?this.videoBuffered():function bufferIntersection(o,s){var m=null,_=null,S=0,E=[],A=[];if(!(o&&o.length&&s&&s.length))return createTimeRanges$2();for(var O=o.length;O--;)E.push({time:o.start(O),type:"start"}),E.push({time:o.end(O),type:"end"});for(O=s.length;O--;)E.push({time:s.start(O),type:"start"}),E.push({time:s.end(O),type:"end"});for(E.sort((function(o,s){return o.time-s.time})),O=0;O<E.length;O++)"start"===E[O].type?2==++S&&(m=E[O].time):"end"===E[O].type&&1==--S&&(_=E[O].time),null!==m&&null!==_&&(A.push([m,_]),m=null,_=null);return createTimeRanges$2(A)}(this.audioBuffered(),this.videoBuffered())}},{key:"setDuration",value:function setDuration(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:noop$1;h1({type:"mediaSource",sourceUpdater:this,action:s1(o),name:"duration",doneFn:s})}},{key:"endOfStream",value:function endOfStream(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:noop$1;"string"!=typeof o&&(o=void 0),h1({type:"mediaSource",sourceUpdater:this,action:o1(o),name:"endOfStream",doneFn:s})}},{key:"removeAudio",value:function removeAudio(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:noop$1;this.audioBuffered().length&&0!==this.audioBuffered().end(0)?h1({type:"audio",sourceUpdater:this,action:r1(o,s),doneFn:m,name:"remove"}):m()}},{key:"removeVideo",value:function removeVideo(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:noop$1;this.videoBuffered().length&&0!==this.videoBuffered().end(0)?h1({type:"video",sourceUpdater:this,action:r1(o,s),doneFn:m,name:"remove"}):m()}},{key:"updating",value:function updating(){return!(!J0("audio",this)&&!J0("video",this))}},{key:"audioTimestampOffset",value:function audioTimestampOffset(o){return void 0!==o&&this.audioBuffer&&this.audioTimestampOffset_!==o&&(h1({type:"audio",sourceUpdater:this,action:i1(o),name:"timestampOffset"}),this.audioTimestampOffset_=o),this.audioTimestampOffset_}},{key:"videoTimestampOffset",value:function videoTimestampOffset(o){return void 0!==o&&this.videoBuffer&&this.videoTimestampOffset!==o&&(h1({type:"video",sourceUpdater:this,action:i1(o),name:"timestampOffset"}),this.videoTimestampOffset_=o),this.videoTimestampOffset_}},{key:"audioQueueCallback",value:function audioQueueCallback(o){this.audioBuffer&&h1({type:"audio",sourceUpdater:this,action:a1(o),name:"callback"})}},{key:"videoQueueCallback",value:function videoQueueCallback(o){this.videoBuffer&&h1({type:"video",sourceUpdater:this,action:a1(o),name:"callback"})}},{key:"dispose",value:function dispose(){var o=this;this.trigger("dispose"),Q0.forEach((function(s){o.abort(s),o.canRemoveSourceBuffer()?o.removeSourceBuffer(s):o["".concat(s,"QueueCallback")]((function(){return e1(s,o)}))})),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}],[{key:"canChangeType",value:function canChangeType(){return $V.SourceBuffer&&$V.SourceBuffer.prototype&&"function"==typeof $V.SourceBuffer.prototype.changeType}}]),SourceUpdater}(videojs.EventTarget),g1=function uint8ToUtf8(o){return decodeURIComponent(escape(String.fromCharCode.apply(null,o)))},m1=new Uint8Array("\n\n".split("").map((function(o){return o.charCodeAt(0)}))),y1=function(o){_inherits$1(NoVttJsError,o);var s=_createSuper$1(NoVttJsError);function NoVttJsError(){return _classCallCheck$1(this,NoVttJsError),s.call(this,"Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}return _createClass$1(NoVttJsError)}(_wrapNativeSuper(Error)),v1=function(o){_inherits$1(VTTSegmentLoader,o);var s=_createSuper$1(VTTSegmentLoader);function VTTSegmentLoader(o){var m,_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck$1(this,VTTSegmentLoader),(m=s.call(this,o,_)).mediaSource_=null,m.subtitlesTrack_=null,m.loaderType_="subtitle",m.featuresNativeTextTracks_=o.featuresNativeTextTracks,m.loadVttJs=o.loadVttJs,m.shouldSaveSegmentTimingInfo_=!1,m}return _createClass$1(VTTSegmentLoader,[{key:"createTransmuxer_",value:function createTransmuxer_(){return null}},{key:"buffered_",value:function buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return createTimeRanges$2();var o=this.subtitlesTrack_.cues;return createTimeRanges$2([[o[0].startTime,o[o.length-1].startTime]])}},{key:"initSegmentForMap",value:function initSegmentForMap(o){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!o)return null;var m=MZ(o),_=this.initSegments_[m];if(s&&!_&&o.bytes){var S=m1.byteLength+o.bytes.byteLength,E=new Uint8Array(S);E.set(o.bytes),E.set(m1,o.bytes.byteLength),this.initSegments_[m]=_={resolvedUri:o.resolvedUri,byterange:o.byterange,bytes:E}}return _||o}},{key:"couldBeginLoading_",value:function couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function track(o){return void 0===o||(this.subtitlesTrack_=o,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}},{key:"remove",value:function remove(o,s){j0(o,s,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function fillBuffer_(){var o=this,s=this.chooseNextRequest_();if(s){if(null===this.syncController_.timestampOffsetForTimeline(s.timeline)){return this.syncController_.one("timestampoffset",(function checkTimestampOffset(){o.state="READY",o.paused()||o.monitorBuffer_()})),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(s)}}},{key:"timestampOffsetForSegment_",value:function timestampOffsetForSegment_(){return null}},{key:"chooseNextRequest_",value:function chooseNextRequest_(){return this.skipEmptySegments_(_get$1(_getPrototypeOf$1(VTTSegmentLoader.prototype),"chooseNextRequest_",this).call(this))}},{key:"skipEmptySegments_",value:function skipEmptySegments_(o){for(;o&&o.segment.empty;){if(o.mediaIndex+1>=o.playlist.segments.length){o=null;break}o=this.generateSegmentInfo_({playlist:o.playlist,mediaIndex:o.mediaIndex+1,startOfSegment:o.startOfSegment+o.duration,isSyncRequest:o.isSyncRequest})}return o}},{key:"stopForError",value:function stopForError(o){this.error(o),this.state="READY",this.pause(),this.trigger("error")}},{key:"segmentRequestFinished_",value:function segmentRequestFinished_(o,s,m){var _=this;if(this.subtitlesTrack_){if(this.saveTransferStats_(s.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(o)return o.code===d0&&this.handleTimeout_(),o.code===h0?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(o);var S=this.pendingSegment_;this.saveBandwidthRelatedStats_(S.duration,s.stats),s.key&&this.segmentKey(s.key,!0),this.state="APPENDING",this.trigger("appending");var E=S.segment;if(E.map&&(E.map.bytes=s.map.bytes),S.bytes=s.bytes,"function"!=typeof $V.WebVTT&&"function"==typeof this.loadVttJs)return this.state="WAITING_ON_VTTJS",void this.loadVttJs().then((function(){return _.segmentRequestFinished_(o,s,m)}),(function(){return _.stopForError({message:"Error loading vtt.js"})}));E.requested=!0;try{this.parseVTTCues_(S)}catch(o){return void this.stopForError({message:o.message})}if(this.updateTimeMapping_(S,this.syncController_.timelines[S.timeline],this.playlist_),S.cues.length?S.timingInfo={start:S.cues[0].startTime,end:S.cues[S.cues.length-1].endTime}:S.timingInfo={start:S.startOfSegment,end:S.startOfSegment+S.duration},S.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");S.byteLength=S.bytes.byteLength,this.mediaSecondsLoaded+=E.duration,S.cues.forEach((function(o){_.subtitlesTrack_.addCue(_.featuresNativeTextTracks_?new $V.VTTCue(o.startTime,o.endTime,o.text):o)})),function removeDuplicateCuesFromTrack(o){var s=o.cues;if(s)for(var m={},_=s.length-1;_>=0;_--){var S=s[_],E="".concat(S.startTime,"-").concat(S.endTime,"-").concat(S.text);m[E]?o.removeCue(S):m[E]=S}}(this.subtitlesTrack_),this.handleAppendsDone_()}else this.state="READY"}},{key:"handleData_",value:function handleData_(){}},{key:"updateTimingInfoEnd_",value:function updateTimingInfoEnd_(){}},{key:"parseVTTCues_",value:function parseVTTCues_(o){var s,m=!1;if("function"!=typeof $V.WebVTT)throw new y1;"function"==typeof $V.TextDecoder?s=new $V.TextDecoder("utf8"):(s=$V.WebVTT.StringDecoder(),m=!0);var _=new $V.WebVTT.Parser($V,$V.vttjs,s);if(o.cues=[],o.timestampmap={MPEGTS:0,LOCAL:0},_.oncue=o.cues.push.bind(o.cues),_.ontimestampmap=function(s){o.timestampmap=s},_.onparsingerror=function(o){videojs.log.warn("Error encountered when parsing cues: "+o.message)},o.segment.map){var S=o.segment.map.bytes;m&&(S=g1(S)),_.parse(S)}var E=o.bytes;m&&(E=g1(E)),_.parse(E),_.flush()}},{key:"updateTimeMapping_",value:function updateTimeMapping_(o,s,m){var _=this,S=o.segment;if(s)if(o.cues.length){var E=o.timestampmap,A=E.MPEGTS,O=E.LOCAL,H=A/TG-O+s.mapping;if(o.cues.forEach((function(o){var m=o.endTime-o.startTime,S=0===A?o.startTime+H:_.handleRollover_(o.startTime+H,s.time);o.startTime=Math.max(S,0),o.endTime=Math.max(S+m,0)})),!m.syncInfo){var K=o.cues[0].startTime,z=o.cues[o.cues.length-1].startTime;m.syncInfo={mediaSequence:m.mediaSequence+o.mediaIndex,time:Math.min(K,z-S.duration)}}}else S.empty=!0}},{key:"handleRollover_",value:function handleRollover_(o,s){if(null===s)return o;var m,_=o*TG,S=s*TG;for(m=S<_?-8589934592:8589934592;Math.abs(_-S)>4294967296;)_+=m;return _/TG}}]),VTTSegmentLoader}(q0),_1=function findAdCue(o,s){for(var m=o.cues,_=0;_<m.length;_++){var S=m[_];if(s>=S.adStartTime&&s<=S.adEndTime)return S}return null},b1=[{name:"VOD",run:function run(o,s,m,_,S){if(m!==1/0){return{time:0,segmentIndex:0,partIndex:null}}return null}},{name:"MediaSequence",run:function run(o,s,m,_,S,E){if(!E)return null;var A=o.getMediaSequenceMap(E);if(!A||0===A.size)return null;if(void 0===s.mediaSequence||!Array.isArray(s.segments)||!s.segments.length)return null;var O,H=s.mediaSequence,K=0,z=_createForOfIteratorHelper(s.segments);try{for(z.s();!(O=z.n()).done;){var G=O.value,q=A.get(H);if(!q)break;if(S>=q.start&&S<q.end){if(Array.isArray(G.parts)&&G.parts.length){var X,J=q.start,ae=0,pe=_createForOfIteratorHelper(G.parts);try{for(pe.s();!(X=pe.n()).done;){var me=X.value,_e=J,Se=_e+me.duration;if(S>=_e&&S<Se)return{time:q.start,segmentIndex:K,partIndex:ae};ae++,J=Se}}catch(o){pe.e(o)}finally{pe.f()}}return{time:q.start,segmentIndex:K,partIndex:null}}K++,H++}}catch(o){z.e(o)}finally{z.f()}return null}},{name:"ProgramDateTime",run:function run(o,s,m,_,S){if(!Object.keys(o.timelineToDatetimeMappings).length)return null;var E=null,A=null,O=XJ(s);S=S||0;for(var H=0;H<O.length;H++){var K=O[s.endList||0===S?H:O.length-(H+1)],z=K.segment,G=o.timelineToDatetimeMappings[z.timeline];if(G&&z.dateTimeObject){var q=z.dateTimeObject.getTime()/1e3+G;if(z.parts&&"number"==typeof K.partIndex)for(var X=0;X<K.partIndex;X++)q+=z.parts[X].duration;var J=Math.abs(S-q);if(null!==A&&(0===J||A<J))break;A=J,E={time:q,segmentIndex:K.segmentIndex,partIndex:K.partIndex}}}return E}},{name:"Segment",run:function run(o,s,m,_,S){var E=null,A=null;S=S||0;for(var O=XJ(s),H=0;H<O.length;H++){var K=O[s.endList||0===S?H:O.length-(H+1)],z=K.segment,G=K.part&&K.part.start||z&&z.start;if(z.timeline===_&&void 0!==G){var q=Math.abs(S-G);if(null!==A&&A<q)break;(!E||null===A||A>=q)&&(A=q,E={time:G,segmentIndex:K.segmentIndex,partIndex:K.partIndex})}}return E}},{name:"Discontinuity",run:function run(o,s,m,_,S){var E=null;if(S=S||0,s.discontinuityStarts&&s.discontinuityStarts.length)for(var A=null,O=0;O<s.discontinuityStarts.length;O++){var H=s.discontinuityStarts[O],K=s.discontinuitySequence+O+1,z=o.discontinuities[K];if(z){var G=Math.abs(S-z.time);if(null!==A&&A<G)break;(!E||null===A||A>=G)&&(A=G,E={time:z.time,segmentIndex:H,partIndex:null})}}return E}},{name:"Playlist",run:function run(o,s,m,_,S){return s.syncInfo?{time:s.syncInfo.time,segmentIndex:s.syncInfo.mediaSequence-s.mediaSequence,partIndex:null}:null}}],S1=function(o){_inherits$1(SyncController,o);var s=_createSuper$1(SyncController);function SyncController(){var o;return _classCallCheck$1(this,SyncController),(o=s.call(this)).timelines=[],o.discontinuities=[],o.timelineToDatetimeMappings={},o.mediaSequenceStorage_=new Map,o.logger_=UJ("SyncController"),o}return _createClass$1(SyncController,[{key:"getMediaSequenceMap",value:function getMediaSequenceMap(o){return this.mediaSequenceStorage_.get(o)}},{key:"updateMediaSequenceMap",value:function updateMediaSequenceMap(o,s,m){if(void 0!==o.mediaSequence&&Array.isArray(o.segments)&&o.segments.length){var _,S=this.getMediaSequenceMap(m),E=new Map,A=o.mediaSequence;S?S.has(o.mediaSequence)?_=S.get(o.mediaSequence).start:(this.logger_("MediaSequence sync for ".concat(m," segment loader - received a gap between playlists.\nFallback base time to: ").concat(s,".\nReceived media sequence: ").concat(A,".\nCurrent map: "),S),_=s):_=0,this.logger_("MediaSequence sync for ".concat(m," segment loader.\nReceived media sequence: ").concat(A,".\nbase time is ").concat(_,"\nCurrent map: "),S),o.segments.forEach((function(o){var s=_,m=s+o.duration,S={start:s,end:m};E.set(A,S),A++,_=m})),this.mediaSequenceStorage_.set(m,E)}}},{key:"getSyncPoint",value:function getSyncPoint(o,s,m,_,S){if(s!==1/0)return b1.find((function(o){return"VOD"===o.name})).run(this,o,s);var E=this.runStrategies_(o,s,m,_,S);if(!E.length)return null;var A,O=_createForOfIteratorHelper(E);try{for(O.s();!(A=O.n()).done;){var H=A.value,K=H.syncPoint,z=H.strategy,G=K.segmentIndex,q=K.time;if(!(G<0)){var X=o.segments[G],J=q,ae=J+X.duration;if(this.logger_("Strategy: ".concat(z,". Current time: ").concat(_,". selected segment: ").concat(G,". Time: [").concat(J," -> ").concat(ae,"]}")),_>=J&&_<ae)return this.logger_("Found sync point with exact match: ",K),K}}}catch(o){O.e(o)}finally{O.f()}return this.selectSyncPoint_(E,{key:"time",value:_})}},{key:"getExpiredTime",value:function getExpiredTime(o,s){if(!o||!o.segments)return null;var m=this.runStrategies_(o,s,o.discontinuitySequence,0,"main");if(!m.length)return null;var _=this.selectSyncPoint_(m,{key:"segmentIndex",value:0});return _.segmentIndex>0&&(_.time*=-1),Math.abs(_.time+tZ({defaultDuration:o.targetDuration,durationList:o.segments,startIndex:_.segmentIndex,endIndex:0}))}},{key:"runStrategies_",value:function runStrategies_(o,s,m,_,S){for(var E=[],A=0;A<b1.length;A++){var O=b1[A],H=O.run(this,o,s,m,_,S);H&&(H.strategy=O.name,E.push({strategy:O.name,syncPoint:H}))}return E}},{key:"selectSyncPoint_",value:function selectSyncPoint_(o,s){for(var m=o[0].syncPoint,_=Math.abs(o[0].syncPoint[s.key]-s.value),S=o[0].strategy,E=1;E<o.length;E++){var A=Math.abs(o[E].syncPoint[s.key]-s.value);A<_&&(_=A,m=o[E].syncPoint,S=o[E].strategy)}return this.logger_("syncPoint for [".concat(s.key,": ").concat(s.value,"] chosen with strategy")+" [".concat(S,"]: [time:").concat(m.time,",")+" segmentIndex:".concat(m.segmentIndex)+("number"==typeof m.partIndex?",partIndex:".concat(m.partIndex):"")+"]"),m}},{key:"saveExpiredSegmentInfo",value:function saveExpiredSegmentInfo(o,s){var m=s.mediaSequence-o.mediaSequence;if(m>86400)videojs.log.warn("Not saving expired segment info. Media sequence gap ".concat(m," is too large."));else for(var _=m-1;_>=0;_--){var S=o.segments[_];if(S&&void 0!==S.start){s.syncInfo={mediaSequence:o.mediaSequence+_,time:S.start},this.logger_("playlist refresh sync: [time:".concat(s.syncInfo.time,",")+" mediaSequence: ".concat(s.syncInfo.mediaSequence,"]")),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMappingForStart",value:function setDateTimeMappingForStart(o){if(this.timelineToDatetimeMappings={},o.segments&&o.segments.length&&o.segments[0].dateTimeObject){var s=o.segments[0],m=s.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[s.timeline]=-m}}},{key:"saveSegmentTimingInfo",value:function saveSegmentTimingInfo(o){var s=o.segmentInfo,m=o.shouldSaveTimelineMapping,_=this.calculateSegmentTimeMapping_(s,s.timingInfo,m),S=s.segment;_&&(this.saveDiscontinuitySyncInfo_(s),s.playlist.syncInfo||(s.playlist.syncInfo={mediaSequence:s.playlist.mediaSequence+s.mediaIndex,time:S.start}));var E=S.dateTimeObject;S.discontinuity&&m&&E&&(this.timelineToDatetimeMappings[S.timeline]=-E.getTime()/1e3)}},{key:"timestampOffsetForTimeline",value:function timestampOffsetForTimeline(o){return void 0===this.timelines[o]?null:this.timelines[o].time}},{key:"mappingForTimeline",value:function mappingForTimeline(o){return void 0===this.timelines[o]?null:this.timelines[o].mapping}},{key:"calculateSegmentTimeMapping_",value:function calculateSegmentTimeMapping_(o,s,m){var _,S,E=o.segment,A=o.part,O=this.timelines[o.timeline];if("number"==typeof o.timestampOffset)O={time:o.startOfSegment,mapping:o.startOfSegment-s.start},m&&(this.timelines[o.timeline]=O,this.trigger("timestampoffset"),this.logger_("time mapping for timeline ".concat(o.timeline,": ")+"[time: ".concat(O.time,"] [mapping: ").concat(O.mapping,"]"))),_=o.startOfSegment,S=s.end+O.mapping;else{if(!O)return!1;_=s.start+O.mapping,S=s.end+O.mapping}return A&&(A.start=_,A.end=S),(!E.start||_<E.start)&&(E.start=_),E.end=S,!0}},{key:"saveDiscontinuitySyncInfo_",value:function saveDiscontinuitySyncInfo_(o){var s=o.playlist,m=o.segment;if(m.discontinuity)this.discontinuities[m.timeline]={time:m.start,accuracy:0};else if(s.discontinuityStarts&&s.discontinuityStarts.length)for(var _=0;_<s.discontinuityStarts.length;_++){var S=s.discontinuityStarts[_],E=s.discontinuitySequence+_+1,A=S-o.mediaIndex,O=Math.abs(A);if(!this.discontinuities[E]||this.discontinuities[E].accuracy>O){var H=void 0;H=A<0?m.start-tZ({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:o.mediaIndex,endIndex:S}):m.end+tZ({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:o.mediaIndex+1,endIndex:S}),this.discontinuities[E]={time:H,accuracy:O}}}}},{key:"dispose",value:function dispose(){this.trigger("dispose"),this.off()}}]),SyncController}(videojs.EventTarget),T1=function(o){_inherits$1(TimelineChangeController,o);var s=_createSuper$1(TimelineChangeController);function TimelineChangeController(){var o;return _classCallCheck$1(this,TimelineChangeController),(o=s.call(this)).pendingTimelineChanges_={},o.lastTimelineChanges_={},o}return _createClass$1(TimelineChangeController,[{key:"clearPendingTimelineChange",value:function clearPendingTimelineChange(o){this.pendingTimelineChanges_[o]=null,this.trigger("pendingtimelinechange")}},{key:"pendingTimelineChange",value:function pendingTimelineChange(o){var s=o.type,m=o.from,_=o.to;return"number"==typeof m&&"number"==typeof _&&(this.pendingTimelineChanges_[s]={type:s,from:m,to:_},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[s]}},{key:"lastTimelineChange",value:function lastTimelineChange(o){var s=o.type,m=o.from,_=o.to;return"number"==typeof m&&"number"==typeof _&&(this.lastTimelineChanges_[s]={type:s,from:m,to:_},delete this.pendingTimelineChanges_[s],this.trigger("timelinechange")),this.lastTimelineChanges_[s]}},{key:"dispose",value:function dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}]),TimelineChangeController}(videojs.EventTarget),k1=JZ(ZZ((function(){var o=function(){function Stream(){this.listeners={}}var o=Stream.prototype;return o.on=function on(o,s){this.listeners[o]||(this.listeners[o]=[]),this.listeners[o].push(s)},o.off=function off(o,s){if(!this.listeners[o])return!1;var m=this.listeners[o].indexOf(s);return this.listeners[o]=this.listeners[o].slice(0),this.listeners[o].splice(m,1),m>-1},o.trigger=function trigger(o){var s=this.listeners[o];if(s)if(2===arguments.length)for(var m=s.length,_=0;_<m;++_)s[_].call(this,arguments[1]);else for(var S=Array.prototype.slice.call(arguments,1),E=s.length,A=0;A<E;++A)s[A].apply(this,S)},o.dispose=function dispose(){this.listeners={}},o.pipe=function pipe(o){this.on("data",(function(s){o.push(s)}))},Stream}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */ /*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */
var s,m=null,_=function(){function AES(o){var s,_,S;_classCallCheck$1(this,AES),m||(m=function precompute(){var o,s,m,_,S,E,A,O,H=[[[],[],[],[],[]],[[],[],[],[],[]]],K=H[0],z=H[1],G=K[4],q=z[4],X=[],J=[];for(o=0;o<256;o++)J[(X[o]=o<<1^283*(o>>7))^o]=o;for(s=m=0;!G[s];s^=_||1,m=J[m]||1)for(E=(E=m^m<<1^m<<2^m<<3^m<<4)>>8^255&E^99,G[s]=E,q[E]=s,O=16843009*X[S=X[_=X[s]]]^65537*S^257*_^16843008*s,A=257*X[E]^16843008*E,o=0;o<4;o++)K[o][s]=A=A<<24^A>>>8,z[o][E]=O=O<<24^O>>>8;for(o=0;o<5;o++)K[o]=K[o].slice(0),z[o]=z[o].slice(0);return H}()),this._tables=[[m[0][0].slice(),m[0][1].slice(),m[0][2].slice(),m[0][3].slice(),m[0][4].slice()],[m[1][0].slice(),m[1][1].slice(),m[1][2].slice(),m[1][3].slice(),m[1][4].slice()]];var E=this._tables[0][4],A=this._tables[1],O=o.length,H=1;if(4!==O&&6!==O&&8!==O)throw new Error("Invalid aes key size");var K=o.slice(0),z=[];for(this._key=[K,z],s=O;s<4*O+28;s++)S=K[s-1],(s%O==0||8===O&&s%O==4)&&(S=E[S>>>24]<<24^E[S>>16&255]<<16^E[S>>8&255]<<8^E[255&S],s%O==0&&(S=S<<8^S>>>24^H<<24,H=H<<1^283*(H>>7))),K[s]=K[s-O]^S;for(_=0;s;_++,s--)S=K[3&_?s:s-4],z[_]=s<=4||_<4?S:A[0][E[S>>>24]]^A[1][E[S>>16&255]]^A[2][E[S>>8&255]]^A[3][E[255&S]]}return _createClass$1(AES,[{key:"decrypt",value:function decrypt(o,s,m,_,S,E){var A,O,H,K,z=this._key[1],G=o^z[0],q=_^z[1],X=m^z[2],J=s^z[3],ae=z.length/4-2,pe=4,me=this._tables[1],_e=me[0],Se=me[1],Ee=me[2],De=me[3],$e=me[4];for(K=0;K<ae;K++)A=_e[G>>>24]^Se[q>>16&255]^Ee[X>>8&255]^De[255&J]^z[pe],O=_e[q>>>24]^Se[X>>16&255]^Ee[J>>8&255]^De[255&G]^z[pe+1],H=_e[X>>>24]^Se[J>>16&255]^Ee[G>>8&255]^De[255&q]^z[pe+2],J=_e[J>>>24]^Se[G>>16&255]^Ee[q>>8&255]^De[255&X]^z[pe+3],pe+=4,G=A,q=O,X=H;for(K=0;K<4;K++)S[(3&-K)+E]=$e[G>>>24]<<24^$e[q>>16&255]<<16^$e[X>>8&255]<<8^$e[255&J]^z[pe++],A=G,G=q,q=X,X=J,J=A}}]),AES}(),S=function(s){_inherits$1(AsyncStream,s);var m=_createSuper$1(AsyncStream);function AsyncStream(){var s;return _classCallCheck$1(this,AsyncStream),(s=m.call(this,o)).jobs=[],s.delay=1,s.timeout_=null,s}return _createClass$1(AsyncStream,[{key:"processJob_",value:function processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}},{key:"push",value:function push(o){this.jobs.push(o),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}]),AsyncStream}(o),E=function ntoh(o){return o<<24|(65280&o)<<8|(16711680&o)>>8|o>>>24},A=function(){function Decrypter(o,s,m,_){_classCallCheck$1(this,Decrypter);var A=Decrypter.STEP,O=new Int32Array(o.buffer),H=new Uint8Array(o.byteLength),K=0;for(this.asyncStream_=new S,this.asyncStream_.push(this.decryptChunk_(O.subarray(K,K+A),s,m,H)),K=A;K<O.length;K+=A)m=new Uint32Array([E(O[K-4]),E(O[K-3]),E(O[K-2]),E(O[K-1])]),this.asyncStream_.push(this.decryptChunk_(O.subarray(K,K+A),s,m,H));this.asyncStream_.push((function(){_(null,function unpad(o){return o.subarray(0,o.byteLength-o[o.byteLength-1])}(H))}))}return _createClass$1(Decrypter,[{key:"decryptChunk_",value:function decryptChunk_(o,s,m,S){return function(){var A=function decrypt(o,s,m){var S,A,O,H,K,z,G,q,X,J=new Int32Array(o.buffer,o.byteOffset,o.byteLength>>2),ae=new _(Array.prototype.slice.call(s)),pe=new Uint8Array(o.byteLength),me=new Int32Array(pe.buffer);for(S=m[0],A=m[1],O=m[2],H=m[3],X=0;X<J.length;X+=4)K=E(J[X]),z=E(J[X+1]),G=E(J[X+2]),q=E(J[X+3]),ae.decrypt(K,z,G,q,me,X),me[X]=E(me[X]^S),me[X+1]=E(me[X+1]^A),me[X+2]=E(me[X+2]^O),me[X+3]=E(me[X+3]^H),S=K,A=z,O=G,H=q;return pe}(o,s,m);S.set(A,o.byteOffset)}}}],[{key:"STEP",get:function get(){return 32e3}}]),Decrypter}(),O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};s="undefined"!=typeof window?window:void 0!==O?O:"undefined"!=typeof self?self:{};var H=s.BigInt||Number;H("0x1"),H("0x100"),H("0x10000"),H("0x1000000"),H("0x100000000"),H("0x10000000000"),H("0x1000000000000"),H("0x100000000000000"),H("0x10000000000000000"),function(){var o=new Uint16Array([65484]),s=new Uint8Array(o.buffer,o.byteOffset,o.byteLength);255===s[0]||s[0]}();var K=function createTransferableMessage(o){var s={};return Object.keys(o).forEach((function(m){var _=o[m];!function isArrayBufferView(o){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(o):o&&o.buffer instanceof ArrayBuffer}(_)?s[m]=_:s[m]={bytes:_.buffer,byteOffset:_.byteOffset,byteLength:_.byteLength}})),s};self.onmessage=function(o){var s=o.data,m=new Uint8Array(s.encrypted.bytes,s.encrypted.byteOffset,s.encrypted.byteLength),_=new Uint32Array(s.key.bytes,s.key.byteOffset,s.key.byteLength/4),S=new Uint32Array(s.iv.bytes,s.iv.byteOffset,s.iv.byteLength/4);new A(m,_,S,(function(o,m){self.postMessage(K({source:s.source,decrypted:m}),[m.buffer])}))}}))),C1=QZ(k1),w1=function audioTrackKind_(o){var s=o.default?"main":"alternative";return o.characteristics&&o.characteristics.indexOf("public.accessibility.describes-video")>=0&&(s="main-desc"),s},x1=function stopLoaders(o,s){o.abort(),o.pause(),s&&s.activePlaylistLoader&&(s.activePlaylistLoader.pause(),s.activePlaylistLoader=null)},E1=function startLoaders(o,s){s.activePlaylistLoader=o,o.load()},I1={AUDIO:function AUDIO(o,s){return function(){var m=s.mediaTypes[o],_=s.excludePlaylist,S=m.activeTrack(),E=m.activeGroup(),A=(E.filter((function(o){return o.default}))[0]||E[0]).id,O=m.tracks[A];if(S!==O){for(var H in videojs.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),m.tracks)m.tracks[H].enabled=m.tracks[H]===O;m.onTrackChanged()}else _({error:{message:"Problem encountered loading the default audio track."}})}},SUBTITLES:function SUBTITLES(o,s){return function(){var m=s.mediaTypes[o];videojs.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");var _=m.activeTrack();_&&(_.mode="disabled"),m.onTrackChanged()}}},A1={AUDIO:function AUDIO(o,s,m){if(s){var _=m.tech,S=m.requestOptions,E=m.segmentLoaders[o];s.on("loadedmetadata",(function(){var o=s.media();E.playlist(o,S),(!_.paused()||o.endList&&"none"!==_.preload())&&E.load()})),s.on("loadedplaylist",(function(){E.playlist(s.media(),S),_.paused()||E.load()})),s.on("error",I1[o](o,m))}},SUBTITLES:function SUBTITLES(o,s,m){var _=m.tech,S=m.requestOptions,E=m.segmentLoaders[o],A=m.mediaTypes[o];s.on("loadedmetadata",(function(){var o=s.media();E.playlist(o,S),E.track(A.activeTrack()),(!_.paused()||o.endList&&"none"!==_.preload())&&E.load()})),s.on("loadedplaylist",(function(){E.playlist(s.media(),S),_.paused()||E.load()})),s.on("error",I1[o](o,m))}},P1={AUDIO:function AUDIO(o,s){var m=s.vhs,_=s.sourceType,S=s.segmentLoaders[o],E=s.requestOptions,A=s.main.mediaGroups,O=s.mediaTypes[o],H=O.groups,K=O.tracks,z=O.logger_,G=s.mainPlaylistLoader,q=cZ(G.main);for(var X in A[o]&&0!==Object.keys(A[o]).length||(A[o]={main:{default:{default:!0}}},q&&(A[o].main.default.playlists=G.main.playlists)),A[o])for(var J in H[X]||(H[X]=[]),A[o][X]){var ae=A[o][X][J],pe=void 0;if(q?(z("AUDIO group '".concat(X,"' label '").concat(J,"' is a main playlist")),ae.isMainPlaylist=!0,pe=null):pe="vhs-json"===_&&ae.playlists?new xZ(ae.playlists[0],m,E):ae.resolvedUri?new xZ(ae.resolvedUri,m,E):ae.playlists&&"dash"===_?new qZ(ae.playlists[0],m,E,G):null,ae=merge$2({id:J,playlistLoader:pe},ae),A1[o](o,ae.playlistLoader,s),H[X].push(ae),void 0===K[J]){var me=new videojs.AudioTrack({id:J,kind:w1(ae),enabled:!1,language:ae.language,default:ae.default,label:J});K[J]=me}}S.on("error",I1[o](o,s))},SUBTITLES:function SUBTITLES(o,s){var m=s.tech,_=s.vhs,S=s.sourceType,E=s.segmentLoaders[o],A=s.requestOptions,O=s.main.mediaGroups,H=s.mediaTypes[o],K=H.groups,z=H.tracks,G=s.mainPlaylistLoader;for(var q in O[o])for(var X in K[q]||(K[q]=[]),O[o][q])if(_.options_.useForcedSubtitles||!O[o][q][X].forced){var J=O[o][q][X],ae=void 0;if("hls"===S)ae=new xZ(J.resolvedUri,_,A);else if("dash"===S){var pe=J.playlists.filter((function(o){return o.excludeUntil!==1/0}));if(!pe.length)return;ae=new qZ(J.playlists[0],_,A,G)}else"vhs-json"===S&&(ae=new xZ(J.playlists?J.playlists[0]:J.resolvedUri,_,A));if(J=merge$2({id:X,playlistLoader:ae},J),A1[o](o,J.playlistLoader,s),K[q].push(J),void 0===z[X]){var me=m.addRemoteTextTrack({id:X,kind:"subtitles",default:J.default&&J.autoselect,language:J.language,label:X},!1).track;z[X]=me}}E.on("error",I1[o](o,s))},"CLOSED-CAPTIONS":function CLOSEDCAPTIONS(o,s){var m=s.tech,_=s.main.mediaGroups,S=s.mediaTypes[o],E=S.groups,A=S.tracks;for(var O in _[o])for(var H in E[O]||(E[O]=[]),_[o][O]){var K=_[o][O][H];if(/^(?:CC|SERVICE)/.test(K.instreamId)){var z=m.options_.vhs&&m.options_.vhs.captionServices||{},G={label:H,language:K.language,instreamId:K.instreamId,default:K.default&&K.autoselect};if(z[G.instreamId]&&(G=merge$2(G,z[G.instreamId])),void 0===G.default&&delete G.default,E[O].push(merge$2({id:H},K)),void 0===A[H]){var q=m.addRemoteTextTrack({id:G.instreamId,kind:"captions",default:G.default,language:G.language,label:G.label},!1).track;A[H]=q}}}}},L1=function groupMatch(o,s){for(var m=0;m<o.length;m++){if(uZ(s,o[m]))return!0;if(o[m].playlists&&groupMatch(o[m].playlists,s))return!0}return!1},D1={AUDIO:function AUDIO(o,s){return function(){var m=s.mediaTypes[o].tracks;for(var _ in m)if(m[_].enabled)return m[_];return null}},SUBTITLES:function SUBTITLES(o,s){return function(){var m=s.mediaTypes[o].tracks;for(var _ in m)if("showing"===m[_].mode||"hidden"===m[_].mode)return m[_];return null}}},R1=function setupMediaGroups(o){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(s){P1[s](s,o)}));var s=o.mediaTypes,m=o.mainPlaylistLoader,_=o.tech,S=o.vhs,E=o.segmentLoaders,A=E.AUDIO,O=E.main;["AUDIO","SUBTITLES"].forEach((function(m){s[m].activeGroup=function activeGroup(o,s){return function(m){var _=s.mainPlaylistLoader,S=s.mediaTypes[o].groups,E=_.media();if(!E)return null;var A=null;E.attributes[o]&&(A=S[E.attributes[o]]);var O=Object.keys(S);if(!A)if("AUDIO"===o&&O.length>1&&cZ(s.main))for(var H=0;H<O.length;H++){var K=S[O[H]];if(L1(K,E)){A=K;break}}else S.main?A=S.main:1===O.length&&(A=S[O[0]]);return void 0===m?A:null!==m&&A&&A.filter((function(o){return o.id===m.id}))[0]||null}}(m,o),s[m].activeTrack=D1[m](m,o),s[m].onGroupChanged=function onGroupChanged(o,s){return function(){var m=s.segmentLoaders,_=m[o],S=m.main,E=s.mediaTypes[o],A=E.activeTrack(),O=E.getActiveGroup(),H=E.activePlaylistLoader,K=E.lastGroup_;O&&K&&O.id===K.id||(E.lastGroup_=O,E.lastTrack_=A,x1(_,E),O&&!O.isMainPlaylist&&(O.playlistLoader?(_.resyncLoader(),E1(O.playlistLoader,E)):H&&S.resetEverything()))}}(m,o),s[m].onGroupChanging=function onGroupChanging(o,s){return function(){var m=s.segmentLoaders[o];s.mediaTypes[o].lastGroup_=null,m.abort(),m.pause()}}(m,o),s[m].onTrackChanged=function onTrackChanged(o,s){return function(){var m=s.mainPlaylistLoader,_=s.segmentLoaders,S=_[o],E=_.main,A=s.mediaTypes[o],O=A.activeTrack(),H=A.getActiveGroup(),K=A.activePlaylistLoader,z=A.lastTrack_;if((!z||!O||z.id!==O.id)&&(A.lastGroup_=H,A.lastTrack_=O,x1(S,A),H)){if(H.isMainPlaylist){if(!O||!z||O.id===z.id)return;var G=s.vhs.playlistController_,q=G.selectPlaylist();if(G.media()===q)return;return A.logger_("track change. Switching main audio from ".concat(z.id," to ").concat(O.id)),m.pause(),E.resetEverything(),void G.fastQualityChange_(q)}if("AUDIO"===o){if(!H.playlistLoader)return E.setAudio(!0),void E.resetEverything();S.setAudio(!0),E.setAudio(!1)}K!==H.playlistLoader?(S.track&&S.track(O),S.resetEverything(),E1(H.playlistLoader,A)):E1(H.playlistLoader,A)}}}(m,o),s[m].getActiveGroup=function getActiveGroup(o,s){var m=s.mediaTypes;return function(){var s=m[o].activeTrack();return s?m[o].activeGroup(s):null}}(m,o)}));var H=s.AUDIO.activeGroup();if(H){var K=(H.filter((function(o){return o.default}))[0]||H[0]).id;s.AUDIO.tracks[K].enabled=!0,s.AUDIO.onGroupChanged(),s.AUDIO.onTrackChanged(),s.AUDIO.getActiveGroup().playlistLoader?(O.setAudio(!1),A.setAudio(!0)):O.setAudio(!0)}m.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(o){return s[o].onGroupChanged()}))})),m.on("mediachanging",(function(){["AUDIO","SUBTITLES"].forEach((function(o){return s[o].onGroupChanging()}))}));var z=function onAudioTrackChanged(){s.AUDIO.onTrackChanged(),_.trigger({type:"usage",name:"vhs-audio-change"})};for(var G in _.audioTracks().addEventListener("change",z),_.remoteTextTracks().addEventListener("change",s.SUBTITLES.onTrackChanged),S.on("dispose",(function(){_.audioTracks().removeEventListener("change",z),_.remoteTextTracks().removeEventListener("change",s.SUBTITLES.onTrackChanged)})),_.clearTracks("audio"),s.AUDIO.tracks)_.audioTracks().addTrack(s.AUDIO.tracks[G])},O1=function(){function SteeringManifest(){_classCallCheck$1(this,SteeringManifest),this.priority_=[],this.pathwayClones_=new Map}return _createClass$1(SteeringManifest,[{key:"version",get:function get(){return this.version_},set:function set(o){1===o&&(this.version_=o)}},{key:"ttl",get:function get(){return this.ttl_},set:function set(o){this.ttl_=o||300}},{key:"reloadUri",get:function get(){return this.reloadUri_},set:function set(o){o&&(this.reloadUri_=FJ(this.reloadUri_,o))}},{key:"priority",get:function get(){return this.priority_},set:function set(o){o&&o.length&&(this.priority_=o)}},{key:"pathwayClones",get:function get(){return this.pathwayClones_},set:function set(o){o&&o.length&&(this.pathwayClones_=new Map(o.map((function(o){return[o.ID,o]}))))}}]),SteeringManifest}(),M1=function(o){_inherits$1(ContentSteeringController,o);var s=_createSuper$1(ContentSteeringController);function ContentSteeringController(o,m){var _;return _classCallCheck$1(this,ContentSteeringController),(_=s.call(this)).currentPathway=null,_.defaultPathway=null,_.queryBeforeStart=!1,_.availablePathways_=new Set,_.steeringManifest=new O1,_.proxyServerUrl_=null,_.manifestType_=null,_.ttlTimeout_=null,_.request_=null,_.currentPathwayClones=new Map,_.nextPathwayClones=new Map,_.excludedSteeringManifestURLs=new Set,_.logger_=UJ("Content Steering"),_.xhr_=o,_.getBandwidth_=m,_}return _createClass$1(ContentSteeringController,[{key:"assignTagProperties",value:function assignTagProperties(o,s){this.manifestType_=s.serverUri?"HLS":"DASH";var m=s.serverUri||s.serverURL;if(!m)return this.logger_("steering manifest URL is ".concat(m,", cannot request steering manifest.")),void this.trigger("error");m.startsWith("data:")?this.decodeDataUriManifest_(m.substring(m.indexOf(",")+1)):(this.steeringManifest.reloadUri=FJ(o,m),this.defaultPathway=s.pathwayId||s.defaultServiceLocation,this.queryBeforeStart=s.queryBeforeStart,this.proxyServerUrl_=s.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering"))}},{key:"requestSteeringManifest",value:function requestSteeringManifest(o){var s=this,m=this.steeringManifest.reloadUri;if(m){var _=o?m:this.getRequestURI(m);if(!_)return this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),void this.dispose();this.request_=this.xhr_({uri:_},(function(o,m){if(o){if(410===m.status)return s.logger_("manifest request 410 ".concat(o,".")),s.logger_("There will be no more content steering requests to ".concat(_," this session.")),void s.excludedSteeringManifestURLs.add(_);if(429===m.status){var S=m.responseHeaders["retry-after"];return s.logger_("manifest request 429 ".concat(o,".")),s.logger_("content steering will retry in ".concat(S," seconds.")),void s.startTTLTimeout_(parseInt(S,10))}return s.logger_("manifest failed to load ".concat(o,".")),void s.startTTLTimeout_()}var E=JSON.parse(s.request_.responseText);s.assignSteeringProperties_(E),s.startTTLTimeout_()}))}}},{key:"setProxyServerUrl_",value:function setProxyServerUrl_(o){var s=new $V.URL(o),m=new $V.URL(this.proxyServerUrl_);return m.searchParams.set("url",encodeURI(s.toString())),this.setSteeringParams_(m.toString())}},{key:"decodeDataUriManifest_",value:function decodeDataUriManifest_(o){var s=JSON.parse($V.atob(o));this.assignSteeringProperties_(s)}},{key:"setSteeringParams_",value:function setSteeringParams_(o){var s=new $V.URL(o),m=this.getPathway(),_=this.getBandwidth_();if(m){var S="_".concat(this.manifestType_,"_pathway");s.searchParams.set(S,m)}if(_){var E="_".concat(this.manifestType_,"_throughput");s.searchParams.set(E,_)}return s.toString()}},{key:"assignSteeringProperties_",value:function assignSteeringProperties_(o){var s=this;if(this.steeringManifest.version=o.VERSION,!this.steeringManifest.version)return this.logger_("manifest version is ".concat(o.VERSION,", which is not supported.")),void this.trigger("error");this.steeringManifest.ttl=o.TTL,this.steeringManifest.reloadUri=o["RELOAD-URI"],this.steeringManifest.priority=o["PATHWAY-PRIORITY"]||o["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=o["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());var m=function chooseNextPathway(o){var m,_=_createForOfIteratorHelper(o);try{for(_.s();!(m=_.n()).done;){var S=m.value;if(s.availablePathways_.has(S))return S}}catch(o){_.e(o)}finally{_.f()}return _toConsumableArray$1(s.availablePathways_)[0]}(this.steeringManifest.priority);this.currentPathway!==m&&(this.currentPathway=m,this.trigger("content-steering"))}},{key:"getPathway",value:function getPathway(){return this.currentPathway||this.defaultPathway}},{key:"getRequestURI",value:function getRequestURI(o){var s=this;if(!o)return null;var m=function isExcluded(o){return s.excludedSteeringManifestURLs.has(o)};if(this.proxyServerUrl_){var _=this.setProxyServerUrl_(o);if(!m(_))return _}var S=this.setSteeringParams_(o);return m(S)?null:S}},{key:"startTTLTimeout_",value:function startTTLTimeout_(){var o=this,s=1e3*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.steeringManifest.ttl);this.ttlTimeout_=$V.setTimeout((function(){o.requestSteeringManifest()}),s)}},{key:"clearTTLTimeout_",value:function clearTTLTimeout_(){$V.clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}},{key:"abort",value:function abort(){this.request_&&this.request_.abort(),this.request_=null}},{key:"dispose",value:function dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new O1}},{key:"addAvailablePathway",value:function addAvailablePathway(o){o&&this.availablePathways_.add(o)}},{key:"clearAvailablePathways",value:function clearAvailablePathways(){this.availablePathways_.clear()}},{key:"excludePathway",value:function excludePathway(o){return this.availablePathways_.delete(o)}},{key:"didDASHTagChange",value:function didDASHTagChange(o,s){return!s&&this.steeringManifest.reloadUri||s&&(FJ(o,s.serverURL)!==this.steeringManifest.reloadUri||s.defaultServiceLocation!==this.defaultPathway||s.queryBeforeStart!==this.queryBeforeStart||s.proxyServerURL!==this.proxyServerUrl_)}},{key:"getAvailablePathways",value:function getAvailablePathways(){return this.availablePathways_}}]),ContentSteeringController}(videojs.EventTarget),F1=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],N1=function sumLoaderStat(o){return this.audioSegmentLoader_[o]+this.mainSegmentLoader_[o]},U1=function(o){_inherits$1(PlaylistController,o);var s=_createSuper$1(PlaylistController);function PlaylistController(o){var m;_classCallCheck$1(this,PlaylistController),m=s.call(this);var _=o.src,S=o.withCredentials,E=o.tech,A=o.bandwidth,O=o.externVhs,H=o.useCueTags,K=o.playlistExclusionDuration,z=o.enableLowInitialPlaylist,G=o.sourceType,q=o.cacheEncryptionKeys,X=o.bufferBasedABR,J=o.leastPixelDiffSelector,ae=o.captionServices;if(!_)throw new Error("A non-empty playlist URL or JSON manifest string is required");var pe=o.maxPlaylistRetries;null==pe&&(pe=1/0),X0=O,m.bufferBasedABR=Boolean(X),m.leastPixelDiffSelector=Boolean(J),m.withCredentials=S,m.tech_=E,m.vhs_=E.vhs,m.sourceType_=G,m.useCueTags_=H,m.playlistExclusionDuration=K,m.maxPlaylistRetries=pe,m.enableLowInitialPlaylist=z,m.useCueTags_&&(m.cueTagsTrack_=m.tech_.addTextTrack("metadata","ad-cues"),m.cueTagsTrack_.inBandMetadataTrackDispatchType=""),m.requestOptions_={withCredentials:S,maxPlaylistRetries:pe,timeout:null},m.on("error",m.pauseLoading),m.mediaTypes_=function createMediaTypes(){var o={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(s){o[s]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:noop$1,activeTrack:noop$1,getActiveGroup:noop$1,onGroupChanged:noop$1,onTrackChanged:noop$1,lastTrack_:null,logger_:UJ("MediaGroups[".concat(s,"]"))}})),o}(),m.mediaSource=new $V.MediaSource,m.handleDurationChange_=m.handleDurationChange_.bind(_assertThisInitialized(m)),m.handleSourceOpen_=m.handleSourceOpen_.bind(_assertThisInitialized(m)),m.handleSourceEnded_=m.handleSourceEnded_.bind(_assertThisInitialized(m)),m.mediaSource.addEventListener("durationchange",m.handleDurationChange_),m.mediaSource.addEventListener("sourceopen",m.handleSourceOpen_),m.mediaSource.addEventListener("sourceended",m.handleSourceEnded_),m.seekable_=createTimeRanges$2(),m.hasPlayed_=!1,m.syncController_=new S1(o),m.segmentMetadataTrack_=E.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,m.decrypter_=new C1,m.sourceUpdater_=new f1(m.mediaSource),m.inbandTextTracks_={},m.timelineChangeController_=new T1,m.keyStatusMap_=new Map;var me={vhs:m.vhs_,parse708captions:o.parse708captions,useDtsForTimestampOffset:o.useDtsForTimestampOffset,captionServices:ae,mediaSource:m.mediaSource,currentTime:m.tech_.currentTime.bind(m.tech_),seekable:function seekable(){return m.seekable()},seeking:function seeking(){return m.tech_.seeking()},duration:function duration(){return m.duration()},hasPlayed:function hasPlayed(){return m.hasPlayed_},goalBufferLength:function goalBufferLength(){return m.goalBufferLength()},bandwidth:A,syncController:m.syncController_,decrypter:m.decrypter_,sourceType:m.sourceType_,inbandTextTracks:m.inbandTextTracks_,cacheEncryptionKeys:q,sourceUpdater:m.sourceUpdater_,timelineChangeController:m.timelineChangeController_,exactManifestTimings:o.exactManifestTimings,addMetadataToTextTrack:m.addMetadataToTextTrack.bind(_assertThisInitialized(m))};m.mainPlaylistLoader_="dash"===m.sourceType_?new qZ(_,m.vhs_,merge$2(m.requestOptions_,{addMetadataToTextTrack:m.addMetadataToTextTrack.bind(_assertThisInitialized(m))})):new xZ(_,m.vhs_,merge$2(m.requestOptions_,{addDateRangesToTextTrack:m.addDateRangesToTextTrack_.bind(_assertThisInitialized(m))})),m.setupMainPlaylistLoaderListeners_(),m.mainSegmentLoader_=new q0(merge$2(me,{segmentMetadataTrack:m.segmentMetadataTrack_,loaderType:"main"}),o),m.audioSegmentLoader_=new q0(merge$2(me,{loaderType:"audio"}),o),m.subtitleSegmentLoader_=new v1(merge$2(me,{loaderType:"vtt",featuresNativeTextTracks:m.tech_.featuresNativeTextTracks,loadVttJs:function loadVttJs(){return new Promise((function(o,s){function onLoad(){E.off("vttjserror",onError),o()}function onError(){E.off("vttjsloaded",onLoad),s()}E.one("vttjsloaded",onLoad),E.one("vttjserror",onError),E.addWebVttScript_()}))}}),o);m.contentSteeringController_=new M1(m.vhs_.xhr,(function getBandwidth(){return m.mainSegmentLoader_.bandwidth})),m.setupSegmentLoaderListeners_(),m.bufferBasedABR&&(m.mainPlaylistLoader_.one("loadedplaylist",(function(){return m.startABRTimer_()})),m.tech_.on("pause",(function(){return m.stopABRTimer_()})),m.tech_.on("play",(function(){return m.startABRTimer_()}))),F1.forEach((function(o){m[o+"_"]=N1.bind(_assertThisInitialized(m),o)})),m.logger_=UJ("pc"),m.triggeredFmp4Usage=!1,"none"===m.tech_.preload()?(m.loadOnPlay_=function(){m.loadOnPlay_=null,m.mainPlaylistLoader_.load()},m.tech_.one("play",m.loadOnPlay_)):m.mainPlaylistLoader_.load(),m.timeToLoadedData__=-1,m.mainAppendsToLoadedData__=-1,m.audioAppendsToLoadedData__=-1;var _e="none"===m.tech_.preload()?"play":"loadstart";return m.tech_.one(_e,(function(){var o=Date.now();m.tech_.one("loadeddata",(function(){m.timeToLoadedData__=Date.now()-o,m.mainAppendsToLoadedData__=m.mainSegmentLoader_.mediaAppends,m.audioAppendsToLoadedData__=m.audioSegmentLoader_.mediaAppends}))})),m}return _createClass$1(PlaylistController,[{key:"mainAppendsToLoadedData_",value:function mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}},{key:"audioAppendsToLoadedData_",value:function audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}},{key:"appendsToLoadedData_",value:function appendsToLoadedData_(){var o=this.mainAppendsToLoadedData_(),s=this.audioAppendsToLoadedData_();return-1===o||-1===s?-1:o+s}},{key:"timeToLoadedData_",value:function timeToLoadedData_(){return this.timeToLoadedData__}},{key:"checkABR_",value:function checkABR_(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"abr",s=this.selectPlaylist();s&&this.shouldSwitchToMedia_(s)&&this.switchMedia_(s,o)}},{key:"switchMedia_",value:function switchMedia_(o,s,m){var _=this.media(),S=_&&(_.id||_.uri),E=o&&(o.id||o.uri);S&&S!==E&&(this.logger_("switch media ".concat(S," -> ").concat(E," from ").concat(s)),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-".concat(s)})),this.mainPlaylistLoader_.media(o,m)}},{key:"switchMediaForDASHContentSteering_",value:function switchMediaForDASHContentSteering_(){var o=this;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(s){var m=o.mediaTypes_[s],_=m?m.activeGroup():null,S=o.contentSteeringController_.getPathway();if(_&&S){var E=(_.length?_[0].playlists:_.playlists).filter((function(o){return o.attributes.serviceLocation===S}));E.length&&o.mediaTypes_[s].activePlaylistLoader.media(E[0])}}))}},{key:"startABRTimer_",value:function startABRTimer_(){var o=this;this.stopABRTimer_(),this.abrTimer_=$V.setInterval((function(){return o.checkABR_()}),250)}},{key:"stopABRTimer_",value:function stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||($V.clearInterval(this.abrTimer_),this.abrTimer_=null)}},{key:"getAudioTrackPlaylists_",value:function getAudioTrackPlaylists_(){var o=this.main(),s=o&&o.playlists||[];if(!o||!o.mediaGroups||!o.mediaGroups.AUDIO)return s;var m,_=o.mediaGroups.AUDIO,S=Object.keys(_);if(Object.keys(this.mediaTypes_.AUDIO.groups).length)m=this.mediaTypes_.AUDIO.activeTrack();else{var E=_.main||S.length&&_[S[0]];for(var A in E)if(E[A].default){m={label:A};break}}if(!m)return s;var O=[];for(var H in _)if(_[H][m.label]){var K=_[H][m.label];if(K.playlists&&K.playlists.length)O.push.apply(O,K.playlists);else if(K.uri)O.push(K);else if(o.playlists.length)for(var z=0;z<o.playlists.length;z++){var G=o.playlists[z];G.attributes&&G.attributes.AUDIO&&G.attributes.AUDIO===H&&O.push(G)}}return O.length?O:s}},{key:"setupMainPlaylistLoaderListeners_",value:function setupMainPlaylistLoaderListeners_(){var o=this;this.mainPlaylistLoader_.on("loadedmetadata",(function(){var s=o.mainPlaylistLoader_.media(),m=1.5*s.targetDuration*1e3;sZ(o.mainPlaylistLoader_.main,o.mainPlaylistLoader_.media())?o.requestOptions_.timeout=0:o.requestOptions_.timeout=m,s.endList&&"none"!==o.tech_.preload()&&(o.mainSegmentLoader_.playlist(s,o.requestOptions_),o.mainSegmentLoader_.load()),R1({sourceType:o.sourceType_,segmentLoaders:{AUDIO:o.audioSegmentLoader_,SUBTITLES:o.subtitleSegmentLoader_,main:o.mainSegmentLoader_},tech:o.tech_,requestOptions:o.requestOptions_,mainPlaylistLoader:o.mainPlaylistLoader_,vhs:o.vhs_,main:o.main(),mediaTypes:o.mediaTypes_,excludePlaylist:o.excludePlaylist.bind(o)}),o.triggerPresenceUsage_(o.main(),s),o.setupFirstPlay(),!o.mediaTypes_.AUDIO.activePlaylistLoader||o.mediaTypes_.AUDIO.activePlaylistLoader.media()?o.trigger("selectedinitialmedia"):o.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){o.trigger("selectedinitialmedia")}))})),this.mainPlaylistLoader_.on("loadedplaylist",(function(){o.loadOnPlay_&&o.tech_.off("play",o.loadOnPlay_);var s=o.mainPlaylistLoader_.media();if(!s){var m;if(o.attachContentSteeringListeners_(),o.initContentSteeringController_(),o.excludeUnsupportedVariants_(),o.enableLowInitialPlaylist&&(m=o.selectInitialPlaylist()),m||(m=o.selectPlaylist()),!m||!o.shouldSwitchToMedia_(m))return;if(o.initialMedia_=m,o.switchMedia_(o.initialMedia_,"initial"),!("vhs-json"===o.sourceType_&&o.initialMedia_.segments))return;s=o.initialMedia_}o.handleUpdatedMediaPlaylist(s)})),this.mainPlaylistLoader_.on("error",(function(){var s=o.mainPlaylistLoader_.error;o.excludePlaylist({playlistToExclude:s.playlist,error:s})})),this.mainPlaylistLoader_.on("mediachanging",(function(){o.mainSegmentLoader_.abort(),o.mainSegmentLoader_.pause()})),this.mainPlaylistLoader_.on("mediachange",(function(){var s=o.mainPlaylistLoader_.media(),m=1.5*s.targetDuration*1e3;sZ(o.mainPlaylistLoader_.main,o.mainPlaylistLoader_.media())?o.requestOptions_.timeout=0:o.requestOptions_.timeout=m,"dash"===o.sourceType_&&o.mainPlaylistLoader_.load(),o.mainSegmentLoader_.pause(),o.mainSegmentLoader_.playlist(s,o.requestOptions_),o.waitingForFastQualityPlaylistReceived_?o.runFastQualitySwitch_():o.mainSegmentLoader_.load(),o.tech_.trigger({type:"mediachange",bubbles:!0})})),this.mainPlaylistLoader_.on("playlistunchanged",(function(){var s=o.mainPlaylistLoader_.media();"playlist-unchanged"!==s.lastExcludeReason_&&(o.stuckAtPlaylistEnd_(s)&&(o.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),o.tech_.trigger("playliststuck")))})),this.mainPlaylistLoader_.on("renditiondisabled",(function(){o.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})})),this.mainPlaylistLoader_.on("renditionenabled",(function(){o.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}))}},{key:"handleUpdatedMediaPlaylist",value:function handleUpdatedMediaPlaylist(o){this.useCueTags_&&this.updateAdCues_(o),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(o,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!o.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}},{key:"triggerPresenceUsage_",value:function triggerPresenceUsage_(o,s){var m=o.mediaGroups||{},_=!0,S=Object.keys(m.AUDIO);for(var E in m.AUDIO)for(var A in m.AUDIO[E]){m.AUDIO[E][A].uri||(_=!1)}_&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(m.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),X0.Playlist.isAes(s)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),S.length&&Object.keys(m.AUDIO[S[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}},{key:"shouldSwitchToMedia_",value:function shouldSwitchToMedia_(o){var s=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,m=this.tech_.currentTime(),_=this.bufferLowWaterLine(),S=this.bufferHighWaterLine();return function shouldSwitchToMedia(o){var s=o.currentPlaylist,m=o.buffered,_=o.currentTime,S=o.nextPlaylist,E=o.bufferLowWaterLine,A=o.bufferHighWaterLine,O=o.duration,H=o.bufferBasedABR,K=o.log;if(!S)return videojs.log.warn("We received no playlist to switch to. Please check your stream."),!1;var z="allowing switch ".concat(s&&s.id||"null"," -> ").concat(S.id);if(!s)return K("".concat(z," as current playlist is not set")),!0;if(S.id===s.id)return!1;var G=Boolean(VJ(m,_).length);if(!s.endList)return G||"number"!=typeof s.partTargetDuration?(K("".concat(z," as current playlist is live")),!0):(K("not ".concat(z," as current playlist is live llhls, but currentTime isn't in buffered.")),!1);var q=GJ(m,_),X=H?XZ.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:XZ.MAX_BUFFER_LOW_WATER_LINE;if(O<X)return K("".concat(z," as duration < max low water line (").concat(O," < ").concat(X,")")),!0;var J=S.attributes.BANDWIDTH,ae=s.attributes.BANDWIDTH;if(J<ae&&(!H||q<A)){var pe="".concat(z," as next bandwidth < current bandwidth (").concat(J," < ").concat(ae,")");return H&&(pe+=" and forwardBuffer < bufferHighWaterLine (".concat(q," < ").concat(A,")")),K(pe),!0}if((!H||J>ae)&&q>=E){var me="".concat(z," as forwardBuffer >= bufferLowWaterLine (").concat(q," >= ").concat(E,")");return H&&(me+=" and next bandwidth > current bandwidth (".concat(J," > ").concat(ae,")")),K(me),!0}return K("not ".concat(z," as no switching criteria met")),!1}({buffered:this.tech_.buffered(),currentTime:m,currentPlaylist:s,nextPlaylist:o,bufferLowWaterLine:_,bufferHighWaterLine:S,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}},{key:"setupSegmentLoaderListeners_",value:function setupSegmentLoaderListeners_(){var o=this;this.mainSegmentLoader_.on("bandwidthupdate",(function(){o.checkABR_("bandwidthupdate"),o.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("timeout",(function(){o.bufferBasedABR&&o.mainSegmentLoader_.load()})),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",(function(){o.trigger("progress")})),this.mainSegmentLoader_.on("error",(function(){var s=o.mainSegmentLoader_.error();o.excludePlaylist({playlistToExclude:s.playlist,error:s})})),this.mainSegmentLoader_.on("appenderror",(function(){o.error=o.mainSegmentLoader_.error_,o.trigger("error")})),this.mainSegmentLoader_.on("syncinfoupdate",(function(){o.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(function(){o.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(function(){o.onSyncInfoUpdate_()})),this.audioSegmentLoader_.on("appenderror",(function(){o.error=o.audioSegmentLoader_.error_,o.trigger("error")})),this.mainSegmentLoader_.on("ended",(function(){o.logger_("main segment loader ended"),o.onEndOfStream()})),this.mainSegmentLoader_.on("earlyabort",(function(s){o.bufferBasedABR||(o.delegateLoaders_("all",["abort"]),o.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:10}))}));var s=function updateCodecs(){if(!o.sourceUpdater_.hasCreatedSourceBuffers())return o.tryToCreateSourceBuffers_();var s=o.getCodecsOrExclude_();s&&o.sourceUpdater_.addOrChangeSourceBuffers(s)};this.mainSegmentLoader_.on("trackinfo",s),this.audioSegmentLoader_.on("trackinfo",s),this.mainSegmentLoader_.on("fmp4",(function(){o.triggeredFmp4Usage||(o.tech_.trigger({type:"usage",name:"vhs-fmp4"}),o.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("fmp4",(function(){o.triggeredFmp4Usage||(o.tech_.trigger({type:"usage",name:"vhs-fmp4"}),o.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("ended",(function(){o.logger_("audioSegmentLoader ended"),o.onEndOfStream()}))}},{key:"mediaSecondsLoaded_",value:function mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"fastQualityChange_",value:function fastQualityChange_(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectPlaylist();o&&o===this.mainPlaylistLoader_.media()?this.logger_("skipping fastQualityChange because new media is same as old"):(this.switchMedia_(o,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0)}},{key:"runFastQualitySwitch_",value:function runFastQualitySwitch_(){var o=this;this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything((function(){o.tech_.setCurrentTime(o.tech_.currentTime())}))}},{key:"play",value:function play(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var o=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<o.start(0)?this.tech_.setCurrentTime(o.end(o.length-1)):void 0}}},{key:"setupFirstPlay",value:function setupFirstPlay(){var o=this.mainPlaylistLoader_.media();if(!o||this.tech_.paused()||this.hasPlayed_)return!1;if(!o.endList||o.start){var s=this.seekable();if(!s.length)return!1;var m=s.end(0),_=m;if(o.start){var S=o.start.timeOffset;_=S<0?Math.max(m+S,s.start(0)):Math.min(m,S)}this.trigger("firstplay"),this.tech_.setCurrentTime(_)}return this.hasPlayed_=!0,this.load(),!0}},{key:"handleSourceOpen_",value:function handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var o=this.tech_.play();void 0!==o&&"function"==typeof o.then&&o.then(null,(function(o){}))}this.trigger("sourceopen")}},{key:"handleSourceEnded_",value:function handleSourceEnded_(){if(this.inbandTextTracks_.metadataTrack_){var o=this.inbandTextTracks_.metadataTrack_.cues;if(o&&o.length){var s=this.duration();o[o.length-1].endTime=isNaN(s)||Math.abs(s)===1/0?Number.MAX_VALUE:s}}}},{key:"handleDurationChange_",value:function handleDurationChange_(){this.tech_.trigger("durationchange")}},{key:"onEndOfStream",value:function onEndOfStream(){var o=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){var s=this.mainSegmentLoader_.getCurrentMediaInfo_();o=!s||s.hasVideo?o&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_}o&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}},{key:"stuckAtPlaylistEnd_",value:function stuckAtPlaylistEnd_(o){if(!this.seekable().length)return!1;var s=this.syncController_.getExpiredTime(o,this.duration());if(null===s)return!1;var m=X0.Playlist.playlistEnd(o,s),_=this.tech_.currentTime(),S=this.tech_.buffered();if(!S.length)return m-_<=jJ;var E=S.end(S.length-1);return E-_<=jJ&&m-E<=jJ}},{key:"excludePlaylist",value:function excludePlaylist(o){var s=this,m=o.playlistToExclude,_=void 0===m?this.mainPlaylistLoader_.media():m,S=o.error,E=void 0===S?{}:S,A=o.playlistExclusionDuration;if(_=_||this.mainPlaylistLoader_.media(),A=A||E.playlistExclusionDuration||this.playlistExclusionDuration,!_)return this.error=E,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));_.playlistErrors_++;var O,H=this.mainPlaylistLoader_.main.playlists,K=H.filter(aZ),z=1===K.length&&K[0]===_;if(1===H.length&&A!==1/0)return videojs.log.warn("Problem encountered with playlist ".concat(_.id,". ")+"Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(z);if(z){if(this.main().contentSteering){var G=this.pathwayAttribute_(_),q=1e3*this.contentSteeringController_.steeringManifest.ttl;return this.contentSteeringController_.excludePathway(G),this.excludeThenChangePathway_(),void setTimeout((function(){s.contentSteeringController_.addAvailablePathway(G)}),q)}var X=!1;H.forEach((function(o){if(o!==_){var s=o.excludeUntil;void 0!==s&&s!==1/0&&(X=!0,delete o.excludeUntil)}})),X&&(videojs.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}O=_.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*A,_.excludeUntil=O,E.reason&&(_.lastExcludeReason_=E.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});var J=this.selectPlaylist();if(!J)return this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error");var ae=E.internal?this.logger_:videojs.log.warn,pe=E.message?" "+E.message:"";ae("".concat(E.internal?"Internal problem":"Problem"," encountered with playlist ").concat(_.id,".")+"".concat(pe," Switching to playlist ").concat(J.id,".")),J.attributes.AUDIO!==_.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),J.attributes.SUBTITLES!==_.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);var me=J.targetDuration/2*1e3||5e3,_e="number"==typeof J.lastRequest&&Date.now()-J.lastRequest<=me;return this.switchMedia_(J,"exclude",z||_e)}},{key:"pauseLoading",value:function pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}},{key:"delegateLoaders_",value:function delegateLoaders_(o,s){var m=this,_=[],S="all"===o;(S||"main"===o)&&_.push(this.mainPlaylistLoader_);var E=[];(S||"audio"===o)&&E.push("AUDIO"),(S||"subtitle"===o)&&(E.push("CLOSED-CAPTIONS"),E.push("SUBTITLES")),E.forEach((function(o){var s=m.mediaTypes_[o]&&m.mediaTypes_[o].activePlaylistLoader;s&&_.push(s)})),["main","audio","subtitle"].forEach((function(s){var S=m["".concat(s,"SegmentLoader_")];!S||o!==s&&"all"!==o||_.push(S)})),_.forEach((function(o){return s.forEach((function(s){"function"==typeof o[s]&&o[s]()}))}))}},{key:"setCurrentTime",value:function setCurrentTime(o){var s=VJ(this.tech_.buffered(),o);return this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media()&&this.mainPlaylistLoader_.media().segments?s&&s.length?o:(this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),void this.load()):0}},{key:"duration",value:function duration(){if(!this.mainPlaylistLoader_)return 0;var o=this.mainPlaylistLoader_.media();return o?o.endList?this.mediaSource?this.mediaSource.duration:X0.Playlist.duration(o):1/0:0}},{key:"seekable",value:function seekable(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function onSyncInfoUpdate_(){var o;if(this.mainPlaylistLoader_){var s=this.mainPlaylistLoader_.media();if(s){var m=this.syncController_.getExpiredTime(s,this.duration());if(null!==m){var _=this.mainPlaylistLoader_.main,S=X0.Playlist.seekable(s,m,X0.Playlist.liveEdgeDelay(_,s));if(0!==S.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(s=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(m=this.syncController_.getExpiredTime(s,this.duration())))return;if(0===(o=X0.Playlist.seekable(s,m,X0.Playlist.liveEdgeDelay(_,s))).length)return}var E,A;this.seekable_&&this.seekable_.length&&(E=this.seekable_.end(0),A=this.seekable_.start(0)),o?o.start(0)>S.end(0)||S.start(0)>o.end(0)?this.seekable_=S:this.seekable_=createTimeRanges$2([[o.start(0)>S.start(0)?o.start(0):S.start(0),o.end(0)<S.end(0)?o.end(0):S.end(0)]]):this.seekable_=S,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===E&&this.seekable_.start(0)===A||(this.logger_("seekable updated [".concat(KJ(this.seekable_),"]")),this.tech_.trigger("seekablechanged"))}}}}}},{key:"updateDuration",value:function updateDuration(o){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,o),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(o){var s=this.seekable();if(!s.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<s.end(s.length-1))&&this.sourceUpdater_.setDuration(s.end(s.length-1))}else{var m=this.tech_.buffered(),_=X0.Playlist.duration(this.mainPlaylistLoader_.media());m.length>0&&(_=Math.max(_,m.end(m.length-1))),this.mediaSource.duration!==_&&this.sourceUpdater_.setDuration(_)}}},{key:"dispose",value:function dispose(){var o=this;this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach((function(s){var m=o.mediaTypes_[s].groups;for(var _ in m)m[_].forEach((function(o){o.playlistLoader&&o.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}},{key:"main",value:function main(){return this.mainPlaylistLoader_.main}},{key:"media",value:function media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}},{key:"areMediaTypesKnown_",value:function areMediaTypesKnown_(){var o=!!this.mediaTypes_.AUDIO.activePlaylistLoader,s=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),m=!o||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return!(!s||!m)}},{key:"getCodecsOrExclude_",value:function getCodecsOrExclude_(){var o=this,s={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},m=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();s.video=s.main;var _=I0(this.main(),m),S={},E=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(s.main.hasVideo&&(S.video=_.video||s.main.videoCodec||_K),s.main.isMuxed&&(S.video+=",".concat(_.audio||s.main.audioCodec||vK)),(s.main.hasAudio&&!s.main.isMuxed||s.audio.hasAudio||E)&&(S.audio=_.audio||s.main.audioCodec||s.audio.audioCodec||vK,s.audio.isFmp4=s.main.hasAudio&&!s.main.isMuxed?s.main.isFmp4:s.audio.isFmp4),S.audio||S.video){var A,O={};if(["video","audio"].forEach((function(o){if(S.hasOwnProperty(o)&&!function supportFunction(o,s){return o?mK(s):yK(s)}(s[o].isFmp4,S[o])){var m=s[o].isFmp4?"browser":"muxer";O[m]=O[m]||[],O[m].push(S[o]),"audio"===o&&(A=m)}})),E&&A&&m.attributes.AUDIO){var H=m.attributes.AUDIO;this.main().playlists.forEach((function(o){(o.attributes&&o.attributes.AUDIO)===H&&o!==m&&(o.excludeUntil=1/0)})),this.logger_("excluding audio group ".concat(H," as ").concat(A,' does not support codec(s): "').concat(S.audio,'"'))}if(!Object.keys(O).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var K=[];if(["video","audio"].forEach((function(s){var m=(hK(o.sourceUpdater_.codecs[s]||"")[0]||{}).type,_=(hK(S[s]||"")[0]||{}).type;m&&_&&m.toLowerCase()!==_.toLowerCase()&&K.push('"'.concat(o.sourceUpdater_.codecs[s],'" -> "').concat(S[s],'"'))})),K.length)return void this.excludePlaylist({playlistToExclude:m,error:{message:"Codec switching not supported: ".concat(K.join(", "),"."),internal:!0},playlistExclusionDuration:1/0})}return S}var z=Object.keys(O).reduce((function(o,s){return o&&(o+=", "),o+="".concat(s,' does not support codec(s): "').concat(O[s].join(","),'"')}),"")+".";this.excludePlaylist({playlistToExclude:m,error:{internal:!0,message:z},playlistExclusionDuration:1/0})}else this.excludePlaylist({playlistToExclude:m,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0})}},{key:"tryToCreateSourceBuffers_",value:function tryToCreateSourceBuffers_(){if("open"===this.mediaSource.readyState&&!this.sourceUpdater_.hasCreatedSourceBuffers()&&this.areMediaTypesKnown_()){var o=this.getCodecsOrExclude_();if(o){this.sourceUpdater_.createSourceBuffers(o);var s=[o.video,o.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(s)}}}},{key:"excludeUnsupportedVariants_",value:function excludeUnsupportedVariants_(){var o=this,s=this.main().playlists,m=[];Object.keys(s).forEach((function(_){var S=s[_];if(-1===m.indexOf(S.id)){m.push(S.id);var E=I0(o.main,S),A=[];!E.audio||yK(E.audio)||mK(E.audio)||A.push("audio codec ".concat(E.audio)),!E.video||yK(E.video)||mK(E.video)||A.push("video codec ".concat(E.video)),E.text&&"stpp.ttml.im1t"===E.text&&A.push("text codec ".concat(E.text)),A.length&&(S.excludeUntil=1/0,o.logger_("excluding ".concat(S.id," for unsupported: ").concat(A.join(", "))))}}))}},{key:"excludeIncompatibleVariants_",value:function excludeIncompatibleVariants_(o){var s=this,m=[],_=this.main().playlists,S=x0(hK(o)),E=E0(S),A=S.video&&hK(S.video)[0]||null,O=S.audio&&hK(S.audio)[0]||null;Object.keys(_).forEach((function(o){var S=_[o];if(-1===m.indexOf(S.id)&&S.excludeUntil!==1/0){m.push(S.id);var H=[],K=I0(s.mainPlaylistLoader_.main,S),z=E0(K);if(K.audio||K.video){if(z!==E&&H.push('codec count "'.concat(z,'" !== "').concat(E,'"')),!s.sourceUpdater_.canChangeType()){var G=K.video&&hK(K.video)[0]||null,q=K.audio&&hK(K.audio)[0]||null;G&&A&&G.type.toLowerCase()!==A.type.toLowerCase()&&H.push('video codec "'.concat(G.type,'" !== "').concat(A.type,'"')),q&&O&&q.type.toLowerCase()!==O.type.toLowerCase()&&H.push('audio codec "'.concat(q.type,'" !== "').concat(O.type,'"'))}H.length&&(S.excludeUntil=1/0,s.logger_("excluding ".concat(S.id,": ").concat(H.join(" && "))))}}}))}},{key:"updateAdCues_",value:function updateAdCues_(o){var s=0,m=this.seekable();m.length&&(s=m.start(0)),function updateAdCues(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(o.segments)for(var _,S=m,E=0;E<o.segments.length;E++){var A=o.segments[E];if(_||(_=_1(s,S+A.duration/2)),_){if("cueIn"in A){_.endTime=S,_.adEndTime=S,S+=A.duration,_=null;continue}if(S<_.endTime){S+=A.duration;continue}_.endTime+=A.duration}else if("cueOut"in A&&((_=new $V.VTTCue(S,S+A.duration,A.cueOut)).adStartTime=S,_.adEndTime=S+parseFloat(A.cueOut),s.addCue(_)),"cueOutCont"in A){var O=_slicedToArray$1(A.cueOutCont.split("/").map(parseFloat),2),H=O[0],K=O[1];(_=new $V.VTTCue(S,S+A.duration,"")).adStartTime=S-H,_.adEndTime=_.adStartTime+K,s.addCue(_)}S+=A.duration}}(o,this.cueTagsTrack_,s)}},{key:"goalBufferLength",value:function goalBufferLength(){var o=this.tech_.currentTime(),s=XZ.GOAL_BUFFER_LENGTH,m=XZ.GOAL_BUFFER_LENGTH_RATE,_=Math.max(s,XZ.MAX_GOAL_BUFFER_LENGTH);return Math.min(s+o*m,_)}},{key:"bufferLowWaterLine",value:function bufferLowWaterLine(){var o=this.tech_.currentTime(),s=XZ.BUFFER_LOW_WATER_LINE,m=XZ.BUFFER_LOW_WATER_LINE_RATE,_=Math.max(s,XZ.MAX_BUFFER_LOW_WATER_LINE),S=Math.max(s,XZ.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(s+o*m,this.bufferBasedABR?S:_)}},{key:"bufferHighWaterLine",value:function bufferHighWaterLine(){return XZ.BUFFER_HIGH_WATER_LINE}},{key:"addDateRangesToTextTrack_",value:function addDateRangesToTextTrack_(o){B0(this.inbandTextTracks_,"com.apple.streaming",this.tech_),function addDateRangeMetadata(o){var s=o.inbandTextTracks,m=o.dateRanges,_=s.metadataTrack_;if(_){var S=$V.WebKitDataCue||$V.VTTCue;m.forEach((function(o){for(var s=0,m=Object.keys(o);s<m.length;s++){var E=m[s];if(!U0.has(E)){var A=new S(o.startTime,o.endTime,"");A.id=o.id,A.type="com.apple.quicktime.HLS",A.value={key:N0[E],data:o[E]},"scte35Out"!==E&&"scte35In"!==E||(A.value.data=new Uint8Array(A.value.data.match(/[\da-f]{2}/gi)).buffer),_.addCue(A)}}o.processDateRange()}))}}({inbandTextTracks:this.inbandTextTracks_,dateRanges:o})}},{key:"addMetadataToTextTrack",value:function addMetadataToTextTrack(o,s,m){var _=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();B0(this.inbandTextTracks_,o,this.tech_),F0({inbandTextTracks:this.inbandTextTracks_,metadataArray:s,timestampOffset:_,videoDuration:m})}},{key:"pathwayAttribute_",value:function pathwayAttribute_(o){return o.attributes["PATHWAY-ID"]||o.attributes.serviceLocation}},{key:"initContentSteeringController_",value:function initContentSteeringController_(){var o=this,s=this.main();if(s.contentSteering){var m,_=_createForOfIteratorHelper(s.playlists);try{for(_.s();!(m=_.n()).done;){var S=m.value;this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(S))}}catch(o){_.e(o)}finally{_.f()}this.contentSteeringController_.assignTagProperties(s.uri,s.contentSteering),this.contentSteeringController_.queryBeforeStart?this.contentSteeringController_.requestSteeringManifest(!0):this.tech_.one("canplay",(function(){o.contentSteeringController_.requestSteeringManifest()}))}}},{key:"resetContentSteeringController_",value:function resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}},{key:"attachContentSteeringListeners_",value:function attachContentSteeringListeners_(){var o=this;this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),"dash"===this.sourceType_&&this.mainPlaylistLoader_.on("loadedplaylist",(function(){var s=o.main();(o.contentSteeringController_.didDASHTagChange(s.uri,s.contentSteering)||function didPathwaysChange(){var m,_=o.contentSteeringController_.getAvailablePathways(),S=[],E=_createForOfIteratorHelper(s.playlists);try{for(E.s();!(m=E.n()).done;){var A=m.value.attributes.serviceLocation;if(A&&(S.push(A),!_.has(A)))return!0}}catch(o){E.e(o)}finally{E.f()}return!(S.length||!_.size)}())&&o.resetContentSteeringController_()}))}},{key:"excludeThenChangePathway_",value:function excludeThenChangePathway_(){var o=this,s=this.contentSteeringController_.getPathway();if(s){this.handlePathwayClones_();var m=this.main().playlists,_=new Set,S=!1;Object.keys(m).forEach((function(E){var A=m[E],O=o.pathwayAttribute_(A),H=O&&s!==O;A.excludeUntil===1/0&&"content-steering"===A.lastExcludeReason_&&!H&&(delete A.excludeUntil,delete A.lastExcludeReason_,S=!0);var K=!A.excludeUntil&&A.excludeUntil!==1/0;!_.has(A.id)&&H&&K&&(_.add(A.id),A.excludeUntil=1/0,A.lastExcludeReason_="content-steering",o.logger_("excluding ".concat(A.id," for ").concat(A.lastExcludeReason_)))})),"DASH"===this.contentSteeringController_.manifestType_&&Object.keys(this.mediaTypes_).forEach((function(m){var _=o.mediaTypes_[m];if(_.activePlaylistLoader){var E=_.activePlaylistLoader.media_;E&&E.attributes.serviceLocation!==s&&(S=!0)}})),S&&this.changeSegmentPathway_()}}},{key:"handlePathwayClones_",value:function handlePathwayClones_(){var o=this,s=this.main().playlists,m=this.contentSteeringController_.currentPathwayClones,_=this.contentSteeringController_.nextPathwayClones;if(m&&m.size||_&&_.size){var S,E=_createForOfIteratorHelper(m.entries());try{for(E.s();!(S=E.n()).done;){var A=_slicedToArray$1(S.value,2),O=A[0],H=A[1];_.get(O)||(this.mainPlaylistLoader_.updateOrDeleteClone(H),this.contentSteeringController_.excludePathway(O))}}catch(o){E.e(o)}finally{E.f()}var K,z=_createForOfIteratorHelper(_.entries());try{var G=function _loop4(){var _=_slicedToArray$1(K.value,2),S=_[0],E=_[1],A=m.get(S);if(!A){var O=s.filter((function(o){return o.attributes["PATHWAY-ID"]===E["BASE-ID"]}));return O.forEach((function(s){o.mainPlaylistLoader_.addClonePathway(E,s)})),o.contentSteeringController_.addAvailablePathway(S),"continue"}if(o.equalPathwayClones_(A,E))return"continue";o.mainPlaylistLoader_.updateOrDeleteClone(E,!0),o.contentSteeringController_.addAvailablePathway(S)};for(z.s();!(K=z.n()).done;)G()}catch(o){z.e(o)}finally{z.f()}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify(_toConsumableArray$1(_))))}}},{key:"equalPathwayClones_",value:function equalPathwayClones_(o,s){if(o["BASE-ID"]!==s["BASE-ID"]||o.ID!==s.ID||o["URI-REPLACEMENT"].HOST!==s["URI-REPLACEMENT"].HOST)return!1;var m=o["URI-REPLACEMENT"].PARAMS,_=s["URI-REPLACEMENT"].PARAMS;for(var S in m)if(m[S]!==_[S])return!1;for(var E in _)if(m[E]!==_[E])return!1;return!0}},{key:"changeSegmentPathway_",value:function changeSegmentPathway_(){var o=this.selectPlaylist();this.pauseLoading(),"DASH"===this.contentSteeringController_.manifestType_&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(o,"content-steering")}},{key:"excludeNonUsablePlaylistsByKeyId_",value:function excludeNonUsablePlaylistsByKeyId_(){var o=this;if(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.main){var s=0,m="non-usable";this.mainPlaylistLoader_.main.playlists.forEach((function(_){var S=o.mainPlaylistLoader_.getKeyIdSet(_);S&&S.size&&S.forEach((function(S){var E="usable",A=o.keyStatusMap_.has(S)&&o.keyStatusMap_.get(S)===E,O=_.lastExcludeReason_===m&&_.excludeUntil===1/0;A?A&&O&&(delete _.excludeUntil,delete _.lastExcludeReason_,o.logger_("enabling playlist ".concat(_.id," because key ID ").concat(S," is ").concat(E))):(_.excludeUntil!==1/0&&_.lastExcludeReason_!==m&&(_.excludeUntil=1/0,_.lastExcludeReason_=m,o.logger_("excluding playlist ".concat(_.id," because the key ID ").concat(S," doesn't exist in the keyStatusMap or is not ").concat(E))),s++)}))})),s>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach((function(o){var s=o&&o.attributes&&o.attributes.RESOLUTION&&o.attributes.RESOLUTION.height<720,_=o.excludeUntil===1/0&&o.lastExcludeReason_===m;s&&_&&(delete o.excludeUntil,videojs.log.warn("enabling non-HD playlist ".concat(o.id," because all playlists were excluded due to ").concat(m," key IDs")))}))}}},{key:"addKeyStatus_",value:function addKeyStatus_(o,s){var m=("string"==typeof o?o:function bufferToHexString(o){var s=new Uint8Array(o);return Array.from(s).map((function(o){return o.toString(16).padStart(2,"0")})).join("")}(o)).slice(0,32).toLowerCase();this.logger_("KeyStatus '".concat(s,"' with key ID ").concat(m," added to the keyStatusMap")),this.keyStatusMap_.set(m,s)}},{key:"updatePlaylistByKeyStatus",value:function updatePlaylistByKeyStatus(o,s){this.addKeyStatus_(o,s),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}},{key:"excludeNonUsableThenChangePlaylist_",value:function excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}]),PlaylistController}(videojs.EventTarget),B1=_createClass$1((function Representation(o,s,m){_classCallCheck$1(this,Representation);var _=o.playlistController_,S=_.fastQualityChange_.bind(_);if(s.attributes){var E=s.attributes.RESOLUTION;this.width=E&&E.width,this.height=E&&E.height,this.bandwidth=s.attributes.BANDWIDTH,this.frameRate=s.attributes["FRAME-RATE"]}this.codecs=I0(_.main(),s),this.playlist=s,this.id=m,this.enabled=function enableFunction(o,s,m){return function(_){var S=o.main.playlists[s],E=iZ(S),A=aZ(S);return void 0===_?A:(_?delete S.disabled:S.disabled=!0,_===A||E||(m(),_?o.trigger("renditionenabled"):o.trigger("renditiondisabled")),_)}}(o.playlists,s.id,S)})),j1=["seeking","seeked","pause","playing","error"],$1=function(){function PlaybackWatcher(o){var s=this;_classCallCheck$1(this,PlaybackWatcher),this.playlistController_=o.playlistController,this.tech_=o.tech,this.seekable=o.seekable,this.allowSeeksWithinUnsafeLiveWindow=o.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=o.liveRangeSafeTimeDelta,this.media=o.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=UJ("PlaybackWatcher"),this.logger_("initialize");var m=function playHandler(){return s.monitorCurrentTime_()},_=function canPlayHandler(){return s.monitorCurrentTime_()},S=function waitingHandler(){return s.techWaiting_()},E=function cancelTimerHandler(){return s.resetTimeUpdate_()},A=this.playlistController_,O=["main","subtitle","audio"],H={};O.forEach((function(o){H[o]={reset:function reset(){return s.resetSegmentDownloads_(o)},updateend:function updateend(){return s.checkSegmentDownloads_(o)}},A["".concat(o,"SegmentLoader_")].on("appendsdone",H[o].updateend),A["".concat(o,"SegmentLoader_")].on("playlistupdate",H[o].reset),s.tech_.on(["seeked","seeking"],H[o].reset)}));var K=function setSeekingHandlers(o){["main","audio"].forEach((function(m){A["".concat(m,"SegmentLoader_")][o]("appended",s.seekingAppendCheck_)}))};this.seekingAppendCheck_=function(){s.fixesBadSeeks_()&&(s.consecutiveUpdates=0,s.lastRecordedTime=s.tech_.currentTime(),K("off"))},this.clearSeekingAppendCheck_=function(){return K("off")},this.watchForBadSeeking_=function(){s.clearSeekingAppendCheck_(),K("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",S),this.tech_.on(j1,E),this.tech_.on("canplay",_),this.tech_.one("play",m),this.dispose=function(){s.clearSeekingAppendCheck_(),s.logger_("dispose"),s.tech_.off("waiting",S),s.tech_.off(j1,E),s.tech_.off("canplay",_),s.tech_.off("play",m),s.tech_.off("seeking",s.watchForBadSeeking_),s.tech_.off("seeked",s.clearSeekingAppendCheck_),O.forEach((function(o){A["".concat(o,"SegmentLoader_")].off("appendsdone",H[o].updateend),A["".concat(o,"SegmentLoader_")].off("playlistupdate",H[o].reset),s.tech_.off(["seeked","seeking"],H[o].reset)})),s.checkCurrentTimeTimeout_&&$V.clearTimeout(s.checkCurrentTimeTimeout_),s.resetTimeUpdate_()}}return _createClass$1(PlaybackWatcher,[{key:"monitorCurrentTime_",value:function monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&$V.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=$V.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"resetSegmentDownloads_",value:function resetSegmentDownloads_(o){var s=this.playlistController_["".concat(o,"SegmentLoader_")];this["".concat(o,"StalledDownloads_")]>0&&this.logger_("resetting possible stalled download count for ".concat(o," loader")),this["".concat(o,"StalledDownloads_")]=0,this["".concat(o,"Buffered_")]=s.buffered_()}},{key:"checkSegmentDownloads_",value:function checkSegmentDownloads_(o){var s=this.playlistController_,m=s["".concat(o,"SegmentLoader_")],_=m.buffered_(),S=function isRangeDifferent(o,s){if(o===s)return!1;if(!o&&s||!s&&o)return!0;if(o.length!==s.length)return!0;for(var m=0;m<o.length;m++)if(o.start(m)!==s.start(m)||o.end(m)!==s.end(m))return!0;return!1}(this["".concat(o,"Buffered_")],_);this["".concat(o,"Buffered_")]=_,S?this.resetSegmentDownloads_(o):(this["".concat(o,"StalledDownloads_")]++,this.logger_("found #".concat(this["".concat(o,"StalledDownloads_")]," ").concat(o," appends that did not increase buffer (possible stalled download)"),{playlistId:m.playlist_&&m.playlist_.id,buffered:zJ(_)}),this["".concat(o,"StalledDownloads_")]<10||(this.logger_("".concat(o," loader stalled download exclusion")),this.resetSegmentDownloads_(o),this.tech_.trigger({type:"usage",name:"vhs-".concat(o,"-download-exclusion")}),"subtitle"!==o&&s.excludePlaylist({error:{message:"Excessive ".concat(o," segment downloading detected.")},playlistExclusionDuration:1/0})))}},{key:"checkCurrentTime_",value:function checkCurrentTime_(){if(!this.tech_.paused()&&!this.tech_.seeking()){var o=this.tech_.currentTime(),s=this.tech_.buffered();if(this.lastRecordedTime===o&&(!s.length||o+jJ>=s.end(s.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&o===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):o===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=o)}}},{key:"resetTimeUpdate_",value:function resetTimeUpdate_(){this.consecutiveUpdates=0}},{key:"fixesBadSeeks_",value:function fixesBadSeeks_(){if(!this.tech_.seeking())return!1;var o,s=this.seekable(),m=this.tech_.currentTime();this.afterSeekableWindow_(s,m,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(o=s.end(s.length-1));if(this.beforeSeekableWindow_(s,m)){var _=s.start(0);o=_+(_===s.end(0)?0:jJ)}if(void 0!==o)return this.logger_("Trying to seek outside of seekable at time ".concat(m," with ")+"seekable range ".concat(KJ(s),". Seeking to ")+"".concat(o,".")),this.tech_.setCurrentTime(o),!0;for(var S=this.playlistController_.sourceUpdater_,E=this.tech_.buffered(),A=S.audioBuffer?S.audioBuffered():null,O=S.videoBuffer?S.videoBuffered():null,H=this.media(),K=H.partTargetDuration?H.partTargetDuration:2*(H.targetDuration-BJ),z=[A,O],G=0;G<z.length;G++){if(z[G])if(GJ(z[G],m)<K)return!1}var q=HJ(E,m);return 0!==q.length&&(o=q.start(0)+jJ,this.logger_("Buffered region starts (".concat(q.start(0),") ")+" just beyond seek point (".concat(m,"). Seeking to ").concat(o,".")),this.tech_.setCurrentTime(o),!0)}},{key:"waiting_",value:function waiting_(){if(!this.techWaiting_()){var o=this.tech_.currentTime(),s=this.tech_.buffered(),m=VJ(s,o);return m.length&&o+3<=m.end(0)?(this.resetTimeUpdate_(),this.tech_.setCurrentTime(o),this.logger_("Stopped at ".concat(o," while inside a buffered region ")+"[".concat(m.start(0)," -> ").concat(m.end(0),"]. Attempting to resume ")+"playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function techWaiting_(){var o=this.seekable(),s=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(o,s)){var m=o.end(o.length-1);return this.logger_("Fell out of live window at time ".concat(s,". Seeking to ")+"live point (seekable end) ".concat(m)),this.resetTimeUpdate_(),this.tech_.setCurrentTime(m),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}var _=this.tech_.vhs.playlistController_.sourceUpdater_,S=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:_.audioBuffered(),videoBuffered:_.videoBuffered(),currentTime:s}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(s),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;var E=HJ(S,s);return E.length>0&&(this.logger_("Stopped at ".concat(s," and seeking to ").concat(E.start(0))),this.resetTimeUpdate_(),this.skipTheGap_(s),!0)}},{key:"afterSeekableWindow_",value:function afterSeekableWindow_(o,s,m){var _=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!o.length)return!1;var S=o.end(o.length-1)+jJ,E=!m.endList,A="number"==typeof m.partTargetDuration;return E&&(A||_)&&(S=o.end(o.length-1)+3*m.targetDuration),s>S}},{key:"beforeSeekableWindow_",value:function beforeSeekableWindow_(o,s){return!!(o.length&&o.start(0)>0&&s<o.start(0)-this.liveRangeSafeTimeDelta)}},{key:"videoUnderflow_",value:function videoUnderflow_(o){var s=o.videoBuffered,m=o.audioBuffered,_=o.currentTime;if(s){var S;if(s.length&&m.length){var E=VJ(s,_-3),A=VJ(s,_),O=VJ(m,_);O.length&&!A.length&&E.length&&(S={start:E.end(0),end:O.end(0)})}else{HJ(s,_).length||(S=this.gapFromVideoUnderflow_(s,_))}return!!S&&(this.logger_("Encountered a gap in video from ".concat(S.start," to ").concat(S.end,". ")+"Seeking to current time ".concat(_)),!0)}}},{key:"skipTheGap_",value:function skipTheGap_(o){var s=this.tech_.buffered(),m=this.tech_.currentTime(),_=HJ(s,m);this.resetTimeUpdate_(),0!==_.length&&m===o&&(this.logger_("skipTheGap_:","currentTime:",m,"scheduled currentTime:",o,"nextRange start:",_.start(0)),this.tech_.setCurrentTime(_.start(0)+BJ),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function gapFromVideoUnderflow_(o,s){for(var m=function findGaps(o){if(o.length<2)return createTimeRanges$2();for(var s=[],m=1;m<o.length;m++){var _=o.end(m-1),S=o.start(m);s.push([_,S])}return createTimeRanges$2(s)}(o),_=0;_<m.length;_++){var S=m.start(_),E=m.end(_);if(s-S<4&&s-S>2)return{start:S,end:E}}return null}}]),PlaybackWatcher}(),V1={errorInterval:30,getSource:function getSource(o){return o(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},H1=function initPlugin(o,s){var m=0,_=0,S=merge$2(V1,s);o.ready((function(){o.trigger({type:"usage",name:"vhs-error-reload-initialized"})}));var E=function loadedMetadataHandler(){_&&o.currentTime(_)},A=function setSource(s){null!=s&&(_=o.duration()!==1/0&&o.currentTime()||0,o.one("loadedmetadata",E),o.src(s),o.trigger({type:"usage",name:"vhs-error-reload"}),o.play())},O=function errorHandler(){if(Date.now()-m<1e3*S.errorInterval)o.trigger({type:"usage",name:"vhs-error-reload-canceled"});else{if(S.getSource&&"function"==typeof S.getSource)return m=Date.now(),S.getSource.call(o,A);videojs.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},H=function cleanupEvents(){o.off("loadedmetadata",E),o.off("error",O),o.off("dispose",cleanupEvents)};o.on("error",O),o.on("dispose",H),o.reloadSourceOnError=function reinitPlugin(s){H(),initPlugin(o,s)}},K1="3.10.0",z1={PlaylistLoader:xZ,Playlist:dZ,utils:UZ,STANDARD_PLAYLIST_SELECTOR:M0,INITIAL_PLAYLIST_SELECTOR:function lowestBitrateCompatibleVariantSelector(){var o=this,s=this.playlists.main.playlists.filter(dZ.isEnabled);return D0(s,(function(o,s){return R0(o,s)})),s.filter((function(s){return!!I0(o.playlists.main,s).video}))[0]||null},lastBandwidthSelector:M0,movingAverageBandwidthSelector:function movingAverageBandwidthSelector(o){var s=-1,m=-1;if(o<0||o>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var _=this.useDevicePixelRatio&&$V.devicePixelRatio||1;return s<0&&(s=this.systemBandwidth,m=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==m&&(s=o*this.systemBandwidth+(1-o)*s,m=this.systemBandwidth),O0(this.playlists.main,s,parseInt(L0(this.tech_.el(),"width"),10)*_,parseInt(L0(this.tech_.el(),"height"),10)*_,this.limitRenditionByPlayerDimensions,this.playlistController_)}},comparePlaylistBandwidth:R0,comparePlaylistResolution:function comparePlaylistResolution(o,s){var m,_;return o.attributes.RESOLUTION&&o.attributes.RESOLUTION.width&&(m=o.attributes.RESOLUTION.width),m=m||$V.Number.MAX_VALUE,s.attributes.RESOLUTION&&s.attributes.RESOLUTION.width&&(_=s.attributes.RESOLUTION.width),m===(_=_||$V.Number.MAX_VALUE)&&o.attributes.BANDWIDTH&&s.attributes.BANDWIDTH?o.attributes.BANDWIDTH-s.attributes.BANDWIDTH:m-_},xhr:AZ()};Object.keys(XZ).forEach((function(o){Object.defineProperty(z1,o,{get:function get(){return videojs.log.warn("using Vhs.".concat(o," is UNSAFE be sure you know what you are doing")),XZ[o]},set:function set(s){videojs.log.warn("using Vhs.".concat(o," is UNSAFE be sure you know what you are doing")),"number"!=typeof s||s<0?videojs.log.warn("value of Vhs.".concat(o," must be greater than or equal to 0")):XZ[o]=s}})}));var W1="videojs-vhs",G1=function handleVhsMediaChange(o,s){for(var m=s.media(),_=-1,S=0;S<o.length;S++)if(o[S].id===m.id){_=S;break}o.selectedIndex_=_,o.trigger({selectedIndex:_,type:"change"})};z1.canPlaySource=function(){return videojs.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};var q1=function waitForKeySessionCreation(o){var s=o.player,m=o.sourceKeySystems,_=o.audioMedia,S=o.mainPlaylists;if(!s.eme.initializeMediaKeys)return Promise.resolve();var E=function getAllPsshKeySystemsOptions(o,s){return o.reduce((function(o,m){if(!m.contentProtection)return o;var _=s.reduce((function(o,s){var _=m.contentProtection[s];return _&&_.pssh&&(o[s]={pssh:_.pssh}),o}),{});return Object.keys(_).length&&o.push(_),o}),[])}(_?S.concat([_]):S,Object.keys(m)),A=[],O=[];return E.forEach((function(o){O.push(new Promise((function(o,m){s.tech_.one("keysessioncreated",o)}))),A.push(new Promise((function(m,_){s.eme.initializeMediaKeys({keySystems:o},(function(o){o?_(o):m()}))})))})),Promise.race([Promise.all(A),Promise.race(O)])},Y1=function setupEmeOptions(o){var s=o.player,m=function emeKeySystems(o,s,m){if(!o)return o;var _={};s&&s.attributes&&s.attributes.CODECS&&(_=x0(hK(s.attributes.CODECS))),m&&m.attributes&&m.attributes.CODECS&&(_.audio=m.attributes.CODECS);var S=gK(_.video),E=gK(_.audio),A={};for(var O in o)A[O]={},E&&(A[O].audioContentType=E),S&&(A[O].videoContentType=S),s.contentProtection&&s.contentProtection[O]&&s.contentProtection[O].pssh&&(A[O].pssh=s.contentProtection[O].pssh),"string"==typeof o[O]&&(A[O].url=o[O]);return merge$2(o,A)}(o.sourceKeySystems,o.media,o.audioMedia);return!!m&&(s.currentSource().keySystems=m,!(m&&!s.eme)||(videojs.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1))},Q1=function getVhsLocalStorage(){if(!$V.localStorage)return null;var o=$V.localStorage.getItem(W1);if(!o)return null;try{return JSON.parse(o)}catch(o){return null}},J1=function addOnRequestHook(o,s){o._requestCallbackSet||(o._requestCallbackSet=new Set),o._requestCallbackSet.add(s)},Z1=function addOnResponseHook(o,s){o._responseCallbackSet||(o._responseCallbackSet=new Set),o._responseCallbackSet.add(s)},e2=function removeOnRequestHook(o,s){o._requestCallbackSet&&(o._requestCallbackSet.delete(s),o._requestCallbackSet.size||delete o._requestCallbackSet)},t2=function removeOnResponseHook(o,s){o._responseCallbackSet&&(o._responseCallbackSet.delete(s),o._responseCallbackSet.size||delete o._responseCallbackSet)};z1.supportsNativeHls=function(){if(!lH||!lH.createElement)return!1;var o=lH.createElement("video");if(!videojs.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some((function(s){return/maybe|probably/i.test(o.canPlayType(s))}))}(),z1.supportsNativeDash=!!(lH&&lH.createElement&&videojs.getTech("Html5").isSupported())&&/maybe|probably/i.test(lH.createElement("video").canPlayType("application/dash+xml")),z1.supportsTypeNatively=function(o){return"hls"===o?z1.supportsNativeHls:"dash"===o&&z1.supportsNativeDash},z1.isSupported=function(){return videojs.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},z1.xhr.onRequest=function(o){J1(z1.xhr,o)},z1.xhr.onResponse=function(o){Z1(z1.xhr,o)},z1.xhr.offRequest=function(o){e2(z1.xhr,o)},z1.xhr.offResponse=function(o){t2(z1.xhr,o)};var n2=function(o){_inherits$1(VhsHandler,o);var s=_createSuper$1(VhsHandler);function VhsHandler(o,m,_){var S;if(_classCallCheck$1(this,VhsHandler),S=s.call(this,m,_.vhs),"number"==typeof _.initialBandwidth&&(S.options_.bandwidth=_.initialBandwidth),S.logger_=UJ("VhsHandler"),m.options_&&m.options_.playerId){var E=videojs.getPlayer(m.options_.playerId);S.player_=E}if(S.tech_=m,S.source_=o,S.stats={},S.ignoreNextSeekingEvent_=!1,S.setOptions_(),S.options_.overrideNative&&m.overrideNativeAudioTracks&&m.overrideNativeVideoTracks)m.overrideNativeAudioTracks(!0),m.overrideNativeVideoTracks(!0);else if(S.options_.overrideNative&&(m.featuresNativeVideoTracks||m.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");return S.on(lH,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(o){var s=lH.fullscreenElement||lH.webkitFullscreenElement||lH.mozFullScreenElement||lH.msFullscreenElement;s&&s.contains(S.tech_.el())?S.playlistController_.fastQualityChange_():S.playlistController_.checkABR_()})),S.on(S.tech_,"seeking",(function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())})),S.on(S.tech_,"error",(function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()})),S.on(S.tech_,"play",S.play),S}return _createClass$1(VhsHandler,[{key:"setOptions_",value:function setOptions_(){var o=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.options_=merge$2(this.options_,s),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=!1!==this.options_.llhls,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,"number"!=typeof this.options_.playlistExclusionDuration&&(this.options_.playlistExclusionDuration=60),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var m=Q1();m&&m.bandwidth&&(this.options_.bandwidth=m.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),m&&m.throughput&&(this.options_.throughput=m.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=XZ.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===XZ.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach((function(s){void 0!==o.source_[s]&&(o.options_[s]=o.source_[s])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}},{key:"setOptions",value:function setOptions(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setOptions_(o)}},{key:"src",value:function src(o,s){var m=this;if(o){this.setOptions_(),this.options_.src=function expandDataUri(o){return 0===o.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(o.substring(o.indexOf(",")+1)):o}(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=z1,this.options_.sourceType=TK(s),this.options_.seekTo=function(o){m.tech_.setCurrentTime(o)},this.playlistController_=new U1(this.options_);var _=merge$2({liveRangeSafeTimeDelta:jJ},this.options_,{seekable:function seekable(){return m.seekable()},media:function media(){return m.playlistController_.media()},playlistController:this.playlistController_});this.playbackWatcher_=new $1(_),this.playlistController_.on("error",(function(){var o=videojs.players[m.tech_.options_.playerId],s=m.playlistController_.error;"object"!=typeof s||s.code?"string"==typeof s&&(s={message:s,code:3}):s.code=3,o.error(s)}));var S=this.options_.bufferBasedABR?z1.movingAverageBandwidthSelector(.55):z1.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):S.bind(this),this.playlistController_.selectInitialPlaylist=z1.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function get(){return this.playlistController_.selectPlaylist},set:function set(o){this.playlistController_.selectPlaylist=o.bind(this)}},throughput:{get:function get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set:function set(o){this.playlistController_.mainSegmentLoader_.throughput.rate=o,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function get(){var o=this.playlistController_.mainSegmentLoader_.bandwidth,s=$V.navigator.connection||$V.navigator.mozConnection||$V.navigator.webkitConnection,m=1e7;if(this.options_.useNetworkInformationApi&&s){var _=1e3*s.downlink*1e3;o=_>=m&&o>=m?Math.max(o,_):_}return o},set:function set(o){this.playlistController_.mainSegmentLoader_.bandwidth=o,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function get(){var o,s=1/(this.bandwidth||1);return o=this.throughput>0?1/this.throughput:0,Math.floor(1/(s+o))},set:function set(){videojs.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function get(){return m.bandwidth||0},enumerable:!0},mediaRequests:{get:function get(){return m.playlistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function get(){return m.playlistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function get(){return m.playlistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function get(){return m.playlistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function get(){return m.playlistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function get(){return m.playlistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function get(){return m.playlistController_.mediaSecondsLoaded_()||0},enumerable:!0},mediaAppends:{get:function get(){return m.playlistController_.mediaAppends_()||0},enumerable:!0},mainAppendsToLoadedData:{get:function get(){return m.playlistController_.mainAppendsToLoadedData_()||0},enumerable:!0},audioAppendsToLoadedData:{get:function get(){return m.playlistController_.audioAppendsToLoadedData_()||0},enumerable:!0},appendsToLoadedData:{get:function get(){return m.playlistController_.appendsToLoadedData_()||0},enumerable:!0},timeToLoadedData:{get:function get(){return m.playlistController_.timeToLoadedData_()||0},enumerable:!0},buffered:{get:function get(){return zJ(m.tech_.buffered())},enumerable:!0},currentTime:{get:function get(){return m.tech_.currentTime()},enumerable:!0},currentSource:{get:function get(){return m.tech_.currentSource_},enumerable:!0},currentTech:{get:function get(){return m.tech_.name_},enumerable:!0},duration:{get:function get(){return m.tech_.duration()},enumerable:!0},main:{get:function get(){return m.playlists.main},enumerable:!0},playerDimensions:{get:function get(){return m.tech_.currentDimensions()},enumerable:!0},seekable:{get:function get(){return zJ(m.tech_.seekable())},enumerable:!0},timestamp:{get:function get(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function get(){return m.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",(function(){m.options_.useBandwidthFromLocalStorage&&function updateVhsLocalStorage(o){if(!$V.localStorage)return!1;var s=Q1();s=s?merge$2(s,o):o;try{$V.localStorage.setItem(W1,JSON.stringify(s))}catch(o){return!1}}({bandwidth:m.bandwidth,throughput:Math.round(m.throughput)})})),this.playlistController_.on("selectedinitialmedia",(function(){!function renditionSelectionMixin(o){o.representations=function(){var s=o.playlistController_.main(),m=cZ(s)?o.playlistController_.getAudioTrackPlaylists_():s.playlists;return m?m.filter((function(o){return!iZ(o)})).map((function(s,m){return new B1(o,s,s.id)})):[]}}(m)})),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",(function(){m.setupEme_()})),this.on(this.playlistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.playlistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=$V.URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}}},{key:"createKeySessions_",value:function createKeySessions_(){var o=this,s=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),q1({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:s&&s.media(),mainPlaylists:this.playlists.main.playlists}).then((function(){o.logger_("created EME key session"),o.playlistController_.sourceUpdater_.initializedEme()})).catch((function(s){o.logger_("error while creating EME key session",s),o.player_.error({message:"Failed to initialize media keys for EME",code:3})}))}},{key:"handleWaitingForKey_",value:function handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}},{key:"setupEme_",value:function setupEme_(){var o=this,s=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,m=Y1({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:s&&s.media()});this.player_.tech_.on("keystatuschange",(function(s){o.playlistController_.updatePlaylistByKeyStatus(s.keyId,s.status)})),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),m?this.createKeySessions_():this.playlistController_.sourceUpdater_.initializedEme()}},{key:"setupQualityLevels_",value:function setupQualityLevels_(){var o=this,s=videojs.players[this.tech_.options_.playerId];s&&s.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=s.qualityLevels(),this.playlistController_.on("selectedinitialmedia",(function(){!function handleVhsLoadedMetadata(o,s){s.representations().forEach((function(s){o.addQualityLevel(s)})),G1(o,s.playlists)}(o.qualityLevels_,o)})),this.playlists.on("mediachange",(function(){G1(o.qualityLevels_,o.playlists)})))}},{key:"version",value:function version(){return this.constructor.version()}},{key:"canChangeType",value:function canChangeType(){return f1.canChangeType()}},{key:"play",value:function play(){this.playlistController_.play()}},{key:"setCurrentTime",value:function setCurrentTime(o){this.playlistController_.setCurrentTime(o)}},{key:"duration",value:function duration(){return this.playlistController_.duration()}},{key:"seekable",value:function seekable(){return this.playlistController_.seekable()}},{key:"dispose",value:function dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&$V.URL.revokeObjectURL&&($V.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),_get$1(_getPrototypeOf$1(VhsHandler.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function convertToProgramTime(o,s){return BZ({playlist:this.playlistController_.media(),time:o,callback:s})}},{key:"seekToProgramTime",value:function seekToProgramTime(o,s){var m=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],_=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return jZ({programTime:o,playlist:this.playlistController_.media(),retryCount:_,pauseAfterSeek:m,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:s})}},{key:"setupXhrHooks_",value:function setupXhrHooks_(){var o=this;this.xhr.onRequest=function(s){J1(o.xhr,s)},this.xhr.onResponse=function(s){Z1(o.xhr,s)},this.xhr.offRequest=function(s){e2(o.xhr,s)},this.xhr.offResponse=function(s){t2(o.xhr,s)},this.player_.trigger("xhr-hooks-ready")}}],[{key:"version",value:function version(){return{"@videojs/http-streaming":K1,"mux.js":"7.0.2","mpd-parser":"1.3.0","m3u8-parser":"7.1.0","aes-decrypter":"4.0.1"}}}]),VhsHandler}(videojs.getComponent("Component")),r2={name:"videojs-http-streaming",VERSION:K1,canHandleSource:function canHandleSource(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=merge$2(videojs.options,s);return r2.canPlayType(o.type,m)},handleSource:function handleSource(o,s){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_=merge$2(videojs.options,m);return s.vhs=new n2(o,s,_),s.vhs.xhr=AZ(),s.vhs.setupXhrHooks_(),s.vhs.src(o.src,o.type),s.vhs},canPlayType:function canPlayType(o,s){var m=TK(o);if(!m)return"";var _=r2.getOverrideNative(s);return!z1.supportsTypeNatively(m)||_?"maybe":""},getOverrideNative:function getOverrideNative(){var o=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).vhs,s=void 0===o?{}:o,m=!(videojs.browser.IS_ANY_SAFARI||videojs.browser.IS_IOS),_=s.overrideNative;return void 0===_?m:_}};(function supportsNativeMediaSources(){return mK("avc1.4d400d,mp4a.40.2")})()&&videojs.getTech("Html5").registerSourceHandler(r2,0),videojs.VhsHandler=n2,videojs.VhsSourceHandler=r2,videojs.Vhs=z1,videojs.use||videojs.registerComponent("Vhs",z1),videojs.options.vhs=videojs.options.vhs||{},videojs.getPlugin&&videojs.getPlugin("reloadSourceOnError")||videojs.registerPlugin("reloadSourceOnError",(function reloadSourceOnError(o){H1(this,o)}));var i2,a2,o2,s2,u2=Math.pow(2,32),getUint64=function(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength);return m.getBigUint64?(s=m.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(s):s:m.getUint32(0)*u2+m.getUint32(4)},parseSidx_1=function(o){var s=new DataView(o.buffer,o.byteOffset,o.byteLength),m={version:o[0],flags:new Uint8Array(o.subarray(1,4)),references:[],referenceId:s.getUint32(4),timescale:s.getUint32(8)},_=12;0===m.version?(m.earliestPresentationTime=s.getUint32(_),m.firstOffset=s.getUint32(_+4),_+=8):(m.earliestPresentationTime=getUint64(o.subarray(_)),m.firstOffset=getUint64(o.subarray(_+8)),_+=16),_+=2;var S=s.getUint16(_);for(_+=2;S>0;_+=12,S--)m.references.push({referenceType:(128&o[_])>>>7,referencedSize:2147483647&s.getUint32(_),subsegmentDuration:s.getUint32(_+4),startsWithSap:!!(128&o[_+8]),sapType:(112&o[_+8])>>>4,sapDeltaTime:268435455&s.getUint32(_+8)});return m},l2=9e4;var c2=l2;
/*! @name @videojs/http-streaming @version 3.10.0 @license Apache-2.0 */i2=function(o){return o*l2},a2=function(o,s){return o*s},o2=function(o){return o/l2},s2=function(o,s){return o/s};const d2=QH,resolveManifestRedirect=(o,s)=>s&&s.responseURL&&o!==s.responseURL?s.responseURL:o,logger=o=>videojs.log.debug?videojs.log.debug.bind(videojs,"VHS:",`${o} >`):function(){};function merge(...o){const s=videojs.obj||videojs;return(s.merge||s.mergeOptions).apply(s,o)}function createTimeRanges(...o){const s=videojs.time||videojs;return(s.createTimeRanges||s.createTimeRanges).apply(s,o)}const h2=1/30,p2=.1,filterRanges=function(o,s){const m=[];let _;if(o&&o.length)for(_=0;_<o.length;_++)s(o.start(_),o.end(_))&&m.push([o.start(_),o.end(_)]);return createTimeRanges(m)},findRange=function(o,s){return filterRanges(o,(function(o,m){return o-p2<=s&&m+p2>=s}))},findNextRange=function(o,s){return filterRanges(o,(function(o){return o-h2>=s}))},printableRange=o=>{const s=[];if(!o||!o.length)return"";for(let m=0;m<o.length;m++)s.push(o.start(m)+" => "+o.end(m));return s.join(", ")},timeRangesToArray=o=>{const s=[];for(let m=0;m<o.length;m++)s.push({start:o.start(m),end:o.end(m)});return s},lastBufferedEnd=function(o){if(o&&o.length&&o.end)return o.end(o.length-1)},timeAheadOf=function(o,s){let m=0;if(!o||!o.length)return m;for(let _=0;_<o.length;_++){const S=o.start(_),E=o.end(_);s>E||(m+=s>S&&s<=E?E-s:E-S)}return m},segmentDurationWithParts=(o,s)=>{if(!s.preload)return s.duration;let m=0;return(s.parts||[]).forEach((function(o){m+=o.duration})),(s.preloadHints||[]).forEach((function(s){"PART"===s.type&&(m+=o.partTargetDuration)})),m},getPartsAndSegments=o=>(o.segments||[]).reduce(((o,s,m)=>(s.parts?s.parts.forEach((function(_,S){o.push({duration:_.duration,segmentIndex:m,partIndex:S,part:_,segment:s})})):o.push({duration:s.duration,segmentIndex:m,partIndex:null,segment:s,part:null}),o)),[]),getLastParts=o=>{const s=o.segments&&o.segments.length&&o.segments[o.segments.length-1];return s&&s.parts||[]},getKnownPartCount=({preloadSegment:o})=>{if(!o)return;const{parts:s,preloadHints:m}=o;let _=(m||[]).reduce(((o,s)=>o+("PART"===s.type?1:0)),0);return _+=s&&s.length?s.length:0,_},liveEdgeDelay=(o,s)=>{if(s.endList)return 0;if(o&&o.suggestedPresentationDelay)return o.suggestedPresentationDelay;const m=getLastParts(s).length>0;return m&&s.serverControl&&s.serverControl.partHoldBack?s.serverControl.partHoldBack:m&&s.partTargetDuration?3*s.partTargetDuration:s.serverControl&&s.serverControl.holdBack?s.serverControl.holdBack:s.targetDuration?3*s.targetDuration:0},intervalDuration=function(o,s,m){if(void 0===s&&(s=o.mediaSequence+o.segments.length),s<o.mediaSequence)return 0;const _=function(o,s){let m=0,_=s-o.mediaSequence,S=o.segments[_];if(S){if(void 0!==S.start)return{result:S.start,precise:!0};if(void 0!==S.end)return{result:S.end-S.duration,precise:!0}}for(;_--;){if(S=o.segments[_],void 0!==S.end)return{result:m+S.end,precise:!0};if(m+=segmentDurationWithParts(o,S),void 0!==S.start)return{result:m+S.start,precise:!0}}return{result:m,precise:!1}}(o,s);if(_.precise)return _.result;const S=function(o,s){let m,_=0,S=s-o.mediaSequence;for(;S<o.segments.length;S++){if(m=o.segments[S],void 0!==m.start)return{result:m.start-_,precise:!0};if(_+=segmentDurationWithParts(o,m),void 0!==m.end)return{result:m.end-_,precise:!0}}return{result:-1,precise:!1}}(o,s);return S.precise?S.result:_.result+m},duration=function(o,s,m){if(!o)return 0;if("number"!=typeof m&&(m=0),void 0===s){if(o.totalDuration)return o.totalDuration;if(!o.endList)return $V.Infinity}return intervalDuration(o,s,m)},sumDurations=function({defaultDuration:o,durationList:s,startIndex:m,endIndex:_}){let S=0;if(m>_&&([m,_]=[_,m]),m<0){for(let s=m;s<Math.min(0,_);s++)S+=o;m=0}for(let o=m;o<_;o++)S+=s[o].duration;return S},playlistEnd=function(o,s,m,_){if(!o||!o.segments)return null;if(o.endList)return duration(o);if(null===s)return null;s=s||0;let S=intervalDuration(o,o.mediaSequence+o.segments.length,s);return m&&(S-=_="number"==typeof _?_:liveEdgeDelay(null,o)),Math.max(0,S)},isExcluded=function(o){return o.excludeUntil&&o.excludeUntil>Date.now()},isIncompatible=function(o){return o.excludeUntil&&o.excludeUntil===1/0},isEnabled=function(o){const s=isExcluded(o);return!o.disabled&&!s},hasAttribute=function(o,s){return s.attributes&&s.attributes[o]},isLowestEnabledRendition=(o,s)=>{if(1===o.playlists.length)return!0;const m=s.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===o.playlists.filter((o=>!!isEnabled(o)&&(o.attributes.BANDWIDTH||0)<m)).length},playlistMatch=(o,s)=>!(!o&&!s||!o&&s||o&&!s)&&(o===s||(!(!o.id||!s.id||o.id!==s.id)||(!(!o.resolvedUri||!s.resolvedUri||o.resolvedUri!==s.resolvedUri)||!(!o.uri||!s.uri||o.uri!==s.uri)))),someAudioVariant=function(o,s){const m=o&&o.mediaGroups&&o.mediaGroups.AUDIO||{};let _=!1;for(const o in m){for(const S in m[o])if(_=s(m[o][S]),_)break;if(_)break}return!!_},isAudioOnly=o=>{if(!o||!o.playlists||!o.playlists.length){return someAudioVariant(o,(o=>o.playlists&&o.playlists.length||o.uri))}for(let s=0;s<o.playlists.length;s++){const m=o.playlists[s],_=m.attributes&&m.attributes.CODECS;if(_&&_.split(",").every((o=>fK(o))))continue;if(!someAudioVariant(o,(o=>playlistMatch(m,o))))return!1}return!0};var f2={liveEdgeDelay:liveEdgeDelay,duration:duration,seekable:function(o,s,m){const _=s||0;let S=playlistEnd(o,s,!0,m);return null===S?createTimeRanges():(S<_&&(S=_),createTimeRanges(_,S))},getMediaInfoForTime:function({playlist:o,currentTime:s,startingSegmentIndex:m,startingPartIndex:_,startTime:S,exactManifestTimings:E}){let A=s-S;const O=getPartsAndSegments(o);let H=0;for(let o=0;o<O.length;o++){const s=O[o];if(m===s.segmentIndex&&("number"!=typeof _||"number"!=typeof s.partIndex||_===s.partIndex)){H=o;break}}if(A<0){if(H>0)for(let s=H-1;s>=0;s--){const m=O[s];if(A+=m.duration,E){if(A<0)continue}else if(A+h2<=0)continue;return{partIndex:m.partIndex,segmentIndex:m.segmentIndex,startTime:S-sumDurations({defaultDuration:o.targetDuration,durationList:O,startIndex:H,endIndex:s})}}return{partIndex:O[0]&&O[0].partIndex||null,segmentIndex:O[0]&&O[0].segmentIndex||0,startTime:s}}if(H<0){for(let m=H;m<0;m++)if(A-=o.targetDuration,A<0)return{partIndex:O[0]&&O[0].partIndex||null,segmentIndex:O[0]&&O[0].segmentIndex||0,startTime:s};H=0}for(let s=H;s<O.length;s++){const m=O[s];A-=m.duration;const _=m.duration>h2;if(!(0===A)&&!(_&&A+h2>=0)||s===O.length-1){if(E){if(A>0)continue}else if(A-h2>=0)continue;return{partIndex:m.partIndex,segmentIndex:m.segmentIndex,startTime:S+sumDurations({defaultDuration:o.targetDuration,durationList:O,startIndex:H,endIndex:s})}}}return{segmentIndex:O[O.length-1].segmentIndex,partIndex:O[O.length-1].partIndex,startTime:s}},isEnabled:isEnabled,isDisabled:function(o){return o.disabled},isExcluded:isExcluded,isIncompatible:isIncompatible,playlistEnd:playlistEnd,isAes:function(o){for(let s=0;s<o.segments.length;s++)if(o.segments[s].key)return!0;return!1},hasAttribute:hasAttribute,estimateSegmentRequestTime:function(o,s,m,_=0){if(!hasAttribute("BANDWIDTH",m))return NaN;return(o*m.attributes.BANDWIDTH-8*_)/s},isLowestEnabledRendition:isLowestEnabledRendition,isAudioOnly:isAudioOnly,playlistMatch:playlistMatch,segmentDurationWithParts:segmentDurationWithParts};const{log:g2}=videojs,createPlaylistID=(o,s)=>`${o}-${s}`,groupID=(o,s,m)=>`placeholder-uri-${o}-${s}-${m}`,forEachMediaGroup=(o,s)=>{o.mediaGroups&&["AUDIO","SUBTITLES"].forEach((m=>{if(o.mediaGroups[m])for(const _ in o.mediaGroups[m])for(const S in o.mediaGroups[m][_]){const E=o.mediaGroups[m][_][S];s(E,m,_,S)}}))},setupMediaPlaylist=({playlist:o,uri:s,id:m})=>{o.id=m,o.playlistErrors_=0,s&&(o.uri=s),o.attributes=o.attributes||{}},addPropertiesToMain=(o,s,m=groupID)=>{o.uri=s;for(let s=0;s<o.playlists.length;s++)if(!o.playlists[s].uri){const m=`placeholder-uri-${s}`;o.playlists[s].uri=m}const _=isAudioOnly(o);forEachMediaGroup(o,((s,S,E,A)=>{if(!s.playlists||!s.playlists.length){if(_&&"AUDIO"===S&&!s.uri)for(let s=0;s<o.playlists.length;s++){const m=o.playlists[s];if(m.attributes&&m.attributes.AUDIO&&m.attributes.AUDIO===E)return}s.playlists=[gH({},s)]}s.playlists.forEach((function(s,_){const O=m(S,E,A,s),H=createPlaylistID(_,O);s.uri?s.resolvedUri=s.resolvedUri||d2(o.uri,s.uri):(s.uri=0===_?O:H,s.resolvedUri=s.uri),s.id=s.id||H,s.attributes=s.attributes||{},o.playlists[s.id]=s,o.playlists[s.uri]=s}))})),(o=>{let s=o.playlists.length;for(;s--;){const m=o.playlists[s];setupMediaPlaylist({playlist:m,id:createPlaylistID(s,m.uri)}),m.resolvedUri=d2(o.uri,m.uri),o.playlists[m.id]=m,o.playlists[m.uri]=m,m.attributes.BANDWIDTH||g2.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}})(o),(o=>{forEachMediaGroup(o,(s=>{s.uri&&(s.resolvedUri=d2(o.uri,s.uri))}))})(o)};class DateRangesStorage{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(o=[]){if(null!==this.offset_)return;if(!o.length)return;const[s]=o;void 0!==s.programDateTime&&(this.offset_=s.programDateTime/1e3)}setPendingDateRanges(o=[]){if(!o.length)return;const[s]=o,m=s.startDate.getTime();this.trimProcessedDateRanges_(m),this.pendingDateRanges_=o.reduce(((o,s)=>(o.set(s.id,s),o)),new Map)}processDateRange(o){this.pendingDateRanges_.delete(o.id),this.processedDateRanges_.set(o.id,o)}getDateRangesToProcess(){if(null===this.offset_)return[];const o={},s=[];this.pendingDateRanges_.forEach(((m,_)=>{if(!this.processedDateRanges_.has(_)&&(m.startTime=m.startDate.getTime()/1e3-this.offset_,m.processDateRange=()=>this.processDateRange(m),s.push(m),m.class))if(o[m.class]){const s=o[m.class].push(m);m.classListIndex=s-1}else o[m.class]=[m],m.classListIndex=0}));for(const m of s){const s=o[m.class]||[];m.endDate?m.endTime=m.endDate.getTime()/1e3-this.offset_:m.endOnNext&&s[m.classListIndex+1]?m.endTime=s[m.classListIndex+1].startTime:m.duration?m.endTime=m.startTime+m.duration:m.plannedDuration?m.endTime=m.startTime+m.plannedDuration:m.endTime=m.startTime}return s}trimProcessedDateRanges_(o){new Map(this.processedDateRanges_).forEach(((s,m)=>{s.startDate.getTime()<o&&this.processedDateRanges_.delete(m)}))}}const{EventTarget:m2}=videojs,updateSegment=(o,s)=>{if(!o)return s;const m=merge(o,s);if(o.preloadHints&&!s.preloadHints&&delete m.preloadHints,o.parts&&!s.parts)delete m.parts;else if(o.parts&&s.parts)for(let _=0;_<s.parts.length;_++)o.parts&&o.parts[_]&&(m.parts[_]=merge(o.parts[_],s.parts[_]));return!o.skipped&&s.skipped&&(m.skipped=!1),o.preload&&!s.preload&&(m.preload=!1),m},resolveSegmentUris=(o,s)=>{!o.resolvedUri&&o.uri&&(o.resolvedUri=d2(s,o.uri)),o.key&&!o.key.resolvedUri&&(o.key.resolvedUri=d2(s,o.key.uri)),o.map&&!o.map.resolvedUri&&(o.map.resolvedUri=d2(s,o.map.uri)),o.map&&o.map.key&&!o.map.key.resolvedUri&&(o.map.key.resolvedUri=d2(s,o.map.key.uri)),o.parts&&o.parts.length&&o.parts.forEach((o=>{o.resolvedUri||(o.resolvedUri=d2(s,o.uri))})),o.preloadHints&&o.preloadHints.length&&o.preloadHints.forEach((o=>{o.resolvedUri||(o.resolvedUri=d2(s,o.uri))}))},getAllSegments=function(o){const s=o.segments||[],m=o.preloadSegment;if(m&&m.parts&&m.parts.length){if(m.preloadHints)for(let o=0;o<m.preloadHints.length;o++)if("MAP"===m.preloadHints[o].type)return s;m.duration=o.targetDuration,m.preload=!0,s.push(m)}return s},isPlaylistUnchanged=(o,s)=>o===s||o.segments&&s.segments&&o.segments.length===s.segments.length&&o.endList===s.endList&&o.mediaSequence===s.mediaSequence&&o.preloadSegment===s.preloadSegment,updateMain$1=(o,s,m=isPlaylistUnchanged)=>{const _=merge(o,{}),S=_.playlists[s.id];if(!S)return null;if(m(S,s))return null;s.segments=getAllSegments(s);const E=merge(S,s);if(E.preloadSegment&&!s.preloadSegment&&delete E.preloadSegment,S.segments){if(s.skip){s.segments=s.segments||[];for(let o=0;o<s.skip.skippedSegments;o++)s.segments.unshift({skipped:!0})}E.segments=((o,s,m)=>{const _=o.slice(),S=s.slice();m=m||0;const E=[];let A;for(let o=0;o<S.length;o++){const s=_[o+m],O=S[o];s?(A=s.map||A,E.push(updateSegment(s,O))):(A&&!O.map&&(O.map=A),E.push(O))}return E})(S.segments,s.segments,s.mediaSequence-S.mediaSequence)}E.segments.forEach((o=>{resolveSegmentUris(o,E.resolvedUri)}));for(let o=0;o<_.playlists.length;o++)_.playlists[o].id===s.id&&(_.playlists[o]=E);return _.playlists[s.id]=E,_.playlists[s.uri]=E,forEachMediaGroup(o,((o,m,_,S)=>{if(o.playlists)for(let m=0;m<o.playlists.length;m++)s.id===o.playlists[m].id&&(o.playlists[m]=E)})),_},refreshDelay=(o,s)=>{const m=o.segments||[],_=m[m.length-1],S=_&&_.parts&&_.parts[_.parts.length-1],E=S&&S.duration||_&&_.duration;return s&&E?1e3*E:500*(o.partTargetDuration||o.targetDuration||10)};class PlaylistLoader extends m2{constructor(o,s,m={}){if(super(),!o)throw new Error("A non-empty playlist URL or object is required");this.logger_=logger("PlaylistLoader");const{withCredentials:_=!1}=m;this.src=o,this.vhs_=s,this.withCredentials=_,this.addDateRangesToTextTrack_=m.addDateRangesToTextTrack;const S=s.options_;this.customTagParsers=S&&S.customTagParsers||[],this.customTagMappers=S&&S.customTagMappers||[],this.llhls=S&&S.llhls,this.dateRangesStorage_=new DateRangesStorage,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const o=this.media();if(!o)return;this.dateRangesStorage_.setOffset(o.segments),this.dateRangesStorage_.setPendingDateRanges(o.dateRanges);const s=this.dateRangesStorage_.getDateRangesToProcess();s.length&&this.addDateRangesToTextTrack_&&this.addDateRangesToTextTrack_(s)}handleMediaupdatetimeout_(){if("HAVE_METADATA"!==this.state)return;const o=this.media();let s=d2(this.main.uri,o.uri);this.llhls&&(s=((o,s)=>{if(s.endList||!s.serverControl)return o;const m={};if(s.serverControl.canBlockReload){const{preloadSegment:o}=s;let _=s.mediaSequence+s.segments.length;if(o){const S=o.parts||[],E=getKnownPartCount(s)-1;E>-1&&E!==S.length-1&&(m._HLS_part=E),(E>-1||S.length)&&_--}m._HLS_msn=_}if(s.serverControl&&s.serverControl.canSkipUntil&&(m._HLS_skip=s.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(m).length){const s=new $V.URL(o);["_HLS_skip","_HLS_msn","_HLS_part"].forEach((function(o){m.hasOwnProperty(o)&&s.searchParams.set(o,m[o])})),o=s.toString()}return o})(s,o)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:s,withCredentials:this.withCredentials},((o,s)=>{if(this.request)return o?this.playlistRequestError(this.request,this.media(),"HAVE_METADATA"):void this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}))}playlistRequestError(o,s,m){const{uri:_,id:S}=s;this.request=null,m&&(this.state=m),this.error={playlist:this.main.playlists[S],status:o.status,message:`HLS playlist request error at URL: ${_}.`,responseText:o.responseText,code:o.status>=500?4:2},this.trigger("error")}parseManifest_({url:o,manifestString:s}){return(({onwarn:o,oninfo:s,manifestString:m,customTagParsers:_=[],customTagMappers:S=[],llhls:E})=>{const A=new sK;o&&A.on("warn",o),s&&A.on("info",s),_.forEach((o=>A.addParser(o))),S.forEach((o=>A.addTagMapper(o))),A.push(m),A.end();const O=A.manifest;if(E||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach((function(o){O.hasOwnProperty(o)&&delete O[o]})),O.segments&&O.segments.forEach((function(o){["parts","preloadHints"].forEach((function(s){o.hasOwnProperty(s)&&delete o[s]}))}))),!O.targetDuration){let s=10;O.segments&&O.segments.length&&(s=O.segments.reduce(((o,s)=>Math.max(o,s.duration)),0)),o&&o({message:`manifest has no targetDuration defaulting to ${s}`}),O.targetDuration=s}const H=getLastParts(O);if(H.length&&!O.partTargetDuration){const s=H.reduce(((o,s)=>Math.max(o,s.duration)),0);o&&(o({message:`manifest has no partTargetDuration defaulting to ${s}`}),g2.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),O.partTargetDuration=s}return O})({onwarn:({message:s})=>this.logger_(`m3u8-parser warn for ${o}: ${s}`),oninfo:({message:s})=>this.logger_(`m3u8-parser info for ${o}: ${s}`),manifestString:s,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}haveMetadata({playlistString:o,playlistObject:s,url:m,id:_}){this.request=null,this.state="HAVE_METADATA";const S=s||this.parseManifest_({url:m,manifestString:o});S.lastRequest=Date.now(),setupMediaPlaylist({playlist:S,uri:m,id:_});const E=updateMain$1(this.main,S);this.targetDuration=S.partTargetDuration||S.targetDuration,this.pendingMedia_=null,E?(this.main=E,this.media_=this.main.playlists[_]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(refreshDelay(this.media(),!!E)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),$V.clearTimeout(this.mediaUpdateTimeout),$V.clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new DateRangesStorage,this.off()}stopRequest(){if(this.request){const o=this.request;this.request=null,o.onreadystatechange=null,o.abort()}}media(o,s){if(!o)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof o){if(!this.main.playlists[o])throw new Error("Unknown playlist URI: "+o);o=this.main.playlists[o]}if($V.clearTimeout(this.finalRenditionTimeout),s){const s=(o.partTargetDuration||o.targetDuration)/2*1e3||5e3;return void(this.finalRenditionTimeout=$V.setTimeout(this.media.bind(this,o,!1),s))}const m=this.state,_=!this.media_||o.id!==this.media_.id,S=this.main.playlists[o.id];if(S&&S.endList||o.endList&&o.segments.length)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=o,void(_&&(this.trigger("mediachanging"),"HAVE_MAIN_MANIFEST"===m?this.trigger("loadedmetadata"):this.trigger("mediachange")));if(this.updateMediaUpdateTimeout_(refreshDelay(o,!0)),_){if(this.state="SWITCHING_MEDIA",this.request){if(o.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=o,this.request=this.vhs_.xhr({uri:o.resolvedUri,withCredentials:this.withCredentials},((s,_)=>{if(this.request){if(o.lastRequest=Date.now(),o.resolvedUri=resolveManifestRedirect(o.resolvedUri,_),s)return this.playlistRequestError(this.request,o,m);this.haveMetadata({playlistString:_.responseText,url:o.uri,id:o.id}),"HAVE_MAIN_MANIFEST"===m?this.trigger("loadedmetadata"):this.trigger("mediachange")}}))}}pause(){this.mediaUpdateTimeout&&($V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}load(o){this.mediaUpdateTimeout&&($V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const s=this.media();if(o){const o=s?(s.partTargetDuration||s.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=$V.setTimeout((()=>{this.mediaUpdateTimeout=null,this.load()}),o)}else this.started?s&&!s.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}updateMediaUpdateTimeout_(o){this.mediaUpdateTimeout&&($V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.media()&&!this.media().endList&&(this.mediaUpdateTimeout=$V.setTimeout((()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(o)}),o))}start(){if(this.started=!0,"object"==typeof this.src)return this.src.uri||(this.src.uri=$V.location.href),this.src.resolvedUri=this.src.uri,void setTimeout((()=>{this.setupInitialPlaylist(this.src)}),0);this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},((o,s)=>{if(!this.request)return;if(this.request=null,o)return this.error={status:s.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:s.responseText,code:2},"HAVE_NOTHING"===this.state&&(this.started=!1),this.trigger("error");this.src=resolveManifestRedirect(this.src,s);const m=this.parseManifest_({manifestString:s.responseText,url:this.src});this.setupInitialPlaylist(m)}))}srcUri(){return"string"==typeof this.src?this.src:this.src.uri}setupInitialPlaylist(o){if(this.state="HAVE_MAIN_MANIFEST",o.playlists)return this.main=o,addPropertiesToMain(this.main,this.srcUri()),o.playlists.forEach((o=>{o.segments=getAllSegments(o),o.segments.forEach((s=>{resolveSegmentUris(s,o.resolvedUri)}))})),this.trigger("loadedplaylist"),void(this.request||this.media(this.main.playlists[0]));const s=this.srcUri()||$V.location.href;this.main=((o,s)=>{const m=createPlaylistID(0,s),_={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:$V.location.href,resolvedUri:$V.location.href,playlists:[{uri:s,id:m,resolvedUri:s,attributes:{}}]};return _.playlists[m]=_.playlists[0],_.playlists[s]=_.playlists[0],_})(0,s),this.haveMetadata({playlistObject:o,url:s,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(o,s){const m=this.main,_=o.ID;let S=m.playlists.length;for(;S--;){const E=m.playlists[S];if(E.attributes["PATHWAY-ID"]===_){const A=E.resolvedUri,O=E.id;if(s){const s=this.createCloneURI_(E.resolvedUri,o),A=createPlaylistID(_,s),O=this.createCloneAttributes_(_,E.attributes),H=this.createClonePlaylist_(E,A,o,O);m.playlists[S]=H,m.playlists[A]=H,m.playlists[s]=H}else m.playlists.splice(S,1);delete m.playlists[O],delete m.playlists[A]}}this.updateOrDeleteCloneMedia(o,s)}updateOrDeleteCloneMedia(o,s){const m=this.main,_=o.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((o=>{if(m.mediaGroups[o]&&m.mediaGroups[o][_])for(const s in m.mediaGroups[o])if(s===_){for(const _ in m.mediaGroups[o][s]){m.mediaGroups[o][s][_].playlists.forEach(((o,s)=>{const _=m.playlists[o.id],S=_.id,E=_.resolvedUri;delete m.playlists[S],delete m.playlists[E]}))}delete m.mediaGroups[o][s]}})),s&&this.createClonedMediaGroups_(o)}addClonePathway(o,s={}){const m=this.main,_=m.playlists.length,S=this.createCloneURI_(s.resolvedUri,o),E=createPlaylistID(o.ID,S),A=this.createCloneAttributes_(o.ID,s.attributes),O=this.createClonePlaylist_(s,E,o,A);m.playlists[_]=O,m.playlists[E]=O,m.playlists[S]=O,this.createClonedMediaGroups_(o)}createClonedMediaGroups_(o){const s=o.ID,m=o["BASE-ID"],_=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((S=>{if(_.mediaGroups[S]&&!_.mediaGroups[S][s])for(const E in _.mediaGroups[S])if(E===m){_.mediaGroups[S][s]={};for(const m in _.mediaGroups[S][E]){const A=_.mediaGroups[S][E][m];_.mediaGroups[S][s][m]=gH({},A);const O=_.mediaGroups[S][s][m],H=this.createCloneURI_(A.resolvedUri,o);O.resolvedUri=H,O.uri=H,O.playlists=[],A.playlists.forEach(((E,A)=>{const H=_.playlists[E.id],K=groupID(S,s,m),z=createPlaylistID(s,K);if(H&&!_.playlists[z]){const s=this.createClonePlaylist_(H,z,o),m=s.resolvedUri;_.playlists[z]=s,_.playlists[m]=s}O.playlists[A]=this.createClonePlaylist_(E,z,o)}))}}}))}createClonePlaylist_(o,s,m,_){const S=this.createCloneURI_(o.resolvedUri,m),E={resolvedUri:S,uri:S,id:s};return o.segments&&(E.segments=[]),_&&(E.attributes=_),merge(o,E)}createCloneURI_(o,s){const m=new URL(o);m.hostname=s["URI-REPLACEMENT"].HOST;const _=s["URI-REPLACEMENT"].PARAMS;for(const o of Object.keys(_))m.searchParams.set(o,_[o]);return m.href}createCloneAttributes_(o,s){const m={"PATHWAY-ID":o};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((_=>{s[_]&&(m[_]=o)})),m}getKeyIdSet(o){if(o.contentProtection){const s=new Set;for(const m in o.contentProtection){const _=o.contentProtection[m].attributes.keyId;_&&s.add(_.toLowerCase())}return s}}}const{xhr:y2}=videojs,callbackWrapper=function(o,s,m,_){const S="arraybuffer"===o.responseType?o.response:o.responseText;!s&&S&&(o.responseTime=Date.now(),o.roundTripTime=o.responseTime-o.requestTime,o.bytesReceived=S.byteLength||S.length,o.bandwidth||(o.bandwidth=Math.floor(o.bytesReceived/o.roundTripTime*8*1e3))),m.headers&&(o.responseHeaders=m.headers),s&&"ETIMEDOUT"===s.code&&(o.timedout=!0),s||o.aborted||200===m.statusCode||206===m.statusCode||0===m.statusCode||(s=new Error("XHR Failed with a response of: "+(o&&(S||o.responseText)))),_(s,o)},xhrFactory=function(){const o=function XhrFunction(o,s){o=merge({timeout:45e3},o);const m=XhrFunction.beforeRequest||videojs.Vhs.xhr.beforeRequest,_=XhrFunction._requestCallbackSet||videojs.Vhs.xhr._requestCallbackSet||new Set,S=XhrFunction._responseCallbackSet||videojs.Vhs.xhr._responseCallbackSet;m&&"function"==typeof m&&(videojs.log.warn("beforeRequest is deprecated, use onRequest instead."),_.add(m));const E=!0===videojs.Vhs.xhr.original?y2:videojs.Vhs.xhr,A=((o,s)=>{if(!o||!o.size)return;let m=s;return o.forEach((o=>{m=o(m)})),m})(_,o);_.delete(m);const O=E(A||o,(function(o,m){return((o,s,m,_)=>{o&&o.size&&o.forEach((o=>{o(s,m,_)}))})(S,O,o,m),callbackWrapper(O,o,m,s)})),H=O.abort;return O.abort=function(){return O.aborted=!0,H.apply(O,arguments)},O.uri=o.uri,O.requestTime=Date.now(),O};return o.original=!0,o},segmentXhrHeaders=function(o){const s={};return o.byterange&&(s.Range=function(o){let s;const m=o.offset;return s="bigint"==typeof o.offset||"bigint"==typeof o.length?$V.BigInt(o.offset)+$V.BigInt(o.length)-$V.BigInt(1):o.offset+o.length-1,"bytes="+m+"-"+s}(o.byterange)),s},textRange=function(o,s){return o.start(s)+"-"+o.end(s)},formatHexString=function(o,s){const m=o.toString(16);return"00".substring(0,2-m.length)+m+(s%2?" ":"")},formatAsciiString=function(o){return o>=32&&o<126?String.fromCharCode(o):"."},createTransferableMessage=function(o){const s={};return Object.keys(o).forEach((m=>{const _=o[m];kK(_)?s[m]={bytes:_.buffer,byteOffset:_.byteOffset,byteLength:_.byteLength}:s[m]=_})),s},initSegmentId=function(o){const s=o.byterange||{length:1/0,offset:0};return[s.length,s.offset,o.resolvedUri].join(",")},segmentKeyId=function(o){return o.resolvedUri},hexDump=o=>{const s=Array.prototype.slice.call(o),m=16;let _,S,E="";for(let o=0;o<s.length/m;o++)_=s.slice(o*m,o*m+m).map(formatHexString).join(""),S=s.slice(o*m,o*m+m).map(formatAsciiString).join(""),E+=_+" "+S+"\n";return E};var v2=Object.freeze({__proto__:null,createTransferableMessage:createTransferableMessage,initSegmentId:initSegmentId,segmentKeyId:segmentKeyId,hexDump:hexDump,tagDump:({bytes:o})=>hexDump(o),textRanges:o=>{let s,m="";for(s=0;s<o.length;s++)m+=textRange(o,s)+" ";return m}});const getProgramTime=({playlist:o,time:s,callback:m})=>{if(!m)throw new Error("getProgramTime: callback must be provided");if(!o||void 0===s)return m({message:"getProgramTime: playlist and time must be provided"});const _=((o,s)=>{if(!s||!s.segments||0===s.segments.length)return null;let m,_=0;for(let S=0;S<s.segments.length&&(m=s.segments[S],_=m.videoTimingInfo?m.videoTimingInfo.transmuxedPresentationEnd:_+m.duration,!(o<=_));S++);const S=s.segments[s.segments.length-1];if(S.videoTimingInfo&&S.videoTimingInfo.transmuxedPresentationEnd<o)return null;if(o>_){if(o>_+.25*S.duration)return null;m=S}return{segment:m,estimatedStart:m.videoTimingInfo?m.videoTimingInfo.transmuxedPresentationStart:_-m.duration,type:m.videoTimingInfo?"accurate":"estimate"}})(s,o);if(!_)return m({message:"valid programTime was not found"});if("estimate"===_.type)return m({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:_.estimatedStart});const S={mediaSeconds:s},E=((o,s)=>{if(!s.dateTimeObject)return null;const m=s.videoTimingInfo.transmuxerPrependedSeconds,_=o-(s.videoTimingInfo.transmuxedPresentationStart+m);return new Date(s.dateTimeObject.getTime()+1e3*_)})(s,_.segment);return E&&(S.programDateTime=E.toISOString()),m(null,S)},seekToProgramTime=({programTime:o,playlist:s,retryCount:m=2,seekTo:_,pauseAfterSeek:S=!0,tech:E,callback:A})=>{if(!A)throw new Error("seekToProgramTime: callback must be provided");if(void 0===o||!s||!_)return A({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!s.endList&&!E.hasStarted_)return A({message:"player must be playing a live stream to start buffering"});if(!(o=>{if(!o.segments||0===o.segments.length)return!1;for(let s=0;s<o.segments.length;s++)if(!o.segments[s].dateTimeObject)return!1;return!0})(s))return A({message:"programDateTime tags must be provided in the manifest "+s.resolvedUri});const O=((o,s)=>{let m;try{m=new Date(o)}catch(o){return null}if(!s||!s.segments||0===s.segments.length)return null;let _=s.segments[0];if(m<new Date(_.dateTimeObject))return null;for(let o=0;o<s.segments.length-1&&(_=s.segments[o],!(m<new Date(s.segments[o+1].dateTimeObject)));o++);const S=s.segments[s.segments.length-1],E=S.dateTimeObject,A=S.videoTimingInfo?(O=S.videoTimingInfo).transmuxedPresentationEnd-O.transmuxedPresentationStart-O.transmuxerPrependedSeconds:S.duration+.25*S.duration;var O;return m>new Date(E.getTime()+1e3*A)?null:(m>new Date(E)&&(_=S),{segment:_,estimatedStart:_.videoTimingInfo?_.videoTimingInfo.transmuxedPresentationStart:f2.duration(s,s.mediaSequence+s.segments.indexOf(_)),type:_.videoTimingInfo?"accurate":"estimate"})})(o,s);if(!O)return A({message:`${o} was not found in the stream`});const H=O.segment,K=((o,s)=>{let m,_;try{m=new Date(o),_=new Date(s)}catch(o){}const S=m.getTime();return(_.getTime()-S)/1e3})(H.dateTimeObject,o);if("estimate"===O.type)return 0===m?A({message:`${o} is not buffered yet. Try again`}):(_(O.estimatedStart+K),void E.one("seeked",(()=>{seekToProgramTime({programTime:o,playlist:s,retryCount:m-1,seekTo:_,pauseAfterSeek:S,tech:E,callback:A})})));const z=H.start+K;E.one("seeked",(()=>A(null,E.currentTime()))),S&&E.pause(),_(z)},callbackOnCompleted=(o,s)=>{if(4===o.readyState)return s()},{EventTarget:_2}=videojs,dashPlaylistUnchanged=function(o,s){if(!isPlaylistUnchanged(o,s))return!1;if(o.sidx&&s.sidx&&(o.sidx.offset!==s.sidx.offset||o.sidx.length!==s.sidx.length))return!1;if(!o.sidx&&s.sidx||o.sidx&&!s.sidx)return!1;if(o.segments&&!s.segments||!o.segments&&s.segments)return!1;if(!o.segments&&!s.segments)return!0;for(let m=0;m<o.segments.length;m++){const _=o.segments[m],S=s.segments[m];if(_.uri!==S.uri)return!1;if(!_.byterange&&!S.byterange)continue;const E=_.byterange,A=S.byterange;if(E&&!A||!E&&A)return!1;if(E.offset!==A.offset||E.length!==A.length)return!1}return!0},dashGroupId=(o,s,m,_)=>`placeholder-uri-${o}-${s}-${_.attributes.NAME||m}`,updateMain=(o,s,m)=>{let _=!0,S=merge(o,{duration:s.duration,minimumUpdatePeriod:s.minimumUpdatePeriod,timelineStarts:s.timelineStarts});for(let o=0;o<s.playlists.length;o++){const E=s.playlists[o];if(E.sidx){const o=hW(E.sidx);m&&m[o]&&m[o].sidx&&oW(E,m[o].sidx,E.sidx.resolvedUri)}const A=updateMain$1(S,E,dashPlaylistUnchanged);A&&(S=A,_=!1)}return forEachMediaGroup(s,((o,s,m,E)=>{if(o.playlists&&o.playlists.length){const A=o.playlists[0].id,O=updateMain$1(S,o.playlists[0],dashPlaylistUnchanged);O&&(S=O,E in S.mediaGroups[s][m]||(S.mediaGroups[s][m][E]=o),S.mediaGroups[s][m][E].playlists[0]=S.playlists[A],_=!1)}})),((o,s)=>{forEachMediaGroup(o,((m,_,S,E)=>{E in s.mediaGroups[_][S]||delete o.mediaGroups[_][S][E]}))})(S,s),s.minimumUpdatePeriod!==o.minimumUpdatePeriod&&(_=!1),_?null:S},equivalentSidx=(o,s)=>(Boolean(!o.map&&!s.map)||Boolean(o.map&&s.map&&o.map.byterange.offset===s.map.byterange.offset&&o.map.byterange.length===s.map.byterange.length))&&o.uri===s.uri&&o.byterange.offset===s.byterange.offset&&o.byterange.length===s.byterange.length,compareSidxEntry=(o,s)=>{const m={};for(const _ in o){const S=o[_].sidx;if(S){const o=hW(S);if(!s[o])break;const _=s[o].sidxInfo;equivalentSidx(_,S)&&(m[o]=s[o])}}return m};class DashPlaylistLoader extends _2{constructor(o,s,m={},_){super(),this.mainPlaylistLoader_=_||this,_||(this.isMain_=!0);const{withCredentials:S=!1}=m;if(this.vhs_=s,this.withCredentials=S,this.addMetadataToTextTrack=m.addMetadataToTextTrack,!o)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",(()=>{this.refreshXml_()})),this.on("mediaupdatetimeout",(()=>{this.refreshMedia_(this.media().id)})),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=logger("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=o,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=o}requestErrored_(o,s,m){return!this.request||(this.request=null,o?(this.error="object"!=typeof o||o instanceof Error?{status:s.status,message:"DASH request error at URL: "+s.uri,response:s.response,code:2}:o,m&&(this.state=m),this.trigger("error"),!0):void 0)}addSidxSegments_(o,s,m){const _=o.sidx&&hW(o.sidx);if(!o.sidx||!_||this.mainPlaylistLoader_.sidxMapping_[_])return void(this.mediaRequest_=$V.setTimeout((()=>m(!1)),0));const S=resolveManifestRedirect(o.sidx.resolvedUri),fin=(S,E)=>{if(this.requestErrored_(S,E,s))return;const A=this.mainPlaylistLoader_.sidxMapping_;let O;try{O=parseSidx_1(CK(E.response).subarray(8))}catch(o){return void this.requestErrored_(o,E,s)}return A[_]={sidxInfo:o.sidx,sidx:O},oW(o,O,o.sidx.resolvedUri),m(!0)};this.request=((o,s,m)=>{let _,S=[],E=!1;const endRequestAndCallback=function(o,s,_,S){return s.abort(),E=!0,m(o,s,_,S)},progressListener=function(o,s){if(E)return;if(o)return endRequestAndCallback(o,s,"",S);const m=s.responseText.substring(S&&S.byteLength||0,s.responseText.length);if(S=PK(S,AK(m,!0)),_=_||YW(S),S.length<10||_&&S.length<_+2)return callbackOnCompleted(s,(()=>endRequestAndCallback(o,s,"",S)));const A=vG(S);return"ts"===A&&S.length<188||!A&&S.length<376?callbackOnCompleted(s,(()=>endRequestAndCallback(o,s,"",S))):endRequestAndCallback(null,s,A,S)},A={uri:o,beforeSend(o){o.overrideMimeType("text/plain; charset=x-user-defined"),o.addEventListener("progress",(function({total:s,loaded:m}){return callbackWrapper(o,null,{statusCode:o.status},progressListener)}))}},O=s(A,(function(o,s){return callbackWrapper(O,o,s,progressListener)}));return O})(S,this.vhs_.xhr,((s,m,_,E)=>{if(s)return fin(s,m);if(!_||"mp4"!==_)return fin({status:m.status,message:`Unsupported ${_||"unknown"} container type for sidx segment at URL: ${S}`,response:"",playlist:o,internal:!0,playlistExclusionDuration:1/0,code:2},m);const{offset:A,length:O}=o.sidx.byterange;if(E.length>=O+A)return fin(s,{response:E.subarray(A,A+O),status:m.status,uri:m.uri});this.request=this.vhs_.xhr({uri:S,responseType:"arraybuffer",headers:segmentXhrHeaders({byterange:o.sidx.byterange})},fin)}))}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},$V.clearTimeout(this.minimumUpdatePeriodTimeout_),$V.clearTimeout(this.mediaRequest_),$V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const o=this.request;this.request=null,o.onreadystatechange=null,o.abort()}}media(o){if(!o)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);const s=this.state;if("string"==typeof o){if(!this.mainPlaylistLoader_.main.playlists[o])throw new Error("Unknown playlist URI: "+o);o=this.mainPlaylistLoader_.main.playlists[o]}const m=!this.media_||o.id!==this.media_.id;if(m&&this.loadedPlaylists_[o.id]&&this.loadedPlaylists_[o.id].endList)return this.state="HAVE_METADATA",this.media_=o,void(m&&(this.trigger("mediachanging"),this.trigger("mediachange")));m&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(o,s,(m=>{this.haveMetadata({startingState:s,playlist:o})})))}haveMetadata({startingState:o,playlist:s}){this.state="HAVE_METADATA",this.loadedPlaylists_[s.id]=s,this.mediaRequest_=null,this.refreshMedia_(s.id),"HAVE_MAIN_MANIFEST"===o?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),$V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&($V.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),"HAVE_NOTHING"===this.state&&(this.started=!1)}load(o){$V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const s=this.media();if(o){const o=s?s.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=$V.setTimeout((()=>this.load()),o)}else this.started?s&&!s.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist"):this.start()}start(){this.started=!0,this.isMain_?this.requestMain_(((o,s)=>{this.haveMain_(),this.hasPendingRequest()||this.media_||this.media(this.mainPlaylistLoader_.main.playlists[0])})):this.mediaRequest_=$V.setTimeout((()=>this.haveMain_()),0)}requestMain_(o){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},((s,m)=>{if(this.requestErrored_(s,m))return void("HAVE_NOTHING"===this.state&&(this.started=!1));const _=m.responseText!==this.mainPlaylistLoader_.mainXml_;return this.mainPlaylistLoader_.mainXml_=m.responseText,m.responseHeaders&&m.responseHeaders.date?this.mainLoaded_=Date.parse(m.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=resolveManifestRedirect(this.mainPlaylistLoader_.srcUrl,m),_?(this.handleMain_(),void this.syncClientServerClock_((()=>o(m,_)))):o(m,_)}))}syncClientServerClock_(o){const s=zW(this.mainPlaylistLoader_.mainXml_);return null===s?(this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),o()):"DIRECT"===s.method?(this.mainPlaylistLoader_.clientOffset_=s.value-Date.now(),o()):void(this.request=this.vhs_.xhr({uri:d2(this.mainPlaylistLoader_.srcUrl,s.value),method:s.method,withCredentials:this.withCredentials},((m,_)=>{if(!this.request)return;if(m)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),o();let S;S="HEAD"===s.method?_.responseHeaders&&_.responseHeaders.date?Date.parse(_.responseHeaders.date):this.mainLoaded_:Date.parse(_.responseText),this.mainPlaylistLoader_.clientOffset_=S-Date.now(),o()})))}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const o=this.mainPlaylistLoader_.main;let s=(({mainXml:o,srcUrl:s,clientOffset:m,sidxMapping:_,previousManifest:S})=>{const E=KW(o,{manifestUri:s,clientOffset:m,sidxMapping:_,previousManifest:S});return addPropertiesToMain(E,s,dashGroupId),E})({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:o});o&&(s=updateMain(o,s,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=s||o;const m=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return m&&m!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=m),(!o||s&&s.minimumUpdatePeriod!==o.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(s),Boolean(s)}updateMinimumUpdatePeriodTimeout_(){const o=this.mainPlaylistLoader_;o.createMupOnMedia_&&(o.off("loadedmetadata",o.createMupOnMedia_),o.createMupOnMedia_=null),o.minimumUpdatePeriodTimeout_&&($V.clearTimeout(o.minimumUpdatePeriodTimeout_),o.minimumUpdatePeriodTimeout_=null);let s=o.main&&o.main.minimumUpdatePeriod;0===s&&(o.media()?s=1e3*o.media().targetDuration:(o.createMupOnMedia_=o.updateMinimumUpdatePeriodTimeout_,o.one("loadedmetadata",o.createMupOnMedia_))),"number"!=typeof s||s<=0?s<0&&this.logger_(`found invalid minimumUpdatePeriod of ${s}, not setting a timeout`):this.createMUPTimeout_(s)}createMUPTimeout_(o){const s=this.mainPlaylistLoader_;s.minimumUpdatePeriodTimeout_=$V.setTimeout((()=>{s.minimumUpdatePeriodTimeout_=null,s.trigger("minimumUpdatePeriod"),s.createMUPTimeout_(o)}),o)}refreshXml_(){this.requestMain_(((o,s)=>{s&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=((o,s)=>{let m=compareSidxEntry(o.playlists,s);return forEachMediaGroup(o,((o,_,S,E)=>{if(o.playlists&&o.playlists.length){const _=o.playlists;m=merge(m,compareSidxEntry(_,s))}})),m})(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,(o=>{this.refreshMedia_(this.media().id)})))}))}refreshMedia_(o){if(!o)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const s=this.mainPlaylistLoader_.main.playlists,m=!this.media_||this.media_!==s[o];if(m?this.media_=s[o]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const createMediaUpdateTimeout=()=>{this.media().endList||(this.mediaUpdateTimeout=$V.setTimeout((()=>{this.trigger("mediaupdatetimeout"),createMediaUpdateTimeout()}),refreshDelay(this.media(),Boolean(m))))};createMediaUpdateTimeout()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(o){if(o&&this.mainPlaylistLoader_.main.eventStream){const o=this.mainPlaylistLoader_.main.eventStream.map((o=>({cueTime:o.start,frames:[{data:o.messageData}]})));this.addMetadataToTextTrack("EventStream",o,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(o){if(o.contentProtection){const s=new Set;for(const m in o.contentProtection){const _=o.contentProtection[m].attributes["cenc:default_KID"];_&&s.add(_.replace(/-/g,"").toLowerCase())}return s}}}var b2={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const browserWorkerPolyFill=function(o){return o.on=o.addEventListener,o.off=o.removeEventListener,o},factory=function(o){return function(){const s=function(o){try{return URL.createObjectURL(new Blob([o],{type:"application/javascript"}))}catch(s){const m=new BlobBuilder;return m.append(o),URL.createObjectURL(m.getBlob())}}(o),m=browserWorkerPolyFill(new Worker(s));m.objURL=s;const _=m.terminate;return m.on=m.addEventListener,m.off=m.removeEventListener,m.terminate=function(){return URL.revokeObjectURL(s),_.call(this)},m}},transform=function(o){return`var browserWorkerPolyFill = ${browserWorkerPolyFill.toString()};\nbrowserWorkerPolyFill(self);\n`+o},getWorkerString=function(o){return o.toString().replace(/^function.+?{/,"").slice(0,-1)},S2=transform(getWorkerString((function(){var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Stream$8=function(){this.init=function(){var o={};this.on=function(s,m){o[s]||(o[s]=[]),o[s]=o[s].concat(m)},this.off=function(s,m){var _;return!!o[s]&&(_=o[s].indexOf(m),o[s]=o[s].slice(),o[s].splice(_,1),_>-1)},this.trigger=function(s){var m,_,S,E;if(m=o[s])if(2===arguments.length)for(S=m.length,_=0;_<S;++_)m[_].call(this,arguments[1]);else{for(E=[],_=arguments.length,_=1;_<arguments.length;++_)E.push(arguments[_]);for(S=m.length,_=0;_<S;++_)m[_].apply(this,E)}},this.dispose=function(){o={}}}};Stream$8.prototype.pipe=function(o){return this.on("data",(function(s){o.push(s)})),this.on("done",(function(s){o.flush(s)})),this.on("partialdone",(function(s){o.partialFlush(s)})),this.on("endedtimeline",(function(s){o.endTimeline(s)})),this.on("reset",(function(s){o.reset(s)})),o},Stream$8.prototype.push=function(o){this.trigger("data",o)},Stream$8.prototype.flush=function(o){this.trigger("done",o)},Stream$8.prototype.partialFlush=function(o){this.trigger("partialdone",o)},Stream$8.prototype.endTimeline=function(o){this.trigger("endedtimeline",o)},Stream$8.prototype.reset=function(o){this.trigger("reset",o)};var s,m,_,S,E,A,O,H,K,z,G,q,X,J,ae,pe,me,_e,Se,Ee,De,$e,He,et,rt,it,at,ot,st,ut,ct,dt,ht,pt,gt,_t,bt,kt,It,At,Lt=Stream$8,Rt=Math.pow(2,32),Mt={getUint64:function(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength);return m.getBigUint64?(s=m.getBigUint64(0))<Number.MAX_SAFE_INTEGER?Number(s):s:m.getUint32(0)*Rt+m.getUint32(4)},MAX_UINT32:Rt},zt=Mt.MAX_UINT32;!function(){var o;if($e={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(o in $e)$e.hasOwnProperty(o)&&($e[o]=[o.charCodeAt(0),o.charCodeAt(1),o.charCodeAt(2),o.charCodeAt(3)]);He=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),rt=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),et=new Uint8Array([0,0,0,1]),it=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),at=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),ot={video:it,audio:at},ct=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ut=new Uint8Array([0,0,0,0,0,0,0,0]),dt=new Uint8Array([0,0,0,0,0,0,0,0]),ht=dt,pt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),gt=dt,st=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),s=function(o){var s,m,_=[],S=0;for(s=1;s<arguments.length;s++)_.push(arguments[s]);for(s=_.length;s--;)S+=_[s].byteLength;for(m=new Uint8Array(S+8),new DataView(m.buffer,m.byteOffset,m.byteLength).setUint32(0,m.byteLength),m.set(o,4),s=0,S=8;s<_.length;s++)m.set(_[s],S),S+=_[s].byteLength;return m},m=function(){return s($e.dinf,s($e.dref,ct))},_=function(o){return s($e.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,o.audioobjecttype<<3|o.samplingfrequencyindex>>>1,o.samplingfrequencyindex<<7|o.channelcount<<3,6,1,2]))},ae=function(o){return s($e.hdlr,ot[o])},J=function(o){var m=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,o.duration>>>24&255,o.duration>>>16&255,o.duration>>>8&255,255&o.duration,85,196,0,0]);return o.samplerate&&(m[12]=o.samplerate>>>24&255,m[13]=o.samplerate>>>16&255,m[14]=o.samplerate>>>8&255,m[15]=255&o.samplerate),s($e.mdhd,m)},X=function(o){return s($e.mdia,J(o),ae(o.type),A(o))},E=function(o){return s($e.mfhd,new Uint8Array([0,0,0,0,(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o]))},A=function(o){return s($e.minf,"video"===o.type?s($e.vmhd,st):s($e.smhd,ut),m(),me(o))},O=function(o,m){for(var _=[],S=m.length;S--;)_[S]=Se(m[S]);return s.apply(null,[$e.moof,E(o)].concat(_))},H=function(o){for(var m=o.length,_=[];m--;)_[m]=G(o[m]);return s.apply(null,[$e.moov,z(4294967295)].concat(_).concat(K(o)))},K=function(o){for(var m=o.length,_=[];m--;)_[m]=Ee(o[m]);return s.apply(null,[$e.mvex].concat(_))},z=function(o){var m=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&o)>>24,(16711680&o)>>16,(65280&o)>>8,255&o,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s($e.mvhd,m)},pe=function(o){var m,_,S=o.samples||[],E=new Uint8Array(4+S.length);for(_=0;_<S.length;_++)m=S[_].flags,E[_+4]=m.dependsOn<<4|m.isDependedOn<<2|m.hasRedundancy;return s($e.sdtp,E)},me=function(o){return s($e.stbl,_e(o),s($e.stts,gt),s($e.stsc,ht),s($e.stsz,pt),s($e.stco,dt))},_e=function(o){return s($e.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===o.type?_t(o):bt(o))},_t=function(o){var m,_,S=o.sps||[],E=o.pps||[],A=[],O=[];for(m=0;m<S.length;m++)A.push((65280&S[m].byteLength)>>>8),A.push(255&S[m].byteLength),A=A.concat(Array.prototype.slice.call(S[m]));for(m=0;m<E.length;m++)O.push((65280&E[m].byteLength)>>>8),O.push(255&E[m].byteLength),O=O.concat(Array.prototype.slice.call(E[m]));if(_=[$e.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&o.width)>>8,255&o.width,(65280&o.height)>>8,255&o.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s($e.avcC,new Uint8Array([1,o.profileIdc,o.profileCompatibility,o.levelIdc,255].concat([S.length],A,[E.length],O))),s($e.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],o.sarRatio){var H=o.sarRatio[0],K=o.sarRatio[1];_.push(s($e.pasp,new Uint8Array([(4278190080&H)>>24,(16711680&H)>>16,(65280&H)>>8,255&H,(4278190080&K)>>24,(16711680&K)>>16,(65280&K)>>8,255&K])))}return s.apply(null,_)},bt=function(o){return s($e.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&o.channelcount)>>8,255&o.channelcount,(65280&o.samplesize)>>8,255&o.samplesize,0,0,0,0,(65280&o.samplerate)>>8,255&o.samplerate,0,0]),_(o))},q=function(o){var m=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,0,(4278190080&o.duration)>>24,(16711680&o.duration)>>16,(65280&o.duration)>>8,255&o.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&o.width)>>8,255&o.width,0,0,(65280&o.height)>>8,255&o.height,0,0]);return s($e.tkhd,m)},Se=function(o){var m,_,S,E,A,O;return m=s($e.tfhd,new Uint8Array([0,0,0,58,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),A=Math.floor(o.baseMediaDecodeTime/zt),O=Math.floor(o.baseMediaDecodeTime%zt),_=s($e.tfdt,new Uint8Array([1,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,255&A,O>>>24&255,O>>>16&255,O>>>8&255,255&O])),92,"audio"===o.type?(S=De(o,92),s($e.traf,m,_,S)):(E=pe(o),S=De(o,E.length+92),s($e.traf,m,_,S,E))},G=function(o){return o.duration=o.duration||4294967295,s($e.trak,q(o),X(o))},Ee=function(o){var m=new Uint8Array([0,0,0,0,(4278190080&o.id)>>24,(16711680&o.id)>>16,(65280&o.id)>>8,255&o.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==o.type&&(m[m.length-1]=0),s($e.trex,m)},At=function(o,s){var m=0,_=0,S=0,E=0;return o.length&&(void 0!==o[0].duration&&(m=1),void 0!==o[0].size&&(_=2),void 0!==o[0].flags&&(S=4),void 0!==o[0].compositionTimeOffset&&(E=8)),[0,0,m|_|S|E,1,(4278190080&o.length)>>>24,(16711680&o.length)>>>16,(65280&o.length)>>>8,255&o.length,(4278190080&s)>>>24,(16711680&s)>>>16,(65280&s)>>>8,255&s]},It=function(o,m){var _,S,E,A,O,H;for(m+=20+16*(A=o.samples||[]).length,E=At(A,m),(S=new Uint8Array(E.length+16*A.length)).set(E),_=E.length,H=0;H<A.length;H++)O=A[H],S[_++]=(4278190080&O.duration)>>>24,S[_++]=(16711680&O.duration)>>>16,S[_++]=(65280&O.duration)>>>8,S[_++]=255&O.duration,S[_++]=(4278190080&O.size)>>>24,S[_++]=(16711680&O.size)>>>16,S[_++]=(65280&O.size)>>>8,S[_++]=255&O.size,S[_++]=O.flags.isLeading<<2|O.flags.dependsOn,S[_++]=O.flags.isDependedOn<<6|O.flags.hasRedundancy<<4|O.flags.paddingValue<<1|O.flags.isNonSyncSample,S[_++]=61440&O.flags.degradationPriority,S[_++]=15&O.flags.degradationPriority,S[_++]=(4278190080&O.compositionTimeOffset)>>>24,S[_++]=(16711680&O.compositionTimeOffset)>>>16,S[_++]=(65280&O.compositionTimeOffset)>>>8,S[_++]=255&O.compositionTimeOffset;return s($e.trun,S)},kt=function(o,m){var _,S,E,A,O,H;for(m+=20+8*(A=o.samples||[]).length,E=At(A,m),(_=new Uint8Array(E.length+8*A.length)).set(E),S=E.length,H=0;H<A.length;H++)O=A[H],_[S++]=(4278190080&O.duration)>>>24,_[S++]=(16711680&O.duration)>>>16,_[S++]=(65280&O.duration)>>>8,_[S++]=255&O.duration,_[S++]=(4278190080&O.size)>>>24,_[S++]=(16711680&O.size)>>>16,_[S++]=(65280&O.size)>>>8,_[S++]=255&O.size;return s($e.trun,_)},De=function(o,s){return"audio"===o.type?kt(o,s):It(o,s)};var qt,Jt,tn,nn,rn,sn,un,pn,vn={ftyp:S=function(){return s($e.ftyp,He,et,He,rt)},mdat:function(o){return s($e.mdat,o)},moof:O,moov:H,initSegment:function(o){var s,m=S(),_=H(o);return(s=new Uint8Array(m.byteLength+_.byteLength)).set(m),s.set(_,m.byteLength),s}},sampleForFrame=function(o,s){var m={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return m.dataOffset=s,m.compositionTimeOffset=o.pts-o.dts,m.duration=o.duration,m.size=4*o.length,m.size+=o.byteLength,o.keyFrame&&(m.flags.dependsOn=2,m.flags.isNonSyncSample=0),m},_n={groupNalsIntoFrames:function(o){var s,m,_=[],S=[];for(S.byteLength=0,S.nalCount=0,S.duration=0,_.byteLength=0,s=0;s<o.length;s++)"access_unit_delimiter_rbsp"===(m=o[s]).nalUnitType?(_.length&&(_.duration=m.dts-_.dts,S.byteLength+=_.byteLength,S.nalCount+=_.length,S.duration+=_.duration,S.push(_)),(_=[m]).byteLength=m.data.byteLength,_.pts=m.pts,_.dts=m.dts):("slice_layer_without_partitioning_rbsp_idr"===m.nalUnitType&&(_.keyFrame=!0),_.duration=m.dts-_.dts,_.byteLength+=m.data.byteLength,_.push(m));return S.length&&(!_.duration||_.duration<=0)&&(_.duration=S[S.length-1].duration),S.byteLength+=_.byteLength,S.nalCount+=_.length,S.duration+=_.duration,S.push(_),S},groupFramesIntoGops:function(o){var s,m,_=[],S=[];for(_.byteLength=0,_.nalCount=0,_.duration=0,_.pts=o[0].pts,_.dts=o[0].dts,S.byteLength=0,S.nalCount=0,S.duration=0,S.pts=o[0].pts,S.dts=o[0].dts,s=0;s<o.length;s++)(m=o[s]).keyFrame?(_.length&&(S.push(_),S.byteLength+=_.byteLength,S.nalCount+=_.nalCount,S.duration+=_.duration),(_=[m]).nalCount=m.length,_.byteLength=m.byteLength,_.pts=m.pts,_.dts=m.dts,_.duration=m.duration):(_.duration+=m.duration,_.nalCount+=m.length,_.byteLength+=m.byteLength,_.push(m));return S.length&&_.duration<=0&&(_.duration=S[S.length-1].duration),S.byteLength+=_.byteLength,S.nalCount+=_.nalCount,S.duration+=_.duration,S.push(_),S},extendFirstKeyFrame:function(o){var s;return!o[0][0].keyFrame&&o.length>1&&(s=o.shift(),o.byteLength-=s.byteLength,o.nalCount-=s.nalCount,o[0][0].dts=s.dts,o[0][0].pts=s.pts,o[0][0].duration+=s.duration),o},generateSampleTable:function(o,s){var m,_,S,E,A,O=s||0,H=[];for(m=0;m<o.length;m++)for(E=o[m],_=0;_<E.length;_++)A=E[_],O+=(S=sampleForFrame(A,O)).size,H.push(S);return H},concatenateNalData:function(o){var s,m,_,S,E,A,O=0,H=o.byteLength,K=o.nalCount,z=new Uint8Array(H+4*K),G=new DataView(z.buffer);for(s=0;s<o.length;s++)for(S=o[s],m=0;m<S.length;m++)for(E=S[m],_=0;_<E.length;_++)A=E[_],G.setUint32(O,A.data.byteLength),O+=4,z.set(A.data,O),O+=A.data.byteLength;return z},generateSampleTableForFrame:function(o,s){var m,_=[];return m=sampleForFrame(o,s||0),_.push(m),_},concatenateNalDataForFrame:function(o){var s,m,_=0,S=o.byteLength,E=o.length,A=new Uint8Array(S+4*E),O=new DataView(A.buffer);for(s=0;s<o.length;s++)m=o[s],O.setUint32(_,m.data.byteLength),_+=4,A.set(m.data,_),_+=m.data.byteLength;return A}},Cn=[33,16,5,32,164,27],wn=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],zeroFill=function(o){for(var s=[];o--;)s.push(0);return s},xn=9e4;sn=function(o,s){return Jt(rn(o,s))},un=function(o,s){return tn(nn(o),s)},pn=function(o,s,m){return nn(m?o:o-s)};var In={ONE_SECOND_IN_TS:xn,secondsToVideoTs:Jt=function(o){return o*xn},secondsToAudioTs:tn=function(o,s){return o*s},videoTsToSeconds:nn=function(o){return o/xn},audioTsToSeconds:rn=function(o,s){return o/s},audioTsToVideoTs:sn,videoTsToAudioTs:un,metadataTsToSeconds:pn},coneOfSilence=function(){if(!qt){var o={96e3:[Cn,[227,64],zeroFill(154),[56]],88200:[Cn,[231],zeroFill(170),[56]],64e3:[Cn,[248,192],zeroFill(240),[56]],48e3:[Cn,[255,192],zeroFill(268),[55,148,128],zeroFill(54),[112]],44100:[Cn,[255,192],zeroFill(268),[55,163,128],zeroFill(84),[112]],32e3:[Cn,[255,192],zeroFill(268),[55,234],zeroFill(226),[112]],24e3:[Cn,[255,192],zeroFill(268),[55,255,128],zeroFill(268),[111,112],zeroFill(126),[224]],16e3:[Cn,[255,192],zeroFill(268),[55,255,128],zeroFill(268),[111,255],zeroFill(269),[223,108],zeroFill(195),[1,192]],12e3:[wn,zeroFill(268),[3,127,248],zeroFill(268),[6,255,240],zeroFill(268),[13,255,224],zeroFill(268),[27,253,128],zeroFill(259),[56]],11025:[wn,zeroFill(268),[3,127,248],zeroFill(268),[6,255,240],zeroFill(268),[13,255,224],zeroFill(268),[27,255,192],zeroFill(268),[55,175,128],zeroFill(108),[112]],8e3:[wn,zeroFill(268),[3,121,16],zeroFill(47),[7]]};s=o,qt=Object.keys(s).reduce((function(o,m){return o[m]=new Uint8Array(s[m].reduce((function(o,s){return o.concat(s)}),[])),o}),{})}var s;return qt},An=In,Fn={prefixWithSilence:function(o,s,m,_){var S,E,A,O,H,K=0,z=0,G=0;if(s.length&&(S=An.audioTsToVideoTs(o.baseMediaDecodeTime,o.samplerate),E=Math.ceil(An.ONE_SECOND_IN_TS/(o.samplerate/1024)),m&&_&&(K=S-Math.max(m,_),G=(z=Math.floor(K/E))*E),!(z<1||G>An.ONE_SECOND_IN_TS/2))){for((A=coneOfSilence()[o.samplerate])||(A=s[0].data),O=0;O<z;O++)H=s[0],s.splice(0,0,{data:A,dts:H.dts-E,pts:H.pts-E});return o.baseMediaDecodeTime-=Math.floor(An.videoTsToAudioTs(G,o.samplerate)),G}},trimAdtsFramesByEarliestDts:function(o,s,m){return s.minSegmentDts>=m?o:(s.minSegmentDts=1/0,o.filter((function(o){return o.dts>=m&&(s.minSegmentDts=Math.min(s.minSegmentDts,o.dts),s.minSegmentPts=s.minSegmentDts,!0)})))},generateSampleTable:function(o){var s,m,_=[];for(s=0;s<o.length;s++)m=o[s],_.push({size:m.data.byteLength,duration:1024});return _},concatenateFrameData:function(o){var s,m,_=0,S=new Uint8Array(function(o){var s,m=0;for(s=0;s<o.length;s++)m+=o[s].data.byteLength;return m}(o));for(s=0;s<o.length;s++)m=o[s],S.set(m.data,_),_+=m.data.byteLength;return S}},Gn=In.ONE_SECOND_IN_TS,qn={clearDtsInfo:function(o){delete o.minSegmentDts,delete o.maxSegmentDts,delete o.minSegmentPts,delete o.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(o,s){var m,_=o.minSegmentDts;return s||(_-=o.timelineStartInfo.dts),m=o.timelineStartInfo.baseMediaDecodeTime,m+=_,m=Math.max(0,m),"audio"===o.type&&(m*=o.samplerate/Gn,m=Math.floor(m)),m},collectDtsInfo:function(o,s){"number"==typeof s.pts&&(void 0===o.timelineStartInfo.pts&&(o.timelineStartInfo.pts=s.pts),void 0===o.minSegmentPts?o.minSegmentPts=s.pts:o.minSegmentPts=Math.min(o.minSegmentPts,s.pts),void 0===o.maxSegmentPts?o.maxSegmentPts=s.pts:o.maxSegmentPts=Math.max(o.maxSegmentPts,s.pts)),"number"==typeof s.dts&&(void 0===o.timelineStartInfo.dts&&(o.timelineStartInfo.dts=s.dts),void 0===o.minSegmentDts?o.minSegmentDts=s.dts:o.minSegmentDts=Math.min(o.minSegmentDts,s.dts),void 0===o.maxSegmentDts?o.maxSegmentDts=s.dts:o.maxSegmentDts=Math.max(o.maxSegmentDts,s.dts))}},ar={parseSei:function(o){for(var s=0,m={payloadType:-1,payloadSize:0},_=0,S=0;s<o.byteLength&&128!==o[s];){for(;255===o[s];)_+=255,s++;for(_+=o[s++];255===o[s];)S+=255,s++;if(S+=o[s++],!m.payload&&4===_){if("GA94"===String.fromCharCode(o[s+3],o[s+4],o[s+5],o[s+6])){m.payloadType=_,m.payloadSize=S,m.payload=o.subarray(s,s+S);break}m.payload=void 0}s+=S,_=0,S=0}return m},parseUserData:function(o){return 181!==o.payload[0]||49!=(o.payload[1]<<8|o.payload[2])||"GA94"!==String.fromCharCode(o.payload[3],o.payload[4],o.payload[5],o.payload[6])||3!==o.payload[7]?null:o.payload.subarray(8,o.payload.length-1)},parseCaptionPackets:function(o,s){var m,_,S,E,A=[];if(!(64&s[0]))return A;for(_=31&s[0],m=0;m<_;m++)E={type:3&s[(S=3*m)+2],pts:o},4&s[S+2]&&(E.ccData=s[S+3]<<8|s[S+4],A.push(E));return A},discardEmulationPreventionBytes:function(o){for(var s,m,_=o.byteLength,S=[],E=1;E<_-2;)0===o[E]&&0===o[E+1]&&3===o[E+2]?(S.push(E+2),E+=2):E++;if(0===S.length)return o;s=_-S.length,m=new Uint8Array(s);var A=0;for(E=0;E<s;A++,E++)A===S[0]&&(A++,S.shift()),m[E]=o[A];return m},USER_DATA_REGISTERED_ITU_T_T35:4},vr=Lt,_r=ar,CaptionStream$2=function(o){o=o||{},CaptionStream$2.prototype.init.call(this),this.parse708captions_="boolean"!=typeof o.parse708captions||o.parse708captions,this.captionPackets_=[],this.ccStreams_=[new Cea608Stream(0,0),new Cea608Stream(0,1),new Cea608Stream(1,0),new Cea608Stream(1,1)],this.parse708captions_&&(this.cc708Stream_=new Cea708Stream({captionServices:o.captionServices})),this.reset(),this.ccStreams_.forEach((function(o){o.on("data",this.trigger.bind(this,"data")),o.on("partialdone",this.trigger.bind(this,"partialdone")),o.on("done",this.trigger.bind(this,"done"))}),this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};CaptionStream$2.prototype=new vr,CaptionStream$2.prototype.push=function(o){var s,m,_;if("sei_rbsp"===o.nalUnitType&&(s=_r.parseSei(o.escapedRBSP)).payload&&s.payloadType===_r.USER_DATA_REGISTERED_ITU_T_T35&&(m=_r.parseUserData(s)))if(o.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(o.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));_=_r.parseCaptionPackets(o.pts,m),this.captionPackets_=this.captionPackets_.concat(_),this.latestDts_!==o.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=o.dts}},CaptionStream$2.prototype.flushCCStreams=function(o){this.ccStreams_.forEach((function(s){return"flush"===o?s.flush():s.partialFlush()}),this)},CaptionStream$2.prototype.flushStream=function(o){this.captionPackets_.length?(this.captionPackets_.forEach((function(o,s){o.presortIndex=s})),this.captionPackets_.sort((function(o,s){return o.pts===s.pts?o.presortIndex-s.presortIndex:o.pts-s.pts})),this.captionPackets_.forEach((function(o){o.type<2?this.dispatchCea608Packet(o):this.dispatchCea708Packet(o)}),this),this.captionPackets_.length=0,this.flushCCStreams(o)):this.flushCCStreams(o)},CaptionStream$2.prototype.flush=function(){return this.flushStream("flush")},CaptionStream$2.prototype.partialFlush=function(){return this.flushStream("partialFlush")},CaptionStream$2.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(o){o.reset()}))},CaptionStream$2.prototype.dispatchCea608Packet=function(o){this.setsTextOrXDSActive(o)?this.activeCea608Channel_[o.type]=null:this.setsChannel1Active(o)?this.activeCea608Channel_[o.type]=0:this.setsChannel2Active(o)&&(this.activeCea608Channel_[o.type]=1),null!==this.activeCea608Channel_[o.type]&&this.ccStreams_[(o.type<<1)+this.activeCea608Channel_[o.type]].push(o)},CaptionStream$2.prototype.setsChannel1Active=function(o){return 4096==(30720&o.ccData)},CaptionStream$2.prototype.setsChannel2Active=function(o){return 6144==(30720&o.ccData)},CaptionStream$2.prototype.setsTextOrXDSActive=function(o){return 256==(28928&o.ccData)||4138==(30974&o.ccData)||6186==(30974&o.ccData)},CaptionStream$2.prototype.dispatchCea708Packet=function(o){this.parse708captions_&&this.cc708Stream_.push(o)};var wr={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},within708TextBlock=function(o){return 32<=o&&o<=127||160<=o&&o<=255},Cea708Window=function(o){this.windowNum=o,this.reset()};Cea708Window.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Cea708Window.prototype.getText=function(){return this.rows.join("\n")},Cea708Window.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Cea708Window.prototype.newLine=function(o){for(this.rows.length>=this.virtualRowCount&&"function"==typeof this.beforeRowOverflow&&this.beforeRowOverflow(o),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Cea708Window.prototype.isEmpty=function(){return 0===this.rows.length||1===this.rows.length&&""===this.rows[0]},Cea708Window.prototype.addText=function(o){this.rows[this.rowIdx]+=o},Cea708Window.prototype.backspace=function(){if(!this.isEmpty()){var o=this.rows[this.rowIdx];this.rows[this.rowIdx]=o.substr(0,o.length-1)}};var Cea708Service=function(o,s,m){this.serviceNum=o,this.text="",this.currentWindow=new Cea708Window(-1),this.windows=[],this.stream=m,"string"==typeof s&&this.createTextDecoder(s)};Cea708Service.prototype.init=function(o,s){this.startPts=o;for(var m=0;m<8;m++)this.windows[m]=new Cea708Window(m),"function"==typeof s&&(this.windows[m].beforeRowOverflow=s)},Cea708Service.prototype.setCurrentWindow=function(o){this.currentWindow=this.windows[o]},Cea708Service.prototype.createTextDecoder=function(o){if("undefined"==typeof TextDecoder)this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(o)}catch(s){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+o+" encoding. "+s})}};var Cea708Stream=function(o){o=o||{},Cea708Stream.prototype.init.call(this);var s,m=this,_=o.captionServices||{},S={};Object.keys(_).forEach((o=>{s=_[o],/^SERVICE/.test(o)&&(S[o]=s.encoding)})),this.serviceEncodings=S,this.current708Packet=null,this.services={},this.push=function(o){3===o.type?(m.new708Packet(),m.add708Bytes(o)):(null===m.current708Packet&&m.new708Packet(),m.add708Bytes(o))}};Cea708Stream.prototype=new vr,Cea708Stream.prototype.new708Packet=function(){null!==this.current708Packet&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Cea708Stream.prototype.add708Bytes=function(o){var s=o.ccData,m=s>>>8,_=255&s;this.current708Packet.ptsVals.push(o.pts),this.current708Packet.data.push(m),this.current708Packet.data.push(_)},Cea708Stream.prototype.push708Packet=function(){var o=this.current708Packet,s=o.data,m=null,_=null,S=0,E=s[S++];for(o.seq=E>>6,o.sizeCode=63&E;S<s.length;S++)_=31&(E=s[S++]),7===(m=E>>5)&&_>0&&(m=E=s[S++]),this.pushServiceBlock(m,S,_),_>0&&(S+=_-1)},Cea708Stream.prototype.pushServiceBlock=function(o,s,m){var _,S=s,E=this.current708Packet.data,A=this.services[o];for(A||(A=this.initService(o,S));S<s+m&&S<E.length;S++)_=E[S],within708TextBlock(_)?S=this.handleText(S,A):24===_?S=this.multiByteCharacter(S,A):16===_?S=this.extendedCommands(S,A):128<=_&&_<=135?S=this.setCurrentWindow(S,A):152<=_&&_<=159?S=this.defineWindow(S,A):136===_?S=this.clearWindows(S,A):140===_?S=this.deleteWindows(S,A):137===_?S=this.displayWindows(S,A):138===_?S=this.hideWindows(S,A):139===_?S=this.toggleWindows(S,A):151===_?S=this.setWindowAttributes(S,A):144===_?S=this.setPenAttributes(S,A):145===_?S=this.setPenColor(S,A):146===_?S=this.setPenLocation(S,A):143===_?A=this.reset(S,A):8===_?A.currentWindow.backspace():12===_?A.currentWindow.clearText():13===_?A.currentWindow.pendingNewLine=!0:14===_?A.currentWindow.clearText():141===_&&S++},Cea708Stream.prototype.extendedCommands=function(o,s){var m=this.current708Packet.data[++o];return within708TextBlock(m)&&(o=this.handleText(o,s,{isExtended:!0})),o},Cea708Stream.prototype.getPts=function(o){return this.current708Packet.ptsVals[Math.floor(o/2)]},Cea708Stream.prototype.initService=function(o,s){var m,_,S=this;return(m="SERVICE"+o)in this.serviceEncodings&&(_=this.serviceEncodings[m]),this.services[o]=new Cea708Service(o,_,S),this.services[o].init(this.getPts(s),(function(s){S.flushDisplayed(s,S.services[o])})),this.services[o]},Cea708Stream.prototype.handleText=function(o,s,m){var _,S,E,A,O=m&&m.isExtended,H=m&&m.isMultiByte,K=this.current708Packet.data,z=O?4096:0,G=K[o],q=K[o+1],X=s.currentWindow;if(H?(S=[G,q],o++):S=[G],s.textDecoder_&&!O)_=s.textDecoder_.decode(new Uint8Array(S));else if(H){const o=function toHexString(o){return o.map((o=>("0"+(255&o).toString(16)).slice(-2))).join("")}(S);_=String.fromCharCode(parseInt(o,16))}else A=wr[E=z|G]||E,_=4096&E&&E===A?"":String.fromCharCode(A);return X.pendingNewLine&&!X.isEmpty()&&X.newLine(this.getPts(o)),X.pendingNewLine=!1,X.addText(_),o},Cea708Stream.prototype.multiByteCharacter=function(o,s){var m=this.current708Packet.data,_=m[o+1],S=m[o+2];return within708TextBlock(_)&&within708TextBlock(S)&&(o=this.handleText(++o,s,{isMultiByte:!0})),o},Cea708Stream.prototype.setCurrentWindow=function(o,s){var m=7&this.current708Packet.data[o];return s.setCurrentWindow(m),o},Cea708Stream.prototype.defineWindow=function(o,s){var m=this.current708Packet.data,_=m[o],S=7&_;s.setCurrentWindow(S);var E=s.currentWindow;return _=m[++o],E.visible=(32&_)>>5,E.rowLock=(16&_)>>4,E.columnLock=(8&_)>>3,E.priority=7&_,_=m[++o],E.relativePositioning=(128&_)>>7,E.anchorVertical=127&_,_=m[++o],E.anchorHorizontal=_,_=m[++o],E.anchorPoint=(240&_)>>4,E.rowCount=15&_,_=m[++o],E.columnCount=63&_,_=m[++o],E.windowStyle=(56&_)>>3,E.penStyle=7&_,E.virtualRowCount=E.rowCount+1,o},Cea708Stream.prototype.setWindowAttributes=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.winAttr;return _=m[++o],S.fillOpacity=(192&_)>>6,S.fillRed=(48&_)>>4,S.fillGreen=(12&_)>>2,S.fillBlue=3&_,_=m[++o],S.borderType=(192&_)>>6,S.borderRed=(48&_)>>4,S.borderGreen=(12&_)>>2,S.borderBlue=3&_,_=m[++o],S.borderType+=(128&_)>>5,S.wordWrap=(64&_)>>6,S.printDirection=(48&_)>>4,S.scrollDirection=(12&_)>>2,S.justify=3&_,_=m[++o],S.effectSpeed=(240&_)>>4,S.effectDirection=(12&_)>>2,S.displayEffect=3&_,o},Cea708Stream.prototype.flushDisplayed=function(o,s){for(var m=[],_=0;_<8;_++)s.windows[_].visible&&!s.windows[_].isEmpty()&&m.push(s.windows[_].getText());s.endPts=o,s.text=m.join("\n\n"),this.pushCaption(s),s.startPts=o},Cea708Stream.prototype.pushCaption=function(o){""!==o.text&&(this.trigger("data",{startPts:o.startPts,endPts:o.endPts,text:o.text,stream:"cc708_"+o.serviceNum}),o.text="",o.startPts=o.endPts)},Cea708Stream.prototype.displayWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible=1);return o},Cea708Stream.prototype.hideWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible=0);return o},Cea708Stream.prototype.toggleWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&(s.windows[S].visible^=1);return o},Cea708Stream.prototype.clearWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&s.windows[S].clearText();return o},Cea708Stream.prototype.deleteWindows=function(o,s){var m=this.current708Packet.data[++o],_=this.getPts(o);this.flushDisplayed(_,s);for(var S=0;S<8;S++)m&1<<S&&s.windows[S].reset();return o},Cea708Stream.prototype.setPenAttributes=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penAttr;return _=m[++o],S.textTag=(240&_)>>4,S.offset=(12&_)>>2,S.penSize=3&_,_=m[++o],S.italics=(128&_)>>7,S.underline=(64&_)>>6,S.edgeType=(56&_)>>3,S.fontStyle=7&_,o},Cea708Stream.prototype.setPenColor=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penColor;return _=m[++o],S.fgOpacity=(192&_)>>6,S.fgRed=(48&_)>>4,S.fgGreen=(12&_)>>2,S.fgBlue=3&_,_=m[++o],S.bgOpacity=(192&_)>>6,S.bgRed=(48&_)>>4,S.bgGreen=(12&_)>>2,S.bgBlue=3&_,_=m[++o],S.edgeRed=(48&_)>>4,S.edgeGreen=(12&_)>>2,S.edgeBlue=3&_,o},Cea708Stream.prototype.setPenLocation=function(o,s){var m=this.current708Packet.data,_=m[o],S=s.currentWindow.penLoc;return s.currentWindow.pendingNewLine=!0,_=m[++o],S.row=15&_,_=m[++o],S.column=63&_,o},Cea708Stream.prototype.reset=function(o,s){var m=this.getPts(o);return this.flushDisplayed(m,s),this.initService(s.serviceNum,o)};var Pr={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},getCharFromCode=function(o){return null===o?"":(o=Pr[o]||o,String.fromCharCode(o))},Or=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],createDisplayBuffer=function(){for(var o=[],s=15;s--;)o.push({text:"",indent:0,offset:0});return o},Cea608Stream=function(o,s){Cea608Stream.prototype.init.call(this),this.field_=o||0,this.dataChannel_=s||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(o){var s,m,_,S,E;if((s=32639&o.ccData)!==this.lastControlCode_){if(4096==(61440&s)?this.lastControlCode_=s:s!==this.PADDING_&&(this.lastControlCode_=null),_=s>>>8,S=255&s,s!==this.PADDING_)if(s===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(s===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(o.pts),this.flushDisplayed(o.pts),m=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=m,this.startPts_=o.pts;else if(s===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(o.pts);else if(s===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(o.pts);else if(s===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(o.pts);else if(s===this.CARRIAGE_RETURN_)this.clearFormatting(o.pts),this.flushDisplayed(o.pts),this.shiftRowsUp_(),this.startPts_=o.pts;else if(s===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(s===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(o.pts),this.displayed_=createDisplayBuffer();else if(s===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=createDisplayBuffer();else if(s===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(o.pts),this.displayed_=createDisplayBuffer()),this.mode_="paintOn",this.startPts_=o.pts;else if(this.isSpecialCharacter(_,S))E=getCharFromCode((_=(3&_)<<8)|S),this[this.mode_](o.pts,E),this.column_++;else if(this.isExtCharacter(_,S))"popOn"===this.mode_?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),E=getCharFromCode((_=(3&_)<<8)|S),this[this.mode_](o.pts,E),this.column_++;else if(this.isMidRowCode(_,S))this.clearFormatting(o.pts),this[this.mode_](o.pts," "),this.column_++,14==(14&S)&&this.addFormatting(o.pts,["i"]),1==(1&S)&&this.addFormatting(o.pts,["u"]);else if(this.isOffsetControlCode(_,S)){const o=3&S;this.nonDisplayed_[this.row_].offset=o,this.column_+=o}else if(this.isPAC(_,S)){var A=Or.indexOf(7968&s);if("rollUp"===this.mode_&&(A-this.rollUpRows_+1<0&&(A=this.rollUpRows_-1),this.setRollUp(o.pts,A)),A!==this.row_&&(this.clearFormatting(o.pts),this.row_=A),1&S&&-1===this.formatting_.indexOf("u")&&this.addFormatting(o.pts,["u"]),16==(16&s)){const o=(14&s)>>1;this.column_=4*o,this.nonDisplayed_[this.row_].indent+=o}this.isColorPAC(S)&&14==(14&S)&&this.addFormatting(o.pts,["i"])}else this.isNormalChar(_)&&(0===S&&(S=null),E=getCharFromCode(_),E+=getCharFromCode(S),this[this.mode_](o.pts,E),this.column_+=E.length)}else this.lastControlCode_=null}};Cea608Stream.prototype=new vr,Cea608Stream.prototype.flushDisplayed=function(o){const logWarning=o=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+o+"."})},s=[];this.displayed_.forEach(((o,m)=>{if(o&&o.text&&o.text.length){try{o.text=o.text.trim()}catch(o){logWarning(m)}o.text.length&&s.push({text:o.text,line:m+1,position:10+Math.min(70,10*o.indent)+2.5*o.offset})}else null==o&&logWarning(m)})),s.length&&this.trigger("data",{startPts:this.startPts_,endPts:o,content:s,stream:this.name_})},Cea608Stream.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=createDisplayBuffer(),this.nonDisplayed_=createDisplayBuffer(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Cea608Stream.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Cea608Stream.prototype.isSpecialCharacter=function(o,s){return o===this.EXT_&&s>=48&&s<=63},Cea608Stream.prototype.isExtCharacter=function(o,s){return(o===this.EXT_+1||o===this.EXT_+2)&&s>=32&&s<=63},Cea608Stream.prototype.isMidRowCode=function(o,s){return o===this.EXT_&&s>=32&&s<=47},Cea608Stream.prototype.isOffsetControlCode=function(o,s){return o===this.OFFSET_&&s>=33&&s<=35},Cea608Stream.prototype.isPAC=function(o,s){return o>=this.BASE_&&o<this.BASE_+8&&s>=64&&s<=127},Cea608Stream.prototype.isColorPAC=function(o){return o>=64&&o<=79||o>=96&&o<=127},Cea608Stream.prototype.isNormalChar=function(o){return o>=32&&o<=127},Cea608Stream.prototype.setRollUp=function(o,s){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(o),this.nonDisplayed_=createDisplayBuffer(),this.displayed_=createDisplayBuffer()),void 0!==s&&s!==this.row_)for(var m=0;m<this.rollUpRows_;m++)this.displayed_[s-m]=this.displayed_[this.row_-m],this.displayed_[this.row_-m]={text:"",indent:0,offset:0};void 0===s&&(s=this.row_),this.topRow_=s-this.rollUpRows_+1},Cea608Stream.prototype.addFormatting=function(o,s){this.formatting_=this.formatting_.concat(s);var m=s.reduce((function(o,s){return o+"<"+s+">"}),"");this[this.mode_](o,m)},Cea608Stream.prototype.clearFormatting=function(o){if(this.formatting_.length){var s=this.formatting_.reverse().reduce((function(o,s){return o+"</"+s+">"}),"");this.formatting_=[],this[this.mode_](o,s)}},Cea608Stream.prototype.popOn=function(o,s){var m=this.nonDisplayed_[this.row_].text;m+=s,this.nonDisplayed_[this.row_].text=m},Cea608Stream.prototype.rollUp=function(o,s){var m=this.displayed_[this.row_].text;m+=s,this.displayed_[this.row_].text=m},Cea608Stream.prototype.shiftRowsUp_=function(){var o;for(o=0;o<this.topRow_;o++)this.displayed_[o]={text:"",indent:0,offset:0};for(o=this.row_+1;o<15;o++)this.displayed_[o]={text:"",indent:0,offset:0};for(o=this.topRow_;o<this.row_;o++)this.displayed_[o]=this.displayed_[o+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},Cea608Stream.prototype.paintOn=function(o,s){var m=this.displayed_[this.row_].text;m+=s,this.displayed_[this.row_].text=m};var Vr={CaptionStream:CaptionStream$2,Cea608Stream:Cea608Stream,Cea708Stream:Cea708Stream},oi={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},li=Lt,hi="shared",handleRollover$1=function(o,s){var m=1;for(o>s&&(m=-1);Math.abs(s-o)>4294967296;)o+=8589934592*m;return o},TimestampRolloverStream$1=function(o){var s,m;TimestampRolloverStream$1.prototype.init.call(this),this.type_=o||hi,this.push=function(o){"metadata"!==o.type?this.type_!==hi&&o.type!==this.type_||(void 0===m&&(m=o.dts),o.dts=handleRollover$1(o.dts,m),o.pts=handleRollover$1(o.pts,m),s=o.dts,this.trigger("data",o)):this.trigger("data",o)},this.flush=function(){m=s,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){m=void 0,s=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};TimestampRolloverStream$1.prototype=new li;var gi,_i={TimestampRolloverStream:TimestampRolloverStream$1,handleRollover:handleRollover$1},typedArray_typedArrayIndexOf=(o,s,m)=>{if(!o)return-1;for(var _=m;_<o.length;_++)if(o[_]===s)return _;return-1},bi=typedArray_typedArrayIndexOf,Ui=3,percentEncode$1=function(o,s,m){var _,S="";for(_=s;_<m;_++)S+="%"+("00"+o[_].toString(16)).slice(-2);return S},parseUtf8=function(o,s,m){return decodeURIComponent(percentEncode$1(o,s,m))},parseIso88591$1=function(o,s,m){return unescape(percentEncode$1(o,s,m))},parseSyncSafeInteger$1=function(o){return o[0]<<21|o[1]<<14|o[2]<<7|o[3]},ta={APIC:function(o){var s,m,_=1;o.data[0]===Ui&&((s=bi(o.data,0,_))<0||(o.mimeType=parseIso88591$1(o.data,_,s),_=s+1,o.pictureType=o.data[_],_++,(m=bi(o.data,0,_))<0||(o.description=parseUtf8(o.data,_,m),_=m+1,"--\x3e"===o.mimeType?o.url=parseIso88591$1(o.data,_,o.data.length):o.pictureData=o.data.subarray(_,o.data.length))))},"T*":function(o){o.data[0]===Ui&&(o.value=parseUtf8(o.data,1,o.data.length).replace(/\0*$/,""),o.values=o.value.split("\0"))},TXXX:function(o){var s;o.data[0]===Ui&&-1!==(s=bi(o.data,0,1))&&(o.description=parseUtf8(o.data,1,s),o.value=parseUtf8(o.data,s+1,o.data.length).replace(/\0*$/,""),o.data=o.value)},"W*":function(o){o.url=parseIso88591$1(o.data,0,o.data.length).replace(/\0.*$/,"")},WXXX:function(o){var s;o.data[0]===Ui&&-1!==(s=bi(o.data,0,1))&&(o.description=parseUtf8(o.data,1,s),o.url=parseIso88591$1(o.data,s+1,o.data.length).replace(/\0.*$/,""))},PRIV:function(o){var s;for(s=0;s<o.data.length;s++)if(0===o.data[s]){o.owner=parseIso88591$1(o.data,0,s);break}o.privateData=o.data.subarray(s+1),o.data=o.privateData}},na={parseId3Frames:function(o){var s,m=10,_=0,S=[];if(!(o.length<10||o[0]!=="I".charCodeAt(0)||o[1]!=="D".charCodeAt(0)||o[2]!=="3".charCodeAt(0))){_=parseSyncSafeInteger$1(o.subarray(6,10)),_+=10,64&o[5]&&(m+=4,m+=parseSyncSafeInteger$1(o.subarray(10,14)),_-=parseSyncSafeInteger$1(o.subarray(16,20)));do{if((s=parseSyncSafeInteger$1(o.subarray(m+4,m+8)))<1)break;var E={id:String.fromCharCode(o[m],o[m+1],o[m+2],o[m+3]),data:o.subarray(m+10,m+s+10)};E.key=E.id,ta[E.id]?ta[E.id](E):"T"===E.id[0]?ta["T*"](E):"W"===E.id[0]&&ta["W*"](E),S.push(E),m+=10,m+=s}while(m<_);return S}},parseSyncSafeInteger:parseSyncSafeInteger$1,frameParsers:ta},aa=Lt,oa=oi,la=na;gi=function(o){var s,m={descriptor:o&&o.descriptor},_=0,S=[],E=0;if(gi.prototype.init.call(this),this.dispatchType=oa.METADATA_STREAM_TYPE.toString(16),m.descriptor)for(s=0;s<m.descriptor.length;s++)this.dispatchType+=("00"+m.descriptor[s].toString(16)).slice(-2);this.push=function(o){var s,m,A,O,H;if("timed-metadata"===o.type)if(o.dataAlignmentIndicator&&(E=0,S.length=0),0===S.length&&(o.data.length<10||o.data[0]!=="I".charCodeAt(0)||o.data[1]!=="D".charCodeAt(0)||o.data[2]!=="3".charCodeAt(0)))this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});else if(S.push(o),E+=o.data.byteLength,1===S.length&&(_=la.parseSyncSafeInteger(o.data.subarray(6,10)),_+=10),!(E<_)){for(s={data:new Uint8Array(_),frames:[],pts:S[0].pts,dts:S[0].dts},H=0;H<_;)s.data.set(S[0].data.subarray(0,_-H),H),H+=S[0].data.byteLength,E-=S[0].data.byteLength,S.shift();m=10,64&s.data[5]&&(m+=4,m+=la.parseSyncSafeInteger(s.data.subarray(10,14)),_-=la.parseSyncSafeInteger(s.data.subarray(16,20)));do{if((A=la.parseSyncSafeInteger(s.data.subarray(m+4,m+8)))<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if((O={id:String.fromCharCode(s.data[m],s.data[m+1],s.data[m+2],s.data[m+3]),data:s.data.subarray(m+10,m+A+10)}).key=O.id,la.frameParsers[O.id]?la.frameParsers[O.id](O):"T"===O.id[0]?la.frameParsers["T*"](O):"W"===O.id[0]&&la.frameParsers["W*"](O),"com.apple.streaming.transportStreamTimestamp"===O.owner){var K=O.data,z=(1&K[3])<<30|K[4]<<22|K[5]<<14|K[6]<<6|K[7]>>>2;z*=4,z+=3&K[7],O.timeStamp=z,void 0===s.pts&&void 0===s.dts&&(s.pts=O.timeStamp,s.dts=O.timeStamp),this.trigger("timestamp",O)}s.frames.push(O),m+=10,m+=A}while(m<_);this.trigger("data",s)}}},gi.prototype=new aa;var ca,da,pa,fa=gi,ga=Lt,ma=Vr,_a=oi,Sa=_i.TimestampRolloverStream,ka=188;(ca=function(){var o=new Uint8Array(ka),s=0;ca.prototype.init.call(this),this.push=function(m){var _,S=0,E=ka;for(s?((_=new Uint8Array(m.byteLength+s)).set(o.subarray(0,s)),_.set(m,s),s=0):_=m;E<_.byteLength;)71!==_[S]||71!==_[E]?(S++,E++):(this.trigger("data",_.subarray(S,E)),S+=ka,E+=ka);S<_.byteLength&&(o.set(_.subarray(S),0),s=_.byteLength-S)},this.flush=function(){s===ka&&71===o[0]&&(this.trigger("data",o),s=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){s=0,this.trigger("reset")}}).prototype=new ga,da=function(){var o,s,m,_;da.prototype.init.call(this),_=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,o=function(o,_){var S=0;_.payloadUnitStartIndicator&&(S+=o[S]+1),"pat"===_.type?s(o.subarray(S),_):m(o.subarray(S),_)},s=function(o,s){s.section_number=o[7],s.last_section_number=o[8],_.pmtPid=(31&o[10])<<8|o[11],s.pmtPid=_.pmtPid},m=function(o,s){var m,S;if(1&o[5]){for(_.programMapTable={video:null,audio:null,"timed-metadata":{}},m=3+((15&o[1])<<8|o[2])-4,S=12+((15&o[10])<<8|o[11]);S<m;){var E=o[S],A=(31&o[S+1])<<8|o[S+2];E===_a.H264_STREAM_TYPE&&null===_.programMapTable.video?_.programMapTable.video=A:E===_a.ADTS_STREAM_TYPE&&null===_.programMapTable.audio?_.programMapTable.audio=A:E===_a.METADATA_STREAM_TYPE&&(_.programMapTable["timed-metadata"][A]=E),S+=5+((15&o[S+3])<<8|o[S+4])}s.programMapTable=_.programMapTable}},this.push=function(s){var m={},_=4;if(m.payloadUnitStartIndicator=!!(64&s[1]),m.pid=31&s[1],m.pid<<=8,m.pid|=s[2],(48&s[3])>>>4>1&&(_+=s[_]+1),0===m.pid)m.type="pat",o(s.subarray(_),m),this.trigger("data",m);else if(m.pid===this.pmtPid)for(m.type="pmt",o(s.subarray(_),m),this.trigger("data",m);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([s,_,m]):this.processPes_(s,_,m)},this.processPes_=function(o,s,m){m.pid===this.programMapTable.video?m.streamType=_a.H264_STREAM_TYPE:m.pid===this.programMapTable.audio?m.streamType=_a.ADTS_STREAM_TYPE:m.streamType=this.programMapTable["timed-metadata"][m.pid],m.type="pes",m.data=o.subarray(s),this.trigger("data",m)}},da.prototype=new ga,da.STREAM_TYPES={h264:27,adts:15},pa=function(){var o,s=this,m=!1,_={data:[],size:0},S={data:[],size:0},E={data:[],size:0},flushStream=function(o,m,_){var S,E,A=new Uint8Array(o.size),O={type:m},H=0,K=0;if(o.data.length&&!(o.size<9)){for(O.trackId=o.data[0].pid,H=0;H<o.data.length;H++)E=o.data[H],A.set(E.data,K),K+=E.data.byteLength;!function(o,s){var m;const _=o[0]<<16|o[1]<<8|o[2];s.data=new Uint8Array,1===_&&(s.packetLength=6+(o[4]<<8|o[5]),s.dataAlignmentIndicator=0!=(4&o[6]),192&(m=o[7])&&(s.pts=(14&o[9])<<27|(255&o[10])<<20|(254&o[11])<<12|(255&o[12])<<5|(254&o[13])>>>3,s.pts*=4,s.pts+=(6&o[13])>>>1,s.dts=s.pts,64&m&&(s.dts=(14&o[14])<<27|(255&o[15])<<20|(254&o[16])<<12|(255&o[17])<<5|(254&o[18])>>>3,s.dts*=4,s.dts+=(6&o[18])>>>1)),s.data=o.subarray(9+o[8]))}(A,O),S="video"===m||O.packetLength<=o.size,(_||S)&&(o.size=0,o.data.length=0),S&&s.trigger("data",O)}};pa.prototype.init.call(this),this.push=function(A){({pat:function(){},pes:function(){var o,s;switch(A.streamType){case _a.H264_STREAM_TYPE:o=_,s="video";break;case _a.ADTS_STREAM_TYPE:o=S,s="audio";break;case _a.METADATA_STREAM_TYPE:o=E,s="timed-metadata";break;default:return}A.payloadUnitStartIndicator&&flushStream(o,s,!0),o.data.push(A),o.size+=A.data.byteLength},pmt:function(){var _={type:"metadata",tracks:[]};null!==(o=A.programMapTable).video&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.video,codec:"avc",type:"video"}),null!==o.audio&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.audio,codec:"adts",type:"audio"}),m=!0,s.trigger("data",_)}})[A.type]()},this.reset=function(){_.size=0,_.data.length=0,S.size=0,S.data.length=0,this.trigger("reset")},this.flushStreams_=function(){flushStream(_,"video"),flushStream(S,"audio"),flushStream(E,"timed-metadata")},this.flush=function(){if(!m&&o){var _={type:"metadata",tracks:[]};null!==o.video&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.video,codec:"avc",type:"video"}),null!==o.audio&&_.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+o.audio,codec:"adts",type:"audio"}),s.trigger("data",_)}m=!1,this.flushStreams_(),this.trigger("done")}},pa.prototype=new ga;var xa={PAT_PID:0,MP2T_PACKET_LENGTH:ka,TransportPacketStream:ca,TransportParseStream:da,ElementaryStream:pa,TimestampRolloverStream:Sa,CaptionStream:ma.CaptionStream,Cea608Stream:ma.Cea608Stream,Cea708Stream:ma.Cea708Stream,MetadataStream:fa};for(var Da in _a)_a.hasOwnProperty(Da)&&(xa[Da]=_a[Da]);var Ra,ja=xa,Va=Lt,za=In.ONE_SECOND_IN_TS,qa=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Ra=function(o){var s,m=0;Ra.prototype.init.call(this),this.skipWarn_=function(o,s){this.trigger("log",{level:"warn",message:`adts skiping bytes ${o} to ${s} in frame ${m} outside syncword`})},this.push=function(_){var S,E,A,O,H,K=0;if(o||(m=0),"audio"===_.type){var z;for(s&&s.length?(A=s,(s=new Uint8Array(A.byteLength+_.data.byteLength)).set(A),s.set(_.data,A.byteLength)):s=_.data;K+7<s.length;)if(255===s[K]&&240==(246&s[K+1])){if("number"==typeof z&&(this.skipWarn_(z,K),z=null),E=2*(1&~s[K+1]),S=(3&s[K+3])<<11|s[K+4]<<3|(224&s[K+5])>>5,H=(O=1024*(1+(3&s[K+6])))*za/qa[(60&s[K+2])>>>2],s.byteLength-K<S)break;this.trigger("data",{pts:_.pts+m*H,dts:_.dts+m*H,sampleCount:O,audioobjecttype:1+(s[K+2]>>>6&3),channelcount:(1&s[K+2])<<2|(192&s[K+3])>>>6,samplerate:qa[(60&s[K+2])>>>2],samplingfrequencyindex:(60&s[K+2])>>>2,samplesize:16,data:s.subarray(K+7+E,K+S)}),m++,K+=S}else"number"!=typeof z&&(z=K),K++;"number"==typeof z&&(this.skipWarn_(z,K),z=null),s=s.subarray(K)}},this.flush=function(){m=0,this.trigger("done")},this.reset=function(){s=void 0,this.trigger("reset")},this.endTimeline=function(){s=void 0,this.trigger("endedtimeline")}},Ra.prototype=new Va;var Qa,Za=Ra;Qa=function(o){var s=o.byteLength,m=0,_=0;this.length=function(){return 8*s},this.bitsAvailable=function(){return 8*s+_},this.loadWord=function(){var S=o.byteLength-s,E=new Uint8Array(4),A=Math.min(4,s);if(0===A)throw new Error("no bytes available");E.set(o.subarray(S,S+A)),m=new DataView(E.buffer).getUint32(0),_=8*A,s-=A},this.skipBits=function(o){var S;_>o?(m<<=o,_-=o):(o-=_,o-=8*(S=Math.floor(o/8)),s-=S,this.loadWord(),m<<=o,_-=o)},this.readBits=function(o){var S=Math.min(_,o),E=m>>>32-S;return(_-=S)>0?m<<=S:s>0&&this.loadWord(),(S=o-S)>0?E<<S|this.readBits(S):E},this.skipLeadingZeros=function(){var o;for(o=0;o<_;++o)if(0!=(m&2147483648>>>o))return m<<=o,_-=o,o;return this.loadWord(),o+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var o=this.skipLeadingZeros();return this.readBits(o+1)-1},this.readExpGolomb=function(){var o=this.readUnsignedExpGolomb();return 1&o?1+o>>>1:-1*(o>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var ro,oo,lo,ho=Lt,po=Qa;oo=function(){var o,s,m=0;oo.prototype.init.call(this),this.push=function(_){var S;s?((S=new Uint8Array(s.byteLength+_.data.byteLength)).set(s),S.set(_.data,s.byteLength),s=S):s=_.data;for(var E=s.byteLength;m<E-3;m++)if(1===s[m+2]){o=m+5;break}for(;o<E;)switch(s[o]){case 0:if(0!==s[o-1]){o+=2;break}if(0!==s[o-2]){o++;break}m+3!==o-2&&this.trigger("data",s.subarray(m+3,o-2));do{o++}while(1!==s[o]&&o<E);m=o-2,o+=3;break;case 1:if(0!==s[o-1]||0!==s[o-2]){o+=3;break}this.trigger("data",s.subarray(m+3,o-2)),m=o-2,o+=3;break;default:o+=3}s=s.subarray(m),o-=m,m=0},this.reset=function(){s=null,m=0,this.trigger("reset")},this.flush=function(){s&&s.byteLength>3&&this.trigger("data",s.subarray(m+3)),s=null,m=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},oo.prototype=new ho,lo={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},ro=function(){var o,s,m,_,S,E,A,O=new oo;ro.prototype.init.call(this),o=this,this.push=function(o){"video"===o.type&&(s=o.trackId,m=o.pts,_=o.dts,O.push(o))},O.on("data",(function(A){var O={trackId:s,pts:m,dts:_,data:A,nalUnitTypeCode:31&A[0]};switch(O.nalUnitTypeCode){case 5:O.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:O.nalUnitType="sei_rbsp",O.escapedRBSP=S(A.subarray(1));break;case 7:O.nalUnitType="seq_parameter_set_rbsp",O.escapedRBSP=S(A.subarray(1)),O.config=E(O.escapedRBSP);break;case 8:O.nalUnitType="pic_parameter_set_rbsp";break;case 9:O.nalUnitType="access_unit_delimiter_rbsp"}o.trigger("data",O)})),O.on("done",(function(){o.trigger("done")})),O.on("partialdone",(function(){o.trigger("partialdone")})),O.on("reset",(function(){o.trigger("reset")})),O.on("endedtimeline",(function(){o.trigger("endedtimeline")})),this.flush=function(){O.flush()},this.partialFlush=function(){O.partialFlush()},this.reset=function(){O.reset()},this.endTimeline=function(){O.endTimeline()},A=function(o,s){var m,_=8,S=8;for(m=0;m<o;m++)0!==S&&(S=(_+s.readExpGolomb()+256)%256),_=0===S?_:S},S=function(o){for(var s,m,_=o.byteLength,S=[],E=1;E<_-2;)0===o[E]&&0===o[E+1]&&3===o[E+2]?(S.push(E+2),E+=2):E++;if(0===S.length)return o;s=_-S.length,m=new Uint8Array(s);var A=0;for(E=0;E<s;A++,E++)A===S[0]&&(A++,S.shift()),m[E]=o[A];return m},E=function(o){var s,m,_,S,E,O,H,K,z,G,q,X,J=0,ae=0,pe=0,me=0,_e=[1,1];if(m=(s=new po(o)).readUnsignedByte(),S=s.readUnsignedByte(),_=s.readUnsignedByte(),s.skipUnsignedExpGolomb(),lo[m]&&(3===(E=s.readUnsignedExpGolomb())&&s.skipBits(1),s.skipUnsignedExpGolomb(),s.skipUnsignedExpGolomb(),s.skipBits(1),s.readBoolean()))for(q=3!==E?8:12,X=0;X<q;X++)s.readBoolean()&&A(X<6?16:64,s);if(s.skipUnsignedExpGolomb(),0===(O=s.readUnsignedExpGolomb()))s.readUnsignedExpGolomb();else if(1===O)for(s.skipBits(1),s.skipExpGolomb(),s.skipExpGolomb(),H=s.readUnsignedExpGolomb(),X=0;X<H;X++)s.skipExpGolomb();if(s.skipUnsignedExpGolomb(),s.skipBits(1),K=s.readUnsignedExpGolomb(),z=s.readUnsignedExpGolomb(),0===(G=s.readBits(1))&&s.skipBits(1),s.skipBits(1),s.readBoolean()&&(J=s.readUnsignedExpGolomb(),ae=s.readUnsignedExpGolomb(),pe=s.readUnsignedExpGolomb(),me=s.readUnsignedExpGolomb()),s.readBoolean()&&s.readBoolean()){switch(s.readUnsignedByte()){case 1:_e=[1,1];break;case 2:_e=[12,11];break;case 3:_e=[10,11];break;case 4:_e=[16,11];break;case 5:_e=[40,33];break;case 6:_e=[24,11];break;case 7:_e=[20,11];break;case 8:_e=[32,11];break;case 9:_e=[80,33];break;case 10:_e=[18,11];break;case 11:_e=[15,11];break;case 12:_e=[64,33];break;case 13:_e=[160,99];break;case 14:_e=[4,3];break;case 15:_e=[3,2];break;case 16:_e=[2,1];break;case 255:_e=[s.readUnsignedByte()<<8|s.readUnsignedByte(),s.readUnsignedByte()<<8|s.readUnsignedByte()]}_e&&(_e[0],_e[1])}return{profileIdc:m,levelIdc:_,profileCompatibility:S,width:16*(K+1)-2*J-2*ae,height:(2-G)*(z+1)*16-2*pe-2*me,sarRatio:_e}}},ro.prototype=new ho;var _o,So={H264Stream:ro,NalByteStream:oo},To=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],parseId3TagSize=function(o,s){var m=o[s+6]<<21|o[s+7]<<14|o[s+8]<<7|o[s+9];return m=m>=0?m:0,(16&o[s+5])>>4?m+20:m+10},getId3Offset=function(o,s){return o.length-s<10||o[s]!=="I".charCodeAt(0)||o[s+1]!=="D".charCodeAt(0)||o[s+2]!=="3".charCodeAt(0)?s:(s+=parseId3TagSize(o,s),getId3Offset(o,s))},parseSyncSafeInteger=function(o){return o[0]<<21|o[1]<<14|o[2]<<7|o[3]},parseIso88591=function(o,s,m){return unescape(function(o,s,m){var _,S="";for(_=s;_<m;_++)S+="%"+("00"+o[_].toString(16)).slice(-2);return S}(o,s,m))},Co={isLikelyAacData:function(o){var s=getId3Offset(o,0);return o.length>=s+2&&255==(255&o[s])&&240==(240&o[s+1])&&16==(22&o[s+1])},parseId3TagSize:parseId3TagSize,parseAdtsSize:function(o,s){var m=(224&o[s+5])>>5,_=o[s+4]<<3;return 6144&o[s+3]|_|m},parseType:function(o,s){return o[s]==="I".charCodeAt(0)&&o[s+1]==="D".charCodeAt(0)&&o[s+2]==="3".charCodeAt(0)?"timed-metadata":!0&o[s]&&240==(240&o[s+1])?"audio":null},parseSampleRate:function(o){for(var s=0;s+5<o.length;){if(255===o[s]&&240==(246&o[s+1]))return To[(60&o[s+2])>>>2];s++}return null},parseAacTimestamp:function(o){var s,m,_;s=10,64&o[5]&&(s+=4,s+=parseSyncSafeInteger(o.subarray(10,14)));do{if((m=parseSyncSafeInteger(o.subarray(s+4,s+8)))<1)return null;if("PRIV"===String.fromCharCode(o[s],o[s+1],o[s+2],o[s+3])){_=o.subarray(s+10,s+m+10);for(var S=0;S<_.byteLength;S++)if(0===_[S]){if("com.apple.streaming.transportStreamTimestamp"===parseIso88591(_,0,S)){var E=_.subarray(S+1),A=(1&E[3])<<30|E[4]<<22|E[5]<<14|E[6]<<6|E[7]>>>2;return A*=4,A+=3&E[7]}break}}s+=10,s+=m}while(s<o.byteLength);return null}},Eo=Co;(_o=function(){var o=new Uint8Array,s=0;_o.prototype.init.call(this),this.setTimestamp=function(o){s=o},this.push=function(m){var _,S,E,A,O=0,H=0;for(o.length?(A=o.length,(o=new Uint8Array(m.byteLength+A)).set(o.subarray(0,A)),o.set(m,A)):o=m;o.length-H>=3;)if(o[H]!=="I".charCodeAt(0)||o[H+1]!=="D".charCodeAt(0)||o[H+2]!=="3".charCodeAt(0))if(255!=(255&o[H])||240!=(240&o[H+1]))H++;else{if(o.length-H<7)break;if(H+(O=Eo.parseAdtsSize(o,H))>o.length)break;E={type:"audio",data:o.subarray(H,H+O),pts:s,dts:s},this.trigger("data",E),H+=O}else{if(o.length-H<10)break;if(H+(O=Eo.parseId3TagSize(o,H))>o.length)break;S={type:"timed-metadata",data:o.subarray(H,H+O)},this.trigger("data",S),H+=O}_=o.length-H,o=_>0?o.subarray(H):new Uint8Array},this.reset=function(){o=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){o=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new Lt;var Io,Lo,Do,Oo,Fo=Lt,No=vn,Bo=_n,Vo=Fn,Ho=qn,Go=ja,qo=In,Qo=Za,as=So.H264Stream,_s=_o,ws=Co.isLikelyAacData,Os=In.ONE_SECOND_IN_TS,Us=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Bs=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],retriggerForStream=function(o,s){s.stream=o,this.trigger("log",s)},addPipelineLogRetriggers=function(o,s){for(var m=Object.keys(s),_=0;_<m.length;_++){var S=m[_];"headOfPipeline"!==S&&s[S].on&&s[S].on("log",retriggerForStream.bind(o,S))}},arrayEquals=function(o,s){var m;if(o.length!==s.length)return!1;for(m=0;m<o.length;m++)if(o[m]!==s[m])return!1;return!0},generateSegmentTimingInfo=function(o,s,m,_,S,E){return{start:{dts:o,pts:o+(m-s)},end:{dts:o+(_-s),pts:o+(S-m)},prependedContentDuration:E,baseMediaDecodeTime:o}};Lo=function(o,s){var m,_=[],S=0,E=0,A=1/0;m=(s=s||{}).firstSequenceNumber||0,Lo.prototype.init.call(this),this.push=function(s){Ho.collectDtsInfo(o,s),o&&Us.forEach((function(m){o[m]=s[m]})),_.push(s)},this.setEarliestDts=function(o){S=o},this.setVideoBaseMediaDecodeTime=function(o){A=o},this.setAudioAppendStart=function(o){E=o},this.flush=function(){var O,H,K,z,G,q,X;0!==_.length?(O=Vo.trimAdtsFramesByEarliestDts(_,o,S),o.baseMediaDecodeTime=Ho.calculateTrackBaseMediaDecodeTime(o,s.keepOriginalTimestamps),X=Vo.prefixWithSilence(o,O,E,A),o.samples=Vo.generateSampleTable(O),K=No.mdat(Vo.concatenateFrameData(O)),_=[],H=No.moof(m,[o]),z=new Uint8Array(H.byteLength+K.byteLength),m++,z.set(H),z.set(K,H.byteLength),Ho.clearDtsInfo(o),G=Math.ceil(1024*Os/o.samplerate),O.length&&(q=O.length*G,this.trigger("segmentTimingInfo",generateSegmentTimingInfo(qo.audioTsToVideoTs(o.baseMediaDecodeTime,o.samplerate),O[0].dts,O[0].pts,O[0].dts+q,O[0].pts+q,X||0)),this.trigger("timingInfo",{start:O[0].pts,end:O[0].pts+q})),this.trigger("data",{track:o,boxes:z}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){Ho.clearDtsInfo(o),_=[],this.trigger("reset")}},Lo.prototype=new Fo,Io=function(o,s){var m,_,S,E=[],A=[];m=(s=s||{}).firstSequenceNumber||0,Io.prototype.init.call(this),delete o.minPTS,this.gopCache_=[],this.push=function(s){Ho.collectDtsInfo(o,s),"seq_parameter_set_rbsp"!==s.nalUnitType||_||(_=s.config,o.sps=[s.data],Bs.forEach((function(s){o[s]=_[s]}),this)),"pic_parameter_set_rbsp"!==s.nalUnitType||S||(S=s.data,o.pps=[s.data]),E.push(s)},this.flush=function(){for(var _,S,O,H,K,z,G,q,X=0;E.length&&"access_unit_delimiter_rbsp"!==E[0].nalUnitType;)E.shift();if(0===E.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(_=Bo.groupNalsIntoFrames(E),(O=Bo.groupFramesIntoGops(_))[0][0].keyFrame||((S=this.getGopForFusion_(E[0],o))?(X=S.duration,O.unshift(S),O.byteLength+=S.byteLength,O.nalCount+=S.nalCount,O.pts=S.pts,O.dts=S.dts,O.duration+=S.duration):O=Bo.extendFirstKeyFrame(O)),A.length){var J;if(!(J=s.alignGopsAtEnd?this.alignGopsAtEnd_(O):this.alignGopsAtStart_(O)))return this.gopCache_.unshift({gop:O.pop(),pps:o.pps,sps:o.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Ho.clearDtsInfo(o),O=J}Ho.collectDtsInfo(o,O),o.samples=Bo.generateSampleTable(O),K=No.mdat(Bo.concatenateNalData(O)),o.baseMediaDecodeTime=Ho.calculateTrackBaseMediaDecodeTime(o,s.keepOriginalTimestamps),this.trigger("processedGopsInfo",O.map((function(o){return{pts:o.pts,dts:o.dts,byteLength:o.byteLength}}))),G=O[0],q=O[O.length-1],this.trigger("segmentTimingInfo",generateSegmentTimingInfo(o.baseMediaDecodeTime,G.dts,G.pts,q.dts+q.duration,q.pts+q.duration,X)),this.trigger("timingInfo",{start:O[0].pts,end:O[O.length-1].pts+O[O.length-1].duration}),this.gopCache_.unshift({gop:O.pop(),pps:o.pps,sps:o.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.trigger("baseMediaDecodeTime",o.baseMediaDecodeTime),this.trigger("timelineStartInfo",o.timelineStartInfo),H=No.moof(m,[o]),z=new Uint8Array(H.byteLength+K.byteLength),m++,z.set(H),z.set(K,H.byteLength),this.trigger("data",{track:o,boxes:z}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),E=[],this.gopCache_.length=0,A.length=0,this.trigger("reset")},this.resetStream_=function(){Ho.clearDtsInfo(o),_=void 0,S=void 0},this.getGopForFusion_=function(s){var m,_,S,E,A,O=1/0;for(A=0;A<this.gopCache_.length;A++)S=(E=this.gopCache_[A]).gop,o.pps&&arrayEquals(o.pps[0],E.pps[0])&&o.sps&&arrayEquals(o.sps[0],E.sps[0])&&(S.dts<o.timelineStartInfo.dts||(m=s.dts-S.dts-S.duration)>=-1e4&&m<=45e3&&(!_||O>m)&&(_=E,O=m));return _?_.gop:null},this.alignGopsAtStart_=function(o){var s,m,_,S,E,O,H,K;for(E=o.byteLength,O=o.nalCount,H=o.duration,s=m=0;s<A.length&&m<o.length&&(_=A[s],S=o[m],_.pts!==S.pts);)S.pts>_.pts?s++:(m++,E-=S.byteLength,O-=S.nalCount,H-=S.duration);return 0===m?o:m===o.length?null:((K=o.slice(m)).byteLength=E,K.duration=H,K.nalCount=O,K.pts=K[0].pts,K.dts=K[0].dts,K)},this.alignGopsAtEnd_=function(o){var s,m,_,S,E,O,H;for(s=A.length-1,m=o.length-1,E=null,O=!1;s>=0&&m>=0;){if(_=A[s],S=o[m],_.pts===S.pts){O=!0;break}_.pts>S.pts?s--:(s===A.length-1&&(E=m),m--)}if(!O&&null===E)return null;if(0===(H=O?m:E))return o;var K=o.slice(H),z=K.reduce((function(o,s){return o.byteLength+=s.byteLength,o.duration+=s.duration,o.nalCount+=s.nalCount,o}),{byteLength:0,duration:0,nalCount:0});return K.byteLength=z.byteLength,K.duration=z.duration,K.nalCount=z.nalCount,K.pts=K[0].pts,K.dts=K[0].dts,K},this.alignGopsWith=function(o){A=o}},Io.prototype=new Fo,Oo=function(o,s){this.numberOfTracks=0,this.metadataStream=s,void 0!==(o=o||{}).remux?this.remuxTracks=!!o.remux:this.remuxTracks=!0,"boolean"==typeof o.keepOriginalTimestamps?this.keepOriginalTimestamps=o.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Oo.prototype.init.call(this),this.push=function(o){return o.content||o.text?this.pendingCaptions.push(o):o.frames?this.pendingMetadata.push(o):(this.pendingTracks.push(o.track),this.pendingBytes+=o.boxes.byteLength,"video"===o.track.type&&(this.videoTrack=o.track,this.pendingBoxes.push(o.boxes)),void("audio"===o.track.type&&(this.audioTrack=o.track,this.pendingBoxes.unshift(o.boxes))))}},Oo.prototype=new Fo,Oo.prototype.flush=function(o){var s,m,_,S,E=0,A={captions:[],captionStreams:{},metadata:[],info:{}},O=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==o&&"AudioSegmentStream"!==o)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(O=this.videoTrack.timelineStartInfo.pts,Bs.forEach((function(o){A.info[o]=this.videoTrack[o]}),this)):this.audioTrack&&(O=this.audioTrack.timelineStartInfo.pts,Us.forEach((function(o){A.info[o]=this.audioTrack[o]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?A.type=this.pendingTracks[0].type:A.type="combined",this.emittedTracks+=this.pendingTracks.length,_=No.initSegment(this.pendingTracks),A.initSegment=new Uint8Array(_.byteLength),A.initSegment.set(_),A.data=new Uint8Array(this.pendingBytes),S=0;S<this.pendingBoxes.length;S++)A.data.set(this.pendingBoxes[S],E),E+=this.pendingBoxes[S].byteLength;for(S=0;S<this.pendingCaptions.length;S++)(s=this.pendingCaptions[S]).startTime=qo.metadataTsToSeconds(s.startPts,O,this.keepOriginalTimestamps),s.endTime=qo.metadataTsToSeconds(s.endPts,O,this.keepOriginalTimestamps),A.captionStreams[s.stream]=!0,A.captions.push(s);for(S=0;S<this.pendingMetadata.length;S++)(m=this.pendingMetadata[S]).cueTime=qo.metadataTsToSeconds(m.pts,O,this.keepOriginalTimestamps),A.metadata.push(m);for(A.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",A),S=0;S<A.captions.length;S++)s=A.captions[S],this.trigger("caption",s);for(S=0;S<A.metadata.length;S++)m=A.metadata[S],this.trigger("id3Frame",m)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Oo.prototype.setRemux=function(o){this.remuxTracks=o},Do=function(o){var s,m,_=this,S=!0;Do.prototype.init.call(this),o=o||{},this.baseMediaDecodeTime=o.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var S={};this.transmuxPipeline_=S,S.type="aac",S.metadataStream=new Go.MetadataStream,S.aacStream=new _s,S.audioTimestampRolloverStream=new Go.TimestampRolloverStream("audio"),S.timedMetadataTimestampRolloverStream=new Go.TimestampRolloverStream("timed-metadata"),S.adtsStream=new Qo,S.coalesceStream=new Oo(o,S.metadataStream),S.headOfPipeline=S.aacStream,S.aacStream.pipe(S.audioTimestampRolloverStream).pipe(S.adtsStream),S.aacStream.pipe(S.timedMetadataTimestampRolloverStream).pipe(S.metadataStream).pipe(S.coalesceStream),S.metadataStream.on("timestamp",(function(o){S.aacStream.setTimestamp(o.timeStamp)})),S.aacStream.on("data",(function(E){"timed-metadata"!==E.type&&"audio"!==E.type||S.audioSegmentStream||(m=m||{timelineStartInfo:{baseMediaDecodeTime:_.baseMediaDecodeTime},codec:"adts",type:"audio"},S.coalesceStream.numberOfTracks++,S.audioSegmentStream=new Lo(m,o),S.audioSegmentStream.on("log",_.getLogTrigger_("audioSegmentStream")),S.audioSegmentStream.on("timingInfo",_.trigger.bind(_,"audioTimingInfo")),S.adtsStream.pipe(S.audioSegmentStream).pipe(S.coalesceStream),_.trigger("trackinfo",{hasAudio:!!m,hasVideo:!!s}))})),S.coalesceStream.on("data",this.trigger.bind(this,"data")),S.coalesceStream.on("done",this.trigger.bind(this,"done")),addPipelineLogRetriggers(this,S)},this.setupTsPipeline=function(){var S={};this.transmuxPipeline_=S,S.type="ts",S.metadataStream=new Go.MetadataStream,S.packetStream=new Go.TransportPacketStream,S.parseStream=new Go.TransportParseStream,S.elementaryStream=new Go.ElementaryStream,S.timestampRolloverStream=new Go.TimestampRolloverStream,S.adtsStream=new Qo,S.h264Stream=new as,S.captionStream=new Go.CaptionStream(o),S.coalesceStream=new Oo(o,S.metadataStream),S.headOfPipeline=S.packetStream,S.packetStream.pipe(S.parseStream).pipe(S.elementaryStream).pipe(S.timestampRolloverStream),S.timestampRolloverStream.pipe(S.h264Stream),S.timestampRolloverStream.pipe(S.adtsStream),S.timestampRolloverStream.pipe(S.metadataStream).pipe(S.coalesceStream),S.h264Stream.pipe(S.captionStream).pipe(S.coalesceStream),S.elementaryStream.on("data",(function(E){var A;if("metadata"===E.type){for(A=E.tracks.length;A--;)s||"video"!==E.tracks[A].type?m||"audio"!==E.tracks[A].type||((m=E.tracks[A]).timelineStartInfo.baseMediaDecodeTime=_.baseMediaDecodeTime):(s=E.tracks[A]).timelineStartInfo.baseMediaDecodeTime=_.baseMediaDecodeTime;s&&!S.videoSegmentStream&&(S.coalesceStream.numberOfTracks++,S.videoSegmentStream=new Io(s,o),S.videoSegmentStream.on("log",_.getLogTrigger_("videoSegmentStream")),S.videoSegmentStream.on("timelineStartInfo",(function(s){m&&!o.keepOriginalTimestamps&&(m.timelineStartInfo=s,S.audioSegmentStream.setEarliestDts(s.dts-_.baseMediaDecodeTime))})),S.videoSegmentStream.on("processedGopsInfo",_.trigger.bind(_,"gopInfo")),S.videoSegmentStream.on("segmentTimingInfo",_.trigger.bind(_,"videoSegmentTimingInfo")),S.videoSegmentStream.on("baseMediaDecodeTime",(function(o){m&&S.audioSegmentStream.setVideoBaseMediaDecodeTime(o)})),S.videoSegmentStream.on("timingInfo",_.trigger.bind(_,"videoTimingInfo")),S.h264Stream.pipe(S.videoSegmentStream).pipe(S.coalesceStream)),m&&!S.audioSegmentStream&&(S.coalesceStream.numberOfTracks++,S.audioSegmentStream=new Lo(m,o),S.audioSegmentStream.on("log",_.getLogTrigger_("audioSegmentStream")),S.audioSegmentStream.on("timingInfo",_.trigger.bind(_,"audioTimingInfo")),S.audioSegmentStream.on("segmentTimingInfo",_.trigger.bind(_,"audioSegmentTimingInfo")),S.adtsStream.pipe(S.audioSegmentStream).pipe(S.coalesceStream)),_.trigger("trackinfo",{hasAudio:!!m,hasVideo:!!s})}})),S.coalesceStream.on("data",this.trigger.bind(this,"data")),S.coalesceStream.on("id3Frame",(function(o){o.dispatchType=S.metadataStream.dispatchType,_.trigger("id3Frame",o)})),S.coalesceStream.on("caption",this.trigger.bind(this,"caption")),S.coalesceStream.on("done",this.trigger.bind(this,"done")),addPipelineLogRetriggers(this,S)},this.setBaseMediaDecodeTime=function(_){var S=this.transmuxPipeline_;o.keepOriginalTimestamps||(this.baseMediaDecodeTime=_),m&&(m.timelineStartInfo.dts=void 0,m.timelineStartInfo.pts=void 0,Ho.clearDtsInfo(m),S.audioTimestampRolloverStream&&S.audioTimestampRolloverStream.discontinuity()),s&&(S.videoSegmentStream&&(S.videoSegmentStream.gopCache_=[]),s.timelineStartInfo.dts=void 0,s.timelineStartInfo.pts=void 0,Ho.clearDtsInfo(s),S.captionStream.reset()),S.timestampRolloverStream&&S.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(o){m&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(o)},this.setRemux=function(s){var m=this.transmuxPipeline_;o.remux=s,m&&m.coalesceStream&&m.coalesceStream.setRemux(s)},this.alignGopsWith=function(o){s&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(o)},this.getLogTrigger_=function(o){var s=this;return function(m){m.stream=o,s.trigger("log",m)}},this.push=function(o){if(S){var s=ws(o);s&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():s||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),S=!1}this.transmuxPipeline_.headOfPipeline.push(o)},this.flush=function(){S=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Do.prototype=new Fo;var Hs,Ys,Zs,pu,_u,vl={Transmuxer:Do,VideoSegmentStream:Io,AudioSegmentStream:Lo,AUDIO_PROPERTIES:Us,VIDEO_PROPERTIES:Bs,generateSegmentTimingInfo:generateSegmentTimingInfo},bin_toUnsigned=function(o){return o>>>0},parseType_1=function(o){var s="";return s+=String.fromCharCode(o[0]),s+=String.fromCharCode(o[1]),s+=String.fromCharCode(o[2]),s+=String.fromCharCode(o[3])},_l=bin_toUnsigned,Pl=parseType_1,findBox$2=function(o,s){var m,_,S,E,A,O=[];if(!s.length)return null;for(m=0;m<o.byteLength;)_=_l(o[m]<<24|o[m+1]<<16|o[m+2]<<8|o[m+3]),S=Pl(o.subarray(m+4,m+8)),E=_>1?m+_:o.byteLength,S===s[0]&&(1===s.length?O.push(o.subarray(m+8,E)):(A=findBox$2(o.subarray(m+8,E),s.slice(1))).length&&(O=O.concat(A))),m=E;return O},Ql=bin_toUnsigned,nc=Mt.getUint64,parseTfdt$2=function(o){var s={version:o[0],flags:new Uint8Array(o.subarray(1,4))};return 1===s.version?s.baseMediaDecodeTime=nc(o.subarray(4)):s.baseMediaDecodeTime=Ql(o[4]<<24|o[5]<<16|o[6]<<8|o[7]),s},parseSampleFlags=function(o){return{isLeading:(12&o[0])>>>2,dependsOn:3&o[0],isDependedOn:(192&o[1])>>>6,hasRedundancy:(48&o[1])>>>4,paddingValue:(14&o[1])>>>1,isNonSyncSample:1&o[1],degradationPriority:o[2]<<8|o[3]}},parseTrun$2=function(o){var s,m={version:o[0],flags:new Uint8Array(o.subarray(1,4)),samples:[]},_=new DataView(o.buffer,o.byteOffset,o.byteLength),S=1&m.flags[2],E=4&m.flags[2],A=1&m.flags[1],O=2&m.flags[1],H=4&m.flags[1],K=8&m.flags[1],z=_.getUint32(4),G=8;for(S&&(m.dataOffset=_.getInt32(G),G+=4),E&&z&&(s={flags:parseSampleFlags(o.subarray(G,G+4))},G+=4,A&&(s.duration=_.getUint32(G),G+=4),O&&(s.size=_.getUint32(G),G+=4),K&&(1===m.version?s.compositionTimeOffset=_.getInt32(G):s.compositionTimeOffset=_.getUint32(G),G+=4),m.samples.push(s),z--);z--;)s={},A&&(s.duration=_.getUint32(G),G+=4),O&&(s.size=_.getUint32(G),G+=4),H&&(s.flags=parseSampleFlags(o.subarray(G,G+4)),G+=4),K&&(1===m.version?s.compositionTimeOffset=_.getInt32(G):s.compositionTimeOffset=_.getUint32(G),G+=4),m.samples.push(s);return m},parseTfhd$2=function(o){var s,m=new DataView(o.buffer,o.byteOffset,o.byteLength),_={version:o[0],flags:new Uint8Array(o.subarray(1,4)),trackId:m.getUint32(4)},S=1&_.flags[2],E=2&_.flags[2],A=8&_.flags[2],O=16&_.flags[2],H=32&_.flags[2],K=65536&_.flags[0],z=131072&_.flags[0];return s=8,S&&(s+=4,_.baseDataOffset=m.getUint32(12),s+=4),E&&(_.sampleDescriptionIndex=m.getUint32(s),s+=4),A&&(_.defaultSampleDuration=m.getUint32(s),s+=4),O&&(_.defaultSampleSize=m.getUint32(s),s+=4),H&&(_.defaultSampleFlags=m.getUint32(s)),K&&(_.durationIsEmpty=!0),!S&&z&&(_.baseDataOffsetIsMoof=!0),_},ic=(Hs="undefined"!=typeof window?window:void 0!==o?o:"undefined"!=typeof self?self:{},ar.discardEmulationPreventionBytes),ac=Vr.CaptionStream,lc=findBox$2,mc=parseTfdt$2,yc=parseTrun$2,_c=parseTfhd$2,kc=Hs,mapToSample=function(o,s){for(var m=o,_=0;_<s.length;_++){var S=s[_];if(m<S.size)return S;m-=S.size}return null},parseCaptionNals=function(o,s){var m=lc(o,["moof","traf"]),_=lc(o,["mdat"]),S={},E=[];return _.forEach((function(o,s){var _=m[s];E.push({mdat:o,traf:_})})),E.forEach((function(o){var m,_,E=o.mdat,A=o.traf,O=lc(A,["tfhd"]),H=_c(O[0]),K=H.trackId,z=lc(A,["tfdt"]),G=z.length>0?mc(z[0]).baseMediaDecodeTime:0,q=lc(A,["trun"]);s===K&&q.length>0&&(m=function(o,s,m){var _=s,S=m.defaultSampleDuration||0,E=m.defaultSampleSize||0,A=m.trackId,O=[];return o.forEach((function(o){var s=yc(o).samples;s.forEach((function(o){void 0===o.duration&&(o.duration=S),void 0===o.size&&(o.size=E),o.trackId=A,o.dts=_,void 0===o.compositionTimeOffset&&(o.compositionTimeOffset=0),"bigint"==typeof _?(o.pts=_+kc.BigInt(o.compositionTimeOffset),_+=kc.BigInt(o.duration)):(o.pts=_+o.compositionTimeOffset,_+=o.duration)})),O=O.concat(s)})),O}(q,G,H),_=function(o,s,m){var _,S,E,A,O=new DataView(o.buffer,o.byteOffset,o.byteLength),H={logs:[],seiNals:[]};for(S=0;S+4<o.length;S+=E)if(E=O.getUint32(S),S+=4,!(E<=0))switch(31&o[S]){case 6:var K=o.subarray(S+1,S+1+E),z=mapToSample(S,s);if(_={nalUnitType:"sei_rbsp",size:E,data:K,escapedRBSP:ic(K),trackId:m},z)_.pts=z.pts,_.dts=z.dts,A=z;else{if(!A){H.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+S+" for trackId "+m+". See mux.js#223."});break}_.pts=A.pts,_.dts=A.dts}H.seiNals.push(_)}return H}(E,m,K),S[K]||(S[K]={seiNals:[],logs:[]}),S[K].seiNals=S[K].seiNals.concat(_.seiNals),S[K].logs=S[K].logs.concat(_.logs))})),S},captionParser=function(){var o,s,m,_,S,E,A=!1;this.isInitialized=function(){return A},this.init=function(s){o=new ac,A=!0,E=!!s&&s.isPartial,o.on("data",(function(o){o.startTime=o.startPts/_,o.endTime=o.endPts/_,S.captions.push(o),S.captionStreams[o.stream]=!0})),o.on("log",(function(o){S.logs.push(o)}))},this.isNewInit=function(o,s){return!(o&&0===o.length||s&&"object"==typeof s&&0===Object.keys(s).length)&&(m!==o[0]||_!==s[m])},this.parse=function(o,E,A){var O;if(!this.isInitialized())return null;if(!E||!A)return null;if(this.isNewInit(E,A))m=E[0],_=A[m];else if(null===m||!_)return s.push(o),null;for(;s.length>0;){var H=s.shift();this.parse(H,E,A)}return O=function(o,s,m){if(null===s)return null;var _=parseCaptionNals(o,s)[s]||{};return{seiNals:_.seiNals,logs:_.logs,timescale:m}}(o,m,_),O&&O.logs&&(S.logs=S.logs.concat(O.logs)),null!==O&&O.seiNals?(this.pushNals(O.seiNals),this.flushStream(),S):S.logs.length?{logs:S.logs,captions:[],captionStreams:[]}:null},this.pushNals=function(s){if(!this.isInitialized()||!s||0===s.length)return null;s.forEach((function(s){o.push(s)}))},this.flushStream=function(){if(!this.isInitialized())return null;E?o.partialFlush():o.flush()},this.clearParsedCaptions=function(){S.captions=[],S.captionStreams={},S.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;o.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){s=[],m=null,_=null,S?this.clearParsedCaptions():S={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},string_uint8ToCString=function(o){for(var s=0,m=String.fromCharCode(o[s]),_="";"\0"!==m;)_+=m,s++,m=String.fromCharCode(o[s]);return _+=m},Ec=string_uint8ToCString,Ac=Mt.getUint64,isValidEmsgBox=function(o,s){var m="\0"!==s.scheme_id_uri,_=0===o&&isDefined(s.presentation_time_delta)&&m,S=1===o&&isDefined(s.presentation_time)&&m;return!(o>1)&&_||S},isDefined=function(o){return void 0!==o||null!==o},Dc={parseEmsgBox:function(o){var s,m,_,S,E,A,O,H=4,K=o[0];if(0===K)H+=(s=Ec(o.subarray(H))).length,H+=(m=Ec(o.subarray(H))).length,_=(z=new DataView(o.buffer)).getUint32(H),H+=4,E=z.getUint32(H),H+=4,A=z.getUint32(H),H+=4,O=z.getUint32(H),H+=4;else if(1===K){var z;_=(z=new DataView(o.buffer)).getUint32(H),H+=4,S=Ac(o.subarray(H)),H+=8,A=z.getUint32(H),H+=4,O=z.getUint32(H),H+=4,H+=(s=Ec(o.subarray(H))).length,H+=(m=Ec(o.subarray(H))).length}var G={scheme_id_uri:s,value:m,timescale:_||1,presentation_time:S,presentation_time_delta:E,event_duration:A,id:O,message_data:new Uint8Array(o.subarray(H,o.byteLength))};return isValidEmsgBox(K,G)?G:void 0},scaleTime:function(o,s,m,_){return o||0===o?o/s:_+m/s}},Mc=bin_toUnsigned,toHexString=function(o){return("00"+o.toString(16)).slice(-2)},jc=findBox$2,zc=parseType_1,qc=Dc,Xc=parseTfhd$2,_d=parseTrun$2,Cd=parseTfdt$2,Ad=Mt.getUint64,Rd=Hs,Ud=na.parseId3Frames;Ys=function(o,s){var m=jc(s,["moof","traf"]).reduce((function(s,m){var _,S=jc(m,["tfhd"])[0],E=Mc(S[4]<<24|S[5]<<16|S[6]<<8|S[7]),A=o[E]||9e4,O=jc(m,["tfdt"])[0],H=new DataView(O.buffer,O.byteOffset,O.byteLength);let K;return"bigint"==typeof(_=1===O[0]?Ad(O.subarray(4,12)):H.getUint32(4))?K=_/Rd.BigInt(A):"number"!=typeof _||isNaN(_)||(K=_/A),K<Number.MAX_SAFE_INTEGER&&(K=Number(K)),K<s&&(s=K),s}),1/0);return"bigint"==typeof m||isFinite(m)?m:0},pu=function(o){var s=0===o[0]?12:20;return Mc(o[s]<<24|o[s+1]<<16|o[s+2]<<8|o[s+3])},Zs=function(o){var s=jc(o,["moov","trak"]),m=[];return s.forEach((function(o){var s,_,S={},E=jc(o,["tkhd"])[0];E&&(_=(s=new DataView(E.buffer,E.byteOffset,E.byteLength)).getUint8(0),S.id=0===_?s.getUint32(12):s.getUint32(20));var A=jc(o,["mdia","hdlr"])[0];if(A){var O=zc(A.subarray(8,12));S.type="vide"===O?"video":"soun"===O?"audio":O}var H=jc(o,["mdia","minf","stbl","stsd"])[0];if(H){var K=H.subarray(8);S.codec=zc(K.subarray(4,8));var z,G=jc(K,[S.codec])[0];G&&(/^[asm]vc[1-9]$/i.test(S.codec)?(z=G.subarray(78),"avcC"===zc(z.subarray(4,8))&&z.length>11?(S.codec+=".",S.codec+=toHexString(z[9]),S.codec+=toHexString(z[10]),S.codec+=toHexString(z[11])):S.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(S.codec)?(z=G.subarray(28),"esds"===zc(z.subarray(4,8))&&z.length>20&&0!==z[19]?(S.codec+="."+toHexString(z[19]),S.codec+="."+toHexString(z[20]>>>2&63).replace(/^0/,"")):S.codec="mp4a.40.2"):S.codec=S.codec.toLowerCase())}var q=jc(o,["mdia","mdhd"])[0];q&&(S.timescale=pu(q)),m.push(S)})),m},_u=function(o,s=0){return jc(o,["emsg"]).map((o=>{var m=qc.parseEmsgBox(new Uint8Array(o)),_=Ud(m.message_data);return{cueTime:qc.scaleTime(m.presentation_time,m.timescale,m.presentation_time_delta,s),duration:qc.scaleTime(m.event_duration,m.timescale),frames:_}}))};var Vd=Ys,zd=Zs,qd=_u,eh=oi,parsePid=function(o){var s=31&o[1];return s<<=8,s|=o[2]},parsePayloadUnitStartIndicator=function(o){return!!(64&o[1])},parseAdaptionField=function(o){var s=0;return(48&o[3])>>>4>1&&(s+=o[4]+1),s},parseNalUnitType=function(o){switch(o){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},uh={parseType:function(o,s){var m=parsePid(o);return 0===m?"pat":m===s?"pmt":s?"pes":null},parsePat:function(o){var s=parsePayloadUnitStartIndicator(o),m=4+parseAdaptionField(o);return s&&(m+=o[m]+1),(31&o[m+10])<<8|o[m+11]},parsePmt:function(o){var s={},m=parsePayloadUnitStartIndicator(o),_=4+parseAdaptionField(o);if(m&&(_+=o[_]+1),1&o[_+5]){var S;S=3+((15&o[_+1])<<8|o[_+2])-4;for(var E=12+((15&o[_+10])<<8|o[_+11]);E<S;){var A=_+E;s[(31&o[A+1])<<8|o[A+2]]=o[A],E+=5+((15&o[A+3])<<8|o[A+4])}return s}},parsePayloadUnitStartIndicator:parsePayloadUnitStartIndicator,parsePesType:function(o,s){switch(s[parsePid(o)]){case eh.H264_STREAM_TYPE:return"video";case eh.ADTS_STREAM_TYPE:return"audio";case eh.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(o){if(!parsePayloadUnitStartIndicator(o))return null;var s=4+parseAdaptionField(o);if(s>=o.byteLength)return null;var m,_=null;return 192&(m=o[s+7])&&((_={}).pts=(14&o[s+9])<<27|(255&o[s+10])<<20|(254&o[s+11])<<12|(255&o[s+12])<<5|(254&o[s+13])>>>3,_.pts*=4,_.pts+=(6&o[s+13])>>>1,_.dts=_.pts,64&m&&(_.dts=(14&o[s+14])<<27|(255&o[s+15])<<20|(254&o[s+16])<<12|(255&o[s+17])<<5|(254&o[s+18])>>>3,_.dts*=4,_.dts+=(6&o[s+18])>>>1)),_},videoPacketContainsKeyFrame:function(o){for(var s=4+parseAdaptionField(o),m=o.subarray(s),_=0,S=0,E=!1;S<m.byteLength-3;S++)if(1===m[S+2]){_=S+5;break}for(;_<m.byteLength;)switch(m[_]){case 0:if(0!==m[_-1]){_+=2;break}if(0!==m[_-2]){_++;break}S+3!==_-2&&"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&m[S+3])&&(E=!0);do{_++}while(1!==m[_]&&_<m.length);S=_-2,_+=3;break;case 1:if(0!==m[_-1]||0!==m[_-2]){_+=3;break}"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&m[S+3])&&(E=!0),S=_-2,_+=3;break;default:_+=3}return m=m.subarray(S),_-=S,S=0,m&&m.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===parseNalUnitType(31&m[S+3])&&(E=!0),E}},hh=oi,mh=_i.handleRollover,vh={};vh.ts=uh,vh.aac=Co;var _h=In.ONE_SECOND_IN_TS,bh=188,kh=71,parseAudioPes_=function(o,s,m){for(var _,S,E,A,O=0,H=bh,K=!1;H<=o.byteLength;)if(o[O]!==kh||o[H]!==kh&&H!==o.byteLength)O++,H++;else{if(_=o.subarray(O,H),"pes"===vh.ts.parseType(_,s.pid))S=vh.ts.parsePesType(_,s.table),E=vh.ts.parsePayloadUnitStartIndicator(_),"audio"===S&&E&&(A=vh.ts.parsePesTime(_))&&(A.type="audio",m.audio.push(A),K=!0);if(K)break;O+=bh,H+=bh}for(O=(H=o.byteLength)-bh,K=!1;O>=0;)if(o[O]!==kh||o[H]!==kh&&H!==o.byteLength)O--,H--;else{if(_=o.subarray(O,H),"pes"===vh.ts.parseType(_,s.pid))S=vh.ts.parsePesType(_,s.table),E=vh.ts.parsePayloadUnitStartIndicator(_),"audio"===S&&E&&(A=vh.ts.parsePesTime(_))&&(A.type="audio",m.audio.push(A),K=!0);if(K)break;O-=bh,H-=bh}},parseVideoPes_=function(o,s,m){for(var _,S,E,A,O,H,K,z=0,G=bh,q=!1,X={data:[],size:0};G<o.byteLength;)if(o[z]!==kh||o[G]!==kh)z++,G++;else{if(_=o.subarray(z,G),"pes"===vh.ts.parseType(_,s.pid))if(S=vh.ts.parsePesType(_,s.table),E=vh.ts.parsePayloadUnitStartIndicator(_),"video"===S&&(E&&!q&&(A=vh.ts.parsePesTime(_))&&(A.type="video",m.video.push(A),q=!0),!m.firstKeyFrame)){if(E&&0!==X.size){for(O=new Uint8Array(X.size),H=0;X.data.length;)K=X.data.shift(),O.set(K,H),H+=K.byteLength;if(vh.ts.videoPacketContainsKeyFrame(O)){var J=vh.ts.parsePesTime(O);J?(m.firstKeyFrame=J,m.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}X.size=0}X.data.push(_),X.size+=_.byteLength}if(q&&m.firstKeyFrame)break;z+=bh,G+=bh}for(z=(G=o.byteLength)-bh,q=!1;z>=0;)if(o[z]!==kh||o[G]!==kh)z--,G--;else{if(_=o.subarray(z,G),"pes"===vh.ts.parseType(_,s.pid))S=vh.ts.parsePesType(_,s.table),E=vh.ts.parsePayloadUnitStartIndicator(_),"video"===S&&E&&(A=vh.ts.parsePesTime(_))&&(A.type="video",m.video.push(A),q=!0);if(q)break;z-=bh,G-=bh}},inspectTs_=function(o){var s={pid:null,table:null},m={};for(var _ in function(o,s){for(var m,_=0,S=bh;S<o.byteLength;)if(o[_]!==kh||o[S]!==kh)_++,S++;else{switch(m=o.subarray(_,S),vh.ts.parseType(m,s.pid)){case"pat":s.pid=vh.ts.parsePat(m);break;case"pmt":var E=vh.ts.parsePmt(m);s.table=s.table||{},Object.keys(E).forEach((function(o){s.table[o]=E[o]}))}_+=bh,S+=bh}}(o,s),s.table){if(s.table.hasOwnProperty(_))switch(s.table[_]){case hh.H264_STREAM_TYPE:m.video=[],parseVideoPes_(o,s,m),0===m.video.length&&delete m.video;break;case hh.ADTS_STREAM_TYPE:m.audio=[],parseAudioPes_(o,s,m),0===m.audio.length&&delete m.audio}}return m},tsInspector_inspect=function(o,s){var m;return m=vh.aac.isLikelyAacData(o)?function(o){for(var s,m=!1,_=0,S=null,E=null,A=0,O=0;o.length-O>=3;){switch(vh.aac.parseType(o,O)){case"timed-metadata":if(o.length-O<10){m=!0;break}if((A=vh.aac.parseId3TagSize(o,O))>o.length){m=!0;break}null===E&&(s=o.subarray(O,O+A),E=vh.aac.parseAacTimestamp(s)),O+=A;break;case"audio":if(o.length-O<7){m=!0;break}if((A=vh.aac.parseAdtsSize(o,O))>o.length){m=!0;break}null===S&&(s=o.subarray(O,O+A),S=vh.aac.parseSampleRate(s)),_++,O+=A;break;default:O++}if(m)return null}if(null===S||null===E)return null;var H=_h/S;return{audio:[{type:"audio",dts:E,pts:E},{type:"audio",dts:E+1024*_*H,pts:E+1024*_*H}]}}(o):inspectTs_(o),m&&(m.audio||m.video)?(function(o,s){if(o.audio&&o.audio.length){var m=s;(void 0===m||isNaN(m))&&(m=o.audio[0].dts),o.audio.forEach((function(o){o.dts=mh(o.dts,m),o.pts=mh(o.pts,m),o.dtsTime=o.dts/_h,o.ptsTime=o.pts/_h}))}if(o.video&&o.video.length){var _=s;if((void 0===_||isNaN(_))&&(_=o.video[0].dts),o.video.forEach((function(o){o.dts=mh(o.dts,_),o.pts=mh(o.pts,_),o.dtsTime=o.dts/_h,o.ptsTime=o.pts/_h})),o.firstKeyFrame){var S=o.firstKeyFrame;S.dts=mh(S.dts,_),S.pts=mh(S.pts,_),S.dtsTime=S.dts/_h,S.ptsTime=S.pts/_h}}}(m,s),m):null};class MessageHandlers{constructor(o,s){this.options=s||{},this.self=o,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new vl.Transmuxer(this.options),function(o,s){s.on("data",(function(s){const m=s.initSegment;s.initSegment={data:m.buffer,byteOffset:m.byteOffset,byteLength:m.byteLength};const _=s.data;s.data=_.buffer,o.postMessage({action:"data",segment:s,byteOffset:_.byteOffset,byteLength:_.byteLength},[s.data])})),s.on("done",(function(s){o.postMessage({action:"done"})})),s.on("gopInfo",(function(s){o.postMessage({action:"gopInfo",gopInfo:s})})),s.on("videoSegmentTimingInfo",(function(s){const m={start:{decode:In.videoTsToSeconds(s.start.dts),presentation:In.videoTsToSeconds(s.start.pts)},end:{decode:In.videoTsToSeconds(s.end.dts),presentation:In.videoTsToSeconds(s.end.pts)},baseMediaDecodeTime:In.videoTsToSeconds(s.baseMediaDecodeTime)};s.prependedContentDuration&&(m.prependedContentDuration=In.videoTsToSeconds(s.prependedContentDuration)),o.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:m})})),s.on("audioSegmentTimingInfo",(function(s){const m={start:{decode:In.videoTsToSeconds(s.start.dts),presentation:In.videoTsToSeconds(s.start.pts)},end:{decode:In.videoTsToSeconds(s.end.dts),presentation:In.videoTsToSeconds(s.end.pts)},baseMediaDecodeTime:In.videoTsToSeconds(s.baseMediaDecodeTime)};s.prependedContentDuration&&(m.prependedContentDuration=In.videoTsToSeconds(s.prependedContentDuration)),o.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:m})})),s.on("id3Frame",(function(s){o.postMessage({action:"id3Frame",id3Frame:s})})),s.on("caption",(function(s){o.postMessage({action:"caption",caption:s})})),s.on("trackinfo",(function(s){o.postMessage({action:"trackinfo",trackInfo:s})})),s.on("audioTimingInfo",(function(s){o.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:In.videoTsToSeconds(s.start),end:In.videoTsToSeconds(s.end)}})})),s.on("videoTimingInfo",(function(s){o.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:In.videoTsToSeconds(s.start),end:In.videoTsToSeconds(s.end)}})})),s.on("log",(function(s){o.postMessage({action:"log",log:s})}))}(this.self,this.transmuxer)}pushMp4Captions(o){this.captionParser||(this.captionParser=new captionParser,this.captionParser.init());const s=new Uint8Array(o.data,o.byteOffset,o.byteLength),m=this.captionParser.parse(s,o.trackIds,o.timescales);this.self.postMessage({action:"mp4Captions",captions:m&&m.captions||[],logs:m&&m.logs||[],data:s.buffer},[s.buffer])}probeMp4StartTime({timescales:o,data:s}){const m=Vd(o,s);this.self.postMessage({action:"probeMp4StartTime",startTime:m,data:s},[s.buffer])}probeMp4Tracks({data:o}){const s=zd(o);this.self.postMessage({action:"probeMp4Tracks",tracks:s,data:o},[o.buffer])}probeEmsgID3({data:o,offset:s}){const m=qd(o,s);this.self.postMessage({action:"probeEmsgID3",id3Frames:m,emsgData:o},[o.buffer])}probeTs({data:o,baseStartTime:s}){const m="number"!=typeof s||isNaN(s)?void 0:s*In.ONE_SECOND_IN_TS,_=tsInspector_inspect(o,m);let S=null;_&&(S={hasVideo:_.video&&2===_.video.length||!1,hasAudio:_.audio&&2===_.audio.length||!1},S.hasVideo&&(S.videoStart=_.video[0].ptsTime),S.hasAudio&&(S.audioStart=_.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:S,data:o},[o.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(o){const s=new Uint8Array(o.data,o.byteOffset,o.byteLength);this.transmuxer.push(s)}reset(){this.transmuxer.reset()}setTimestampOffset(o){const s=o.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(In.secondsToVideoTs(s)))}setAudioAppendStart(o){this.transmuxer.setAudioAppendStart(Math.ceil(In.secondsToVideoTs(o.appendStart)))}setRemux(o){this.transmuxer.setRemux(o.remux)}flush(o){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(o){this.transmuxer.alignGopsWith(o.gopsToAlignWith.slice())}}self.onmessage=function(o){"init"===o.data.action&&o.data.options?this.messageHandlers=new MessageHandlers(self,o.data.options):(this.messageHandlers||(this.messageHandlers=new MessageHandlers(self)),o.data&&o.data.action&&"init"!==o.data.action&&this.messageHandlers[o.data.action]&&this.messageHandlers[o.data.action](o.data))}})));var T2=factory(S2);const processTransmux=o=>{const{transmuxer:s,bytes:m,audioAppendStart:_,gopsToAlignWith:S,remux:E,onData:A,onTrackInfo:O,onAudioTimingInfo:H,onVideoTimingInfo:K,onVideoSegmentTimingInfo:z,onAudioSegmentTimingInfo:G,onId3:q,onCaptions:X,onDone:J,onEndedTimeline:ae,onTransmuxerLog:pe,isEndOfTimeline:me}=o,_e={buffer:[]};let Se=me;if(s.onmessage=m=>{s.currentTransmux===o&&("data"===m.data.action&&((o,s,m)=>{const{type:_,initSegment:S,captions:E,captionStreams:A,metadata:O,videoFrameDtsTime:H,videoFramePtsTime:K}=o.data.segment;s.buffer.push({captions:E,captionStreams:A,metadata:O});const z=o.data.segment.boxes||{data:o.data.segment.data},G={type:_,data:new Uint8Array(z.data,z.data.byteOffset,z.data.byteLength),initSegment:new Uint8Array(S.data,S.byteOffset,S.byteLength)};void 0!==H&&(G.videoFrameDtsTime=H),void 0!==K&&(G.videoFramePtsTime=K),m(G)})(m,_e,A),"trackinfo"===m.data.action&&O(m.data.trackInfo),"gopInfo"===m.data.action&&((o,s)=>{s.gopInfo=o.data.gopInfo})(m,_e),"audioTimingInfo"===m.data.action&&H(m.data.audioTimingInfo),"videoTimingInfo"===m.data.action&&K(m.data.videoTimingInfo),"videoSegmentTimingInfo"===m.data.action&&z(m.data.videoSegmentTimingInfo),"audioSegmentTimingInfo"===m.data.action&&G(m.data.audioSegmentTimingInfo),"id3Frame"===m.data.action&&q([m.data.id3Frame],m.data.id3Frame.dispatchType),"caption"===m.data.action&&X(m.data.caption),"endedtimeline"===m.data.action&&(Se=!1,ae()),"log"===m.data.action&&pe(m.data.log),"transmuxed"===m.data.type&&(Se||(s.onmessage=null,(({transmuxedData:o,callback:s})=>{o.buffer=[],s(o)})({transmuxedData:_e,callback:J}),dequeue(s))))},_&&s.postMessage({action:"setAudioAppendStart",appendStart:_}),Array.isArray(S)&&s.postMessage({action:"alignGopsWith",gopsToAlignWith:S}),void 0!==E&&s.postMessage({action:"setRemux",remux:E}),m.byteLength){const o=m instanceof ArrayBuffer?m:m.buffer,_=m instanceof ArrayBuffer?0:m.byteOffset;s.postMessage({action:"push",data:o,byteOffset:_,byteLength:m.byteLength},[o])}me&&s.postMessage({action:"endTimeline"}),s.postMessage({action:"flush"})},dequeue=o=>{o.currentTransmux=null,o.transmuxQueue.length&&(o.currentTransmux=o.transmuxQueue.shift(),"function"==typeof o.currentTransmux?o.currentTransmux():processTransmux(o.currentTransmux))},processAction=(o,s)=>{o.postMessage({action:s}),dequeue(o)},enqueueAction=(o,s)=>{if(!s.currentTransmux)return s.currentTransmux=o,void processAction(s,o);s.transmuxQueue.push(processAction.bind(null,s,o))},transmux=o=>{if(!o.transmuxer.currentTransmux)return o.transmuxer.currentTransmux=o,void processTransmux(o);o.transmuxer.transmuxQueue.push(o)};var segmentTransmuxer_reset=o=>{enqueueAction("reset",o)},segmentTransmuxer_createTransmuxer=o=>{const s=new T2;s.currentTransmux=null,s.transmuxQueue=[];const m=s.terminate;return s.terminate=()=>(s.currentTransmux=null,s.transmuxQueue.length=0,m.call(s)),s.postMessage({action:"init",options:o}),s};const workerCallback=function(o){const s=o.transmuxer,m=o.endAction||o.action,_=o.callback,S=gH({},o,{endAction:null,transmuxer:null,callback:null}),listenForEndEvent=S=>{S.data.action===m&&(s.removeEventListener("message",listenForEndEvent),S.data.data&&(S.data.data=new Uint8Array(S.data.data,o.byteOffset||0,o.byteLength||S.data.data.byteLength),o.data&&(o.data=S.data.data)),_(S.data))};if(s.addEventListener("message",listenForEndEvent),o.data){const m=o.data instanceof ArrayBuffer;S.byteOffset=m?0:o.data.byteOffset,S.byteLength=o.data.byteLength;const _=[m?o.data:o.data.buffer];s.postMessage(S,_)}else s.postMessage(S)},k2=2,C2=-101,w2=-102,abortAll=o=>{o.forEach((o=>{o.abort()}))},handleErrors=(o,s)=>s.timedout?{status:s.status,message:"HLS request timed-out at URL: "+s.uri,code:C2,xhr:s}:s.aborted?{status:s.status,message:"HLS request aborted at URL: "+s.uri,code:w2,xhr:s}:o?{status:s.status,message:"HLS request errored at URL: "+s.uri,code:k2,xhr:s}:"arraybuffer"===s.responseType&&0===s.response.byteLength?{status:s.status,message:"Empty HLS response at URL: "+s.uri,code:k2,xhr:s}:null,handleKeyResponse=(o,s,m)=>(_,S)=>{const E=S.response,A=handleErrors(_,S);if(A)return m(A,o);if(16!==E.byteLength)return m({status:S.status,message:"Invalid HLS key at URL: "+S.uri,code:k2,xhr:S},o);const O=new DataView(E),H=new Uint32Array([O.getUint32(0),O.getUint32(4),O.getUint32(8),O.getUint32(12)]);for(let o=0;o<s.length;o++)s[o].bytes=H;return m(null,o)},parseInitSegment=(o,s)=>{const m=vG(o.map.bytes);if("mp4"!==m){const _=o.map.resolvedUri||o.map.uri;return s({internal:!0,message:`Found unsupported ${m||"unknown"} container for initialization segment at URL: ${_}`,code:k2})}workerCallback({action:"probeMp4Tracks",data:o.map.bytes,transmuxer:o.transmuxer,callback:({tracks:m,data:_})=>(o.map.bytes=_,m.forEach((function(s){o.map.tracks=o.map.tracks||{},o.map.tracks[s.type]||(o.map.tracks[s.type]=s,"number"==typeof s.id&&s.timescale&&(o.map.timescales=o.map.timescales||{},o.map.timescales[s.id]=s.timescale))})),s(null))})},handleSegmentResponse=({segment:o,finishProcessingFn:s,responseType:m})=>(_,S)=>{const E=handleErrors(_,S);if(E)return s(E,o);const A="arraybuffer"!==m&&S.responseText?(o=>{const s=new Uint8Array(new ArrayBuffer(o.length));for(let m=0;m<o.length;m++)s[m]=o.charCodeAt(m);return s.buffer})(S.responseText.substring(o.lastReachedChar||0)):S.response;return o.stats=(o=>({bandwidth:o.bandwidth,bytesReceived:o.bytesReceived||0,roundTripTime:o.roundTripTime||0}))(S),o.key?o.encryptedBytes=new Uint8Array(A):o.bytes=new Uint8Array(A),s(null,o)},transmuxAndNotify=({segment:o,bytes:s,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z,doneFn:G,onTransmuxerLog:q})=>{const X=o.map&&o.map.tracks||{},J=Boolean(X.audio&&X.video);let ae=_.bind(null,o,"audio","start");const pe=_.bind(null,o,"audio","end");let me=_.bind(null,o,"video","start");const _e=_.bind(null,o,"video","end");workerCallback({action:"probeTs",transmuxer:o.transmuxer,data:s,baseStartTime:o.baseStartTime,callback:_=>{o.bytes=s=_.data;const X=_.result;X&&(m(o,{hasAudio:X.hasAudio,hasVideo:X.hasVideo,isMuxed:J}),m=null),transmux({bytes:s,transmuxer:o.transmuxer,audioAppendStart:o.audioAppendStart,gopsToAlignWith:o.gopsToAlignWith,remux:J,onData:s=>{s.type="combined"===s.type?"video":s.type,z(o,s)},onTrackInfo:s=>{m&&(J&&(s.isMuxed=!0),m(o,s))},onAudioTimingInfo:o=>{ae&&void 0!==o.start&&(ae(o.start),ae=null),pe&&void 0!==o.end&&pe(o.end)},onVideoTimingInfo:o=>{me&&void 0!==o.start&&(me(o.start),me=null),_e&&void 0!==o.end&&_e(o.end)},onVideoSegmentTimingInfo:o=>{S(o)},onAudioSegmentTimingInfo:o=>{E(o)},onId3:(s,m)=>{A(o,s,m)},onCaptions:s=>{O(o,[s])},isEndOfTimeline:H,onEndedTimeline:()=>{K()},onTransmuxerLog:q,onDone:s=>{G&&(s.type="combined"===s.type?"video":s.type,G(null,o,s))}})}})},handleSegmentBytes=({segment:o,bytes:s,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z,doneFn:G,onTransmuxerLog:q})=>{let X=new Uint8Array(s);if(_G(X)){o.isFmp4=!0;const{tracks:S}=o.map,E={isFmp4:!0,hasVideo:!!S.video,hasAudio:!!S.audio};S.audio&&S.audio.codec&&"enca"!==S.audio.codec&&(E.audioCodec=S.audio.codec),S.video&&S.video.codec&&"encv"!==S.video.codec&&(E.videoCodec=S.video.codec),S.video&&S.audio&&(E.isMuxed=!0),m(o,E);const finishLoading=(s,m)=>{z(o,{data:X,type:E.hasAudio&&!E.isMuxed?"audio":"video"}),m&&m.length&&A(o,m),s&&s.length&&O(o,s),G(null,o,{})};workerCallback({action:"probeMp4StartTime",timescales:o.map.timescales,data:X,transmuxer:o.transmuxer,callback:({data:m,startTime:A})=>{s=m.buffer,o.bytes=X=m,E.hasAudio&&!E.isMuxed&&_(o,"audio","start",A),E.hasVideo&&_(o,"video","start",A),workerCallback({action:"probeEmsgID3",data:X,transmuxer:o.transmuxer,offset:A,callback:({emsgData:m,id3Frames:_})=>{s=m.buffer,o.bytes=X=m,S.video&&m.byteLength&&o.transmuxer?workerCallback({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:o.transmuxer,data:X,timescales:o.map.timescales,trackIds:[S.video.id],callback:m=>{s=m.data.buffer,o.bytes=X=m.data,m.logs.forEach((function(o){q(merge(o,{stream:"mp4CaptionParser"}))})),finishLoading(m.captions,_)}}):finishLoading(void 0,_)}})}})}else if(o.transmuxer){if(void 0===o.container&&(o.container=vG(X)),"ts"!==o.container&&"aac"!==o.container)return m(o,{hasAudio:!1,hasVideo:!1}),void G(null,o,{});transmuxAndNotify({segment:o,bytes:s,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z,doneFn:G,onTransmuxerLog:q})}else G(null,o,{})},decrypt=function({id:o,key:s,encryptedBytes:m,decryptionWorker:_},S){const decryptionHandler=s=>{if(s.data.source===o){_.removeEventListener("message",decryptionHandler);const o=s.data.decrypted;S(new Uint8Array(o.bytes,o.byteOffset,o.byteLength))}};let E;_.addEventListener("message",decryptionHandler),E=s.bytes.slice?s.bytes.slice():new Uint32Array(Array.prototype.slice.call(s.bytes)),_.postMessage(createTransferableMessage({source:o,encrypted:m,key:E,iv:s.iv}),[m.buffer,E.buffer])},waitForCompletion=({activeXhrs:o,decryptionWorker:s,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z,doneFn:G,onTransmuxerLog:q})=>{let X=0,J=!1;return(ae,pe)=>{if(!J){if(ae)return J=!0,abortAll(o),G(ae,pe);if(X+=1,X===o.length){const segmentFinish=function(){if(pe.encryptedBytes)return(({decryptionWorker:o,segment:s,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z,doneFn:G,onTransmuxerLog:q})=>{decrypt({id:s.requestId,key:s.key,encryptedBytes:s.encryptedBytes,decryptionWorker:o},(o=>{s.bytes=o,handleSegmentBytes({segment:s,bytes:s.bytes,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z,doneFn:G,onTransmuxerLog:q})}))})({decryptionWorker:s,segment:pe,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z,doneFn:G,onTransmuxerLog:q});handleSegmentBytes({segment:pe,bytes:pe.bytes,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z,doneFn:G,onTransmuxerLog:q})};if(pe.endOfAllRequests=Date.now(),pe.map&&pe.map.encryptedBytes&&!pe.map.bytes)return decrypt({decryptionWorker:s,id:pe.requestId+"-init",encryptedBytes:pe.map.encryptedBytes,key:pe.map.key},(s=>{pe.map.bytes=s,parseInitSegment(pe,(s=>{if(s)return abortAll(o),G(s,pe);segmentFinish()}))}));segmentFinish()}}}},handleProgress=({segment:o,progressFn:s,trackInfoFn:m,timingInfoFn:_,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:E,id3Fn:A,captionsFn:O,isEndOfTimeline:H,endedTimelineFn:K,dataFn:z})=>m=>{if(!m.target.aborted)return o.stats=merge(o.stats,(o=>{const s=o.target,m={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-s.requestTime||0};return m.bytesReceived=o.loaded,m.bandwidth=Math.floor(m.bytesReceived/m.roundTripTime*8*1e3),m})(m)),!o.stats.firstBytesReceivedAt&&o.stats.bytesReceived&&(o.stats.firstBytesReceivedAt=Date.now()),s(m,o)},mediaSegmentRequest=({xhr:o,xhrOptions:s,decryptionWorker:m,segment:_,abortFn:S,progressFn:E,trackInfoFn:A,timingInfoFn:O,videoSegmentTimingInfoFn:H,audioSegmentTimingInfoFn:K,id3Fn:z,captionsFn:G,isEndOfTimeline:q,endedTimelineFn:X,dataFn:J,doneFn:ae,onTransmuxerLog:pe})=>{const me=[],_e=waitForCompletion({activeXhrs:me,decryptionWorker:m,trackInfoFn:A,timingInfoFn:O,videoSegmentTimingInfoFn:H,audioSegmentTimingInfoFn:K,id3Fn:z,captionsFn:G,isEndOfTimeline:q,endedTimelineFn:X,dataFn:J,doneFn:ae,onTransmuxerLog:pe});if(_.key&&!_.key.bytes){const m=[_.key];_.map&&!_.map.bytes&&_.map.key&&_.map.key.resolvedUri===_.key.resolvedUri&&m.push(_.map.key);const S=o(merge(s,{uri:_.key.resolvedUri,responseType:"arraybuffer"}),handleKeyResponse(_,m,_e));me.push(S)}if(_.map&&!_.map.bytes){if(_.map.key&&(!_.key||_.key.resolvedUri!==_.map.key.resolvedUri)){const m=o(merge(s,{uri:_.map.key.resolvedUri,responseType:"arraybuffer"}),handleKeyResponse(_,[_.map.key],_e));me.push(m)}const m=merge(s,{uri:_.map.resolvedUri,responseType:"arraybuffer",headers:segmentXhrHeaders(_.map)}),S=(({segment:o,finishProcessingFn:s})=>(m,_)=>{const S=handleErrors(m,_);if(S)return s(S,o);const E=new Uint8Array(_.response);if(o.map.key)return o.map.encryptedBytes=E,s(null,o);o.map.bytes=E,parseInitSegment(o,(function(m){if(m)return m.xhr=_,m.status=_.status,s(m,o);s(null,o)}))})({segment:_,finishProcessingFn:_e}),E=o(m,S);me.push(E)}const Se=merge(s,{uri:_.part&&_.part.resolvedUri||_.resolvedUri,responseType:"arraybuffer",headers:segmentXhrHeaders(_)}),Ee=o(Se,handleSegmentResponse({segment:_,finishProcessingFn:_e,responseType:Se.responseType}));Ee.addEventListener("progress",handleProgress({segment:_,progressFn:E,trackInfoFn:A,timingInfoFn:O,videoSegmentTimingInfoFn:H,audioSegmentTimingInfoFn:K,id3Fn:z,captionsFn:G,isEndOfTimeline:q,endedTimelineFn:X,dataFn:J})),me.push(Ee);const De={};return me.forEach((o=>{o.addEventListener("loadend",(({loadendState:o,abortFn:s})=>m=>{m.target.aborted&&s&&!o.calledAbortFn&&(s(),o.calledAbortFn=!0)})({loadendState:De,abortFn:S}))})),()=>abortAll(me)},x2=logger("CodecUtils"),isMaat=(o,s)=>{const m=s.attributes||{};return o&&o.mediaGroups&&o.mediaGroups.AUDIO&&m.AUDIO&&o.mediaGroups.AUDIO[m.AUDIO]},unwrapCodecList=function(o){const s={};return o.forEach((({mediaType:o,type:m,details:_})=>{s[o]=s[o]||[],s[o].push(dK(`${m}${_}`))})),Object.keys(s).forEach((function(o){if(s[o].length>1)return x2(`multiple ${o} codecs found as attributes: ${s[o].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),void(s[o]=null);s[o]=s[o][0]})),s},codecCount=function(o){let s=0;return o.audio&&s++,o.video&&s++,s},codecsForPlaylist=function(o,s){const m=s.attributes||{},_=unwrapCodecList(function(o){const s=o.attributes||{};if(s.CODECS)return hK(s.CODECS)}(s)||[]);if(isMaat(o,s)&&!_.audio&&!((o,s)=>{if(!isMaat(o,s))return!0;const m=s.attributes||{},_=o.mediaGroups.AUDIO[m.AUDIO];for(const o in _)if(!_[o].uri&&!_[o].playlists)return!0;return!1})(o,s)){const s=unwrapCodecList(pK(o,m.AUDIO)||[]);s.audio&&(_.audio=s.audio)}return _},E2=logger("PlaylistSelector"),representationToString=function(o){if(!o||!o.playlist)return;const s=o.playlist;return JSON.stringify({id:s.id,bandwidth:o.bandwidth,width:o.width,height:o.height,codecs:s.attributes&&s.attributes.CODECS||""})},safeGetComputedStyle=function(o,s){if(!o)return"";const m=$V.getComputedStyle(o);return m?m[s]:""},stableSort=function(o,s){const m=o.slice();o.sort((function(o,_){const S=s(o,_);return 0===S?m.indexOf(o)-m.indexOf(_):S}))},comparePlaylistBandwidth=function(o,s){let m,_;return o.attributes.BANDWIDTH&&(m=o.attributes.BANDWIDTH),m=m||$V.Number.MAX_VALUE,s.attributes.BANDWIDTH&&(_=s.attributes.BANDWIDTH),_=_||$V.Number.MAX_VALUE,m-_};let simpleSelector=function(o,s,m,_,S,E){if(!o)return;const A={bandwidth:s,width:m,height:_,limitRenditionByPlayerDimensions:S};let O=o.playlists;f2.isAudioOnly(o)&&(O=E.getAudioTrackPlaylists_(),A.audioOnly=!0);let H=O.map((o=>{let s;const m=o.attributes&&o.attributes.RESOLUTION&&o.attributes.RESOLUTION.width,_=o.attributes&&o.attributes.RESOLUTION&&o.attributes.RESOLUTION.height;return s=o.attributes&&o.attributes.BANDWIDTH,s=s||$V.Number.MAX_VALUE,{bandwidth:s,width:m,height:_,playlist:o}}));stableSort(H,((o,s)=>o.bandwidth-s.bandwidth)),H=H.filter((o=>!f2.isIncompatible(o.playlist)));let K=H.filter((o=>f2.isEnabled(o.playlist)));K.length||(K=H.filter((o=>!f2.isDisabled(o.playlist))));const z=K.filter((o=>o.bandwidth*b2.BANDWIDTH_VARIANCE<s));let G=z[z.length-1];const q=z.filter((o=>o.bandwidth===G.bandwidth))[0];if(!1===S){const o=q||K[0]||H[0];if(o&&o.playlist){let s="sortedPlaylistReps";return q&&(s="bandwidthBestRep"),K[0]&&(s="enabledPlaylistReps"),E2(`choosing ${representationToString(o)} using ${s} with options`,A),o.playlist}return E2("could not choose a playlist with options",A),null}const X=z.filter((o=>o.width&&o.height));stableSort(X,((o,s)=>o.width-s.width));const J=X.filter((o=>o.width===m&&o.height===_));G=J[J.length-1];const ae=J.filter((o=>o.bandwidth===G.bandwidth))[0];let pe,me,_e,Se;if(ae||(pe=X.filter((o=>o.width>m||o.height>_)),me=pe.filter((o=>o.width===pe[0].width&&o.height===pe[0].height)),G=me[me.length-1],_e=me.filter((o=>o.bandwidth===G.bandwidth))[0]),E.leastPixelDiffSelector){const o=X.map((o=>(o.pixelDiff=Math.abs(o.width-m)+Math.abs(o.height-_),o)));stableSort(o,((o,s)=>o.pixelDiff===s.pixelDiff?s.bandwidth-o.bandwidth:o.pixelDiff-s.pixelDiff)),Se=o[0]}const Ee=Se||_e||ae||q||K[0]||H[0];if(Ee&&Ee.playlist){let o="sortedPlaylistReps";return Se?o="leastPixelDiffRep":_e?o="resolutionPlusOneRep":ae?o="resolutionBestRep":q?o="bandwidthBestRep":K[0]&&(o="enabledPlaylistReps"),E2(`choosing ${representationToString(Ee)} using ${o} with options`,A),Ee.playlist}return E2("could not choose a playlist with options",A),null};const lastBandwidthSelector=function(){const o=this.useDevicePixelRatio&&$V.devicePixelRatio||1;return simpleSelector(this.playlists.main,this.systemBandwidth,parseInt(safeGetComputedStyle(this.tech_.el(),"width"),10)*o,parseInt(safeGetComputedStyle(this.tech_.el(),"height"),10)*o,this.limitRenditionByPlayerDimensions,this.playlistController_)},addMetadata=({inbandTextTracks:o,metadataArray:s,timestampOffset:m,videoDuration:_})=>{if(!s)return;const S=$V.WebKitDataCue||$V.VTTCue,E=o.metadataTrack_;if(!E)return;if(s.forEach((o=>{const s=o.cueTime+m;!("number"!=typeof s||$V.isNaN(s)||s<0)&&s<1/0&&o.frames&&o.frames.length&&o.frames.forEach((o=>{const m=new S(s,s,o.value||o.url||o.data||"");m.frame=o,m.value=o,function(o){Object.defineProperties(o.frame,{id:{get:()=>(videojs.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),o.value.key)},value:{get:()=>(videojs.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),o.value.data)},privateData:{get:()=>(videojs.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),o.value.data)}})}(m),E.addCue(m)}))})),!E.cues||!E.cues.length)return;const A=E.cues,O=[];for(let o=0;o<A.length;o++)A[o]&&O.push(A[o]);const H=O.reduce(((o,s)=>{const m=o[s.startTime]||[];return m.push(s),o[s.startTime]=m,o}),{}),K=Object.keys(H).sort(((o,s)=>Number(o)-Number(s)));K.forEach(((o,s)=>{const m=H[o],S=isFinite(_)?_:o,E=Number(K[s+1])||S;m.forEach((o=>{o.endTime=E}))}))},I2={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},A2=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),createMetadataTrackIfNotExists=(o,s,m)=>{o.metadataTrack_||(o.metadataTrack_=m.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,videojs.browser.IS_ANY_SAFARI||(o.metadataTrack_.inBandMetadataTrackDispatchType=s))},removeCuesFromTrack=function(o,s,m){let _,S;if(m&&m.cues)for(_=m.cues.length;_--;)S=m.cues[_],S.startTime>=o&&S.endTime<=s&&m.removeCue(S)},finite=o=>"number"==typeof o&&isFinite(o),P2=1/60,segmentInfoString=o=>{const{startOfSegment:s,duration:m,segment:_,part:S,playlist:{mediaSequence:E,id:A,segments:O=[]},mediaIndex:H,partIndex:K,timeline:z}=o,G=O.length-1;let q="mediaIndex/partIndex increment";o.getMediaInfoForTime?q=`getMediaInfoForTime (${o.getMediaInfoForTime})`:o.isSyncRequest&&(q="getSyncSegmentCandidate (isSyncRequest)"),o.independent&&(q+=` with independent ${o.independent}`);const X="number"==typeof K,J=o.segment.uri?"segment":"pre-segment",ae=X?getKnownPartCount({preloadSegment:_})-1:0;return`${J} [${E+H}/${E+G}]`+(X?` part [${K}/${ae}]`:"")+` segment start/end [${_.start} => ${_.end}]`+(X?` part start/end [${S.start} => ${S.end}]`:"")+` startOfSegment [${s}]`+` duration [${m}]`+` timeline [${z}]`+` selected by [${q}]`+` playlist [${A}]`},timingInfoPropertyForMedia=o=>`${o}TimingInfo`,shouldWaitForTimelineChange=({timelineChangeController:o,currentTimeline:s,segmentTimeline:m,loaderType:_,audioDisabled:S})=>{if(s===m)return!1;if("audio"===_){const s=o.lastTimelineChange({type:"main"});return!s||s.to!==m}if("main"===_&&S){const s=o.pendingTimelineChange({type:"audio"});return!s||s.to!==m}return!1},segmentTooLong=({segmentDuration:o,maxDuration:s})=>!!o&&Math.round(o)>s+h2,getTroublesomeSegmentDurationMessage=(o,s)=>{if("hls"!==s)return null;const m=(o=>{let s=0;return["video","audio"].forEach((function(m){const _=o[`${m}TimingInfo`];if(!_)return;const{start:S,end:E}=_;let A;"bigint"==typeof S||"bigint"==typeof E?A=$V.BigInt(E)-$V.BigInt(S):"number"==typeof S&&"number"==typeof E&&(A=E-S),void 0!==A&&A>s&&(s=A)})),"bigint"==typeof s&&s<Number.MAX_SAFE_INTEGER&&(s=Number(s)),s})({audioTimingInfo:o.audioTimingInfo,videoTimingInfo:o.videoTimingInfo});if(!m)return null;const _=o.playlist.targetDuration,S=segmentTooLong({segmentDuration:m,maxDuration:2*_}),E=segmentTooLong({segmentDuration:m,maxDuration:_}),A=`Segment with index ${o.mediaIndex} from playlist ${o.playlist.id} has a duration of ${m} when the reported duration is ${o.duration} and the target duration is ${_}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return S||E?{severity:S?"warn":"info",message:A}:null};class SegmentLoader extends videojs.EventTarget{constructor(o,s={}){if(super(),!o)throw new TypeError("Initialization settings are required");if("function"!=typeof o.currentTime)throw new TypeError("No currentTime getter specified");if(!o.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=o.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=o.hasPlayed,this.currentTime_=o.currentTime,this.seekable_=o.seekable,this.seeking_=o.seeking,this.duration_=o.duration,this.mediaSource_=o.mediaSource,this.vhs_=o.vhs,this.loaderType_=o.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=o.segmentMetadataTrack,this.goalBufferLength_=o.goalBufferLength,this.sourceType_=o.sourceType,this.sourceUpdater_=o.sourceUpdater,this.inbandTextTracks_=o.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=o.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=o.parse708captions,this.useDtsForTimestampOffset_=o.useDtsForTimestampOffset,this.captionServices_=o.captionServices,this.exactManifestTimings=o.exactManifestTimings,this.addMetadataToTextTrack=o.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=o.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=o.decrypter,this.syncController_=o.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",(()=>{this.isEndOfStream_()||(this.ended_=!1)})),this.fetchAtBuffer_=!1,this.logger_=logger(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(o){o!==this.state_&&(this.logger_(`${this.state_} -> ${o}`),this.state_=o,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",(()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})),"main"===this.loaderType_&&this.timelineChangeController_.on("pendingtimelinechange",(()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})),"audio"===this.loaderType_&&this.timelineChangeController_.on("timelinechange",(()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}))}createTransmuxer_(){return segmentTransmuxer_createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&$V.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(o){this.audioDisabled_=!o,o?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,$V.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(o){return"APPENDING"!==this.state||this.pendingSegment_?!this.pendingSegment_||this.pendingSegment_.requestId!==o:(this.state="READY",!0)}error(o){return void 0!==o&&(this.logger_("error occurred:",o),this.error_=o),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&segmentTransmuxer_reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const o=this.getMediaInfo_();if(!this.sourceUpdater_||!o)return createTimeRanges();if("main"===this.loaderType_){const{hasAudio:s,hasVideo:m,isMuxed:_}=o;if(m&&s&&!this.audioDisabled_&&!_)return this.sourceUpdater_.buffered();if(m)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(o,s=!1){if(!o)return null;const m=initSegmentId(o);let _=this.initSegments_[m];return s&&!_&&o.bytes&&(this.initSegments_[m]=_={resolvedUri:o.resolvedUri,byterange:o.byterange,bytes:o.bytes,tracks:o.tracks,timescales:o.timescales}),_||o}segmentKey(o,s=!1){if(!o)return null;const m=segmentKeyId(o);let _=this.keyCache_[m];this.cacheEncryptionKeys_&&s&&!_&&o.bytes&&(this.keyCache_[m]=_={resolvedUri:o.resolvedUri,bytes:o.bytes});const S={resolvedUri:(_||o).resolvedUri};return _&&(S.bytes=_.bytes),S}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),this.playlist_)return"INIT"===this.state&&this.couldBeginLoading_()?this.init_():void(!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY"))}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(o,s={}){if(!o)return;const m=this.playlist_,_=this.pendingSegment_;this.playlist_=o,this.xhrOptions_=s,"INIT"===this.state&&(o.syncInfo={mediaSequence:o.mediaSequence,time:0},"main"===this.loaderType_&&this.syncController_.setDateTimeMappingForStart(o));let S=null;if(m&&(m.id?S=m.id:m.uri&&(S=m.uri)),this.logger_(`playlist update [${S} => ${o.id||o.uri}]`),this.syncController_.updateMediaSequenceMap(o,this.currentTime_(),this.loaderType_),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(!m||m.uri!==o.uri){if(null!==this.mediaIndex){!o.endList&&"number"==typeof o.partTargetDuration?this.resetLoader():this.resyncLoader()}return this.currentMediaInfo_=void 0,void this.trigger("playlistupdate")}const E=o.mediaSequence-m.mediaSequence;if(this.logger_(`live window shift [${E}]`),null!==this.mediaIndex)if(this.mediaIndex-=E,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const o=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!o.parts||!o.parts.length||!o.parts[this.partIndex])){const o=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=o}}_&&(_.mediaIndex-=E,_.mediaIndex<0?(_.mediaIndex=null,_.partIndex=null):(_.mediaIndex>=0&&(_.segment=o.segments[_.mediaIndex]),_.partIndex>=0&&_.segment.parts&&(_.part=_.segment.parts[_.partIndex]))),this.syncController_.saveExpiredSegmentInfo(m,o)}pause(){this.checkBufferTimeout_&&($V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return null===this.checkBufferTimeout_}resetEverything(o){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,o),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}resyncLoader(){this.transmuxer_&&segmentTransmuxer_reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.shouldForceTimestampOffsetAfterResync_=!0,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(o,s,m=(()=>{}),_=!1){if(s===1/0&&(s=this.duration_()),s<=o)return void this.logger_("skipping remove because end ${end} is <= start ${start}");if(!this.sourceUpdater_||!this.getMediaInfo_())return void this.logger_("skipping remove because no source updater or starting media info");let S=1;const removeFinished=()=>{S--,0===S&&m()};!_&&this.audioDisabled_||(S++,this.sourceUpdater_.removeAudio(o,s,removeFinished)),(_||"main"===this.loaderType_)&&(this.gopBuffer_=((o,s,m,_)=>{const S=Math.ceil((s-_)*c2),E=Math.ceil((m-_)*c2),A=o.slice();let O=o.length;for(;O--&&!(o[O].pts<=E););if(-1===O)return A;let H=O+1;for(;H--&&!(o[H].pts<=S););return H=Math.max(H,0),A.splice(H,O-H+1),A})(this.gopBuffer_,o,s,this.timeMapping_),S++,this.sourceUpdater_.removeVideo(o,s,removeFinished));for(const m in this.inbandTextTracks_)removeCuesFromTrack(o,s,this.inbandTextTracks_[m]);removeCuesFromTrack(o,s,this.segmentMetadataTrack_),removeFinished()}monitorBuffer_(){this.checkBufferTimeout_&&$V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=$V.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&$V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=$V.setTimeout(this.monitorBufferTick_.bind(this),500)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const o=this.chooseNextRequest_();o&&("number"==typeof o.timestampOffset&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:o.timeline})),this.loadSegment_(o))}isEndOfStream_(o=this.mediaIndex,s=this.playlist_,m=this.partIndex){if(!s||!this.mediaSource_)return!1;const _="number"==typeof o&&s.segments[o],S=o+1===s.segments.length,E=!_||!_.parts||m+1===_.parts.length;return s.endList&&"open"===this.mediaSource_.readyState&&S&&E}chooseNextRequest_(){const o=this.buffered_(),s=lastBufferedEnd(o)||0,m=timeAheadOf(o,this.currentTime_()),_=!this.hasPlayed_()&&m>=1,S=m>=this.goalBufferLength_(),E=this.playlist_.segments;if(!E.length||_||S)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const A={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(A.isSyncRequest)A.mediaIndex=function(o,s,m){s=s||[];const _=[];let S=0;for(let E=0;E<s.length;E++){const A=s[E];if(o===A.timeline&&(_.push(E),S+=A.duration,S>m))return E}return 0===_.length?0:_[_.length-1]}(this.currentTimeline_,E,s),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${A.mediaIndex}`);else if(null!==this.mediaIndex){const o=E[this.mediaIndex],m="number"==typeof this.partIndex?this.partIndex:-1;A.startOfSegment=o.end?o.end:s,o.parts&&o.parts[m+1]?(A.mediaIndex=this.mediaIndex,A.partIndex=m+1):A.mediaIndex=this.mediaIndex+1}else{const{segmentIndex:o,startTime:m,partIndex:_}=f2.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?s:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});A.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${s}`:`currentTime ${this.currentTime_()}`,A.mediaIndex=o,A.startOfSegment=m,A.partIndex=_,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${A.mediaIndex} `)}const O=E[A.mediaIndex];let H=O&&"number"==typeof A.partIndex&&O.parts&&O.parts[A.partIndex];if(!O||"number"==typeof A.partIndex&&!H)return null;"number"!=typeof A.partIndex&&O.parts&&(A.partIndex=0,H=O.parts[0]);const K=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!m&&H&&!K&&!H.independent)if(0===A.partIndex){const o=E[A.mediaIndex-1],s=o.parts&&o.parts.length&&o.parts[o.parts.length-1];s&&s.independent&&(A.mediaIndex-=1,A.partIndex=o.parts.length-1,A.independent="previous segment")}else O.parts[A.partIndex-1].independent&&(A.partIndex-=1,A.independent="previous part");const z=this.mediaSource_&&"ended"===this.mediaSource_.readyState;return A.mediaIndex>=E.length-1&&z&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,A.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(A))}generateSegmentInfo_(o){const{independent:s,playlist:m,mediaIndex:_,startOfSegment:S,isSyncRequest:E,partIndex:A,forceTimestampOffset:O,getMediaInfoForTime:H}=o,K=m.segments[_],z="number"==typeof A&&K.parts[A],G={requestId:"segment-loader-"+Math.random(),uri:z&&z.resolvedUri||K.resolvedUri,mediaIndex:_,partIndex:z?A:null,isSyncRequest:E,startOfSegment:S,playlist:m,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:K.timeline,duration:z&&z.duration||K.duration,segment:K,part:z,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:H,independent:s},q=void 0!==O?O:this.isPendingTimestampOffset_;G.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:K.timeline,currentTimeline:this.currentTimeline_,startOfSegment:S,buffered:this.buffered_(),overrideCheck:q});const X=lastBufferedEnd(this.sourceUpdater_.audioBuffered());return"number"==typeof X&&(G.audioAppendStart=X-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(G.gopsToAlignWith=((o,s,m)=>{if(null==s||!o.length)return[];const _=Math.ceil((s-m+3)*c2);let S;for(S=0;S<o.length&&!(o[S].pts>_);S++);return o.slice(S)})(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),G}timestampOffsetForSegment_(o){return(({segmentTimeline:o,currentTimeline:s,startOfSegment:m,buffered:_,overrideCheck:S})=>S||o!==s?o<s?m:_.length?_.end(_.length-1):m:null)(o)}earlyAbortWhenNeeded_(o){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return;if(Date.now()-(o.firstBytesReceivedAt||Date.now())<1e3)return;const s=this.currentTime_(),m=o.bandwidth,_=this.pendingSegment_.duration,S=f2.estimateSegmentRequestTime(_,m,this.playlist_,o.bytesReceived),E=function(o,s,m=1){return((o.length?o.end(o.length-1):0)-s)/m}(this.buffered_(),s,this.vhs_.tech_.playbackRate())-1;if(S<=E)return;const A=function(o){const{main:s,currentTime:m,bandwidth:_,duration:S,segmentDuration:E,timeUntilRebuffer:A,currentTimeline:O,syncController:H}=o,K=s.playlists.filter((o=>!f2.isIncompatible(o)));let z=K.filter(f2.isEnabled);z.length||(z=K.filter((o=>!f2.isDisabled(o))));const G=z.filter(f2.hasAttribute.bind(null,"BANDWIDTH")).map((o=>{const s=H.getSyncPoint(o,S,O,m)?1:2;return{playlist:o,rebufferingImpact:f2.estimateSegmentRequestTime(E,_,o)*s-A}})),q=G.filter((o=>o.rebufferingImpact<=0));return stableSort(q,((o,s)=>comparePlaylistBandwidth(s.playlist,o.playlist))),q.length?q[0]:(stableSort(G,((o,s)=>o.rebufferingImpact-s.rebufferingImpact)),G[0]||null)}({main:this.vhs_.playlists.main,currentTime:s,bandwidth:m,duration:this.duration_(),segmentDuration:_,timeUntilRebuffer:E,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!A)return;const O=S-E-A.rebufferingImpact;let H=.5;E<=h2&&(H=1),!A.playlist||A.playlist.uri===this.playlist_.uri||O<H||(this.bandwidth=A.playlist.attributes.BANDWIDTH*b2.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(o){this.logger_(`Aborting ${segmentInfoString(o)}`),this.mediaRequestsAborted+=1}handleProgress_(o,s){this.earlyAbortWhenNeeded_(s.stats),this.checkForAbort_(s.requestId)||this.trigger("progress")}handleTrackInfo_(o,s){this.earlyAbortWhenNeeded_(o.stats),this.checkForAbort_(o.requestId)||this.checkForIllegalMediaSwitch(s)||(s=s||{},function(o,s){if(!o&&!s||!o&&s||o&&!s)return!1;if(o===s)return!0;const m=Object.keys(o).sort(),_=Object.keys(s).sort();if(m.length!==_.length)return!1;for(let S=0;S<m.length;S++){const E=m[S];if(E!==_[S])return!1;if(o[E]!==s[E])return!1}return!0}(this.currentMediaInfo_,s)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=s,this.currentMediaInfo_=s,this.logger_("trackinfo update",s),this.trigger("trackinfo")),this.checkForAbort_(o.requestId)||(this.pendingSegment_.trackInfo=s,this.hasEnoughInfoToAppend_()&&this.processCallQueue_()))}handleTimingInfo_(o,s,m,_){if(this.earlyAbortWhenNeeded_(o.stats),this.checkForAbort_(o.requestId))return;const S=this.pendingSegment_,E=timingInfoPropertyForMedia(s);S[E]=S[E]||{},S[E][m]=_,this.logger_(`timinginfo: ${s} - ${m} - ${_}`),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}handleCaptions_(o,s){if(this.earlyAbortWhenNeeded_(o.stats),this.checkForAbort_(o.requestId))return;if(0===s.length)return void this.logger_("SegmentLoader received no captions from a caption event");if(!this.pendingSegment_.hasAppendedData_)return void this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,o,s));const m=null===this.sourceUpdater_.videoTimestampOffset()?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),_={};s.forEach((o=>{_[o.stream]=_[o.stream]||{startTime:1/0,captions:[],endTime:0};const s=_[o.stream];s.startTime=Math.min(s.startTime,o.startTime+m),s.endTime=Math.max(s.endTime,o.endTime+m),s.captions.push(o)})),Object.keys(_).forEach((o=>{const{startTime:s,endTime:S,captions:E}=_[o],A=this.inbandTextTracks_;this.logger_(`adding cues from ${s} -> ${S} for ${o}`),function(o,s,m){if(!o[m]){s.trigger({type:"usage",name:"vhs-608"});let _=m;/^cc708_/.test(m)&&(_="SERVICE"+m.split("_")[1]);const S=s.textTracks().getTrackById(_);if(S)o[m]=S;else{let S=m,E=m,A=!1;const O=(s.options_.vhs&&s.options_.vhs.captionServices||{})[_];O&&(S=O.label,E=O.language,A=O.default),o[m]=s.addRemoteTextTrack({kind:"captions",id:_,default:A,label:S,language:E},!1).track}}}(A,this.vhs_.tech_,o),removeCuesFromTrack(s,S,A[o]),function({inbandTextTracks:o,captionArray:s,timestampOffset:m}){if(!s)return;const _=$V.WebKitDataCue||$V.VTTCue;s.forEach((s=>{const S=s.stream;s.content?s.content.forEach((E=>{const A=new _(s.startTime+m,s.endTime+m,E.text);A.line=E.line,A.align="left",A.position=E.position,A.positionAlign="line-left",o[S].addCue(A)})):o[S].addCue(new _(s.startTime+m,s.endTime+m,s.text))}))}({captionArray:E,inbandTextTracks:A,timestampOffset:m})})),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(o,s,m){if(this.earlyAbortWhenNeeded_(o.stats),this.checkForAbort_(o.requestId))return;this.pendingSegment_.hasAppendedData_?this.addMetadataToTextTrack(m,s,this.duration_()):this.metadataQueue_.id3.push(this.handleId3_.bind(this,o,s,m))}processMetadataQueue_(){this.metadataQueue_.id3.forEach((o=>o())),this.metadataQueue_.caption.forEach((o=>o())),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const o=this.callQueue_;this.callQueue_=[],o.forEach((o=>o()))}processLoadQueue_(){const o=this.loadQueue_;this.loadQueue_=[],o.forEach((o=>o()))}hasEnoughInfoToLoad_(){if("audio"!==this.loaderType_)return!0;const o=this.pendingSegment_;return!!o&&(!this.getCurrentMediaInfo_()||!shouldWaitForTimelineChange({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:o.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}getCurrentMediaInfo_(o=this.pendingSegment_){return o&&o.trackInfo||this.currentMediaInfo_}getMediaInfo_(o=this.pendingSegment_){return this.getCurrentMediaInfo_(o)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready())return!1;if(this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const o=this.pendingSegment_,s=this.getCurrentMediaInfo_();if(!o||!s)return!1;const{hasAudio:m,hasVideo:_,isMuxed:S}=s;return!(_&&!o.videoTimingInfo)&&(!(m&&!this.audioDisabled_&&!S&&!o.audioTimingInfo)&&!shouldWaitForTimelineChange({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:o.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(o,s){if(this.earlyAbortWhenNeeded_(o.stats),this.checkForAbort_(o.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_())return void this.callQueue_.push(this.handleData_.bind(this,o,s));const m=this.pendingSegment_;if(this.setTimeMapping_(m.timeline),this.updateMediaSecondsLoaded_(m.part||m.segment),"closed"!==this.mediaSource_.readyState){if(o.map&&(o.map=this.initSegmentForMap(o.map,!0),m.segment.map=o.map),o.key&&this.segmentKey(o.key,!0),m.isFmp4=o.isFmp4,m.timingInfo=m.timingInfo||{},m.isFmp4)this.trigger("fmp4"),m.timingInfo.start=m[timingInfoPropertyForMedia(s.type)].start;else{const o=this.getCurrentMediaInfo_(),s="main"===this.loaderType_&&o&&o.hasVideo;let _;s&&(_=m.videoTimingInfo.start),m.timingInfo.start=this.trueSegmentStart_({currentStart:m.timingInfo.start,playlist:m.playlist,mediaIndex:m.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:s,firstVideoFrameTimeForData:_,videoTimingInfo:m.videoTimingInfo,audioTimingInfo:m.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(m,s.type),this.updateSourceBufferTimestampOffset_(m),m.isSyncRequest){this.updateTimingInfoEnd_(m),this.syncController_.saveSegmentTimingInfo({segmentInfo:m,shouldSaveTimelineMapping:"main"===this.loaderType_});const o=this.chooseNextRequest_();if(o.mediaIndex!==m.mediaIndex||o.partIndex!==m.partIndex)return void this.logger_("sync segment was incorrect, not appending");this.logger_("sync segment was correct, appending")}m.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(m,s)}}updateAppendInitSegmentStatus(o,s){"main"!==this.loaderType_||"number"!=typeof o.timestampOffset||o.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[s]!==o.playlist&&(this.appendInitSegment_[s]=!0)}getInitSegmentAndUpdateState_({type:o,initSegment:s,map:m,playlist:_}){if(m){const o=initSegmentId(m);if(this.activeInitSegmentId_===o)return null;s=this.initSegmentForMap(m,!0).bytes,this.activeInitSegmentId_=o}return s&&this.appendInitSegment_[o]?(this.playlistOfLastInitSegment_[o]=_,this.appendInitSegment_[o]=!1,this.activeInitSegmentId_=null,s):null}handleQuotaExceededError_({segmentInfo:o,type:s,bytes:m},_){const S=this.sourceUpdater_.audioBuffered(),E=this.sourceUpdater_.videoBuffered();S.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+timeRangesToArray(S).join(", ")),E.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+timeRangesToArray(E).join(", "));const A=S.length?S.start(0):0,O=S.length?S.end(S.length-1):0,H=E.length?E.start(0):0,K=E.length?E.end(E.length-1):0;if(O-A<=1&&K-H<=1)return this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${m.byteLength}, audio buffer: ${timeRangesToArray(S).join(", ")}, video buffer: ${timeRangesToArray(E).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),void this.trigger("error");this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:o,type:s,bytes:m}));const z=this.currentTime_()-1;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${z}`),this.remove(0,z,(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, retrying append in 1s"),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=$V.setTimeout((()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()}),1e3)}),!0)}handleAppendError_({segmentInfo:o,type:s,bytes:m},_){_&&(22!==_.code?(this.logger_("Received non QUOTA_EXCEEDED_ERR on append",_),this.error(`${s} append of ${m.length}b failed for segment #${o.mediaIndex} in playlist ${o.playlist.id}`),this.trigger("appenderror")):this.handleQuotaExceededError_({segmentInfo:o,type:s,bytes:m}))}appendToSourceBuffer_({segmentInfo:o,type:s,initSegment:m,data:_,bytes:S}){if(!S){const o=[_];let s=_.byteLength;m&&(o.unshift(m),s+=m.byteLength),S=(o=>{let s,m=0;return o.bytes&&(s=new Uint8Array(o.bytes),o.segments.forEach((o=>{s.set(o,m),m+=o.byteLength}))),s})({bytes:s,segments:o})}this.sourceUpdater_.appendBuffer({segmentInfo:o,type:s,bytes:S},this.handleAppendError_.bind(this,{segmentInfo:o,type:s,bytes:S}))}handleSegmentTimingInfo_(o,s,m){if(!this.pendingSegment_||s!==this.pendingSegment_.requestId)return;const _=this.pendingSegment_.segment,S=`${o}TimingInfo`;_[S]||(_[S]={}),_[S].transmuxerPrependedSeconds=m.prependedContentDuration||0,_[S].transmuxedPresentationStart=m.start.presentation,_[S].transmuxedDecodeStart=m.start.decode,_[S].transmuxedPresentationEnd=m.end.presentation,_[S].transmuxedDecodeEnd=m.end.decode,_[S].baseMediaDecodeTime=m.baseMediaDecodeTime}appendData_(o,s){const{type:m,data:_}=s;if(!_||!_.byteLength)return;if("audio"===m&&this.audioDisabled_)return;const S=this.getInitSegmentAndUpdateState_({type:m,initSegment:s.initSegment,playlist:o.playlist,map:o.isFmp4?o.segment.map:null});this.appendToSourceBuffer_({segmentInfo:o,type:m,initSegment:S,data:_})}loadSegment_(o){this.state="WAITING",this.pendingSegment_=o,this.trimBackBuffer_(o),"number"==typeof o.timestampOffset&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.hasEnoughInfoToLoad_()?this.updateTransmuxerAndRequestSegment_(o):this.loadQueue_.push((()=>{const s=gH({},o,{forceTimestampOffset:!0});gH(o,this.generateSegmentInfo_(s)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(o)}))}updateTransmuxerAndRequestSegment_(o){this.shouldUpdateTransmuxerTimestampOffset_(o.timestampOffset)&&(this.gopBuffer_.length=0,o.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:o.timestampOffset}));const s=this.createSimplifiedSegmentObj_(o),m=this.isEndOfStream_(o.mediaIndex,o.playlist,o.partIndex),_=null!==this.mediaIndex,S=o.timeline!==this.currentTimeline_&&o.timeline>0,E=m||_&&S;this.logger_(`Requesting ${segmentInfoString(o)}`),s.map&&!s.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),o.abortRequests=mediaSegmentRequest({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:s,abortFn:this.handleAbort_.bind(this,o),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",o.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",o.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:E,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:s,level:m,stream:_})=>{this.logger_(`${segmentInfoString(o)} logged from transmuxer stream ${_} as a ${m}: ${s}`)}})}trimBackBuffer_(o){const s=((o,s,m)=>{let _=s-b2.BACK_BUFFER_LENGTH;o.length&&(_=Math.max(_,o.start(0)));const S=s-m;return Math.min(S,_)})(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);s>0&&this.remove(0,s)}createSimplifiedSegmentObj_(o){const s=o.segment,m=o.part,_={resolvedUri:m?m.resolvedUri:s.resolvedUri,byterange:m?m.byterange:s.byterange,requestId:o.requestId,transmuxer:o.transmuxer,audioAppendStart:o.audioAppendStart,gopsToAlignWith:o.gopsToAlignWith,part:o.part},S=o.playlist.segments[o.mediaIndex-1];if(S&&S.timeline===s.timeline&&(S.videoTimingInfo?_.baseStartTime=S.videoTimingInfo.transmuxedDecodeEnd:S.audioTimingInfo&&(_.baseStartTime=S.audioTimingInfo.transmuxedDecodeEnd)),s.key){const m=s.key.iv||new Uint32Array([0,0,0,o.mediaIndex+o.playlist.mediaSequence]);_.key=this.segmentKey(s.key),_.key.iv=m}return s.map&&(_.map=this.initSegmentForMap(s.map)),_}saveTransferStats_(o){this.mediaRequests+=1,o&&(this.mediaBytesTransferred+=o.bytesReceived,this.mediaTransferDuration+=o.roundTripTime)}saveBandwidthRelatedStats_(o,s){this.pendingSegment_.byteLength=s.bytesReceived,o<P2?this.logger_(`Ignoring segment's bandwidth because its duration of ${o} is less than the min to record 0.016666666666666666`):(this.bandwidth=s.bandwidth,this.roundTrip=s.roundTripTime)}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(o,s,m){if(this.callQueue_.length)return void this.callQueue_.push(this.segmentRequestFinished_.bind(this,o,s,m));if(this.saveTransferStats_(s.stats),!this.pendingSegment_)return;if(s.requestId!==this.pendingSegment_.requestId)return;if(o){if(this.pendingSegment_=null,this.state="READY",o.code===w2)return;return this.pause(),o.code===C2?void this.handleTimeout_():(this.mediaRequestsErrored+=1,this.error(o),void this.trigger("error"))}const _=this.pendingSegment_;this.saveBandwidthRelatedStats_(_.duration,s.stats),_.endOfAllRequests=s.endOfAllRequests,m.gopInfo&&(this.gopBuffer_=((o,s,m)=>{if(!s.length)return o;if(m)return s.slice();const _=s[0].pts;let S=0;for(;S<o.length&&!(o[S].pts>=_);S++);return o.slice(0,S).concat(s)})(this.gopBuffer_,m.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(_)}setTimeMapping_(o){const s=this.syncController_.mappingForTimeline(o);null!==s&&(this.timeMapping_=s)}updateMediaSecondsLoaded_(o){"number"==typeof o.start&&"number"==typeof o.end?this.mediaSecondsLoaded+=o.end-o.start:this.mediaSecondsLoaded+=o.duration}shouldUpdateTransmuxerTimestampOffset_(o){return null!==o&&("main"===this.loaderType_&&o!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&o!==this.sourceUpdater_.audioTimestampOffset())}trueSegmentStart_({currentStart:o,playlist:s,mediaIndex:m,firstVideoFrameTimeForData:_,currentVideoTimestampOffset:S,useVideoTimingInfo:E,videoTimingInfo:A,audioTimingInfo:O}){if(void 0!==o)return o;if(!E)return O.start;const H=s.segments[m-1];return 0!==m&&H&&void 0!==H.start&&H.end===_+S?A.start:_}waitForAppendsToComplete_(o){const s=this.getCurrentMediaInfo_(o);if(!s)return this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),void this.trigger("error");const{hasAudio:m,hasVideo:_,isMuxed:S}=s,E="main"===this.loaderType_&&_,A=!this.audioDisabled_&&m&&!S;if(o.waitingOnAppends=0,!o.hasAppendedData_)return o.timingInfo||"number"!=typeof o.timestampOffset||(this.isPendingTimestampOffset_=!0),o.timingInfo={start:0},o.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(o),this.processMetadataQueue_()),void this.checkAppendsDone_(o);E&&o.waitingOnAppends++,A&&o.waitingOnAppends++,E&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,o)),A&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,o))}checkAppendsDone_(o){this.checkForAbort_(o.requestId)||(o.waitingOnAppends--,0===o.waitingOnAppends&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(o){const s=((o,s,m)=>"main"===o&&s&&m?m.hasAudio||m.hasVideo?s.hasVideo&&!m.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!s.hasVideo&&m.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null)(this.loaderType_,this.getCurrentMediaInfo_(),o);return!!s&&(this.error({message:s,playlistExclusionDuration:1/0}),this.trigger("error"),!0)}updateSourceBufferTimestampOffset_(o){if(null===o.timestampOffset||"number"!=typeof o.timingInfo.start||o.changedTimestampOffset||"main"!==this.loaderType_)return;let s=!1;o.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:o.segment.videoTimingInfo,audioTimingInfo:o.segment.audioTimingInfo,timingInfo:o.timingInfo}),o.changedTimestampOffset=!0,o.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(o.timestampOffset),s=!0),o.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(o.timestampOffset),s=!0),s&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:o,audioTimingInfo:s,timingInfo:m}){return this.useDtsForTimestampOffset_?o&&"number"==typeof o.transmuxedDecodeStart?o.transmuxedDecodeStart:s&&"number"==typeof s.transmuxedDecodeStart?s.transmuxedDecodeStart:m.start:m.start}updateTimingInfoEnd_(o){o.timingInfo=o.timingInfo||{};const s=this.getMediaInfo_(),m="main"===this.loaderType_&&s&&s.hasVideo&&o.videoTimingInfo?o.videoTimingInfo:o.audioTimingInfo;m&&(o.timingInfo.end="number"==typeof m.end?m.end:m.start+o.duration)}handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());const o=this.pendingSegment_;this.updateTimingInfoEnd_(o),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:o,shouldSaveTimelineMapping:"main"===this.loaderType_});const s=getTroublesomeSegmentDurationMessage(o,this.sourceType_);if(s&&("warn"===s.severity?videojs.log.warn(s.message):this.logger_(s.message)),this.recordThroughput_(o),this.pendingSegment_=null,this.state="READY",o.isSyncRequest&&(this.trigger("syncinfoupdate"),!o.hasAppendedData_))return void this.logger_(`Throwing away un-appended sync request ${segmentInfoString(o)}`);this.logger_(`Appended ${segmentInfoString(o)}`),this.addSegmentMetadataCue_(o),this.fetchAtBuffer_=!0,this.currentTimeline_!==o.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:o.timeline}),"main"!==this.loaderType_||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:o.timeline})),this.currentTimeline_=o.timeline,this.trigger("syncinfoupdate");const m=o.segment,_=o.part,S=m.end&&this.currentTime_()-m.end>3*o.playlist.targetDuration,E=_&&_.end&&this.currentTime_()-_.end>3*o.playlist.partTargetDuration;if(S||E)return this.logger_(`bad ${S?"segment":"part"} ${segmentInfoString(o)}`),void this.resetEverything();null!==this.mediaIndex&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=o.mediaIndex,this.partIndex=o.partIndex,this.isEndOfStream_(o.mediaIndex,o.playlist,o.partIndex)&&this.endOfStream(),this.trigger("appended"),o.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(o){if(o.duration<P2)return void this.logger_(`Ignoring segment's throughput because its duration of ${o.duration} is less than the min to record 0.016666666666666666`);const s=this.throughput.rate,m=Date.now()-o.endOfAllRequests+1,_=Math.floor(o.byteLength/m*8*1e3);this.throughput.rate+=(_-s)/++this.throughput.count}addSegmentMetadataCue_(o){if(!this.segmentMetadataTrack_)return;const s=o.segment,m=s.start,_=s.end;if(!finite(m)||!finite(_))return;removeCuesFromTrack(m,_,this.segmentMetadataTrack_);const S=$V.WebKitDataCue||$V.VTTCue,E={custom:s.custom,dateTimeObject:s.dateTimeObject,dateTimeString:s.dateTimeString,programDateTime:s.programDateTime,bandwidth:o.playlist.attributes.BANDWIDTH,resolution:o.playlist.attributes.RESOLUTION,codecs:o.playlist.attributes.CODECS,byteLength:o.byteLength,uri:o.uri,timeline:o.timeline,playlist:o.playlist.id,start:m,end:_},A=new S(m,_,JSON.stringify(E));A.value=E,this.segmentMetadataTrack_.addCue(A)}}function noop(){}const toTitleCase=function(o){return"string"!=typeof o?o:o.replace(/./,(o=>o.toUpperCase()))},L2=["video","audio"],updating=(o,s)=>{const m=s[`${o}Buffer`];return m&&m.updating||s.queuePending[o]},shiftQueue=(o,s)=>{if(0===s.queue.length)return;let m=0,_=s.queue[m];if("mediaSource"!==_.type){if("mediaSource"!==o&&s.ready()&&"closed"!==s.mediaSource.readyState&&!updating(o,s)){if(_.type!==o){if(m=((o,s)=>{for(let m=0;m<s.length;m++){const _=s[m];if("mediaSource"===_.type)return null;if(_.type===o)return m}return null})(o,s.queue),null===m)return;_=s.queue[m]}return s.queue.splice(m,1),s.queuePending[o]=_,_.action(o,s),_.doneFn?void 0:(s.queuePending[o]=null,void shiftQueue(o,s))}}else s.updating()||"closed"===s.mediaSource.readyState||(s.queue.shift(),_.action(s),_.doneFn&&_.doneFn(),shiftQueue("audio",s),shiftQueue("video",s))},cleanupBuffer=(o,s)=>{const m=s[`${o}Buffer`],_=toTitleCase(o);m&&(m.removeEventListener("updateend",s[`on${_}UpdateEnd_`]),m.removeEventListener("error",s[`on${_}Error_`]),s.codecs[o]=null,s[`${o}Buffer`]=null)},inSourceBuffers=(o,s)=>o&&s&&-1!==Array.prototype.indexOf.call(o.sourceBuffers,s),actions_appendBuffer=(o,s,m)=>(_,S)=>{const E=S[`${_}Buffer`];if(inSourceBuffers(S.mediaSource,E)){S.logger_(`Appending segment ${s.mediaIndex}'s ${o.length} bytes to ${_}Buffer`);try{E.appendBuffer(o)}catch(o){S.logger_(`Error with code ${o.code} `+(22===o.code?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${s.mediaIndex} to ${_}Buffer`),S.queuePending[_]=null,m(o)}}},actions_remove=(o,s)=>(m,_)=>{const S=_[`${m}Buffer`];if(inSourceBuffers(_.mediaSource,S)){_.logger_(`Removing ${o} to ${s} from ${m}Buffer`);try{S.remove(o,s)}catch(S){_.logger_(`Remove ${o} to ${s} from ${m}Buffer failed`)}}},actions_timestampOffset=o=>(s,m)=>{const _=m[`${s}Buffer`];inSourceBuffers(m.mediaSource,_)&&(m.logger_(`Setting ${s}timestampOffset to ${o}`),_.timestampOffset=o)},actions_callback=o=>(s,m)=>{o()},actions_endOfStream=o=>s=>{if("open"===s.mediaSource.readyState){s.logger_(`Calling mediaSource endOfStream(${o||""})`);try{s.mediaSource.endOfStream(o)}catch(o){videojs.log.warn("Failed to call media source endOfStream",o)}}},actions_duration=o=>s=>{s.logger_(`Setting mediaSource duration to ${o}`);try{s.mediaSource.duration=o}catch(o){videojs.log.warn("Failed to set media source duration",o)}},actions_abort=()=>(o,s)=>{if("open"!==s.mediaSource.readyState)return;const m=s[`${o}Buffer`];if(inSourceBuffers(s.mediaSource,m)){s.logger_(`calling abort on ${o}Buffer`);try{m.abort()}catch(s){videojs.log.warn(`Failed to abort on ${o}Buffer`,s)}}},actions_addSourceBuffer=(o,s)=>m=>{const _=toTitleCase(o),S=gK(s);m.logger_(`Adding ${o}Buffer with codec ${s} to mediaSource`);const E=m.mediaSource.addSourceBuffer(S);E.addEventListener("updateend",m[`on${_}UpdateEnd_`]),E.addEventListener("error",m[`on${_}Error_`]),m.codecs[o]=s,m[`${o}Buffer`]=E},actions_removeSourceBuffer=o=>s=>{const m=s[`${o}Buffer`];if(cleanupBuffer(o,s),inSourceBuffers(s.mediaSource,m)){s.logger_(`Removing ${o}Buffer with codec ${s.codecs[o]} from mediaSource`);try{s.mediaSource.removeSourceBuffer(m)}catch(s){videojs.log.warn(`Failed to removeSourceBuffer ${o}Buffer`,s)}}},actions_changeType=o=>(s,m)=>{const _=m[`${s}Buffer`],S=gK(o);if(inSourceBuffers(m.mediaSource,_)&&m.codecs[s]!==o){m.logger_(`changing ${s}Buffer codec from ${m.codecs[s]} to ${o}`);try{_.changeType(S),m.codecs[s]=o}catch(o){videojs.log.warn(`Failed to changeType on ${s}Buffer`,o)}}},pushQueue=({type:o,sourceUpdater:s,action:m,doneFn:_,name:S})=>{s.queue.push({type:o,action:m,doneFn:_,name:S}),shiftQueue(o,s)},onUpdateend=(o,s)=>m=>{if(s.queuePending[o]){const m=s.queuePending[o].doneFn;s.queuePending[o]=null,m&&m(s[`${o}Error_`])}shiftQueue(o,s)};class SourceUpdater extends videojs.EventTarget{constructor(o){super(),this.mediaSource=o,this.sourceopenListener_=()=>shiftQueue("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=logger("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=onUpdateend("video",this),this.onAudioUpdateEnd_=onUpdateend("audio",this),this.onVideoError_=o=>{this.videoError_=o},this.onAudioError_=o=>{this.audioError_=o},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(o){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(o),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(o,s){pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_addSourceBuffer(o,s),name:"addSourceBuffer"})}abort(o){pushQueue({type:o,sourceUpdater:this,action:actions_abort(o),name:"abort"})}removeSourceBuffer(o){this.canRemoveSourceBuffer()?pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_removeSourceBuffer(o),name:"removeSourceBuffer"}):videojs.log.error("removeSourceBuffer is not supported!")}canRemoveSourceBuffer(){return!videojs.browser.IS_FIREFOX&&$V.MediaSource&&$V.MediaSource.prototype&&"function"==typeof $V.MediaSource.prototype.removeSourceBuffer}static canChangeType(){return $V.SourceBuffer&&$V.SourceBuffer.prototype&&"function"==typeof $V.SourceBuffer.prototype.changeType}canChangeType(){return this.constructor.canChangeType()}changeType(o,s){this.canChangeType()?pushQueue({type:o,sourceUpdater:this,action:actions_changeType(s),name:"changeType"}):videojs.log.error("changeType is not supported!")}addOrChangeSourceBuffers(o){if(!o||"object"!=typeof o||0===Object.keys(o).length)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(o).forEach((s=>{const m=o[s];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(s,m);this.canChangeType()&&this.changeType(s,m)}))}appendBuffer(o,s){const{segmentInfo:m,type:_,bytes:S}=o;if(this.processedAppend_=!0,"audio"===_&&this.videoBuffer&&!this.videoAppendQueued_)return this.delayedAudioAppendQueue_.push([o,s]),void this.logger_(`delayed audio append of ${S.length} until video append`);if(pushQueue({type:_,sourceUpdater:this,action:actions_appendBuffer(S,m||{mediaIndex:-1},s),doneFn:s,name:"appendBuffer"}),"video"===_){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const o=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${o.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,o.forEach((o=>{this.appendBuffer.apply(this,o)}))}}audioBuffered(){return inSourceBuffers(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:createTimeRanges()}videoBuffered(){return inSourceBuffers(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:createTimeRanges()}buffered(){const o=inSourceBuffers(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,s=inSourceBuffers(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return s&&!o?this.audioBuffered():o&&!s?this.videoBuffered():function(o,s){let m=null,_=null,S=0;const E=[],A=[];if(!(o&&o.length&&s&&s.length))return createTimeRanges();let O=o.length;for(;O--;)E.push({time:o.start(O),type:"start"}),E.push({time:o.end(O),type:"end"});for(O=s.length;O--;)E.push({time:s.start(O),type:"start"}),E.push({time:s.end(O),type:"end"});for(E.sort((function(o,s){return o.time-s.time})),O=0;O<E.length;O++)"start"===E[O].type?(S++,2===S&&(m=E[O].time)):"end"===E[O].type&&(S--,1===S&&(_=E[O].time)),null!==m&&null!==_&&(A.push([m,_]),m=null,_=null);return createTimeRanges(A)}(this.audioBuffered(),this.videoBuffered())}setDuration(o,s=noop){pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_duration(o),name:"duration",doneFn:s})}endOfStream(o=null,s=noop){"string"!=typeof o&&(o=void 0),pushQueue({type:"mediaSource",sourceUpdater:this,action:actions_endOfStream(o),name:"endOfStream",doneFn:s})}removeAudio(o,s,m=noop){this.audioBuffered().length&&0!==this.audioBuffered().end(0)?pushQueue({type:"audio",sourceUpdater:this,action:actions_remove(o,s),doneFn:m,name:"remove"}):m()}removeVideo(o,s,m=noop){this.videoBuffered().length&&0!==this.videoBuffered().end(0)?pushQueue({type:"video",sourceUpdater:this,action:actions_remove(o,s),doneFn:m,name:"remove"}):m()}updating(){return!(!updating("audio",this)&&!updating("video",this))}audioTimestampOffset(o){return void 0!==o&&this.audioBuffer&&this.audioTimestampOffset_!==o&&(pushQueue({type:"audio",sourceUpdater:this,action:actions_timestampOffset(o),name:"timestampOffset"}),this.audioTimestampOffset_=o),this.audioTimestampOffset_}videoTimestampOffset(o){return void 0!==o&&this.videoBuffer&&this.videoTimestampOffset!==o&&(pushQueue({type:"video",sourceUpdater:this,action:actions_timestampOffset(o),name:"timestampOffset"}),this.videoTimestampOffset_=o),this.videoTimestampOffset_}audioQueueCallback(o){this.audioBuffer&&pushQueue({type:"audio",sourceUpdater:this,action:actions_callback(o),name:"callback"})}videoQueueCallback(o){this.videoBuffer&&pushQueue({type:"video",sourceUpdater:this,action:actions_callback(o),name:"callback"})}dispose(){this.trigger("dispose"),L2.forEach((o=>{this.abort(o),this.canRemoveSourceBuffer()?this.removeSourceBuffer(o):this[`${o}QueueCallback`]((()=>cleanupBuffer(o,this)))})),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const uint8ToUtf8=o=>decodeURIComponent(escape(String.fromCharCode.apply(null,o))),D2=new Uint8Array("\n\n".split("").map((o=>o.charCodeAt(0))));class NoVttJsError extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class VTTSegmentLoader extends SegmentLoader{constructor(o,s={}){super(o,s),this.mediaSource_=null,this.subtitlesTrack_=null,this.loaderType_="subtitle",this.featuresNativeTextTracks_=o.featuresNativeTextTracks,this.loadVttJs=o.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return createTimeRanges();const o=this.subtitlesTrack_.cues;return createTimeRanges([[o[0].startTime,o[o.length-1].startTime]])}initSegmentForMap(o,s=!1){if(!o)return null;const m=initSegmentId(o);let _=this.initSegments_[m];if(s&&!_&&o.bytes){const s=D2.byteLength+o.bytes.byteLength,S=new Uint8Array(s);S.set(o.bytes),S.set(D2,o.bytes.byteLength),this.initSegments_[m]=_={resolvedUri:o.resolvedUri,byterange:o.byterange,bytes:S}}return _||o}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(o){return void 0===o||(this.subtitlesTrack_=o,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}remove(o,s){removeCuesFromTrack(o,s,this.subtitlesTrack_)}fillBuffer_(){const o=this.chooseNextRequest_();if(o){if(null===this.syncController_.timestampOffsetForTimeline(o.timeline)){const checkTimestampOffset=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};return this.syncController_.one("timestampoffset",checkTimestampOffset),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(o)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(o){for(;o&&o.segment.empty;){if(o.mediaIndex+1>=o.playlist.segments.length){o=null;break}o=this.generateSegmentInfo_({playlist:o.playlist,mediaIndex:o.mediaIndex+1,startOfSegment:o.startOfSegment+o.duration,isSyncRequest:o.isSyncRequest})}return o}stopForError(o){this.error(o),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(o,s,m){if(!this.subtitlesTrack_)return void(this.state="READY");if(this.saveTransferStats_(s.stats),!this.pendingSegment_)return this.state="READY",void(this.mediaRequestsAborted+=1);if(o)return o.code===C2&&this.handleTimeout_(),o.code===w2?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,void this.stopForError(o);const _=this.pendingSegment_;this.saveBandwidthRelatedStats_(_.duration,s.stats),s.key&&this.segmentKey(s.key,!0),this.state="APPENDING",this.trigger("appending");const S=_.segment;if(S.map&&(S.map.bytes=s.map.bytes),_.bytes=s.bytes,"function"!=typeof $V.WebVTT&&"function"==typeof this.loadVttJs)return this.state="WAITING_ON_VTTJS",void this.loadVttJs().then((()=>this.segmentRequestFinished_(o,s,m)),(()=>this.stopForError({message:"Error loading vtt.js"})));S.requested=!0;try{this.parseVTTCues_(_)}catch(o){return void this.stopForError({message:o.message})}if(this.updateTimeMapping_(_,this.syncController_.timelines[_.timeline],this.playlist_),_.cues.length?_.timingInfo={start:_.cues[0].startTime,end:_.cues[_.cues.length-1].endTime}:_.timingInfo={start:_.startOfSegment,end:_.startOfSegment+_.duration},_.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");_.byteLength=_.bytes.byteLength,this.mediaSecondsLoaded+=S.duration,_.cues.forEach((o=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new $V.VTTCue(o.startTime,o.endTime,o.text):o)})),function(o){const s=o.cues;if(!s)return;const m={};for(let _=s.length-1;_>=0;_--){const S=s[_],E=`${S.startTime}-${S.endTime}-${S.text}`;m[E]?o.removeCue(S):m[E]=S}}(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(o){let s,m=!1;if("function"!=typeof $V.WebVTT)throw new NoVttJsError;"function"==typeof $V.TextDecoder?s=new $V.TextDecoder("utf8"):(s=$V.WebVTT.StringDecoder(),m=!0);const _=new $V.WebVTT.Parser($V,$V.vttjs,s);if(o.cues=[],o.timestampmap={MPEGTS:0,LOCAL:0},_.oncue=o.cues.push.bind(o.cues),_.ontimestampmap=s=>{o.timestampmap=s},_.onparsingerror=o=>{videojs.log.warn("Error encountered when parsing cues: "+o.message)},o.segment.map){let s=o.segment.map.bytes;m&&(s=uint8ToUtf8(s)),_.parse(s)}let S=o.bytes;m&&(S=uint8ToUtf8(S)),_.parse(S),_.flush()}updateTimeMapping_(o,s,m){const _=o.segment;if(!s)return;if(!o.cues.length)return void(_.empty=!0);const{MPEGTS:S,LOCAL:E}=o.timestampmap,A=S/c2-E+s.mapping;if(o.cues.forEach((o=>{const m=o.endTime-o.startTime,_=0===S?o.startTime+A:this.handleRollover_(o.startTime+A,s.time);o.startTime=Math.max(_,0),o.endTime=Math.max(_+m,0)})),!m.syncInfo){const s=o.cues[0].startTime,S=o.cues[o.cues.length-1].startTime;m.syncInfo={mediaSequence:m.mediaSequence+o.mediaIndex,time:Math.min(s,S-_.duration)}}}handleRollover_(o,s){if(null===s)return o;let m=o*c2;const _=s*c2;let S;for(S=_<m?-8589934592:8589934592;Math.abs(m-_)>4294967296;)m+=S;return m/c2}}const findAdCue=function(o,s){const m=o.cues;for(let o=0;o<m.length;o++){const _=m[o];if(s>=_.adStartTime&&s<=_.adEndTime)return _}return null},R2=[{name:"VOD",run:(o,s,m,_,S)=>{if(m!==1/0){return{time:0,segmentIndex:0,partIndex:null}}return null}},{name:"MediaSequence",run:(o,s,m,_,S,E)=>{if(!E)return null;const A=o.getMediaSequenceMap(E);if(!A||0===A.size)return null;if(void 0===s.mediaSequence||!Array.isArray(s.segments)||!s.segments.length)return null;let O=s.mediaSequence,H=0;for(const o of s.segments){const s=A.get(O);if(!s)break;if(S>=s.start&&S<s.end){if(Array.isArray(o.parts)&&o.parts.length){let m=s.start,_=0;for(const E of o.parts){const o=m,A=o+E.duration;if(S>=o&&S<A)return{time:s.start,segmentIndex:H,partIndex:_};_++,m=A}}return{time:s.start,segmentIndex:H,partIndex:null}}H++,O++}return null}},{name:"ProgramDateTime",run:(o,s,m,_,S)=>{if(!Object.keys(o.timelineToDatetimeMappings).length)return null;let E=null,A=null;const O=getPartsAndSegments(s);S=S||0;for(let m=0;m<O.length;m++){const _=O[s.endList||0===S?m:O.length-(m+1)],H=_.segment,K=o.timelineToDatetimeMappings[H.timeline];if(!K||!H.dateTimeObject)continue;let z=H.dateTimeObject.getTime()/1e3+K;if(H.parts&&"number"==typeof _.partIndex)for(let o=0;o<_.partIndex;o++)z+=H.parts[o].duration;const G=Math.abs(S-z);if(null!==A&&(0===G||A<G))break;A=G,E={time:z,segmentIndex:_.segmentIndex,partIndex:_.partIndex}}return E}},{name:"Segment",run:(o,s,m,_,S)=>{let E=null,A=null;S=S||0;const O=getPartsAndSegments(s);for(let o=0;o<O.length;o++){const m=O[s.endList||0===S?o:O.length-(o+1)],H=m.segment,K=m.part&&m.part.start||H&&H.start;if(H.timeline===_&&void 0!==K){const o=Math.abs(S-K);if(null!==A&&A<o)break;(!E||null===A||A>=o)&&(A=o,E={time:K,segmentIndex:m.segmentIndex,partIndex:m.partIndex})}}return E}},{name:"Discontinuity",run:(o,s,m,_,S)=>{let E=null;if(S=S||0,s.discontinuityStarts&&s.discontinuityStarts.length){let m=null;for(let _=0;_<s.discontinuityStarts.length;_++){const A=s.discontinuityStarts[_],O=s.discontinuitySequence+_+1,H=o.discontinuities[O];if(H){const o=Math.abs(S-H.time);if(null!==m&&m<o)break;(!E||null===m||m>=o)&&(m=o,E={time:H.time,segmentIndex:A,partIndex:null})}}}return E}},{name:"Playlist",run:(o,s,m,_,S)=>{if(s.syncInfo){return{time:s.syncInfo.time,segmentIndex:s.syncInfo.mediaSequence-s.mediaSequence,partIndex:null}}return null}}];class SyncController extends videojs.EventTarget{constructor(o={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.mediaSequenceStorage_=new Map,this.logger_=logger("SyncController")}getMediaSequenceMap(o){return this.mediaSequenceStorage_.get(o)}updateMediaSequenceMap(o,s,m){if(void 0===o.mediaSequence||!Array.isArray(o.segments)||!o.segments.length)return;const _=this.getMediaSequenceMap(m),S=new Map;let E,A=o.mediaSequence;_?_.has(o.mediaSequence)?E=_.get(o.mediaSequence).start:(this.logger_(`MediaSequence sync for ${m} segment loader - received a gap between playlists.\nFallback base time to: ${s}.\nReceived media sequence: ${A}.\nCurrent map: `,_),E=s):E=0,this.logger_(`MediaSequence sync for ${m} segment loader.\nReceived media sequence: ${A}.\nbase time is ${E}\nCurrent map: `,_),o.segments.forEach((o=>{const s=E,m=s+o.duration,_={start:s,end:m};S.set(A,_),A++,E=m})),this.mediaSequenceStorage_.set(m,S)}getSyncPoint(o,s,m,_,S){if(s!==1/0){const m=R2.find((({name:o})=>"VOD"===o));return m.run(this,o,s)}const E=this.runStrategies_(o,s,m,_,S);if(!E.length)return null;for(const s of E){const{syncPoint:m,strategy:S}=s,{segmentIndex:E,time:A}=m;if(E<0)continue;const O=A,H=O+o.segments[E].duration;if(this.logger_(`Strategy: ${S}. Current time: ${_}. selected segment: ${E}. Time: [${O} -> ${H}]}`),_>=O&&_<H)return this.logger_("Found sync point with exact match: ",m),m}return this.selectSyncPoint_(E,{key:"time",value:_})}getExpiredTime(o,s){if(!o||!o.segments)return null;const m=this.runStrategies_(o,s,o.discontinuitySequence,0,"main");if(!m.length)return null;const _=this.selectSyncPoint_(m,{key:"segmentIndex",value:0});return _.segmentIndex>0&&(_.time*=-1),Math.abs(_.time+sumDurations({defaultDuration:o.targetDuration,durationList:o.segments,startIndex:_.segmentIndex,endIndex:0}))}runStrategies_(o,s,m,_,S){const E=[];for(let A=0;A<R2.length;A++){const O=R2[A],H=O.run(this,o,s,m,_,S);H&&(H.strategy=O.name,E.push({strategy:O.name,syncPoint:H}))}return E}selectSyncPoint_(o,s){let m=o[0].syncPoint,_=Math.abs(o[0].syncPoint[s.key]-s.value),S=o[0].strategy;for(let E=1;E<o.length;E++){const A=Math.abs(o[E].syncPoint[s.key]-s.value);A<_&&(_=A,m=o[E].syncPoint,S=o[E].strategy)}return this.logger_(`syncPoint for [${s.key}: ${s.value}] chosen with strategy [${S}]: [time:${m.time}, segmentIndex:${m.segmentIndex}`+("number"==typeof m.partIndex?`,partIndex:${m.partIndex}`:"")+"]"),m}saveExpiredSegmentInfo(o,s){const m=s.mediaSequence-o.mediaSequence;if(m>86400)videojs.log.warn(`Not saving expired segment info. Media sequence gap ${m} is too large.`);else for(let _=m-1;_>=0;_--){const m=o.segments[_];if(m&&void 0!==m.start){s.syncInfo={mediaSequence:o.mediaSequence+_,time:m.start},this.logger_(`playlist refresh sync: [time:${s.syncInfo.time}, mediaSequence: ${s.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(o){if(this.timelineToDatetimeMappings={},o.segments&&o.segments.length&&o.segments[0].dateTimeObject){const s=o.segments[0],m=s.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[s.timeline]=-m}}saveSegmentTimingInfo({segmentInfo:o,shouldSaveTimelineMapping:s}){const m=this.calculateSegmentTimeMapping_(o,o.timingInfo,s),_=o.segment;m&&(this.saveDiscontinuitySyncInfo_(o),o.playlist.syncInfo||(o.playlist.syncInfo={mediaSequence:o.playlist.mediaSequence+o.mediaIndex,time:_.start}));const S=_.dateTimeObject;_.discontinuity&&s&&S&&(this.timelineToDatetimeMappings[_.timeline]=-S.getTime()/1e3)}timestampOffsetForTimeline(o){return void 0===this.timelines[o]?null:this.timelines[o].time}mappingForTimeline(o){return void 0===this.timelines[o]?null:this.timelines[o].mapping}calculateSegmentTimeMapping_(o,s,m){const _=o.segment,S=o.part;let E,A,O=this.timelines[o.timeline];if("number"==typeof o.timestampOffset)O={time:o.startOfSegment,mapping:o.startOfSegment-s.start},m&&(this.timelines[o.timeline]=O,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${o.timeline}: [time: ${O.time}] [mapping: ${O.mapping}]`)),E=o.startOfSegment,A=s.end+O.mapping;else{if(!O)return!1;E=s.start+O.mapping,A=s.end+O.mapping}return S&&(S.start=E,S.end=A),(!_.start||E<_.start)&&(_.start=E),_.end=A,!0}saveDiscontinuitySyncInfo_(o){const s=o.playlist,m=o.segment;if(m.discontinuity)this.discontinuities[m.timeline]={time:m.start,accuracy:0};else if(s.discontinuityStarts&&s.discontinuityStarts.length)for(let _=0;_<s.discontinuityStarts.length;_++){const S=s.discontinuityStarts[_],E=s.discontinuitySequence+_+1,A=S-o.mediaIndex,O=Math.abs(A);if(!this.discontinuities[E]||this.discontinuities[E].accuracy>O){let _;_=A<0?m.start-sumDurations({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:o.mediaIndex,endIndex:S}):m.end+sumDurations({defaultDuration:s.targetDuration,durationList:s.segments,startIndex:o.mediaIndex+1,endIndex:S}),this.discontinuities[E]={time:_,accuracy:O}}}}dispose(){this.trigger("dispose"),this.off()}}class TimelineChangeController extends videojs.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(o){this.pendingTimelineChanges_[o]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:o,from:s,to:m}){return"number"==typeof s&&"number"==typeof m&&(this.pendingTimelineChanges_[o]={type:o,from:s,to:m},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[o]}lastTimelineChange({type:o,from:s,to:m}){return"number"==typeof s&&"number"==typeof m&&(this.lastTimelineChanges_[o]={type:o,from:s,to:m},delete this.pendingTimelineChanges_[o],this.trigger("timelinechange")),this.lastTimelineChanges_[o]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const O2=transform(getWorkerString((function(){var o=function(){function Stream(){this.listeners={}}var o=Stream.prototype;return o.on=function on(o,s){this.listeners[o]||(this.listeners[o]=[]),this.listeners[o].push(s)},o.off=function off(o,s){if(!this.listeners[o])return!1;var m=this.listeners[o].indexOf(s);return this.listeners[o]=this.listeners[o].slice(0),this.listeners[o].splice(m,1),m>-1},o.trigger=function trigger(o){var s=this.listeners[o];if(s)if(2===arguments.length)for(var m=s.length,_=0;_<m;++_)s[_].call(this,arguments[1]);else for(var S=Array.prototype.slice.call(arguments,1),E=s.length,A=0;A<E;++A)s[A].apply(this,S)},o.dispose=function dispose(){this.listeners={}},o.pipe=function pipe(o){this.on("data",(function(s){o.push(s)}))},Stream}();
/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */let s=null;class AES{constructor(o){let m,_,S;s||(s=function(){const o=[[[],[],[],[],[]],[[],[],[],[],[]]],s=o[0],m=o[1],_=s[4],S=m[4];let E,A,O;const H=[],K=[];let z,G,q,X,J,ae;for(E=0;E<256;E++)K[(H[E]=E<<1^283*(E>>7))^E]=E;for(A=O=0;!_[A];A^=z||1,O=K[O]||1)for(X=O^O<<1^O<<2^O<<3^O<<4,X=X>>8^255&X^99,_[A]=X,S[X]=A,q=H[G=H[z=H[A]]],ae=16843009*q^65537*G^257*z^16843008*A,J=257*H[X]^16843008*X,E=0;E<4;E++)s[E][A]=J=J<<24^J>>>8,m[E][X]=ae=ae<<24^ae>>>8;for(E=0;E<5;E++)s[E]=s[E].slice(0),m[E]=m[E].slice(0);return o}()),this._tables=[[s[0][0].slice(),s[0][1].slice(),s[0][2].slice(),s[0][3].slice(),s[0][4].slice()],[s[1][0].slice(),s[1][1].slice(),s[1][2].slice(),s[1][3].slice(),s[1][4].slice()]];const E=this._tables[0][4],A=this._tables[1],O=o.length;let H=1;if(4!==O&&6!==O&&8!==O)throw new Error("Invalid aes key size");const K=o.slice(0),z=[];for(this._key=[K,z],m=O;m<4*O+28;m++)S=K[m-1],(m%O==0||8===O&&m%O==4)&&(S=E[S>>>24]<<24^E[S>>16&255]<<16^E[S>>8&255]<<8^E[255&S],m%O==0&&(S=S<<8^S>>>24^H<<24,H=H<<1^283*(H>>7))),K[m]=K[m-O]^S;for(_=0;m;_++,m--)S=K[3&_?m:m-4],z[_]=m<=4||_<4?S:A[0][E[S>>>24]]^A[1][E[S>>16&255]]^A[2][E[S>>8&255]]^A[3][E[255&S]]}decrypt(o,s,m,_,S,E){const A=this._key[1];let O,H,K,z=o^A[0],G=_^A[1],q=m^A[2],X=s^A[3];const J=A.length/4-2;let ae,pe=4;const me=this._tables[1],_e=me[0],Se=me[1],Ee=me[2],De=me[3],$e=me[4];for(ae=0;ae<J;ae++)O=_e[z>>>24]^Se[G>>16&255]^Ee[q>>8&255]^De[255&X]^A[pe],H=_e[G>>>24]^Se[q>>16&255]^Ee[X>>8&255]^De[255&z]^A[pe+1],K=_e[q>>>24]^Se[X>>16&255]^Ee[z>>8&255]^De[255&G]^A[pe+2],X=_e[X>>>24]^Se[z>>16&255]^Ee[G>>8&255]^De[255&q]^A[pe+3],pe+=4,z=O,G=H,q=K;for(ae=0;ae<4;ae++)S[(3&-ae)+E]=$e[z>>>24]<<24^$e[G>>16&255]<<16^$e[q>>8&255]<<8^$e[255&X]^A[pe++],O=z,z=G,G=q,q=X,X=O}}class AsyncStream extends o{constructor(){super(o),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(o){this.jobs.push(o),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const ntoh=function(o){return o<<24|(65280&o)<<8|(16711680&o)>>8|o>>>24};class Decrypter{constructor(o,s,m,_){const S=Decrypter.STEP,E=new Int32Array(o.buffer),A=new Uint8Array(o.byteLength);let O=0;for(this.asyncStream_=new AsyncStream,this.asyncStream_.push(this.decryptChunk_(E.subarray(O,O+S),s,m,A)),O=S;O<E.length;O+=S)m=new Uint32Array([ntoh(E[O-4]),ntoh(E[O-3]),ntoh(E[O-2]),ntoh(E[O-1])]),this.asyncStream_.push(this.decryptChunk_(E.subarray(O,O+S),s,m,A));this.asyncStream_.push((function(){_(null,function unpad(o){return o.subarray(0,o.byteLength-o[o.byteLength-1])}
/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */(A))}))}static get STEP(){return 32e3}decryptChunk_(o,s,m,_){return function(){const S=function(o,s,m){const _=new Int32Array(o.buffer,o.byteOffset,o.byteLength>>2),S=new AES(Array.prototype.slice.call(s)),E=new Uint8Array(o.byteLength),A=new Int32Array(E.buffer);let O,H,K,z,G,q,X,J,ae;for(O=m[0],H=m[1],K=m[2],z=m[3],ae=0;ae<_.length;ae+=4)G=ntoh(_[ae]),q=ntoh(_[ae+1]),X=ntoh(_[ae+2]),J=ntoh(_[ae+3]),S.decrypt(G,q,X,J,A,ae),A[ae]=ntoh(A[ae]^O),A[ae+1]=ntoh(A[ae+1]^H),A[ae+2]=ntoh(A[ae+2]^K),A[ae+3]=ntoh(A[ae+3]^z),O=G,H=q,K=X,z=J;return E}(o,s,m);_.set(S,o.byteOffset)}}}var m,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};m="undefined"!=typeof window?window:void 0!==_?_:"undefined"!=typeof self?self:{};var S=m.BigInt||Number;S("0x1"),S("0x100"),S("0x10000"),S("0x1000000"),S("0x100000000"),S("0x10000000000"),S("0x1000000000000"),S("0x100000000000000"),S("0x10000000000000000"),function(){var o=new Uint16Array([65484]),s=new Uint8Array(o.buffer,o.byteOffset,o.byteLength);255===s[0]||s[0]}();const createTransferableMessage=function(o){const s={};return Object.keys(o).forEach((m=>{const _=o[m];!function isArrayBufferView(o){return"function"===ArrayBuffer.isView?ArrayBuffer.isView(o):o&&o.buffer instanceof ArrayBuffer}(_)?s[m]=_:s[m]={bytes:_.buffer,byteOffset:_.byteOffset,byteLength:_.byteLength}})),s};self.onmessage=function(o){const s=o.data,m=new Uint8Array(s.encrypted.bytes,s.encrypted.byteOffset,s.encrypted.byteLength),_=new Uint32Array(s.key.bytes,s.key.byteOffset,s.key.byteLength/4),S=new Uint32Array(s.iv.bytes,s.iv.byteOffset,s.iv.byteLength/4);new Decrypter(m,_,S,(function(o,m){self.postMessage(createTransferableMessage({source:s.source,decrypted:m}),[m.buffer])}))}})));var M2=factory(O2);const audioTrackKind_=o=>{let s=o.default?"main":"alternative";return o.characteristics&&o.characteristics.indexOf("public.accessibility.describes-video")>=0&&(s="main-desc"),s},stopLoaders=(o,s)=>{o.abort(),o.pause(),s&&s.activePlaylistLoader&&(s.activePlaylistLoader.pause(),s.activePlaylistLoader=null)},startLoaders=(o,s)=>{s.activePlaylistLoader=o,o.load()},F2={AUDIO:(o,s)=>()=>{const{mediaTypes:{[o]:m},excludePlaylist:_}=s,S=m.activeTrack(),E=m.activeGroup(),A=(E.filter((o=>o.default))[0]||E[0]).id,O=m.tracks[A];if(S!==O){videojs.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const o in m.tracks)m.tracks[o].enabled=m.tracks[o]===O;m.onTrackChanged()}else _({error:{message:"Problem encountered loading the default audio track."}})},SUBTITLES:(o,s)=>()=>{const{mediaTypes:{[o]:m}}=s;videojs.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const _=m.activeTrack();_&&(_.mode="disabled"),m.onTrackChanged()}},N2={AUDIO:(o,s,m)=>{if(!s)return;const{tech:_,requestOptions:S,segmentLoaders:{[o]:E}}=m;s.on("loadedmetadata",(()=>{const o=s.media();E.playlist(o,S),(!_.paused()||o.endList&&"none"!==_.preload())&&E.load()})),s.on("loadedplaylist",(()=>{E.playlist(s.media(),S),_.paused()||E.load()})),s.on("error",F2[o](o,m))},SUBTITLES:(o,s,m)=>{const{tech:_,requestOptions:S,segmentLoaders:{[o]:E},mediaTypes:{[o]:A}}=m;s.on("loadedmetadata",(()=>{const o=s.media();E.playlist(o,S),E.track(A.activeTrack()),(!_.paused()||o.endList&&"none"!==_.preload())&&E.load()})),s.on("loadedplaylist",(()=>{E.playlist(s.media(),S),_.paused()||E.load()})),s.on("error",F2[o](o,m))}},U2={AUDIO:(o,s)=>{const{vhs:m,sourceType:_,segmentLoaders:{[o]:S},requestOptions:E,main:{mediaGroups:A},mediaTypes:{[o]:{groups:O,tracks:H,logger_:K}},mainPlaylistLoader:z}=s,G=isAudioOnly(z.main);A[o]&&0!==Object.keys(A[o]).length||(A[o]={main:{default:{default:!0}}},G&&(A[o].main.default.playlists=z.main.playlists));for(const S in A[o]){O[S]||(O[S]=[]);for(const q in A[o][S]){let X,J=A[o][S][q];if(G?(K(`AUDIO group '${S}' label '${q}' is a main playlist`),J.isMainPlaylist=!0,X=null):X="vhs-json"===_&&J.playlists?new PlaylistLoader(J.playlists[0],m,E):J.resolvedUri?new PlaylistLoader(J.resolvedUri,m,E):J.playlists&&"dash"===_?new DashPlaylistLoader(J.playlists[0],m,E,z):null,J=merge({id:q,playlistLoader:X},J),N2[o](o,J.playlistLoader,s),O[S].push(J),void 0===H[q]){const o=new videojs.AudioTrack({id:q,kind:audioTrackKind_(J),enabled:!1,language:J.language,default:J.default,label:q});H[q]=o}}}S.on("error",F2[o](o,s))},SUBTITLES:(o,s)=>{const{tech:m,vhs:_,sourceType:S,segmentLoaders:{[o]:E},requestOptions:A,main:{mediaGroups:O},mediaTypes:{[o]:{groups:H,tracks:K}},mainPlaylistLoader:z}=s;for(const E in O[o]){H[E]||(H[E]=[]);for(const G in O[o][E]){if(!_.options_.useForcedSubtitles&&O[o][E][G].forced)continue;let q,X=O[o][E][G];if("hls"===S)q=new PlaylistLoader(X.resolvedUri,_,A);else if("dash"===S){const o=X.playlists.filter((o=>o.excludeUntil!==1/0));if(!o.length)return;q=new DashPlaylistLoader(X.playlists[0],_,A,z)}else"vhs-json"===S&&(q=new PlaylistLoader(X.playlists?X.playlists[0]:X.resolvedUri,_,A));if(X=merge({id:G,playlistLoader:q},X),N2[o](o,X.playlistLoader,s),H[E].push(X),void 0===K[G]){const o=m.addRemoteTextTrack({id:G,kind:"subtitles",default:X.default&&X.autoselect,language:X.language,label:G},!1).track;K[G]=o}}}E.on("error",F2[o](o,s))},"CLOSED-CAPTIONS":(o,s)=>{const{tech:m,main:{mediaGroups:_},mediaTypes:{[o]:{groups:S,tracks:E}}}=s;for(const s in _[o]){S[s]||(S[s]=[]);for(const A in _[o][s]){const O=_[o][s][A];if(!/^(?:CC|SERVICE)/.test(O.instreamId))continue;const H=m.options_.vhs&&m.options_.vhs.captionServices||{};let K={label:A,language:O.language,instreamId:O.instreamId,default:O.default&&O.autoselect};if(H[K.instreamId]&&(K=merge(K,H[K.instreamId])),void 0===K.default&&delete K.default,S[s].push(merge({id:A},O)),void 0===E[A]){const o=m.addRemoteTextTrack({id:K.instreamId,kind:"captions",default:K.default,language:K.language,label:K.label},!1).track;E[A]=o}}}}},groupMatch=(o,s)=>{for(let m=0;m<o.length;m++){if(playlistMatch(s,o[m]))return!0;if(o[m].playlists&&groupMatch(o[m].playlists,s))return!0}return!1},B2={AUDIO:(o,s)=>()=>{const{mediaTypes:{[o]:{tracks:m}}}=s;for(const o in m)if(m[o].enabled)return m[o];return null},SUBTITLES:(o,s)=>()=>{const{mediaTypes:{[o]:{tracks:m}}}=s;for(const o in m)if("showing"===m[o].mode||"hidden"===m[o].mode)return m[o];return null}},setupMediaGroups=o=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((s=>{U2[s](s,o)}));const{mediaTypes:s,mainPlaylistLoader:m,tech:_,vhs:S,segmentLoaders:{AUDIO:E,main:A}}=o;["AUDIO","SUBTITLES"].forEach((m=>{s[m].activeGroup=((o,s)=>m=>{const{mainPlaylistLoader:_,mediaTypes:{[o]:{groups:S}}}=s,E=_.media();if(!E)return null;let A=null;E.attributes[o]&&(A=S[E.attributes[o]]);const O=Object.keys(S);if(!A)if("AUDIO"===o&&O.length>1&&isAudioOnly(s.main))for(let o=0;o<O.length;o++){const s=S[O[o]];if(groupMatch(s,E)){A=s;break}}else S.main?A=S.main:1===O.length&&(A=S[O[0]]);return void 0===m?A:null!==m&&A&&A.filter((o=>o.id===m.id))[0]||null})(m,o),s[m].activeTrack=B2[m](m,o),s[m].onGroupChanged=((o,s)=>()=>{const{segmentLoaders:{[o]:m,main:_},mediaTypes:{[o]:S}}=s,E=S.activeTrack(),A=S.getActiveGroup(),O=S.activePlaylistLoader,H=S.lastGroup_;A&&H&&A.id===H.id||(S.lastGroup_=A,S.lastTrack_=E,stopLoaders(m,S),A&&!A.isMainPlaylist&&(A.playlistLoader?(m.resyncLoader(),startLoaders(A.playlistLoader,S)):O&&_.resetEverything()))})(m,o),s[m].onGroupChanging=((o,s)=>()=>{const{segmentLoaders:{[o]:m},mediaTypes:{[o]:_}}=s;_.lastGroup_=null,m.abort(),m.pause()})(m,o),s[m].onTrackChanged=((o,s)=>()=>{const{mainPlaylistLoader:m,segmentLoaders:{[o]:_,main:S},mediaTypes:{[o]:E}}=s,A=E.activeTrack(),O=E.getActiveGroup(),H=E.activePlaylistLoader,K=E.lastTrack_;if((!K||!A||K.id!==A.id)&&(E.lastGroup_=O,E.lastTrack_=A,stopLoaders(_,E),O)){if(O.isMainPlaylist){if(!A||!K||A.id===K.id)return;const o=s.vhs.playlistController_,_=o.selectPlaylist();if(o.media()===_)return;return E.logger_(`track change. Switching main audio from ${K.id} to ${A.id}`),m.pause(),S.resetEverything(),void o.fastQualityChange_(_)}if("AUDIO"===o){if(!O.playlistLoader)return S.setAudio(!0),void S.resetEverything();_.setAudio(!0),S.setAudio(!1)}H!==O.playlistLoader?(_.track&&_.track(A),_.resetEverything(),startLoaders(O.playlistLoader,E)):startLoaders(O.playlistLoader,E)}})(m,o),s[m].getActiveGroup=((o,{mediaTypes:s})=>()=>{const m=s[o].activeTrack();return m?s[o].activeGroup(m):null})(m,o)}));const O=s.AUDIO.activeGroup();if(O){const o=(O.filter((o=>o.default))[0]||O[0]).id;s.AUDIO.tracks[o].enabled=!0,s.AUDIO.onGroupChanged(),s.AUDIO.onTrackChanged();s.AUDIO.getActiveGroup().playlistLoader?(A.setAudio(!1),E.setAudio(!0)):A.setAudio(!0)}m.on("mediachange",(()=>{["AUDIO","SUBTITLES"].forEach((o=>s[o].onGroupChanged()))})),m.on("mediachanging",(()=>{["AUDIO","SUBTITLES"].forEach((o=>s[o].onGroupChanging()))}));const onAudioTrackChanged=()=>{s.AUDIO.onTrackChanged(),_.trigger({type:"usage",name:"vhs-audio-change"})};_.audioTracks().addEventListener("change",onAudioTrackChanged),_.remoteTextTracks().addEventListener("change",s.SUBTITLES.onTrackChanged),S.on("dispose",(()=>{_.audioTracks().removeEventListener("change",onAudioTrackChanged),_.remoteTextTracks().removeEventListener("change",s.SUBTITLES.onTrackChanged)})),_.clearTracks("audio");for(const o in s.AUDIO.tracks)_.audioTracks().addTrack(s.AUDIO.tracks[o])};class SteeringManifest{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(o){1===o&&(this.version_=o)}set ttl(o){this.ttl_=o||300}set reloadUri(o){o&&(this.reloadUri_=d2(this.reloadUri_,o))}set priority(o){o&&o.length&&(this.priority_=o)}set pathwayClones(o){o&&o.length&&(this.pathwayClones_=new Map(o.map((o=>[o.ID,o]))))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class ContentSteeringController extends videojs.EventTarget{constructor(o,s){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new SteeringManifest,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=logger("Content Steering"),this.xhr_=o,this.getBandwidth_=s}assignTagProperties(o,s){this.manifestType_=s.serverUri?"HLS":"DASH";const m=s.serverUri||s.serverURL;if(!m)return this.logger_(`steering manifest URL is ${m}, cannot request steering manifest.`),void this.trigger("error");m.startsWith("data:")?this.decodeDataUriManifest_(m.substring(m.indexOf(",")+1)):(this.steeringManifest.reloadUri=d2(o,m),this.defaultPathway=s.pathwayId||s.defaultServiceLocation,this.queryBeforeStart=s.queryBeforeStart,this.proxyServerUrl_=s.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering"))}requestSteeringManifest(o){const s=this.steeringManifest.reloadUri;if(!s)return;const m=o?s:this.getRequestURI(s);if(!m)return this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),void this.dispose();this.request_=this.xhr_({uri:m},((o,s)=>{if(o){if(410===s.status)return this.logger_(`manifest request 410 ${o}.`),this.logger_(`There will be no more content steering requests to ${m} this session.`),void this.excludedSteeringManifestURLs.add(m);if(429===s.status){const m=s.responseHeaders["retry-after"];return this.logger_(`manifest request 429 ${o}.`),this.logger_(`content steering will retry in ${m} seconds.`),void this.startTTLTimeout_(parseInt(m,10))}return this.logger_(`manifest failed to load ${o}.`),void this.startTTLTimeout_()}const _=JSON.parse(this.request_.responseText);this.assignSteeringProperties_(_),this.startTTLTimeout_()}))}setProxyServerUrl_(o){const s=new $V.URL(o),m=new $V.URL(this.proxyServerUrl_);return m.searchParams.set("url",encodeURI(s.toString())),this.setSteeringParams_(m.toString())}decodeDataUriManifest_(o){const s=JSON.parse($V.atob(o));this.assignSteeringProperties_(s)}setSteeringParams_(o){const s=new $V.URL(o),m=this.getPathway(),_=this.getBandwidth_();if(m){const o=`_${this.manifestType_}_pathway`;s.searchParams.set(o,m)}if(_){const o=`_${this.manifestType_}_throughput`;s.searchParams.set(o,_)}return s.toString()}assignSteeringProperties_(o){if(this.steeringManifest.version=o.VERSION,!this.steeringManifest.version)return this.logger_(`manifest version is ${o.VERSION}, which is not supported.`),void this.trigger("error");this.steeringManifest.ttl=o.TTL,this.steeringManifest.reloadUri=o["RELOAD-URI"],this.steeringManifest.priority=o["PATHWAY-PRIORITY"]||o["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=o["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const s=(o=>{for(const s of o)if(this.availablePathways_.has(s))return s;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==s&&(this.currentPathway=s,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(o){if(!o)return null;const isExcluded=o=>this.excludedSteeringManifestURLs.has(o);if(this.proxyServerUrl_){const s=this.setProxyServerUrl_(o);if(!isExcluded(s))return s}const s=this.setSteeringParams_(o);return isExcluded(s)?null:s}startTTLTimeout_(o=this.steeringManifest.ttl){const s=1e3*o;this.ttlTimeout_=$V.setTimeout((()=>{this.requestSteeringManifest()}),s)}clearTTLTimeout_(){$V.clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new SteeringManifest}addAvailablePathway(o){o&&this.availablePathways_.add(o)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(o){return this.availablePathways_.delete(o)}didDASHTagChange(o,s){return!s&&this.steeringManifest.reloadUri||s&&(d2(o,s.serverURL)!==this.steeringManifest.reloadUri||s.defaultServiceLocation!==this.defaultPathway||s.queryBeforeStart!==this.queryBeforeStart||s.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}let j2;const $2=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],sumLoaderStat=function(o){return this.audioSegmentLoader_[o]+this.mainSegmentLoader_[o]};class PlaylistController extends videojs.EventTarget{constructor(o){super();const{src:s,withCredentials:m,tech:_,bandwidth:S,externVhs:E,useCueTags:A,playlistExclusionDuration:O,enableLowInitialPlaylist:H,sourceType:K,cacheEncryptionKeys:z,bufferBasedABR:G,leastPixelDiffSelector:q,captionServices:X}=o;if(!s)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:J}=o;null==J&&(J=1/0),j2=E,this.bufferBasedABR=Boolean(G),this.leastPixelDiffSelector=Boolean(q),this.withCredentials=m,this.tech_=_,this.vhs_=_.vhs,this.sourceType_=K,this.useCueTags_=A,this.playlistExclusionDuration=O,this.maxPlaylistRetries=J,this.enableLowInitialPlaylist=H,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:m,maxPlaylistRetries:J,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=(()=>{const o={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((s=>{o[s]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:noop,activeTrack:noop,getActiveGroup:noop,onGroupChanged:noop,onTrackChanged:noop,lastTrack_:null,logger_:logger(`MediaGroups[${s}]`)}})),o})(),this.mediaSource=new $V.MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=createTimeRanges(),this.hasPlayed_=!1,this.syncController_=new SyncController(o),this.segmentMetadataTrack_=_.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new M2,this.sourceUpdater_=new SourceUpdater(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new TimelineChangeController,this.keyStatusMap_=new Map;const ae={vhs:this.vhs_,parse708captions:o.parse708captions,useDtsForTimestampOffset:o.useDtsForTimestampOffset,captionServices:X,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:S,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:z,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:o.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_="dash"===this.sourceType_?new DashPlaylistLoader(s,this.vhs_,merge(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new PlaylistLoader(s,this.vhs_,merge(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new SegmentLoader(merge(ae,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),o),this.audioSegmentLoader_=new SegmentLoader(merge(ae,{loaderType:"audio"}),o),this.subtitleSegmentLoader_=new VTTSegmentLoader(merge(ae,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise(((o,s)=>{function onLoad(){_.off("vttjserror",onError),o()}function onError(){_.off("vttjsloaded",onLoad),s()}_.one("vttjsloaded",onLoad),_.one("vttjserror",onError),_.addWebVttScript_()}))}),o);this.contentSteeringController_=new ContentSteeringController(this.vhs_.xhr,(()=>this.mainSegmentLoader_.bandwidth)),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",(()=>this.startABRTimer_())),this.tech_.on("pause",(()=>this.stopABRTimer_())),this.tech_.on("play",(()=>this.startABRTimer_()))),$2.forEach((o=>{this[o+"_"]=sumLoaderStat.bind(this,o)})),this.logger_=logger("pc"),this.triggeredFmp4Usage=!1,"none"===this.tech_.preload()?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const pe="none"===this.tech_.preload()?"play":"loadstart";this.tech_.one(pe,(()=>{const o=Date.now();this.tech_.one("loadeddata",(()=>{this.timeToLoadedData__=Date.now()-o,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends}))}))}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const o=this.mainAppendsToLoadedData_(),s=this.audioAppendsToLoadedData_();return-1===o||-1===s?-1:o+s}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(o="abr"){const s=this.selectPlaylist();s&&this.shouldSwitchToMedia_(s)&&this.switchMedia_(s,o)}switchMedia_(o,s,m){const _=this.media(),S=_&&(_.id||_.uri),E=o&&(o.id||o.uri);S&&S!==E&&(this.logger_(`switch media ${S} -> ${E} from ${s}`),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${s}`})),this.mainPlaylistLoader_.media(o,m)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((o=>{const s=this.mediaTypes_[o],m=s?s.activeGroup():null,_=this.contentSteeringController_.getPathway();if(m&&_){const s=(m.length?m[0].playlists:m.playlists).filter((o=>o.attributes.serviceLocation===_));s.length&&this.mediaTypes_[o].activePlaylistLoader.media(s[0])}}))}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=$V.setInterval((()=>this.checkABR_()),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||($V.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const o=this.main(),s=o&&o.playlists||[];if(!o||!o.mediaGroups||!o.mediaGroups.AUDIO)return s;const m=o.mediaGroups.AUDIO,_=Object.keys(m);let S;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)S=this.mediaTypes_.AUDIO.activeTrack();else{const o=m.main||_.length&&m[_[0]];for(const s in o)if(o[s].default){S={label:s};break}}if(!S)return s;const E=[];for(const s in m)if(m[s][S.label]){const _=m[s][S.label];if(_.playlists&&_.playlists.length)E.push.apply(E,_.playlists);else if(_.uri)E.push(_);else if(o.playlists.length)for(let m=0;m<o.playlists.length;m++){const _=o.playlists[m];_.attributes&&_.attributes.AUDIO&&_.attributes.AUDIO===s&&E.push(_)}}return E.length?E:s}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",(()=>{const o=this.mainPlaylistLoader_.media(),s=1.5*o.targetDuration*1e3;isLowestEnabledRendition(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=s,o.endList&&"none"!==this.tech_.preload()&&(this.mainSegmentLoader_.playlist(o,this.requestOptions_),this.mainSegmentLoader_.load()),setupMediaGroups({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),o),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(()=>{this.trigger("selectedinitialmedia")}))})),this.mainPlaylistLoader_.on("loadedplaylist",(()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let o=this.mainPlaylistLoader_.media();if(!o){let s;if(this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_(),this.enableLowInitialPlaylist&&(s=this.selectInitialPlaylist()),s||(s=this.selectPlaylist()),!s||!this.shouldSwitchToMedia_(s))return;this.initialMedia_=s,this.switchMedia_(this.initialMedia_,"initial");if(!("vhs-json"===this.sourceType_&&this.initialMedia_.segments))return;o=this.initialMedia_}this.handleUpdatedMediaPlaylist(o)})),this.mainPlaylistLoader_.on("error",(()=>{const o=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:o.playlist,error:o})})),this.mainPlaylistLoader_.on("mediachanging",(()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()})),this.mainPlaylistLoader_.on("mediachange",(()=>{const o=this.mainPlaylistLoader_.media(),s=1.5*o.targetDuration*1e3;isLowestEnabledRendition(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=s,"dash"===this.sourceType_&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(o,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})})),this.mainPlaylistLoader_.on("playlistunchanged",(()=>{const o=this.mainPlaylistLoader_.media();if("playlist-unchanged"===o.lastExcludeReason_)return;this.stuckAtPlaylistEnd_(o)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))})),this.mainPlaylistLoader_.on("renditiondisabled",(()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})})),this.mainPlaylistLoader_.on("renditionenabled",(()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}))}handleUpdatedMediaPlaylist(o){this.useCueTags_&&this.updateAdCues_(o),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(o,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!o.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(o,s){const m=o.mediaGroups||{};let _=!0;const S=Object.keys(m.AUDIO);for(const o in m.AUDIO)for(const s in m.AUDIO[o]){m.AUDIO[o][s].uri||(_=!1)}_&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(m.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),j2.Playlist.isAes(s)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),S.length&&Object.keys(m.AUDIO[S[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(o){const s=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,m=this.tech_.currentTime(),_=this.bufferLowWaterLine(),S=this.bufferHighWaterLine();return function({currentPlaylist:o,buffered:s,currentTime:m,nextPlaylist:_,bufferLowWaterLine:S,bufferHighWaterLine:E,duration:A,bufferBasedABR:O,log:H}){if(!_)return videojs.log.warn("We received no playlist to switch to. Please check your stream."),!1;const K=`allowing switch ${o&&o.id||"null"} -> ${_.id}`;if(!o)return H(`${K} as current playlist is not set`),!0;if(_.id===o.id)return!1;const z=Boolean(findRange(s,m).length);if(!o.endList)return z||"number"!=typeof o.partTargetDuration?(H(`${K} as current playlist is live`),!0):(H(`not ${K} as current playlist is live llhls, but currentTime isn't in buffered.`),!1);const G=timeAheadOf(s,m),q=O?b2.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:b2.MAX_BUFFER_LOW_WATER_LINE;if(A<q)return H(`${K} as duration < max low water line (${A} < ${q})`),!0;const X=_.attributes.BANDWIDTH,J=o.attributes.BANDWIDTH;if(X<J&&(!O||G<E)){let o=`${K} as next bandwidth < current bandwidth (${X} < ${J})`;return O&&(o+=` and forwardBuffer < bufferHighWaterLine (${G} < ${E})`),H(o),!0}if((!O||X>J)&&G>=S){let o=`${K} as forwardBuffer >= bufferLowWaterLine (${G} >= ${S})`;return O&&(o+=` and next bandwidth > current bandwidth (${X} > ${J})`),H(o),!0}return H(`not ${K} as no switching criteria met`),!1}({buffered:this.tech_.buffered(),currentTime:m,currentPlaylist:s,nextPlaylist:o,bufferLowWaterLine:_,bufferHighWaterLine:S,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",(()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("timeout",(()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()})),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",(()=>{this.trigger("progress")})),this.mainSegmentLoader_.on("error",(()=>{const o=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:o.playlist,error:o})})),this.mainSegmentLoader_.on("appenderror",(()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")})),this.mainSegmentLoader_.on("syncinfoupdate",(()=>{this.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(()=>{this.onSyncInfoUpdate_()})),this.audioSegmentLoader_.on("appenderror",(()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")})),this.mainSegmentLoader_.on("ended",(()=>{this.logger_("main segment loader ended"),this.onEndOfStream()})),this.mainSegmentLoader_.on("earlyabort",(o=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:10}))}));const updateCodecs=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const o=this.getCodecsOrExclude_();o&&this.sourceUpdater_.addOrChangeSourceBuffers(o)};this.mainSegmentLoader_.on("trackinfo",updateCodecs),this.audioSegmentLoader_.on("trackinfo",updateCodecs),this.mainSegmentLoader_.on("fmp4",(()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("fmp4",(()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)})),this.audioSegmentLoader_.on("ended",(()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}))}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(o=this.selectPlaylist()){o&&o===this.mainPlaylistLoader_.media()?this.logger_("skipping fastQualityChange because new media is same as old"):(this.switchMedia_(o,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0)}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything((()=>{this.tech_.setCurrentTime(this.tech_.currentTime())}))}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const o=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<o.start(0)?this.tech_.setCurrentTime(o.end(o.length-1)):void 0}setupFirstPlay(){const o=this.mainPlaylistLoader_.media();if(!o||this.tech_.paused()||this.hasPlayed_)return!1;if(!o.endList||o.start){const s=this.seekable();if(!s.length)return!1;const m=s.end(0);let _=m;if(o.start){const S=o.start.timeOffset;_=S<0?Math.max(m+S,s.start(0)):Math.min(m,S)}this.trigger("firstplay"),this.tech_.setCurrentTime(_)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const o=this.tech_.play();void 0!==o&&"function"==typeof o.then&&o.then(null,(o=>{}))}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const o=this.inbandTextTracks_.metadataTrack_.cues;if(!o||!o.length)return;const s=this.duration();o[o.length-1].endTime=isNaN(s)||Math.abs(s)===1/0?Number.MAX_VALUE:s}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let o=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const s=this.mainSegmentLoader_.getCurrentMediaInfo_();o=!s||s.hasVideo?o&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_}o&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(o){if(!this.seekable().length)return!1;const s=this.syncController_.getExpiredTime(o,this.duration());if(null===s)return!1;const m=j2.Playlist.playlistEnd(o,s),_=this.tech_.currentTime(),S=this.tech_.buffered();if(!S.length)return m-_<=p2;const E=S.end(S.length-1);return E-_<=p2&&m-E<=p2}excludePlaylist({playlistToExclude:o=this.mainPlaylistLoader_.media(),error:s={},playlistExclusionDuration:m}){if(o=o||this.mainPlaylistLoader_.media(),m=m||s.playlistExclusionDuration||this.playlistExclusionDuration,!o)return this.error=s,void("open"!==this.mediaSource.readyState?this.trigger("error"):this.sourceUpdater_.endOfStream("network"));o.playlistErrors_++;const _=this.mainPlaylistLoader_.main.playlists,S=_.filter(isEnabled),E=1===S.length&&S[0]===o;if(1===_.length&&m!==1/0)return videojs.log.warn(`Problem encountered with playlist ${o.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(E);if(E){if(this.main().contentSteering){const s=this.pathwayAttribute_(o),m=1e3*this.contentSteeringController_.steeringManifest.ttl;return this.contentSteeringController_.excludePathway(s),this.excludeThenChangePathway_(),void setTimeout((()=>{this.contentSteeringController_.addAvailablePathway(s)}),m)}let s=!1;_.forEach((m=>{if(m===o)return;const _=m.excludeUntil;void 0!==_&&_!==1/0&&(s=!0,delete m.excludeUntil)})),s&&(videojs.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let A;A=o.playlistErrors_>this.maxPlaylistRetries?1/0:Date.now()+1e3*m,o.excludeUntil=A,s.reason&&(o.lastExcludeReason_=s.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const O=this.selectPlaylist();if(!O)return this.error="Playback cannot continue. No available working or supported playlists.",void this.trigger("error");const H=s.internal?this.logger_:videojs.log.warn,K=s.message?" "+s.message:"";H(`${s.internal?"Internal problem":"Problem"} encountered with playlist ${o.id}.${K} Switching to playlist ${O.id}.`),O.attributes.AUDIO!==o.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),O.attributes.SUBTITLES!==o.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const z=O.targetDuration/2*1e3||5e3,G="number"==typeof O.lastRequest&&Date.now()-O.lastRequest<=z;return this.switchMedia_(O,"exclude",E||G)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(o,s){const m=[],_="all"===o;(_||"main"===o)&&m.push(this.mainPlaylistLoader_);const S=[];(_||"audio"===o)&&S.push("AUDIO"),(_||"subtitle"===o)&&(S.push("CLOSED-CAPTIONS"),S.push("SUBTITLES")),S.forEach((o=>{const s=this.mediaTypes_[o]&&this.mediaTypes_[o].activePlaylistLoader;s&&m.push(s)})),["main","audio","subtitle"].forEach((s=>{const _=this[`${s}SegmentLoader_`];!_||o!==s&&"all"!==o||m.push(_)})),m.forEach((o=>s.forEach((s=>{"function"==typeof o[s]&&o[s]()}))))}setCurrentTime(o){const s=findRange(this.tech_.buffered(),o);return this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media()&&this.mainPlaylistLoader_.media().segments?s&&s.length?o:(this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),void this.load()):0}duration(){if(!this.mainPlaylistLoader_)return 0;const o=this.mainPlaylistLoader_.media();return o?o.endList?this.mediaSource?this.mediaSource.duration:j2.Playlist.duration(o):1/0:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let o;if(!this.mainPlaylistLoader_)return;let s=this.mainPlaylistLoader_.media();if(!s)return;let m=this.syncController_.getExpiredTime(s,this.duration());if(null===m)return;const _=this.mainPlaylistLoader_.main,S=j2.Playlist.seekable(s,m,j2.Playlist.liveEdgeDelay(_,s));if(0===S.length)return;if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(s=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),m=this.syncController_.getExpiredTime(s,this.duration()),null===m)return;if(o=j2.Playlist.seekable(s,m,j2.Playlist.liveEdgeDelay(_,s)),0===o.length)return}let E,A;this.seekable_&&this.seekable_.length&&(E=this.seekable_.end(0),A=this.seekable_.start(0)),o?o.start(0)>S.end(0)||S.start(0)>o.end(0)?this.seekable_=S:this.seekable_=createTimeRanges([[o.start(0)>S.start(0)?o.start(0):S.start(0),o.end(0)<S.end(0)?o.end(0):S.end(0)]]):this.seekable_=S,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===E&&this.seekable_.start(0)===A||(this.logger_(`seekable updated [${printableRange(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}updateDuration(o){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),"open"!==this.mediaSource.readyState)return this.updateDuration_=this.updateDuration.bind(this,o),void this.mediaSource.addEventListener("sourceopen",this.updateDuration_);if(o){const o=this.seekable();if(!o.length)return;return void((isNaN(this.mediaSource.duration)||this.mediaSource.duration<o.end(o.length-1))&&this.sourceUpdater_.setDuration(o.end(o.length-1)))}const s=this.tech_.buffered();let m=j2.Playlist.duration(this.mainPlaylistLoader_.media());s.length>0&&(m=Math.max(m,s.end(s.length-1))),this.mediaSource.duration!==m&&this.sourceUpdater_.setDuration(m)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach((o=>{const s=this.mediaTypes_[o].groups;for(const o in s)s[o].forEach((o=>{o.playlistLoader&&o.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const o=!!this.mediaTypes_.AUDIO.activePlaylistLoader,s=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),m=!o||!!this.audioSegmentLoader_.getCurrentMediaInfo_();return!(!s||!m)}getCodecsOrExclude_(){const o={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},s=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();o.video=o.main;const m=codecsForPlaylist(this.main(),s),_={},S=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(o.main.hasVideo&&(_.video=m.video||o.main.videoCodec||_K),o.main.isMuxed&&(_.video+=`,${m.audio||o.main.audioCodec||vK}`),(o.main.hasAudio&&!o.main.isMuxed||o.audio.hasAudio||S)&&(_.audio=m.audio||o.main.audioCodec||o.audio.audioCodec||vK,o.audio.isFmp4=o.main.hasAudio&&!o.main.isMuxed?o.main.isFmp4:o.audio.isFmp4),!_.audio&&!_.video)return void this.excludePlaylist({playlistToExclude:s,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});const E={};let A;if(["video","audio"].forEach((function(s){if(_.hasOwnProperty(s)&&(m=o[s].isFmp4,S=_[s],!(m?mK(S):yK(S)))){const m=o[s].isFmp4?"browser":"muxer";E[m]=E[m]||[],E[m].push(_[s]),"audio"===s&&(A=m)}var m,S})),S&&A&&s.attributes.AUDIO){const o=s.attributes.AUDIO;this.main().playlists.forEach((m=>{(m.attributes&&m.attributes.AUDIO)===o&&m!==s&&(m.excludeUntil=1/0)})),this.logger_(`excluding audio group ${o} as ${A} does not support codec(s): "${_.audio}"`)}if(!Object.keys(E).length){if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const o=[];if(["video","audio"].forEach((s=>{const m=(hK(this.sourceUpdater_.codecs[s]||"")[0]||{}).type,S=(hK(_[s]||"")[0]||{}).type;m&&S&&m.toLowerCase()!==S.toLowerCase()&&o.push(`"${this.sourceUpdater_.codecs[s]}" -> "${_[s]}"`)})),o.length)return void this.excludePlaylist({playlistToExclude:s,error:{message:`Codec switching not supported: ${o.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0})}return _}{const o=Object.keys(E).reduce(((o,s)=>(o&&(o+=", "),o+=`${s} does not support codec(s): "${E[s].join(",")}"`)),"")+".";this.excludePlaylist({playlistToExclude:s,error:{internal:!0,message:o},playlistExclusionDuration:1/0})}}tryToCreateSourceBuffers_(){if("open"!==this.mediaSource.readyState||this.sourceUpdater_.hasCreatedSourceBuffers())return;if(!this.areMediaTypesKnown_())return;const o=this.getCodecsOrExclude_();if(!o)return;this.sourceUpdater_.createSourceBuffers(o);const s=[o.video,o.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(s)}excludeUnsupportedVariants_(){const o=this.main().playlists,s=[];Object.keys(o).forEach((m=>{const _=o[m];if(-1!==s.indexOf(_.id))return;s.push(_.id);const S=codecsForPlaylist(this.main,_),E=[];!S.audio||yK(S.audio)||mK(S.audio)||E.push(`audio codec ${S.audio}`),!S.video||yK(S.video)||mK(S.video)||E.push(`video codec ${S.video}`),S.text&&"stpp.ttml.im1t"===S.text&&E.push(`text codec ${S.text}`),E.length&&(_.excludeUntil=1/0,this.logger_(`excluding ${_.id} for unsupported: ${E.join(", ")}`))}))}excludeIncompatibleVariants_(o){const s=[],m=this.main().playlists,_=unwrapCodecList(hK(o)),S=codecCount(_),E=_.video&&hK(_.video)[0]||null,A=_.audio&&hK(_.audio)[0]||null;Object.keys(m).forEach((o=>{const _=m[o];if(-1!==s.indexOf(_.id)||_.excludeUntil===1/0)return;s.push(_.id);const O=[],H=codecsForPlaylist(this.mainPlaylistLoader_.main,_),K=codecCount(H);if(H.audio||H.video){if(K!==S&&O.push(`codec count "${K}" !== "${S}"`),!this.sourceUpdater_.canChangeType()){const o=H.video&&hK(H.video)[0]||null,s=H.audio&&hK(H.audio)[0]||null;o&&E&&o.type.toLowerCase()!==E.type.toLowerCase()&&O.push(`video codec "${o.type}" !== "${E.type}"`),s&&A&&s.type.toLowerCase()!==A.type.toLowerCase()&&O.push(`audio codec "${s.type}" !== "${A.type}"`)}O.length&&(_.excludeUntil=1/0,this.logger_(`excluding ${_.id}: ${O.join(" && ")}`))}}))}updateAdCues_(o){let s=0;const m=this.seekable();m.length&&(s=m.start(0)),function(o,s,m=0){if(!o.segments)return;let _,S=m;for(let m=0;m<o.segments.length;m++){const E=o.segments[m];if(_||(_=findAdCue(s,S+E.duration/2)),_){if("cueIn"in E){_.endTime=S,_.adEndTime=S,S+=E.duration,_=null;continue}if(S<_.endTime){S+=E.duration;continue}_.endTime+=E.duration}else if("cueOut"in E&&(_=new $V.VTTCue(S,S+E.duration,E.cueOut),_.adStartTime=S,_.adEndTime=S+parseFloat(E.cueOut),s.addCue(_)),"cueOutCont"in E){const[o,m]=E.cueOutCont.split("/").map(parseFloat);_=new $V.VTTCue(S,S+E.duration,""),_.adStartTime=S-o,_.adEndTime=_.adStartTime+m,s.addCue(_)}S+=E.duration}}(o,this.cueTagsTrack_,s)}goalBufferLength(){const o=this.tech_.currentTime(),s=b2.GOAL_BUFFER_LENGTH,m=b2.GOAL_BUFFER_LENGTH_RATE,_=Math.max(s,b2.MAX_GOAL_BUFFER_LENGTH);return Math.min(s+o*m,_)}bufferLowWaterLine(){const o=this.tech_.currentTime(),s=b2.BUFFER_LOW_WATER_LINE,m=b2.BUFFER_LOW_WATER_LINE_RATE,_=Math.max(s,b2.MAX_BUFFER_LOW_WATER_LINE),S=Math.max(s,b2.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(s+o*m,this.bufferBasedABR?S:_)}bufferHighWaterLine(){return b2.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(o){createMetadataTrackIfNotExists(this.inbandTextTracks_,"com.apple.streaming",this.tech_),(({inbandTextTracks:o,dateRanges:s})=>{const m=o.metadataTrack_;if(!m)return;const _=$V.WebKitDataCue||$V.VTTCue;s.forEach((o=>{for(const s of Object.keys(o)){if(A2.has(s))continue;const S=new _(o.startTime,o.endTime,"");S.id=o.id,S.type="com.apple.quicktime.HLS",S.value={key:I2[s],data:o[s]},"scte35Out"!==s&&"scte35In"!==s||(S.value.data=new Uint8Array(S.value.data.match(/[\da-f]{2}/gi)).buffer),m.addCue(S)}o.processDateRange()}))})({inbandTextTracks:this.inbandTextTracks_,dateRanges:o})}addMetadataToTextTrack(o,s,m){const _=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();createMetadataTrackIfNotExists(this.inbandTextTracks_,o,this.tech_),addMetadata({inbandTextTracks:this.inbandTextTracks_,metadataArray:s,timestampOffset:_,videoDuration:m})}pathwayAttribute_(o){return o.attributes["PATHWAY-ID"]||o.attributes.serviceLocation}initContentSteeringController_(){const o=this.main();if(o.contentSteering){for(const s of o.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(s));this.contentSteeringController_.assignTagProperties(o.uri,o.contentSteering),this.contentSteeringController_.queryBeforeStart?this.contentSteeringController_.requestSteeringManifest(!0):this.tech_.one("canplay",(()=>{this.contentSteeringController_.requestSteeringManifest()}))}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),"dash"===this.sourceType_&&this.mainPlaylistLoader_.on("loadedplaylist",(()=>{const o=this.main();(this.contentSteeringController_.didDASHTagChange(o.uri,o.contentSteering)||(()=>{const s=this.contentSteeringController_.getAvailablePathways(),m=[];for(const _ of o.playlists){const o=_.attributes.serviceLocation;if(o&&(m.push(o),!s.has(o)))return!0}return!(m.length||!s.size)})())&&this.resetContentSteeringController_()}))}excludeThenChangePathway_(){const o=this.contentSteeringController_.getPathway();if(!o)return;this.handlePathwayClones_();const s=this.main().playlists,m=new Set;let _=!1;Object.keys(s).forEach((S=>{const E=s[S],A=this.pathwayAttribute_(E),O=A&&o!==A;E.excludeUntil===1/0&&"content-steering"===E.lastExcludeReason_&&!O&&(delete E.excludeUntil,delete E.lastExcludeReason_,_=!0);const H=!E.excludeUntil&&E.excludeUntil!==1/0;!m.has(E.id)&&O&&H&&(m.add(E.id),E.excludeUntil=1/0,E.lastExcludeReason_="content-steering",this.logger_(`excluding ${E.id} for ${E.lastExcludeReason_}`))})),"DASH"===this.contentSteeringController_.manifestType_&&Object.keys(this.mediaTypes_).forEach((s=>{const m=this.mediaTypes_[s];if(m.activePlaylistLoader){const s=m.activePlaylistLoader.media_;s&&s.attributes.serviceLocation!==o&&(_=!0)}})),_&&this.changeSegmentPathway_()}handlePathwayClones_(){const o=this.main().playlists,s=this.contentSteeringController_.currentPathwayClones,m=this.contentSteeringController_.nextPathwayClones;if(s&&s.size||m&&m.size){for(const[o,_]of s.entries()){m.get(o)||(this.mainPlaylistLoader_.updateOrDeleteClone(_),this.contentSteeringController_.excludePathway(o))}for(const[_,S]of m.entries()){const m=s.get(_);if(m)this.equalPathwayClones_(m,S)||(this.mainPlaylistLoader_.updateOrDeleteClone(S,!0),this.contentSteeringController_.addAvailablePathway(_));else{const s=o.filter((o=>o.attributes["PATHWAY-ID"]===S["BASE-ID"]));s.forEach((o=>{this.mainPlaylistLoader_.addClonePathway(S,o)})),this.contentSteeringController_.addAvailablePathway(_)}}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...m])))}}equalPathwayClones_(o,s){if(o["BASE-ID"]!==s["BASE-ID"]||o.ID!==s.ID||o["URI-REPLACEMENT"].HOST!==s["URI-REPLACEMENT"].HOST)return!1;const m=o["URI-REPLACEMENT"].PARAMS,_=s["URI-REPLACEMENT"].PARAMS;for(const o in m)if(m[o]!==_[o])return!1;for(const o in _)if(m[o]!==_[o])return!1;return!0}changeSegmentPathway_(){const o=this.selectPlaylist();this.pauseLoading(),"DASH"===this.contentSteeringController_.manifestType_&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(o,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let o=0;const s="non-usable";this.mainPlaylistLoader_.main.playlists.forEach((m=>{const _=this.mainPlaylistLoader_.getKeyIdSet(m);_&&_.size&&_.forEach((_=>{const S="usable",E=this.keyStatusMap_.has(_)&&this.keyStatusMap_.get(_)===S,A=m.lastExcludeReason_===s&&m.excludeUntil===1/0;E?E&&A&&(delete m.excludeUntil,delete m.lastExcludeReason_,this.logger_(`enabling playlist ${m.id} because key ID ${_} is ${S}`)):(m.excludeUntil!==1/0&&m.lastExcludeReason_!==s&&(m.excludeUntil=1/0,m.lastExcludeReason_=s,this.logger_(`excluding playlist ${m.id} because the key ID ${_} doesn't exist in the keyStatusMap or is not ${S}`)),o++)}))})),o>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach((o=>{const m=o&&o.attributes&&o.attributes.RESOLUTION&&o.attributes.RESOLUTION.height<720,_=o.excludeUntil===1/0&&o.lastExcludeReason_===s;m&&_&&(delete o.excludeUntil,videojs.log.warn(`enabling non-HD playlist ${o.id} because all playlists were excluded due to ${s} key IDs`))}))}addKeyStatus_(o,s){const m=("string"==typeof o?o:(o=>{const s=new Uint8Array(o);return Array.from(s).map((o=>o.toString(16).padStart(2,"0"))).join("")})(o)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${s}' with key ID ${m} added to the keyStatusMap`),this.keyStatusMap_.set(m,s)}updatePlaylistByKeyStatus(o,s){this.addKeyStatus_(o,s),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}class Representation{constructor(o,s,m){const{playlistController_:_}=o,S=_.fastQualityChange_.bind(_);if(s.attributes){const o=s.attributes.RESOLUTION;this.width=o&&o.width,this.height=o&&o.height,this.bandwidth=s.attributes.BANDWIDTH,this.frameRate=s.attributes["FRAME-RATE"]}this.codecs=codecsForPlaylist(_.main(),s),this.playlist=s,this.id=m,this.enabled=((o,s,m)=>_=>{const S=o.main.playlists[s],E=isIncompatible(S),A=isEnabled(S);return void 0===_?A:(_?delete S.disabled:S.disabled=!0,_===A||E||(m(),_?o.trigger("renditionenabled"):o.trigger("renditiondisabled")),_)})(o.playlists,s.id,S)}}const V2=["seeking","seeked","pause","playing","error"];class PlaybackWatcher{constructor(o){this.playlistController_=o.playlistController,this.tech_=o.tech,this.seekable=o.seekable,this.allowSeeksWithinUnsafeLiveWindow=o.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=o.liveRangeSafeTimeDelta,this.media=o.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=logger("PlaybackWatcher"),this.logger_("initialize");const playHandler=()=>this.monitorCurrentTime_(),canPlayHandler=()=>this.monitorCurrentTime_(),waitingHandler=()=>this.techWaiting_(),cancelTimerHandler=()=>this.resetTimeUpdate_(),s=this.playlistController_,m=["main","subtitle","audio"],_={};m.forEach((o=>{_[o]={reset:()=>this.resetSegmentDownloads_(o),updateend:()=>this.checkSegmentDownloads_(o)},s[`${o}SegmentLoader_`].on("appendsdone",_[o].updateend),s[`${o}SegmentLoader_`].on("playlistupdate",_[o].reset),this.tech_.on(["seeked","seeking"],_[o].reset)}));const setSeekingHandlers=o=>{["main","audio"].forEach((m=>{s[`${m}SegmentLoader_`][o]("appended",this.seekingAppendCheck_)}))};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),setSeekingHandlers("off"))},this.clearSeekingAppendCheck_=()=>setSeekingHandlers("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),setSeekingHandlers("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",waitingHandler),this.tech_.on(V2,cancelTimerHandler),this.tech_.on("canplay",canPlayHandler),this.tech_.one("play",playHandler),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",waitingHandler),this.tech_.off(V2,cancelTimerHandler),this.tech_.off("canplay",canPlayHandler),this.tech_.off("play",playHandler),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),m.forEach((o=>{s[`${o}SegmentLoader_`].off("appendsdone",_[o].updateend),s[`${o}SegmentLoader_`].off("playlistupdate",_[o].reset),this.tech_.off(["seeked","seeking"],_[o].reset)})),this.checkCurrentTimeTimeout_&&$V.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&$V.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=$V.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(o){const s=this.playlistController_[`${o}SegmentLoader_`];this[`${o}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${o} loader`),this[`${o}StalledDownloads_`]=0,this[`${o}Buffered_`]=s.buffered_()}checkSegmentDownloads_(o){const s=this.playlistController_,m=s[`${o}SegmentLoader_`],_=m.buffered_(),S=function(o,s){if(o===s)return!1;if(!o&&s||!s&&o)return!0;if(o.length!==s.length)return!0;for(let m=0;m<o.length;m++)if(o.start(m)!==s.start(m)||o.end(m)!==s.end(m))return!0;return!1}(this[`${o}Buffered_`],_);this[`${o}Buffered_`]=_,S?this.resetSegmentDownloads_(o):(this[`${o}StalledDownloads_`]++,this.logger_(`found #${this[`${o}StalledDownloads_`]} ${o} appends that did not increase buffer (possible stalled download)`,{playlistId:m.playlist_&&m.playlist_.id,buffered:timeRangesToArray(_)}),this[`${o}StalledDownloads_`]<10||(this.logger_(`${o} loader stalled download exclusion`),this.resetSegmentDownloads_(o),this.tech_.trigger({type:"usage",name:`vhs-${o}-download-exclusion`}),"subtitle"!==o&&s.excludePlaylist({error:{message:`Excessive ${o} segment downloading detected.`},playlistExclusionDuration:1/0})))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const o=this.tech_.currentTime(),s=this.tech_.buffered();if(this.lastRecordedTime===o&&(!s.length||o+p2>=s.end(s.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&o===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):o===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=o)}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const o=this.seekable(),s=this.tech_.currentTime();let m;if(this.afterSeekableWindow_(o,s,this.media(),this.allowSeeksWithinUnsafeLiveWindow)){m=o.end(o.length-1)}if(this.beforeSeekableWindow_(o,s)){const s=o.start(0);m=s+(s===o.end(0)?0:p2)}if(void 0!==m)return this.logger_(`Trying to seek outside of seekable at time ${s} with seekable range ${printableRange(o)}. Seeking to ${m}.`),this.tech_.setCurrentTime(m),!0;const _=this.playlistController_.sourceUpdater_,S=this.tech_.buffered(),E=_.audioBuffer?_.audioBuffered():null,A=_.videoBuffer?_.videoBuffered():null,O=this.media(),H=O.partTargetDuration?O.partTargetDuration:2*(O.targetDuration-h2),K=[E,A];for(let o=0;o<K.length;o++){if(!K[o])continue;if(timeAheadOf(K[o],s)<H)return!1}const z=findNextRange(S,s);return 0!==z.length&&(m=z.start(0)+p2,this.logger_(`Buffered region starts (${z.start(0)})  just beyond seek point (${s}). Seeking to ${m}.`),this.tech_.setCurrentTime(m),!0)}waiting_(){if(this.techWaiting_())return;const o=this.tech_.currentTime(),s=this.tech_.buffered(),m=findRange(s,o);return m.length&&o+3<=m.end(0)?(this.resetTimeUpdate_(),this.tech_.setCurrentTime(o),this.logger_(`Stopped at ${o} while inside a buffered region [${m.start(0)} -> ${m.end(0)}]. Attempting to resume playback by seeking to the current time.`),void this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"})):void 0}techWaiting_(){const o=this.seekable(),s=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(o,s)){const m=o.end(o.length-1);return this.logger_(`Fell out of live window at time ${s}. Seeking to live point (seekable end) ${m}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(m),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const m=this.tech_.vhs.playlistController_.sourceUpdater_,_=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:m.audioBuffered(),videoBuffered:m.videoBuffered(),currentTime:s}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(s),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const S=findNextRange(_,s);return S.length>0&&(this.logger_(`Stopped at ${s} and seeking to ${S.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(s),!0)}afterSeekableWindow_(o,s,m,_=!1){if(!o.length)return!1;let S=o.end(o.length-1)+p2;const E=!m.endList,A="number"==typeof m.partTargetDuration;return E&&(A||_)&&(S=o.end(o.length-1)+3*m.targetDuration),s>S}beforeSeekableWindow_(o,s){return!!(o.length&&o.start(0)>0&&s<o.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:o,audioBuffered:s,currentTime:m}){if(!o)return;let _;if(o.length&&s.length){const S=findRange(o,m-3),E=findRange(o,m),A=findRange(s,m);A.length&&!E.length&&S.length&&(_={start:S.end(0),end:A.end(0)})}else{findNextRange(o,m).length||(_=this.gapFromVideoUnderflow_(o,m))}return!!_&&(this.logger_(`Encountered a gap in video from ${_.start} to ${_.end}. Seeking to current time ${m}`),!0)}skipTheGap_(o){const s=this.tech_.buffered(),m=this.tech_.currentTime(),_=findNextRange(s,m);this.resetTimeUpdate_(),0!==_.length&&m===o&&(this.logger_("skipTheGap_:","currentTime:",m,"scheduled currentTime:",o,"nextRange start:",_.start(0)),this.tech_.setCurrentTime(_.start(0)+h2),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(o,s){const m=function(o){if(o.length<2)return createTimeRanges();const s=[];for(let m=1;m<o.length;m++){const _=o.end(m-1),S=o.start(m);s.push([_,S])}return createTimeRanges(s)}(o);for(let o=0;o<m.length;o++){const _=m.start(o),S=m.end(o);if(s-_<4&&s-_>2)return{start:_,end:S}}return null}}const H2={errorInterval:30,getSource(o){return o(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource())}},initPlugin=function(o,s){let m=0,_=0;const S=merge(H2,s);o.ready((()=>{o.trigger({type:"usage",name:"vhs-error-reload-initialized"})}));const loadedMetadataHandler=function(){_&&o.currentTime(_)},setSource=function(s){null!=s&&(_=o.duration()!==1/0&&o.currentTime()||0,o.one("loadedmetadata",loadedMetadataHandler),o.src(s),o.trigger({type:"usage",name:"vhs-error-reload"}),o.play())},errorHandler=function(){if(Date.now()-m<1e3*S.errorInterval)o.trigger({type:"usage",name:"vhs-error-reload-canceled"});else{if(S.getSource&&"function"==typeof S.getSource)return m=Date.now(),S.getSource.call(o,setSource);videojs.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},cleanupEvents=function(){o.off("loadedmetadata",loadedMetadataHandler),o.off("error",errorHandler),o.off("dispose",cleanupEvents)};o.on("error",errorHandler),o.on("dispose",cleanupEvents),o.reloadSourceOnError=function(s){cleanupEvents(),initPlugin(o,s)}},reloadSourceOnError=function(o){initPlugin(this,o)};var K2="3.10.0";const z2={PlaylistLoader:PlaylistLoader,Playlist:f2,utils:v2,STANDARD_PLAYLIST_SELECTOR:lastBandwidthSelector,INITIAL_PLAYLIST_SELECTOR:function(){const o=this.playlists.main.playlists.filter(f2.isEnabled);stableSort(o,((o,s)=>comparePlaylistBandwidth(o,s)));return o.filter((o=>!!codecsForPlaylist(this.playlists.main,o).video))[0]||null},lastBandwidthSelector:lastBandwidthSelector,movingAverageBandwidthSelector:function(o){let s=-1,m=-1;if(o<0||o>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){const _=this.useDevicePixelRatio&&$V.devicePixelRatio||1;return s<0&&(s=this.systemBandwidth,m=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==m&&(s=o*this.systemBandwidth+(1-o)*s,m=this.systemBandwidth),simpleSelector(this.playlists.main,s,parseInt(safeGetComputedStyle(this.tech_.el(),"width"),10)*_,parseInt(safeGetComputedStyle(this.tech_.el(),"height"),10)*_,this.limitRenditionByPlayerDimensions,this.playlistController_)}},comparePlaylistBandwidth:comparePlaylistBandwidth,comparePlaylistResolution:function(o,s){let m,_;return o.attributes.RESOLUTION&&o.attributes.RESOLUTION.width&&(m=o.attributes.RESOLUTION.width),m=m||$V.Number.MAX_VALUE,s.attributes.RESOLUTION&&s.attributes.RESOLUTION.width&&(_=s.attributes.RESOLUTION.width),_=_||$V.Number.MAX_VALUE,m===_&&o.attributes.BANDWIDTH&&s.attributes.BANDWIDTH?o.attributes.BANDWIDTH-s.attributes.BANDWIDTH:m-_},xhr:xhrFactory()};Object.keys(b2).forEach((o=>{Object.defineProperty(z2,o,{get:()=>(videojs.log.warn(`using Vhs.${o} is UNSAFE be sure you know what you are doing`),b2[o]),set(s){videojs.log.warn(`using Vhs.${o} is UNSAFE be sure you know what you are doing`),"number"!=typeof s||s<0?videojs.log.warn(`value of Vhs.${o} must be greater than or equal to 0`):b2[o]=s}})}));const W2="videojs-vhs",handleVhsMediaChange=function(o,s){const m=s.media();let _=-1;for(let s=0;s<o.length;s++)if(o[s].id===m.id){_=s;break}o.selectedIndex_=_,o.trigger({selectedIndex:_,type:"change"})};z2.canPlaySource=function(){return videojs.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const emeKeySystems=(o,s,m)=>{if(!o)return o;let _={};s&&s.attributes&&s.attributes.CODECS&&(_=unwrapCodecList(hK(s.attributes.CODECS))),m&&m.attributes&&m.attributes.CODECS&&(_.audio=m.attributes.CODECS);const S=gK(_.video),E=gK(_.audio),A={};for(const m in o)A[m]={},E&&(A[m].audioContentType=E),S&&(A[m].videoContentType=S),s.contentProtection&&s.contentProtection[m]&&s.contentProtection[m].pssh&&(A[m].pssh=s.contentProtection[m].pssh),"string"==typeof o[m]&&(A[m].url=o[m]);return merge(o,A)},getAllPsshKeySystemsOptions=(o,s)=>o.reduce(((o,m)=>{if(!m.contentProtection)return o;const _=s.reduce(((o,s)=>{const _=m.contentProtection[s];return _&&_.pssh&&(o[s]={pssh:_.pssh}),o}),{});return Object.keys(_).length&&o.push(_),o}),[]),waitForKeySessionCreation=({player:o,sourceKeySystems:s,audioMedia:m,mainPlaylists:_})=>{if(!o.eme.initializeMediaKeys)return Promise.resolve();const S=m?_.concat([m]):_,E=getAllPsshKeySystemsOptions(S,Object.keys(s)),A=[],O=[];return E.forEach((s=>{O.push(new Promise(((s,m)=>{o.tech_.one("keysessioncreated",s)}))),A.push(new Promise(((m,_)=>{o.eme.initializeMediaKeys({keySystems:s},(o=>{o?_(o):m()}))})))})),Promise.race([Promise.all(A),Promise.race(O)])},setupEmeOptions=({player:o,sourceKeySystems:s,media:m,audioMedia:_})=>{const S=emeKeySystems(s,m,_);return!!S&&(o.currentSource().keySystems=S,!(S&&!o.eme)||(videojs.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1))},getVhsLocalStorage=()=>{if(!$V.localStorage)return null;const o=$V.localStorage.getItem(W2);if(!o)return null;try{return JSON.parse(o)}catch(o){return null}},expandDataUri=o=>0===o.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")?JSON.parse(o.substring(o.indexOf(",")+1)):o,addOnRequestHook=(o,s)=>{o._requestCallbackSet||(o._requestCallbackSet=new Set),o._requestCallbackSet.add(s)},addOnResponseHook=(o,s)=>{o._responseCallbackSet||(o._responseCallbackSet=new Set),o._responseCallbackSet.add(s)},removeOnRequestHook=(o,s)=>{o._requestCallbackSet&&(o._requestCallbackSet.delete(s),o._requestCallbackSet.size||delete o._requestCallbackSet)},removeOnResponseHook=(o,s)=>{o._responseCallbackSet&&(o._responseCallbackSet.delete(s),o._responseCallbackSet.size||delete o._responseCallbackSet)};z2.supportsNativeHls=function(){if(!lH||!lH.createElement)return!1;const o=lH.createElement("video");if(!videojs.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some((function(s){return/maybe|probably/i.test(o.canPlayType(s))}))}(),z2.supportsNativeDash=!!(lH&&lH.createElement&&videojs.getTech("Html5").isSupported())&&/maybe|probably/i.test(lH.createElement("video").canPlayType("application/dash+xml")),z2.supportsTypeNatively=o=>"hls"===o?z2.supportsNativeHls:"dash"===o&&z2.supportsNativeDash,z2.isSupported=function(){return videojs.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},z2.xhr.onRequest=function(o){addOnRequestHook(z2.xhr,o)},z2.xhr.onResponse=function(o){addOnResponseHook(z2.xhr,o)},z2.xhr.offRequest=function(o){removeOnRequestHook(z2.xhr,o)},z2.xhr.offResponse=function(o){removeOnResponseHook(z2.xhr,o)};const G2=videojs.getComponent("Component");class VhsHandler extends G2{constructor(o,s,m){if(super(s,m.vhs),"number"==typeof m.initialBandwidth&&(this.options_.bandwidth=m.initialBandwidth),this.logger_=logger("VhsHandler"),s.options_&&s.options_.playerId){const o=videojs.getPlayer(s.options_.playerId);this.player_=o}if(this.tech_=s,this.source_=o,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&s.overrideNativeAudioTracks&&s.overrideNativeVideoTracks)s.overrideNativeAudioTracks(!0),s.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(s.featuresNativeVideoTracks||s.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(lH,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(o=>{const s=lH.fullscreenElement||lH.webkitFullscreenElement||lH.mozFullScreenElement||lH.msFullscreenElement;s&&s.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()})),this.on(this.tech_,"seeking",(function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())})),this.on(this.tech_,"error",(function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()})),this.on(this.tech_,"play",this.play)}setOptions_(o={}){if(this.options_=merge(this.options_,o),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=!1!==this.options_.llhls,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,"number"!=typeof this.options_.playlistExclusionDuration&&(this.options_.playlistExclusionDuration=60),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){const o=getVhsLocalStorage();o&&o.bandwidth&&(this.options_.bandwidth=o.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),o&&o.throughput&&(this.options_.throughput=o.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=b2.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===b2.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach((o=>{void 0!==this.source_[o]&&(this.options_[o]=this.source_[o])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}setOptions(o={}){this.setOptions_(o)}src(o,s){if(!o)return;this.setOptions_(),this.options_.src=expandDataUri(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=z2,this.options_.sourceType=TK(s),this.options_.seekTo=o=>{this.tech_.setCurrentTime(o)},this.playlistController_=new PlaylistController(this.options_);const m=merge({liveRangeSafeTimeDelta:p2},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new PlaybackWatcher(m),this.playlistController_.on("error",(()=>{const o=videojs.players[this.tech_.options_.playerId];let s=this.playlistController_.error;"object"!=typeof s||s.code?"string"==typeof s&&(s={message:s,code:3}):s.code=3,o.error(s)}));const _=this.options_.bufferBasedABR?z2.movingAverageBandwidthSelector(.55):z2.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):_.bind(this),this.playlistController_.selectInitialPlaylist=z2.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(o){this.playlistController_.selectPlaylist=o.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(o){this.playlistController_.mainSegmentLoader_.throughput.rate=o,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let o=this.playlistController_.mainSegmentLoader_.bandwidth;const s=$V.navigator.connection||$V.navigator.mozConnection||$V.navigator.webkitConnection,m=1e7;if(this.options_.useNetworkInformationApi&&s){const _=1e3*s.downlink*1e3;o=_>=m&&o>=m?Math.max(o,_):_}return o},set(o){this.playlistController_.mainSegmentLoader_.bandwidth=o,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const o=1/(this.bandwidth||1);let s;s=this.throughput>0?1/this.throughput:0;return Math.floor(1/(o+s))},set(){videojs.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>timeRangesToArray(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>timeRangesToArray(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",(()=>{this.options_.useBandwidthFromLocalStorage&&(o=>{if(!$V.localStorage)return!1;let s=getVhsLocalStorage();s=s?merge(s,o):o;try{$V.localStorage.setItem(W2,JSON.stringify(s))}catch(o){return!1}})({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})})),this.playlistController_.on("selectedinitialmedia",(()=>{var o;(o=this).representations=()=>{const s=o.playlistController_.main(),m=isAudioOnly(s)?o.playlistController_.getAudioTrackPlaylists_():s.playlists;return m?m.filter((o=>!isIncompatible(o))).map(((s,m)=>new Representation(o,s,s.id))):[]}})),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",(()=>{this.setupEme_()})),this.on(this.playlistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.playlistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=$V.URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const o=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),waitForKeySessionCreation({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:o&&o.media(),mainPlaylists:this.playlists.main.playlists}).then((()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()})).catch((o=>{this.logger_("error while creating EME key session",o),this.player_.error({message:"Failed to initialize media keys for EME",code:3})}))}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const o=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,s=setupEmeOptions({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:o&&o.media()});this.player_.tech_.on("keystatuschange",(o=>{this.playlistController_.updatePlaylistByKeyStatus(o.keyId,o.status)})),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),s?this.createKeySessions_():this.playlistController_.sourceUpdater_.initializedEme()}setupQualityLevels_(){const o=videojs.players[this.tech_.options_.playerId];o&&o.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=o.qualityLevels(),this.playlistController_.on("selectedinitialmedia",(()=>{!function(o,s){s.representations().forEach((s=>{o.addQualityLevel(s)})),handleVhsMediaChange(o,s.playlists)}(this.qualityLevels_,this)})),this.playlists.on("mediachange",(()=>{handleVhsMediaChange(this.qualityLevels_,this.playlists)})))}static version(){return{"@videojs/http-streaming":K2,"mux.js":"7.0.2","mpd-parser":"1.3.0","m3u8-parser":"7.1.0","aes-decrypter":"4.0.1"}}version(){return this.constructor.version()}canChangeType(){return SourceUpdater.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(o){this.playlistController_.setCurrentTime(o)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&$V.URL.revokeObjectURL&&($V.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(o,s){return getProgramTime({playlist:this.playlistController_.media(),time:o,callback:s})}seekToProgramTime(o,s,m=!0,_=2){return seekToProgramTime({programTime:o,playlist:this.playlistController_.media(),retryCount:_,pauseAfterSeek:m,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:s})}setupXhrHooks_(){this.xhr.onRequest=o=>{addOnRequestHook(this.xhr,o)},this.xhr.onResponse=o=>{addOnResponseHook(this.xhr,o)},this.xhr.offRequest=o=>{removeOnRequestHook(this.xhr,o)},this.xhr.offResponse=o=>{removeOnResponseHook(this.xhr,o)},this.player_.trigger("xhr-hooks-ready")}}const q2={name:"videojs-http-streaming",VERSION:K2,canHandleSource(o,s={}){const m=merge(videojs.options,s);return q2.canPlayType(o.type,m)},handleSource(o,s,m={}){const _=merge(videojs.options,m);return s.vhs=new VhsHandler(o,s,_),s.vhs.xhr=xhrFactory(),s.vhs.setupXhrHooks_(),s.vhs.src(o.src,o.type),s.vhs},canPlayType(o,s){const m=TK(o);if(!m)return"";const _=q2.getOverrideNative(s);return!z2.supportsTypeNatively(m)||_?"maybe":""},getOverrideNative(o={}){const{vhs:s={}}=o,m=!(videojs.browser.IS_ANY_SAFARI||videojs.browser.IS_IOS),{overrideNative:_=m}=s;return _}};mK("avc1.4d400d,mp4a.40.2")&&videojs.getTech("Html5").registerSourceHandler(q2,0),videojs.VhsHandler=VhsHandler,videojs.VhsSourceHandler=q2,videojs.Vhs=z2,videojs.use||videojs.registerComponent("Vhs",z2),videojs.options.vhs=videojs.options.vhs||{},videojs.getPlugin&&videojs.getPlugin("reloadSourceOnError")||videojs.registerPlugin("reloadSourceOnError",reloadSourceOnError);var X2=Object.freeze({__proto__:null,LOCAL_STORAGE_KEY:W2,Vhs:z2,VhsHandler:VhsHandler,VhsSourceHandler:q2,emeKeySystems:emeKeySystems,expandDataUri:expandDataUri,getAllPsshKeySystemsOptions:getAllPsshKeySystemsOptions,setupEmeOptions:setupEmeOptions,waitForKeySessionCreation:waitForKeySessionCreation,simpleTypeFromSourceType:TK}),Y2=new Map([["abort","Abort"],["canplay","CanPlay"],["canplaythrough","CanPlayThrough"],["durationchange","DurationChange"],["emptied","Emptied"],["encrypted","Encrypted"],["ended","Ended"],["error","Error"],["interruptbegin","InterruptBegin"],["interruptend","InterruptEnd"],["loadeddata","LoadedData"],["loadedmetadata","LoadedMetadata"],["loadstart","LoadStart"],["pause","Pause"],["play","Play"],["playing","Playing"],["progress","Progress"],["ratechange","Ratechange"],["seeked","Seeked"],["seeking","Seeking"],["stalled","Stalled"],["suspend","Suspend"],["timeupdate","TimeUpdate"],["volumechange","VolumeChange"],["waiting","Waiting"],["resize","Resize"],["componentresize","ComponentResize"],["controlsdisabled","ControlsDisabled"],["controlsenabled","ControlsEnabled"],["dispose","Dispose"],["enterFullWindow","EnterFullWindow"],["enterpictureinpicture","EnterPictureInPicture"],["exitFullWindow","ExitFullWindow"],["fullscreenchange","FullScreenChange"],["languagechange","LanguageChange"],["leavepictureinpicture","LeavePictureInPicture"],["playbackrateschange","PlaybackRatesChange"],["playerresize","PlayerResize"],["pluginsetup","PluginSetup"],["posterchange","PosterChange"],["progress","Progress"],["ratechange","RateChange"],["ready","Ready"],["sourceset","SourceSet"],["tap","Tap"],["textdata","TextData"],["texttrackchange","TextTrackChange"],["useractive","UserActive"],["userinactive","UserInactive"],["usingnativecontrols","UsingNativeControls"],["usingcustomcontrols","UsingCustomControls"]]);function forceHTTPS(o){return"https:"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.location.protocol)?o.replace("http:","https:"):o}var __awaiter=function(o,s,m,_){return new(m||(m=Promise))((function(S,E){function fulfilled(o){try{step(_.next(o))}catch(o){E(o)}}function rejected(o){try{step(_.throw(o))}catch(o){E(o)}}function step(o){o.done?S(o.value):function adopt(o){return o instanceof m?o:new m((function(s){s(o)}))}(o.value).then(fulfilled,rejected)}step((_=_.apply(o,s||[])).next())}))},Q2=function(){function VideoJSPlayer(o){var s=this;_classCallCheck$1(this,VideoJSPlayer),this.supportedFormats=[".mpd",".m3u8",".mp4",".mp3",".wav",".ogg",".aac",".flac"],this.errorCount=0,this.timeoutId=null,this.logger=new $v(new Yv),this.retryAttempts=2,this.retryWaitTime=1e3,this.renderCC=function(o){s.logger.info(o)};var m=o.width,_=o.height,S=o.bitrateRange,E=o.videoEl,A=o.shouldRetry,O=o.retryAttempts,H=o.retryWaitTime;E?this.videoElement=E:(this.videoElement=document.createElement("video"),document.body.appendChild(this.videoElement)),Object.assign(window,{videojs:videojs,httpStreaming:X2}),this.injectDashPlugin(),this.modifyVjsStyles(),videojs(this.videoElement,{id:"VideoJsElement",controls:!1,html5:{vhs:{overrideNative:!0}}}),this.player=videojs.getPlayer("VideoJsElement"),this.shouldRetryOnFailure=null!=A&&A,this.retryAttempts=null!=O?O:2,this.retryWaitTime=null!=H?H:this.retryWaitTime,this.videoElement.style.position="absolute",this.width=m,this.height=_,this.size(m,_),this.bitrateRange=S}return _createClass$1(VideoJSPlayer,[{key:"modifyVjsStyles",value:function modifyVjsStyles(){var o=document.querySelector(".vjs-styles-defaults");o&&(o.querySelector(".vjs-hidden")||(o.innerHTML+="\n                  .vjs-hidden {\n                      display: none !important;\n                  }\n              "))}},{key:"injectDashPlugin",value:function injectDashPlugin(){if(!document.getElementById("videoJsDashScript")){var o=document.createElement("script");o.id="videoJsDashScript",o.src="./static/videojsScripts/videojs-dash.min.js",document.head.appendChild(o)}if(!document.getElementById("dashJSSCript")){var s=document.createElement("script");s.id="dashJSSCript",s.src="./static/videojsScripts/dash.all.min.js",document.head.appendChild(s)}}},{key:"open",value:function open(o,s){return __awaiter(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:return this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),m.next=3,this.loadVideo(o,s);case 3:case"end":return m.stop()}}),_callee,this)})))}},{key:"loadVideo",value:function loadVideo(o,s){return __awaiter(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee2(){var m;return _regeneratorRuntime$1().wrap((function _callee2$(_){for(;;)switch(_.prev=_.next){case 0:this.playbackConfig={type:s||"VOD",url:o,startPosition:null},(m=this.getSourceType(o))?this.player.src({src:o,type:m}):this.player.src({src:o}),this.player.load();case 4:case"end":return _.stop()}}),_callee2,this)})))}},{key:"getSourceType",value:function getSourceType(o){return o.includes(this.supportedFormats[0])?"application/dash+xml":o.includes(this.supportedFormats[1])?"application/x-mpegURL":void 0}},{key:"destroy",value:function destroy(){var o=this;return new Promise((function(s,m){try{o.player.dispose();var _=function handleDispose(){clearTimeout(S),s()},S=setTimeout((function(){o.player.off("dispose",_),s()}),1e3);o.player.one("dispose",_)}catch(o){m(o)}}))}},{key:"close",value:function close(){return __awaiter(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee3(){return _regeneratorRuntime$1().wrap((function _callee3$(o){for(;;)switch(o.prev=o.next){case 0:this.player.src(""),this.player.load();case 2:case"end":return o.stop()}}),_callee3,this)})))}},{key:"size",value:function size(o,s){this.player.dimensions(o,s),this.videoElement.style.width="".concat(o,"px"),this.videoElement.style.height="".concat(s,"px")}},{key:"position",value:function position(o,s){this.videoElement.style.top="".concat(s,"px"),this.videoElement.style.left="".concat(o,"px")}},{key:"mute",value:function mute(){this.player.muted(!0)}},{key:"unmute",value:function unmute(){this.player.muted(!1)}},{key:"play",value:function play(){return __awaiter(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee4(){return _regeneratorRuntime$1().wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.player.play();case 2:case"end":return o.stop()}}),_callee4,this)})))}},{key:"pause",value:function pause(){return __awaiter(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee5(){return _regeneratorRuntime$1().wrap((function _callee5$(o){for(;;)switch(o.prev=o.next){case 0:this.player.pause();case 1:case"end":return o.stop()}}),_callee5,this)})))}},{key:"seek",value:function seek(o){return __awaiter(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee6(){return _regeneratorRuntime$1().wrap((function _callee6$(s){for(;;)switch(s.prev=s.next){case 0:this.player.currentTime(o);case 1:case"end":return s.stop()}}),_callee6,this)})))}},{key:"loop",value:function loop(o){this.player.loop(o)}},{key:"isFormatSupported",value:function isFormatSupported(o){var s=this.supportedFormats;for(var m in s)if(o.includes(s[m]))return!0;return!1}},{key:"registerEventListeners",value:function registerEventListeners(o){var s,m=this,_=_createForOfIteratorHelper(Y2);try{for(_.s();!(s=_.n()).done;){var S=s.value;this.player.on(S,(function(s){m.handleEvent(s,o)}))}}catch(o){_.e(o)}finally{_.f()}}},{key:"registerPlayerEventListener",value:function registerPlayerEventListener(o,s){var m=this.getMappedEventKey(o);m&&this.player.on(m,s)}},{key:"deregisterEventListeners",value:function deregisterEventListeners(){var o,s=_createForOfIteratorHelper(Y2);try{for(s.s();!(o=s.n()).done;){var m=o.value;this.player.off(m)}}catch(o){s.e(o)}finally{s.f()}}},{key:"deregisterPlayerEventListener",value:function deregisterPlayerEventListener(o,s){this.player.off(o,s)}},{key:"handleEvent",value:function handleEvent(o,s){var m=this,_=Y2.get(o.type);if(_){var S={playbackConfig:this.playbackConfig};if("Error"===_)this.videoElement.error&&(S.errorContext={code:"".concat(this.videoElement.error.code),message:this.videoElement.error.message});var E={type:_,timestamp:o.timeStamp,metadata:S};if("Error"===_){if(S.errorContext&&parseInt(S.errorContext.code)>=2)if(this.shouldRetryOnFailure&&this.errorCount<=this.retryAttempts){if(this.errorCount++,this.playbackConfig){var A=this.playbackConfig.url,O=this.playbackConfig.type||"VOD",H=this.retryWaitTime>1e3?this.retryWaitTime:this.retryWaitTime*this.errorCount;this.timeoutId=setTimeout((function(){return __awaiter(m,void 0,void 0,_regeneratorRuntime$1().mark((function _callee7(){return _regeneratorRuntime$1().wrap((function _callee7$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.open(forceHTTPS(A),O);case 2:case"end":return o.stop()}}),_callee7,this)})))}),H)}}else this.errorCount=0,s&&s(E)}else s&&s(E)}}},{key:"hide",value:function hide(){this.player.hide()}},{key:"show",value:function show(){this.player.show()}},{key:"getMappedEventKey",value:function getMappedEventKey(o){var s,m=_createForOfIteratorHelper(Y2.entries());try{for(m.s();!(s=m.n()).done;){var _=_slicedToArray$1(s.value,2),S=_[0];if(_[1]===o)return S}}catch(o){m.e(o)}finally{m.f()}}},{key:"onPlayerEvent",set:function set(o){try{this.registerEventListeners(o)}catch(o){this.logger.warn("Player encountered an error when registering listeners ".concat(o))}}},{key:"setupCC",value:function setupCC(){for(var o,s=this,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",_=this.player.textTracks(),S=0;S<_.length;S++){var E=_[S];"captions"!==E.kind&&"subtitles"!==E.kind||E.language!==m?E.mode="disabled":(E.mode="hidden",(o=E).oncuechange=function(){var m=o.activeCues,_=null==m?void 0:m.length,S="";if(_){for(var E=0;E<_;E++){var A=m[E];S+=(null==A?void 0:A.text)+"\n"}s.renderCC(S)}})}}},{key:"isPlaying",get:function get(){return!this.player.paused()}},{key:"currentTime",get:function get(){return this.player.currentTime()}},{key:"duration",get:function get(){return this.player.duration()}},{key:"ccEnabled",get:function get(){return!1}},{key:"ccAvailable",get:function get(){return!0}}]),VideoJSPlayer}(),J2=function(o){_inherits$1(PlayerWidget,o);var s=_createSuper$1(PlayerWidget);function PlayerWidget(){var o;return _classCallCheck$1(this,PlayerWidget),(o=s.apply(this,arguments)).progressBarAnimation=null,o.progressBarReturn=null,o.playerInstance={},o.isPlayerWidgetContainer=!1,o._isLive=!1,o.isFullscreen=!1,o.autoplay=!0,o._currentSourceUrl="",o.api={},o.logger={},o.playerCoords={w:0,h:0,x:0,y:0,stroke:4},o.store={},o.selectedSource={format:"",type:"VOD",url:"",formattedUrl:"",tags:[],id:""},o.widgetStroke=4,o}return _createClass$1(PlayerWidget,[{key:"_init",value:function _init(){this._setAnimation(),this.api=a_.resolveType(a_.dependencyKeys.API),this.logger=a_.resolveType(DE.dependencyKeys.Logger),this.store=a_.resolveType(a_.dependencyKeys.Store)}},{key:"_enable",value:function _enable(){this._setState("PlayerFocused")}},{key:"_setAnimation",value:function _setAnimation(){this.progressBarAnimation=this._progressBarView.animation({duration:1,stopMethod:"immediate",actions:[{p:"alpha",v:{0:1,.5:1,1:0}}]}),this.progressBarReturn=this._progressBarView.animation({duration:1,stopMethod:"immediate",actions:[{p:"alpha",v:{0:1}}]})}},{key:"_handleBack",value:function _handleBack(){this.isFullscreen?(this.toggleFullscreen(),Oy.focusPage()):this.playerInstance.close()}},{key:"_handleMediaPlayPause",value:function _handleMediaPlayPause(){this.playerInstance.isPlaying?this.pause():this.play()}},{key:"_handleMediaFastForward",value:function _handleMediaFastForward(){this.seek(10)}},{key:"_handleMediaRewind",value:function _handleMediaRewind(){this.seek(-10)}},{key:"_handleKey",value:function _handleKey(){return!0}},{key:"play",value:function play(){this.playerInstance.play&&this.playerInstance.play()}},{key:"pause",value:function pause(){this.playerInstance.pause&&this.playerInstance.pause()}},{key:"show",value:function show(){this.visible=!0}},{key:"hide",value:function hide(){this.visible=!1}},{key:"fullscreen",value:function fullscreen(){this.store.set("fullScreenEnabled",{page:Oy.getActiveHash()||"",isVisible:!0}),this.tag("OverlayBackground").alpha=0,this.playerInstance.resizeVideo(qw.screenWidth,qw.screenHeight,0,0),this._progressBarView.playerSize="fullscreen",this.isFullscreen=!0}},{key:"toggleFullscreen",value:function toggleFullscreen(){this.isFullscreen?(this.store.set("fullScreenEnabled",{page:Oy.getActiveHash()||"",isVisible:!1}),this.tag("OverlayBackground").alpha=1,this.sizeAsWidget(),this._progressBarView.playerSize="home"===Oy.getActiveHash()?"widgetCenter":"widget",this.isFullscreen=!1):(this.store.set("fullScreenEnabled",{page:Oy.getActiveHash()||"",isVisible:!0}),this.tag("OverlayBackground").alpha=0,this.playerInstance.resizeVideo(qw.screenWidth,qw.screenHeight,0,0),this._progressBarView.playerSize="fullscreen",this.isFullscreen=!0)}},{key:"updateLogo",value:function updateLogo(){this.isFullscreen?this.overlay.patch({w:1920,h:1080}):this.overlay.patch({w:1075,h:604})}},{key:"mute",value:function mute(){this.playerInstance.mute()}},{key:"unmute",value:function unmute(){this.playerInstance.unmute()}},{key:"restart",value:function restart(){if(this.playerInstance.close(),""===this.selectedSource.format)return this.availabilityMessage.alpha=1,void(this.overlay.alpha=1);this.updatePlayer(),this.updateVideoSource(),this.visible&&this._active()}},{key:"close",value:function close(){this.playerInstance.close()}},{key:"updatePlayer",value:function updatePlayer(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o,s=this;return _regeneratorRuntime$1().wrap((function _callee$(m){for(;;)switch(m.prev=m.next){case 0:if(!this.playerInstance.destroy){m.next=9;break}return m.prev=1,m.next=4,this.playerInstance.destroy();case 4:m.next=9;break;case 6:m.prev=6,m.t0=m.catch(1),this.logger.info(JSON.stringify(m.t0,null,2));case 9:if(o=this.retrievePlayerInstance()){m.next=12;break}return m.abrupt("return");case 12:a_.registerType(new u_({customTimeUpdateInterval:3,playerInstance:o}),DE.dependencyKeys.Player),this.playerInstance=a_.resolveType(DE.dependencyKeys.Player),this.playerInstance.onPlayerEvent=function(o){s.store.set("currentEvent",o)},this.store.propertyChanged.currentEvent.addListener((function(o){return s.handleEvent(o)})),this.updatePlayerState();case 17:case"end":return m.stop()}}),_callee,this,[[1,6]])})))}},{key:"handleEvent",value:function handleEvent(o){if(o.newValue){var s=o.newValue;if("Playing"===s.type&&!("AOD"===this.selectedSource.type||"LiveAudio"===this.selectedSource.type)&&(this.overlay.alpha=0),"TextMetadataCue"===s.type){var m=s.payload;this.tag("PlayerMessage").patch({alpha:1,text:{text:"metadata was updated!: ".concat(null==m?void 0:m.text)}})}}}},{key:"retrieveMediaElement",value:function retrieveMediaElement(){var o=this.generatesAudioPlayerItself();if(("AOD"===this.selectedSource.type||"LiveAudio"===this.selectedSource.type)&&!o){var s=document.createElement("audio");return s.id="audioElement",document.body.appendChild(s),s}}},{key:"generatesAudioPlayerItself",value:function generatesAudioPlayerItself(){switch(this.selectedPlayer){case"avplay":case"aamp":return!0;default:return!1}}},{key:"retrievePlayerInstance",value:function retrievePlayerInstance(){var o=this.retrieveMediaElement();switch(this.selectedPlayer){case"hls":return new mV({width:qw.screenWidth,height:qw.screenHeight,bitrateRange:{min:1e3,max:9999},videoEl:o});case"aamp":return new PV(qw.screenWidth,qw.screenHeight,{min:1e3,max:9999});case"shaka":return new HV({width:qw.screenWidth,height:qw.screenHeight,bitrateRange:{min:1e3,max:9999},videoEl:o});case"avplay":return new QV(qw.screenWidth,qw.screenHeight,{min:1e3,max:9999});case"ivsplayer":return new oH(qw.screenWidth,qw.screenHeight,{min:1e3,max:9999});case"videojsplayer":return new Q2({width:qw.screenWidth,height:qw.screenHeight,bitrateRange:{min:1e3,max:9999}})}}},{key:"seek",value:function seek(o){this.playerInstance.seek(this.calculateSeekValue(o,this.playerInstance.duration))}},{key:"calculateSeekValue",value:function calculateSeekValue(o,s){return clamp$2(o+this.playerInstance.currentTime,0,s)}},{key:"updateVideoSource",value:function updateVideoSource(){this.selectedSource&&(this._currentSourceUrl=this.selectedSource.url,this._currentDRMKeys=this.selectedSource.drm,this.updatePlayer())}},{key:"updatePlayerState",value:function updatePlayerState(){var o=this;this.availabilityMessage.alpha=1,this.selectedPlayer&&this.selectedSource.format&&(this.playerInstance.isFormatSupported(this._currentSourceUrl)?(this.tag("PlayerMessage").alpha=0,this.playerInstance.open(this._currentSourceUrl).then((function(){o.autoplay&&o.play(),o.store.getByProperty("playerMuted")&&o.mute()})).catch((function(s){return o.logger.error(JSON.stringify(s,null,2))})),this.sizeAsWidget(),this._progressBarView.player=this.playerInstance):this.tag("PlayerMessage").alpha=1)}},{key:"sizeAsWidget",value:function sizeAsWidget(){this.playerInstance.resizeVideo(this.playerCoords.w,this.playerCoords.h,this.playerCoords.x,this.playerCoords.y)}},{key:"resize",value:function resize(o,s,m,_,S){this.playerCoords.w=o,this.playerCoords.h=s,this.playerCoords.x=m||this.x,this.playerCoords.y=_||this.y,this.patch({stroke:S||this.widgetStroke})}},{key:"positionAvailabilityMessage",value:function positionAvailabilityMessage(o,s,m,_){this.availabilityMessage.patch({x:m,y:_,OverlayBackground:{w:o,h:s}})}},{key:"_handleEnter",value:function _handleEnter(){this.playerInstance.isPlaying?this.playerInstance.pause():this.playerInstance.play()}},{key:"_progressBarView",get:function get(){return this.tag("ProgressBarView")}},{key:"player",set:function set(o){this.selectedPlayer!==o&&(this.selectedPlayer=o,this.updatePlayer())}},{key:"source",set:function set(o){this.selectedSource!==o&&(this.selectedSource=o,""!==this.selectedSource.format&&this.updateVideoSource())}},{key:"currentSourceUrl",get:function get(){return this._currentSourceUrl}},{key:"availabilityMessage",get:function get(){return this.tag("AvailabilityMessage")}},{key:"overlay",get:function get(){return this.tag("AvailabilityMessage.OverlayBackground.Overlay")}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,PlayerMessage:{x:651,y:60,alpha:0,text:{text:"Selected Source is unsupported!",textColor:4294901760,fontSize:36},shader:null},AvailabilityMessage:{x:765,y:213,OverlayBackground:{w:1075,h:604,color:XS.get("clear"),rect:!0,Overlay:{w:function w(o){return o},h:function h(o){return o},color:805306368,Logo:{w:457,h:142,mount:.5,x:function x(o){return o/2},y:function y(o){return o/2},src:ca.asset(ZP),shader:null},shader:null},shader:{type:E.shaders.RoundedRectangle,radius:0,stroke:4,strokeColor:XS.get("white")}}},ProgressBarView:{type:oV,shader:null}}}},{key:"_states",value:function _states(){return[function(o){_inherits$1(PlayerFocused,o);var s=_createSuper$1(PlayerFocused);function PlayerFocused(){return _classCallCheck$1(this,PlayerFocused),s.apply(this,arguments)}return _createClass$1(PlayerFocused,[{key:"$enter",value:function $enter(){var o;null===(o=this.progressBarReturn)||void 0===o||o.start(),this._setState("ProgressBarFocused")}}]),PlayerFocused}(this),function(o){_inherits$1(ProgressBarFocused,o);var s=_createSuper$1(ProgressBarFocused);function ProgressBarFocused(){return _classCallCheck$1(this,ProgressBarFocused),s.apply(this,arguments)}return _createClass$1(ProgressBarFocused,[{key:"_getFocused",value:function _getFocused(){return this._progressBarView}}]),ProgressBarFocused}(this),function(o){_inherits$1(ProgressBarHidden,o);var s=_createSuper$1(ProgressBarHidden);function ProgressBarHidden(){return _classCallCheck$1(this,ProgressBarHidden),s.apply(this,arguments)}return _createClass$1(ProgressBarHidden,[{key:"$enter",value:function $enter(){var o;null===(o=this.progressBarAnimation)||void 0===o||o.start()}},{key:"_handleEnter",value:function _handleEnter(){var o;null===(o=this.progressBarReturn)||void 0===o||o.start(),this._setState("ProgressBarFocused")}}]),ProgressBarHidden}(this)]}}]),PlayerWidget}(aL),Z2=function(o){_inherits$1(ExitModal,o);var s=_createSuper$1(ExitModal);function ExitModal(){var o;return _classCallCheck$1(this,ExitModal),(o=s.apply(this,arguments)).textProvider={},o}return _createClass$1(ExitModal,[{key:"_init",value:function _init(){this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.setUpModal()}},{key:"setUpModal",value:function setUpModal(){var o={w:222,h:69,color:XS.get("black"),focusedColor:XS.get("velopeGreen"),radius:getLngOptimalElementSize(17),stroke:3,strokeColor:XS.get("white"),focusedStroke:0,textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")}};this.header.patch({Title:{text:{text:this.textProvider.getText(ST)}}}),this.modal.patch({box:{w:getLngOptimalElementSize(801),h:366,margin:75,titleYMargin:48,bodyYMargin:135,src:ca.asset(rL),radius:54,background:{color:XS.get("black"),alpha:.5,rect:!0},title:{text:this.textProvider.getText(TT),textColor:XS.get("eggshell"),fontSize:39,textAlign:"center",fontFace:XP.bold},body:{text:this.textProvider.getText(kT),lineHeight:60,textColor:XS.get("eggshell"),fontSize:33,textAlign:"center",fontFace:XP.regular},buttons:{align:"center",spacing:getLngOptimalElementSize(50),left:Object.assign(Object.assign({},o),{title:this.textProvider.getText(wT)}),right:Object.assign(Object.assign({},o),{title:this.textProvider.getText(CT)})}}})}},{key:"_getFocused",value:function _getFocused(){return this.modal}},{key:"_focus",value:function _focus(){this.setSmooth("alpha",1)}},{key:"_unfocus",value:function _unfocus(){this.setSmooth("alpha",0)}},{key:"_firstEnable",value:function _firstEnable(){this.modal.onLButtonPressed=function(){Oy.focusWidget("ExampleModal")},this.modal.onRButtonPressed=function(){qw.shutdown()}}},{key:"_handleBack",value:function _handleBack(){Oy.focusPage()}},{key:"_handleKey",value:function _handleKey(){}},{key:"modal",get:function get(){return this.tag("Modal")}},{key:"header",get:function get(){return this.tag("Header")}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,alpha:0,Header:{w:function w(o){return o},h:66,y:48,zIndex:99,Logo:{w:207,h:66,x:57,src:ca.asset(ZP),shader:{type:E.shaders.RoundedRectangle,radius:9}},Title:{w:402,h:66,x:309,y:9,text:{fontSize:39,wordWrapWidth:function wordWrapWidth(o){return o},textColor:XS.get("eggshell"),fontFace:XP.bold}}},Modal:{type:MP}}}}]),ExitModal}(E.Component),e4=function(o){_inherits$1(ExampleModal,o);var s=_createSuper$1(ExampleModal);function ExampleModal(){var o;return _classCallCheck$1(this,ExampleModal),(o=s.apply(this,arguments)).textProvider={},o}return _createClass$1(ExampleModal,[{key:"_init",value:function _init(){this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.setUpModal()}},{key:"setUpModal",value:function setUpModal(){this.header.patch({Title:{text:{text:this.textProvider.getText(xT)}}}),this.modal.patch({box:{w:800,h:364,margin:75,titleYMargin:49,bodyYMargin:134,color:XS.get("black"),radius:54,background:{color:XS.get("black"),alpha:.5,rect:!0},title:{text:this.textProvider.getText(ET),textColor:XS.get("eggshell"),fontSize:40,textAlign:"center",fontFace:XP.bold},body:{text:this.textProvider.getText(IT),lineHeight:60,textColor:XS.get("eggshell"),fontSize:32,textAlign:"center",fontFace:XP.regular},buttons:{align:"center",spacing:50,left:{w:222,h:69,title:this.textProvider.getText(AT),color:XS.get("black"),focusedColor:XS.get("velopeGreen"),radius:17,stroke:3,strokeColor:XS.get("white"),focusedStroke:0,textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")}}}}})}},{key:"_getFocused",value:function _getFocused(){return this.modal}},{key:"_focus",value:function _focus(){this.setSmooth("alpha",1)}},{key:"_unfocus",value:function _unfocus(){this.setSmooth("alpha",0)}},{key:"_firstEnable",value:function _firstEnable(){this.modal.onLButtonPressed=function(){Oy.focusPage()}}},{key:"_handleBack",value:function _handleBack(){Oy.focusPage()}},{key:"_handleKey",value:function _handleKey(){}},{key:"modal",get:function get(){return this.tag("Modal")}},{key:"header",get:function get(){return this.tag("Header")}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,alpha:0,Header:{w:function w(o){return o},h:64,y:46,zIndex:99,Logo:{w:206,h:64,x:56,src:ca.asset(ZP),shader:{type:E.shaders.RoundedRectangle,radius:10}},Title:{w:400,h:44,x:308,y:9,text:{fontSize:40,wordWrapWidth:function wordWrapWidth(o){return o},textColor:XS.get("eggshell"),fontFace:XP.bold}}},Modal:{type:MP}}}}]),ExampleModal}(E.Component),t4=500,n4=2,r4=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],i4=["ArrowDown","ArrowLeft","ArrowRight","ArrowLeft"],a4=function(o){_inherits$1(SpinnerView,o);var s=_createSuper$1(SpinnerView);function SpinnerView(){var o;return _classCallCheck$1(this,SpinnerView),(o=s.apply(this,arguments)).presenter={},o.isLoading=function(s){if("isLoading"===s.propertyName)if(s.newValue)var m=setTimeout((function(){o.appIsLoading?o.patch({alpha:1}):(clearTimeout(m),o.patch({alpha:0}))}),t4);else o.patch({alpha:0})},o}return _createClass$1(SpinnerView,[{key:"_init",value:function _init(){this.presenter=a_.resolveType(DE.dependencyKeys.SpinnerPresenter),this.presenter.propertyChanged.addListener(this.isLoading)}},{key:"appIsLoading",get:function get(){return this.presenter.appLoading}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,alpha:0,Background:{w:function w(o){return o},h:function h(o){return o},rect:!0,color:XS.get("black")},Spinner:{w:400,h:400,x:960,y:560,mount:.5,spinnerColor:XS.get("white"),radius:200,period:n4,stroke:10,showDot:!0,clockwise:!0,type:GP}}}}]),SpinnerView}(E.Component),o4=function(o){_inherits$1(ProfilingMonitor,o);var s=_createSuper$1(ProfilingMonitor);function ProfilingMonitor(){var o;return _classCallCheck$1(this,ProfilingMonitor),(o=s.apply(this,arguments)).profiling={},o.currentFetchRecords=[],o.currentInputs=[],o.unfocusWidget=!1,o}return _createClass$1(ProfilingMonitor,[{key:"_getFocused",value:function _getFocused(){return this.fetchList}},{key:"_init",value:function _init(){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){var o=this;return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:this.profiling=a_.resolveType(a_.dependencyKeys.Profiling),this.profiling.active?ja.setInterval((function(){if(o.tag("Content.ProfilingData").patch({Memory:{text:{text:"Memory used: ".concat(o.profiling.currentMemoryHeapSize()," MB")}},NetworkActivity:{text:{text:"Fetch calls: ".concat(o.profiling.currentFetchRecords().length)}}}),o.currentFetchRecords.length<o.profiling.currentFetchRecords().length){o.currentFetchRecords=_toConsumableArray$1(o.profiling.currentFetchRecords());var s=o.currentFetchRecords.map((function(s,m){return o.fetchListItemTemplate(s,m)})),m=o.fetchList.selectedIndex;o.fetchList.items=s,o.hasFocus()?o.fetchList.selectedIndex=m:o.selectLastListItem()}}),2e3):this.alpha=0;case 2:case"end":return s.stop()}}),_callee,this)})))}},{key:"_captureUp",value:function _captureUp(){return this.fetchList.selectedIndex-1>=0&&(this.refreshListColor(),this.fetchList.items[this.fetchList.selectedIndex-1].patch({Duration:{text:{textColor:ProfilingMonitor.selectedItemColor}},Request:{text:{textColor:ProfilingMonitor.selectedItemColor}}})),!1}},{key:"_captureDown",value:function _captureDown(){return this.fetchList.selectedIndex+1<this.fetchList.items.length&&(this.refreshListColor(),this.fetchList.items[this.fetchList.selectedIndex+1].patch({Duration:{text:{textColor:ProfilingMonitor.selectedItemColor}},Request:{text:{textColor:ProfilingMonitor.selectedItemColor}}})),!1}},{key:"_handleKey",value:function _handleKey(){return this.unfocusWidget&&(this.unfocusWidget=!1,this.refreshListColor(),Oy.focusPage()),!0}},{key:"receiveKey",value:function receiveKey(o){if(this.profiling.active){if(r4[this.currentInputs.length]===o){if(this.currentInputs.push(o),!arrayCompare(this.currentInputs,r4))return;this.toggleVisibility(),this.hasFocus()&&(Oy.focusPage(),this.refreshListColor())}if(this.alpha&&i4[this.currentInputs.length]===o){if(this.currentInputs.push(o),!arrayCompare(this.currentInputs,i4))return;this.hasFocus()?this.unfocusWidget=!0:Oy.focusWidget("ProfilingMonitor"),this.selectLastListItem()}this.currentInputs=[]}}},{key:"toggleVisibility",value:function toggleVisibility(){this.alpha=1===this.alpha?0:1}},{key:"fetchListItemTemplate",value:function fetchListItemTemplate(o,s){return{w:1870,h:70,Duration:{text:{fontSize:18,text:"Duration: ".concat(o.duration.toFixed(4)," ").concat(this.profiling.durationUnit),textColor:this.hasFocus()&&s===this.fetchList.selectedIndex?ProfilingMonitor.selectedItemColor:ProfilingMonitor.itemColor}},Request:{y:35,text:{fontSize:28,text:"".concat(s,"-").concat(o.name),textColor:this.hasFocus()&&s===this.fetchList.selectedIndex?ProfilingMonitor.selectedItemColor:ProfilingMonitor.itemColor}}}}},{key:"refreshListColor",value:function refreshListColor(){this.fetchList.items.forEach((function(o){o.patch({Duration:{text:{textColor:ProfilingMonitor.itemColor}},Request:{text:{textColor:ProfilingMonitor.itemColor}}})}))}},{key:"selectLastListItem",value:function selectLastListItem(){0!==this.fetchList.items.length&&(this.fetchList.selectedIndex=this.fetchListLast,this.fetchList.hasFocus()?this.fetchList.items[this.fetchListLast].patch({Duration:{text:{textColor:ProfilingMonitor.selectedItemColor}},Request:{text:{textColor:ProfilingMonitor.selectedItemColor}}}):this.refreshListColor())}},{key:"fetchList",get:function get(){return this.tag("Content.ProfilingData.FetchList.List")}},{key:"fetchListLast",get:function get(){return this.fetchList.items.length-1}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,Background:{w:function w(o){return o},h:function h(o){return o},color:XS.get("transparentBlack"),rect:!0},Content:{w:function w(o){return o},Title:{w:function w(o){return o},y:10,text:{text:"Profiling Data",textAlign:"center",fontSize:24}},ProfilingData:{y:30,w:function w(o){return o},Memory:{w:function w(o){return o},y:20,text:{textAlign:"center",fontSize:20}},NetworkActivity:{y:50,w:function w(o){return o},text:{textAlign:"center",fontSize:20}},FetchList:{x:20,y:90,w:function w(o){return o},Header:{text:{textAlign:"center",fontSize:20,text:"Network activity:"}},List:{y:40,w:function w(o){return o},h:ProfilingMonitor.fetchListHeight,clipping:!0,type:RP,itemSpacing:22}}}}}}}]),ProfilingMonitor}(E.Component);o4.fetchListHeight=920,o4.itemColor=4294967295,o4.selectedItemColor=4294967040;var s4=function(o){_inherits$1(PlayerWidgetContainer,o);var s=_createSuper$1(PlayerWidgetContainer);function PlayerWidgetContainer(){var o;return _classCallCheck$1(this,PlayerWidgetContainer),(o=s.apply(this,arguments)).isPlayerWidgetContainer=!0,o.widgetSizeW=1077,o.widgetSizeH=605,o.widgetPositionX=420,o.widgetPositionY=190,o.textProvider={},o}return _createClass$1(PlayerWidgetContainer,[{key:"_init",value:function _init(){_get$1(_getPrototypeOf$1(PlayerWidgetContainer.prototype),"_init",this).call(this),this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.setUpText()}},{key:"setUpText",value:function setUpText(){this.tag("Title").text.text=this.textProvider.getText(fT)}},{key:"_firstEnable",value:function _firstEnable(){_get$1(_getPrototypeOf$1(PlayerWidgetContainer.prototype),"_firstEnable",this).call(this),this.controlButtons.widget=this}},{key:"resizingPlayer",value:function resizingPlayer(){var o=this.widgetSizeW,s=this.widgetSizeH,m=this.widgetPositionX,_=this.widgetPositionY;qw.screenWidth===JS&&(o=calculateProportion(o,YS,JS),s=calculateProportion(s,QS,ZS),m=calculateProportion(m,YS,JS),_=calculateProportion(_,QS,ZS)),this.resize(o,s,m,_),this.positionAvailabilityMessage(this.widgetSizeW,this.widgetSizeH,this.widgetPositionX,this.widgetPositionY)}},{key:"_enable",value:function _enable(){this._setState("PlayerControlsFocused")}},{key:"_focus",value:function _focus(){this._setState("PlayerControlsFocused"),this._progressBarView.playerSize="widgetCenter",this.show()}},{key:"fullscreen",value:function fullscreen(){this.toggleFullscreen(),this.isFullscreen?(this.tag("Background").alpha=0,this.tag("Header").alpha=0,this._setState("PlayerFocused")):(this.controlButtons.visible=!0,this.tag("Background").alpha=.7,this.tag("Header").alpha=1,this._setState("PlayerControlsFocused"))}},{key:"_handleBack",value:function _handleBack(){this.isFullscreen?this.fullscreen():(this.reset(),Oy.focusPage())}},{key:"reset",value:function reset(){this.hide(),this.source={format:"",type:"VOD",tags:[],url:"",formattedUrl:"",id:""},this.restart()}},{key:"hide",value:function hide(){this.alpha=0}},{key:"show",value:function show(){this.alpha=1,this.source={format:"mp4",type:"VOD",tags:["4"],url:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",formattedUrl:"",id:"4"},this.player="hls",this.resizingPlayer(),this.sizeAsWidget()}},{key:"controlButtons",get:function get(){return this.tag("ControlButtons.Buttons")}}],[{key:"_template",value:function _template(){return Object.assign(Object.assign({Background:{w:function w(o){return o},h:function h(o){return o},color:XS.get("black"),rect:!0,alpha:.7,shader:{w:1075,h:604,x:422,y:191,type:E.shaders.Hole}}},_get$1(_getPrototypeOf$1(PlayerWidgetContainer),"_template",this).call(this)),{alpha:0,Header:{w:function w(o){return o},h:64,y:46,zIndex:99,Logo:{w:206,h:64,x:56,src:ca.asset(ZP),shader:{type:E.shaders.RoundedRectangle,radius:10}},Title:{w:400,h:44,x:308,y:9,text:{fontSize:40,wordWrapWidth:function wordWrapWidth(o){return o},textColor:XS.get("eggshell"),fontFace:XP.bold}}},ControlButtons:{x:422,y:820,Buttons:{type:kL}}})}},{key:"_states",value:function _states(){return[].concat(_toConsumableArray$1(_get$1(_getPrototypeOf$1(PlayerWidgetContainer),"_states",this).call(this)),[function(o){_inherits$1(PlayerControlsFocused,o);var s=_createSuper$1(PlayerControlsFocused);function PlayerControlsFocused(){return _classCallCheck$1(this,PlayerControlsFocused),s.apply(this,arguments)}return _createClass$1(PlayerControlsFocused,[{key:"_getFocused",value:function _getFocused(){return this.controlButtons}}]),PlayerControlsFocused}(this)])}}]),PlayerWidgetContainer}(J2),u4=function(o){_inherits$1(QAImageOverlay,o);var s=_createSuper$1(QAImageOverlay);function QAImageOverlay(){var o;return _classCallCheck$1(this,QAImageOverlay),(o=s.apply(this,arguments)).currentInputs=[],o.pressedKeyTimeout=0,o.delayKeySubmissionMS=800,o.logger={},o.overlayControls=["0","0","0"],o.imageOverlays=QP,o}return _createClass$1(QAImageOverlay,[{key:"_init",value:function _init(){this.logger=a_.resolveType(DE.dependencyKeys.Logger)}},{key:"receiveKey",value:function receiveKey(o){return __awaiter$h(this,void 0,void 0,_regeneratorRuntime$1().mark((function _callee(){return _regeneratorRuntime$1().wrap((function _callee$(s){for(;;)switch(s.prev=s.next){case 0:return this.pressedKeyTimeout&&ja.clearTimeout(this.pressedKeyTimeout),this.currentInputs.push(o),s.next=4,this.delaySubmission(this.delayKeySubmissionMS);case 4:case"end":return s.stop()}}),_callee,this)})))}},{key:"delaySubmission",value:function delaySubmission(o){var s=this;return new Promise((function(){s.pressedKeyTimeout=ja.setTimeout((function(){if(s.arrayCompare(s.currentInputs,s.overlayControls))s.visible=!s.visible,s.currentInputs=[];else{var o=s.currentInputs.join(""),m=s.imageOverlays.find((function(s){return s.url.replace("QAOverlayImages/","").split(".")[0]===o})),_=(null==m?void 0:m.url)||"";_.length>0&&(s.QAImage=ca.asset(_)),s.currentInputs=[]}}),o)}))}},{key:"_handleUp",value:function _handleUp(){this.Overlay.alpha+=.1}},{key:"_handleDown",value:function _handleDown(){this.Overlay.alpha-=.1}},{key:"QAImage",set:function set(o){this.tag("Background").patch({src:o})}},{key:"Overlay",get:function get(){return this.tag("Background")}},{key:"arrayCompare",value:function arrayCompare(o,s){return Array.isArray(o)&&Array.isArray(s)&&o.length===s.length&&o.every((function(o,m){return o===s[m]}))}}],[{key:"_template",value:function _template(){return{Background:{zIndex:1e3,src:"",color:XS.get("lime"),alpha:.5},Indicator:{alpha:1,x:820,y:20,w:180,h:60,rect:!0,color:XS.get("black"),Text:{text:{text:"  Overlay On",fontSize:28,textColor:XS.get("white")}}}}}}]),QAImageOverlay}(E.Component),l4=function(o){_inherits$1(ErrorView,o);var s=_createSuper$1(ErrorView);function ErrorView(){var o;return _classCallCheck$1(this,ErrorView),(o=s.apply(this,arguments)).modalBackgroundColor=XS.get("black"),o.errorModalWidth=1920,o.errorModalHeight=1080,o.presenter={},o.leftButtonInUse=!1,o.rightButtonInUse=!1,o.dismissButtonVisible=!1,o.returnButtonVisible=!1,o.exitButtonVisible=!1,o.textProvider={},o.errorButtonStyling={w:222,h:69,color:XS.get("black"),focusedColor:XS.get("velopeGreen"),radius:18,stroke:3,strokeColor:XS.get("white"),focusedStroke:0,textStyle:{fontSize:24,textColor:XS.get("eggshell"),fontFace:XP.bold},focusedStyle:{fontSize:24,textColor:XS.get("black")}},o.handleError=function(s){if("errorTriggered"===s.propertyName){var m=s.newValue;if("API"===m.type&&(o.errorMessage=o.textProvider.getText(KT)),"player"===m.type&&(o.errorMessage=o.textProvider.getText(zT)),m.onRetry&&o.setButtons("Retry",m.onRetry),m.useDismissButton){o.setButtons("Dismiss",(function dismissCallback(){m.onBack&&m.onBack(),o.dismissProcess()}))}else if(m.useExitButton){o.setButtons("Exit",(function exitCallback(){m.onExit&&m.onExit(),o.exitProcess()}))}o.show()}},o}return _createClass$1(ErrorView,[{key:"_init",value:function _init(){this.textProvider=a_.resolveType(DE.dependencyKeys.TextProvider),this.presenter=a_.resolveType(DE.dependencyKeys.ErrorPresenter),this.presenter.propertyChanged.addListener(this.handleError),this.setUpModal()}},{key:"setUpModal",value:function setUpModal(){this.modal.patch({box:{w:this.errorModalWidth,h:this.errorModalHeight,margin:75,titleYMargin:getLngOptimalElementSize(200),bodyXMargin:getLngOptimalElementSize(500),bodyYMargin:300,color:this.modalBackgroundColor,radius:54,background:{color:XS.get("clear"),alpha:.5,rect:!0},title:{text:this.textProvider.getText(LT),textColor:XS.get("eggshell"),fontSize:getLngOptimalElementSize(40),textAlign:"center",fontFace:XP.bold},body:{text:this.textProvider.getText(PT),lineHeight:60,textColor:XS.get("eggshell"),fontSize:getLngOptimalElementSize(32),textAlign:"center",fontFace:XP.regular},buttons:{align:"center",spacing:getLngOptimalElementSize(50),y:getLngOptimalElementSize(800),left:Object.assign(Object.assign({},this.errorButtonStyling),{title:this.textProvider.getText(HT)})}}})}},{key:"_getFocused",value:function _getFocused(){return this.modal}},{key:"_handleExit",value:function _handleExit(){Oy.focusWidget("ExitModal")}},{key:"show",value:function show(){this.alpha=1,this.visible=!0,Oy.focusWidget("ErrorModal")}},{key:"hide",value:function hide(){this.alpha=0,this.leftButtonInUse=!1,Oy.focusPage()}},{key:"_handleBack",value:function _handleBack(){this.hide()}},{key:"_handleKey",value:function _handleKey(){}},{key:"dismissProcess",value:function dismissProcess(){this.hide(),Oy.focusPage()}},{key:"exitProcess",value:function exitProcess(){this.hide(),qw.shutdown()}},{key:"_focus",value:function _focus(){this.show()}},{key:"_unfocus",value:function _unfocus(){this.alpha=.001}},{key:"modal",get:function get(){return this.tag("Modal")}},{key:"setButtons",value:function setButtons(o,s){this.leftButtonInUse?this.setRightButton(o,s):(this.setLeftButton(o,s),this.leftButtonInUse=!0)}},{key:"setLeftButton",value:function setLeftButton(o,s){var m=Object.assign(Object.assign({},this.errorButtonStyling),{title:o});this.modal.leftButtonProps=m,this.modal.onLButtonPressed=function(){s()}}},{key:"setRightButton",value:function setRightButton(o,s){var m=Object.assign(Object.assign({},this.errorButtonStyling),{title:o});this.modal.rightButtonProps=m,this.modal.onRButtonPressed=function(){s()}}},{key:"backgroundColor",set:function set(o){this.modalBackgroundColor=o}},{key:"modalW",get:function get(){return this.errorModalWidth},set:function set(o){this.errorModalWidth=o}},{key:"errorHeader",set:function set(o){this.modal.title=o}},{key:"errorMessage",set:function set(o){this.modal.body=o}},{key:"modalH",get:function get(){return this.errorModalHeight},set:function set(o){this.errorModalHeight=o}},{key:"button",set:function set(o){this.errorButtonStyling=o}}],[{key:"_template",value:function _template(){return{w:1920,h:1080,alpha:0,Header:{w:function w(o){return o},h:getLngOptimalElementSize(64),y:getLngOptimalElementSize(46),zIndex:99,Logo:{w:getLngOptimalElementSize(206),h:getLngOptimalElementSize(64),x:getLngOptimalElementSize(56),src:ca.asset(ZP),shader:{type:E.shaders.RoundedRectangle,radius:10}}},Modal:{type:MP}}}}]),ErrorView}(E.Component),c4=function(o){_inherits$1(App,o);var s=_createSuper$1(App);function App(){var o;return _classCallCheck$1(this,App),(o=s.apply(this,arguments)).profiling={},o.logger={},o}return _createClass$1(App,[{key:"_setup",value:function _setup(){"browser"===qw.deviceType&&(document.body.style.backgroundColor="black"),RS.init(),DE.init(),this.profiling=a_.resolveType(a_.dependencyKeys.Profiling),this.profiling.init(),this.profiling.track("Launch");var o=new s_;window.addEventListener("error",(function globalErrorHandler(s){o.handleError(s)}),!0),window.addEventListener("unhandledrejection",(function promiseErrorHandler(s){o.handlePromise(s)}),!0),Oy.startRouter(aV,this)}},{key:"_attach",value:function _attach(){this.profiling.stopTrack("Launch")}},{key:"_getFocused",value:function _getFocused(){return Oy.getActivePage()}},{key:"_captureKey",value:function _captureKey(o){return this.QAOverlay.receiveKey(o.key),this.profilingOverlay.receiveKey(o.key),!("0"!==o.key||!this.visible)&&(Oy.focusWidget("QAImageOverlay"),!0)}},{key:"_handleAppClose",value:function _handleAppClose(){this.application.closeApp()}},{key:"profilingOverlay",get:function get(){return this.tag("ProfilingMonitor")}},{key:"QAOverlay",get:function get(){return this.tag("QAImageOverlay")}}],[{key:"getFonts",value:function getFonts(){return[{family:"Regular",url:ca.asset(qP.regular)},{family:"Bold",url:ca.asset(qP.bold)},{family:"BoldItalic",url:ca.asset(qP.boldItalic)},{family:"Thin",url:ca.asset(qP.thin)},{family:"Medium",url:ca.asset(qP.medium)}]}},{key:"_template",value:function _template(){return Object.assign(Object.assign({announcerEnabled:!0},_get$1(_getPrototypeOf$1(App),"_template",this).call(this)),{Widgets:{PlayerWidget:{type:J2},LoadSpinner:{type:a4},ExitModal:{type:Z2},ExampleModal:{type:e4},ProfilingMonitor:{type:o4},PlayerWidgetContainer:{type:s4},QAImageOverlay:{type:u4},ErrorModal:{type:l4}}})}}]),App}(function withAnnouncer(o){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Speech,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_=_objectSpread(_objectSpread({},mI),m);return function(o){_inherits(_class,o);var S=_createSuper(_class);function _class(){return _classCallCheck(this,_class),S.apply(this,arguments)}return _createClass(_class,[{key:"_construct",value:function _construct(){this._currentlySpeaking=""}},{key:"_voiceOut",value:function _voiceOut(o){var S=this;if(!this._voiceOutDisabled){var E=o;_.abbreviationsConfig.abbreviationsPattern&&(E=Array.isArray(o)?o.map((function(o){return gI(o,_.abbreviationsConfig)})):gI(o,_.abbreviationsConfig));var A=s(E,m.language);A&&A.series&&A.series.then((function(){S.stage.emit("announceEnded")}));var O=(Array.isArray(E)?E.concat().join(" "):E).split(" ").length*_.voiceOutDelay;return clearTimeout(this._announceEndedTimeout),this._announceEndedTimeout=setTimeout((function(){S.stage.emit("announceTimeoutEnded")}),O),A}}},{key:"_build",value:function _build(){var o=this;_get(_getPrototypeOf(_class.prototype),"_build",this)&&_get(_getPrototypeOf(_class.prototype),"_build",this).call(this),this._debounceAnnounceFocusChanges=debounce$1(this._announceFocusChanges.bind(this),Number.isInteger(this.announcerFocusDebounce)?this.announcerFocusDebounce:400),this.announcerTimeout=Number.isInteger(this.announcerTimeout)?this.announcerTimeout:3e5,this._resetFocusTimer=debounce$1((function(){o._lastFocusPath=void 0}),this.announcerTimeout)}},{key:"_firstEnable",value:function _firstEnable(){_get(_getPrototypeOf(_class.prototype),"_firstEnable",this)&&_get(_getPrototypeOf(_class.prototype),"_firstEnable",this).call(this),this._focusChange()}},{key:"_disable",value:function _disable(){clearTimeout(this._announceEndedTimeout),this.stage.emit("announceEnded"),this.stage.emit("announceTimeoutEnded")}},{key:"announcerEnabled",get:function get(){return this._announcerEnabled},set:function set(o){this._announcerEnabled=o,this._focusChange()}},{key:"_focusChange",value:function _focusChange(){this._resetFocusTimer&&(this._resetFocusTimer(),this.$announcerCancel(),this._debounceAnnounceFocusChanges())}},{key:"_announceFocusChanges",value:function _announceFocusChanges(){var o=this.application.focusPath||[],s=this._lastFocusPath||[],m=o.every((function(o){return!o.loading})),_=o.filter((function(o){return!s.includes(o)}));if(m){if(this._lastFocusPath=o.slice(0),this.focusDiffHook=_,this.announcerEnabled){var S=_.reduce((function(o,s){return s.announce?o.push([elmName(s),"Announce",s.announce]):s.title&&o.push([elmName(s),"Title",s.title||""]),o}),[]);_.reverse().reduce((function(o,s){return s.announceContext?o.push([elmName(s),"Context",s.announceContext]):o.push([elmName(s),"No Context",""]),o}),S),this.debug&&console.table(S),(S=S.reduce((function(o,s){var m=s[2];return m&&o.push(m),o}),[])).length&&(this.$announcerCancel(),this._currentlySpeaking=this._voiceOut(S.reduce((function(o,s){return o.concat(s)}),[])))}}else this._debounceAnnounceFocusChanges()}},{key:"$announce",value:function $announce(o){var s=this,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_=m.append,S=void 0!==_&&_,E=m.notification,A=void 0!==E&&E;o&&o.trim().length&&this.announcerEnabled&&(this._debounceAnnounceFocusChanges.flush(),S&&this._currentlySpeaking&&this._currentlySpeaking.active?this._currentlySpeaking.append(o):(this.$announcerCancel(),this._currentlySpeaking=this._voiceOut(o)),A&&(this._voiceOutDisabled=!0,this._currentlySpeaking.series.finally((function(){s._voiceOutDisabled=!1,s.$announcerRefresh()}))))}},{key:"$announcerCancel",value:function $announcerCancel(){this._currentlySpeaking&&this._currentlySpeaking.cancel()}},{key:"$announcerRefresh",value:function $announcerRefresh(o){this._lastFocusPath=o?this._lastFocusPath.slice(0,o):void 0,this._resetFocusTimer(),this._focusChange()}}]),_class}(o)}(Oy.App,qw.announce.bind(qw),{language:"en-US"}));return function index(o,s){return 1280===qw.screenWidth&&(o.stage.w=1280,o.stage.h=720,o.stage.precision=2/3),window.platform=qw,o.keys=qw.keyMapping,Launch.apply(void 0,[c4,o,s].concat(Array.prototype.slice.call(arguments)))}}();
